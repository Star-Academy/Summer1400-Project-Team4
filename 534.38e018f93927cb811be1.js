(self.webpackChunketl=self.webpackChunketl||[]).push([[534],{4299:Yr=>{Yr.exports=function(cn,Tt,$e,yn){var cr=new Blob(void 0!==yn?[yn,cn]:[cn],{type:$e||"application/octet-stream"});if(void 0!==window.navigator.msSaveBlob)window.navigator.msSaveBlob(cr,Tt);else{var Er=window.URL&&window.URL.createObjectURL?window.URL.createObjectURL(cr):window.webkitURL.createObjectURL(cr),Gi=document.createElement("a");Gi.style.display="none",Gi.href=Er,Gi.setAttribute("download",Tt),void 0===Gi.download&&Gi.setAttribute("target","_blank"),document.body.appendChild(Gi),Gi.click(),setTimeout(function(){document.body.removeChild(Gi),window.URL.revokeObjectURL(Er)},200)}}},70:()=>{!function(){"use strict";var cn,Tt,$e,yn,nr,cr,Er,Gi,lo,Qo,hr,Mo,qi,ui="leader-line",co={top:1,right:2,bottom:3,left:4},Io={straight:1,arc:2,fluid:3,magnet:4,grid:5},Jn="behind",Sr={disc:{elmId:"leader-line-disc",noRotate:!0,bBox:{left:-5,top:-5,width:10,height:10,right:5,bottom:5},widthR:2.5,heightR:2.5,bCircle:5,sideLen:5,backLen:5,overhead:0,outlineBase:1,outlineMax:4},square:{elmId:"leader-line-square",noRotate:!0,bBox:{left:-5,top:-5,width:10,height:10,right:5,bottom:5},widthR:2.5,heightR:2.5,bCircle:5,sideLen:5,backLen:5,overhead:0,outlineBase:1,outlineMax:4},arrow1:{elmId:"leader-line-arrow1",bBox:{left:-8,top:-8,width:16,height:16,right:8,bottom:8},widthR:4,heightR:4,bCircle:8,sideLen:8,backLen:8,overhead:8,outlineBase:2,outlineMax:1.5},arrow2:{elmId:"leader-line-arrow2",bBox:{left:-7,top:-8,width:11,height:16,right:4,bottom:8},widthR:2.75,heightR:4,bCircle:8,sideLen:8,backLen:7,overhead:4,outlineBase:1,outlineMax:1.75},arrow3:{elmId:"leader-line-arrow3",bBox:{left:-4,top:-5,width:12,height:10,right:8,bottom:5},widthR:3,heightR:2.5,bCircle:8,sideLen:5,backLen:4,overhead:8,outlineBase:1,outlineMax:2.5},hand:{elmId:"leader-line-hand",bBox:{left:-3,top:-12,width:40,height:24,right:37,bottom:12},widthR:10,heightR:6,bCircle:37,sideLen:12,backLen:3,overhead:37},crosshair:{elmId:"leader-line-crosshair",noRotate:!0,bBox:{left:-96,top:-96,width:192,height:192,right:96,bottom:96},widthR:48,heightR:48,bCircle:96,sideLen:96,backLen:96,overhead:0}},ko={behind:Jn,disc:"disc",square:"square",arrow1:"arrow1",arrow2:"arrow2",arrow3:"arrow3",hand:"hand",crosshair:"crosshair"},bi={disc:"disc",square:"square",arrow1:"arrow1",arrow2:"arrow2",arrow3:"arrow3",hand:"hand",crosshair:"crosshair"},Xr=[1,2,3,4],pr="auto",li={x:"left",y:"top",width:"width",height:"height"},Jr=.5522847,Qr=.25*Math.PI,Da=/^\s*(\-?[\d\.]+)\s*(\%)?\s*$/,vt="http://www.w3.org/2000/svg",un="-ms-scroll-limit"in document.documentElement.style&&"-ms-ime-align"in document.documentElement.style&&!window.navigator.msPointerEnabled,Xt=!un&&!!document.uniqueID,En="MozAppearance"in document.documentElement.style,Ht=!(un||En||!window.chrome||!window.CSS),Sn=!(un||Xt||En||Ht||window.chrome||!("WebkitAppearance"in document.documentElement.style)),Ei=Xt||un?.2:.1,Qn={path:3,lineColor:"coral",lineSize:4,plugSE:[Jn,"arrow1"],plugSizeSE:[1,1],lineOutlineEnabled:!1,lineOutlineColor:"indianred",lineOutlineSize:.25,plugOutlineEnabledSE:[!1,!1],plugOutlineSizeSE:[1,1]},Wi=(hr={}.toString,qi=(Mo={}.hasOwnProperty.toString).call(Object),function(_){var A,C;return _&&"[object Object]"===hr.call(_)&&(!(A=Object.getPrototypeOf(_))||(C=A.hasOwnProperty("constructor")&&A.constructor)&&"function"==typeof C&&Mo.call(C)===qi)}),ln=Number.isFinite||function(_){return"number"==typeof _&&window.isFinite(_)},en=function(){var _,A={ease:[.25,.1,.25,1],linear:[0,0,1,1],"ease-in":[.42,0,1,1],"ease-out":[0,0,.58,1],"ease-in-out":[.42,0,.58,1]},C=1e3/60/2,T=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(ee){setTimeout(ee,C)},P=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame||function(ee){clearTimeout(ee)},V=Number.isFinite||function(ee){return"number"==typeof ee&&window.isFinite(ee)},le=[],te=0;function re(){var ee=Date.now(),ye=!1;_&&(P.call(window,_),_=null),le.forEach(function(G){var Q,$,se;if(G.framesStart){if((Q=ee-G.framesStart)>=G.duration&&G.count&&G.loopsLeft<=1)return se=G.frames[G.lastFrame=G.reverse?0:G.frames.length-1],G.frameCallback(se.value,!0,se.timeRatio,se.outputRatio),void(G.framesStart=null);if(Q>G.duration){if($=Math.floor(Q/G.duration),G.count){if($>=G.loopsLeft)return se=G.frames[G.lastFrame=G.reverse?0:G.frames.length-1],G.frameCallback(se.value,!0,se.timeRatio,se.outputRatio),void(G.framesStart=null);G.loopsLeft-=$}G.framesStart+=G.duration*$,Q=ee-G.framesStart}G.reverse&&(Q=G.duration-Q),se=G.frames[G.lastFrame=Math.round(Q/C)],!1!==G.frameCallback(se.value,!1,se.timeRatio,se.outputRatio)?ye=!0:G.framesStart=null}}),ye&&(_=T.call(window,re))}function j(ee,ye){ee.framesStart=Date.now(),null!=ye&&(ee.framesStart-=ee.duration*(ee.reverse?1-ye:ye)),ee.loopsLeft=ee.count,ee.lastFrame=null,re()}return{add:function(ee,ye,G,Q,$,se,_e){var Ae,Ne,Te,ge,ne,ue,oe,ut,ft,rt,q,Ee,I,xe=++te;function Fe(ct,fe){return{value:ee(fe),timeRatio:ct,outputRatio:fe}}if("string"==typeof $&&($=A[$]),ee=ee||function(){},G<C)Ne=[Fe(0,0),Fe(1,1)];else{if(Te=C/G,Ne=[Fe(0,0)],0===$[0]&&0===$[1]&&1===$[2]&&1===$[3])for(ne=Te;ne<=1;ne+=Te)Ne.push(Fe(ne,ne));else for(ue=ge=(ne=Te)/10;ue<=1;ue+=ge)rt=(ft=(ut=ue)*ut)*ut,I=3*(q=1-ut)*ft,ne<=(oe={x:(Ee=q*q*3*ut)*$[0]+I*$[2]+rt,y:Ee*$[1]+I*$[3]+rt}).x&&(Ne.push(Fe(oe.x,oe.y)),ne+=Te);Ne.push(Fe(1,1))}return le.push(Ae={animId:xe,frameCallback:ye,duration:G,count:Q,frames:Ne,reverse:!!se}),!1!==_e&&j(Ae,_e),xe},remove:function(ee){var ye;le.some(function(G,Q){return G.animId===ee&&(ye=Q,!(G.framesStart=null))})&&le.splice(ye,1)},start:function(ee,ye,G){le.some(function(Q){return Q.animId===ee&&(Q.reverse=!!ye,j(Q,G),!0)})},stop:function(ee,ye){var G;return le.some(function(Q){return Q.animId===ee&&(ye?null!=Q.lastFrame&&(G=Q.frames[Q.lastFrame].timeRatio):(G=(Date.now()-Q.framesStart)/Q.duration,Q.reverse&&(G=1-G),G<0?G=0:1<G&&(G=1)),!(Q.framesStart=null))}),G},validTiming:function(ee){return"string"==typeof ee?A[ee]:Array.isArray(ee)&&[0,1,2,3].every(function(ye){return V(ee[ye])&&0<=ee[ye]&&ee[ye]<=1})?[ee[0],ee[1],ee[2],ee[3]]:null}}}(),Ra=function(_){var A={};function C(T){if(A[T])return A[T].exports;var P=A[T]={i:T,l:!1,exports:{}};return _[T].call(P.exports,P,P.exports,C),P.l=!0,P.exports}return C.m=_,C.c=A,C.d=function(T,P,V){C.o(T,P)||Object.defineProperty(T,P,{configurable:!1,enumerable:!0,get:V})},C.r=function(T){Object.defineProperty(T,"__esModule",{value:!0})},C.n=function(T){var P=T&&T.__esModule?function(){return T.default}:function(){return T};return C.d(P,"a",P),P},C.o=function(T,P){return Object.prototype.hasOwnProperty.call(T,P)},C.p="",C(C.s=0)}([function(_,A,C){C.r(A);var P=[],V=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(G){return setTimeout(G,1e3/60)},le=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame||function(G){return clearTimeout(G)},te=void 0,re=Date.now();function j(){var G=void 0,Q=void 0;te&&(le.call(window,te),te=null),P.forEach(function($){$.event&&($.listener($.event),$.event=null,G=!0)}),G?(re=Date.now(),Q=!0):Date.now()-re<500&&(Q=!0),Q&&(te=V.call(window,j))}function ee(G){var Q=-1;return P.some(function($,se){return $.listener===G&&(Q=se,!0)}),Q}A.default={add:function(G){var Q=void 0;return-1===ee(G)?(P.push(Q={listener:G}),function($){Q.event=$,te||j()}):null},remove:function(G){var Q;-1<(Q=ee(G))&&(P.splice(Q,1),!P.length&&te&&(le.call(window,te),te=null))}}}]).default,Oo={line_altColor:{iniValue:!1},line_color:{},line_colorTra:{iniValue:!1},line_strokeWidth:{},plug_enabled:{iniValue:!1},plug_enabledSE:{hasSE:!0,iniValue:!1},plug_plugSE:{hasSE:!0,iniValue:Jn},plug_colorSE:{hasSE:!0},plug_colorTraSE:{hasSE:!0,iniValue:!1},plug_markerWidthSE:{hasSE:!0},plug_markerHeightSE:{hasSE:!0},lineOutline_enabled:{iniValue:!1},lineOutline_color:{},lineOutline_colorTra:{iniValue:!1},lineOutline_strokeWidth:{},lineOutline_inStrokeWidth:{},plugOutline_enabledSE:{hasSE:!0,iniValue:!1},plugOutline_plugSE:{hasSE:!0,iniValue:Jn},plugOutline_colorSE:{hasSE:!0},plugOutline_colorTraSE:{hasSE:!0,iniValue:!1},plugOutline_strokeWidthSE:{hasSE:!0},plugOutline_inStrokeWidthSE:{hasSE:!0},position_socketXYSE:{hasSE:!0,hasProps:!0},position_plugOverheadSE:{hasSE:!0},position_path:{},position_lineStrokeWidth:{},position_socketGravitySE:{hasSE:!0},path_pathData:{},path_edge:{hasProps:!0},viewBox_bBox:{hasProps:!0},viewBox_plugBCircleSE:{hasSE:!0},lineMask_enabled:{iniValue:!1},lineMask_outlineMode:{iniValue:!1},lineMask_x:{},lineMask_y:{},lineOutlineMask_x:{},lineOutlineMask_y:{},maskBGRect_x:{},maskBGRect_y:{},capsMaskAnchor_enabledSE:{hasSE:!0,iniValue:!1},capsMaskAnchor_pathDataSE:{hasSE:!0},capsMaskAnchor_strokeWidthSE:{hasSE:!0},capsMaskMarker_enabled:{iniValue:!1},capsMaskMarker_enabledSE:{hasSE:!0,iniValue:!1},capsMaskMarker_plugSE:{hasSE:!0,iniValue:Jn},capsMaskMarker_markerWidthSE:{hasSE:!0},capsMaskMarker_markerHeightSE:{hasSE:!0},caps_enabled:{iniValue:!1},attach_plugSideLenSE:{hasSE:!0},attach_plugBackLenSE:{hasSE:!0}},fs={show_on:{},show_effect:{},show_animOptions:{},show_animId:{},show_inAnim:{}},gs="fade",No=[],di={},za=0,qn={},Ba=0;function Dr(_,A){var C,T;return typeof _!=typeof A||(C=Wi(_)?"obj":Array.isArray(_)?"array":"")!=(Wi(A)?"obj":Array.isArray(A)?"array":"")||("obj"===C?Dr(T=Object.keys(_).sort(),Object.keys(A).sort())||T.some(function(P){return Dr(_[P],A[P])}):"array"===C?_.length!==A.length||_.some(function(P,V){return Dr(P,A[V])}):_!==A)}function Si(_){return _&&(Wi(_)?Object.keys(_).reduce(function(A,C){return A[C]=Si(_[C]),A},{}):Array.isArray(_)?_.map(Si):_)}function rr(_){var A,C,T,P=1,V=_=(_+"").trim();function le(te){var re=1,j=Da.exec(te);return j&&(re=parseFloat(j[1]),j[2]?re=0<=re&&re<=100?re/100:1:(re<0||1<re)&&(re=1)),re}return(A=/^(rgba|hsla|hwb|gray|device\-cmyk)\s*\(([\s\S]+)\)$/i.exec(_))?(C=A[1].toLowerCase(),T=A[2].trim().split(/\s*,\s*/),"rgba"===C&&4===T.length?(P=le(T[3]),V="rgb("+T.slice(0,3).join(", ")+")"):"hsla"===C&&4===T.length?(P=le(T[3]),V="hsl("+T.slice(0,3).join(", ")+")"):"hwb"===C&&4===T.length?(P=le(T[3]),V="hwb("+T.slice(0,3).join(", ")+")"):"gray"===C&&2===T.length?(P=le(T[1]),V="gray("+T[0]+")"):"device-cmyk"===C&&5<=T.length&&(P=le(T[4]),V="device-cmyk("+T.slice(0,4).join(", ")+")")):(A=/^\#(?:([\da-f]{6})([\da-f]{2})|([\da-f]{3})([\da-f]))$/i.exec(_))?A[1]?(P=parseInt(A[2],16)/255,V="#"+A[1]):(P=parseInt(A[4]+A[4],16)/255,V="#"+A[3]):"transparent"===_.toLocaleLowerCase()&&(P=0),[P,V]}function Yi(_){return!(!_||_.nodeType!==Node.ELEMENT_NODE||"function"!=typeof _.getBoundingClientRect)}function Rr(_,A){var C,T,P,V,le={};if(!(P=_.ownerDocument))return console.error("Cannot get document that contains the element."),null;if(_.compareDocumentPosition(P)&Node.DOCUMENT_POSITION_DISCONNECTED)return console.error("A disconnected element was passed."),null;for(T in C=_.getBoundingClientRect())le[T]=C[T];if(!A){if(!(V=P.defaultView))return console.error("Cannot get window that contains the element."),null;le.left+=V.pageXOffset,le.right+=V.pageXOffset,le.top+=V.pageYOffset,le.bottom+=V.pageYOffset}return le}function po(_,A){var C,T,P=[],V=_;for(A=A||window;;){if(!(C=V.ownerDocument))return console.error("Cannot get document that contains the element."),null;if(!(T=C.defaultView))return console.error("Cannot get window that contains the element."),null;if(T===A)break;if(!(V=T.frameElement))return console.error("`baseWindow` was not found."),null;P.unshift(V)}return P}function Lo(_,A){var C,T,P=0,V=0;return(T=po(_,A=A||window))?T.length?(T.forEach(function(le,te){var re,j,ee=Rr(le,0<te);P+=ee.left,V+=ee.top,j=(re=le).ownerDocument.defaultView.getComputedStyle(re,""),ee={left:re.clientLeft+parseFloat(j.paddingLeft),top:re.clientTop+parseFloat(j.paddingTop)},P+=ee.left,V+=ee.top}),(C=Rr(_,!0)).left+=P,C.right+=P,C.top+=V,C.bottom+=V,C):Rr(_):null}function Kn(_,A){var C=_.x-A.x,T=_.y-A.y;return Math.sqrt(C*C+T*T)}function Fo(_,A,C){var T=A.x-_.x,P=A.y-_.y;return{x:_.x+T*C,y:_.y+P*C,angle:Math.atan2(P,T)/(Math.PI/180)}}function Xi(_,A,C){var T=Math.atan2(_.y-A.y,A.x-_.x);return{x:A.x+Math.cos(T)*C,y:A.y+Math.sin(T)*C*-1}}function Bi(_,A,C,T,P){var V=P*P,le=V*P,te=1-P,re=te*te,j=re*te,ee=j*_.x+3*re*P*A.x+3*te*V*C.x+le*T.x,ye=j*_.y+3*re*P*A.y+3*te*V*C.y+le*T.y,G=_.x+2*P*(A.x-_.x)+V*(C.x-2*A.x+_.x),Q=_.y+2*P*(A.y-_.y)+V*(C.y-2*A.y+_.y),$=A.x+2*P*(C.x-A.x)+V*(T.x-2*C.x+A.x),se=A.y+2*P*(C.y-A.y)+V*(T.y-2*C.y+A.y),_e=te*_.x+P*A.x,Ae=te*_.y+P*A.y,Ne=te*C.x+P*T.x,Te=te*C.y+P*T.y,ge=90-180*Math.atan2(G-$,Q-se)/Math.PI;return{x:ee,y:ye,fromP2:{x:G,y:Q},toP1:{x:$,y:se},fromP1:{x:_e,y:Ae},toP2:{x:Ne,y:Te},angle:ge+=180<ge?-180:180}}function fo(_,A,C,T,P){function V(Q,$,se,_e,Ae){return Q*(Q*(-3*$+9*se-9*_e+3*Ae)+6*$-12*se+6*_e)-3*$+3*se}var le,te,re,j,ye=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],G=0;return le=(P=null==P||1<P?1:P<0?0:P)/2,[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816].forEach(function(Q,$){re=V(te=le*Q+le,_.x,A.x,C.x,T.x),j=V(te,_.y,A.y,C.y,T.y),G+=ye[$]*Math.sqrt(re*re+j*j)}),le*G}function Vi(_,A,C,T,P){for(var V,le=.5,te=1-le;V=fo(_,A,C,T,te),!(Math.abs(V-P)<=.01);)te+=(V<P?1:-1)*(le/=2);return te}function _i(_,A){var C;return _.forEach(function(T){var P=A?T.map(function(V){var le={x:V.x,y:V.y};return A(le),le}):T;C||(C=[{type:"M",values:[P[0].x,P[0].y]}]),C.push(P.length?2===P.length?{type:"L",values:[P[1].x,P[1].y]}:{type:"C",values:[P[1].x,P[1].y,P[2].x,P[2].y,P[3].x,P[3].y]}:{type:"Z",values:[]})}),C}function $o(_){var A=[],C=0;return _.forEach(function(T){var P=(2===T.length?Kn:fo).apply(null,T);A.push(P),C+=P}),{segsLen:A,lenAll:C}}function Fn(_,A){return null==_||null==A||_.length!==A.length||_.some(function(C,T){var P=A[T];return C.type!==P.type||C.values.some(function(V,le){return V!==P.values[le]})})}function Hn(_,A,C){_.events[A]?_.events[A].indexOf(C)<0&&_.events[A].push(C):_.events[A]=[C]}function Wn(_,A,C){var T;_.events[A]&&-1<(T=_.events[A].indexOf(C))&&_.events[A].splice(T,1)}function gr(_){Er&&clearTimeout(Er),No.push(_),Er=setTimeout(function(){No.forEach(function(A){A()}),No=[]},0)}function hn(_,A){_.reflowTargets.indexOf(A)<0&&_.reflowTargets.push(A)}function Po(_){_.reflowTargets.forEach(function(A){var C;C=A,setTimeout(function(){var T=C.parentNode,P=C.nextSibling;T.insertBefore(T.removeChild(C),P)},0)}),_.reflowTargets=[]}function ea(_,A,C,T,P,V,le){var te,re,j;"auto-start-reverse"===C?("boolean"!=typeof Gi&&(A.setAttribute("orient","auto-start-reverse"),Gi=A.orientType.baseVal===SVGMarkerElement.SVG_MARKER_ORIENT_UNKNOWN),Gi?A.setAttribute("orient",C):((te=P.createSVGTransform()).setRotate(180,0,0),V.transform.baseVal.appendItem(te),A.setAttribute("orient","auto"),j=!0)):(A.setAttribute("orient",C),!1===Gi&&V.transform.baseVal.clear()),re=A.viewBox.baseVal,j?(re.x=-T.right,re.y=-T.bottom):(re.x=T.left,re.y=T.top),re.width=T.width,re.height=T.height,Xt&&hn(_,le)}function ta(_,A){return{prop:_?"markerEnd":"markerStart",orient:A?A.noRotate?"0":_?"auto":"auto-start-reverse":null}}function On(_,A){Object.keys(A).forEach(function(C){var T=A[C];_[C]=null!=T.iniValue?T.hasSE?[T.iniValue,T.iniValue]:T.iniValue:T.hasSE?T.hasProps?[{},{}]:[]:T.hasProps?{}:null})}function dt(_,A,C,T,P){return T!==A[C]&&(A[C]=T,P&&P.forEach(function(V){V(_,T,C)}),!0)}function gn(_){function A(le,te){return le+parseFloat(te)}var C=_.document,T=_.getComputedStyle(C.documentElement,""),P=_.getComputedStyle(C.body,""),V={x:0,y:0};return"static"!==P.position?(V.x-=[T.marginLeft,T.borderLeftWidth,T.paddingLeft,P.marginLeft,P.borderLeftWidth].reduce(A,0),V.y-=[T.marginTop,T.borderTopWidth,T.paddingTop,P.marginTop,P.borderTopWidth].reduce(A,0)):"static"!==T.position&&(V.x-=[T.marginLeft,T.borderLeftWidth].reduce(A,0),V.y-=[T.marginTop,T.borderTopWidth].reduce(A,0)),V}function Ti(_){var A,C=_.document;C.getElementById("leader-line-defs")||(A=(new _.DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg" version="1.1" id="leader-line-defs"><style><![CDATA[.leader-line{position:absolute;overflow:visible!important;pointer-events:none!important;font-size:16px}#leader-line-defs{width:0;height:0;position:absolute;left:0;top:0}.leader-line-line-path{fill:none}.leader-line-mask-bg-rect{fill:#fff}.leader-line-caps-mask-anchor,.leader-line-caps-mask-marker-shape{fill:#000}.leader-line-caps-mask-anchor{stroke:#000}.leader-line-caps-mask-line,.leader-line-plugs-face{stroke:transparent}.leader-line-line-mask-shape{stroke:#fff}.leader-line-line-outline-mask-shape{stroke:#000}.leader-line-plug-mask-shape{fill:#fff;stroke:#000}.leader-line-plug-outline-mask-shape{fill:#000;stroke:#fff}.leader-line-areaAnchor{position:absolute;overflow:visible!important}]]></style><defs><circle id="leader-line-disc" cx="0" cy="0" r="5"/><rect id="leader-line-square" x="-5" y="-5" width="10" height="10"/><polygon id="leader-line-arrow1" points="-8,-8 8,0 -8,8 -5,0"/><polygon id="leader-line-arrow2" points="-4,-8 4,0 -4,8 -7,5 -2,0 -7,-5"/><polygon id="leader-line-arrow3" points="-4,-5 8,0 -4,5"/><g id="leader-line-hand"><path style="fill: #fcfcfc" d="M9.19 11.14h4.75c1.38 0 2.49-1.11 2.49-2.49 0-.51-.15-.98-.41-1.37h1.3c1.38 0 2.49-1.11 2.49-2.49s-1.11-2.53-2.49-2.53h1.02c1.38 0 2.49-1.11 2.49-2.49s-1.11-2.49-2.49-2.49h14.96c1.37 0 2.49-1.11 2.49-2.49s-1.11-2.49-2.49-2.49H16.58C16-9.86 14.28-11.14 9.7-11.14c-4.79 0-6.55 3.42-7.87 4.73H-2.14v13.23h3.68C3.29 9.97 5.47 11.14 9.19 11.14L9.19 11.14Z"/><path style="fill: black" d="M13.95 12c1.85 0 3.35-1.5 3.35-3.35 0-.17-.02-.34-.04-.51h.07c1.85 0 3.35-1.5 3.35-3.35 0-.79-.27-1.51-.72-2.08 1.03-.57 1.74-1.67 1.74-2.93 0-.59-.16-1.15-.43-1.63h12.04c1.85 0 3.35-1.5 3.35-3.35 0-1.85-1.5-3.35-3.35-3.35H17.2C16.26-10.93 13.91-12 9.7-12 5.36-12 3.22-9.4 1.94-7.84c0 0-.29.33-.5.57-.63 0-3.58 0-3.58 0C-2.61-7.27-3-6.88-3-6.41v13.23c0 .47.39.86.86.86 0 0 2.48 0 3.2 0C2.9 10.73 5.29 12 9.19 12L13.95 12ZM9.19 10.28c-3.46 0-5.33-1.05-6.9-3.87-.15-.27-.44-.44-.75-.44 0 0-1.81 0-2.82 0V-5.55c1.06 0 3.11 0 3.11 0 .25 0 .44-.06.61-.25l.83-.95c1.23-1.49 2.91-3.53 6.43-3.53 3.45 0 4.9.74 5.57 1.72h-4.3c-.48 0-.86.38-.86.86s.39.86.86.86h22.34c.9 0 1.63.73 1.63 1.63 0 .9-.73 1.63-1.63 1.63H15.83c-.48 0-.86.38-.86.86 0 .47.39.86.86.86h2.52c.9 0 1.63.73 1.63 1.63s-.73 1.63-1.63 1.63h-3.12c-.48 0-.86.38-.86.86 0 .47.39.86.86.86h2.11c.88 0 1.63.76 1.63 1.67 0 .9-.73 1.63-1.63 1.63h-3.2c-.48 0-.86.39-.86.86 0 .47.39.86.86.86h1.36c.05.16.09.34.09.51 0 .9-.73 1.63-1.63 1.63C13.95 10.28 9.19 10.28 9.19 10.28Z"/></g><g id="leader-line-crosshair"><path d="M0-78.97c-43.54 0-78.97 35.43-78.97 78.97 0 43.54 35.43 78.97 78.97 78.97s78.97-35.43 78.97-78.97C78.97-43.54 43.55-78.97 0-78.97ZM76.51-1.21h-9.91v-9.11h-2.43v9.11h-11.45c-.64-28.12-23.38-50.86-51.5-51.5V-64.17h9.11V-66.6h-9.11v-9.91C42.46-75.86 75.86-42.45 76.51-1.21ZM-1.21-30.76h-9.11v2.43h9.11V-4.2c-1.44.42-2.57 1.54-2.98 2.98H-28.33v-9.11h-2.43v9.11H-50.29C-49.65-28-27.99-49.65-1.21-50.29V-30.76ZM-30.76 1.21v9.11h2.43v-9.11H-4.2c.42 1.44 1.54 2.57 2.98 2.98v24.13h-9.11v2.43h9.11v19.53C-27.99 49.65-49.65 28-50.29 1.21H-30.76ZM1.22 30.75h9.11v-2.43h-9.11V4.2c1.44-.42 2.56-1.54 2.98-2.98h24.13v9.11h2.43v-9.11h19.53C49.65 28 28 49.65 1.22 50.29V30.75ZM30.76-1.21v-9.11h-2.43v9.11H4.2c-.42-1.44-1.54-2.56-2.98-2.98V-28.33h9.11v-2.43h-9.11V-50.29C28-49.65 49.65-28 50.29-1.21H30.76ZM-1.21-76.51v9.91h-9.11v2.43h9.11v11.45c-28.12.64-50.86 23.38-51.5 51.5H-64.17v-9.11H-66.6v9.11h-9.91C-75.86-42.45-42.45-75.86-1.21-76.51ZM-76.51 1.21h9.91v9.11h2.43v-9.11h11.45c.64 28.12 23.38 50.86 51.5 51.5v11.45h-9.11v2.43h9.11v9.91C-42.45 75.86-75.86 42.45-76.51 1.21ZM1.22 76.51v-9.91h9.11v-2.43h-9.11v-11.45c28.12-.64 50.86-23.38 51.5-51.5h11.45v9.11h2.43v-9.11h9.91C75.86 42.45 42.45 75.86 1.22 76.51Z"/><path d="M0 83.58-7.1 96 7.1 96Z"/><path d="M0-83.58 7.1-96-7.1-96"/><path d="M83.58 0 96 7.1 96-7.1Z"/><path d="M-83.58 0-96-7.1-96 7.1Z"/></g></defs></svg>',"image/svg+xml"),C.body.appendChild(A.documentElement),function(_){_.SVGPathElement.prototype.getPathData&&_.SVGPathElement.prototype.setPathData||function(){var A={Z:"Z",M:"M",L:"L",C:"C",Q:"Q",A:"A",H:"H",V:"V",S:"S",T:"T",z:"Z",m:"m",l:"l",c:"c",q:"q",a:"a",h:"h",v:"v",s:"s",t:"t"},C=function(G){this._string=G,this._currentIndex=0,this._endIndex=this._string.length,this._prevCommand=null,this._skipOptionalSpaces()},T=-1!==_.navigator.userAgent.indexOf("MSIE ");C.prototype={parseSegment:function(){var G=this._string[this._currentIndex],Q=A[G]?A[G]:null;if(null===Q){if(null===this._prevCommand||null===(Q=("+"===G||"-"===G||"."===G||"0"<=G&&G<="9")&&"Z"!==this._prevCommand?"M"===this._prevCommand?"L":"m"===this._prevCommand?"l":this._prevCommand:null))return null}else this._currentIndex+=1;var $=null,se=(this._prevCommand=Q).toUpperCase();return"H"===se||"V"===se?$=[this._parseNumber()]:"M"===se||"L"===se||"T"===se?$=[this._parseNumber(),this._parseNumber()]:"S"===se||"Q"===se?$=[this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber()]:"C"===se?$=[this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber()]:"A"===se?$=[this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseArcFlag(),this._parseArcFlag(),this._parseNumber(),this._parseNumber()]:"Z"===se&&(this._skipOptionalSpaces(),$=[]),null===$||0<=$.indexOf(null)?null:{type:Q,values:$}},hasMoreData:function(){return this._currentIndex<this._endIndex},peekSegmentType:function(){var G=this._string[this._currentIndex];return A[G]?A[G]:null},initialCommandIsMoveTo:function(){if(!this.hasMoreData())return!0;var G=this.peekSegmentType();return"M"===G||"m"===G},_isCurrentSpace:function(){var G=this._string[this._currentIndex];return G<=" "&&(" "===G||"\n"===G||"\t"===G||"\r"===G||"\f"===G)},_skipOptionalSpaces:function(){for(;this._currentIndex<this._endIndex&&this._isCurrentSpace();)this._currentIndex+=1;return this._currentIndex<this._endIndex},_skipOptionalSpacesOrDelimiter:function(){return!(this._currentIndex<this._endIndex&&!this._isCurrentSpace()&&","!==this._string[this._currentIndex])&&(this._skipOptionalSpaces()&&this._currentIndex<this._endIndex&&","===this._string[this._currentIndex]&&(this._currentIndex+=1,this._skipOptionalSpaces()),this._currentIndex<this._endIndex)},_parseNumber:function(){var G=0,Q=0,$=1,se=0,_e=1,Ae=1,Ne=this._currentIndex;if(this._skipOptionalSpaces(),this._currentIndex<this._endIndex&&"+"===this._string[this._currentIndex]?this._currentIndex+=1:this._currentIndex<this._endIndex&&"-"===this._string[this._currentIndex]&&(this._currentIndex+=1,_e=-1),this._currentIndex===this._endIndex||(this._string[this._currentIndex]<"0"||"9"<this._string[this._currentIndex])&&"."!==this._string[this._currentIndex])return null;for(var Te=this._currentIndex;this._currentIndex<this._endIndex&&"0"<=this._string[this._currentIndex]&&this._string[this._currentIndex]<="9";)this._currentIndex+=1;if(this._currentIndex!==Te)for(var ge=this._currentIndex-1,ne=1;Te<=ge;)Q+=ne*(this._string[ge]-"0"),ge-=1,ne*=10;if(this._currentIndex<this._endIndex&&"."===this._string[this._currentIndex]){if(this._currentIndex+=1,this._currentIndex>=this._endIndex||this._string[this._currentIndex]<"0"||"9"<this._string[this._currentIndex])return null;for(;this._currentIndex<this._endIndex&&"0"<=this._string[this._currentIndex]&&this._string[this._currentIndex]<="9";)$*=10,se+=(this._string.charAt(this._currentIndex)-"0")/$,this._currentIndex+=1}if(this._currentIndex!==Ne&&this._currentIndex+1<this._endIndex&&("e"===this._string[this._currentIndex]||"E"===this._string[this._currentIndex])&&"x"!==this._string[this._currentIndex+1]&&"m"!==this._string[this._currentIndex+1]){if(this._currentIndex+=1,"+"===this._string[this._currentIndex]?this._currentIndex+=1:"-"===this._string[this._currentIndex]&&(this._currentIndex+=1,Ae=-1),this._currentIndex>=this._endIndex||this._string[this._currentIndex]<"0"||"9"<this._string[this._currentIndex])return null;for(;this._currentIndex<this._endIndex&&"0"<=this._string[this._currentIndex]&&this._string[this._currentIndex]<="9";)G*=10,G+=this._string[this._currentIndex]-"0",this._currentIndex+=1}var ue=Q+se;return ue*=_e,G&&(ue*=Math.pow(10,Ae*G)),Ne===this._currentIndex?null:(this._skipOptionalSpacesOrDelimiter(),ue)},_parseArcFlag:function(){if(this._currentIndex>=this._endIndex)return null;var G=null,Q=this._string[this._currentIndex];if(this._currentIndex+=1,"0"===Q)G=0;else{if("1"!==Q)return null;G=1}return this._skipOptionalSpacesOrDelimiter(),G}};var P=function(G){if(!G||0===G.length)return[];var Q=new C(G),$=[];if(Q.initialCommandIsMoveTo())for(;Q.hasMoreData();){var se=Q.parseSegment();if(null===se)break;$.push(se)}return $},V=_.SVGPathElement.prototype.setAttribute,le=_.SVGPathElement.prototype.removeAttribute,te=_.Symbol?_.Symbol():"__cachedPathData",re=_.Symbol?_.Symbol():"__cachedNormalizedPathData",j=function(G,Q,$,se,_e,Ae,Ne,Te,ge,ne){var oe,ut,ft,rt,q=function(Lt,on,mn){return{x:Lt*Math.cos(mn)-on*Math.sin(mn),y:Lt*Math.sin(mn)+on*Math.cos(mn)}},Ee=Math.PI*Ne/180,I=[];if(ne)oe=ne[0],ut=ne[1],ft=ne[2],rt=ne[3];else{var xe=q(G,Q,-Ee);G=xe.x,Q=xe.y;var Fe=q($,se,-Ee),ct=(G-($=Fe.x))/2,fe=(Q-(se=Fe.y))/2,D=ct*ct/(_e*_e)+fe*fe/(Ae*Ae);1<D&&(_e*=D=Math.sqrt(D),Ae*=D);var H=_e*_e,x=Ae*Ae,de=(Te===ge?-1:1)*Math.sqrt(Math.abs((H*x-H*fe*fe-x*ct*ct)/(H*fe*fe+x*ct*ct)));ft=de*_e*fe/Ae+(G+$)/2,rt=de*-Ae*ct/_e+(Q+se)/2,oe=Math.asin(parseFloat(((Q-rt)/Ae).toFixed(9))),ut=Math.asin(parseFloat(((se-rt)/Ae).toFixed(9))),G<ft&&(oe=Math.PI-oe),$<ft&&(ut=Math.PI-ut),oe<0&&(oe=2*Math.PI+oe),ut<0&&(ut=2*Math.PI+ut),ge&&ut<oe&&(oe-=2*Math.PI),!ge&&oe<ut&&(ut-=2*Math.PI)}var Ye=ut-oe;if(Math.abs(Ye)>120*Math.PI/180){var Qt=ut,Ii=$,kt=se;ut=ge&&oe<ut?oe+120*Math.PI/180*1:oe+120*Math.PI/180*-1,$=ft+_e*Math.cos(ut),se=rt+Ae*Math.sin(ut),I=j($,se,Ii,kt,_e,Ae,Ne,0,ge,[ut,Qt,ft,rt])}Ye=ut-oe;var yt=Math.cos(oe),gt=Math.sin(oe),Gt=Math.cos(ut),mt=Math.sin(ut),Jt=Math.tan(Ye/4),Pn=4/3*_e*Jt,Ut=4/3*Ae*Jt,Ji=[G,Q],Ui=[G+Pn*gt,Q-Ut*yt],Li=[$+Pn*mt,se-Ut*Gt],An=[$,se];if(Ui[0]=2*Ji[0]-Ui[0],Ui[1]=2*Ji[1]-Ui[1],ne)return[Ui,Li,An].concat(I);I=[Ui,Li,An].concat(I).join().split(",");var ve=[],Dt=[];return I.forEach(function(Lt,on){Dt.push(on%2?q(I[on-1],I[on],Ee).y:q(I[on],I[on+1],Ee).x),6===Dt.length&&(ve.push(Dt),Dt=[])}),ve},ee=function(G){return G.map(function(Q){return{type:Q.type,values:Array.prototype.slice.call(Q.values)}})},ye=function(G){var Q=[],$=null,se=null,_e=null,Ae=null,Ne=null,Te=null,ge=null;return G.forEach(function(ne){if("M"===ne.type){var ue=ne.values[0],oe=ne.values[1];Q.push({type:"M",values:[ue,oe]}),Ae=Te=ue,Ne=ge=oe}else if("C"===ne.type){var ut=ne.values[0],ft=ne.values[1],rt=ne.values[2],q=ne.values[3];Q.push({type:"C",values:[ut,ft,rt,q,ue=ne.values[4],oe=ne.values[5]]}),se=rt,_e=q,Ae=ue,Ne=oe}else if("L"===ne.type)Q.push({type:"L",values:[ue=ne.values[0],oe=ne.values[1]]}),Ae=ue,Ne=oe;else if("H"===ne.type)Q.push({type:"L",values:[ue=ne.values[0],Ne]}),Ae=ue;else if("V"===ne.type)Q.push({type:"L",values:[Ae,oe=ne.values[0]]}),Ne=oe;else if("S"===ne.type)"C"===$||"S"===$?(Ee=Ae+(Ae-se),I=Ne+(Ne-_e)):(Ee=Ae,I=Ne),Q.push({type:"C",values:[Ee,I,rt=ne.values[0],q=ne.values[1],ue=ne.values[2],oe=ne.values[3]]}),se=rt,_e=q,Ae=ue,Ne=oe;else if("T"===ne.type){"Q"===$||"T"===$?(ut=Ae+(Ae-se),ft=Ne+(Ne-_e)):(ut=Ae,ft=Ne);var Ee=Ae+2*(ut-Ae)/3,I=Ne+2*(ft-Ne)/3,xe=(ue=ne.values[0])+2*(ut-ue)/3,Fe=(oe=ne.values[1])+2*(ft-oe)/3;Q.push({type:"C",values:[Ee,I,xe,Fe,ue,oe]}),se=ut,_e=ft,Ae=ue,Ne=oe}else if("Q"===ne.type)Q.push({type:"C",values:[Ee=Ae+2*((ut=ne.values[0])-Ae)/3,I=Ne+2*((ft=ne.values[1])-Ne)/3,xe=(ue=ne.values[2])+2*(ut-ue)/3,Fe=(oe=ne.values[3])+2*(ft-oe)/3,ue,oe]}),se=ut,_e=ft,Ae=ue,Ne=oe;else if("A"===ne.type){var ct=ne.values[0],fe=ne.values[1],D=ne.values[2],H=ne.values[3],x=ne.values[4];ue=ne.values[5],oe=ne.values[6],0===ct||0===fe?(Q.push({type:"C",values:[Ae,Ne,ue,oe,ue,oe]}),Ae=ue,Ne=oe):(Ae!==ue||Ne!==oe)&&j(Ae,Ne,ue,oe,ct,fe,D,H,x).forEach(function(k){Q.push({type:"C",values:k}),Ae=ue,Ne=oe})}else"Z"===ne.type&&(Q.push(ne),Ae=Te,Ne=ge);$=ne.type}),Q};_.SVGPathElement.prototype.setAttribute=function(G,Q){"d"===G&&(this[te]=null,this[re]=null),V.call(this,G,Q)},_.SVGPathElement.prototype.removeAttribute=function(G,Q){"d"===G&&(this[te]=null,this[re]=null),le.call(this,G)},_.SVGPathElement.prototype.getPathData=function(G){if(G&&G.normalize){if(this[re])return ee(this[re]);this[te]?Te=ee(this[te]):(Te=P(this.getAttribute("d")||""),this[te]=ee(Te));var Q=ye(($=[],Ne=Ae=_e=se=null,Te.forEach(function(ge){var ne=ge.type;if("M"===ne){var ue=ge.values[0],oe=ge.values[1];$.push({type:"M",values:[ue,oe]}),se=Ae=ue,_e=Ne=oe}else if("m"===ne)$.push({type:"M",values:[ue=se+ge.values[0],oe=_e+ge.values[1]]}),se=Ae=ue,_e=Ne=oe;else if("L"===ne)$.push({type:"L",values:[ue=ge.values[0],oe=ge.values[1]]}),se=ue,_e=oe;else if("l"===ne)$.push({type:"L",values:[ue=se+ge.values[0],oe=_e+ge.values[1]]}),se=ue,_e=oe;else if("C"===ne){var ut=ge.values[0],ft=ge.values[1],rt=ge.values[2],q=ge.values[3];$.push({type:"C",values:[ut,ft,rt,q,ue=ge.values[4],oe=ge.values[5]]}),se=ue,_e=oe}else"c"===ne?($.push({type:"C",values:[ut=se+ge.values[0],ft=_e+ge.values[1],rt=se+ge.values[2],q=_e+ge.values[3],ue=se+ge.values[4],oe=_e+ge.values[5]]}),se=ue,_e=oe):"Q"===ne?($.push({type:"Q",values:[ut=ge.values[0],ft=ge.values[1],ue=ge.values[2],oe=ge.values[3]]}),se=ue,_e=oe):"q"===ne?($.push({type:"Q",values:[ut=se+ge.values[0],ft=_e+ge.values[1],ue=se+ge.values[2],oe=_e+ge.values[3]]}),se=ue,_e=oe):"A"===ne?($.push({type:"A",values:[ge.values[0],ge.values[1],ge.values[2],ge.values[3],ge.values[4],ue=ge.values[5],oe=ge.values[6]]}),se=ue,_e=oe):"a"===ne?($.push({type:"A",values:[ge.values[0],ge.values[1],ge.values[2],ge.values[3],ge.values[4],ue=se+ge.values[5],oe=_e+ge.values[6]]}),se=ue,_e=oe):"H"===ne?($.push({type:"H",values:[ue=ge.values[0]]}),se=ue):"h"===ne?($.push({type:"H",values:[ue=se+ge.values[0]]}),se=ue):"V"===ne?($.push({type:"V",values:[oe=ge.values[0]]}),_e=oe):"v"===ne?($.push({type:"V",values:[oe=_e+ge.values[0]]}),_e=oe):"S"===ne?($.push({type:"S",values:[rt=ge.values[0],q=ge.values[1],ue=ge.values[2],oe=ge.values[3]]}),se=ue,_e=oe):"s"===ne?($.push({type:"S",values:[rt=se+ge.values[0],q=_e+ge.values[1],ue=se+ge.values[2],oe=_e+ge.values[3]]}),se=ue,_e=oe):"T"===ne?($.push({type:"T",values:[ue=ge.values[0],oe=ge.values[1]]}),se=ue,_e=oe):"t"===ne?($.push({type:"T",values:[ue=se+ge.values[0],oe=_e+ge.values[1]]}),se=ue,_e=oe):"Z"!==ne&&"z"!==ne||($.push({type:"Z",values:[]}),se=Ae,_e=Ne)}),$));return this[re]=ee(Q),Q}if(this[te])return ee(this[te]);var $,se,_e,Ae,Ne,Te=P(this.getAttribute("d")||"");return this[te]=ee(Te),Te},_.SVGPathElement.prototype.setPathData=function(G){if(0===G.length)T?this.setAttribute("d",""):this.removeAttribute("d");else{for(var Q="",$=0,se=G.length;$<se;$+=1){var _e=G[$];0<$&&(Q+=" "),Q+=_e.type,_e.values&&0<_e.values.length&&(Q+=" "+_e.values.join(" "))}this.setAttribute("d",Q)}},_.SVGRectElement.prototype.getPathData=function(G){var Q=this.x.baseVal.value,$=this.y.baseVal.value,se=this.width.baseVal.value,_e=this.height.baseVal.value,Ae=this.hasAttribute("rx")?this.rx.baseVal.value:this.ry.baseVal.value,Ne=this.hasAttribute("ry")?this.ry.baseVal.value:this.rx.baseVal.value;se/2<Ae&&(Ae=se/2),_e/2<Ne&&(Ne=_e/2);var Te=[{type:"M",values:[Q+Ae,$]},{type:"H",values:[Q+se-Ae]},{type:"A",values:[Ae,Ne,0,0,1,Q+se,$+Ne]},{type:"V",values:[$+_e-Ne]},{type:"A",values:[Ae,Ne,0,0,1,Q+se-Ae,$+_e]},{type:"H",values:[Q+Ae]},{type:"A",values:[Ae,Ne,0,0,1,Q,$+_e-Ne]},{type:"V",values:[$+Ne]},{type:"A",values:[Ae,Ne,0,0,1,Q+Ae,$]},{type:"Z",values:[]}];return Te=Te.filter(function(ge){return"A"!==ge.type||0!==ge.values[0]&&0!==ge.values[1]}),G&&!0===G.normalize&&(Te=ye(Te)),Te},_.SVGCircleElement.prototype.getPathData=function(G){var Q=this.cx.baseVal.value,$=this.cy.baseVal.value,se=this.r.baseVal.value,_e=[{type:"M",values:[Q+se,$]},{type:"A",values:[se,se,0,0,1,Q,$+se]},{type:"A",values:[se,se,0,0,1,Q-se,$]},{type:"A",values:[se,se,0,0,1,Q,$-se]},{type:"A",values:[se,se,0,0,1,Q+se,$]},{type:"Z",values:[]}];return G&&!0===G.normalize&&(_e=ye(_e)),_e},_.SVGEllipseElement.prototype.getPathData=function(G){var Q=this.cx.baseVal.value,$=this.cy.baseVal.value,se=this.rx.baseVal.value,_e=this.ry.baseVal.value,Ae=[{type:"M",values:[Q+se,$]},{type:"A",values:[se,_e,0,0,1,Q,$+_e]},{type:"A",values:[se,_e,0,0,1,Q-se,$]},{type:"A",values:[se,_e,0,0,1,Q,$-_e]},{type:"A",values:[se,_e,0,0,1,Q+se,$]},{type:"Z",values:[]}];return G&&!0===G.normalize&&(Ae=ye(Ae)),Ae},_.SVGLineElement.prototype.getPathData=function(){return[{type:"M",values:[this.x1.baseVal.value,this.y1.baseVal.value]},{type:"L",values:[this.x2.baseVal.value,this.y2.baseVal.value]}]},_.SVGPolylineElement.prototype.getPathData=function(){for(var G=[],Q=0;Q<this.points.numberOfItems;Q+=1){var $=this.points.getItem(Q);G.push({type:0===Q?"M":"L",values:[$.x,$.y]})}return G},_.SVGPolygonElement.prototype.getPathData=function(){for(var G=[],Q=0;Q<this.points.numberOfItems;Q+=1){var $=this.points.getItem(Q);G.push({type:0===Q?"M":"L",values:[$.x,$.y]})}return G.push({type:"Z",values:[]}),G}}()}(_))}function Kr(_,A){A!==_.isShown&&(!!A!=!!_.isShown&&(_.svg.style.visibility=A?"":"hidden"),_.isShown=A,_.events&&_.events.svgShow&&_.events.svgShow.forEach(function(C){C(_,A)}))}function mi(_,A){var C,T,P,V,le,te,re,j,ee,ye,G,Q,$,se,_e,Ae,Ne,Te,ge,ne,ue,oe,ut,ft,rt,q,Ee,I,xe,Fe,ct,fe,D,H,x,k,de,Ye,Qt,Ii,kt,yt,gt,Gt,mt,Jt,Pn,Ut,Ji,Ui,Li,An={};A.line&&(An.line=(T=(C=_).options,le=!1,le=dt(C,P=C.curStats,"line_color",T.lineColor,(V=C.events).cur_line_color)||le,le=dt(C,P,"line_colorTra",rr(P.line_color)[0]<1)||le,le=dt(C,P,"line_strokeWidth",T.lineSize,V.cur_line_strokeWidth)||le)),(A.plug||An.line)&&(An.plug=(re=(te=_).options,j=te.curStats,ee=te.events,ye=!1,[0,1].forEach(function(ve){var Dt,Lt,on,mn,Ar,ms,ki,go,vi=re.plugSE[ve];ye=dt(te,j.plug_enabledSE,ve,vi!==Jn)||ye,ye=dt(te,j.plug_plugSE,ve,vi)||ye,ye=dt(te,j.plug_colorSE,ve,go=re.plugColorSE[ve]||j.line_color,ee.cur_plug_colorSE)||ye,ye=dt(te,j.plug_colorTraSE,ve,rr(go)[0]<1)||ye,vi!==Jn&&(mn=Lt=(Dt=Sr[bi[vi]]).widthR*re.plugSizeSE[ve],Ar=on=Dt.heightR*re.plugSizeSE[ve],Sn&&(mn*=j.line_strokeWidth,Ar*=j.line_strokeWidth),ye=dt(te,j.plug_markerWidthSE,ve,mn)||ye,ye=dt(te,j.plug_markerHeightSE,ve,Ar)||ye,j.capsMaskMarker_markerWidthSE[ve]=Lt,j.capsMaskMarker_markerHeightSE[ve]=on),j.plugOutline_plugSE[ve]=j.capsMaskMarker_plugSE[ve]=vi,j.plug_enabledSE[ve]?(j.position_plugOverheadSE[ve]=Dt.overhead*(go=j.line_strokeWidth/Qn.lineSize*re.plugSizeSE[ve]),j.viewBox_plugBCircleSE[ve]=Dt.bCircle*go,ms=Dt.sideLen*go,ki=Dt.backLen*go):(j.position_plugOverheadSE[ve]=-j.line_strokeWidth/2,j.viewBox_plugBCircleSE[ve]=ms=ki=0),dt(te,j.attach_plugSideLenSE,ve,ms,ee.cur_attach_plugSideLenSE),dt(te,j.attach_plugBackLenSE,ve,ki,ee.cur_attach_plugBackLenSE),j.capsMaskAnchor_enabledSE[ve]=!j.plug_enabledSE[ve]}),ye=dt(te,j,"plug_enabled",j.plug_enabledSE[0]||j.plug_enabledSE[1])||ye)),(A.lineOutline||An.line)&&(An.lineOutline=($=(G=_).options,_e=!1,_e=dt(G,se=G.curStats,"lineOutline_enabled",$.lineOutlineEnabled)||_e,_e=dt(G,se,"lineOutline_color",$.lineOutlineColor)||_e,_e=dt(G,se,"lineOutline_colorTra",rr(se.lineOutline_color)[0]<1)||_e,_e=dt(G,se,"lineOutline_strokeWidth",se.line_strokeWidth-2*(Q=se.line_strokeWidth*$.lineOutlineSize))||_e,_e=dt(G,se,"lineOutline_inStrokeWidth",se.lineOutline_colorTra?se.lineOutline_strokeWidth+2*Ei:se.line_strokeWidth-Q)||_e)),(A.plugOutline||An.line||An.plug||An.lineOutline)&&(An.plugOutline=(Ne=(Ae=_).options,Te=Ae.curStats,ge=!1,[0,1].forEach(function(ve){var Dt,Lt=Te.plugOutline_plugSE[ve],on=Lt!==Jn?Sr[bi[Lt]]:null;ge=dt(Ae,Te.plugOutline_enabledSE,ve,Ne.plugOutlineEnabledSE[ve]&&Te.plug_enabled&&Te.plug_enabledSE[ve]&&!!on&&!!on.outlineBase)||ge,ge=dt(Ae,Te.plugOutline_colorSE,ve,Dt=Ne.plugOutlineColorSE[ve]||Te.lineOutline_color)||ge,ge=dt(Ae,Te.plugOutline_colorTraSE,ve,rr(Dt)[0]<1)||ge,on&&on.outlineBase&&((Dt=Ne.plugOutlineSizeSE[ve])>on.outlineMax&&(Dt=on.outlineMax),ge=dt(Ae,Te.plugOutline_strokeWidthSE,ve,Dt*=2*on.outlineBase)||ge,ge=dt(Ae,Te.plugOutline_inStrokeWidthSE,ve,Te.plugOutline_colorTraSE[ve]?Dt-Ei/(Te.line_strokeWidth/Qn.lineSize)/Ne.plugSizeSE[ve]*2:Dt/2)||ge)}),ge)),(A.faces||An.line||An.plug||An.lineOutline||An.plugOutline)&&(An.faces=(oe=(ne=_).curStats,ut=ne.aplStats,ft=ne.events,rt=!1,!oe.line_altColor&&dt(ne,ut,"line_color",ue=oe.line_color,ft.apl_line_color)&&(ne.lineFace.style.stroke=ue,rt=!0),dt(ne,ut,"line_strokeWidth",ue=oe.line_strokeWidth,ft.apl_line_strokeWidth)&&(ne.lineShape.style.strokeWidth=ue+"px",rt=!0,(En||Xt)&&(hn(ne,ne.lineShape),Xt&&(hn(ne,ne.lineFace),hn(ne,ne.lineMaskCaps)))),dt(ne,ut,"lineOutline_enabled",ue=oe.lineOutline_enabled,ft.apl_lineOutline_enabled)&&(ne.lineOutlineFace.style.display=ue?"inline":"none",rt=!0),oe.lineOutline_enabled&&(dt(ne,ut,"lineOutline_color",ue=oe.lineOutline_color,ft.apl_lineOutline_color)&&(ne.lineOutlineFace.style.stroke=ue,rt=!0),dt(ne,ut,"lineOutline_strokeWidth",ue=oe.lineOutline_strokeWidth,ft.apl_lineOutline_strokeWidth)&&(ne.lineOutlineMaskShape.style.strokeWidth=ue+"px",rt=!0,Xt&&(hn(ne,ne.lineOutlineMaskCaps),hn(ne,ne.lineOutlineFace))),dt(ne,ut,"lineOutline_inStrokeWidth",ue=oe.lineOutline_inStrokeWidth,ft.apl_lineOutline_inStrokeWidth)&&(ne.lineMaskShape.style.strokeWidth=ue+"px",rt=!0,Xt&&(hn(ne,ne.lineOutlineMaskCaps),hn(ne,ne.lineOutlineFace)))),dt(ne,ut,"plug_enabled",ue=oe.plug_enabled,ft.apl_plug_enabled)&&(ne.plugsFace.style.display=ue?"inline":"none",rt=!0),oe.plug_enabled&&[0,1].forEach(function(ve){var Dt=oe.plug_plugSE[ve],Lt=Dt!==Jn?Sr[bi[Dt]]:null,on=ta(ve,Lt);dt(ne,ut.plug_enabledSE,ve,ue=oe.plug_enabledSE[ve],ft.apl_plug_enabledSE)&&(ne.plugsFace.style[on.prop]=ue?"url(#"+ne.plugMarkerIdSE[ve]+")":"none",rt=!0),oe.plug_enabledSE[ve]&&(dt(ne,ut.plug_plugSE,ve,Dt,ft.apl_plug_plugSE)&&(ne.plugFaceSE[ve].href.baseVal="#"+Lt.elmId,ea(ne,ne.plugMarkerSE[ve],on.orient,Lt.bBox,ne.svg,ne.plugMarkerShapeSE[ve],ne.plugsFace),rt=!0,En&&hn(ne,ne.plugsFace)),dt(ne,ut.plug_colorSE,ve,ue=oe.plug_colorSE[ve],ft.apl_plug_colorSE)&&(ne.plugFaceSE[ve].style.fill=ue,rt=!0,(Ht||Sn||Xt)&&!oe.line_colorTra&&hn(ne,Xt?ne.lineMaskCaps:ne.capsMaskLine)),["markerWidth","markerHeight"].forEach(function(mn){var Ar="plug_"+mn+"SE";dt(ne,ut[Ar],ve,ue=oe[Ar][ve],ft["apl_"+Ar])&&(ne.plugMarkerSE[ve][mn].baseVal.value=ue,rt=!0)}),dt(ne,ut.plugOutline_enabledSE,ve,ue=oe.plugOutline_enabledSE[ve],ft.apl_plugOutline_enabledSE)&&(ue?(ne.plugFaceSE[ve].style.mask="url(#"+ne.plugMaskIdSE[ve]+")",ne.plugOutlineFaceSE[ve].style.display="inline"):(ne.plugFaceSE[ve].style.mask="none",ne.plugOutlineFaceSE[ve].style.display="none"),rt=!0),oe.plugOutline_enabledSE[ve]&&(dt(ne,ut.plugOutline_plugSE,ve,Dt,ft.apl_plugOutline_plugSE)&&(ne.plugOutlineFaceSE[ve].href.baseVal=ne.plugMaskShapeSE[ve].href.baseVal=ne.plugOutlineMaskShapeSE[ve].href.baseVal="#"+Lt.elmId,[ne.plugMaskSE[ve],ne.plugOutlineMaskSE[ve]].forEach(function(mn){mn.x.baseVal.value=Lt.bBox.left,mn.y.baseVal.value=Lt.bBox.top,mn.width.baseVal.value=Lt.bBox.width,mn.height.baseVal.value=Lt.bBox.height}),rt=!0),dt(ne,ut.plugOutline_colorSE,ve,ue=oe.plugOutline_colorSE[ve],ft.apl_plugOutline_colorSE)&&(ne.plugOutlineFaceSE[ve].style.fill=ue,rt=!0,Xt&&(hn(ne,ne.lineMaskCaps),hn(ne,ne.lineOutlineMaskCaps))),dt(ne,ut.plugOutline_strokeWidthSE,ve,ue=oe.plugOutline_strokeWidthSE[ve],ft.apl_plugOutline_strokeWidthSE)&&(ne.plugOutlineMaskShapeSE[ve].style.strokeWidth=ue+"px",rt=!0),dt(ne,ut.plugOutline_inStrokeWidthSE,ve,ue=oe.plugOutline_inStrokeWidthSE[ve],ft.apl_plugOutline_inStrokeWidthSE)&&(ne.plugMaskShapeSE[ve].style.strokeWidth=ue+"px",rt=!0)))}),rt)),(A.position||An.line||An.plug)&&(An.position=function(_){var A,C,T,P,V,le,te,re,j,ee,ye,Q,$,se,_e,Ae,Ne,Te,ge=_.options,ne=_.curStats,ue=_.aplStats,oe=ne.position_socketXYSE,ut=!1;function ft(q,Ee){var I=1===Ee?{x:q.left+q.width/2,y:q.top}:2===Ee?{x:q.right,y:q.top+q.height/2}:3===Ee?{x:q.left+q.width/2,y:q.bottom}:{x:q.left,y:q.top+q.height/2};return I.socketId=Ee,I}function rt(q){return{x:q.x,y:q.y}}if(ne.position_path=ge.path,ne.position_lineStrokeWidth=ne.line_strokeWidth,ne.position_socketGravitySE=A=Si(ge.socketGravitySE),C=[0,1].map(function(q){var Ee,I,xe,Fe=ge.anchorSE[q],ct=_.optionIsAttach.anchorSE[q],fe=!1!==ct?qn[Fe._id]:null,D=!1!==ct&&fe.conf.getStrokeWidth?fe.conf.getStrokeWidth(fe,_):0,H=!1!==ct&&fe.conf.getBBoxNest?fe.conf.getBBoxNest(fe,_,D):Lo(Fe,_.baseWindow);return ne.capsMaskAnchor_pathDataSE[q]=!1!==ct&&fe.conf.getPathData?fe.conf.getPathData(fe,_,D):(I=null!=(Ee=H).right?Ee.right:Ee.left+Ee.width,[{type:"M",values:[Ee.left,Ee.top]},{type:"L",values:[I,Ee.top]},{type:"L",values:[I,xe=null!=Ee.bottom?Ee.bottom:Ee.top+Ee.height]},{type:"L",values:[Ee.left,xe]},{type:"Z",values:[]}]),ne.capsMaskAnchor_strokeWidthSE[q]=D,H}),te=-1,ge.socketSE[0]&&ge.socketSE[1]?(oe[0]=ft(C[0],ge.socketSE[0]),oe[1]=ft(C[1],ge.socketSE[1])):(ge.socketSE[0]||ge.socketSE[1]?(ge.socketSE[0]?(V=0,le=1):(V=1,le=0),oe[V]=ft(C[V],ge.socketSE[V]),(P=Xr.map(function(q){return ft(C[le],q)})).forEach(function(q){var Ee=Kn(q,oe[V]);(Ee<te||-1===te)&&(oe[le]=q,te=Ee)})):(P=Xr.map(function(q){return ft(C[1],q)}),Xr.map(function(q){return ft(C[0],q)}).forEach(function(q){P.forEach(function(Ee){var I=Kn(q,Ee);(I<te||-1===te)&&(oe[0]=q,oe[1]=Ee,te=I)})})),[0,1].forEach(function(q){var Ee,I;ge.socketSE[q]||(C[q].width||C[q].height?C[q].width||4!==oe[q].socketId&&2!==oe[q].socketId?C[q].height||1!==oe[q].socketId&&3!==oe[q].socketId||(oe[q].socketId=0<=oe[q?0:1].y-C[q].top?3:1):oe[q].socketId=0<=oe[q?0:1].x-C[q].left?2:4:(Ee=oe[q?0:1].x-C[q].left,I=oe[q?0:1].y-C[q].top,oe[q].socketId=Math.abs(Ee)>=Math.abs(I)?0<=Ee?2:4:0<=I?3:1))})),ne.position_path!==ue.position_path||ne.position_lineStrokeWidth!==ue.position_lineStrokeWidth||[0,1].some(function(q){return ne.position_plugOverheadSE[q]!==ue.position_plugOverheadSE[q]||(Fe=oe[q]).x!==(ct=ue.position_socketXYSE[q]).x||Fe.y!==ct.y||Fe.socketId!==ct.socketId||(I=ue.position_socketGravitySE[q],(xe=null==(Ee=A[q])?"auto":Array.isArray(Ee)?"array":"number")!=(null==I?"auto":Array.isArray(I)?"array":"number")||("array"===xe?Ee[0]!==I[0]||Ee[1]!==I[1]:Ee!==I));var Ee,I,xe,Fe,ct})){switch(_.pathList.baseVal=T=[],_.pathList.animVal=null,ne.position_path){case 1:T.push([rt(oe[0]),rt(oe[1])]);break;case 2:Q=Qr*("number"==typeof A[0]&&0<A[0]||"number"==typeof A[1]&&0<A[1]?-1:1),se=-($=Math.atan2(oe[1].y-oe[0].y,oe[1].x-oe[0].x))+Q,_e=Math.PI-$-Q,Ae=Kn(oe[0],oe[1])/Math.sqrt(2)*Jr,Ne={x:oe[0].x+Math.cos(se)*Ae,y:oe[0].y+Math.sin(se)*Ae*-1},Te={x:oe[1].x+Math.cos(_e)*Ae,y:oe[1].y+Math.sin(_e)*Ae*-1},T.push([rt(oe[0]),Ne,Te,rt(oe[1])]);break;case 3:case 4:j=[A[0],4===ne.position_path?0:A[1]],ee=[],ye=[],oe.forEach(function(q,Ee){var I,xe,Fe,ct,fe,D=j[Ee];Array.isArray(D)?I={x:D[0],y:D[1]}:"number"==typeof D?I=1===q.socketId?{x:0,y:-D}:2===q.socketId?{x:D,y:0}:3===q.socketId?{x:0,y:D}:{x:-D,y:0}:(xe=oe[Ee?0:1],ct=0<(Fe=ne.position_plugOverheadSE[Ee])?120+(8<Fe?3.75*(Fe-8):0):80+(ne.position_lineStrokeWidth>4?5*(ne.position_lineStrokeWidth-4):0),1===q.socketId?((fe=(q.y-xe.y)/2)<ct&&(fe=ct),I={x:0,y:-fe}):2===q.socketId?((fe=(xe.x-q.x)/2)<ct&&(fe=ct),I={x:fe,y:0}):3===q.socketId?((fe=(xe.y-q.y)/2)<ct&&(fe=ct),I={x:0,y:fe}):((fe=(q.x-xe.x)/2)<ct&&(fe=ct),I={x:-fe,y:0})),ee[Ee]=q.x+I.x,ye[Ee]=q.y+I.y}),T.push([rt(oe[0]),{x:ee[0],y:ye[0]},{x:ee[1],y:ye[1]},rt(oe[1])]);break;case 5:!function(){var q,ct=[[],[]],fe=[];function D(kt){return 1===kt?3:2===kt?4:3===kt?1:2}function H(kt){return 2===kt||4===kt?"x":"y"}function x(kt,yt,gt){var Gt={x:kt.x,y:kt.y};if(gt){if(gt===D(kt.dirId))throw new Error("Invalid dirId: "+gt);Gt.dirId=gt}else Gt.dirId=kt.dirId;return 1===Gt.dirId?Gt.y-=yt:2===Gt.dirId?Gt.x+=yt:3===Gt.dirId?Gt.y+=yt:Gt.x-=yt,Gt}function k(kt,yt){return 1===yt.dirId?kt.y<=yt.y:2===yt.dirId?kt.x>=yt.x:3===yt.dirId?kt.y>=yt.y:kt.x<=yt.x}function R(kt,yt){return 1===yt.dirId||3===yt.dirId?kt.x===yt.x:kt.y===yt.y}function de(kt){return kt[0]?{contain:0,notContain:1}:{contain:1,notContain:0}}function Ye(kt,yt,gt){return Math.abs(yt[gt]-kt[gt])}function Qt(kt,yt,gt){return"x"===gt?kt.x<yt.x?2:4:kt.y<yt.y?3:1}function Ii(){var kt,yt,gt,Gt,mt=[k(fe[1],fe[0]),k(fe[0],fe[1])],Jt=[H(fe[0].dirId),H(fe[1].dirId)];if(Jt[0]===Jt[1]){if(mt[0]&&mt[1])return R(fe[1],fe[0])||(fe[0][Jt[0]]===fe[1][Jt[1]]?(ct[0].push(fe[0]),ct[1].push(fe[1])):(kt=fe[0][Jt[0]]+(fe[1][Jt[1]]-fe[0][Jt[0]])/2,ct[0].push(x(fe[0],Math.abs(kt-fe[0][Jt[0]]))),ct[1].push(x(fe[1],Math.abs(kt-fe[1][Jt[1]]))))),!1;mt[0]!==mt[1]?(yt=de(mt),(gt=Ye(fe[yt.notContain],fe[yt.contain],Jt[yt.notContain]))<30&&(fe[yt.notContain]=x(fe[yt.notContain],30-gt)),ct[yt.notContain].push(fe[yt.notContain]),fe[yt.notContain]=x(fe[yt.notContain],30,R(fe[yt.contain],fe[yt.notContain])?"x"===Jt[yt.notContain]?3:2:Qt(fe[yt.notContain],fe[yt.contain],"x"===Jt[yt.notContain]?"y":"x"))):(gt=Ye(fe[0],fe[1],"x"===Jt[0]?"y":"x"),ct.forEach(function(Pn,Ut){var Ji=0===Ut?1:0;Pn.push(fe[Ut]),fe[Ut]=x(fe[Ut],30,60<=gt?Qt(fe[Ut],fe[Ji],"x"===Jt[Ut]?"y":"x"):"x"===Jt[Ut]?3:2)}))}else{if(mt[0]&&mt[1])return R(fe[1],fe[0])?ct[1].push(fe[1]):R(fe[0],fe[1])?ct[0].push(fe[0]):ct[0].push("x"===Jt[0]?{x:fe[1].x,y:fe[0].y}:{x:fe[0].x,y:fe[1].y}),!1;mt[0]!==mt[1]?(yt=de(mt),ct[yt.notContain].push(fe[yt.notContain]),fe[yt.notContain]=x(fe[yt.notContain],30,Ye(fe[yt.notContain],fe[yt.contain],Jt[yt.contain])>=30?Qt(fe[yt.notContain],fe[yt.contain],Jt[yt.contain]):fe[yt.contain].dirId)):(Gt=[{x:fe[0].x,y:fe[0].y},{x:fe[1].x,y:fe[1].y}],ct.forEach(function(Pn,Ut){var Ji=0===Ut?1:0,Ui=Ye(Gt[Ut],Gt[Ji],Jt[Ut]);Ui<30&&(fe[Ut]=x(fe[Ut],30-Ui)),Pn.push(fe[Ut]),fe[Ut]=x(fe[Ut],30,Qt(fe[Ut],fe[Ji],Jt[Ji]))}))}return!0}for(oe.forEach(function(kt,yt){var gt,Gt=rt(kt),mt=A[yt];gt=Array.isArray(mt)?mt[0]<0?[4,-mt[0]]:0<mt[0]?[2,mt[0]]:mt[1]<0?[1,-mt[1]]:0<mt[1]?[3,mt[1]]:[kt.socketId,0]:"number"!=typeof mt?[kt.socketId,30]:0<=mt?[kt.socketId,mt]:[D(kt.socketId),-mt],Gt.dirId=gt[0],mt=gt[1],ct[yt].push(Gt),fe[yt]=x(Gt,mt)});Ii(););ct[1].reverse(),ct[0].concat(ct[1]).forEach(function(kt,yt){var gt={x:kt.x,y:kt.y};0<yt&&T.push([q,gt]),q=gt})}()}re=[],ne.position_plugOverheadSE.forEach(function(q,Ee){var I,xe,Fe,ct,fe,D,H,x,k,R,de,Ye=!Ee;0<q?2===(I=T[xe=Ye?0:T.length-1]).length?(re[xe]=re[xe]||Kn.apply(null,I),re[xe]>10&&(re[xe]-q<10&&(q=re[xe]-10),Fe=Fo(I[0],I[1],(Ye?q:re[xe]-q)/re[xe]),T[xe]=Ye?[Fe,I[1]]:[I[0],Fe],re[xe]-=q)):(re[xe]=re[xe]||fo.apply(null,I),re[xe]>10&&(re[xe]-q<10&&(q=re[xe]-10),Fe=Bi(I[0],I[1],I[2],I[3],Vi(I[0],I[1],I[2],I[3],Ye?q:re[xe]-q)),Ye?(ct=I[0],fe=Fe.toP1):(ct=I[3],fe=Fe.fromP2),D=Math.atan2(ct.y-Fe.y,Fe.x-ct.x),H=Kn(Fe,fe),Fe.x=ct.x+Math.cos(D)*q,Fe.y=ct.y+Math.sin(D)*q*-1,fe.x=Fe.x+Math.cos(D)*H,fe.y=Fe.y+Math.sin(D)*H*-1,T[xe]=Ye?[Fe,Fe.toP1,Fe.toP2,I[3]]:[I[0],Fe.fromP1,Fe.fromP2,Fe],re[xe]=null)):q<0&&(I=T[xe=Ye?0:T.length-1],q<(de=-C[Ee]["x"==(k=4===(x=oe[Ee].socketId)||2===x?"x":"y")?"width":"height"])&&(q=de),R=q*(4===x||1===x?-1:1),2===I.length?I[Ye?0:I.length-1][k]+=R:(Ye?[0,1]:[I.length-2,I.length-1]).forEach(function(Qt){I[Qt][k]+=R}),re[xe]=null)}),ue.position_socketXYSE=Si(oe),ue.position_plugOverheadSE=Si(ne.position_plugOverheadSE),ue.position_path=ne.position_path,ue.position_lineStrokeWidth=ne.position_lineStrokeWidth,ue.position_socketGravitySE=Si(A),ut=!0,_.events.apl_position&&_.events.apl_position.forEach(function(q){q(_,T)})}return ut}(_)),(A.path||An.position)&&(An.path=(I=(q=_).curStats,xe=q.aplStats,ct=I.path_edge,fe=!1,(Fe=q.pathList.animVal||q.pathList.baseVal)&&(ct.x1=ct.x2=Fe[0][0].x,ct.y1=ct.y2=Fe[0][0].y,I.path_pathData=Ee=_i(Fe,function(ve){ve.x<ct.x1&&(ct.x1=ve.x),ve.y<ct.y1&&(ct.y1=ve.y),ve.x>ct.x2&&(ct.x2=ve.x),ve.y>ct.y2&&(ct.y2=ve.y)}),Fn(Ee,xe.path_pathData)&&(q.linePath.setPathData(Ee),xe.path_pathData=Ee,fe=!0,Xt?(hn(q,q.plugsFace),hn(q,q.lineMaskCaps)):En&&hn(q,q.linePath),q.events.apl_path&&q.events.apl_path.forEach(function(ve){ve(q,Ee)}))),fe)),An.viewBox=(de=(k=(D=_).curStats).path_edge,Ye=k.viewBox_bBox,Qt=D.aplStats.viewBox_bBox,Ii=D.svg.viewBox.baseVal,kt=D.svg.style,yt=!1,H=Math.max(k.line_strokeWidth/2,k.viewBox_plugBCircleSE[0]||0,k.viewBox_plugBCircleSE[1]||0),x={x1:de.x1-H,y1:de.y1-H,x2:de.x2+H,y2:de.y2+H},D.events.new_edge4viewBox&&D.events.new_edge4viewBox.forEach(function(ve){ve(D,x)}),Ye.x=k.lineMask_x=k.lineOutlineMask_x=k.maskBGRect_x=x.x1,Ye.y=k.lineMask_y=k.lineOutlineMask_y=k.maskBGRect_y=x.y1,Ye.width=x.x2-x.x1,Ye.height=x.y2-x.y1,["x","y","width","height"].forEach(function(ve){var Dt;(Dt=Ye[ve])!==Qt[ve]&&(Ii[ve]=Qt[ve]=Dt,kt[li[ve]]=Dt+("x"===ve||"y"===ve?D.bodyOffset[ve]:0)+"px",yt=!0)}),yt),An.mask=(mt=(gt=_).curStats,Jt=gt.aplStats,Pn=!1,mt.plug_enabled?[0,1].forEach(function(ve){mt.capsMaskMarker_enabledSE[ve]=mt.plug_enabledSE[ve]&&mt.plug_colorTraSE[ve]||mt.plugOutline_enabledSE[ve]&&mt.plugOutline_colorTraSE[ve]}):mt.capsMaskMarker_enabledSE[0]=mt.capsMaskMarker_enabledSE[1]=!1,mt.capsMaskMarker_enabled=mt.capsMaskMarker_enabledSE[0]||mt.capsMaskMarker_enabledSE[1],mt.lineMask_outlineMode=mt.lineOutline_enabled,mt.caps_enabled=mt.capsMaskMarker_enabled||mt.capsMaskAnchor_enabledSE[0]||mt.capsMaskAnchor_enabledSE[1],mt.lineMask_enabled=mt.caps_enabled||mt.lineMask_outlineMode,(mt.lineMask_enabled&&!mt.lineMask_outlineMode||mt.lineOutline_enabled)&&["x","y"].forEach(function(ve){var Dt="maskBGRect_"+ve;dt(gt,Jt,Dt,Gt=mt[Dt])&&(gt.maskBGRect[ve].baseVal.value=Gt,Pn=!0)}),dt(gt,Jt,"lineMask_enabled",Gt=mt.lineMask_enabled)&&(gt.lineFace.style.mask=Gt?"url(#"+gt.lineMaskId+")":"none",Pn=!0,Sn&&hn(gt,gt.lineMask)),mt.lineMask_enabled&&(dt(gt,Jt,"lineMask_outlineMode",Gt=mt.lineMask_outlineMode)&&(Gt?(gt.lineMaskBG.style.display="none",gt.lineMaskShape.style.display="inline"):(gt.lineMaskBG.style.display="inline",gt.lineMaskShape.style.display="none"),Pn=!0),["x","y"].forEach(function(ve){var Dt="lineMask_"+ve;dt(gt,Jt,Dt,Gt=mt[Dt])&&(gt.lineMask[ve].baseVal.value=Gt,Pn=!0)}),dt(gt,Jt,"caps_enabled",Gt=mt.caps_enabled)&&(gt.lineMaskCaps.style.display=gt.lineOutlineMaskCaps.style.display=Gt?"inline":"none",Pn=!0,Sn&&hn(gt,gt.capsMaskLine)),mt.caps_enabled&&([0,1].forEach(function(ve){var Dt;dt(gt,Jt.capsMaskAnchor_enabledSE,ve,Gt=mt.capsMaskAnchor_enabledSE[ve])&&(gt.capsMaskAnchorSE[ve].style.display=Gt?"inline":"none",Pn=!0,Sn&&hn(gt,gt.lineMask)),mt.capsMaskAnchor_enabledSE[ve]&&(Fn(Dt=mt.capsMaskAnchor_pathDataSE[ve],Jt.capsMaskAnchor_pathDataSE[ve])&&(gt.capsMaskAnchorSE[ve].setPathData(Dt),Jt.capsMaskAnchor_pathDataSE[ve]=Dt,Pn=!0),dt(gt,Jt.capsMaskAnchor_strokeWidthSE,ve,Gt=mt.capsMaskAnchor_strokeWidthSE[ve])&&(gt.capsMaskAnchorSE[ve].style.strokeWidth=Gt+"px",Pn=!0))}),dt(gt,Jt,"capsMaskMarker_enabled",Gt=mt.capsMaskMarker_enabled)&&(gt.capsMaskLine.style.display=Gt?"inline":"none",Pn=!0),mt.capsMaskMarker_enabled&&[0,1].forEach(function(ve){var Dt=mt.capsMaskMarker_plugSE[ve],Lt=Dt!==Jn?Sr[bi[Dt]]:null,on=ta(ve,Lt);dt(gt,Jt.capsMaskMarker_enabledSE,ve,Gt=mt.capsMaskMarker_enabledSE[ve])&&(gt.capsMaskLine.style[on.prop]=Gt?"url(#"+gt.lineMaskMarkerIdSE[ve]+")":"none",Pn=!0),mt.capsMaskMarker_enabledSE[ve]&&(dt(gt,Jt.capsMaskMarker_plugSE,ve,Dt)&&(gt.capsMaskMarkerShapeSE[ve].href.baseVal="#"+Lt.elmId,ea(gt,gt.capsMaskMarkerSE[ve],on.orient,Lt.bBox,gt.svg,gt.capsMaskMarkerShapeSE[ve],gt.capsMaskLine),Pn=!0,En&&(hn(gt,gt.capsMaskLine),hn(gt,gt.lineFace))),["markerWidth","markerHeight"].forEach(function(mn){var Ar="capsMaskMarker_"+mn+"SE";dt(gt,Jt[Ar],ve,Gt=mt[Ar][ve])&&(gt.capsMaskMarkerSE[ve][mn].baseVal.value=Gt,Pn=!0)}))}))),mt.lineOutline_enabled&&["x","y"].forEach(function(ve){var Dt="lineOutlineMask_"+ve;dt(gt,Jt,Dt,Gt=mt[Dt])&&(gt.lineOutlineMask[ve].baseVal.value=Gt,Pn=!0)}),Pn),A.effect&&(Ui=(Ut=_).curStats,Li=Ut.aplStats,Object.keys(cn).forEach(function(ve){var Dt=cn[ve],Lt=ve+"_enabled",on=ve+"_options",mn=Ui[on];dt(Ut,Li,Lt,Ji=Ui[Lt])?(Ji&&(Li[on]=Si(mn)),Dt[Ji?"init":"remove"](Ut)):Ji&&Dr(mn,Li[on])&&(Dt.remove(Ut),Li[Lt]=!0,Li[on]=Si(mn),Dt.init(Ut))})),(Ht||Sn)&&An.line&&!An.path&&hn(_,_.lineShape),Ht&&An.plug&&!An.line&&hn(_,_.plugsFace),Po(_)}function Do(_,A){return{duration:ln(_.duration)&&0<_.duration?_.duration:A.duration,timing:en.validTiming(_.timing)?_.timing:Si(A.timing)}}function $r(_,A,C,T){var P,V=_.curStats,le=_.aplStats,te={};function re(){["show_on","show_effect","show_animOptions"].forEach(function(j){le[j]=V[j]})}V.show_on=A,C&&Tt[C]&&(V.show_effect=C,V.show_animOptions=Do(Wi(T)?T:{},Tt[C].defaultAnimOptions)),te.show_on=V.show_on!==le.show_on,te.show_effect=V.show_effect!==le.show_effect,te.show_animOptions=Dr(V.show_animOptions,le.show_animOptions),te.show_effect||te.show_animOptions?V.show_inAnim?(P=te.show_effect?Tt[le.show_effect].stop(_,!0,!0):Tt[le.show_effect].stop(_),re(),Tt[le.show_effect].init(_,P)):te.show_on&&(le.show_effect&&te.show_effect&&Tt[le.show_effect].stop(_,!0,!0),re(),Tt[le.show_effect].init(_)):te.show_on&&(re(),Tt[le.show_effect].start(_))}function Va(_,A,C){var T={props:_,optionName:C};return!(!(_.attachments.indexOf(A)<0)||A.conf.bind&&!A.conf.bind(A,T)||(_.attachments.push(A),A.boundTargets.push(T),0))}function Ro(_,A,C){var T=_.attachments.indexOf(A);-1<T&&_.attachments.splice(T,1),A.boundTargets.some(function(P,V){return P.props===_&&(A.conf.unbind&&A.conf.unbind(A,P),T=V,!0)})&&(A.boundTargets.splice(T,1),C||gr(function(){A.boundTargets.length||cr(A)}))}function _r(_,A){var C,T,P=_.options,V={};function le(j,ee,ye,G,Q){var $={};return ye?null!=G?($.container=j[ye],$.key=G):($.container=j,$.key=ye):($.container=j,$.key=ee),$.default=Q,$.acceptsAuto=null==$.default,$}function te(j,ee,ye,G,Q,$,se){var _e,Ae,Ne,Te=le(j,ye,Q,$,se);return null!=ee[ye]&&(Ae=(ee[ye]+"").toLowerCase())&&(Te.acceptsAuto&&Ae===pr||(Ne=G[Ae]))&&Ne!==Te.container[Te.key]&&(Te.container[Te.key]=Ne,_e=!0),null!=Te.container[Te.key]||Te.acceptsAuto||(Te.container[Te.key]=Te.default,_e=!0),_e}function re(j,ee,ye,G,Q,$,se,_e,Ae){var Ne,Te,ge,ne,ue=le(j,ye,Q,$,se);if(!G){if(null==ue.default)throw new Error("Invalid `type`: "+ye);G=typeof ue.default}return null!=ee[ye]&&(ue.acceptsAuto&&(ee[ye]+"").toLowerCase()===pr||(ge=Te=ee[ye],("number"===(ne=G)?ln(ge):typeof ge===ne)&&(Te=Ae&&"string"===G&&Te?Te.trim():Te,1)&&(!_e||_e(Te))))&&Te!==ue.container[ue.key]&&(ue.container[ue.key]=Te,Ne=!0),null!=ue.container[ue.key]||ue.acceptsAuto||(ue.container[ue.key]=ue.default,Ne=!0),Ne}if(A=A||{},["start","end"].forEach(function(j,ee){var ye=A[j],G=!1;if(ye&&(Yi(ye)||(G=nr(ye,"anchor")))&&ye!==P.anchorSE[ee]){if(!1!==_.optionIsAttach.anchorSE[ee]&&Ro(_,qn[P.anchorSE[ee]._id]),G&&!Va(_,qn[ye._id],j))throw new Error("Can't bind attachment");P.anchorSE[ee]=ye,_.optionIsAttach.anchorSE[ee]=G,T=V.position=!0}}),!P.anchorSE[0]||!P.anchorSE[1]||P.anchorSE[0]===P.anchorSE[1])throw new Error("`start` and `end` are required.");T&&(C=function(j,ee){var ye,G,Q;if(!(ye=po(j))||!(G=po(ee)))throw new Error("Cannot get frames.");return ye.length&&G.length&&(ye.reverse(),G.reverse(),ye.some(function($){return G.some(function(se){return se===$&&(Q=se.contentWindow,!0)})})),Q||window}(!1!==_.optionIsAttach.anchorSE[0]?qn[P.anchorSE[0]._id].element:P.anchorSE[0],!1!==_.optionIsAttach.anchorSE[1]?qn[P.anchorSE[1]._id].element:P.anchorSE[1]))!==_.baseWindow&&(function(j,ee){var ye,G,Q,$,se,_e,Ae,Ne,Te,ge,ne=j.aplStats,ue=ee.document,oe=ui+"-"+j._id;function ut(q){var Ee=G.appendChild(ue.createElementNS(vt,"mask"));return Ee.id=q,Ee.maskUnits.baseVal=SVGUnitTypes.SVG_UNIT_TYPE_USERSPACEONUSE,[Ee.x,Ee.y,Ee.width,Ee.height].forEach(function(I){I.baseVal.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX,0)}),Ee}function ft(q){var Ee=G.appendChild(ue.createElementNS(vt,"marker"));return Ee.id=q,Ee.markerUnits.baseVal=SVGMarkerElement.SVG_MARKERUNITS_STROKEWIDTH,Ee.viewBox.baseVal||Ee.setAttribute("viewBox","0 0 0 0"),Ee}function rt(q){return[q.width,q.height].forEach(function(Ee){Ee.baseVal.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PERCENTAGE,100)}),q}j.pathList={},On(ne,Oo),Object.keys(cn).forEach(function(q){var Ee=q+"_enabled";ne[Ee]&&(cn[q].remove(j),ne[Ee]=!1)}),j.baseWindow&&j.svg&&j.baseWindow.document.body.removeChild(j.svg),Ti(j.baseWindow=ee),j.bodyOffset=gn(ee),j.svg=ye=ue.createElementNS(vt,"svg"),ye.className.baseVal=ui,ye.viewBox.baseVal||ye.setAttribute("viewBox","0 0 0 0"),j.defs=G=ye.appendChild(ue.createElementNS(vt,"defs")),j.linePath=$=G.appendChild(ue.createElementNS(vt,"path")),$.id=se=oe+"-line-path",$.className.baseVal=ui+"-line-path",Sn&&($.style.fill="none"),j.lineShape=$=G.appendChild(ue.createElementNS(vt,"use")),$.id=_e=oe+"-line-shape",$.href.baseVal="#"+se,(Q=G.appendChild(ue.createElementNS(vt,"g"))).id=Ae=oe+"-caps",j.capsMaskAnchorSE=[0,1].map(function(){var q=Q.appendChild(ue.createElementNS(vt,"path"));return q.className.baseVal=ui+"-caps-mask-anchor",q}),j.lineMaskMarkerIdSE=[oe+"-caps-mask-marker-0",oe+"-caps-mask-marker-1"],j.capsMaskMarkerSE=[0,1].map(function(q){return ft(j.lineMaskMarkerIdSE[q])}),j.capsMaskMarkerShapeSE=[0,1].map(function(q){var Ee=j.capsMaskMarkerSE[q].appendChild(ue.createElementNS(vt,"use"));return Ee.className.baseVal=ui+"-caps-mask-marker-shape",Ee}),j.capsMaskLine=$=Q.appendChild(ue.createElementNS(vt,"use")),$.className.baseVal=ui+"-caps-mask-line",$.href.baseVal="#"+_e,j.maskBGRect=$=rt(G.appendChild(ue.createElementNS(vt,"rect"))),$.id=Ne=oe+"-mask-bg-rect",$.className.baseVal=ui+"-mask-bg-rect",Sn&&($.style.fill="white"),j.lineMask=rt(ut(j.lineMaskId=oe+"-line-mask")),j.lineMaskBG=$=j.lineMask.appendChild(ue.createElementNS(vt,"use")),$.href.baseVal="#"+Ne,j.lineMaskShape=$=j.lineMask.appendChild(ue.createElementNS(vt,"use")),$.className.baseVal=ui+"-line-mask-shape",$.href.baseVal="#"+se,$.style.display="none",j.lineMaskCaps=$=j.lineMask.appendChild(ue.createElementNS(vt,"use")),$.href.baseVal="#"+Ae,j.lineOutlineMask=rt(ut(Te=oe+"-line-outline-mask")),($=j.lineOutlineMask.appendChild(ue.createElementNS(vt,"use"))).href.baseVal="#"+Ne,j.lineOutlineMaskShape=$=j.lineOutlineMask.appendChild(ue.createElementNS(vt,"use")),$.className.baseVal=ui+"-line-outline-mask-shape",$.href.baseVal="#"+se,j.lineOutlineMaskCaps=$=j.lineOutlineMask.appendChild(ue.createElementNS(vt,"use")),$.href.baseVal="#"+Ae,j.face=ye.appendChild(ue.createElementNS(vt,"g")),j.lineFace=$=j.face.appendChild(ue.createElementNS(vt,"use")),$.href.baseVal="#"+_e,j.lineOutlineFace=$=j.face.appendChild(ue.createElementNS(vt,"use")),$.href.baseVal="#"+_e,$.style.mask="url(#"+Te+")",$.style.display="none",j.plugMaskIdSE=[oe+"-plug-mask-0",oe+"-plug-mask-1"],j.plugMaskSE=[0,1].map(function(q){return ut(j.plugMaskIdSE[q])}),j.plugMaskShapeSE=[0,1].map(function(q){var Ee=j.plugMaskSE[q].appendChild(ue.createElementNS(vt,"use"));return Ee.className.baseVal=ui+"-plug-mask-shape",Ee}),ge=[],j.plugOutlineMaskSE=[0,1].map(function(q){return ut(ge[q]=oe+"-plug-outline-mask-"+q)}),j.plugOutlineMaskShapeSE=[0,1].map(function(q){var Ee=j.plugOutlineMaskSE[q].appendChild(ue.createElementNS(vt,"use"));return Ee.className.baseVal=ui+"-plug-outline-mask-shape",Ee}),j.plugMarkerIdSE=[oe+"-plug-marker-0",oe+"-plug-marker-1"],j.plugMarkerSE=[0,1].map(function(q){var Ee=ft(j.plugMarkerIdSE[q]);return Sn&&(Ee.markerUnits.baseVal=SVGMarkerElement.SVG_MARKERUNITS_USERSPACEONUSE),Ee}),j.plugMarkerShapeSE=[0,1].map(function(q){return j.plugMarkerSE[q].appendChild(ue.createElementNS(vt,"g"))}),j.plugFaceSE=[0,1].map(function(q){return j.plugMarkerShapeSE[q].appendChild(ue.createElementNS(vt,"use"))}),j.plugOutlineFaceSE=[0,1].map(function(q){var Ee=j.plugMarkerShapeSE[q].appendChild(ue.createElementNS(vt,"use"));return Ee.style.mask="url(#"+ge[q]+")",Ee.style.display="none",Ee}),j.plugsFace=$=j.face.appendChild(ue.createElementNS(vt,"use")),$.className.baseVal=ui+"-plugs-face",$.href.baseVal="#"+_e,$.style.display="none",j.curStats.show_inAnim?(j.isShown=1,Tt[ne.show_effect].stop(j,!0)):j.isShown||(ye.style.visibility="hidden"),ue.body.appendChild(ye),[0,1,2].forEach(function(q){var Ee,I=j.options.labelSEM[q];I&&nr(I,"label")&&(Ee=qn[I._id]).conf.initSvg&&Ee.conf.initSvg(Ee,j)})}(_,C),V.line=V.plug=V.lineOutline=V.plugOutline=V.faces=V.effect=!0),V.position=te(P,A,"path",Io,null,null,Qn.path)||V.position,V.position=te(P,A,"startSocket",co,"socketSE",0)||V.position,V.position=te(P,A,"endSocket",co,"socketSE",1)||V.position,[A.startSocketGravity,A.endSocketGravity].forEach(function(j,ee){var ye,G,Q=!1;null!=j&&(Array.isArray(j)?ln(j[0])&&ln(j[1])&&(Q=[j[0],j[1]],Array.isArray(P.socketGravitySE[ee])&&(ye=Q).length===(G=P.socketGravitySE[ee]).length&&ye.every(function($,se){return $===G[se]})&&(Q=!1)):((j+"").toLowerCase()===pr?Q=null:ln(j)&&0<=j&&(Q=j),Q===P.socketGravitySE[ee]&&(Q=!1)),!1!==Q&&(P.socketGravitySE[ee]=Q,V.position=!0))}),V.line=re(P,A,"color",null,"lineColor",null,Qn.lineColor,null,!0)||V.line,V.line=re(P,A,"size",null,"lineSize",null,Qn.lineSize,function(j){return 0<j})||V.line,["startPlug","endPlug"].forEach(function(j,ee){V.plug=te(P,A,j,ko,"plugSE",ee,Qn.plugSE[ee])||V.plug,V.plug=re(P,A,j+"Color","string","plugColorSE",ee,null,null,!0)||V.plug,V.plug=re(P,A,j+"Size",null,"plugSizeSE",ee,Qn.plugSizeSE[ee],function(ye){return 0<ye})||V.plug}),V.lineOutline=re(P,A,"outline",null,"lineOutlineEnabled",null,Qn.lineOutlineEnabled)||V.lineOutline,V.lineOutline=re(P,A,"outlineColor",null,"lineOutlineColor",null,Qn.lineOutlineColor,null,!0)||V.lineOutline,V.lineOutline=re(P,A,"outlineSize",null,"lineOutlineSize",null,Qn.lineOutlineSize,function(j){return 0<j&&j<=.48})||V.lineOutline,["startPlugOutline","endPlugOutline"].forEach(function(j,ee){V.plugOutline=re(P,A,j,null,"plugOutlineEnabledSE",ee,Qn.plugOutlineEnabledSE[ee])||V.plugOutline,V.plugOutline=re(P,A,j+"Color","string","plugOutlineColorSE",ee,null,null,!0)||V.plugOutline,V.plugOutline=re(P,A,j+"Size",null,"plugOutlineSizeSE",ee,Qn.plugOutlineSizeSE[ee],function(ye){return 1<=ye})||V.plugOutline}),["startLabel","endLabel","middleLabel"].forEach(function(j,ee){var ye,G,Q,$=A[j],se=P.labelSEM[ee]&&!_.optionIsAttach.labelSEM[ee]?qn[P.labelSEM[ee]._id].text:P.labelSEM[ee],_e=!1;if((ye="string"==typeof $)&&($=$.trim()),(ye||$&&(_e=nr($,"label")))&&$!==se){if(P.labelSEM[ee]&&(Ro(_,qn[P.labelSEM[ee]._id]),P.labelSEM[ee]=""),$){if(_e?(G=qn[(Q=$)._id]).boundTargets.slice().forEach(function(Ae){G.conf.removeOption(G,Ae)}):Q=new yn($e.captionLabel,[$]),!Va(_,qn[Q._id],j))throw new Error("Can't bind attachment");P.labelSEM[ee]=Q}_.optionIsAttach.labelSEM[ee]=_e}}),Object.keys(cn).forEach(function(j){var ee,ye,G=cn[j],Q=j+"_enabled",$=j+"_options";function se(Ae){var Ne={};return G.optionsConf.forEach(function(Te){var ge=Te[0],ne=Te[3];null==Te[4]||Ne[ne]||(Ne[ne]=[]),("function"==typeof ge?ge:"id"===ge?te:re).apply(null,[Ne,Ae].concat(Te.slice(1)))}),Ne}function _e(Ae){var Ne,Te=j+"_animOptions";return Ae.hasOwnProperty("animation")?Wi(Ae.animation)?Ne=_.curStats[Te]=Do(Ae.animation,G.defaultAnimOptions):_.curStats[Te]=(Ne=!!Ae.animation)?Do({},G.defaultAnimOptions):null:_.curStats[Te]=(Ne=!!G.defaultEnabled)?Do({},G.defaultAnimOptions):null,Ne}A.hasOwnProperty(j)&&(Wi(ee=A[j])?(_.curStats[Q]=!0,ye=_.curStats[$]=se(ee),G.anim&&(_.curStats[$].animation=_e(ee))):(ye=_.curStats[Q]=!!ee)&&(_.curStats[$]=se({}),G.anim&&(_.curStats[$].animation=_e({}))),Dr(ye,P[j])&&(P[j]=ye,V.effect=!0))}),mi(_,V)}function Mi(_,A,C){var T={options:{anchorSE:[],socketSE:[],socketGravitySE:[],plugSE:[],plugColorSE:[],plugSizeSE:[],plugOutlineEnabledSE:[],plugOutlineColorSE:[],plugOutlineSizeSE:[],labelSEM:["","",""]},optionIsAttach:{anchorSE:[!1,!1],labelSEM:[!1,!1,!1]},curStats:{},aplStats:{},attachments:[],events:{},reflowTargets:[]};On(T.curStats,Oo),On(T.aplStats,Oo),Object.keys(cn).forEach(function(P){var V=cn[P].stats;On(T.curStats,V),On(T.aplStats,V),T.options[P]=!1}),On(T.curStats,fs),On(T.aplStats,fs),T.curStats.show_effect=gs,T.curStats.show_animOptions=Si(Tt[gs].defaultAnimOptions),Object.defineProperty(this,"_id",{value:++za}),T._id=this._id,di[this._id]=T,1===arguments.length&&(C=_,_=null),C=C||{},(_||A)&&(C=Si(C),_&&(C.start=_),A&&(C.end=A)),T.isShown=T.aplStats.show_on=!C.hide,this.setOptions(C)}cn={dash:{stats:{dash_len:{},dash_gap:{},dash_maxOffset:{}},anim:!0,defaultAnimOptions:{duration:1e3,timing:"linear"},optionsConf:[["type","len","number",null,null,null,function(_){return 0<_}],["type","gap","number",null,null,null,function(_){return 0<_}]],init:function(_){Hn(_,"apl_line_strokeWidth",cn.dash.update),_.lineFace.style.strokeDashoffset=0,cn.dash.update(_)},remove:function(_){var A=_.curStats;Wn(_,"apl_line_strokeWidth",cn.dash.update),A.dash_animId&&(en.remove(A.dash_animId),A.dash_animId=null),_.lineFace.style.strokeDasharray="none",_.lineFace.style.strokeDashoffset=0,On(_.aplStats,cn.dash.stats)},update:function(_){var A,C=_.curStats,T=_.aplStats,P=T.dash_options,V=!1;C.dash_len=P.len||2*T.line_strokeWidth,C.dash_gap=P.gap||T.line_strokeWidth,C.dash_maxOffset=C.dash_len+C.dash_gap,V=dt(_,T,"dash_len",C.dash_len)||V,(V=dt(_,T,"dash_gap",C.dash_gap)||V)&&(_.lineFace.style.strokeDasharray=T.dash_len+","+T.dash_gap),C.dash_animOptions?(V=dt(_,T,"dash_maxOffset",C.dash_maxOffset),T.dash_animOptions&&(V||Dr(C.dash_animOptions,T.dash_animOptions))&&(C.dash_animId&&(A=en.stop(C.dash_animId),en.remove(C.dash_animId)),T.dash_animOptions=null),T.dash_animOptions||(C.dash_animId=en.add(function(le){return(1-le)*T.dash_maxOffset+"px"},function(le){_.lineFace.style.strokeDashoffset=le},C.dash_animOptions.duration,0,C.dash_animOptions.timing,!1,A),T.dash_animOptions=Si(C.dash_animOptions))):T.dash_animOptions&&(C.dash_animId&&(en.remove(C.dash_animId),C.dash_animId=null),_.lineFace.style.strokeDashoffset=0,T.dash_animOptions=null)}},gradient:{stats:{gradient_colorSE:{hasSE:!0},gradient_pointSE:{hasSE:!0,hasProps:!0}},optionsConf:[["type","startColor","string","colorSE",0,null,null,!0],["type","endColor","string","colorSE",1,null,null,!0]],init:function(_){var A,C=_.baseWindow.document,P=ui+"-"+_._id+"-gradient";_.efc_gradient_gradient=A=_.defs.appendChild(C.createElementNS(vt,"linearGradient")),A.id=P,A.gradientUnits.baseVal=SVGUnitTypes.SVG_UNIT_TYPE_USERSPACEONUSE,[A.x1,A.y1,A.x2,A.y2].forEach(function(V){V.baseVal.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX,0)}),_.efc_gradient_stopSE=[0,1].map(function(V){var le=_.efc_gradient_gradient.appendChild(C.createElementNS(vt,"stop"));try{le.offset.baseVal=V}catch(te){if(te.code!==DOMException.NO_MODIFICATION_ALLOWED_ERR)throw te;le.setAttribute("offset",V)}return le}),Hn(_,"cur_plug_colorSE",cn.gradient.update),Hn(_,"apl_path",cn.gradient.update),_.curStats.line_altColor=!0,_.lineFace.style.stroke="url(#"+P+")",cn.gradient.update(_)},remove:function(_){_.efc_gradient_gradient&&(_.defs.removeChild(_.efc_gradient_gradient),_.efc_gradient_gradient=_.efc_gradient_stopSE=null),Wn(_,"cur_plug_colorSE",cn.gradient.update),Wn(_,"apl_path",cn.gradient.update),_.curStats.line_altColor=!1,_.lineFace.style.stroke=_.curStats.line_color,On(_.aplStats,cn.gradient.stats)},update:function(_){var A,C,T=_.curStats,P=_.aplStats,V=P.gradient_options,le=_.pathList.animVal||_.pathList.baseVal;[0,1].forEach(function(te){T.gradient_colorSE[te]=V.colorSE[te]||T.plug_colorSE[te]}),T.gradient_pointSE[0]={x:(C=le[0][0]).x,y:C.y},C=(A=le[le.length-1])[A.length-1],T.gradient_pointSE[1]={x:C.x,y:C.y},[0,1].forEach(function(te){var re;dt(_,P.gradient_colorSE,te,re=T.gradient_colorSE[te])&&(Sn?(re=rr(re),_.efc_gradient_stopSE[te].style.stopColor=re[1],_.efc_gradient_stopSE[te].style.stopOpacity=re[0]):_.efc_gradient_stopSE[te].style.stopColor=re),["x","y"].forEach(function(j){(re=T.gradient_pointSE[te][j])!==P.gradient_pointSE[te][j]&&(_.efc_gradient_gradient[j+(te+1)].baseVal.value=P.gradient_pointSE[te][j]=re)})})}},dropShadow:{stats:{dropShadow_dx:{},dropShadow_dy:{},dropShadow_blur:{},dropShadow_color:{},dropShadow_opacity:{},dropShadow_x:{},dropShadow_y:{}},optionsConf:[["type","dx",null,null,null,2],["type","dy",null,null,null,4],["type","blur",null,null,null,3,function(_){return 0<=_}],["type","color",null,null,null,"#000",null,!0],["type","opacity",null,null,null,.8,function(_){return 0<=_&&_<=1}]],init:function(_){var A,C,T,P,V,te=_.defs,re=ui+"-"+_._id+"-dropShadow",j=(A=_.baseWindow.document,C=re,V={},"boolean"!=typeof Qo&&(Qo=!!window.SVGFEDropShadowElement&&!Sn),V.elmsAppend=[V.elmFilter=T=A.createElementNS(vt,"filter")],T.filterUnits.baseVal=SVGUnitTypes.SVG_UNIT_TYPE_USERSPACEONUSE,T.x.baseVal.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX,0),T.y.baseVal.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX,0),T.width.baseVal.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PERCENTAGE,100),T.height.baseVal.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PERCENTAGE,100),T.id=C,Qo?(V.elmOffset=V.elmBlur=P=T.appendChild(A.createElementNS(vt,"feDropShadow")),V.styleFlood=P.style):(V.elmBlur=T.appendChild(A.createElementNS(vt,"feGaussianBlur")),V.elmOffset=P=T.appendChild(A.createElementNS(vt,"feOffset")),P.result.baseVal="offsetblur",P=T.appendChild(A.createElementNS(vt,"feFlood")),V.styleFlood=P.style,(P=T.appendChild(A.createElementNS(vt,"feComposite"))).in2.baseVal="offsetblur",P.operator.baseVal=SVGFECompositeElement.SVG_FECOMPOSITE_OPERATOR_IN,(P=T.appendChild(A.createElementNS(vt,"feMerge"))).appendChild(A.createElementNS(vt,"feMergeNode")),P.appendChild(A.createElementNS(vt,"feMergeNode")).in1.baseVal="SourceGraphic"),V);["elmFilter","elmOffset","elmBlur","styleFlood","elmsAppend"].forEach(function(ee){_["efc_dropShadow_"+ee]=j[ee]}),j.elmsAppend.forEach(function(ee){te.appendChild(ee)}),_.face.setAttribute("filter","url(#"+re+")"),Hn(_,"new_edge4viewBox",cn.dropShadow.adjustEdge),cn.dropShadow.update(_)},remove:function(_){var A=_.defs;_.efc_dropShadow_elmsAppend&&(_.efc_dropShadow_elmsAppend.forEach(function(C){A.removeChild(C)}),_.efc_dropShadow_elmFilter=_.efc_dropShadow_elmOffset=_.efc_dropShadow_elmBlur=_.efc_dropShadow_styleFlood=_.efc_dropShadow_elmsAppend=null),Wn(_,"new_edge4viewBox",cn.dropShadow.adjustEdge),mi(_,{}),_.face.removeAttribute("filter"),On(_.aplStats,cn.dropShadow.stats)},update:function(_){var A,C,T=_.curStats,P=_.aplStats,V=P.dropShadow_options;T.dropShadow_dx=A=V.dx,dt(_,P,"dropShadow_dx",A)&&(_.efc_dropShadow_elmOffset.dx.baseVal=A,C=!0),T.dropShadow_dy=A=V.dy,dt(_,P,"dropShadow_dy",A)&&(_.efc_dropShadow_elmOffset.dy.baseVal=A,C=!0),T.dropShadow_blur=A=V.blur,dt(_,P,"dropShadow_blur",A)&&(_.efc_dropShadow_elmBlur.setStdDeviation(A,A),C=!0),C&&mi(_,{}),T.dropShadow_color=A=V.color,dt(_,P,"dropShadow_color",A)&&(_.efc_dropShadow_styleFlood.floodColor=A),T.dropShadow_opacity=A=V.opacity,dt(_,P,"dropShadow_opacity",A)&&(_.efc_dropShadow_styleFlood.floodOpacity=A)},adjustEdge:function(_,A){var C,T,P=_.curStats,V=_.aplStats;null!=P.dropShadow_dx&&((T={x1:A.x1-(C=3*P.dropShadow_blur)+P.dropShadow_dx,y1:A.y1-C+P.dropShadow_dy,x2:A.x2+C+P.dropShadow_dx,y2:A.y2+C+P.dropShadow_dy}).x1<A.x1&&(A.x1=T.x1),T.y1<A.y1&&(A.y1=T.y1),T.x2>A.x2&&(A.x2=T.x2),T.y2>A.y2&&(A.y2=T.y2),["x","y"].forEach(function(le){var te,re="dropShadow_"+le;P[re]=te=A[le+"1"],dt(_,V,re,te)&&(_.efc_dropShadow_elmFilter[le].baseVal.value=te)}))}}},Object.keys(cn).forEach(function(_){var A=cn[_],C=A.stats;C[_+"_enabled"]={iniValue:!1},C[_+"_options"]={hasProps:!0},A.anim&&(C[_+"_animOptions"]={},C[_+"_animId"]={})}),Tt={none:{defaultAnimOptions:{},init:function(_,A){var C=_.curStats;C.show_animId&&(en.remove(C.show_animId),C.show_animId=null),Tt.none.start(_,A)},start:function(_,A){Tt.none.stop(_,!0)},stop:function(_,A,C){return C=null!=C?C:_.aplStats.show_on,_.curStats.show_inAnim=!1,A&&Kr(_,C),C?1:0}},fade:{defaultAnimOptions:{duration:300,timing:"linear"},init:function(_,A){var C=_.curStats,T=_.aplStats;C.show_animId&&en.remove(C.show_animId),C.show_animId=en.add(function(P){return P},function(P,V){V?Tt.fade.stop(_,!0):(_.svg.style.opacity=P+"",Xt&&(hn(_,_.svg),Po(_)))},T.show_animOptions.duration,1,T.show_animOptions.timing,null,!1),Tt.fade.start(_,A)},start:function(_,A){var C,T=_.curStats;T.show_inAnim&&(C=en.stop(T.show_animId)),Kr(_,1),T.show_inAnim=!0,en.start(T.show_animId,!_.aplStats.show_on,null!=A?A:C)},stop:function(_,A,C){var T,P=_.curStats;return C=null!=C?C:_.aplStats.show_on,T=P.show_inAnim?en.stop(P.show_animId):C?1:0,P.show_inAnim=!1,A&&(_.svg.style.opacity=C?"":"0",Kr(_,C)),T}},draw:{defaultAnimOptions:{duration:500,timing:[.58,0,.42,1]},init:function(_,A){var C=_.curStats,T=_.aplStats,P=_.pathList.baseVal,V=$o(P),le=V.segsLen,te=V.lenAll;C.show_animId&&en.remove(C.show_animId),C.show_animId=en.add(function(re){var j,ee,ye,G,Q=-1;if(0===re)ee=[[P[0][0],P[0][0]]];else if(1===re)ee=P;else{for(j=te*re,ee=[];j>=le[++Q];)ee.push(P[Q]),j-=le[Q];j&&(2===(ye=P[Q]).length?ee.push([ye[0],Fo(ye[0],ye[1],j/le[Q])]):(G=Bi(ye[0],ye[1],ye[2],ye[3],Vi(ye[0],ye[1],ye[2],ye[3],j)),ee.push([ye[0],G.fromP1,G.fromP2,G])))}return ee},function(re,j){j?Tt.draw.stop(_,!0):(_.pathList.animVal=re,mi(_,{path:!0}))},T.show_animOptions.duration,1,T.show_animOptions.timing,null,!1),Tt.draw.start(_,A)},start:function(_,A){var C,T=_.curStats;T.show_inAnim&&(C=en.stop(T.show_animId)),Kr(_,1),T.show_inAnim=!0,Hn(_,"apl_position",Tt.draw.update),en.start(T.show_animId,!_.aplStats.show_on,null!=A?A:C)},stop:function(_,A,C){var T,P=_.curStats;return C=null!=C?C:_.aplStats.show_on,T=P.show_inAnim?en.stop(P.show_animId):C?1:0,P.show_inAnim=!1,A&&(_.pathList.animVal=C?null:[[_.pathList.baseVal[0][0],_.pathList.baseVal[0][0]]],mi(_,{path:!0}),Kr(_,C)),T},update:function(_){Wn(_,"apl_position",Tt.draw.update),_.curStats.show_inAnim?Tt.draw.init(_,Tt.draw.stop(_)):_.aplStats.show_animOptions={}}}},function(){function _(A){return function(C){var T={};T[A]=C,this.setOptions(T)}}[["start","anchorSE",0],["end","anchorSE",1],["color","lineColor"],["size","lineSize"],["startSocketGravity","socketGravitySE",0],["endSocketGravity","socketGravitySE",1],["startPlugColor","plugColorSE",0],["endPlugColor","plugColorSE",1],["startPlugSize","plugSizeSE",0],["endPlugSize","plugSizeSE",1],["outline","lineOutlineEnabled"],["outlineColor","lineOutlineColor"],["outlineSize","lineOutlineSize"],["startPlugOutline","plugOutlineEnabledSE",0],["endPlugOutline","plugOutlineEnabledSE",1],["startPlugOutlineColor","plugOutlineColorSE",0],["endPlugOutlineColor","plugOutlineColorSE",1],["startPlugOutlineSize","plugOutlineSizeSE",0],["endPlugOutlineSize","plugOutlineSizeSE",1]].forEach(function(A){var C=A[0],T=A[1],P=A[2];Object.defineProperty(Mi.prototype,C,{get:function(){var V=null!=P?di[this._id].options[T][P]:T?di[this._id].options[T]:di[this._id].options[C];return null==V?pr:Si(V)},set:_(C),enumerable:!0})}),[["path",Io],["startSocket",co,"socketSE",0],["endSocket",co,"socketSE",1],["startPlug",ko,"plugSE",0],["endPlug",ko,"plugSE",1]].forEach(function(A){var C=A[0],T=A[1],P=A[2],V=A[3];Object.defineProperty(Mi.prototype,C,{get:function(){var le,te=null!=V?di[this._id].options[P][V]:P?di[this._id].options[P]:di[this._id].options[C];return te?Object.keys(T).some(function(re){return T[re]===te&&(le=re,!0)})?le:new Error("It's broken"):pr},set:_(C),enumerable:!0})}),Object.keys(cn).forEach(function(A){var C=cn[A];Object.defineProperty(Mi.prototype,A,{get:function(){var T,P,V=di[this._id].options[A];return Wi(V)?(T=V,P=C.optionsConf.reduce(function(le,te){var re,ee=te[1],ye=te[2],G=te[3],Q=te[4],$=null!=Q?T[G][Q]:G?T[G]:T[ee];return le[ee]="id"===te[0]?$?Object.keys(ye).some(function(se){return ye[se]===$&&(re=se,!0)})?re:new Error("It's broken"):pr:null==$?pr:Si($),le},{}),C.anim&&(P.animation=Si(T.animation)),P):V},set:_(A),enumerable:!0})}),["startLabel","endLabel","middleLabel"].forEach(function(A,C){Object.defineProperty(Mi.prototype,A,{get:function(){var T=di[this._id],P=T.options;return P.labelSEM[C]&&!T.optionIsAttach.labelSEM[C]?qn[P.labelSEM[C]._id].text:P.labelSEM[C]||""},set:_(A),enumerable:!0})})}(),Mi.prototype.setOptions=function(_){return _r(di[this._id],_),this},Mi.prototype.position=function(){return mi(di[this._id],{position:!0}),this},Mi.prototype.remove=function(){var _=di[this._id],A=_.curStats;Object.keys(cn).forEach(function(C){var T=C+"_animId";A[T]&&en.remove(A[T])}),A.show_animId&&en.remove(A.show_animId),_.attachments.slice().forEach(function(C){Ro(_,C)}),_.baseWindow&&_.svg&&_.baseWindow.document.body.removeChild(_.svg),delete di[this._id]},Mi.prototype.show=function(_,A){return $r(di[this._id],!0,_,A),this},Mi.prototype.hide=function(_,A){return $r(di[this._id],!1,_,A),this},cr=function(_){_&&qn[_._id]&&(_.boundTargets.slice().forEach(function(A){Ro(A.props,_,!0)}),_.conf.remove&&_.conf.remove(_),delete qn[_._id])},yn=function(){function _(A,C){var T,P={conf:A,curStats:{},aplStats:{},boundTargets:[]},V={};A.argOptions.every(function(le){return!(!C.length||("string"==typeof le.type?typeof C[0]!==le.type:"function"!=typeof le.type||!le.type(C[0]))||(V[le.optionName]=C.shift(),0))}),T=C.length&&Wi(C[0])?Si(C[0]):{},Object.keys(V).forEach(function(le){T[le]=V[le]}),A.stats&&(On(P.curStats,A.stats),On(P.aplStats,A.stats)),Object.defineProperty(this,"_id",{value:++Ba}),Object.defineProperty(this,"isRemoved",{get:function(){return!qn[this._id]}}),P._id=this._id,A.init&&!A.init(P,T)||(qn[this._id]=P)}return _.prototype.remove=function(){var A=this,C=qn[A._id];C&&(C.boundTargets.slice().forEach(function(T){C.conf.removeOption(C,T)}),gr(function(){var T=qn[A._id];T&&(console.error("LeaderLineAttachment was not removed by removeOption"),cr(T))}))},_}(),window.LeaderLineAttachment=yn,nr=function(_,A){return _ instanceof yn&&(!(_.isRemoved||A&&qn[_._id].conf.type!==A)||null)},$e={pointAnchor:{type:"anchor",argOptions:[{optionName:"element",type:Yi}],init:function(_,A){return _.element=$e.pointAnchor.checkElement(A.element),_.x=$e.pointAnchor.parsePercent(A.x,!0)||[.5,!0],_.y=$e.pointAnchor.parsePercent(A.y,!0)||[.5,!0],!0},removeOption:function(_,A){var C=A.props,T={},P=_.element,V=C.options.anchorSE["start"===A.optionName?1:0];P===V&&(P=V===document.body?new yn($e.pointAnchor,[P]):document.body),T[A.optionName]=P,_r(C,T)},getBBoxNest:function(_,A){var C=Lo(_.element,A.baseWindow),T=C.width,P=C.height;return C.width=C.height=0,C.left=C.right=C.left+_.x[0]*(_.x[1]?T:1),C.top=C.bottom=C.top+_.y[0]*(_.y[1]?P:1),C},parsePercent:function(_,A){var C,T,P=!1;return ln(_)?T=_:"string"==typeof _&&(C=Da.exec(_))&&C[2]&&(P=0!=(T=parseFloat(C[1])/100)),null!=T&&(A||0<=T)?[T,P]:null},checkElement:function(_){if(null==_)_=document.body;else if(!Yi(_))throw new Error("`element` must be Element");return _}},areaAnchor:{type:"anchor",argOptions:[{optionName:"element",type:Yi},{optionName:"shape",type:"string"}],stats:{color:{},strokeWidth:{},elementWidth:{},elementHeight:{},elementLeft:{},elementTop:{},pathListRel:{},bBoxRel:{},pathData:{},viewBoxBBox:{hasProps:!0},dashLen:{},dashGap:{}},init:function(_,A){var C,T,P,V=[];return _.element=$e.pointAnchor.checkElement(A.element),"string"==typeof A.color&&(_.color=A.color.trim()),"string"==typeof A.fillColor&&(_.fill=A.fillColor.trim()),ln(A.size)&&0<=A.size&&(_.size=A.size),A.dash&&(_.dash=!0,ln(A.dash.len)&&0<A.dash.len&&(_.dashLen=A.dash.len),ln(A.dash.gap)&&0<A.dash.gap&&(_.dashGap=A.dash.gap)),"circle"===A.shape?_.shape=A.shape:"polygon"===A.shape&&Array.isArray(A.points)&&3<=A.points.length&&A.points.every(function(le){var te={};return!(!(te.x=$e.pointAnchor.parsePercent(le[0],!0))||!(te.y=$e.pointAnchor.parsePercent(le[1],!0))||(V.push(te),(te.x[1]||te.y[1])&&(_.hasRatio=!0),0))})?(_.shape=A.shape,_.points=V):(_.shape="rect",_.radius=ln(A.radius)&&0<=A.radius?A.radius:0),"rect"!==_.shape&&"circle"!==_.shape||(_.x=$e.pointAnchor.parsePercent(A.x,!0)||[-.05,!0],_.y=$e.pointAnchor.parsePercent(A.y,!0)||[-.05,!0],_.width=$e.pointAnchor.parsePercent(A.width)||[1.1,!0],_.height=$e.pointAnchor.parsePercent(A.height)||[1.1,!0],(_.x[1]||_.y[1]||_.width[1]||_.height[1])&&(_.hasRatio=!0)),_.svg=T=(C=_.element.ownerDocument).createElementNS(vt,"svg"),T.className.baseVal=ui+"-areaAnchor",T.viewBox.baseVal||T.setAttribute("viewBox","0 0 0 0"),_.path=T.appendChild(C.createElementNS(vt,"path")),_.path.style.fill=_.fill||"none",_.isShown=!1,T.style.visibility="hidden",C.body.appendChild(T),Ti(P=C.defaultView),_.bodyOffset=gn(P),_.updateColor=function(){var le,re=_.aplStats,j=_.boundTargets.length?_.boundTargets[0].props.curStats:null;_.curStats.color=le=_.color||(j?j.line_color:Qn.lineColor),dt(_,re,"color",le)&&(_.path.style.stroke=le)},_.updateShow=function(){Kr(_,_.boundTargets.some(function(le){return!0===le.props.isShown}))},!0},bind:function(_,A){var C=A.props;return _.color||Hn(C,"cur_line_color",_.updateColor),Hn(C,"svgShow",_.updateShow),gr(function(){_.updateColor(),_.updateShow()}),!0},unbind:function(_,A){var C=A.props;_.color||Wn(C,"cur_line_color",_.updateColor),Wn(C,"svgShow",_.updateShow),1<_.boundTargets.length&&gr(function(){_.updateColor(),_.updateShow(),$e.areaAnchor.update(_)&&_.boundTargets.forEach(function(T){mi(T.props,{position:!0})})})},removeOption:function(_,A){$e.pointAnchor.removeOption(_,A)},remove:function(_){_.boundTargets.length&&(console.error("LeaderLineAttachment was not unbound by remove"),_.boundTargets.forEach(function(A){$e.areaAnchor.unbind(_,A)})),_.svg.parentNode.removeChild(_.svg)},getStrokeWidth:function(_,A){return $e.areaAnchor.update(_)&&1<_.boundTargets.length&&gr(function(){_.boundTargets.forEach(function(C){C.props!==A&&mi(C.props,{position:!0})})}),_.curStats.strokeWidth},getPathData:function(_,A){var C=Lo(_.element,A.baseWindow);return _i(_.curStats.pathListRel,function(T){T.x+=C.left,T.y+=C.top})},getBBoxNest:function(_,A){var C=Lo(_.element,A.baseWindow),T=_.curStats.bBoxRel;return{left:T.left+C.left,top:T.top+C.top,right:T.right+C.left,bottom:T.bottom+C.top,width:T.width,height:T.height}},update:function(_){var A,C,T,P,V,le,te,re,j,ee,ye,G,Q,$,se,_e,Ae,Ne,Te,ge,ne,ue,oe,ut,ft,rt,q,Ee,I,xe,Fe,ct,fe=_.curStats,D=_.aplStats,H=_.boundTargets.length?_.boundTargets[0].props.curStats:null,x={};if(x.strokeWidth=dt(_,fe,"strokeWidth",null!=_.size?_.size:H?H.line_strokeWidth:Qn.lineSize),A=Rr(_.element),x.elementWidth=dt(_,fe,"elementWidth",A.width),x.elementHeight=dt(_,fe,"elementHeight",A.height),x.elementLeft=dt(_,fe,"elementLeft",A.left),x.elementTop=dt(_,fe,"elementTop",A.top),x.strokeWidth||_.hasRatio&&(x.elementWidth||x.elementHeight)){switch(_.shape){case"rect":(ge={left:_.x[0]*(_.x[1]?A.width:1),top:_.y[0]*(_.y[1]?A.height:1),width:_.width[0]*(_.width[1]?A.width:1),height:_.height[0]*(_.height[1]?A.height:1)}).right=ge.left+ge.width,ge.bottom=ge.top+ge.height,ut=fe.strokeWidth/2,ue=(oe=Math.min(ge.width,ge.height))?oe/2*Math.SQRT2+ut:0,(ne=_.radius?_.radius<=ue?_.radius:ue:0)?(rt=ne-(ft=(ne-ut)/Math.SQRT2),fe.pathListRel=[[(q=[{x:ge.left-rt,y:ge.top+ft},{x:ge.left+ft,y:ge.top-rt},{x:ge.right-ft,y:ge.top-rt},{x:ge.right+rt,y:ge.top+ft},{x:ge.right+rt,y:ge.bottom-ft},{x:ge.right-ft,y:ge.bottom+rt},{x:ge.left+ft,y:ge.bottom+rt},{x:ge.left-rt,y:ge.bottom-ft}])[0],{x:q[0].x,y:q[0].y-(Ee=ne*Jr)},{x:q[1].x-Ee,y:q[1].y},q[1]]],q[1].x!==q[2].x&&fe.pathListRel.push([q[1],q[2]]),fe.pathListRel.push([q[2],{x:q[2].x+Ee,y:q[2].y},{x:q[3].x,y:q[3].y-Ee},q[3]]),q[3].y!==q[4].y&&fe.pathListRel.push([q[3],q[4]]),fe.pathListRel.push([q[4],{x:q[4].x,y:q[4].y+Ee},{x:q[5].x+Ee,y:q[5].y},q[5]]),q[5].x!==q[6].x&&fe.pathListRel.push([q[5],q[6]]),fe.pathListRel.push([q[6],{x:q[6].x-Ee,y:q[6].y},{x:q[7].x,y:q[7].y+Ee},q[7]]),q[7].y!==q[0].y&&fe.pathListRel.push([q[7],q[0]]),fe.pathListRel.push([]),q=[{x:ge.left-(rt=ne-ft+fe.strokeWidth/2),y:ge.top-rt},{x:ge.right+rt,y:ge.bottom+rt}]):(fe.pathListRel=[[(q=[{x:ge.left-(rt=fe.strokeWidth/2),y:ge.top-rt},{x:ge.right+rt,y:ge.bottom+rt}])[0],{x:q[1].x,y:q[0].y}],[{x:q[1].x,y:q[0].y},q[1]],[q[1],{x:q[0].x,y:q[1].y}],[]],q=[{x:ge.left-fe.strokeWidth,y:ge.top-fe.strokeWidth},{x:ge.right+fe.strokeWidth,y:ge.bottom+fe.strokeWidth}]),fe.bBoxRel={left:q[0].x,top:q[0].y,right:q[1].x,bottom:q[1].y,width:q[1].x-q[0].x,height:q[1].y-q[0].y};break;case"circle":(te={left:_.x[0]*(_.x[1]?A.width:1),top:_.y[0]*(_.y[1]?A.height:1),width:_.width[0]*(_.width[1]?A.width:1),height:_.height[0]*(_.height[1]?A.height:1)}).width||te.height||(te.width=te.height=10),te.width||(te.width=te.height),te.height||(te.height=te.width),te.right=te.left+te.width,te.bottom=te.top+te.height,re=te.left+te.width/2,j=te.top+te.height/2,$=fe.strokeWidth/2,_e=te.height/2,ee=(se=te.width/2)*Math.SQRT2+$,ye=_e*Math.SQRT2+$,fe.pathListRel=[[(Te=[{x:re-ee,y:j},{x:re,y:j-ye},{x:re+ee,y:j},{x:re,y:j+ye}])[0],{x:Te[0].x,y:Te[0].y-(Q=ye*Jr)},{x:Te[1].x-(G=ee*Jr),y:Te[1].y},Te[1]],[Te[1],{x:Te[1].x+G,y:Te[1].y},{x:Te[2].x,y:Te[2].y-Q},Te[2]],[Te[2],{x:Te[2].x,y:Te[2].y+Q},{x:Te[3].x+G,y:Te[3].y},Te[3]],[Te[3],{x:Te[3].x-G,y:Te[3].y},{x:Te[0].x,y:Te[0].y+Q},Te[0]],[]],fe.bBoxRel={left:(Te=[{x:te.left-(Ae=ee-se+fe.strokeWidth/2),y:te.top-(Ne=ye-_e+fe.strokeWidth/2)},{x:te.right+Ae,y:te.bottom+Ne}])[0].x,top:Te[0].y,right:Te[1].x,bottom:Te[1].y,width:Te[1].x-Te[0].x,height:Te[1].y-Te[0].y};break;case"polygon":_.points.forEach(function(k){var R=k.x[0]*(k.x[1]?A.width:1),de=k.y[0]*(k.y[1]?A.height:1);T?(R<T.left&&(T.left=R),R>T.right&&(T.right=R),de<T.top&&(T.top=de),de>T.bottom&&(T.bottom=de)):T={left:R,right:R,top:de,bottom:de},P?fe.pathListRel.push([P,{x:R,y:de}]):fe.pathListRel=[],P={x:R,y:de}}),fe.pathListRel.push([]),fe.bBoxRel={left:(le=[{x:T.left-(V=fe.strokeWidth/2),y:T.top-V},{x:T.right+V,y:T.bottom+V}])[0].x,top:le[0].y,right:le[1].x,bottom:le[1].y,width:le[1].x-le[0].x,height:le[1].y-le[0].y}}x.pathListRel=x.bBoxRel=!0}return(x.pathListRel||x.elementLeft||x.elementTop)&&(fe.pathData=_i(fe.pathListRel,function(k){k.x+=A.left,k.y+=A.top})),dt(_,D,"strokeWidth",C=fe.strokeWidth)&&(_.path.style.strokeWidth=C+"px"),Fn(C=fe.pathData,D.pathData)&&(_.path.setPathData(C),D.pathData=C,x.pathData=!0),_.dash&&(!x.pathData&&(!x.strokeWidth||_.dashLen&&_.dashGap)||(fe.dashLen=_.dashLen||2*fe.strokeWidth,fe.dashGap=_.dashGap||fe.strokeWidth),x.dash=dt(_,D,"dashLen",fe.dashLen)||x.dash,x.dash=dt(_,D,"dashGap",fe.dashGap)||x.dash,x.dash&&(_.path.style.strokeDasharray=D.dashLen+","+D.dashGap)),xe=D.viewBoxBBox,Fe=_.svg.viewBox.baseVal,ct=_.svg.style,(I=fe.viewBoxBBox).x=fe.bBoxRel.left+A.left,I.y=fe.bBoxRel.top+A.top,I.width=fe.bBoxRel.width,I.height=fe.bBoxRel.height,["x","y","width","height"].forEach(function(k){(C=I[k])!==xe[k]&&(Fe[k]=xe[k]=C,ct[li[k]]=C+("x"===k||"y"===k?_.bodyOffset[k]:0)+"px")}),x.strokeWidth||x.pathListRel||x.bBoxRel}},mouseHoverAnchor:{type:"anchor",argOptions:[{optionName:"element",type:Yi},{optionName:"showEffectName",type:"string"}],style:{backgroundImage:"url('data:image/svg+xml;charset=utf-8;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0Ij48cG9seWdvbiBwb2ludHM9IjI0LDAgMCw4IDgsMTEgMCwxOSA1LDI0IDEzLDE2IDE2LDI0IiBmaWxsPSJjb3JhbCIvPjwvc3ZnPg==')",backgroundSize:"",backgroundRepeat:"no-repeat",backgroundColor:"#f8f881",cursor:"default"},hoverStyle:{backgroundImage:"none",backgroundColor:"#fadf8f"},padding:{top:1,right:15,bottom:1,left:2},minHeight:15,backgroundPosition:{right:2,top:2},backgroundSize:{width:12,height:12},dirKeys:[["top","Top"],["right","Right"],["bottom","Bottom"],["left","Left"]],init:function(_,A){var C,T,P,V,le,te,re,j,ee,ye,G,Q=$e.mouseHoverAnchor,$={};if(_.element=$e.pointAnchor.checkElement(A.element),!((ye=(j=_.element).ownerDocument)&&(ee=ye.defaultView)&&ee.HTMLElement&&j instanceof ee.HTMLElement))throw new Error("`element` must be HTML element");return Q.style.backgroundSize=Q.backgroundSize.width+"px "+Q.backgroundSize.height+"px",["style","hoverStyle"].forEach(function(se){var _e=Q[se];_[se]=Object.keys(_e).reduce(function(Ae,Ne){return Ae[Ne]=_e[Ne],Ae},{})}),"inline"===(C=_.element.ownerDocument.defaultView.getComputedStyle(_.element,"")).display?_.style.display="inline-block":"none"===C.display&&(_.style.display="block"),$e.mouseHoverAnchor.dirKeys.forEach(function(se){var _e=se[0],Ae="padding"+se[1];parseFloat(C[Ae])<Q.padding[_e]&&(_.style[Ae]=Q.padding[_e]+"px")}),_.style.display&&(V=_.element.style.display,_.element.style.display=_.style.display),$e.mouseHoverAnchor.dirKeys.forEach(function(se){var _e="padding"+se[1];_.style[_e]&&($[_e]=_.element.style[_e],_.element.style[_e]=_.style[_e])}),(P=_.element.getBoundingClientRect()).height<Q.minHeight&&(Xt?(G=Q.minHeight,"content-box"===C.boxSizing?G-=parseFloat(C.borderTopWidth)+parseFloat(C.borderBottomWidth)+parseFloat(C.paddingTop)+parseFloat(C.paddingBottom):"padding-box"===C.boxSizing&&(G-=parseFloat(C.borderTopWidth)+parseFloat(C.borderBottomWidth)),_.style.height=G+"px"):_.style.height=parseFloat(C.height)+(Q.minHeight-P.height)+"px"),_.style.backgroundPosition=Sn?P.width-Q.backgroundSize.width-Q.backgroundPosition.right+"px "+Q.backgroundPosition.top+"px":"right "+Q.backgroundPosition.right+"px top "+Q.backgroundPosition.top+"px",_.style.display&&(_.element.style.display=V),$e.mouseHoverAnchor.dirKeys.forEach(function(se){var _e="padding"+se[1];_.style[_e]&&(_.element.style[_e]=$[_e])}),["style","hoverStyle"].forEach(function(se){var _e=_[se],Ae=A[se];Wi(Ae)&&Object.keys(Ae).forEach(function(Ne){"string"==typeof Ae[Ne]||ln(Ae[Ne])?_e[Ne]=Ae[Ne]:null==Ae[Ne]&&delete _e[Ne]})}),"function"==typeof A.onSwitch&&(re=A.onSwitch),A.showEffectName&&Tt[A.showEffectName]&&(_.showEffectName=le=A.showEffectName),te=A.animOptions,_.elmStyle=T=_.element.style,_.mouseenter=function(se){_.hoverStyleSave=Q.getStyles(T,Object.keys(_.hoverStyle)),Q.setStyles(T,_.hoverStyle),_.boundTargets.forEach(function(_e){$r(_e.props,!0,le,te)}),re&&re(se)},_.mouseleave=function(se){Q.setStyles(T,_.hoverStyleSave),_.boundTargets.forEach(function(_e){$r(_e.props,!1,le,te)}),re&&re(se)},!0},bind:function(_,A){var C,T,P,V,le;return A.props.svg?$e.mouseHoverAnchor.llShow(A.props,!1,_.showEffectName):gr(function(){$e.mouseHoverAnchor.llShow(A.props,!1,_.showEffectName)}),_.enabled||(_.styleSave=$e.mouseHoverAnchor.getStyles(_.elmStyle,Object.keys(_.style)),$e.mouseHoverAnchor.setStyles(_.elmStyle,_.style),_.removeEventListener=(T=_.mouseenter,P=_.mouseleave,"onmouseenter"in(C=_.element)&&"onmouseleave"in C?(C.addEventListener("mouseenter",T,!1),C.addEventListener("mouseleave",P,!1),function(){C.removeEventListener("mouseenter",T,!1),C.removeEventListener("mouseleave",P,!1)}):(console.warn("mouseenter and mouseleave events polyfill is enabled."),C.addEventListener("mouseover",V=function(te){te.relatedTarget&&(te.relatedTarget===this||this.compareDocumentPosition(te.relatedTarget)&Node.DOCUMENT_POSITION_CONTAINED_BY)||T.apply(this,arguments)}),C.addEventListener("mouseout",le=function(te){te.relatedTarget&&(te.relatedTarget===this||this.compareDocumentPosition(te.relatedTarget)&Node.DOCUMENT_POSITION_CONTAINED_BY)||P.apply(this,arguments)}),function(){C.removeEventListener("mouseover",V,!1),C.removeEventListener("mouseout",le,!1)})),_.enabled=!0),!0},unbind:function(_,A){_.enabled&&_.boundTargets.length<=1&&(_.removeEventListener(),$e.mouseHoverAnchor.setStyles(_.elmStyle,_.styleSave),_.enabled=!1),$e.mouseHoverAnchor.llShow(A.props,!0,_.showEffectName)},removeOption:function(_,A){$e.pointAnchor.removeOption(_,A)},remove:function(_){_.boundTargets.length&&(console.error("LeaderLineAttachment was not unbound by remove"),_.boundTargets.forEach(function(A){$e.mouseHoverAnchor.unbind(_,A)}))},getBBoxNest:function(_,A){return Lo(_.element,A.baseWindow)},llShow:function(_,A,C){Tt[C||_.curStats.show_effect].stop(_,!0,A),_.aplStats.show_on=A},getStyles:function(_,A){return A.reduce(function(C,T){return C[T]=_[T],C},{})},setStyles:function(_,A){Object.keys(A).forEach(function(C){_[C]=A[C]})}},captionLabel:{type:"label",argOptions:[{optionName:"text",type:"string"}],stats:{color:{},x:{},y:{}},textStyleProps:["fontFamily","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","kerning","letterSpacing","wordSpacing","textDecoration"],init:function(_,A){return"string"==typeof A.text&&(_.text=A.text.trim()),!!_.text&&("string"==typeof A.color&&(_.color=A.color.trim()),_.outlineColor="string"==typeof A.outlineColor?A.outlineColor.trim():"#fff",Array.isArray(A.offset)&&ln(A.offset[0])&&ln(A.offset[1])&&(_.offset={x:A.offset[0],y:A.offset[1]}),ln(A.lineOffset)&&(_.lineOffset=A.lineOffset),$e.captionLabel.textStyleProps.forEach(function(C){null!=A[C]&&(_[C]=A[C])}),_.updateColor=function(C){$e.captionLabel.updateColor(_,C)},_.updateSocketXY=function(C){var T,P,V,le,te=_.curStats,re=_.aplStats,j=C.curStats,ee=j.position_socketXYSE[_.socketIndex];null!=ee.x&&(_.offset?(te.x=ee.x+_.offset.x,te.y=ee.y+_.offset.y):(T=_.height/2,P=Math.max(j.attach_plugSideLenSE[_.socketIndex]||0,j.line_strokeWidth/2),V=j.position_socketXYSE[_.socketIndex?0:1],4===ee.socketId||2===ee.socketId?(te.x=4===ee.socketId?ee.x-T-_.width:ee.x+T,te.y=V.y<ee.y?ee.y+P+T:ee.y-P-T-_.height):(te.x=V.x<ee.x?ee.x+P+T:ee.x-P-T-_.width,te.y=1===ee.socketId?ee.y-T-_.height:ee.y+T)),dt(_,re,"x",le=te.x)&&(_.elmPosition.x.baseVal.getItem(0).value=le),dt(_,re,"y",le=te.y)&&(_.elmPosition.y.baseVal.getItem(0).value=le+_.height))},_.updatePath=function(C){var T,P,V=_.curStats,le=_.aplStats,te=C.pathList.animVal||C.pathList.baseVal;te&&(T=$e.captionLabel.getMidPoint(te,_.lineOffset),V.x=T.x-_.width/2,V.y=T.y-_.height/2,dt(_,le,"x",P=V.x)&&(_.elmPosition.x.baseVal.getItem(0).value=P),dt(_,le,"y",P=V.y)&&(_.elmPosition.y.baseVal.getItem(0).value=P+_.height))},_.updateShow=function(C){$e.captionLabel.updateShow(_,C)},Sn&&(_.adjustEdge=function(C,T){var P=_.curStats;null!=P.x&&$e.captionLabel.adjustEdge(T,{x:P.x,y:P.y,width:_.width,height:_.height},_.strokeWidth/2)}),!0)},updateColor:function(_,A){var C,P=_.aplStats;_.curStats.color=C=_.color||A.curStats.line_color,dt(_,P,"color",C)&&(_.styleFill.fill=C)},updateShow:function(_,A){var C=!0===A.isShown;C!==_.isShown&&(_.styleShow.visibility=C?"":"hidden",_.isShown=C)},adjustEdge:function(_,A,C){var T={x1:A.x-C,y1:A.y-C,x2:A.x+A.width+C,y2:A.y+A.height+C};T.x1<_.x1&&(_.x1=T.x1),T.y1<_.y1&&(_.y1=T.y1),T.x2>_.x2&&(_.x2=T.x2),T.y2>_.y2&&(_.y2=T.y2)},newText:function(_,A,C,T,P){var V,le,te,re,j,ee;return(V=A.createElementNS(vt,"text")).textContent=_,[V.x,V.y].forEach(function(ye){var G=C.createSVGLength();G.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX,0),ye.baseVal.initialize(G)}),"boolean"!=typeof lo&&(lo="paintOrder"in V.style),P&&!lo?(te=A.createElementNS(vt,"defs"),V.id=T,te.appendChild(V),(j=(le=A.createElementNS(vt,"g")).appendChild(A.createElementNS(vt,"use"))).href.baseVal="#"+T,(re=le.appendChild(A.createElementNS(vt,"use"))).href.baseVal="#"+T,(ee=j.style).strokeLinejoin="round",{elmPosition:V,styleText:V.style,styleFill:re.style,styleStroke:ee,styleShow:le.style,elmsAppend:[te,le]}):(ee=V.style,P&&(ee.strokeLinejoin="round",ee.paintOrder="stroke"),{elmPosition:V,styleText:ee,styleFill:ee,styleStroke:P?ee:null,styleShow:ee,elmsAppend:[V]})},getMidPoint:function(_,A){var C,T,P,V=$o(_),le=V.segsLen,te=V.lenAll,re=-1;if((C=te/2+(A||0))<=0)return 2===(T=_[0]).length?Fo(T[0],T[1],0):Bi(T[0],T[1],T[2],T[3],0);if(te<=C)return 2===(T=_[_.length-1]).length?Fo(T[0],T[1],1):Bi(T[0],T[1],T[2],T[3],1);for(P=[];C>le[++re];)P.push(_[re]),C-=le[re];return 2===(T=_[re]).length?Fo(T[0],T[1],C/le[re]):Bi(T[0],T[1],T[2],T[3],Vi(T[0],T[1],T[2],T[3],C))},initSvg:function(_,A){var C,T,P=$e.captionLabel.newText(_.text,A.baseWindow.document,A.svg,ui+"-captionLabel-"+_._id,_.outlineColor);["elmPosition","styleFill","styleShow","elmsAppend"].forEach(function(V){_[V]=P[V]}),_.isShown=!1,_.styleShow.visibility="hidden",$e.captionLabel.textStyleProps.forEach(function(V){null!=_[V]&&(P.styleText[V]=_[V])}),P.elmsAppend.forEach(function(V){A.svg.appendChild(V)}),C=P.elmPosition.getBBox(),_.width=C.width,_.height=C.height,_.outlineColor&&(T=10<(T=C.height/9)?10:T<2?2:T,P.styleStroke.strokeWidth=T+"px",P.styleStroke.stroke=_.outlineColor),_.strokeWidth=T||0,On(_.aplStats,$e.captionLabel.stats),_.updateColor(A),_.refSocketXY?_.updateSocketXY(A):_.updatePath(A),Sn&&mi(A,{}),_.updateShow(A)},bind:function(_,A){var C=A.props;return _.color||Hn(C,"cur_line_color",_.updateColor),(_.refSocketXY="startLabel"===A.optionName||"endLabel"===A.optionName)?(_.socketIndex="startLabel"===A.optionName?0:1,Hn(C,"apl_position",_.updateSocketXY),_.offset||(Hn(C,"cur_attach_plugSideLenSE",_.updateSocketXY),Hn(C,"cur_line_strokeWidth",_.updateSocketXY))):Hn(C,"apl_path",_.updatePath),Hn(C,"svgShow",_.updateShow),Sn&&Hn(C,"new_edge4viewBox",_.adjustEdge),$e.captionLabel.initSvg(_,C),!0},unbind:function(_,A){var C=A.props;_.elmsAppend&&(_.elmsAppend.forEach(function(T){C.svg.removeChild(T)}),_.elmPosition=_.styleFill=_.styleShow=_.elmsAppend=null),On(_.curStats,$e.captionLabel.stats),On(_.aplStats,$e.captionLabel.stats),_.color||Wn(C,"cur_line_color",_.updateColor),_.refSocketXY?(Wn(C,"apl_position",_.updateSocketXY),_.offset||(Wn(C,"cur_attach_plugSideLenSE",_.updateSocketXY),Wn(C,"cur_line_strokeWidth",_.updateSocketXY))):Wn(C,"apl_path",_.updatePath),Wn(C,"svgShow",_.updateShow),Sn&&(Wn(C,"new_edge4viewBox",_.adjustEdge),mi(C,{}))},removeOption:function(_,A){var C=A.props,T={};T[A.optionName]="",_r(C,T)},remove:function(_){_.boundTargets.length&&(console.error("LeaderLineAttachment was not unbound by remove"),_.boundTargets.forEach(function(A){$e.captionLabel.unbind(_,A)}))}},pathLabel:{type:"label",argOptions:[{optionName:"text",type:"string"}],stats:{color:{},startOffset:{},pathData:{}},init:function(_,A){return"string"==typeof A.text&&(_.text=A.text.trim()),!!_.text&&("string"==typeof A.color&&(_.color=A.color.trim()),_.outlineColor="string"==typeof A.outlineColor?A.outlineColor.trim():"#fff",ln(A.lineOffset)&&(_.lineOffset=A.lineOffset),$e.captionLabel.textStyleProps.forEach(function(C){null!=A[C]&&(_[C]=A[C])}),_.updateColor=function(C){$e.captionLabel.updateColor(_,C)},_.updatePath=function(C){var T,V=_.aplStats,te=C.pathList.animVal||C.pathList.baseVal;te&&(_.curStats.pathData=T=$e.pathLabel.getOffsetPathData(te,C.curStats.line_strokeWidth/2+_.strokeWidth/2+_.height/4,1.25*_.height),Fn(T,V.pathData)&&(_.elmPath.setPathData(T),V.pathData=T,_.bBox=_.elmPosition.getBBox(),_.updateStartOffset(C)))},_.updateStartOffset=function(C){var T,P,V,le,te=_.curStats,re=_.aplStats,j=C.curStats;te.pathData&&(2!==_.semIndex||_.lineOffset)&&(T=te.pathData.reduce(function(ee,ye){var G,Q=ye.values;switch(ye.type){case"M":le={x:Q[0],y:Q[1]};break;case"L":G={x:Q[0],y:Q[1]},le&&(ee+=Kn(le,G)),le=G;break;case"C":G={x:Q[4],y:Q[5]},le&&(ee+=fo(le,{x:Q[0],y:Q[1]},{x:Q[2],y:Q[3]},G)),le=G}return ee},0),V=0===_.semIndex?0:1===_.semIndex?T:T/2,2!==_.semIndex&&(P=Math.max(j.attach_plugBackLenSE[_.semIndex]||0,j.line_strokeWidth/2)+_.strokeWidth/2+_.height/4,V=(V+=0===_.semIndex?P:-P)<0?0:T<V?T:V),_.lineOffset&&(V=(V+=_.lineOffset)<0?0:T<V?T:V),te.startOffset=V,dt(_,re,"startOffset",V)&&(_.elmOffset.startOffset.baseVal.value=V))},_.updateShow=function(C){$e.captionLabel.updateShow(_,C)},Sn&&(_.adjustEdge=function(C,T){_.bBox&&$e.captionLabel.adjustEdge(T,_.bBox,_.strokeWidth/2)}),!0)},getOffsetPathData:function(_,A,C){var T,P,le=[];function te(re,j){return Math.abs(re.x-j.x)<3&&Math.abs(re.y-j.y)<3}return _.forEach(function(re){var j,ee,ye,G,Q,$,se,_e,Ae,Ne,Te,ge,ne,ue,oe,ut,ft,rt,q,Ee,I;2===re.length?(rt=re[0],q=re[1],Ee=A,I=Math.atan2(rt.y-q.y,q.x-rt.x)+.5*Math.PI,j=[{x:rt.x+Math.cos(I)*Ee,y:rt.y+Math.sin(I)*Ee*-1},{x:q.x+Math.cos(I)*Ee,y:q.y+Math.sin(I)*Ee*-1}],T?(ye=T.points,0<=(G=Math.atan2(ye[1].y-ye[0].y,ye[0].x-ye[1].x)-Math.atan2(re[0].y-re[1].y,re[1].x-re[0].x))&&G<=Math.PI?ee={type:"line",points:j,inside:!0}:($=Xi(ye[0],ye[1],A),Q=Xi(j[1],j[0],A),ge=(Ae=$).x-(_e=ye[0]).x,ft=((ue=(Te=j[1]).x-(Ne=Q).x)*(_e.y-Ne.y)-(oe=Te.y-Ne.y)*(_e.x-Ne.x))/(-ue*(ne=Ae.y-_e.y)+ge*oe),(se=0<=(ut=(-ne*(_e.x-Ne.x)+ge*(_e.y-Ne.y))/(-ue*ne+ge*oe))&&ut<=1&&0<=ft&&ft<=1?{x:_e.x+ft*ge,y:_e.y+ft*ne}:null)?ee={type:"line",points:[ye[1]=se,j[1]]}:(ye[1]=te(Q,$)?Q:$,ee={type:"line",points:[Q,j[1]]}),T.len=Kn(ye[0],ye[1]))):ee={type:"line",points:j},ee.len=Kn(ee.points[0],ee.points[1]),le.push(T=ee)):(le.push({type:"cubic",points:function(xe,Fe,ct,fe,D,H){for(var x,k,R=fo(xe,Fe,ct,fe)/16,de=1/(16<D?R*(D/16):R),Ye=[],Qt=0;k=(90-(x=Bi(xe,Fe,ct,fe,Qt)).angle)*(Math.PI/180),Ye.push({x:x.x+Math.cos(k)*D,y:x.y+Math.sin(k)*D*-1}),!(1<=Qt);)1<(Qt+=de)&&(Qt=1);return Ye}(re[0],re[1],re[2],re[3],A)}),T=null)}),T=null,le.forEach(function(re){var j;"line"===re.type?(re.inside&&(T.len>A?((j=T.points)[1]=Xi(j[0],j[1],-A),T.len=Kn(j[0],j[1])):(T.points=null,T.len=0),re.len>A+C?((j=re.points)[0]=Xi(j[1],j[0],-(A+C)),re.len=Kn(j[0],j[1])):(re.points=null,re.len=0)),T=re):T=null}),le.reduce(function(re,j){var ee=j.points;return ee&&(P&&te(ee[0],P)||re.push({type:"M",values:[ee[0].x,ee[0].y]}),"line"===j.type?re.push({type:"L",values:[ee[1].x,ee[1].y]}):(ee.shift(),ee.forEach(function(ye){re.push({type:"L",values:[ye.x,ye.y]})})),P=ee[ee.length-1]),re},[])},newText:function(_,A,C,T){var P,V,le,te,re,j,ee,ye,G,Q;return(te=(le=A.createElementNS(vt,"defs")).appendChild(A.createElementNS(vt,"path"))).id=P=C+"-path",(j=(re=A.createElementNS(vt,"text")).appendChild(A.createElementNS(vt,"textPath"))).href.baseVal="#"+P,j.startOffset.baseVal.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX,0),j.textContent=_,"boolean"!=typeof lo&&(lo="paintOrder"in re.style),T&&!lo?(re.id=V=C+"-text",le.appendChild(re),(G=(ee=A.createElementNS(vt,"g")).appendChild(A.createElementNS(vt,"use"))).href.baseVal="#"+V,(ye=ee.appendChild(A.createElementNS(vt,"use"))).href.baseVal="#"+V,(Q=G.style).strokeLinejoin="round",{elmPosition:re,elmPath:te,elmOffset:j,styleText:re.style,styleFill:ye.style,styleStroke:Q,styleShow:ee.style,elmsAppend:[le,ee]}):(Q=re.style,T&&(Q.strokeLinejoin="round",Q.paintOrder="stroke"),{elmPosition:re,elmPath:te,elmOffset:j,styleText:Q,styleFill:Q,styleStroke:T?Q:null,styleShow:Q,elmsAppend:[le,re]})},initSvg:function(_,A){var C,T,P=$e.pathLabel.newText(_.text,A.baseWindow.document,ui+"-pathLabel-"+_._id,_.outlineColor);["elmPosition","elmPath","elmOffset","styleFill","styleShow","elmsAppend"].forEach(function(V){_[V]=P[V]}),_.isShown=!1,_.styleShow.visibility="hidden",$e.captionLabel.textStyleProps.forEach(function(V){null!=_[V]&&(P.styleText[V]=_[V])}),P.elmsAppend.forEach(function(V){A.svg.appendChild(V)}),P.elmPath.setPathData([{type:"M",values:[0,100]},{type:"h",values:[100]}]),C=P.elmPosition.getBBox(),P.styleText.textAnchor=["start","end","middle"][_.semIndex],2!==_.semIndex||_.lineOffset||P.elmOffset.startOffset.baseVal.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PERCENTAGE,50),_.height=C.height,_.outlineColor&&(T=10<(T=C.height/9)?10:T<2?2:T,P.styleStroke.strokeWidth=T+"px",P.styleStroke.stroke=_.outlineColor),_.strokeWidth=T||0,On(_.aplStats,$e.pathLabel.stats),_.updateColor(A),_.updatePath(A),_.updateStartOffset(A),Sn&&mi(A,{}),_.updateShow(A)},bind:function(_,A){var C=A.props;return _.color||Hn(C,"cur_line_color",_.updateColor),Hn(C,"cur_line_strokeWidth",_.updatePath),Hn(C,"apl_path",_.updatePath),_.semIndex="startLabel"===A.optionName?0:"endLabel"===A.optionName?1:2,(2!==_.semIndex||_.lineOffset)&&Hn(C,"cur_attach_plugBackLenSE",_.updateStartOffset),Hn(C,"svgShow",_.updateShow),Sn&&Hn(C,"new_edge4viewBox",_.adjustEdge),$e.pathLabel.initSvg(_,C),!0},unbind:function(_,A){var C=A.props;_.elmsAppend&&(_.elmsAppend.forEach(function(T){C.svg.removeChild(T)}),_.elmPosition=_.elmPath=_.elmOffset=_.styleFill=_.styleShow=_.elmsAppend=null),On(_.curStats,$e.pathLabel.stats),On(_.aplStats,$e.pathLabel.stats),_.color||Wn(C,"cur_line_color",_.updateColor),Wn(C,"cur_line_strokeWidth",_.updatePath),Wn(C,"apl_path",_.updatePath),(2!==_.semIndex||_.lineOffset)&&Wn(C,"cur_attach_plugBackLenSE",_.updateStartOffset),Wn(C,"svgShow",_.updateShow),Sn&&(Wn(C,"new_edge4viewBox",_.adjustEdge),mi(C,{}))},removeOption:function(_,A){var C=A.props,T={};T[A.optionName]="",_r(C,T)},remove:function(_){_.boundTargets.length&&(console.error("LeaderLineAttachment was not unbound by remove"),_.boundTargets.forEach(function(A){$e.pathLabel.unbind(_,A)}))}}},Object.keys($e).forEach(function(_){Mi[_]=function(){return new yn($e[_],Array.prototype.slice.call(arguments))}}),Mi.positionByWindowResize=!0,window.addEventListener("resize",Ra.add(function(){Mi.positionByWindowResize&&Object.keys(di).forEach(function(_){mi(di[_],{position:!0})})}),!1)}()},534:(Yr,cn,Tt)=>{"use strict";Tt.r(cn),Tt.d(cn,{PipelineModule:()=>fe});var $e=Tt(8583),yn=Tt(8239),nr=Tt(2298),cr=Tt(6215),Er=Tt(8049);function Qo(D,H){return D.find(x=>x.name===H)}var hr=(()=>{return(D=hr||(hr={})).inner="inner join",D.left="left outer join",D.right="right outer join",D.full="full outer join",hr;var D})();const Mo={[hr.inner]:{title:"\u0627\u0644\u062d\u0627\u0642 \u062f\u0627\u062e\u0644\u06cc"},[hr.left]:{title:"\u0627\u0644\u062d\u0627\u0642 \u0627\u0632 \u0686\u067e"},[hr.right]:{title:"\u0627\u0644\u062d\u0627\u0642 \u0627\u0632 \u0631\u0627\u0633\u062a"},[hr.full]:{title:"\u0627\u0644\u062d\u0627\u0642 \u06a9\u0627\u0645\u0644"}};var qi=(()=>{return(D=qi||(qi={})).count="count",D.sum="sum",D.average="average",D.min="min",D.max="max",qi;var D})();const ui={[qi.count]:{title:"\u0634\u0645\u0627\u0631\u0634"},[qi.sum]:{title:"\u0645\u062c\u0645\u0648\u0639"},[qi.average]:{title:"\u0645\u06cc\u0627\u0646\u06af\u06cc\u0646"},[qi.min]:{title:"\u06a9\u0645\u06cc\u0646\u0647"},[qi.max]:{title:"\u0628\u06cc\u0634\u06cc\u0646\u0647"}};var _t=(()=>{return(D=_t||(_t={})).datasetInput="dataset_input",D.datasetOutput="dataset_output",D.filter="filter",D.sort="sort",D.join="join",D.aggregate="aggregate",_t;var D})();const gi={[_t.datasetInput]:{type:_t.datasetInput,title:"\u062f\u06cc\u062a\u0627\u0633\u062a \u0648\u0631\u0648\u062f\u06cc",altTitle:"",numInputs:0,hasOutput:!0,iconName:"file_download",iconMirrored:!1},[_t.datasetOutput]:{type:_t.datasetOutput,title:"\u062f\u06cc\u062a\u0627\u0633\u062a \u062e\u0631\u0648\u062c\u06cc",altTitle:"",numInputs:1,hasOutput:!1,iconName:"publish",iconMirrored:!1},[_t.sort]:{type:_t.sort,title:"\u0645\u0631\u062a\u0628\u200c\u0633\u0627\u0632\u06cc",altTitle:"Sort",numInputs:1,hasOutput:!0,iconName:"sort_by_alpha",iconMirrored:!1},[_t.filter]:{type:_t.filter,title:"\u0641\u06cc\u0644\u062a\u0631",altTitle:"Filter",numInputs:1,hasOutput:!0,iconName:"filter_alt",iconMirrored:!1},[_t.join]:{type:_t.join,title:"\u0627\u0644\u062d\u0627\u0642",altTitle:"Join",numInputs:1,hasOutput:!0,iconName:"merge_type",iconMirrored:!1},[_t.aggregate]:{type:_t.aggregate,title:"\u062a\u062c\u0645\u06cc\u0639",altTitle:"Aggregate",numInputs:1,hasOutput:!0,iconName:"stacked_bar_chart",iconMirrored:!0}};class Ci{constructor(H,x,k,R,de){this.id=H,this.name=x,this.type=k,this.position=R,this.inputs=de,this.validations=new nr.t(1),this.inputFields=[],this.outputFields=new cr.X([]),this.typeInfo=gi[k];for(const Ye in de)this.inputFields.push(new cr.X([]))}updateFields(H,x){var k=this;return(0,yn.Z)(function*(){yield k.updateInputFields(H,x),yield k.updateOutputFields(H,x)})()}updateInputFields(H,x){var k=this;return(0,yn.Z)(function*(){for(const R in k.inputs){if(null===k.inputs[R])continue;const de=H.getNode(k.inputs[R]);void 0!==de&&k.inputFields[R].next(de.node.outputFields.value)}})()}validate(H,x){var k=this;return(0,yn.Z)(function*(){let R=Object.assign(Object.assign({},yield k.validateInputs(H)),yield k.validateConfig(H,x));return k.validations.next(R),R})()}validateInputs(H){var x=this;return(0,yn.Z)(function*(){return x.inputs.some(k=>null===k||void 0===H.getNode(k))?{inputs:"\u0648\u0631\u0648\u062f\u06cc \u0627\u06cc\u0646 \u06af\u0631\u0647 \u0628\u0647 \u06af\u0631\u0647 \u062f\u06cc\u06af\u0631\u06cc \u0645\u062a\u0635\u0644 \u0646\u0634\u062f\u0647 \u0627\u0633\u062a"}:{}})()}export(){return{nodeId:this.id,name:this.name,type:this.type,position:JSON.stringify(this.position),inputs:JSON.stringify(this.inputs),instruction:JSON.stringify(this.exportConfig())}}exportConfig(){}}const Nt={[_t.datasetInput]:class extends Ci{constructor(H,x,k,R,de){super(H,x,_t.datasetInput,k,R),this.id=H,this.name=x,this.position=k,this.inputs=R,this.config=de||{}}updateOutputFields(H,x){var k=this;return(0,yn.Z)(function*(){if(void 0!==k.config.datasetId){const R=yield x.getFields(k.config.datasetId).pipe((0,Er.P)()).toPromise();k.outputFields.next(R.fields)}})()}validateConfig(H,x){var k=this;return(0,yn.Z)(function*(){let R={};return void 0===k.config.datasetId&&(R.datasetId="\u062f\u06cc\u062a\u0627\u0633\u062a \u0648\u0631\u0648\u062f\u06cc \u0627\u0646\u062a\u062e\u0627\u0628 \u0646\u0634\u062f\u0647 \u0627\u0633\u062a"),R})()}exportConfig(){return{datasetId:this.config.datasetId}}static importConfig(H){return{datasetId:H.datasetId}}},[_t.datasetOutput]:class extends Ci{constructor(H,x,k,R,de){super(H,x,_t.datasetOutput,k,R),this.id=H,this.name=x,this.position=k,this.inputs=R,this.config=de||{overwrite:!1}}updateOutputFields(H,x){return(0,yn.Z)(function*(){})()}validateConfig(H,x){var k=this;return(0,yn.Z)(function*(){let R={};return void 0===k.config.datasetId&&(R.datasetId="\u062f\u06cc\u062a\u0627\u0633\u062a \u062e\u0631\u0648\u062c\u06cc \u0627\u0646\u062a\u062e\u0627\u0628 \u0646\u0634\u062f\u0647 \u0627\u0633\u062a"),R})()}exportConfig(){return{datasetId:this.config.datasetId,overwrite:this.config.overwrite}}static importConfig(H){return{datasetId:H.datasetId,overwrite:H.overwrite}}},[_t.sort]:class extends Ci{constructor(H,x,k,R,de){super(H,x,_t.sort,k,R),this.id=H,this.name=x,this.position=k,this.inputs=R,this.config=de||{orders:[]}}updateOutputFields(H,x){var k=this;return(0,yn.Z)(function*(){k.outputFields.next(k.inputFields[0].value)})()}validateConfig(H,x){return(0,yn.Z)(function*(){return{}})()}exportConfig(){return{orders:this.config.orders}}static importConfig(H){return{orders:H.orders}}},[_t.filter]:class extends Ci{constructor(H,x,k,R,de){super(H,x,_t.filter,k,R),this.id=H,this.name=x,this.position=k,this.inputs=R,this.config=de||{Command:"="}}updateOutputFields(H,x){var k=this;return(0,yn.Z)(function*(){k.outputFields.next(k.inputFields[0].value)})()}validateConfig(H,x){return(0,yn.Z)(function*(){return{}})()}exportConfig(){return this.config}static importConfig(H){return H}},[_t.join]:class extends Ci{constructor(H,x,k,R,de){super(H,x,_t.join,k,R),this.id=H,this.name=x,this.position=k,this.inputs=R,this.config=de||{type:hr.inner,joinWith:void 0,leftTableKey:"",rightTableKey:""},this.inputFields.push(new cr.X([]))}updateOutputFields(H,x){var k=this;return(0,yn.Z)(function*(){let R=k.inputFields[0].value;if(void 0!==k.config.joinWith){const de=yield x.getFields(k.config.joinWith).pipe((0,Er.P)()).toPromise();R=R.concat(de.fields)}k.outputFields.next(R)})()}validateConfig(H,x){var k=this;return(0,yn.Z)(function*(){let R={};return void 0===k.config.joinWith&&(R.joinWith="\u062f\u06cc\u062a\u0627\u0633\u062a \u0628\u0631\u0627\u06cc \u0627\u0644\u062d\u0627\u0642 \u0627\u0646\u062a\u062e\u0627\u0628 \u0646\u0634\u062f\u0647 \u0627\u0633\u062a"),R})()}exportConfig(){return{type:this.config.type,joinWith:this.config.joinWith,leftTableKey:this.config.leftTableKey,rightTableKey:this.config.rightTableKey}}static importConfig(H){return{type:H.type,joinWith:H.joinWith,leftTableKey:H.leftTableKey,rightTableKey:H.rightTableKey}}},[_t.aggregate]:class extends Ci{constructor(H,x,k,R,de){super(H,x,_t.aggregate,k,R),this.id=H,this.name=x,this.position=k,this.inputs=R,this.config=de||{groupBy:[],operations:[]}}updateOutputFields(H,x){var k=this;return(0,yn.Z)(function*(){const R=k.config.groupBy.reduce((Qt,Ii)=>{const kt=Qo(k.inputFields[0].value,Ii);return void 0!==kt&&Qt.push(kt),Qt},[]),de=k.config.operations.reduce((Qt,Ii)=>{const kt=Qo(k.inputFields[0].value,Ii.fieldName);return void 0!==kt&&Qt.push({name:Ii.outputFieldName,type:kt.type}),Qt},[]),Ye=R.concat(de);k.outputFields.next(Ye)})()}validateConfig(H,x){return(0,yn.Z)(function*(){return{}})()}exportConfig(){return this.config}static importConfig(H){return{groupBy:H.groupBy,operations:H.operations}}}};function Io(D){const H=Nt[D.type],x=H.importConfig(JSON.parse(D.instruction));return new H(D.nodeId,D.name,JSON.parse(D.position),JSON.parse(D.inputs),x)}var Jn=Tt(3461),ho=Tt(9765),hs=Tt(1439);function Sr(D){return Object.keys(D).length>0}function ko(D){return Object.keys(D).map(H=>({key:H,value:D[H]}))}class bi{constructor(H,x){this.id=H,this.name=x,this.nodes=[],this.nodeAdded=new ho.xQ,this.nodeEdited=new ho.xQ,this.nodeRemoved=new ho.xQ,this.loaded=new nr.t(1),this.validations=new nr.t(1)}getNode(H){const x=this.nodes.findIndex(k=>k.id===H);if(!(x<0))return{index:x,node:this.nodes[x]}}addNode(H){if(void 0!==this.getNode(H.id))throw new Error("A node with the same id already exists in the pipeline");this.nodes.push(H),this.nodeAdded.next(H)}createNode(H,x,k={x:0,y:0},R){if(void 0!==R){if(R.length!==gi[x].numInputs)throw new Error("Invalid number of inputs")}else R=new Array(gi[x].numInputs).fill(null);const de=new Nt[x](this.nextId,H,k,R);return this.addNode(de),de.id}get nextId(){return Math.max(0,...this.nodes.map(H=>H.id+1))}editNode(H){var x;const k=null===(x=this.getNode(H.id))||void 0===x?void 0:x.index;if(void 0===k)throw new Error("A node with the given id does not exist in the pipeline");this.nodes[k]=H,this.nodeEdited.next(H)}markNodeAsEdited(H){var x;const k=null===(x=this.getNode(H))||void 0===x?void 0:x.node;if(void 0===k)throw new Error("A node with the given id does not exist in the pipeline");this.nodeEdited.next(k)}removeNode(H){const x=this.nodes.findIndex(R=>R.id===H);if(x<0)throw new Error("A node with the given id does not exist in the pipeline");this.nodes.forEach(R=>{let de=!1;for(let Ye=0;Ye<R.inputs.length;Ye++)R.inputs[Ye]===H&&(R.inputs[Ye]=null,de=!0);de&&this.nodeEdited.next(R)});const k=this.nodes.splice(x,1)[0];this.nodeRemoved.next(k)}validate(H){var x=this;return(0,hs.P)((0,yn.Z)(function*(){let k=x.reorder();if(Object.keys(k).length>0)return x.validations.next(k),k;1!==x.nodes.filter(de=>de.type===_t.datasetInput).length&&(k.inputs="\u062a\u0646\u0647\u0627 \u06cc\u06a9 \u06af\u0631\u0647 \u062f\u06cc\u062a\u0627\u0633\u062a \u0648\u0631\u0648\u062f\u06cc \u0628\u0627\u06cc\u062f \u0648\u062c\u0648\u062f \u062f\u0627\u0634\u062a\u0647 \u0628\u0627\u0634\u062f"),x.nodes.filter(de=>de.type===_t.datasetOutput).length>1&&(k.outputs="\u062d\u062f\u0627\u06a9\u062b\u0631 \u06cc\u06a9 \u06af\u0631\u0647 \u062f\u06cc\u062a\u0627\u0633\u062a \u062e\u0631\u0648\u062c\u06cc \u0628\u0627\u06cc\u062f \u0648\u062c\u0648\u062f \u062f\u0627\u0634\u062a\u0647 \u0628\u0627\u0634\u062f");for(const de of x.nodes)yield de.updateOutputFields(x,H);let R=!1;for(const de of x.nodes){const Ye=yield de.validate(x,H);R||(R=Sr(Ye))}return R&&(k.nodes="\u06cc\u06a9\u06cc \u0627\u0632 \u06af\u0631\u0647\u200c\u0647\u0627 \u0646\u0627\u0645\u0639\u062a\u0628\u0631 \u0627\u0633\u062a"),k}))}reorder(){const H=[];for(let x=0;x<this.nodes.length;x++){let k=!1,R=x;for(;R<this.nodes.length;R++)if(this.nodes[R].inputs.every(Ye=>null===Ye||H.includes(Ye))){k=!0;break}if(!k)return{circular:"\u06af\u0631\u0627\u0641 \u0634\u0627\u0645\u0644 \u062f\u0648\u0631 \u0627\u0633\u062a"};H.push(this.nodes[R].id),(0,Jn.bA)(this.nodes,R,x)}return{}}}const Xr=(()=>{const D=new bi(void 0,"\u0633\u0646\u0627\u0631\u06cc\u0648 \u062c\u062f\u06cc\u062f"),H=D.createNode("\u062f\u06cc\u062a\u0627\u0633\u062a \u0648\u0631\u0648\u062f\u06cc",_t.datasetInput,{x:3,y:5});return D.createNode("\u062f\u06cc\u062a\u0627\u0633\u062a \u062e\u0631\u0648\u062c\u06cc",_t.datasetOutput,{x:11,y:5},[H]),D})();function pr(D){const H=D.nodes.filter(de=>de.type===_t.datasetInput);if(H.length>1)throw new Error("\u062d\u062f\u0627\u06a9\u062b\u0631 \u06cc\u06a9 \u06af\u0631\u0647 \u062f\u06cc\u062a\u0627\u0633\u062a \u0648\u0631\u0648\u062f\u06cc \u067e\u0634\u062a\u06cc\u0628\u0627\u062a\u06cc \u0645\u06cc\u200c\u0634\u0648\u062f");const x=D.nodes.filter(de=>de.type===_t.datasetOutput);if(H.length>1)throw new Error("\u062d\u062f\u0627\u06a9\u062b\u0631 \u06cc\u06a9 \u06af\u0631\u0647 \u062f\u06cc\u062a\u0627\u0633\u062a \u062e\u0631\u0648\u062c\u06cc \u067e\u0634\u062a\u06cc\u0628\u0627\u062a\u06cc \u0645\u06cc\u200c\u0634\u0648\u062f");const k=H[0],R=x[0];return{pipelineId:D.id,pipelineName:D.name,inputDatasetId:(null==k?void 0:k.config.datasetId)||0,inputDataset:k?JSON.stringify(k.export()):null,outputDatasetId:(null==R?void 0:R.config.datasetId)||0,outputDataset:R?JSON.stringify(R.export()):null,overwrite:(null==R?void 0:R.config.overwrite)||!1,processes:D.nodes.filter(de=>de.type!==_t.datasetInput&&de.type!==_t.datasetOutput).map(de=>de.export())}}function li(D){const H=new bi(D.pipelineId,D.pipelineName);if(null!==D.inputDataset){const x=JSON.parse(D.inputDataset);H.addNode(Io(x))}for(const x of D.processes)H.addNode(Io(x));if(null!==D.outputDataset){const x=JSON.parse(D.outputDataset);H.addNode(Io(x))}return H}var f=Tt(7716),Fr=Tt(3423),Fa=Tt(2675);let ps=(()=>{class D{constructor(x,k){this.router=x,this.pipelineService=k}ngOnInit(){this.pipelineService.create(pr(Xr)).subscribe(x=>{this.router.navigate(["pipeline",x])})}}return D.\u0275fac=function(x){return new(x||D)(f.Y36(Fr.F0),f.Y36(Fa.n))},D.\u0275cmp=f.Xpm({type:D,selectors:[["app-initial-creator"]],decls:0,vars:0,template:function(x,k){},styles:[""]}),D})();var Pr=Tt(4299),Pa=Tt.n(Pr),fr=Tt(7556),Hi=Tt(810);let Jr=(()=>{class D{constructor(x){this.datasetService=x,this.datasets=new nr.t(1),this.datasetDetails={}}update(){this.datasetService.getAll().subscribe(x=>{this.datasets.next(x)})}getFields(x){return void 0===this.datasetDetails[x]&&this.updateFields(x),this.datasetDetails[x]}updateFields(x){void 0===this.datasetDetails[x]&&(this.datasetDetails[x]=new nr.t(1)),this.datasetService.get(x).subscribe(k=>{this.datasetDetails[x].next(k)})}}return D.\u0275fac=function(x){return new(x||D)(f.LFG(Hi.d))},D.\u0275prov=f.Yz7({token:D,factory:D.\u0275fac}),D})();var Qr=Tt(6458),Da=Tt(2522),vt=Tt(1095),un=Tt(6627),Xt=Tt(8295),En=Tt(9983),Ht=Tt(3679),Sn=Tt(5384),Ei=Tt(3017),Qn=Tt(3738);let Wi=(()=>{class D{constructor(x){this.hostRef=x,this.onInit=new f.vpe,this.afterViewInit=new f.vpe,this.onDestroy=new f.vpe}ngOnInit(){this.onInit.emit(this.hostRef.nativeElement)}ngAfterViewInit(){this.afterViewInit.emit(this.hostRef.nativeElement)}ngOnDestroy(){this.onDestroy.emit(this.hostRef.nativeElement)}}return D.\u0275fac=function(x){return new(x||D)(f.Y36(f.SBq))},D.\u0275dir=f.lG2({type:D,selectors:[["","spy-element",""]],outputs:{onInit:"onInit",afterViewInit:"afterViewInit",onDestroy:"onDestroy"}}),D})();var ln=Tt(2458);Tt(70);let ir=(()=>{class D{constructor(x){this.document=x}onContainer(x){return(k,R,de)=>{let Ye;Ye=void 0===de?new LeaderLine(k,R):new LeaderLine(k,R,de);const Qt=this.document.querySelector("body > .leader-line:last-of-type");if(!Qt)return console.error("element of line was not found:",Ye),Ye;x.appendChild(Qt);const Ii=Ye.remove;return Ye.remove=()=>{this.document.body.appendChild(Qt),Ii.bind(Ye)()},Ye}}}return D.\u0275fac=function(x){return new(x||D)(f.LFG($e.K0))},D.\u0275prov=f.Yz7({token:D,factory:D.\u0275fac}),D})();const Ra=["connectionEnd"],Oo=["connectionEndPreview"],fs=["*"];let gs=(()=>{class D{constructor(x,k){this.lineService=x,this.document=k,this.connectionRestVisibility=!0}tryToInitializeLine(){var x,k;if(void 0===this.line&&void 0!==this.lineContainer&&void 0!==this.connectionBegin&&void 0!==this.connectionEndRef){const R=this.lineService.onContainer(this.lineContainer);this.line=R(this.connectionBegin,null===(x=this.connectionEndRef)||void 0===x?void 0:x.nativeElement,{color:"var(--arrow-color)",startSocket:"left",endSocket:"right",path:"fluid",hide:!this.connectionRestVisibility,startSocketGravity:100,endSocketGravity:100}),this.subscription=null===(k=this.reposition)||void 0===k?void 0:k.subscribe(()=>{var de;null===(de=this.line)||void 0===de||de.position()}),this.line.position()}}updateLineVisibility(){void 0!==this.line&&(this.connectionRestVisibility?this.line.show():this.line.hide("none"))}ngOnInit(){}ngAfterViewInit(){this.tryToInitializeLine(),this.updateLineVisibility()}ngOnChanges(x){this.tryToInitializeLine(),"visibilityOnRest"in x&&this.updateLineVisibility()}ngOnDestroy(){var x,k;null===(x=this.subscription)||void 0===x||x.unsubscribe(),null===(k=this.line)||void 0===k||k.remove()}previewDragStarted(x){this.line.end=this.document.getElementsByClassName("cdk-drag-preview")[0],this.line.show()}previewDragMoved(x){var k;null===(k=this.line)||void 0===k||k.position()}previewDragEnded(){var x;this.line.end=null===(x=this.connectionEndRef)||void 0===x?void 0:x.nativeElement,this.updateLineVisibility()}}return D.\u0275fac=function(x){return new(x||D)(f.Y36(ir),f.Y36($e.K0))},D.\u0275cmp=f.Xpm({type:D,selectors:[["app-anchor"]],viewQuery:function(x,k){if(1&x&&(f.Gf(Ra,5),f.Gf(Oo,5)),2&x){let R;f.iGM(R=f.CRH())&&(k.connectionEndRef=R.first),f.iGM(R=f.CRH())&&(k.connectionEndPreviewRef=R.first)}},inputs:{lineContainer:"lineContainer",connectionBegin:"connectionBegin",connectionRestVisibility:"connectionRestVisibility",reposition:"reposition",dragData:"dragData"},features:[f.TTD],ngContentSelectors:fs,decls:3,vars:1,consts:[["cdkDrag","",3,"cdkDragData","cdkDragMoved","cdkDragStarted","cdkDragEnded"],["connectionEnd",""]],template:function(x,k){1&x&&(f.F$t(),f.TgZ(0,"div",0,1),f.NdJ("cdkDragMoved",function(de){return k.previewDragMoved(de)})("cdkDragStarted",function(de){return k.previewDragStarted(de)})("cdkDragEnded",function(){return k.previewDragEnded()}),f.Hsn(2),f.qZA()),2&x&&f.Q6J("cdkDragData",k.dragData)},directives:[Jn.Zt],styles:["[_nghost-%COMP%] > *[_ngcontent-%COMP%]{position:absolute}"]}),D})();const No=["lineContainer"],di=["cardContainer"];function za(D,H){if(1&D){const x=f.EpF();f.TgZ(0,"div",24),f.TgZ(1,"button",25),f.TgZ(2,"mat-icon"),f._uU(3,"more_vert"),f.qZA(),f.qZA(),f.TgZ(4,"mat-menu",null,26),f.TgZ(6,"button",27),f.NdJ("click",function(){f.CHM(x);const R=f.oxw().$implicit;return f.oxw().removeNode(R.node.id)}),f.TgZ(7,"mat-icon"),f._uU(8,"delete"),f.qZA(),f.TgZ(9,"span"),f._uU(10,"\u062d\u0630\u0641"),f.qZA(),f.qZA(),f.qZA(),f.qZA()}if(2&D){const x=f.MAs(5);f.xp6(1),f.Q6J("matMenuTriggerFor",x)}}function qn(D,H){if(1&D){const x=f.EpF();f.TgZ(0,"app-anchor",30),f.NdJ("shouldReposition",function(){return f.CHM(x),f.oxw(3).shouldReposition=!0}),f._UZ(1,"div",31),f.qZA()}if(2&D){const x=f.oxw().$implicit,k=f.oxw(2),R=f.MAs(9);f.Q6J("lineContainer",R)("connectionBegin",x.outputPlaceholderElement)("reposition",k.reposition)("dragData",x)}}const Ba=function(D,H){return{type:"input",card:D,index:H}};function Dr(D,H){if(1&D){const x=f.EpF();f.TgZ(0,"div",28),f.NdJ("cdkDropListDropped",function(R){return f.CHM(x),f.oxw(2).buttonDrop(R)}),f.YNc(1,qn,2,4,"app-anchor",29),f.qZA()}if(2&D){const x=H.$implicit,k=H.index,R=f.oxw().$implicit,de=f.oxw();f.Q6J("cdkDropListData",f.WLB(3,Ba,R,k))("cdkDropListEnterPredicate",de.inputDropEnterPredicate),f.xp6(1),f.Q6J("ngIf",null!==x)}}const Si=function(D){return{card:D,type:"output"}};function rr(D,H){if(1&D){const x=f.EpF();f.TgZ(0,"div",32),f.NdJ("cdkDropListDropped",function(R){return f.CHM(x),f.oxw(2).buttonDrop(R)}),f.TgZ(1,"app-anchor",33),f._UZ(2,"div",31),f.qZA(),f.qZA()}if(2&D){const x=f.oxw().$implicit,k=f.MAs(14),R=f.oxw(),de=f.MAs(9);f.Q6J("cdkDropListData",f.VKq(6,Si,x)),f.xp6(1),f.Q6J("lineContainer",de)("connectionBegin",k)("connectionRestVisibility",!1)("reposition",R.reposition)("dragData",x)}}const Yi=function(){return{}};function Rr(D,H){if(1&D){const x=f.EpF();f.TgZ(0,"mat-card",17),f.NdJ("click",function(){const de=f.CHM(x).$implicit;return f.oxw().updateSelectedCard(de)})("cdkDragStarted",function(R){return f.CHM(x),f.oxw().cardDragStarted(R)})("cdkDragEnded",function(R){return f.CHM(x),f.oxw().cardDragEnded(R)})("cdkDragMoved",function(){return f.CHM(x),f.oxw().shouldReposition=!0})("transitionend",function(){return f.CHM(x),f.oxw().shouldReposition=!0}),f.ALo(1,"async"),f.TgZ(2,"mat-card-header"),f.TgZ(3,"mat-card-title"),f._uU(4),f.qZA(),f.TgZ(5,"mat-card-subtitle"),f.TgZ(6,"mat-icon"),f._uU(7),f.qZA(),f.TgZ(8,"span"),f._uU(9),f.qZA(),f.qZA(),f.qZA(),f.YNc(10,za,11,1,"div",18),f.TgZ(11,"div",19),f.YNc(12,Dr,2,6,"div",20),f.qZA(),f.TgZ(13,"div",21,22),f.NdJ("onInit",function(){const de=f.CHM(x).$implicit,Ye=f.MAs(14);return de.outputPlaceholderElement=Ye}),f.YNc(15,rr,3,8,"div",23),f.qZA(),f.qZA()}if(2&D){const x=H.$implicit,k=f.oxw();f.ekj("selected",(null==k.selectedCard||null==k.selectedCard.node?null:k.selectedCard.node.id)===x.node.id)("errored",k.hasError(f.lcZ(1,14,null==x.node?null:x.node.validations)||f.DdM(16,Yi))),f.Q6J("cdkDragData",x)("cdkDragFreeDragPosition",x.position),f.xp6(4),f.Oqu(x.title),f.xp6(2),f.ekj("mat-icon-rtl-mirror",x.typeInfo.iconMirrored),f.xp6(1),f.hij(" ",x.typeInfo.iconName," "),f.xp6(2),f.Oqu(x.subtitle),f.xp6(1),f.Q6J("ngIf",x.typeInfo.type!==k.PipelineNodeType.datasetInput&&x.typeInfo.type!==k.PipelineNodeType.datasetOutput),f.xp6(2),f.Q6J("ngForOf",x.inputs),f.xp6(3),f.Q6J("ngIf",x.hasOutput)}}function po(D,H){1&D&&f._UZ(0,"div",41)}function Lo(D,H){1&D&&f._UZ(0,"div",42)}const Kn=function(){return[]};function Fo(D,H){if(1&D&&(f.TgZ(0,"div"),f.TgZ(1,"mat-card",37),f.TgZ(2,"mat-card-header"),f.TgZ(3,"mat-card-title"),f._uU(4),f.qZA(),f.TgZ(5,"mat-card-subtitle"),f.TgZ(6,"mat-icon"),f._uU(7),f.qZA(),f.TgZ(8,"span"),f._uU(9),f.qZA(),f.qZA(),f.qZA(),f.TgZ(10,"div",19),f.YNc(11,po,1,0,"div",38),f.qZA(),f.TgZ(12,"div",39),f.YNc(13,Lo,1,0,"div",40),f.qZA(),f.qZA(),f.qZA()),2&D){const x=f.oxw().$implicit;f.xp6(4),f.hij(" ",x.title," "),f.xp6(2),f.ekj("mat-icon-rtl-mirror",x.iconMirrored),f.xp6(1),f.hij(" ",x.iconName," "),f.xp6(2),f.Oqu(x.title),f.xp6(2),f.Q6J("ngForOf",f.DdM(7,Kn).constructor(x.numInputs)),f.xp6(2),f.Q6J("ngIf",x.hasOutput)}}function Xi(D,H){if(1&D){const x=f.EpF();f.TgZ(0,"div",34),f.TgZ(1,"mat-card",35),f.NdJ("cdkDragEnded",function(R){return f.CHM(x),f.oxw().addNode(R)}),f.TgZ(2,"mat-icon"),f._uU(3),f.qZA(),f.TgZ(4,"span"),f._uU(5),f.qZA(),f.YNc(6,Fo,14,8,"div",36),f.qZA(),f.qZA()}if(2&D){const x=H.$implicit;f.xp6(1),f.Q6J("cdkDragData",x),f.xp6(1),f.ekj("mat-icon-rtl-mirror",x.iconMirrored),f.xp6(1),f.hij(" ",x.iconName," "),f.xp6(2),f.Oqu(x.title)}}const Bi=function(){return{type:"remove"}},Vi=4*parseFloat(getComputedStyle(document.documentElement).fontSize);class _i{constructor(H){this.node=H,this.inputs=Array(H.inputs.length).fill(null),this.hasOutput=this.typeInfo.hasOutput,this.updatePosition()}get title(){return this.node.name}get subtitle(){return gi[this.node.type].title}get typeInfo(){return gi[this.node.type]}updatePosition(){this.position={x:-this.node.position.x*Vi,y:this.node.position.y*Vi}}}let $o=(()=>{class D{constructor(){this.selectedNodeEvent=new f.vpe,this.baseOffset={x:0,y:0},this.dragOffset={x:0,y:0},this.cards=[],this.reposition=new ho.xQ,this.shouldReposition=!1,this.subscriptions=[],this.Card=_i,this.addNodeTypes=Object.values(gi).filter(x=>x.type!==_t.datasetInput&&x.type!==_t.datasetOutput&&x.type!==_t.sort),this.PipelineNodeType=_t,this.hasError=Sr}ngOnInit(){}ngOnChanges(x){void 0!==x.pipeline&&x.pipeline.previousValue!==x.pipeline.currentValue&&(x.pipeline.previousValue&&(this.subscriptions.forEach(k=>k.unsubscribe()),this.subscriptions.splice(0),this.shouldReposition=!1,this.updateSelectedCard(void 0),this.cards.splice(0),this.baseOffset={x:0,y:0},this.dragOffset={x:0,y:0}),this.initPipeline())}ngAfterViewInit(){window.addEventListener("load",()=>{this.reposition.next()})}ngAfterViewChecked(){this.reposition.next(),this.shouldReposition=!1}updateSelectedCard(x){this.selectedCard=x,this.selectedNodeEvent.emit(null==x?void 0:x.node)}initPipeline(){this.pipeline.nodes.forEach(x=>{this.cards.push(new _i(x))}),this.pipeline.nodes.forEach(x=>{this.updateCardInputs(x)}),this.subscriptions.push(this.pipeline.nodeAdded.subscribe(x=>{this.cards.push(new _i(x)),this.updateCardInputs(x)})),this.subscriptions.push(this.pipeline.nodeEdited.subscribe(x=>{this.updateCardInputs(x)})),this.subscriptions.push(this.pipeline.nodeRemoved.subscribe(x=>{const k=this.cards.findIndex(R=>R.node.id===x.id);this.cards.splice(k,1)})),this.subscriptions.push(this.pipeline.loaded.subscribe(()=>{this.autoView()}))}autoView(){if(this.pipeline.nodes.length>0){const x=this.pipeline.nodes.reduce((k,R)=>({x:Math.min(k.x,R.position.x),y:Math.min(k.y,R.position.y)}),{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY});this.baseOffset={x:(x.x-2)*Vi,y:-(x.y-2)*Vi}}}updateCardInputs(x){const k=this.findCard(x.id);for(let R=0;R<k.inputs.length;R++)k.inputs[R]=null===x.inputs[R]?null:this.findCard(x.inputs[R])}findCard(x){return this.cards.find(k=>k.node.id===x)}inputDropEnterPredicate(x,k){return x.data!==k.data.card}buttonDrop(x){if(x.previousContainer===x.container)return;const k=x.previousContainer.data,R=x.container.data;"output"===R.type||"remove"===R.type?"input"===k.type&&(k.card.node.inputs[k.index]=null,this.pipeline.markNodeAsEdited(k.card.node.id)):"input"===R.type&&("input"===k.type?(R.card.node.inputs[R.index]=k.card.node.inputs[k.index],k.card.node.inputs[k.index]=null,this.pipeline.markNodeAsEdited(k.card.node.id),this.pipeline.markNodeAsEdited(R.card.node.id)):"output"===k.type&&(R.card.node.inputs[R.index]=k.card.node.id,this.pipeline.markNodeAsEdited(R.card.node.id)))}updateDragOffset(x){this.dragOffset=x.distance}updateOffset(x){this.baseOffset={x:this.baseOffset.x+x.distance.x,y:this.baseOffset.y+x.distance.y},this.dragOffset={x:0,y:0},x.source.reset()}cardDragStarted(x){x.source.element.nativeElement.classList.remove("snap-animation")}cardDragEnded(x){x.source.element.nativeElement.classList.add("snap-animation"),x.source.data.node.position={x:Math.round(-x.source.getFreeDragPosition().x/Vi),y:Math.round(x.source.getFreeDragPosition().y/Vi)},x.source.data.updatePosition()}addNode(x){const k=this.cardContainer.nativeElement.getBoundingClientRect();if(x.dropPoint.x<k.left||x.dropPoint.x>k.right||x.dropPoint.y<k.top||x.dropPoint.y>k.bottom)return;const R_y=x.dropPoint.y-k.top-Vi-this.baseOffset.y,de={x:Math.round((k.right-x.dropPoint.x-2.5*Vi+this.baseOffset.x)/Vi),y:Math.round(R_y/Vi)};this.pipeline.createNode(x.source.data.title,x.source.data.type,de)}removeNode(x){var k,R;this.pipeline.removeNode(x),(null===(R=null===(k=this.selectedCard)||void 0===k?void 0:k.node)||void 0===R?void 0:R.id)===x&&this.updateSelectedCard(void 0)}}return D.\u0275fac=function(x){return new(x||D)},D.\u0275cmp=f.Xpm({type:D,selectors:[["app-diagram"]],viewQuery:function(x,k){if(1&x&&(f.Gf(No,5),f.Gf(di,5)),2&x){let R;f.iGM(R=f.CRH())&&(k.lineContainer=R.first),f.iGM(R=f.CRH())&&(k.cardContainer=R.first)}},inputs:{pipeline:"pipeline"},outputs:{selectedNodeEvent:"selectedNode"},features:[f.TTD],decls:24,vars:10,consts:[["hasBackdrop","false"],[1,"diagram-container"],["cdkDropListGroup","","cdkDrag","",1,"card-container",3,"cdkDragEnded","cdkDragMoved"],["cardContainer",""],["cdkDropList","",1,"remove-connection-container",3,"cdkDropListData","cdkDropListDropped"],[1,"offset-container"],["class","diagram-card","cdkDrag","",3,"selected","errored","cdkDragData","cdkDragFreeDragPosition","click","cdkDragStarted","cdkDragEnded","cdkDragMoved","transitionend",4,"ngFor","ngForOf"],[1,"line-container"],["lineContainer",""],[1,"add-node-button-container"],["mat-raised-button","","color","primary",3,"click"],["position","end","mode","side"],["addSidePane",""],[1,"add-node-pane"],["mat-icon-button","",3,"click"],[1,"add-node-list"],["cdkDropList","",4,"ngFor","ngForOf"],["cdkDrag","",1,"diagram-card",3,"cdkDragData","cdkDragFreeDragPosition","click","cdkDragStarted","cdkDragEnded","cdkDragMoved","transitionend"],["class","more-menu-container",4,"ngIf"],[1,"drop-placeholder","input-drop-placeholder"],["class","empty-button-placeholder","cdkDropList","",3,"cdkDropListData","cdkDropListEnterPredicate","cdkDropListDropped",4,"ngFor","ngForOf"],["spy-element","",1,"drop-placeholder","output-drop-placeholder",3,"onInit"],["connectionBegin",""],["class","full-button-placeholder","cdkDropList","",3,"cdkDropListData","cdkDropListDropped",4,"ngIf"],[1,"more-menu-container"],["mat-icon-button","",3,"matMenuTriggerFor"],["moreMenu","matMenu"],["mat-menu-item","","disableRipple","","matRipple","","matRippleColor","rgba(255, 0, 0, 0.2)",1,"remove-menu-item",3,"click"],["cdkDropList","",1,"empty-button-placeholder",3,"cdkDropListData","cdkDropListEnterPredicate","cdkDropListDropped"],[3,"lineContainer","connectionBegin","reposition","dragData","shouldReposition",4,"ngIf"],[3,"lineContainer","connectionBegin","reposition","dragData","shouldReposition"],[1,"drag-button"],["cdkDropList","",1,"full-button-placeholder",3,"cdkDropListData","cdkDropListDropped"],[3,"lineContainer","connectionBegin","connectionRestVisibility","reposition","dragData"],["cdkDropList",""],["cdkDrag","",1,"add-node-card",3,"cdkDragData","cdkDragEnded"],[4,"cdkDragPreview"],[1,"diagram-card","preview-diagram-card"],["class","empty-button-placeholder",4,"ngFor","ngForOf"],[1,"drop-placeholder","output-drop-placeholder"],["class","full-button-placeholder",4,"ngIf"],[1,"empty-button-placeholder"],[1,"full-button-placeholder"]],template:function(x,k){if(1&x){const R=f.EpF();f.TgZ(0,"mat-sidenav-container",0),f.TgZ(1,"mat-sidenav-content"),f.TgZ(2,"div",1),f.TgZ(3,"div",2,3),f.NdJ("cdkDragEnded",function(Ye){return k.updateOffset(Ye)})("cdkDragMoved",function(Ye){return k.shouldReposition=!0,k.updateDragOffset(Ye)}),f.TgZ(5,"div",4),f.NdJ("cdkDropListDropped",function(Ye){return k.buttonDrop(Ye)}),f.qZA(),f.TgZ(6,"div",5),f.YNc(7,Rr,16,17,"mat-card",6),f.qZA(),f.qZA(),f._UZ(8,"div",7,8),f.TgZ(10,"div",9),f.TgZ(11,"button",10),f.NdJ("click",function(){return f.CHM(R),f.MAs(15).open()}),f.TgZ(12,"mat-icon"),f._uU(13,"add"),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.TgZ(14,"mat-sidenav",11,12),f.TgZ(16,"div",13),f.TgZ(17,"h3"),f._uU(18," \u067e\u0631\u062f\u0627\u0632\u0634 \u062c\u062f\u06cc\u062f "),f.TgZ(19,"button",14),f.NdJ("click",function(){return f.CHM(R),f.MAs(15).close()}),f.TgZ(20,"mat-icon"),f._uU(21,"chevron_left"),f.qZA(),f.qZA(),f.qZA(),f.TgZ(22,"div",15),f.YNc(23,Xi,7,5,"div",16),f.qZA(),f.qZA(),f.qZA(),f.qZA()}if(2&x){const R=f.MAs(15);f.xp6(2),f.Udp("background-position","right "+(-k.baseOffset.x-k.dragOffset.x)+"px top "+(k.baseOffset.y+k.dragOffset.y)+"px"),f.xp6(3),f.Q6J("cdkDropListData",f.DdM(9,Bi)),f.xp6(1),f.Udp("transform","translate("+k.baseOffset.x+"px, "+k.baseOffset.y+"px)"),f.xp6(1),f.Q6J("ngForOf",k.cards),f.xp6(3),f.ekj("invisible",R.opened),f.xp6(13),f.Q6J("ngForOf",k.addNodeTypes)}},directives:[Ei.TM,Ei.Rh,Jn.Fd,Jn.Zt,Jn.Wj,$e.sg,vt.lW,un.Hw,Ei.JX,Qn.a8,Qn.dk,Qn.n5,Qn.$j,$e.O5,Wi,Sn.p6,Sn.VK,Sn.OP,ln.wG,gs,Jn.pV],pipes:[$e.Ov],styles:[":root{--arrow-color: #673ab7}.mat-sidenav-container[_ngcontent-%COMP%]{width:100%;height:100%}.diagram-container[_ngcontent-%COMP%]{width:100%;height:100%;overflow:hidden;background-size:4rem 4rem;background-image:linear-gradient(to right,#eee .1rem,transparent .1rem),linear-gradient(to bottom,#eee .1rem,transparent .1rem)}.card-container[_ngcontent-%COMP%]{width:100%;height:100%}.card-container.cdk-drag-dragging[_ngcontent-%COMP%]{cursor:grab}.card-container[_ngcontent-%COMP%]   .diagram-card[_ngcontent-%COMP%]{position:absolute}.offset-container[_ngcontent-%COMP%]{width:0;height:0;overflow:visible}.diagram-card[_ngcontent-%COMP%]{width:20rem;height:8rem;display:flex;flex-direction:row;justify-content:center;-webkit-user-select:none;user-select:none;cursor:pointer;transition:box-shadow .28s cubic-bezier(.4,0,.2,1);box-shadow:0 3px 1px -2px #0003,0 2px 2px #00000024,0 1px 5px #0000001f}.diagram-card.snap-animation[_ngcontent-%COMP%]{transition:transform .2s ease-in-out,box-shadow .28s cubic-bezier(.4,0,.2,1)}.diagram-card.selected[_ngcontent-%COMP%]{box-shadow:0 2px 4px -1px #673ab799,0 4px 5px #673ab76b,0 1px 10px #673ab75c}.diagram-card.cdk-drag-dragging[_ngcontent-%COMP%]{box-shadow:0 3px 5px -1px #673ab799,0 6px 10px #673ab76b,0 1px 18px #673ab75c;cursor:move}.diagram-card.errored[_ngcontent-%COMP%]{box-shadow:0 3px 1px -2px #f44336cc,0 2px 2px #f443368f,0 1px 5px #f443367a}.diagram-card.errored.selected[_ngcontent-%COMP%]{box-shadow:0 2px 4px -1px #f4433699,0 4px 5px #f443366b,0 1px 10px #f443365c}.diagram-card.errored.cdk-drag-dragging[_ngcontent-%COMP%]{box-shadow:0 3px 5px -1px #f4433699,0 6px 10px #f443366b,0 1px 18px #f443365c}.diagram-card[_ngcontent-%COMP%]   .mat-card-title[_ngcontent-%COMP%], .diagram-card[_ngcontent-%COMP%]   .mat-card-subtitle[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center;grid-gap:var(--density-smaller);gap:var(--density-smaller)}.more-menu-container[_ngcontent-%COMP%]{position:absolute;top:0;left:0;margin:var(--density-small)}.remove-menu-item[_ngcontent-%COMP%]{color:#f44336}.remove-menu-item[_ngcontent-%COMP%] > .mat-icon[_ngcontent-%COMP%]{color:#f44336}.drop-placeholder[_ngcontent-%COMP%]{position:absolute;width:0;height:8rem;display:flex;flex-direction:column;justify-content:space-evenly;align-items:center}.input-drop-placeholder[_ngcontent-%COMP%]{top:0;right:0}.output-drop-placeholder[_ngcontent-%COMP%]{top:0;left:0}.empty-button-placeholder[_ngcontent-%COMP%]{width:2rem;height:2rem;border-radius:100%;background-color:#d1c4e9}.empty-button-placeholder[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{position:absolute}.full-button-placeholder[_ngcontent-%COMP%]{width:2rem;height:2rem;border-radius:100%;background-color:#673ab7}.full-button-placeholder[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{position:absolute}.drag-button[_ngcontent-%COMP%]{width:2rem;height:2rem;border-radius:100%;background-color:#673ab7}.line-container[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:0;height:0}.remove-connection-container[_ngcontent-%COMP%]{position:absolute;top:0;right:0;width:100%;height:100%}.remove-connection-container[_ngcontent-%COMP%]   .drag-button[_ngcontent-%COMP%]{display:none}.add-node-button-container[_ngcontent-%COMP%]{position:absolute;top:0;left:0;margin:var(--density-large);transition:opacity .2s ease-in;opacity:1}.add-node-button-container.invisible[_ngcontent-%COMP%]{visibility:hidden;opacity:0}.mat-sidenav[_ngcontent-%COMP%]{width:20rem}.add-node-pane[_ngcontent-%COMP%]{min-height:100%;padding:var(--density-large);background-color:#fafafa}.add-node-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:var(--density-large);gap:var(--density-large)}.add-node-card[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;grid-gap:var(--density-small);gap:var(--density-small);-webkit-user-select:none;user-select:none;cursor:move}.preview-diagram-card[_ngcontent-%COMP%]{position:absolute;transform:translate(50%,-50%)}"]}),D})();var Fn=Tt(7441);function Hn(D,H){if(1&D&&(f.TgZ(0,"mat-option",4),f._uU(1),f.qZA()),2&D){const x=H.$implicit;f.Q6J("value",x.id),f.xp6(1),f.hij(" ",x.name," ")}}function Wn(D,H){if(1&D){const x=f.EpF();f.TgZ(0,"div"),f.TgZ(1,"h3"),f._uU(2,"\u0627\u0637\u0644\u0627\u0639\u0627\u062a \u062f\u06cc\u062a\u0627\u0633\u062a"),f.qZA(),f.TgZ(3,"mat-form-field",1),f.TgZ(4,"mat-label"),f._uU(5,"\u062f\u06cc\u062a\u0627\u0633\u062a"),f.qZA(),f.TgZ(6,"mat-select",2),f.NdJ("ngModelChange",function(R){return f.CHM(x),f.oxw().node.config.datasetId=R}),f._UZ(7,"mat-option"),f.YNc(8,Hn,2,2,"mat-option",3),f.ALo(9,"async"),f.qZA(),f.TgZ(10,"mat-error"),f._uU(11,"\u0644\u0637\u0641\u0627\u064b \u06cc\u06a9 \u062f\u06cc\u062a\u0627\u0633\u062a \u0627\u0646\u062a\u062e\u0627\u0628 \u06a9\u0646\u06cc\u062f"),f.qZA(),f.qZA(),f.qZA()}if(2&D){const x=f.oxw();f.xp6(6),f.Q6J("ngModel",x.node.config.datasetId),f.xp6(2),f.Q6J("ngForOf",f.lcZ(9,2,x.store.datasets))}}let gr=(()=>{class D{constructor(){}ngOnInit(){var x;null===(x=this.store)||void 0===x||x.update()}}return D.\u0275fac=function(x){return new(x||D)},D.\u0275cmp=f.Xpm({type:D,selectors:[["app-input-config"]],inputs:{node:"node",store:"store"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"wide-field"],["required","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(x,k){1&x&&f.YNc(0,Wn,12,4,"div",0),2&x&&f.Q6J("ngIf",void 0!==k.node&&void 0!==k.store)},directives:[$e.O5,Xt.KE,Xt.hX,Fn.gD,Ht.Q7,Ht.JJ,Ht.On,ln.ey,$e.sg,Xt.TO],pipes:[$e.Ov],styles:[""]}),D})();var hn=Tt(7539);function Po(D,H){if(1&D&&(f.TgZ(0,"mat-option",5),f._uU(1),f.qZA()),2&D){const x=H.$implicit;f.Q6J("value",x.id),f.xp6(1),f.hij(" ",x.name," ")}}function ea(D,H){if(1&D){const x=f.EpF();f.TgZ(0,"div"),f.TgZ(1,"h3"),f._uU(2,"\u0627\u0637\u0644\u0627\u0639\u0627\u062a \u062f\u06cc\u062a\u0627\u0633\u062a"),f.qZA(),f.TgZ(3,"mat-form-field",1),f.TgZ(4,"mat-label"),f._uU(5,"\u062f\u06cc\u062a\u0627\u0633\u062a"),f.qZA(),f.TgZ(6,"mat-select",2),f.NdJ("ngModelChange",function(R){return f.CHM(x),f.oxw().node.config.datasetId=R}),f._UZ(7,"mat-option"),f.YNc(8,Po,2,2,"mat-option",3),f.ALo(9,"async"),f.qZA(),f.TgZ(10,"mat-error"),f._uU(11,"\u0644\u0637\u0641\u0627\u064b \u06cc\u06a9 \u062f\u06cc\u062a\u0627\u0633\u062a \u0627\u0646\u062a\u062e\u0627\u0628 \u06a9\u0646\u06cc\u062f"),f.qZA(),f.qZA(),f.TgZ(12,"mat-checkbox",4),f.NdJ("ngModelChange",function(R){return f.CHM(x),f.oxw().node.config.overwrite=R}),f._uU(13," \u0631\u0648\u0646\u0648\u06cc\u0633\u06cc "),f.qZA(),f.qZA()}if(2&D){const x=f.oxw();f.xp6(6),f.Q6J("ngModel",x.node.config.datasetId),f.xp6(2),f.Q6J("ngForOf",f.lcZ(9,3,x.store.datasets)),f.xp6(4),f.Q6J("ngModel",x.node.config.overwrite)}}let ta=(()=>{class D{constructor(){}ngOnInit(){var x;null===(x=this.store)||void 0===x||x.update()}}return D.\u0275fac=function(x){return new(x||D)},D.\u0275cmp=f.Xpm({type:D,selectors:[["app-output-config"]],inputs:{node:"node",store:"store"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"wide-field"],["required","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"ngModel","ngModelChange"],[3,"value"]],template:function(x,k){1&x&&f.YNc(0,ea,14,5,"div",0),2&x&&f.Q6J("ngIf",void 0!==k.node&&void 0!==k.store)},directives:[$e.O5,Xt.KE,Xt.hX,Fn.gD,Ht.Q7,Ht.JJ,Ht.On,ln.ey,$e.sg,Xt.TO,hn.oG],pipes:[$e.Ov],styles:[""]}),D})();var On=Tt(2238),dt=Tt(7646),gn=Tt(1769),Ti=Tt(171);function _s(D,H){if(1&D){const x=f.EpF();f.TgZ(0,"button",4),f.NdJ("click",function(){return f.CHM(x),f.oxw().handleAddNode("AND")}),f._uU(1," \u0627\u0641\u0632\u0648\u062f\u0646 AND "),f.qZA()}}function Kr(D,H){if(1&D){const x=f.EpF();f.TgZ(0,"button",26),f.NdJ("click",function(){return f.CHM(x),f.oxw().handleAddNode("OR")}),f._uU(1," \u0627\u0641\u0632\u0648\u062f\u0646 OR "),f.qZA()}}function mi(D,H){if(1&D){const x=f.EpF();f.TgZ(0,"mat-accordion"),f.TgZ(1,"mat-expansion-panel",33),f.TgZ(2,"mat-expansion-panel-header"),f.TgZ(3,"mat-panel-title"),f._uU(4," \u0648\u06cc\u0631\u0627\u06cc\u0634 \u06af\u0631\u0647\u200c\u06cc \u0634\u0631\u0637\u06cc "),f.qZA(),f.qZA(),f.TgZ(5,"mat-form-field",14),f.TgZ(6,"mat-label"),f._uU(7,"\u0646\u0627\u0645 \u0645\u062a\u063a\u06cc\u0631"),f.qZA(),f.TgZ(8,"input",34),f.NdJ("ngModelChange",function(R){return f.CHM(x),f.oxw(2).currentData._field=R}),f.qZA(),f.qZA(),f.TgZ(9,"mat-form-field",14),f.TgZ(10,"mat-label"),f._uU(11,"\u0639\u0645\u0644\u06af\u0631"),f.qZA(),f.TgZ(12,"mat-select",35),f.NdJ("ngModelChange",function(R){return f.CHM(x),f.oxw(2).currentData.Command=R}),f.TgZ(13,"mat-option",17),f._uU(14,">"),f.qZA(),f.TgZ(15,"mat-option",18),f._uU(16,"<"),f.qZA(),f.TgZ(17,"mat-option",19),f._uU(18,"="),f.qZA(),f.qZA(),f.qZA(),f.TgZ(19,"mat-form-field",14),f.TgZ(20,"mat-label"),f._uU(21,"\u0639\u0645\u0644\u0648\u0646\u062f"),f.qZA(),f.TgZ(22,"input",34),f.NdJ("ngModelChange",function(R){return f.CHM(x),f.oxw(2).currentData._value=R}),f.qZA(),f.qZA(),f.qZA(),f.qZA()}if(2&D){const x=f.oxw(2);f.xp6(1),f.Q6J("expanded",!0),f.xp6(7),f.Q6J("ngModel",x.currentData._field),f.xp6(4),f.Q6J("ngModel",x.currentData.Command),f.xp6(10),f.Q6J("ngModel",x.currentData._value)}}function Do(D,H){if(1&D){const x=f.EpF();f.TgZ(0,"mat-sidenav",27,28),f.TgZ(2,"div",10),f.TgZ(3,"mat-form-field",29),f.TgZ(4,"input",30,31),f.NdJ("ngModelChange",function(R){return f.CHM(x),f.oxw().currentData.name=R}),f.qZA(),f.qZA(),f.YNc(6,mi,23,4,"mat-accordion",32),f.qZA(),f.qZA()}if(2&D){const x=f.oxw();f.xp6(4),f.Q6J("ngModel",x.currentData.name),f.xp6(2),f.Q6J("ngIf","child"===x.currentData.type)}}let $r=(()=>{class D{constructor(x,k,R){this.formBuilder=x,this.dialogRef=k,this.data=R,this.nodeSize=0,this.onSaveGraph=new f.vpe,this.panelOpenState=!1,this.errorGraph=!1}ngOnInit(){this.form=this.formBuilder.group({Command:[null,Ht.kI.required],_field:[null,[Ht.kI.required]],_value:[null,Ht.kI.required]}),this.ogma=new dt({container:"graph-container",options:{interactions:{zoom:{onDoubleClick:!0}}}}),this.ogma.styles.addNodeRule({text:{maxLineLength:140,size:12,color:"black",minVisibleSize:2,content:x=>x.getData("name")}}),this.ogma.styles.addEdgeRule({shape:"arrow",width:7}),this.nodeSize=this.ogma.getNodes().size,this.ogma.events.onKeyPress(46,()=>{const x=this.ogma.getSelectedNodes(),k=this.ogma.getSelectedEdges();this.nodeSize-=x.size,this.ogma.removeNodes(x.getId()),this.ogma.removeEdges(k.getId()),this.currentData=null}),this.ogma.events.onClick(x=>{const k=x.button,R=x.target;R?"left"===k?(this.ogma.clearSelection(),R.setSelected(!0),R.isNode&&(this.currentData=this.ogma.getNode(R.getId()).getData())):"right"===k&&R.setSelected(!0):(this.ogma.clearSelection(),this.currentData=null)}),this.ogma.view.locateGraph(),this.ogma.events.onDragStart(()=>{this.ogma.keyboard.isKeyPressed("ctrl")&&this.ogma.tools.connectNodes.enable({strokeColor:"red",condition:(x,k)=>{const R=this.ogma.getEdges();for(let de=0;de<R.size;de++){const Ye=R.get(de).getData();if(Ye.source==x.getId()&&Ye.target==k.getId())return!1}return"child"!=x.getData().type&&x.getId()!=k.getId()},createNodes:!1,createEdge:x=>(x.attributes=Object.assign(Object.assign({},x.attributes),{color:"orange"}),x),onComplete:(x,k,R)=>{k&&R?R.setData({source:x.getId(),target:k.getId()}):this.ogma.tools.connectNodes.disable()}})}),this.ogma.events.onDragEnd(()=>{this.ogma.algorithms.detectCycle()&&this.ogma.removeEdge(this.ogma.getEdges().get(this.ogma.getEdges().size-1).getId())})}handleAddNode(x){switch(x){case"AND":this.ogma.addNode({id:++this.nodeSize,data:{type:"parent",name:"AND",Command:"AND"},attributes:{x:-200*Math.random(),y:200*Math.random(),color:"green",radius:25}});break;case"OR":this.ogma.addNode({id:++this.nodeSize,data:{type:"parent",name:"OR",Command:"OR"},attributes:{x:200*Math.random(),y:100*-Math.random(),color:"magenta",radius:25}});break;case"condition":this.ogma.addNode({id:++this.nodeSize,data:Object.assign({type:"child",name:"condition"},this.form.value),attributes:{x:100*-Math.random(),y:200*-Math.random(),color:"orange",radius:25}}),this.ogma.getNodes().forEach(k=>{})}}handleSavingGraph(){const x=this.ogma.getNodes().filter(k=>0===k.getDegree("in"));if(1!==x.size)alert("\u062e\u0637\u0627 \u062f\u0631 \u0630\u062e\u06cc\u0631\u0647 \u0633\u0627\u0632\u06cc : \u06af\u0631\u0627\u0641 \u0641\u0642\u0637 \u06cc\u06a9 \u0631\u06cc\u0634\u0647 \u0628\u0627\u06cc\u062f \u062f\u0627\u0634\u062a\u0647 \u0628\u0627\u0634\u062f");else{const k=this.applyingDFS(x.get(0));if(this.errorGraph)alert("\u062e\u0637\u0627 \u062f\u0631 \u0630\u062e\u06cc\u0631\u0647 \u0633\u0627\u0632\u06cc : \u06af\u0631\u0647 \u0647\u0627\u06cc \u063a\u06cc\u0631 \u0634\u0631\u0637\u06cc \u062d\u062f\u0627\u0642\u0644 2 \u0641\u0631\u0632\u0646\u062f \u0628\u0627\u06cc\u062f \u062f\u0627\u0634\u062a\u0647 \u0628\u0627\u0634\u0646\u062f"),this.errorGraph=!1;else{const R=JSON.stringify(k,void 0,1);console.log(R),alert("\u0641\u06cc\u0644\u062a\u0631 \u0628\u0627 \u0645\u0648\u0641\u0642\u06cc\u062a \u0630\u062e\u06cc\u0631\u0647 \u0634\u062f"),this.onSaveGraph.emit(),this.dialogRef.close(k)}}}applyingDFS(x){let k={Command:x.getData("Command")};if("child"==x.getData("type"))k=Object.assign(Object.assign({},k),{_field:x.getData("_field"),_value:x.getData("_value")});else{const R=x.getAdjacentNodes({direction:"out"});let de=[];if(R.forEach((Ye,Qt)=>{let Ii=this.applyingDFS(Ye);Ii?de.push(Ii):this.errorGraph=!0}),de.length<2||this.errorGraph)return void(this.errorGraph=!0);k=Object.assign(Object.assign({},k),{_statement:de})}return k}}return D.\u0275fac=function(x){return new(x||D)(f.Y36(Ht.qu),f.Y36(On.so),f.Y36(On.WI))},D.\u0275cmp=f.Xpm({type:D,selectors:[["app-filtering-tree"]],decls:55,vars:8,consts:[["hasBackdrop","false"],["mat-dialog-content","",2,"width","100%"],["id","graph-container"],[1,"add-node-button-container"],["color","primary","mat-raised-button","",3,"click"],["mat-dialog-actions",""],["color","accent","mat-raised-button","",2,"margin-top","58rem","margin-right","2rem",3,"click"],["color","accent","mat-dialog-close","","mat-raised-button","",2,"margin-top","58rem","margin-right","2rem"],["mode","over","position","end",3,"opened"],["addSidePane",""],[1,"add-side-pane"],["mat-icon-button","",3,"click"],[3,"opened","closed"],[3,"formGroup"],[1,"wide-field"],["formControlName","_field","matInput","","name","_field","required","","type","text",1,"propery-input"],["formControlName","Command"],["value",">"],["value","<"],["value","="],["formControlName","_value","matInput","","name","_value","required","","type","text",1,"propery-input"],["color","primary","mat-raised-button","",3,"disabled","click"],[1,"add-buttons"],["color","primary","mat-raised-button","",3,"click",4,"ngIf"],["color","primary","mat-raised-button","","style","width: 10.3rem",3,"click",4,"ngIf"],["mode","side","opened","",4,"ngIf"],["color","primary","mat-raised-button","",2,"width","10.3rem",3,"click"],["mode","side","opened",""],["editSidePane",""],[1,"node-name-input"],["matInput","","placeholder","\u0646\u0627\u0645 \u06af\u0631\u0647","type","text","readonly","",2,"font-size","70%",3,"ngModel","ngModelChange"],["nodeNameInput","matInput"],[4,"ngIf"],[3,"expanded"],["matInput","","type","text",1,"propery-input",3,"ngModel","ngModelChange"],[3,"ngModel","ngModelChange"]],template:function(x,k){if(1&x){const R=f.EpF();f.TgZ(0,"mat-sidenav-container",0),f.TgZ(1,"mat-sidenav-content"),f.TgZ(2,"mat-sidenav-container",0),f.TgZ(3,"mat-sidenav-content"),f.TgZ(4,"div",1),f.TgZ(5,"div",2),f.TgZ(6,"div",3),f.TgZ(7,"button",4),f.NdJ("click",function(){return f.CHM(R),f.MAs(16).open()}),f.TgZ(8,"mat-icon"),f._uU(9,"add"),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.TgZ(10,"div",5),f.TgZ(11,"button",6),f.NdJ("click",function(){return k.handleSavingGraph()}),f._uU(12," \u0630\u062e\u06cc\u0631\u0647 "),f.qZA(),f.TgZ(13,"button",7),f._uU(14," \u0627\u0646\u0635\u0631\u0627\u0641 "),f.qZA(),f.qZA(),f.qZA(),f.TgZ(15,"mat-sidenav",8,9),f.TgZ(17,"div",10),f.TgZ(18,"h4"),f._uU(19," \u0627\u06cc\u062c\u0627\u062f \u06af\u0631\u0647 \u06cc \u062c\u062f\u06cc\u062f "),f.TgZ(20,"button",11),f.NdJ("click",function(){return f.CHM(R),f.MAs(16).close()}),f.TgZ(21,"mat-icon"),f._uU(22,"chevron_left"),f.qZA(),f.qZA(),f.qZA(),f._UZ(23,"mat-divider"),f.TgZ(24,"mat-accordion"),f.TgZ(25,"mat-expansion-panel",12),f.NdJ("opened",function(){return k.panelOpenState=!0})("closed",function(){return k.panelOpenState=!1}),f.TgZ(26,"mat-expansion-panel-header"),f.TgZ(27,"mat-panel-title"),f._uU(28," \u0637\u0631\u0627\u062d\u06cc \u06af\u0631\u0647 \u0634\u0631\u0637\u06cc "),f.qZA(),f.qZA(),f.TgZ(29,"form",13),f.TgZ(30,"mat-form-field",14),f.TgZ(31,"mat-label"),f._uU(32,"\u0646\u0627\u0645 \u0645\u062a\u063a\u06cc\u0631"),f.qZA(),f._UZ(33,"input",15),f.qZA(),f.TgZ(34,"mat-form-field",14),f.TgZ(35,"mat-label"),f._uU(36,"\u0639\u0645\u0644\u06af\u0631"),f.qZA(),f.TgZ(37,"mat-select",16),f.TgZ(38,"mat-option",17),f._uU(39," > "),f.qZA(),f.TgZ(40,"mat-option",18),f._uU(41," < "),f.qZA(),f.TgZ(42,"mat-option",19),f._uU(43,"="),f.qZA(),f.qZA(),f.qZA(),f.TgZ(44,"mat-form-field",14),f.TgZ(45,"mat-label"),f._uU(46," \u0639\u0645\u0644\u0648\u0646\u062f"),f.qZA(),f._UZ(47,"input",20),f.qZA(),f.TgZ(48,"button",21),f.NdJ("click",function(){return k.handleAddNode("condition")}),f._uU(49," \u0627\u0641\u0632\u0648\u062f\u0646 \u0634\u0631\u0637 "),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.TgZ(50,"div",22),f.YNc(51,_s,2,0,"button",23),f.YNc(52,Kr,2,0,"button",24),f.qZA(),f._UZ(53,"mat-divider"),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.YNc(54,Do,7,2,"mat-sidenav",25),f.qZA()}if(2&x){const R=f.MAs(16);f.xp6(6),f.ekj("invisible",R.opened),f.xp6(9),f.Q6J("opened",!1),f.xp6(14),f.Q6J("formGroup",k.form),f.xp6(19),f.Q6J("disabled",!k.form.valid),f.xp6(3),f.Q6J("ngIf",!k.panelOpenState),f.xp6(1),f.Q6J("ngIf",!k.panelOpenState),f.xp6(2),f.Q6J("ngIf",!!k.currentData)}},directives:[Ei.TM,Ei.Rh,On.xY,vt.lW,un.Hw,On.H8,On.ZT,Ei.JX,gn.d,Ti.pp,Ti.ib,Ti.yz,Ti.yK,Ht._Y,Ht.JL,Ht.sg,Xt.KE,Xt.hX,Ht.Fj,En.Nt,Ht.JJ,Ht.u,Ht.Q7,Fn.gD,ln.ey,$e.O5,Ht.On],styles:[".mat-drawer[_ngcontent-%COMP%]{width:100px}.mat-drawer-container[_ngcontent-%COMP%]{height:100%}#graph-container[_ngcontent-%COMP%]{overflow:hidden;display:block;position:absolute;height:64.2rem;width:100%}.add-node-button-container[_ngcontent-%COMP%]{position:absolute;top:0;left:0;margin:var(--density-large);transition:opacity .2s ease-in;opacity:1}.add-node-button-container.invisible[_ngcontent-%COMP%]{visibility:hidden;opacity:0}.mat-sidenav[_ngcontent-%COMP%]{width:31rem}.add-side-pane[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:var(--density-large);gap:var(--density-large);padding:var(--density-large)}.add-buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row;grid-gap:var(--density-large);gap:var(--density-large)}.node-name-input[_ngcontent-%COMP%]{font-size:20px}.node-name-input[_ngcontent-%COMP%]   .mat-form-field-underline[_ngcontent-%COMP%]{background-color:transparent}.wide-field[_ngcontent-%COMP%]{width:100%}.propery-input[_ngcontent-%COMP%]{direction:ltr;text-align:left}"]}),D})();function Va(D,H){if(1&D){const x=f.EpF();f.TgZ(0,"div"),f.TgZ(1,"button",1),f.NdJ("click",function(){return f.CHM(x),f.oxw().designClicked()}),f.TgZ(2,"mat-icon",2),f._uU(3,"launch"),f.qZA(),f._uU(4," \u0637\u0631\u0627\u062d\u06cc \u0641\u06cc\u0644\u062a\u0631 "),f.qZA(),f.qZA()}}let Ro=(()=>{class D{constructor(x){this.dialog=x}ngOnInit(){}designClicked(){var x;this.dialog.open($r,{panelClass:"filterDialog",disableClose:!1,closeOnNavigation:!0,data:null===(x=this.node)||void 0===x?void 0:x.config}).afterClosed().subscribe(R=>{console.log(R),this.node.config=R})}}return D.\u0275fac=function(x){return new(x||D)(f.Y36(On.uw))},D.\u0275cmp=f.Xpm({type:D,selectors:[["app-filter-config"]],inputs:{node:"node"},decls:1,vars:1,consts:[[4,"ngIf"],["mat-raised-button","","color","accent",3,"click"],[1,"mat-icon-rtl-mirror"]],template:function(x,k){1&x&&f.YNc(0,Va,5,0,"div",0),2&x&&f.Q6J("ngIf",void 0!==k.node)},directives:[$e.O5,vt.lW,un.Hw],styles:[""]}),D})();var _r=Tt(946);const Mi=["orderPanel"];function _(D,H){if(1&D){const x=f.EpF();f.TgZ(0,"mat-expansion-panel",5,6),f.TgZ(2,"mat-expansion-panel-header"),f.TgZ(3,"mat-panel-title"),f.TgZ(4,"mat-icon",7),f._uU(5," drag_handle "),f.qZA(),f.TgZ(6,"span"),f.TgZ(7,"bdo",8),f._uU(8),f.qZA(),f.qZA(),f.TgZ(9,"mat-icon",9),f._uU(10),f.qZA(),f.qZA(),f.qZA(),f.TgZ(11,"mat-form-field",10),f.TgZ(12,"mat-label"),f._uU(13,"\u0646\u0627\u0645 \u0645\u062a\u063a\u06cc\u0631"),f.qZA(),f.TgZ(14,"input",11),f.NdJ("ngModelChange",function(R){return f.CHM(x).$implicit.fieldName=R}),f.qZA(),f.qZA(),f.TgZ(15,"div",12),f.TgZ(16,"mat-checkbox",13),f.NdJ("ngModelChange",function(R){return f.CHM(x).$implicit.descending=R}),f._uU(17," \u0646\u0632\u0648\u0644\u06cc "),f.qZA(),f.TgZ(18,"button",14),f.NdJ("click",function(){const de=f.CHM(x).index;return f.oxw(2).removeOrder(de)}),f.TgZ(19,"mat-icon"),f._uU(20,"delete"),f.qZA(),f._uU(21," \u062d\u0630\u0641 "),f.qZA(),f.qZA(),f.qZA()}if(2&D){const x=H.$implicit;f.xp6(8),f.Oqu(x.fieldName),f.xp6(2),f.hij(" ",x.descending?"south":"north"," "),f.xp6(4),f.Q6J("ngModel",x.fieldName),f.xp6(2),f.Q6J("ngModel",x.descending)}}function A(D,H){if(1&D){const x=f.EpF();f.TgZ(0,"div"),f.TgZ(1,"div",1),f.TgZ(2,"h3"),f._uU(3,"\u0645\u0631\u062a\u0628\u200c\u0633\u0627\u0632\u06cc \u0628\u0631\u0627\u0633\u0627\u0633"),f.qZA(),f.TgZ(4,"button",2),f.NdJ("click",function(){return f.CHM(x),f.oxw().addOrder()}),f.TgZ(5,"mat-icon"),f._uU(6,"add"),f.qZA(),f.qZA(),f.qZA(),f.TgZ(7,"mat-accordion",3),f.NdJ("cdkDropListDropped",function(R){return f.CHM(x),f.oxw().dropOrder(R)}),f.YNc(8,_,22,4,"mat-expansion-panel",4),f.qZA(),f.qZA()}if(2&D){const x=f.oxw();f.xp6(8),f.Q6J("ngForOf",x.node.config.orders)}}let C=(()=>{class D{constructor(x){this.cdref=x,this.expandNewOrder=!1}ngOnInit(){}ngAfterViewChecked(){var x;this.expandNewOrder&&(this.expandNewOrder=!1,null===(x=this.firstOrderPanel)||void 0===x||x.open(),this.cdref.detectChanges())}addOrder(){var x;null===(x=this.node)||void 0===x||x.config.orders.unshift({fieldName:"",descending:!1}),this.expandNewOrder=!0}removeOrder(x){var k;null===(k=this.node)||void 0===k||k.config.orders.splice(x,1)}dropOrder(x){(0,Jn.bA)(this.node.config.orders,x.previousIndex,x.currentIndex)}}return D.\u0275fac=function(x){return new(x||D)(f.Y36(f.sBO))},D.\u0275cmp=f.Xpm({type:D,selectors:[["app-sort-config"]],viewQuery:function(x,k){if(1&x&&f.Gf(Mi,5),2&x){let R;f.iGM(R=f.CRH())&&(k.firstOrderPanel=R.first)}},inputs:{node:"node"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"config-title-add"],["mat-icon-button","","color","primary",3,"click"],["cdkDropList","",3,"cdkDropListDropped"],["cdkDrag","",4,"ngFor","ngForOf"],["cdkDrag",""],["orderPanel",""],["cdkDragHandle","",1,"drag-handle"],["dir","ltr"],[1,"sort-icon"],[1,"wide-field"],["matInput","","type","text","required","",1,"propery-input",3,"ngModel","ngModelChange"],[1,"inline-row"],[3,"ngModel","ngModelChange"],["mat-raised-button","","color","warn",3,"click"]],template:function(x,k){1&x&&f.YNc(0,A,9,1,"div",0),2&x&&f.Q6J("ngIf",void 0!==k.node)},directives:[$e.O5,vt.lW,un.Hw,Ti.pp,Jn.Wj,$e.sg,Ti.ib,Jn.Zt,Ti.yz,Ti.yK,Jn.Bh,_r.Lv,Xt.KE,Xt.hX,En.Nt,Ht.Fj,Ht.Q7,Ht.JJ,Ht.On,hn.oG],styles:["mat-panel-title[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;-webkit-user-select:none;user-select:none}.drag-handle[_ngcontent-%COMP%]{color:#0000008a;margin-left:var(--density-small);cursor:move}.sort-icon[_ngcontent-%COMP%]{transform:scale(.7)}.inline-row[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:space-between}"]}),D})();function T(D,H){if(1&D&&(f.TgZ(0,"mat-option",6),f._uU(1),f.qZA()),2&D){const x=H.$implicit,k=f.oxw(2);f.Q6J("value",x),f.xp6(1),f.hij(" ",k.joinTypeInfo[x].title," ")}}function P(D,H){if(1&D&&(f.TgZ(0,"mat-option",6),f._uU(1),f.qZA()),2&D){const x=H.$implicit;f.Q6J("value",x.id),f.xp6(1),f.hij(" ",x.name," ")}}function V(D,H){if(1&D){const x=f.EpF();f.TgZ(0,"div"),f.TgZ(1,"h3"),f._uU(2,"\u0627\u0637\u0644\u0627\u0639\u0627\u062a \u0627\u0644\u062d\u0627\u0642"),f.qZA(),f.TgZ(3,"mat-form-field",1),f.TgZ(4,"mat-label"),f._uU(5,"\u0646\u0648\u0639"),f.qZA(),f.TgZ(6,"mat-select",2),f.NdJ("ngModelChange",function(R){return f.CHM(x),f.oxw().node.config.type=R}),f.YNc(7,T,2,2,"mat-option",3),f.qZA(),f.qZA(),f.TgZ(8,"mat-form-field",1),f.TgZ(9,"mat-label"),f._uU(10,"\u062f\u06cc\u062a\u0627\u0633\u062a \u0631\u0627\u0633\u062a"),f.qZA(),f.TgZ(11,"mat-select",4),f.NdJ("ngModelChange",function(R){return f.CHM(x),f.oxw().node.config.joinWith=R}),f._UZ(12,"mat-option"),f.YNc(13,P,2,2,"mat-option",3),f.ALo(14,"async"),f.qZA(),f.TgZ(15,"mat-error"),f._uU(16,"\u0644\u0637\u0641\u0627\u064b \u06cc\u06a9 \u062f\u06cc\u062a\u0627\u0633\u062a \u0627\u0646\u062a\u062e\u0627\u0628 \u06a9\u0646\u06cc\u062f"),f.qZA(),f.qZA(),f.TgZ(17,"mat-form-field",1),f.TgZ(18,"mat-label"),f._uU(19,"\u06a9\u0644\u06cc\u062f \u0686\u067e"),f.qZA(),f.TgZ(20,"input",5),f.NdJ("ngModelChange",function(R){return f.CHM(x),f.oxw().node.config.leftTableKey=R}),f.qZA(),f.qZA(),f.TgZ(21,"mat-form-field",1),f.TgZ(22,"mat-label"),f._uU(23,"\u06a9\u0644\u06cc\u062f \u0631\u0627\u0633\u062a"),f.qZA(),f.TgZ(24,"input",5),f.NdJ("ngModelChange",function(R){return f.CHM(x),f.oxw().node.config.rightTableKey=R}),f.qZA(),f.qZA(),f.qZA()}if(2&D){const x=f.oxw();f.xp6(6),f.Q6J("ngModel",x.node.config.type),f.xp6(1),f.Q6J("ngForOf",x.joinType),f.xp6(4),f.Q6J("ngModel",x.node.config.joinWith),f.xp6(2),f.Q6J("ngForOf",f.lcZ(14,6,x.store.datasets)),f.xp6(7),f.Q6J("ngModel",x.node.config.leftTableKey),f.xp6(4),f.Q6J("ngModel",x.node.config.rightTableKey)}}let le=(()=>{class D{constructor(){this.joinTypeInfo=Mo,this.joinType=Object.values(hr)}ngOnInit(){var x;null===(x=this.store)||void 0===x||x.update()}}return D.\u0275fac=function(x){return new(x||D)},D.\u0275cmp=f.Xpm({type:D,selectors:[["app-join-config"]],inputs:{node:"node",store:"store"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"wide-field"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["required","",3,"ngModel","ngModelChange"],["matInput","","type","text","required","",1,"propery-input",3,"ngModel","ngModelChange"],[3,"value"]],template:function(x,k){1&x&&f.YNc(0,V,25,8,"div",0),2&x&&f.Q6J("ngIf",void 0!==k.node&&void 0!==k.store)},directives:[$e.O5,Xt.KE,Xt.hX,Fn.gD,Ht.JJ,Ht.On,$e.sg,Ht.Q7,ln.ey,Xt.TO,En.Nt,Ht.Fj],pipes:[$e.Ov],styles:[""]}),D})();const te=["groupByPanel"],re=["operationPanel"];function j(D,H){if(1&D){const x=f.EpF();f.TgZ(0,"mat-expansion-panel",null,4),f.TgZ(2,"mat-expansion-panel-header"),f.TgZ(3,"mat-panel-title"),f.TgZ(4,"span"),f.TgZ(5,"bdo",5),f._uU(6),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.TgZ(7,"mat-form-field",6),f.TgZ(8,"mat-label"),f._uU(9,"\u0646\u0627\u0645 \u0645\u062a\u063a\u06cc\u0631"),f.qZA(),f.TgZ(10,"input",7),f.NdJ("ngModelChange",function(R){const Ye=f.CHM(x).index;return f.oxw(3).node.config.groupBy[Ye]=R}),f.qZA(),f.qZA(),f.TgZ(11,"div",8),f._UZ(12,"div"),f.TgZ(13,"button",9),f.NdJ("click",function(){const de=f.CHM(x).index;return f.oxw(3).removeGroupBy(de)}),f.TgZ(14,"mat-icon"),f._uU(15,"delete"),f.qZA(),f._uU(16," \u062d\u0630\u0641 "),f.qZA(),f.qZA(),f.qZA()}if(2&D){const x=H.$implicit,k=H.index,R=f.oxw(3);f.xp6(6),f.Oqu(x),f.xp6(4),f.Q6J("ngModel",R.node.config.groupBy[k])}}function ee(D,H){if(1&D&&(f.TgZ(0,"mat-accordion"),f.YNc(1,j,17,2,"mat-expansion-panel",3),f.qZA()),2&D){const x=f.oxw(2);f.xp6(1),f.Q6J("ngForOf",x.node.config.groupBy)("ngForTrackBy",x.trackByIndex)}}function ye(D,H){if(1&D&&(f.TgZ(0,"mat-option",14),f._uU(1),f.qZA()),2&D){const x=H.$implicit,k=f.oxw(4);f.Q6J("value",x),f.xp6(1),f.hij(" ",k.aggregateOperationTypeInfo[x].title," ")}}function G(D,H){if(1&D){const x=f.EpF();f.TgZ(0,"mat-expansion-panel",null,11),f.TgZ(2,"mat-expansion-panel-header"),f.TgZ(3,"mat-panel-title"),f.TgZ(4,"span"),f.TgZ(5,"span"),f._uU(6),f.TgZ(7,"bdo",5),f._uU(8),f.qZA(),f._uU(9," \u0628\u0647 \u0639\u0646\u0648\u0627\u0646 "),f.TgZ(10,"bdo",5),f._uU(11),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.TgZ(12,"mat-form-field",6),f.TgZ(13,"mat-label"),f._uU(14,"\u0646\u0627\u0645 \u0645\u062a\u063a\u06cc\u0631"),f.qZA(),f.TgZ(15,"input",7),f.NdJ("ngModelChange",function(R){return f.CHM(x).$implicit.fieldName=R}),f.qZA(),f.qZA(),f.TgZ(16,"mat-form-field",6),f.TgZ(17,"mat-label"),f._uU(18,"\u0646\u0648\u0639 \u0639\u0645\u0644\u06cc\u062a"),f.qZA(),f.TgZ(19,"mat-select",12),f.NdJ("ngModelChange",function(R){return f.CHM(x).$implicit.type=R}),f.YNc(20,ye,2,2,"mat-option",13),f.qZA(),f.qZA(),f.TgZ(21,"mat-form-field",6),f.TgZ(22,"mat-label"),f._uU(23,"\u0646\u0627\u0645 \u0645\u062a\u063a\u06cc\u0631 \u062e\u0631\u0648\u062c\u06cc"),f.qZA(),f.TgZ(24,"input",7),f.NdJ("ngModelChange",function(R){return f.CHM(x).$implicit.outputFieldName=R}),f.qZA(),f.qZA(),f.TgZ(25,"div",8),f._UZ(26,"div"),f.TgZ(27,"button",9),f.NdJ("click",function(){const de=f.CHM(x).index;return f.oxw(3).removeOperation(de)}),f.TgZ(28,"mat-icon"),f._uU(29,"delete"),f.qZA(),f._uU(30," \u062d\u0630\u0641 "),f.qZA(),f.qZA(),f.qZA()}if(2&D){const x=H.$implicit,k=f.oxw(3);f.xp6(6),f.hij(" ",k.aggregateOperationTypeInfo[x.type].title," "),f.xp6(2),f.Oqu(x.fieldName),f.xp6(3),f.Oqu(x.outputFieldName),f.xp6(4),f.Q6J("ngModel",x.fieldName),f.xp6(4),f.Q6J("ngModel",x.type),f.xp6(1),f.Q6J("ngForOf",k.aggregateOperationType),f.xp6(4),f.Q6J("ngModel",x.outputFieldName)}}function Q(D,H){if(1&D&&(f.TgZ(0,"mat-accordion"),f.YNc(1,G,31,7,"mat-expansion-panel",10),f.qZA()),2&D){const x=f.oxw(2);f.xp6(1),f.Q6J("ngForOf",x.node.config.operations)}}function $(D,H){if(1&D){const x=f.EpF();f.TgZ(0,"div"),f.TgZ(1,"div",1),f.TgZ(2,"h3"),f._uU(3,"\u06af\u0631\u0648\u0647\u200c\u0628\u0646\u062f\u06cc \u0628\u0631 \u0627\u0633\u0627\u0633"),f.qZA(),f.TgZ(4,"button",2),f.NdJ("click",function(){return f.CHM(x),f.oxw().addGroupBy()}),f.TgZ(5,"mat-icon"),f._uU(6,"add"),f.qZA(),f.qZA(),f.qZA(),f.YNc(7,ee,2,2,"mat-accordion",0),f._UZ(8,"br"),f.TgZ(9,"div",1),f.TgZ(10,"h3"),f._uU(11,"\u0639\u0645\u0644\u06cc\u0627\u062a"),f.qZA(),f.TgZ(12,"button",2),f.NdJ("click",function(){return f.CHM(x),f.oxw().addOperation()}),f.TgZ(13,"mat-icon"),f._uU(14,"add"),f.qZA(),f.qZA(),f.qZA(),f.YNc(15,Q,2,1,"mat-accordion",0),f.qZA()}if(2&D){const x=f.oxw();f.xp6(7),f.Q6J("ngIf",void 0!==x.node.config.groupBy),f.xp6(8),f.Q6J("ngIf",void 0!==x.node.config.operations)}}let se=(()=>{class D{constructor(x){this.cdref=x,this.expandNewGroupBy=!1,this.expandNewOperation=!1,this.aggregateOperationTypeInfo=ui,this.aggregateOperationType=Object.values(qi)}ngOnInit(){}ngAfterViewChecked(){var x,k;let R=!1;this.expandNewGroupBy&&(this.expandNewGroupBy=!1,null===(x=this.firstGroupByPanel)||void 0===x||x.open(),R=!0),this.expandNewOperation&&(this.expandNewOperation=!1,null===(k=this.firstOperationPanel)||void 0===k||k.open(),R=!0),R&&this.cdref.detectChanges()}trackByIndex(x,k){return x}addGroupBy(){var x,k;null===(k=null===(x=this.node)||void 0===x?void 0:x.config.groupBy)||void 0===k||k.unshift(""),this.expandNewGroupBy=!0}removeGroupBy(x){var k,R;null===(R=null===(k=this.node)||void 0===k?void 0:k.config.groupBy)||void 0===R||R.splice(x,1)}addOperation(){var x,k;null===(k=null===(x=this.node)||void 0===x?void 0:x.config.operations)||void 0===k||k.unshift({fieldName:"",type:qi.count,outputFieldName:""}),this.expandNewOperation=!0}removeOperation(x){var k,R;null===(R=null===(k=this.node)||void 0===k?void 0:k.config.operations)||void 0===R||R.splice(x,1)}}return D.\u0275fac=function(x){return new(x||D)(f.Y36(f.sBO))},D.\u0275cmp=f.Xpm({type:D,selectors:[["app-aggregate-config"]],viewQuery:function(x,k){if(1&x&&(f.Gf(te,5),f.Gf(re,5)),2&x){let R;f.iGM(R=f.CRH())&&(k.firstGroupByPanel=R.first),f.iGM(R=f.CRH())&&(k.firstOperationPanel=R.first)}},inputs:{node:"node"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"config-title-add"],["mat-icon-button","","color","primary",3,"click"],[4,"ngFor","ngForOf","ngForTrackBy"],["groupByPanel",""],["dir","ltr"],[1,"wide-field"],["matInput","","type","text","required","",1,"propery-input",3,"ngModel","ngModelChange"],[1,"delete-row"],["mat-raised-button","","color","warn",3,"click"],[4,"ngFor","ngForOf"],["operationPanel",""],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(x,k){1&x&&f.YNc(0,$,16,2,"div",0),2&x&&f.Q6J("ngIf",void 0!==k.node)},directives:[$e.O5,vt.lW,un.Hw,Ti.pp,$e.sg,Ti.ib,Ti.yz,Ti.yK,_r.Lv,Xt.KE,Xt.hX,En.Nt,Ht.Fj,Ht.Q7,Ht.JJ,Ht.On,Fn.gD,ln.ey],styles:["mat-panel-title[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;-webkit-user-select:none;user-select:none}.drag-handle[_ngcontent-%COMP%]{color:#0000008a;margin-left:var(--density-small);cursor:move}.delete-row[_ngcontent-%COMP%]{display:flex;flex-direction:row-reverse}"]}),D})();const _e=["diagram"];function Ae(D,H){if(1&D){const x=f.EpF();f.TgZ(0,"mat-toolbar",2),f.TgZ(1,"a",3),f.TgZ(2,"mat-icon"),f._uU(3,"call_split"),f.qZA(),f.TgZ(4,"span",4),f._uU(5," \u06a9\u0627\u0648\u0634\u06af\u0631"),f.qZA(),f.qZA(),f.TgZ(6,"span",5),f.TgZ(7,"button",6),f.NdJ("click",function(){return f.CHM(x),f.oxw().runPipeline()}),f.TgZ(8,"mat-icon",7),f._uU(9," play_arrow "),f.qZA(),f.qZA(),f.TgZ(10,"mat-form-field",8),f.TgZ(11,"mat-label"),f._uU(12,"\u0646\u0627\u0645 \u0633\u0646\u0627\u0631\u06cc\u0648"),f.qZA(),f.TgZ(13,"input",9,10),f.NdJ("ngModelChange",function(R){return f.CHM(x),f.oxw().pipeline.name=R}),f.qZA(),f.TgZ(15,"button",11),f.TgZ(16,"mat-icon"),f._uU(17,"edit"),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.TgZ(18,"nav"),f.TgZ(19,"button",12),f.NdJ("click",function(){return f.CHM(x),f.oxw().savePipeline()}),f.TgZ(20,"mat-icon"),f._uU(21,"save"),f.qZA(),f.qZA(),f.TgZ(22,"button",13),f.NdJ("click",function(){return f.CHM(x),f.oxw().downloadPipeline()}),f.TgZ(23,"mat-icon"),f._uU(24,"file_download"),f.qZA(),f.qZA(),f.TgZ(25,"button",14),f.NdJ("click",function(){return f.CHM(x),f.MAs(29).click()}),f.TgZ(26,"mat-icon"),f._uU(27,"file_upload"),f.qZA(),f.qZA(),f.TgZ(28,"input",15,16),f.NdJ("change",function(R){return f.CHM(x),f.oxw().importPipeline(R)}),f.qZA(),f.TgZ(30,"button",17),f.TgZ(31,"mat-icon"),f._uU(32,"person"),f.qZA(),f.qZA(),f.TgZ(33,"mat-menu",null,18),f.TgZ(35,"button",19),f.TgZ(36,"mat-icon"),f._uU(37,"dashboard"),f.qZA(),f._uU(38," \u062f\u0627\u0634\u0628\u0648\u0631\u062f "),f.qZA(),f.TgZ(39,"button",20),f.TgZ(40,"mat-icon"),f._uU(41,"manage_accounts"),f.qZA(),f._uU(42," \u0645\u062f\u06cc\u0631\u06cc\u062a \u062d\u0633\u0627\u0628 "),f.qZA(),f.TgZ(43,"button",21),f.TgZ(44,"mat-icon"),f._uU(45,"exit_to_app"),f.qZA(),f._uU(46," \u062e\u0631\u0648\u062c "),f.qZA(),f.qZA(),f.qZA(),f.qZA()}if(2&D){const x=f.MAs(14),k=f.MAs(34),R=f.oxw();f.xp6(13),f.Q6J("ngModel",R.pipeline.name),f.xp6(2),f.Udp("visibility",x.focused?"":"hidden"),f.xp6(15),f.Q6J("matMenuTriggerFor",k)}}function Ne(D,H){1&D&&(f.TgZ(0,"h2",27),f.TgZ(1,"mat-icon"),f._uU(2,"info"),f.qZA(),f._uU(3," \u067e\u0631\u062f\u0627\u0632\u0634\u06cc \u0627\u0646\u062a\u062e\u0627\u0628 \u0646\u0634\u062f\u0647 "),f.qZA())}function Te(D,H){if(1&D&&f._UZ(0,"app-input-config",35),2&D){const x=f.oxw(3);f.Q6J("node",x.selectedNode)("store",x.datasetStore)}}function ge(D,H){if(1&D&&f._UZ(0,"app-output-config",35),2&D){const x=f.oxw(3);f.Q6J("node",x.selectedNode)("store",x.datasetStore)}}function ne(D,H){if(1&D&&f._UZ(0,"app-filter-config",36),2&D){const x=f.oxw(3);f.Q6J("node",x.selectedNode)}}function ue(D,H){if(1&D&&f._UZ(0,"app-sort-config",36),2&D){const x=f.oxw(3);f.Q6J("node",x.selectedNode)}}function oe(D,H){if(1&D&&f._UZ(0,"app-join-config",35),2&D){const x=f.oxw(3);f.Q6J("node",x.selectedNode)("store",x.datasetStore)}}function ut(D,H){if(1&D&&f._UZ(0,"app-aggregate-config",36),2&D){const x=f.oxw(3);f.Q6J("node",x.selectedNode)}}function ft(D,H){if(1&D&&(f.TgZ(0,"div",38),f._uU(1),f.qZA()),2&D){const x=H.$implicit;f.xp6(1),f.hij(" ",x.value," ")}}function rt(D,H){if(1&D&&(f.TgZ(0,"div"),f.YNc(1,ft,2,1,"div",37),f.ALo(2,"async"),f.qZA()),2&D){const x=f.oxw(3);f.xp6(1),f.Q6J("ngForOf",x.listErrors(f.lcZ(2,1,x.selectedNode.validations)))}}function q(D,H){if(1&D){const x=f.EpF();f.TgZ(0,"div",28),f.TgZ(1,"mat-form-field",29),f.TgZ(2,"input",9,30),f.NdJ("ngModelChange",function(R){return f.CHM(x),f.oxw(2).selectedNode.name=R}),f.qZA(),f.TgZ(4,"button",11),f.TgZ(5,"mat-icon"),f._uU(6,"edit"),f.qZA(),f.qZA(),f.TgZ(7,"mat-hint",31),f.TgZ(8,"mat-icon"),f._uU(9),f.qZA(),f.TgZ(10,"span"),f._uU(11),f.qZA(),f.qZA(),f.qZA(),f.TgZ(12,"div",32),f.YNc(13,Te,1,2,"app-input-config",33),f.YNc(14,ge,1,2,"app-output-config",33),f.YNc(15,ne,1,1,"app-filter-config",34),f.YNc(16,ue,1,1,"app-sort-config",34),f.YNc(17,oe,1,2,"app-join-config",33),f.YNc(18,ut,1,1,"app-aggregate-config",34),f.qZA(),f.YNc(19,rt,3,3,"div",1),f.ALo(20,"async"),f.qZA()}if(2&D){const x=f.MAs(3),k=f.oxw(2);f.xp6(2),f.Q6J("ngModel",k.selectedNode.name),f.xp6(2),f.Udp("visibility",x.focused?"":"hidden"),f.xp6(4),f.ekj("mat-icon-rtl-mirror",k.pipelineNodeInfo[k.selectedNode.type].iconMirrored),f.xp6(1),f.hij(" ",k.pipelineNodeInfo[k.selectedNode.type].iconName," "),f.xp6(2),f.Oqu(k.pipelineNodeInfo[k.selectedNode.type].title),f.xp6(1),f.Q6J("ngSwitch",k.selectedNode.type),f.xp6(1),f.Q6J("ngSwitchCase",k.PipelineNodeType.datasetInput),f.xp6(1),f.Q6J("ngSwitchCase",k.PipelineNodeType.datasetOutput),f.xp6(1),f.Q6J("ngSwitchCase",k.PipelineNodeType.filter),f.xp6(1),f.Q6J("ngSwitchCase",k.PipelineNodeType.sort),f.xp6(1),f.Q6J("ngSwitchCase",k.PipelineNodeType.join),f.xp6(1),f.Q6J("ngSwitchCase",k.PipelineNodeType.aggregate),f.xp6(1),f.Q6J("ngIf",null!==f.lcZ(20,15,k.selectedNode.validations))}}function Ee(D,H){if(1&D){const x=f.EpF();f.TgZ(0,"mat-sidenav-container"),f.TgZ(1,"mat-sidenav",22),f.YNc(2,Ne,4,0,"h2",23),f.YNc(3,q,21,17,"div",24),f.qZA(),f.TgZ(4,"mat-sidenav-content"),f.TgZ(5,"app-diagram",25,26),f.NdJ("selectedNode",function(R){return f.CHM(x),f.oxw().selectedNode=R}),f.qZA(),f.qZA(),f.qZA()}if(2&D){const x=f.oxw();f.xp6(2),f.Q6J("ngIf",void 0===x.selectedNode),f.xp6(1),f.Q6J("ngIf",void 0!==x.selectedNode),f.xp6(2),f.Q6J("pipeline",x.pipeline)}}let I=(()=>{class D{constructor(x,k,R,de,Ye,Qt){this.route=x,this.router=k,this.pipelineService=R,this.auth=de,this.datasetStore=Ye,this.snackBar=Qt,this.pipelineNodeInfo=gi,this.PipelineNodeType=_t,this.listErrors=ko}ngOnInit(){this.route.paramMap.subscribe(x=>{const k=parseInt(x.get("id"));this.pipelineService.get(k).subscribe({next:R=>{this.pipeline=li(R)},error:()=>{this.snackBar.open("\u0627\u0634\u06a9\u0627\u0644 \u062f\u0631 \u062f\u0631\u06cc\u0627\u0641\u062a \u0633\u0646\u0627\u0631\u06cc\u0648","",{duration:3e3,verticalPosition:"bottom",horizontalPosition:"center",panelClass:"red-snackbar"})}})})}ngAfterContentInit(){}ngAfterViewInit(){}runPipeline(){var x;null===(x=this.pipeline)||void 0===x||x.validate(this.datasetStore).subscribe(k=>{if(Sr(k)){const de=ko(k)[0].value;return void this.snackBar.open(de,"",{duration:3e3,verticalPosition:"bottom",horizontalPosition:"center",panelClass:"red-snackbar"})}const R=this.basicValidateAndExportPipeline();!R||this.pipelineService.update(R).subscribe({next:()=>{this.snackBar.open("\u062f\u0631 \u062d\u0627\u0644 \u0627\u062c\u0631\u0627\u06cc \u0633\u0646\u0627\u0631\u06cc\u0648","",{duration:3e3,verticalPosition:"bottom",horizontalPosition:"center",panelClass:"purple-snackbar"}),this.pipelineService.execute(this.pipeline.id).subscribe({next:()=>{this.snackBar.open("\u0627\u062c\u0631\u0627\u06cc \u0633\u0646\u0627\u0631\u06cc\u0648 \u0628\u0627 \u0645\u0648\u0641\u0642\u06cc\u062a \u0628\u0647 \u0627\u062a\u0645\u0627\u0645 \u0631\u0633\u06cc\u062f","",{duration:3e3,verticalPosition:"bottom",horizontalPosition:"center",panelClass:"green-snackbar"})},error:Ye=>{console.error(Ye),this.snackBar.open("\u0627\u0634\u06a9\u0627\u0644 \u062f\u0631 \u0627\u062c\u0631\u0627\u06cc \u0633\u0646\u0627\u0631\u06cc\u0648","",{duration:3e3,verticalPosition:"bottom",horizontalPosition:"center",panelClass:"red-snackbar"})}})},error:()=>{this.snackBar.open("\u0627\u0634\u06a9\u0627\u0644 \u062f\u0631 \u0630\u062e\u06cc\u0631\u0647 \u0633\u0646\u0627\u0631\u06cc\u0648","",{duration:3e3,verticalPosition:"bottom",horizontalPosition:"center",panelClass:"red-snackbar"})}})})}basicValidateAndExportPipeline(){let k,x=this.pipeline.reorder();if(!Sr(x)){try{k=pr(this.pipeline)}catch(R){return console.error(R),void this.snackBar.open(R.message,"",{duration:3e3,verticalPosition:"bottom",horizontalPosition:"center",panelClass:"red-snackbar"})}return k}{console.error(x);const R=ko(x)[0].value;this.snackBar.open(R,"",{duration:3e3,verticalPosition:"bottom",horizontalPosition:"center",panelClass:"red-snackbar"})}}savePipeline(){const x=this.basicValidateAndExportPipeline();!x||this.pipelineService.update(x).subscribe({next:()=>{this.snackBar.open("\u0633\u0646\u0627\u0631\u06cc\u0648 \u0628\u0627 \u0645\u0648\u0641\u0642\u06cc\u062a \u0630\u062e\u06cc\u0631\u0647 \u0634\u062f","",{duration:3e3,verticalPosition:"bottom",horizontalPosition:"center",panelClass:"green-snackbar"})},error:()=>{this.snackBar.open("\u0627\u0634\u06a9\u0627\u0644 \u062f\u0631 \u0630\u062e\u06cc\u0631\u0647 \u0633\u0646\u0627\u0631\u06cc\u0648","",{duration:3e3,verticalPosition:"bottom",horizontalPosition:"center",panelClass:"red-snackbar"})}})}downloadPipeline(){const x=this.basicValidateAndExportPipeline();if(!x)return;x.pipelineId=void 0;const k=JSON.stringify(x,null,4);console.log(k),Pa()(k,"pipeline.json")}importPipeline(x){var k=this;return(0,yn.Z)(function*(){var R;const Ye=yield x.target.files.item(0).text(),Qt=li(JSON.parse(Ye));Qt.id=null===(R=k.pipeline)||void 0===R?void 0:R.id,k.pipeline=Qt,x.target.value=""})()}logOut(){this.auth.authToken=null,this.router.navigate(["/"])}}return D.\u0275fac=function(x){return new(x||D)(f.Y36(Fr.gz),f.Y36(Fr.F0),f.Y36(Fa.n),f.Y36(fr.e),f.Y36(Jr),f.Y36(Qr.ux))},D.\u0275cmp=f.Xpm({type:D,selectors:[["app-pipeline"]],viewQuery:function(x,k){if(1&x&&f.Gf(_e,5),2&x){let R;f.iGM(R=f.CRH())&&(k.diagram=R.first)}},decls:2,vars:2,consts:[["color","primary",4,"ngIf"],[4,"ngIf"],["color","primary"],["routerLink","/","mat-flat-button","","disableRipple","","color","primary"],[1,"logo-name"],[1,"pipeline-info"],["title","\u0627\u062c\u0631\u0627","mat-icon-button","","mat-raised-button","","mat-tip","",3,"click"],["color","primary",1,"mat-icon-rtl-mirror"],["floatLabel","never"],["matInput","","type","text",3,"ngModel","ngModelChange"],["pipelineNameInput","matInput"],["matSuffix","","mat-icon-button","","disabled","",2,"color","inherit"],["title","\u0630\u062e\u06cc\u0631\u0647","mat-icon-button","",3,"click"],["title","\u062f\u0627\u0646\u0644\u0648\u062f \u0633\u0646\u0627\u0631\u06cc\u0648","mat-icon-button","",3,"click"],["title","\u0622\u067e\u0644\u0648\u062f \u0633\u0646\u0627\u0631\u06cc\u0648","mat-icon-button","",3,"click"],["type","file","hidden","",3,"change"],["pipelineImport",""],["mat-button","",3,"matMenuTriggerFor"],["accountMenu","matMenu"],["mat-menu-item","","routerLink","/"],["mat-menu-item","","routerLink","/user/edit_profile"],["mat-menu-item","","click","logOut()"],["mode","side","opened","","disableClose",""],["class","no-selected-node",4,"ngIf"],["class","config-pane",4,"ngIf"],[3,"pipeline","selectedNode"],["diagram",""],[1,"no-selected-node"],[1,"config-pane"],[1,"node-name-input"],["nodeNameInput","matInput"],[1,"node-type-info"],[3,"ngSwitch"],[3,"node","store",4,"ngSwitchCase"],[3,"node",4,"ngSwitchCase"],[3,"node","store"],[3,"node"],["class","error-list-item",4,"ngFor","ngForOf"],[1,"error-list-item"]],template:function(x,k){1&x&&(f.YNc(0,Ae,47,4,"mat-toolbar",0),f.YNc(1,Ee,7,3,"mat-sidenav-container",1)),2&x&&(f.Q6J("ngIf",void 0!==k.pipeline),f.xp6(1),f.Q6J("ngIf",void 0!==k.pipeline))},directives:[$e.O5,Da.Ye,Fr.yS,vt.zs,un.Hw,vt.lW,Xt.KE,Xt.hX,En.Nt,Ht.Fj,Ht.JJ,Ht.On,Xt.R9,Sn.p6,Sn.VK,Sn.OP,Fr.rH,Ei.TM,Ei.JX,Ei.Rh,$o,Xt.bx,$e.RF,$e.n9,gr,ta,Ro,C,le,se,$e.sg],pipes:[$e.Ov],styles:["[_nghost-%COMP%]{display:grid;grid-template-rows:auto 1fr;height:100%}.mat-toolbar[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;z-index:2}.logo-name[_ngcontent-%COMP%]{font-size:20px}.pipeline-info[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:baseline;grid-gap:var(--density-large);gap:var(--density-large);font-size:16px}.pipeline-info[_ngcontent-%COMP%]     .mat-form-field-underline{background-color:transparent}nav[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;grid-gap:var(--density-large);gap:var(--density-large)}.mat-sidenav[_ngcontent-%COMP%]{width:30rem}.no-selected-node[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center;grid-gap:var(--density-normal);gap:var(--density-normal);padding:var(--density-larger);color:#0000008a}.config-pane[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100%;padding:var(--density-large);padding-top:0;grid-gap:var(--density-larger);gap:var(--density-larger)}.config-pane[_ngcontent-%COMP%]     .wide-field{width:100%}.config-pane[_ngcontent-%COMP%]     .propery-input{direction:ltr;text-align:left}.config-pane[_ngcontent-%COMP%]     .config-title-add{display:flex;flex-direction:row;align-items:baseline;justify-content:space-between}.node-name-input[_ngcontent-%COMP%]{font-size:20px}.node-name-input[_ngcontent-%COMP%]     .mat-form-field-underline{background-color:transparent}.node-type-info[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;grid-gap:var(--density-small);gap:var(--density-small)}.error-list-item[_ngcontent-%COMP%]{color:#f44336}"]}),D})();var xe=Tt(4473),Fe=Tt(5826);const ct=[{path:":id",canActivate:[Fe.a],component:I},{path:"",canActivate:[Fe.a],component:ps},{path:"**",redirectTo:"/"}];let fe=(()=>{class D{}return D.\u0275fac=function(x){return new(x||D)},D.\u0275mod=f.oAB({type:D}),D.\u0275inj=f.cJS({providers:[ir,fr.e,Jr,Fe.a],imports:[[$e.ez,Fr.Bz.forChild(ct),xe.q,Ht.u5,Ht.UX]]}),D})()},7646:function(Yr,cn,Tt){(Yr=Tt.nmd(Yr)).exports=function(){"use strict";function $e(e){return"function"==typeof e||"[object Function]"===nr.call(e)}function yn(e){var i,t=(i=Number(e),isNaN(i)?0:0!==i&&isFinite(i)?(0<i?1:-1)*Math.floor(Math.abs(i)):i);return Math.min(Math.max(t,0),cr)}var nr,cr;Array.prototype.fill||Object.defineProperty(Array.prototype,"fill",{value:function(e){if(null==this)throw new TypeError("this is null or not defined");for(var t=Object(this),n=t.length>>>0,i=arguments[1]>>0,r=i<0?Math.max(n+i,0):Math.min(i,n),o=arguments[2],a=void 0===o?n:o>>0,s=a<0?Math.max(n+a,0):Math.min(a,n);r<s;)t[r]=e,r++;return t}}),Array.prototype.copyWithin||(Array.prototype.copyWithin=function(e,t){if(null==this)throw new TypeError("this is null or not defined");var n=Object(this),i=n.length>>>0,r=e>>0,o=r<0?Math.max(i+r,0):Math.min(r,i),a=t>>0,s=a<0?Math.max(i+a,0):Math.min(a,i),l=arguments[2],u=void 0===l?i:l>>0,d=u<0?Math.max(i+u,0):Math.min(u,i),c=Math.min(d-s,i-o),h=1;for(s<o&&o<s+c&&(h=-1,s+=c-1,o+=c-1);0<c;)s in n?n[o]=n[s]:delete n[o],s+=h,o+=h,c--;return n}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(e){if(null==this)throw new TypeError;var t=Object(this),n=t.length>>>0;if(0==n)return-1;var i=n-1;1<arguments.length&&((i=Number(arguments[1]))!=i?i=0:0!=i&&i!=1/0&&i!=-1/0&&(i=(0<i?1:-1)*Math.floor(Math.abs(i))));for(var r=0<=i?Math.min(i,n-1):n-Math.abs(i);0<=r;r--)if(r in t&&t[r]===e)return r;return-1}),Array.from||(Array.from=(nr=Object.prototype.toString,cr=Math.pow(2,53)-1,function(e,t,n){var i=Object(e);if(null==e)throw new TypeError("Array.from requires an array-like object - not null or undefined");var r,o=1<arguments.length?t:void 0;if(void 0!==o){if(!$e(o))throw new TypeError("Array.from: when provided, the second argument must be a function");2<arguments.length&&(r=n)}for(var a,s=yn(i.length),l=$e(this)?Object(new this(s)):new Array(s),u=0;u<s;)a=i[u],l[u]=o?void 0===r?o(a,u):o.call(r,a,u):a,u+=1;return l.length=s,l})),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),i=n.length>>>0;if(0==i)return!1;for(var r,o,a=0|t,s=Math.max(0<=a?a:i-Math.abs(a),0);s<i;){if((r=n[s])===(o=e)||"number"==typeof r&&"number"==typeof o&&isNaN(r)&&isNaN(o))return!0;s++}return!1}}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var i=arguments[1],r=0;r<n;){var o=t[r];if(e.call(i,o,r,t))return o;r++}},configurable:!0,writable:!0});var Er=[Uint32Array,Uint16Array,Uint8Array,Int32Array,Int16Array,Int8Array,Float32Array,Float64Array],Gi=["join","slice","reverse","forEach","map","includes","copyWithin","reduce","indexOf","sort","filter","every","some","fill"];ArrayBuffer.isView||(ArrayBuffer.isView=function(e){for(var t=0;t<Er.length;++t)if(e instanceof Er[t])return!0;return!1});for(var lo,Qo=function(e){return function(t,n){return new e(Array.prototype.slice.call(this,t,n))}},hr=function(e){for(var t=0,n=Gi;t<n.length;t++){var i=n[t];if(!e.prototype[i]){var r="slice"===i?Qo(e):Array.prototype[i];e.prototype[i]=r}}e.from||(e.from=function(o,a,s){var l=e.__proto__;if("function"!=typeof this)throw new TypeError("# is not a constructor");if(this.__proto__!==l)throw new TypeError("this is not a typed array.");if("function"!=typeof(a=a||function(h){return h}))throw new TypeError("specified argument is not a function");if(!(o=Object(o)).length)return new this(0);for(var u=[],d=0;d<o.length;d++)u.push(o[d]);var c=new this((u=u.map(a,s)).length);for(d=0;d<c.length;d++)c[d]=u[d];return c})},Mo=0,qi=Er;Mo<qi.length;Mo++)hr(qi[Mo]);function ui(){}function _t(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],La(e,this)}function gi(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,_t._immediateFn(function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var i;try{i=n(e._value)}catch(r){return void zi(t.promise,r)}Ci(t.promise,i)}else(1===e._state?Ci:zi)(t.promise,e._value)})):e._deferreds.push(t)}function Ci(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof _t)return e._state=3,e._value=t,void co(e);if("function"==typeof n)return void La((i=n,r=t,function(){i.apply(r,arguments)}),e)}e._state=1,e._value=t,co(e)}catch(o){zi(e,o)}var i,r}function zi(e,t){e._state=2,e._value=t,co(e)}function co(e){2===e._state&&0===e._deferreds.length&&_t._immediateFn(function(){e._handled||_t._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)gi(e,e._deferreds[t]);e._deferreds=null}function cs(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function La(e,t){var n=!1;try{e(function(i){n||(n=!0,Ci(t,i))},function(i){n||(n=!0,zi(t,i))})}catch(i){if(n)return;n=!0,zi(t,i)}}"undefined"==typeof CanvasRenderingContext2D||CanvasRenderingContext2D.prototype.setLineDash||(CanvasRenderingContext2D.prototype.setLineDash=function(e){}),Math.log2||(Math.log2=function(e){return Math.log(e)*Math.LOG2E}),Math.sign||(Math.sign=function(e){return(0<e?1:0)-(e<0?1:0)||+e}),Number.isNaN||(Number.isNaN=function(e){return"number"==typeof e&&isNaN(e)}),Number.MAX_SAFE_INTEGER||Object.defineProperty(Number,"MAX_SAFE_INTEGER",{enumerable:!1,configurable:!1,writable:!1,value:Math.pow(2,53)-1}),lo=setTimeout,_t.prototype.catch=function(e){return this.then(null,e)},_t.prototype.then=function(e,t){var n=new this.constructor(ui);return gi(this,new cs(e,t,n)),n},_t.all=function(e){var t=Array.prototype.slice.call(e);return new _t(function(n,i){if(0===t.length)return n([]);var r=t.length;function o(s,l){try{if(l&&("object"==typeof l||"function"==typeof l)){var u=l.then;if("function"==typeof u)return void u.call(l,function(d){o(s,d)},i)}t[s]=l,0==--r&&n(t)}catch(d){i(d)}}for(var a=0;a<t.length;a++)o(a,t[a])})},_t.resolve=function(e){return e&&"object"==typeof e&&e.constructor===_t?e:new _t(function(t){t(e)})},_t.reject=function(e){return new _t(function(t,n){n(e)})},_t.race=function(e){return new _t(function(t,n){for(var i=0,r=e.length;i<r;i++)e[i].then(t,n)})},_t._immediateFn="object"==typeof global&&"function"==typeof global.setImmediate&&function(e){global.setImmediate(e)}||function(e){lo(e,0)},_t._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},_t._setImmediateFn=function(e){_t._immediateFn=e},_t._setUnhandledRejectionFn=function(e){_t._unhandledRejectionFn=e},"object"!=typeof global||global.Promise||(global.exports=_t),"object"!=typeof window||"Promise"in window||(window.Promise=_t),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var n=this.toString();("number"!=typeof t||!isFinite(t)||Math.floor(t)!==t||t>n.length)&&(t=n.length);var i=n.lastIndexOf(e,t-=e.length);return-1!==i&&i===t}),String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(t||0,e.length)===e}),String.prototype.includes||(String.prototype.includes=function(e,t){return"number"!=typeof t&&(t=0),!(t+e.length>this.length)&&-1!==this.indexOf(e,t)}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e){var t=arguments;if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),i=1;i<arguments.length;i++){var r=t[i];if(null!=r)for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])}return n},writable:!0,configurable:!0});var Ko=function(e,t){return(Ko=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var r in i)i.hasOwnProperty(r)&&(n[r]=i[r])})(e,t)};function wt(e,t){function n(){this.constructor=e}Ko(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var Nt=function(){return(Nt=Object.assign||function(e){for(var t,n=arguments,i=1,r=arguments.length;i<r;i++)for(var o in t=n[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function Io(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}var Jn={},ho={},hs={},Sr=function(e){return null};if("object"==typeof global&&(ho=global),"object"==typeof window&&(hs=window),"function"==typeof Yr.require){var ko=Yr.require.bind(Yr);Sr=function(e){try{return ko(e)}catch(t){return null}}}else"function"==typeof ho.require&&(Sr=function(e){var t=Yr.require;try{return t(e)}catch(n){return null}});function bi(e,t){var n=(void 0===t?{}:t).throwOnError,i=null;if(!i&&e&&(i=Jn[e]),!i&&e&&(i=Sr(e)),!i&&e&&(i=hs[e]),!i&&e&&(i=ho[e]),i||!n)return i;var r=['unable to find module "'+e+'"; make sure one of these statements is true:',"- Ogma.libraries['"+e+"'] is set to the right library","- require('"+e+"') returns the right library","- window['"+e+"'] is set to the right library"].join("\n");throw new Error(r)}function Xr(e,t){for(var n=1,i=e.length;n<i;n++){for(var r=e[n],o=n;0<o&&t.get(e[o-1])>t.get(r);)e[o]=e[o-1],--o;e[o]=r}return e}function pr(e,t){for(var n=1,i=e.length;n<i;n++){for(var r=e[n],o=n;0<o&&t.get(e[o-1])<t.get(r);)e[o]=e[o-1],--o;e[o]=r}return e}function li(e){return Array.isArray(e)||ArrayBuffer.isView(e)}function f(e){return Array.isArray(e)?e:[e]}function Fr(e){for(var t=[],n=0;n<e.length;++n){var i=e[n];if(Array.isArray(i))for(var r=0;r<i.length;++r)t.push(i[r]);else t.push(i)}return t}function Fa(e,t){var n=e.indexOf(t);return-1!==n&&(e.splice(n,1),!0)}function ps(e,t){for(var n,i,r=0,o=e.length-1;r<=o;)if((i=e[n=(r+o)/2|0])<t)r=1+n;else{if(!(t<i))return n;o=n-1}return-1}function Pr(e){if(!e)return[];if("string"==typeof e)return e.split(".");if(Array.isArray(e)){for(var t=0;t<e.length;++t)if("string"!=typeof e[t])throw new TypeError(e[t]+" is not a string");return e.slice()}throw new TypeError('invalid property path "'+e+'": expected string or array of strings')}function Pa(e,t,n){var i,r,o;if(0===t)return function(){e.apply(n,arguments)};function a(){i=!1,r&&(o.apply(n,r),r=null)}return o=function(){var s;return i?r=arguments:(s=e.apply(n,arguments),setTimeout(a,t),i=!0),s}}function fr(){return 120===new Uint8Array(new Uint32Array([305419896]).buffer)[0]}function Hi(e){return e.reduce(function(t,n){return t.then(n)},Promise.resolve())}function Jr(e,t,n,i,r,o,a,s){return e+r+256*(t+o)+65536*(n+a)+16777216*(i+s)}function Qr(e){return!(null===e||"object"!=typeof e||li(e)||e instanceof RegExp||"undefined"!=typeof HTMLElement&&e instanceof HTMLElement)}function Da(e){for(var t=Object.keys(e),n=new Array(t.length),i=0;i<t.length;++i)n[i]=e[t[i]];return n}function vt(e,t,n){if(Array.isArray(e))return e.forEach(t,n);if(!Qr(e))throw new Error("forEach: invalid argument "+JSON.stringify(e));var i=Object.keys(e);if(void 0!==n)for(var r=0;r<i.length;++r){var o=i[r];t.call(n,e[o],o)}else for(r=0;r<i.length;++r)t(e[o=i[r]],o)}function un(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=un(e[n]);return t}if(!en(e))return e;var i={},r=Object.keys(e);for(n=0;n<r.length;++n){var o=r[n];i[o]=un(e[o])}return i}function Xt(e,t,n){for(var i="string"==typeof t?t.split("."):t,r=0;r<i.length-1;++r){var o=i[r],a=e[o];a||(e[o]=a={}),e=a}e[i[i.length-1]]=n}function En(e,t){var n=Pr(t);if(!n.length)return e;if(e){for(var i=0;i<n.length-1;++i){var r=e[n[i]];if(!r)return;e=r}return e[n[n.length-1]]}}function Ht(e,t,n){void 0===n&&(n="."),t=t||function(h){return!Qr(h)};for(var i={},r=Object.keys(e),o=0;o<r.length;++o){var a=r[o],s=e[a];if(t(s))i[a]=s;else for(var l=Ht(s,t),u=Object.keys(l),d=0;d<u.length;d++){var c=u[d];i[""+a+n+c]=l[c]}}return i}function Sn(e){for(var t={},n=Object.keys(e),i=0;i<n.length;++i){var r=n[i];Xt(t,r,e[r])}return t}function Ei(e,t,n){void 0===n&&(n=[]);for(var i=Object.keys(e),r=0;r<i.length;++r){var o=i[r],a=e[o],s=t?t+o:o;en(a)?Ei(a,s+".",n):n.push(s)}return n}function Qn(e,t){if(void 0===t&&(t=[]),en(e))for(var n=0,i=Object.keys(e);n<i.length;n++)Qn(e[i[n]],t);else t.push(e);return t}function Wi(e){for(var t in e)"function"==typeof e[t]&&delete e[t];return e}function ln(e,t){if(void 0===e)return un(t);if(!Qr(e))return e;for(var n={},i=0,r=Object.keys(t);i<r.length;i++){var o=r[i],a=t[o],s=e[o];n[o]=Qr(a)?ln(s,a):void 0===s?un(a):s}return n}function en(e){return e&&(e.constructor===Object||!e.constructor)}function ir(e,t){if(!en(t)||!en(e))return t;for(var n=Object.assign({},e),i=Object.keys(t),r=0;r<i.length;++r){var o=i[r];n[o]=ir(n[o],t[o])}return n}function Ra(e,t){return null==t?e:t.reduce(function(n,i){return n[i]=e[i],n},{})}var Oo,fs=(Oo=0,"undefined"!=typeof requestAnimationFrame?requestAnimationFrame:function(e){var t=Date.now(),n=Math.min(16,Math.max(0,16-(t-Oo))),i=Oo=t+n;return setTimeout(function(){return e(i)},n)}),gs="undefined"!=typeof cancelAnimationFrame?cancelAnimationFrame:function(e){return clearTimeout(e)};function No(e,t){return fs(function(n){e.call(t,n)})}function di(e){e&&gs(e)}var za,qn,Ba,Dr,Si="object"==typeof global&&null!==global&&void 0!==global.it,rr="undefined"!=typeof document,Yi="undefined"!=typeof window,Rr=Yi&&!window.__OGMA_HEADLESS,po=Rr&&rr,Lo=(Kn.prototype.open=function(e,t){this.method=e,this.url=t,Kn.onSend&&Kn.onSend(this)},Kn.prototype.respond=function(e,t,n){this.readyState=4,this.status=e,this.headers=t,this.responseText=n,this.response=n,this.onreadystatechange()},Kn.prototype.send=function(){this.readyState=4},Kn.onCreate=null,Kn.onSend=null,Kn);function Kn(){this.method=null,this.url=null,this.status=0,this.readyState=0,this.headers={},this.responseText=null,this.response=null,Kn.onCreate&&Kn.onCreate(this)}var Fo=(Xi.prototype.readAsDataURL=function(e){this._blob=e,Xi.onRead&&Xi.onRead(this)},Xi.prototype.load=function(e){this.result="function"==typeof e?e(this._blob):e,this.onload&&this.onload()},Xi.onCreate=null,Xi.onRead=null,Xi);function Xi(){this.onload=null,Xi.onCreate&&Xi.onCreate(this)}function Bi(){return qn||{createElementNS:function(){return null},createElement:function(){return null},implementation:{createDocument:function(){throw new Error('unable to create XML document; if you use Node JS install the "xmldom" package')}}}}function fo(e,t){var n=e.style[t];if((!n||"auto"===n)&&Bi().defaultView){var i=document.defaultView.getComputedStyle(e,null);n=i?i[t]:null}return"auto"===n?null:n}za=bi("xmldom"),qn=rr?document:za?(new za.DOMImplementation).createDocument():null,Ba="undefined"!=typeof XMLHttpRequest?XMLHttpRequest:Lo,Dr="undefined"!=typeof FileReader?FileReader:Fo;var Vi=(Object.defineProperty(_i.prototype,"offsetWidth",{get:function(){return parseFloat(this.style.width)},enumerable:!0,configurable:!0}),Object.defineProperty(_i.prototype,"offsetHeight",{get:function(){return parseFloat(this.style.height)},enumerable:!0,configurable:!0}),Object.defineProperty(_i.prototype,"firstChild",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(_i.prototype,"parentNode",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(_i.prototype,"classList",{get:function(){return{length:0,value:"",add:function(){},remove:function(){},contains:function(e){return!1},item:null}},enumerable:!0,configurable:!0}),Object.defineProperty(_i.prototype,"innerHTML",{get:function(){return""},set:function(e){},enumerable:!0,configurable:!0}),_i.prototype.appendChild=function(){},_i.prototype.removeChild=function(){},_i.prototype.addEventListener=function(){},_i.prototype.removeEventListener=function(){},_i.prototype.insertBefore=function(){},_i.prototype.contains=function(e){return!1},_i);function _i(){this.onmousewheel=function(){},this.__dummy=!0,this.style={},this.clientWidth=0,this.clientHeight=0,this.childNodes=[],this.style={width:"0px",height:"0px",top:null,left:null,position:"",backgroundColor:null}}function $o(){return new Vi}function Fn(){return Yi&&window.devicePixelRatio||1}function Hn(e){var t,n,i,r=";base64,";if(-1===e.indexOf(r))return n=(t=e.split(","))[0].split(":")[1],gr(i=decodeURIComponent(t[1]),n);n=(t=e.split(r))[0].split(":")[1];for(var o=(i=window.atob(t[1])).length,a=new Uint8Array(o),s=0;s<o;++s)a[s]=i.charCodeAt(s);return gr([a],n)}var Wn=function(e,t){this.data=e,this.type=t};function gr(e,t){return"undefined"!=typeof Blob?new Blob(e,{type:t}):new Wn(e,t)}function hn(e,t,n){if(!Rr)return e;var i=null,r=null,o=null;if(window.Blob?(i="blob"===n?e:"dataURL"===n?Hn(e):gr([e],"text/xml"),r=window.URL.createObjectURL(i)):o="data:text/xml;charset=UTF-8,"+encodeURIComponent('<?xml version="1.0" encoding="UTF-8"?>')+encodeURIComponent(e),navigator.msSaveBlob)navigator.msSaveBlob(i,t);else if(navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(i,t);else{var a=document.createElement("a");a.setAttribute("href",window.Blob?r:o),a.setAttribute("download",t),document.body.appendChild(a),a.click(),document.body.removeChild(a)}return r&&setTimeout(function(){window.URL.revokeObjectURL(r)},0),e}function Po(e,t,n,i){if(void 0===i&&(i=Fn()),e.style.width=t+"px",e.style.height=n+"px","IMG"===e.tagName||"CANVAS"===e.tagName){var r=e;r.width=t*i,r.height=n*i}}function ea(e,t){vt(t,function(n,i){void 0!==n&&e.setAttribute(i,n)})}var ta="http://www.w3.org/2000/svg",On="http://www.w3.org/2000/xmlns/",dt="http://www.w3.org/1999/xlink";function gn(e,t){var n=qn.createElementNS(ta,e);return n.style||(n.style={}),t&&ea(n,t),n}function Ti(e){return qn.createTextNode(e)}function _s(e){return"undefined"==typeof Image?Promise.resolve(null):new Promise(function(t){var n=new Image;n.src=e,n.onload=function(){return t(n)},n.onerror=function(){return t(null)}})}function Kr(e){if(0===e.indexOf("http://")||0===e.indexOf("https://"))return e;var t=window.location.origin,n=window.location.pathname,i=n.lastIndexOf("/");return-1===i?t+"/"+e:t+n.substr(0,i)+"/"+e}function mi(e){return new Promise(function(t,n){var i=new Ba;i.open("GET",Kr(e),!0),i.onreadystatechange=function(){if(4===i.readyState){var r=i.status;200===r?t(i.responseText):n(0!==r?new Error('cannot retrieve file at url "'+e+'"; the server responded with status code '+r+"."):new Error('cannot send XMLHttpRequest to url "'+e+"\"; if you're using the local file protocol this is most likely the cause."))}},i.onerror=function(){n(new Error('cannot retrieve file at url "'+e+'"; the XMLHttpRequest failed.'))},i.send()})}function Do(e){return"undefined"!=typeof HTMLElement&&e instanceof HTMLElement}function $r(e,t){e.style.cursor=t,e.style.cursor!==t&&(e.style.cursor="-webkit-"+t)}function Va(e){return new Promise(function(t,n){var i=new Ba;i.responseType="blob",i.open("GET",Kr(e),!0),i.onreadystatechange=function(){4===i.readyState&&(200===i.status?t(i.response):n(i.status))},i.onerror=function(r){return n(r)},i.send()})}function Ro(e){return Va(e).then(function(t){return new Promise(function(n,i){var r=new Dr;r.onerror=i,r.onload=function(){return n(r.result)},r.readAsDataURL(t)})})}function _r(e,t){void 0===t&&(t=!0);var n=t?"&#13;":"\n";return(""+e).replace(/&/g,"&amp;").replace(/'/g,"&apos;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r\n/g,n).replace(/[\r\n]/g,n)}var Mi={0:"left",1:"middle",2:"right"};function _(e){if(e.baseURI)return e.baseURI;var t=e.getElementsByTagName("base");return 0<t.length?t[0].href:e.URL||e.location.href}function A(e,t,n,i){return new Promise(function(r){var o=t,a=Date.now(),s=(n-t)*Math.min(1,1/(i/16));!function l(){Date.now()-a<i?(o=Math.min(1,Math.max(0,o+s)),e.style.opacity=o.toString(),No(l)):r()}()})}var C="undefined"!=typeof performance&&performance.now?function(){return 0|performance.now()}:function(){return Date.now()},T=C();function P(){return C()-T}function V(){var e=new Date,t=e.getDate(),n=e.getMonth()+1;return e.getFullYear()+"-"+(n<10?"0"+n:n)+"-"+(t<10?"0"+t:t)}function le(){var e=new Date;return"["+te((e.getUTCHours()-(e.getTimezoneOffset()/60|0))%24)+":"+te(e.getUTCMinutes())+":"+te(e.getUTCSeconds())+":"+te(e.getUTCMilliseconds(),3)+"]"}function te(e,t){void 0===t&&(t=2);for(var n=Math.pow(10,t-1),i=String(e);1<n;)e<n&&(i="0"+i),n/=10;return i}var re,j,ee=Yi&&!window.PointerEvent&&!!window.MSPointerEvent,ye=Yi&&!(!window.PointerEvent&&!ee),G=ee?"MSPointerDown":"pointerdown",Q=ee?"MSPointerMove":"pointermove",$=ee?"MSPointerUp":"pointerup",se=ee?"MSPointerCancel":"pointercancel",_e={},Ae=0;function Ne(e){return"mouse"===e.pointerType||e.MSPOINTER_TYPE_MOUSE&&e.pointerType===e.MSPOINTER_TYPE_MOUSE}function Te(e){return"mouse"!==e.pointerType&&e.MSPOINTER_TYPE_MOUSE&&e.pointerType!==e.MSPOINTER_TYPE_MOUSE}function ge(e){_e[e.pointerId]=e}function ne(e){_e[e.pointerId]&&(_e[e.pointerId]=e)}function ue(e){delete _e[e.pointerId]}function oe(e,t){for(var n in e.touches=[],_e)e.touches.push(_e[n]);e.changedTouches=[e],t(e)}function Ee(e,t,n,i){return n===re.START?e(t,G,i,!1):n===re.MOVE?e(t,Q,i,!1):n===re.END?(e(t,$,i,!1),e(t,se,i,!1)):void 0}(j=re=re||{}).START="touchstart",j.MOVE="touchmove",j.END="touchend",j.CANCEL="touchcancel";var I,xe,Fe=(ct.prototype.onMounted=function(e,t){},ct.prototype.destroy=function(e){},ct);function ct(){}(xe=I=I||{}).MOVE="move",xe.DOWN="down",xe.UP="up",xe.CLICK="click",xe.DOUBLE_CLICK="doubleClick",xe.HOVER="hover",xe.UNHOVER="unhover",xe.WHEEL="wheel",xe.DRAG_START="dragStart",xe.DRAG_PROGRESS="dragProgress",xe.DRAG_END="dragEnd",xe.GESTURE_START="gestureStart",xe.GESTURE_PROGRESS="gestureProgress",xe.GESTURE_END="gestureEnd",xe.RESIZE="resize",xe.ADD_NODES="addNodes",xe.ADD_EDGES="addEdges",xe.REMOVE_NODES="removeNodes",xe.REMOVE_EDGES="removeEdges",xe.BEFORE_REMOVE_NODES="beforeRemoveNodes",xe.BEFORE_REMOVE_EDGES="beforeRemoveEdges",xe.CLEAR_GRAPH="clear",xe.EXCLUDED_STATE_CHANGE="excludedStateChange",xe.UPDATE_ATTRIBUTES="updateAttributes",xe.RENDERER_STATE_CHANGE="rendererStateChange",xe.UPDATE_NODE_DATA="updateNodeData",xe.UPDATE_EDGE_DATA="updateEdgeData",xe.SET_DATA="setData",xe.START_ZOOM="startZoom",xe.VIEW_CHANGED="viewChanged",xe.MOVE_END="moveEnd",xe.CAMERA_MOVE="cameraMove",xe.CAMERA_ROTATE="cameraRotate",xe.CAMERA_PAN="cameraPan",xe.CAMERA_ZOOM="cameraZoom",xe.NODES_DRAG_START="startMoveNodesByDragging",xe.NODES_DRAG_PROGRESS="progressMoveNodesByDragging",xe.NODES_DRAG_END="endMoveNodesByDragging",xe.ANIMATE="animate",xe.NEW_FRAME="newFrame",xe.BEFORE_NEW_FRAME="beforeNewFrame",xe.AFTER_NEW_FRAME="afterNewFrame",xe.SET_CONTAINER="setContainer",xe.RELOAD_FONTS="reloadFonts",xe.MOUSE_LEAVE="mouseLeave",xe.MOUSE_DOWN="mouseDown",xe.MOUSE_UP="mouseUp",xe.MOUSE_MOVE="mouseMove",xe.MOUSE_WHEEL="mouseWheel",xe.MOUSE_CLICK="mouseClick",xe.MOUSE_DOUBLE_CLICK="mouseDoubleClick",xe.DOCUMENT_MOUSE_MOVE="documentMouseMove",xe.DOCUMENT_MOUSE_UP="documentMouseUp",xe.VIRTUAL_DOWN="virtualDown",xe.VIRTUAL_UP="virtualUp",xe.VIRTUAL_MOVE="virtualMove",xe.VIRTUAL_CLICK="virtualClick",xe.VIRTUAL_DOUBLE_CLICK="virtualDoubleClick",xe.VIRTUAL_WHEEL="virtualWheel",xe.TOUCH_DOWN="touchDown",xe.TOUCH_UP="touchUp",xe.TOUCH_TAP="touchTap",xe.TOUCH_DOUBLE_TAP="touchDoubleTap",xe.TOUCH_MOVE="touchMove",xe.TOUCH_START_GESTURE="touchStartGesture",xe.TOUCH_PROGRESS_GESTURE="touchProgressGesture",xe.TOUCH_END_GESTURE="touchEndGesture",xe.DOCUMENT_TOUCH_MOVE="documentTouchMove",xe.DOCUMENT_TOUCH_UP="documentTouchUp",xe.GEO_LOADED="geoLoaded",xe.GEO_ENABLED="geoEnabled",xe.GEO_DISABLED="geoDisabled",xe.GEO_READY="geoReady",xe.TOOLTIP_HIDE="hideTooltip",xe.TOOLTIP_SHOW="showTooltip",xe.CONNECT_NODES="connectNodes",xe.LAYOUT_START="layoutStart",xe.LAYOUT_END="layoutEnd",xe.LAYOUT_COMPUTED="layoutComputed";var fe,D=["graphics","legend","brand"],H=(wt(x,fe=Fe),x.prototype.onMounted=function(e,t){t.container&&e.setContainer(t.container)},x.prototype.addWindowEventListener=function(e,t,n){this._isRealBrowser&&this.addElementEventListener(window,e,t,n)},x.prototype.addDocumentEventListener=function(e,t,n){return this._isDocumentReady&&this.addElementEventListener(document.documentElement,e,t,n),t},x.prototype.removeDocumentEventListener=function(e,t){this._isDocumentReady&&document.documentElement.removeEventListener(e,t)},x.prototype.addMediaListener=function(e,t){if(this._isDocumentReady&&"function"==typeof window.matchMedia){var n=window.matchMedia(e);n.addListener(t),this._onDetachDom.push(function(){return n.removeListener(t)})}},x.prototype.addElementEventListener=function(e,t,n,i){return this._isDestroyed||(e.addEventListener(t,n,i),this._onDetachDom.push(function(){return e.removeEventListener(t,n,i)})),n},x.prototype.detachFromDom=function(){this._onDetachDom.forEach(function(e){return e()}),this._onDetachDom=null,this._emptyContainer()},x.prototype.setTimeout=function(e,t){var n=this;void 0===t&&(t=0);var i=setTimeout(function(){n._timeouts.splice(n._timeouts.indexOf(i),1),e()},t);return this._timeouts.push(i),i},x.prototype.clearTimeout=function(e){return e&&(clearTimeout(e),this._timeouts.splice(this._timeouts.indexOf(e),1)),null},x.prototype.clearAllTimeouts=function(){this._timeouts.forEach(clearTimeout),this._timeouts=[]},x.prototype.stopFrames=function(){this._isDestroyed=!0,this._nextFrame&&(di(this._nextFrame),this._nextFrame=null)},x.prototype.isDestroyed=function(){return this._isDestroyed},x.prototype.getDimensions=function(){return{width:this._width,height:this._height}},x.prototype.setDimensions=function(e){this._resize(e)},x.prototype.setLayer=function(e,t,n){var i=(void 0===n?{}:n).automaticResize,r=void 0!==i&&i;t&&(t._ogmaLayer=e,r&&(t.style.position="absolute",t.style.top="0px",t.style.left="0px",Po(t,this._width,this._height,Fn()))),this._layers[e]={element:t,automaticResize:r},this._updateContainerContent()},x.prototype.setContainer=function(e){if("string"==typeof e){var t=e;if(!(e=document.getElementById(t)))throw new Error('unable to find DOM element with id "'+t+'"')}if(e!==this._container){var n=this._container;this._isFullScreen=!1,this._container=e,this._resize(),this._updateContainerContent(),this._events.fire(I.SET_CONTAINER,{element:e,prevElement:n})}},x.prototype.getContainer=function(){return this._container},x.prototype.appendElement=function(e){null!==this._container&&this._container.appendChild(e)},x.prototype.focus=function(){this._focus=!0},x.prototype.blur=function(){this._focus=!1},x.prototype.hasFocus=function(){return this._focus},x.prototype.forceResize=function(){this._resize()},x.prototype._beforeOrAfterNextFrame=function(e){var t=e?this._afterNextFramePromises:this._beforeNextFramePromises,n=new Promise(function(i){t.push(function(){return i(),n})});return this._refresh(),n},x.prototype.beforeNextFrame=function(){return this._beforeOrAfterNextFrame(!1)},x.prototype.afterNextFrame=function(){return this._beforeOrAfterNextFrame(!0)},x.prototype.refresh=function(e){e&&(this._refreshUntil=Math.max(this._refreshUntil,e)),this._refresh()},x.prototype._emptyContainer=function(){if(this._container){for(var e=[],t=0;t<this._container.childNodes.length;++t){var n=this._container.childNodes[t];n._ogmaLayer&&e.push(n)}for(t=0;t<e.length;++t)this._container.removeChild(e[t])}},x.prototype._fillContainer=function(){var e=this;if(this._container){var t=fo(this._container,"position");"absolute"!==t&&"relative"!==t&&"fixed"!==t&&(this._container.style.position="relative");var n=this._container.firstChild;D.forEach(function(i){var r=e._layers[i];r&&r.element&&e._container.insertBefore(r.element,n)})}},x.prototype._updateContainerContent=function(){this._emptyContainer(),this._fillContainer()},x.prototype._resize=function(e){if(this._container||e){var t,n,i=this._width,r=this._height;if(this._container){var o=this._settings.get("minimumWidth"),a=this._settings.get("minimumHeight"),l=this._container.clientHeight||1;t=Math.max(o,e?e.width:this._container.clientWidth||1),n=Math.max(a,e?e.height:l)}else t=e.width,n=e.height;t===i&&n===r||(this._width=t,this._height=n,vt(this._layers,function(u){u.automaticResize&&Po(u.element,t,n)}),this._events.fire(I.RESIZE,{prevWidth:i,prevHeight:r,width:t,height:n,difWidth:t-i,difHeight:n-r}))}},x.prototype._refresh=function(){var e=this;this._inFrame?this._mustRefresh=!0:this._nextFrame||this._isDestroyed||(this._nextFrame=No(function(){return e._playFrame()}))},x.prototype._playFrame=function(){var e=this,t=P(),n=t-this._currentTime,i=Fr([this._beforeNextFramePromises,function(){return e._events.fire(I.BEFORE_NEW_FRAME,{elapsed:n})},function(){return e._events.fire(I.NEW_FRAME,{elapsed:n})},function(){return e._events.fire(I.AFTER_NEW_FRAME,{elapsed:n})},this._afterNextFramePromises,function(){e._inFrame=!1,(e._mustRefresh||t<e._refreshUntil+17)&&(e._mustRefresh=!1,e._refresh())}]);this._inFrame=!0,this._nextFrame=null,this._mustRefresh=!1,this._currentTime=t,this._beforeNextFramePromises=[],this._afterNextFramePromises=[],i.reduce(function(r,o){return r.then(function(){if(!e._isDestroyed)return o()})},Promise.resolve())},x.prototype.isPlayingFrame=function(){return this._inFrame||!!this._nextFrame},x.prototype.setFullScreen=function(e){var t;this._container&&(e&&!this._isFullScreen?(t=this._container).requestFullScreen?t.requestFullScreen():t.webkitRequestFullScreen?t.webkitRequestFullScreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.msRequestFullscreen&&t.msRequestFullscreen():e||!this._isFullScreen||"undefined"!=typeof document&&(document.cancelFullScreen?document.cancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen())),this._isFullScreen=e},x.prototype.isFullScreen=function(){return this._isFullScreen},x.prototype.debounceBeforeFrame=function(e){function t(){var o=r;i=!1,r=[],e(),o.forEach(function(a){return a()})}var n=this,i=!1,r=[];return function(){return new Promise(function(o){r.push(o),i||(i=!0,n.beforeNextFrame().then(t))})}},x.prototype.destroy=function(){(function(){if(Ae--,rr&&0===Ae){var e=document.documentElement;e.removeEventListener(G,ge,!0),e.removeEventListener(Q,ne,!0),e.removeEventListener($,ue,!0),e.removeEventListener(se,ue,!0)}})(),this.detachFromDom(),this.clearAllTimeouts(),this.stopFrames()},x);function x(e,t){var n=e.events,i=e.settings,r=void 0===t?{}:t,o=r.width,a=void 0===o?300:o,s=r.height,l=void 0===s?300:s,u=fe.call(this)||this;return u._layers={},u._focus=!1,u._container=null,u._isFullScreen=!1,u._beforeNextFramePromises=[],u._afterNextFramePromises=[],u._refreshUntil=0,u._currentTime=P(),u._timeouts=[],u._isDestroyed=!1,u._onDetachDom=[],u._isRealBrowser=Rr,u._isDocumentReady=po,u._inFrame=!1,u._mustRefresh=!1,u._nextFrame=null,u._onWindowResize=function(){return u._resize()},u._onWindowFocus=function(){return u.refresh()},u._events=n,u._settings=i,u._width=a,u._height=l,u._settings.register("minimumWidth",300,function(){return u._resize()},!1),u._settings.register("minimumHeight",300,function(){return u._resize()},!1),u._events.register([I.BEFORE_NEW_FRAME,I.NEW_FRAME,I.AFTER_NEW_FRAME,I.SET_CONTAINER,I.RESIZE]),u._onDetachDom=[],function(){if(rr&&0===Ae&&ye){var d=document.documentElement;d.addEventListener(G,ge,!0),d.addEventListener(Q,ne,!0),d.addEventListener($,ue,!0),d.addEventListener(se,ue,!0)}Ae++}(),u.addWindowEventListener("resize",u._onWindowResize),u.addWindowEventListener("focus",u._onWindowFocus),u}var k,R=(wt(de,k=Fe),de.prototype.setProperty=function(e,t,n,i){var r=(void 0===i?{}:i).dispatch;this._setDataProperty(e.isNode,e._indexes,t,n,void 0!==r&&r),this._events.fire(I.SET_DATA,{elements:e})},de.prototype.getProperty=function(e,t){return this._getDataProperty(e.isNode,e._indexes,t)},de.prototype._setDataProperty=function(e,t,n,i,r){r&&"function"==typeof i&&(r=!1),n=Ye(n);for(var o="function"==typeof i,a=e?this._nodeList:this._edgeList,s=e?this._nodeDataList:this._edgeDataList,l=function(S,w){for(var M=0;M<S.length;++M){var O=S[M],F=O.property;if(null===w&&null===F)return O;if(w&&F&&F.length===w.length){for(var L=!0,N=0;N<F.length;++N)if(F[N]!==w[N]){L=!1;break}if(L)return O}}var B={property:w&&w.slice(),indexes:[],previousValues:[],newValues:[],nodes:null,edges:null};return S.push(B),B}(e?this._nodeChanges:this._edgeChanges,n),u=0;u<t.length;++u){var d=t[u],c=s.get(d),h=a.get(d),p=r?i[u]:i,g=void 0,m=void 0;if(null===n)g=c,m=o?p(h):p,s.set(d,m);else{null==c&&s.set(d,c={});for(var b=n.length,v=0;v<b;v++){var y=n[v],E=c[y];v<b-1?(null==E&&(c[y]=E={}),c=E):(g=E,m=o?p(h):p,c[y]=m)}}l.indexes.push(d),l.previousValues.push(g),l.newValues.push(m)}this._scheduleEvents()},de.prototype._getDataProperty=function(e,t,n,i){n=Ye(n),i=i||new Array(t.length);for(var r=e?this._nodeDataList:this._edgeDataList,o=0;o<t.length;++o){var s=r.get(t[o]),l=void 0;if(null!==n&&n.length)if(null==s)l=void 0;else for(var u=n.length,d=0;d<u&&s;++d)l=s=s[n[d]];else l=s;i[o]=l}return i},de.prototype._scheduleEvents=function(){this._shouldTriggerEvents=!0,this._dom.refresh()},de.prototype._triggerEvents=function(){var e=this._prepareEvtPayload(!0),t=this._prepareEvtPayload(!1);this._events.fire(I.UPDATE_NODE_DATA,e),this._events.fire(I.UPDATE_EDGE_DATA,t)},de.prototype._prepareEvtPayload=function(e){var t=e?this._graph.nodeList:this._graph.edgeList,n=e?"_nodeChanges":"_edgeChanges",i=[],r=this[n];this[n]=[];for(var o=[],a=0;a<r.length;++a){var s=r[a],l=s.indexes,u=s.property,d=s.newValues,c=s.previousValues;i=i.concat(l),o.push(e?{property:u,newValues:d,previousValues:c,nodes:t(l)}:{property:u,newValues:d,previousValues:c,edges:t(l)})}return e?{nodes:t(i).dedupe(),isNode:e,changes:o}:{edges:t(i).dedupe(),isNode:e,changes:o}},de);function de(e){var t,n=k.call(this)||this;return n._nodeChanges=[],n._edgeChanges=[],n._shouldTriggerEvents=!1,n._dom=e.dom,n._graph=e.graph,n._events=e.events,n._nodeDataList=n._graph.createAttribute(!0,{name:"data",storage:"any"}),n._edgeDataList=n._graph.createAttribute(!1,{name:"data",storage:"any"}),n._nodeList=n._graph.getNodeAttribute("object"),n._edgeList=n._graph.getEdgeAttribute("object"),n._events.register([I.SET_DATA,I.UPDATE_NODE_DATA,I.UPDATE_EDGE_DATA]),n._events.on(((t={})[I.ADD_NODES+" "+I.ADD_EDGES]=function(i){for(var a=i.objects,s=i.nodes||i.edges,u=s.size,d=s._indexes,c=n[s.isNode?"_nodeDataList":"_edgeDataList"],h=0;h<u;++h)c.set(d[h],a[h].data)},t[I.BEFORE_NEW_FRAME]=function(){n._shouldTriggerEvents&&(n._shouldTriggerEvents=!1,n._triggerEvents())},t)),n}function Ye(e){return"string"==typeof e?e.split("."):li(e)?e:null==e?null:void 0}var Qt={1:gt(1),2:gt(2),4:gt(4),8:kt(),16:kt(),32:kt(),int8:kt(),int16:kt(),int32:kt(),float:kt(),any:kt()},Ii={1:Gt(1),2:Gt(2),4:Gt(4),8:yt(),16:yt(),32:yt(),int8:yt(),int16:yt(),int32:yt(),float:yt(),any:yt()};function kt(){return new Function("array","index","return array[index];")}function yt(){return new Function("array","index","value","array[index] = value;")}function gt(e){var t=8/e;return new Function("array","index","return (array[index / "+t+" | 0] >> ((index % "+t+") * "+e+")) & "+((1<<e)-1)+";")}function Gt(e){return new Function("array","index","value","\n    var offset = (index % "+8/e+") * "+e+";\n    var finalIndex = index / "+8/e+" | 0;\n    var orMask = value << offset;\n    var andMask = 255 - (("+(Math.pow(2,e)-1)+" - value) << offset);\n\n    array[finalIndex] = (array[finalIndex] & andMask) | orMask;")}var mt={get:function(e){return this._getArrayElt(this._buffer,e)},set:function(e,t){this._setArrayElt(this._buffer,e,t)}},Jt={get:function(e){return this._byIndex[this._getArrayElt(this._buffer,e)]},set:function(e,t){var n=this._byName[t];void 0===n&&(n=this._nextIndex++,this._byIndex.push(t),this._getElementBitSize()>this._elementSize&&this.increaseElementSize(),this._byName[t]=n),this._setArrayElt(this._buffer,e,n)}},Pn=(Ut.prototype.getValues=function(){return Object.keys(this._byName)},Ut.prototype.getName=function(){return this._name},Ut.prototype.get=function(e){return this._get(e)},Ut.prototype.set=function(e,t){this._set(e,t)},Ut.prototype._get=function(e){return this._defaultValue},Ut.prototype._set=function(e,t){t!==this._defaultValue&&(this._initialize(),this._set(e,t))},Ut.prototype.setFallback=function(e){this._fallback=e,this.get=this._getWithFallback},Ut.prototype._getWithFallback=function(e){var t=this._get(e);return void 0===t?this._fallback.get(e):t},Ut.prototype._initialize=function(){this._initialized=!0,this._buffer=Ui(this._nbElements,this._elementSize),this._get=this._methods.get,this._set=this._methods.set,"resource"!==this._storage&&this._defaultValue!==this._BASE_VALUE&&this._reset(0)},Ut.prototype.increaseNbElements=function(e){var t=Ji(e+1);if(!(t<=this._nbElements)){if(this._initialized)if("any"===this._elementSize)for(var n=this._nbElements;n<t;++n)this._buffer.push(this._defaultValue);else{var i=Ui(t,this._elementSize);i.set(this._buffer),this._buffer=i,"resource"!==this._storage&&this._defaultValue!==this._BASE_VALUE&&this._reset(this._nbElements)}this._nbElements=t}},Ut.prototype.increaseElementSize=function(){var e=this._elementSize;if("number"!=typeof e||32===e)throw new Error("FlexArray: cannot increase element size");var t=2*e,n=Qt[t],i=Ii[t];if(this._initialized){var r=this._nbElements,o=this._getArrayElt,a=this._buffer,s=Ui(r,t);if(8<=e)s.set(a);else for(var l=0;l<r;++l)i(s,l,o(a,l));this._buffer=s}this._elementSize=t,this._getArrayElt=n,this._setArrayElt=i},Ut.prototype.buffer=function(){if(!this._buffer)throw new Error("FlexArray: buffer not instantiated");return this._buffer},Ut.prototype.elementBitSize=function(){return this._elementSize},Ut.prototype.capacity=function(){return this._nbElements},Ut.prototype.byteSize=function(){return this._nbElements*this._elementSize/8},Ut.prototype.isInitialized=function(){return this._initialized||this._fallback&&this._fallback.isInitialized()},Ut.prototype.getMultiple=function(e,t){var n=e.length;void 0===t&&(t=new Array(n));for(var i=0,r=n;i<r;++i)t[i]=this.get(e[i]);return t},Ut.prototype.fill=function(e,t){for(var n=0,i=e.length;n<i;++n)this.set(e[n],t)},Ut.prototype.setMultiple=function(e,t,n){if(n||!Array.isArray(t)&&!ArrayBuffer.isView(t))for(i=0,r=e.length;i<r;++i)this.set(e[i],t);else for(var i=0,r=e.length;i<r;++i)this.set(e[i],t[i])},Ut.prototype.reset=function(){return this._initialized&&this._reset(0),this},Ut.prototype._reset=function(e){var t="resource"===this._storage?0:this._defaultValue;if("number"!=typeof this._elementSize||8<=this._elementSize)this._buffer.fill(t,e);else{for(var n=8/this._elementSize,i=0,r=0;r<n;++r)i<<=this._elementSize,i+=t;if(void 0===e)this._buffer.fill(i);else{var o=e+(8-e%8);for(r=e;r<o;++r)this._setArrayElt(this._buffer,r,t);this._buffer.fill(i,o/8)}}},Ut.prototype._getElementBitSize=function(){return Math.pow(2,Math.ceil(Math.log2(Math.log2(this._nextIndex))))},Ut);function Ut(e){this._initialized=!1;var t,n,i=e.name,r=e.storage,a=(n=r,void 0===(t=e.default)&&"any"!==n&&"resource"!==n?0:t),s=Math.max(8,Ji((e.size||0)+1)),l="resource"===r?1:r;this._name=i,this._storage=r,this._getArrayElt=Qt[l],this._setArrayElt=Ii[l],this._elementSize=l,this._nbElements=s,this._fallback=null,this._byName=void 0,this._byIndex=void 0,this._nextIndex=void 0,this._defaultValue=a,this._BASE_VALUE="any"===r?void 0:0,this._methods=mt,this._initialized=!1,this._buffer=null,"resource"===r&&(this._methods=Jt,this._byName={},this._byIndex=[],this._nextIndex=1,this._byName[a]=0,this._byIndex.push(a))}function Ji(e){for(var t=2;t<e;)t*=2;return t}function Ui(e,t){return"any"===t?new Array(e):"float"===t?new Float32Array(e):"int8"===t?new Int8Array(e):"int16"===t?new Int16Array(e):"int32"===t?new Int32Array(e):32===t?new Uint32Array(e):16===t?new Uint16Array(e):new Uint8Array(Math.ceil(e/8*t))}function Li(e){return Math.pow(2,Math.ceil(Math.log2(e)))}function An(e){for(var t=0,n=0;n<e.length;++n)t+=e[n];return t}function ve(e,t,n){return Math.max(t,Math.min(n,e))}function Dt(e,t,n){return e+(t-e)*n}function Lt(e,t,n){return e*(1-n)+t*n}function on(e){if(!e.length)return-1/0;for(var t=e[0],n=1,i=e.length;n<i;++n){var r=e[n];t<r&&(t=r)}return t}function mn(e){if(!e.length)return 1/0;for(var t=e[0],n=1,i=e.length;n<i;++n){var r=e[n];r<t&&(t=r)}return t}function Ar(e,t){return Math.log(e)/Math.log(t)}var ms=(ki.prototype.isBusy=function(){return this._busy},ki.prototype.markBusy=function(){return this._busy=!0,this},ki.prototype.sliceAndReset=function(){this._busy=!1;var e=this.slice(0,this._size);return this.reset(),e},ki.prototype.reset=function(){return this._size=0,this},ki.prototype.reserve=function(e){return e>this._capacity&&this._setCapacity(Li(e)),this},ki.prototype._setCapacity=function(e){var t=new Uint32Array(e);t.set(this._buffer),this._buffer=t,this._capacity=e},ki.prototype.push=function(e){return this._size===this._capacity&&this._setCapacity(2*this._capacity),this._buffer[this._size++]=e,this},ki.prototype.pushUnchecked=function(e){return this._buffer[this._size++]=e,this},ki.prototype.slice=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this._size),this._buffer.slice(e,t)},ki.prototype.getBuffer=function(){return this._buffer},ki.prototype.getLength=function(){return this._size},ki.prototype.getCapacity=function(){return this._capacity},ki.prototype.setLength=function(e){return this._size=e,this},ki.prototype.isEmpty=function(){return 0===this._size},ki);function ki(){this._buffer=new Uint32Array(4),this._capacity=4,this._size=0,this._busy=!1}var go=(vi.prototype.addElements=function(e){for(var t=[],n=0,i=e.length;n<i;++n){var r=e[n],o=this._idToIndex[r];void 0===o&&(o=this._getNextIndex(),this._idToIndex[r]=o,this._indexToId[o]=r),t.push(o)}for(var a=0,s=this._flexArrays;a<s.length;a++)s[a].increaseNbElements(this._nextIndex);for(var l=0,u=this._indexLists;l<u.length;l++)u[l].reserve(this._nextIndex);return new Uint32Array(t)},vi.prototype.removeElements=function(e){for(var t=0,n=e.length;t<n;++t){var i=e[t],r=this._indexToId[i];void 0!==r&&(delete this._idToIndex[r],this._removeIndex(i))}},vi.prototype.clear=function(){this._idToIndex=Object.create(null),this._indexToId=[void 0],this._nextIndex=1,this._freeIndexes=[];for(var e=0,t=this._flexArrays;e<t.length;e++)t[e].reset();for(var n=0,i=this._indexLists;n<i.length;n++)i[n].reset()},vi.prototype.has=function(e){return void 0!==this._indexToId[e]},vi.prototype.getIndex=function(e,t){void 0===t&&(t=!1);var n=this._idToIndex[e];if(void 0===n&&t)throw new Error(this._name+' id "'+e+'" not found');return n},vi.prototype.createFlexArray=function(e){var t=e.name;if(t&&this._flexArraysByName[t])throw new Error(this._name+' flexArray "'+t+'" already exists');var i,n=e.default;return void 0===n&&"any"!==e.storage&&"resource"!==e.storage&&(n=0),i=new Pn({storage:e.storage,size:this._nextIndex,name:t,default:n}),this._flexArrays.push(i),this._defaultValues.push(e.default),t&&(this._flexArraysByName[t]=i),i},vi.prototype.getFlexArray=function(e){return this._flexArraysByName[e]||null},vi.prototype.getAllFlexArrays=function(){return this._flexArraysByName},vi.prototype.createIndexList=function(){var e=new ms;return e.reserve(this._nextIndex),this._indexLists.push(e),e},vi.prototype.getId=function(e){return this._indexToId[e]},vi.prototype.getMaxIndex=function(){return this._nextIndex-1},vi.prototype._removeIndex=function(e){this._indexesToBeFreed.push(e)},vi.prototype._getNextIndex=function(){var e=this._freeIndexes.pop();return void 0===e&&(e=this._nextIndex++),e},vi.prototype.freeIndexes=function(){for(var e=0,t=this._indexesToBeFreed;e<t.length;e++){var n=t[e];this._indexToId[n]=void 0,this._freeIndexes.push(n)}for(var i=0;i<this._flexArrays.length;++i)for(var r=this._flexArrays[i],o=this._defaultValues[i],a=0,s=this._indexesToBeFreed;a<s.length;a++)r.set(n=s[a],o);this._indexesToBeFreed=[]},vi);function vi(e){var t=this;this._nextIndex=1,this._freeIndexes=[],this._indexesToBeFreed=[],this._idToIndex=Object.create(null),this._indexToId=[void 0],this._flexArrays=[],this._defaultValues=[],this._flexArraysByName={},this._indexLists=[],this._name=e?"node":"edge",this._nextIndex=1,this._freeIndexes=[],this._indexesToBeFreed=[],this._idToIndex=Object.create(null),this._indexToId=[void 0],this._idFlexArray=new Pn({storage:"int32"}),this._idFlexArray.get=function(n){return t._indexToId[n]},this._idFlexArray.getMultiple=function(n){for(var i=new Array(n.length),r=0;r<n.length;++r)i[r]=t._indexToId[n[r]];return i},this._flexArraysByName.id=this._idFlexArray}var or,pd,fd=(_o.prototype.addEntry=function(e){return void 0===e&&(e=this._nextIndex++),e>=this._capacity&&this._reserve(e+1),this._sizes[e]=0,e},_o.prototype.get=function(e){var t=this._sizes[e],n=this._MAX_LIST_SIZE*e;if(t<=this._MAX_LIST_SIZE){for(var i=0,r=this._constList.length=t;i<r;++i)this._constList[i]=this._buffer[n+i];return this._constList}if(t===this._BIG_LIST)return this._bigLists[this._buffer[n]]},_o.prototype.size=function(e){var t=this._sizes[e];return t<=this._MAX_LIST_SIZE?t:this._bigLists[this._buffer[e*this._MAX_LIST_SIZE]].length},_o.prototype.sizes=function(e){for(var t=this._sizes,n=this._bigLists,i=this._buffer,r=this._MAX_LIST_SIZE,o=e.length,a=new Array(o),s=0;s<o;s++){var l=e[s],u=t[l];a[s]=u<=r?u:n[i[l*r]].length}return a},_o.prototype.addTo=function(e,t){var n=this._sizes[e],i=e*this._MAX_LIST_SIZE;if(n<this._MAX_LIST_SIZE)this._buffer[i+n]=t,this._sizes[e]=n+1;else if(n===this._BIG_LIST)this._bigLists[this._buffer[i]].push(t);else{for(var o=new Array(this._MAX_LIST_SIZE),a=0;a<this._MAX_LIST_SIZE;++a)o[a]=this._buffer[i+a];o.push(t),this._bigLists.push(o),this._sizes[e]=this._BIG_LIST,this._buffer[i]=this._bigLists.length-1}return this},_o.prototype.removeFrom=function(e,t){return this.removeFromAndGetSize(e,t),this},_o.prototype.removeFromAndGetSize=function(e,t){var n=this._MAX_LIST_SIZE*e,i=this._sizes[e];if(i<=this._MAX_LIST_SIZE){for(var r=n,o=n+i;r<o;++r)if(this._buffer[r]===t)return--i,this._buffer[r]=this._buffer[o-1],this._sizes[e]=i}else if(i===this._BIG_LIST){var s=this._bigLists[this._buffer[n]];if(-1!==(r=s.indexOf(t)))return s.splice(r,1),s.length}throw new Error('topology: Table: "removeFrom" failed, should not happen')},_o.prototype.reserve=function(e){return this._capacity<e&&this._reserve(e),this},_o.prototype._reserve=function(e){this._capacity=Math.pow(2,Math.ceil(Math.log2(e))),this._buffer=Ih(this._buffer,this._capacity*this._MAX_LIST_SIZE),this._sizes=Ih(this._sizes,this._capacity)},_o);function _o(){this._BIG_LIST=255,this._MAX_LIST_SIZE=8,this._capacity=8,this._buffer=new Uint32Array(this._capacity*this._MAX_LIST_SIZE),this._sizes=new Uint8Array(this._capacity),this._bigLists=[],this._nextIndex=0,this._constList=new Array(this._MAX_LIST_SIZE)}function Ih(e,t){var n=new e.constructor(t);return n.set(e),n}(pd=or=or||{}).BOTH="both",pd.IN="in",pd.OUT="out";var Oy=(ii.prototype.getAdjacentDirections=function(e){return this._neighborTable.get(e)},ii.prototype.getEdgeIndexesInDirection=function(e){return this._parallelTable.get(e)},ii.prototype.allocateNodes=function(e){this._neighborTable.reserve(e.length);for(var t=0;t<e.length;++t)this._neighborTable.addEntry(e[t])},ii.prototype.allocateEdges=function(e,t,n){this._parallelTable.reserve(Math.floor(e.length/2));for(var i=0;i<e.length;i++){var r=e[i],a=n[i];this._sourceList.set(r,t[i]),this._targetList.set(r,a),this.addToAdjacencyList(r)}},ii.prototype.getExtremity=function(e,t){var n=e?this._sourceList:this._targetList;if(t.isList){for(var i=this._graph.acquireIndexList(!0),r=0;r<t._indexes.length;r++)i.push(n.get(t._indexes[r]));return this._graph.nodeList(i.sliceAndReset())}return this._graph.getObjectList(!0).get(n.get(t._index))},ii.prototype.setExtremities=function(e,t,n){for(var i=0;i<e.length;++i)this.removeFromAdjacencyList(e[i]);for(null!==t&&this._sourceList.setMultiple(e,t),null!==n&&this._targetList.setMultiple(e,n),i=0;i<e.length;++i)this.addToAdjacencyList(e[i])},ii.prototype.addToAdjacencyList=function(e){var t=this._sourceList.get(e),n=this._targetList.get(e),i=tu(t,n),r=this._parallelEdgesIndex[i];void 0===r&&(r=this._parallelTable.addEntry(),this._parallelEdgesIndex[i]=r,this._neighborTable.addTo(t,r),t!==n&&this._neighborTable.addTo(n,r)),this._parallelTable.addTo(r,e)},ii.prototype.removeFromAdjacencyList=function(e){var t=this._sourceList.get(e),n=this._targetList.get(e),i=tu(t,n),r=this._parallelEdgesIndex[i];0===this._parallelTable.removeFromAndGetSize(r,e)&&(this._neighborTable.removeFrom(t,r),t!==n&&this._neighborTable.removeFrom(n,r),this._parallelEdgesIndex[i]=void 0)},ii.prototype.getParallelEdges=function(e,t){void 0===t&&(t={});for(var n=t.filter||"visible",i=this._graph.acquireIndexList(!1),r=this._graph.getFilter(!1,n),o=0;o<e._indexes.length;o++){var a=e._indexes[o],s=tu(this._sourceList.get(a),this._targetList.get(a)),u=this._parallelTable.get(+this._parallelEdgesIndex[s]);if(u)for(var d=0,c=u;d<c.length;d++){var h=c[d];r(h)&&i.push(h)}}return this._graph.edgeList(i.sliceAndReset())},ii.prototype.fastGetNodesAdjacentElements=function(e){for(var t=this._graph.acquireIndexList(!0),n=this._graph.acquireIndexList(!1),i=this._sourceList,r=this._targetList,o=0;o<e.length;o++)for(var a=e[o],s=0,l=this._neighborTable.get(a);s<l.length;s++){var d=this._parallelTable.get(l[s]),c=d[0],h=i.get(c),p=r.get(c);t.push(h+p-a);for(var g=0,m=d;g<m.length;g++)n.push(m[g])}return{nodes:this._graph.nodeList(t.sliceAndReset()),edges:this._graph.edgeList(n.sliceAndReset())}},ii.prototype.fastGetEdgesAdjacentElements=function(e){for(var t=this._graph.acquireIndexList(!0),n=this._graph.acquireIndexList(!1),i=this._sourceList,r=this._targetList,o=0;o<e.length;o++){var a=e[o],s=i.get(a),l=r.get(a),u=tu(s,l),c=this._parallelTable.get(+this._parallelEdgesIndex[u]);if(c)for(var h=0,p=c;h<p.length;h++)n.push(p[h]);t.push(s),t.push(l)}return{nodes:this._graph.nodeList(t.sliceAndReset()),edges:this._graph.edgeList(n.sliceAndReset())}},ii.prototype.getDeduper=function(e){return(e?this.nodeDeduper:this.edgeDeduper).reset()},ii.prototype.collectAdjacentEdges=function(e,t,n,i,r){void 0===i&&(i=!1),void 0===r&&(r=!1);var a=t===or.IN,s=!(t===or.OUT||a||r),l=this._graph.acquireIndexList(!1),u=this._graph.getFilter(!1,n),d=i?this.getDeduper(!1):this._fakeDeduper,c=this._fakeInvertedDeduper,h=this._sourceList,p=this._targetList;if(r){c=this.getDeduper(!0);for(var g=0;g<e.length;g++)c.set(e[g],1)}for(g=0;g<e.length;g++)for(var m=e[g],b=0,v=this._neighborTable.get(m);b<v.length;b++){var E=this._parallelTable.get(v[b]);if(s)for(var S=0,w=E;S<w.length;S++)u(F=w[S])&&0===d.get(F)&&(l.push(F),d.set(F,1));else for(var M=0,O=E;M<O.length;M++){var F=O[M],L=h.get(F),N=p.get(F),B=L+N-m;a!=(N===m)&&L!==N||!u(F)||0!==d.get(F)||1!==c.get(B)||(l.push(F),d.set(F,1))}}return l.sliceAndReset()},ii.prototype.collectAdjacentNodes=function(e,t,n,i,r,o){void 0===i&&(i=!1);var a=t!==or.IN,s=t!==or.OUT,l=this._graph.acquireIndexList(!0),u=this._graph.getFilter(!1,n),d=i?this.getDeduper(!0):this._fakeDeduper,c=this._sourceList,h=this._targetList;if(r)for(var p=0;p<r.length;p++){var g=r[p];l.push(g),d.set(g,1)}if(o)for(p=0;p<o.length;p++)d.set(g=o[p],1);for(p=0;p<e.length;p++)for(var m=e[p],b=0,v=this._neighborTable.get(m);b<v.length;b++)for(var E=0,S=this._parallelTable.get(v[b]);E<S.length;E++){var w=S[E];if(u(w)){var M=c.get(w),O=h.get(w);if(g=M+O-m,(s&&m===O||a&&m===M)&&0===d.get(g)){l.push(g),d.set(g,1);break}}}return l.sliceAndReset()},ii.prototype.getAdjacentElements=function(e,t,n){void 0===n&&(n={});var i=n.direction||or.BOTH,r=n.filter||"visible",o=n.policy||"union",a=!!n.bothExtremities,s=n.includeSources;return!0===s?o="include-sources":!1===s&&(o="exclude-sources"),e?this.collectAdjacentNodes(t,i,r,!0,"include-sources"===o?t:null,"exclude-sources"===o?t:null):this.collectAdjacentEdges(t,i,r,!0,a)},ii.prototype.getEdgesBetweenTwoNodes=function(e,t){var n=tu(e,t),r=this._parallelTable.get(+this._parallelEdgesIndex[n]);return new Uint32Array(r||0)},ii.prototype.getConnectedComponents=function(e,t){for(var n=void 0===t?{}:t,i=n.filter,r=void 0===i?"visible":i,o=n.returnIds,a=void 0!==o&&o,s=n.internalIndexes,l=void 0!==s&&s,u=this._graph,d=[],c={},h=u.acquireIndexList(!0),p=u.getFilter(!0,r),g=0;g<e.length;g++)p(v=e[g])&&h.push(v);var m=h.sliceAndReset(),b={filter:r};for(g=0;g<m.length;g++){var v;if(!c[v=m[g]]){for(var y=[v],E=[];0!==y.length;){var S=y.pop();c[S]||(y.push.apply(y,this.getAdjacentElements(!0,new Uint32Array([S]),b)),c[S]=!0,E.push(S))}0<E.length&&d.push(E)}}if(a){var w=u.getNodeAttribute("id");for(g=0;g<d.length;g++)d[g]=w.getMultiple(d[g])}else if(!l)for(g=0;g<d.length;g++)d[g]=u.nodeList(new Uint32Array(d[g]));return d},ii.prototype.getAdjacencyList=function(e){for(var t=e.directed,n=e.ids,i=e.weight,r=e.nodes,o=t?or.OUT:or.BOTH,a=new Array(r.length),s=this._graph,l=0;l<r.length;++l)a[l]=this.collectAdjacentEdges(new Uint32Array([r[l]]),o,"all");var u=s.getEdgeAttribute("source"),d=s.getEdgeAttribute("target"),c=s.getEdgeAttribute("width"),h=s.getNodeAttribute("id"),p=[],g="number"==typeof i,m=!("function"==typeof i||g||!i);for(l=0;l<a.length;l++){for(var b=a[l],v=r[l],y=b.length,E=n?new Array(y):new Uint32Array(y),S=new Array(y),w=0;w<y;w++){var M=b[w],O=u.get(M),F=d.get(M),L=t||v===O?F:O;n&&(L=h.get(L)),E[w]=L,i&&(g&&(S[w]=i),"function"==typeof i&&(S[w]=i(s.getNode(O),s.getNode(F))),m&&(S[w]=c.get(M)||1))}var N=Nt({nodes:E,id:n?h.get(v):v},i&&{weights:S});p.push(N)}return p},ii.prototype.degrees=function(e,t){if(t!==or.IN&&t!==or.OUT)return this._neighborTable.sizes(e);for(var n=new Array(e.length),i=t===or.IN,r=0,o=e.length;r<o;r++)n[r]=this._degree(e[r],i);return n},ii.prototype._degree=function(e,t){for(var n=this._neighborTable.get(e),i=this._sourceList,r=this._targetList,o=0,a=0;a<n.length;++a)for(var s=this._parallelTable.get(n[a]),l=0;l<s.length;++l){var u=s[l],d=i.get(u),c=r.get(u);if(t&&c===e||!t&&d===e){o+=1;break}}return o},ii.prototype.getDegree=function(e,t){for(var n=this._getDegreeOptions(t),i=n.direction,r=n.filter,o=new Array(e.length),a=new Uint32Array(1),s=0;s<e.length;++s)a[0]=e[s],o[s]=this.collectAdjacentNodes(a,i,r).length;return o},ii.prototype._getDegreeOptions=function(e){var t={direction:or.BOTH,filter:"visible"};return"string"==typeof e?t.direction=e:e&&("string"==typeof e.direction&&(t.direction=e.direction),"string"==typeof e.filter&&(t.filter=e.filter)),t},ii);function ii(e){this._parallelEdgesIndex=[],this._fakeDeduper={get:function(){return 0},set:function(){},reset:function(){return this}},this._fakeInvertedDeduper={get:function(){return 1},set:function(){},reset:function(){return this}},this._sourceList=null,this._targetList=null,this._graph=e,this._neighborTable=new fd,this._parallelTable=new fd,this._parallelEdgesIndex=[],this.nodeDeduper=e.createNodeAttribute({storage:1}),this.edgeDeduper=e.createEdgeAttribute({storage:1}),this._sourceList=e.getEdgeAttribute("source"),this._targetList=e.getEdgeAttribute("target")}function tu(e,t){var n=e<t?e:t;return 67108864*n+(e+t-n)}function eo(e){Si||console.warn(le()+" "+e)}function kh(e){"object"==typeof e&&null!==e||(e={});var t="function"==typeof e.data?e.data:function(n){return n};return{attributes:Array.isArray(e.attributes)?e.attributes:void 0,data:t}}function ju(e){1<e&&eo("getData: more than one argument were specified, you probably want to use a single array argument instead of multiple arguments")}function Zu(e,t){for(var n=function(o){var a=t;Object.keys(a).forEach(function(s){var l=a[s];o.prototype[s]=function(u,d){return eo('Deprecated method "'+s+'"; please use "'+l+'" instead.'),this[l](u,d)}})},i=0,r=e;i<r.length;i++)n(r[i])}function Oh(e){var t=e.getFlexArray("removed"),n=e.getFlexArray("excluded"),i=e.getFlexArray("virtual");return{all:function(r){return 0===t.get(r)},visible:function(r){return 0===n.get(r)},raw:function(r){return 0===i.get(r)&&0===t.get(r)},_all:function(r){return!0}}}function Nh(e,t,n){return{all:Gu(n.all,e,t),visible:Gu(n.visible,e,t),raw:Gu(n.raw,e,t),_all:Gu(n._all,e,t)}}function Gu(e,t,n){var i=null;return{getList:function(){if(!i){var r=t(),o=n();o.reset();for(var a=1;a<=r;++a)e(a)&&o.push(a);i=o.sliceAndReset()}return i},invalidList:function(){i=null}}}function Ny(e){if(void 0===e)return Math.round(Math.random()*Number.MAX_SAFE_INTEGER);if("string"!=typeof e&&("number"!=typeof e||!isFinite(e)))throw new Error(e+" is not a valid id, expected string or number");return e}function Lh(e,t,n){for(var i=e.getObjectList(t.isNode),r=0;r<t._indexes.length;++r)n(i.get(t._indexes[r]),r)}function Fh(e,t,n){for(var i=new Array(t.size),r=e.getObjectList(t.isNode),o=0;o<t._indexes.length;++o){var s=r.get(t._indexes[o]);i[o]=n(s,o)}return i}function Ph(e,t,n){n=n||function(){return!0};for(var i=t.isNode,r=e.acquireIndexList(i),o=e.getObjectList(i),a=e.getListFactory(i),s=0;s<t._indexes.length;++s){var l=t._indexes[s],u=o.get(l);u&&n(u,s)&&r.push(l)}return a(r.sliceAndReset())}function Dh(e,t,n,i){var r=e.getListFactory(t.isNode);if(!n)return{valid:t,invalid:r()};for(var o=e.acquireIndexList(t.isNode),a=e.acquireIndexList(t.isNode),s=e.getObjectList(t.isNode),l=0;l<t._indexes.length;l++){var u=t._indexes[l],d=s.get(u);void 0!==d&&(n(d,i)?o:a).pushUnchecked(u)}return{valid:r(o.sliceAndReset()),invalid:r(a.sliceAndReset())}}function Rh(e,t,n,i){for(var r=e.getObjectList(t.isNode),o=i,a=0;a<t._indexes.length;++a)o=n(o,r.get(t._indexes[a]),a);return o}function zh(e,t){for(var n=t.isNode,i=e.topology.getDeduper(n),r=e.acquireIndexList(n),o=e.getListFactory(n),a=0;a<t._indexes.length;a++){var s=t._indexes[a];0===i.get(s)&&(i.set(s,1),r.push(s))}return o(r.sliceAndReset())}function Bh(e,t){for(var n=t.isNode,i=e.storage.fetch(n),r=i.getFlexArray("excluded"),o=i.getMaxIndex(),a=e.topology.getDeduper(n),s=e.acquireIndexList(n),l=e.getListFactory(n),u=0;u<t._indexes.length;u++)a.set(t._indexes[u],1);for(var d=1;d<=o;++d)0===a.get(d)&&0===r.get(d)&&s.push(d);return l(s.sliceAndReset())}function Vh(e,t,n){var i=e.getListFactory(t.isNode),r=new Uint32Array(t._indexes.length+n._indexes.length);return r.set(t._indexes),r.set(n._indexes,t._indexes.length),i(r)}function Uh(e,t){return e.getObjectList(t.isNode).getMultiple(t._indexes)}function qu(e,t){var n=e.getStorage(t.isNode);if(t.isList){for(var i=new Array(t.size),r=0;r<t._indexes.length;++r)i[r]=n.getId(t._indexes[r]);return i}return n.getId(t._index)}function jh(e,t){return e.topology.getExtremity(!0,t)}function Zh(e,t){return e.topology.getExtremity(!1,t)}function Gh(e,t,n){return e.getObjectList(t.isNode).get(t._indexes[n])}function qh(e,t,n){var i=e.getListFactory(t.isNode),r=e.getObjectList(t.isNode),o=t._indexes.slice();return o.sort(function(a,s){var l=r.get(a),u=r.get(s);return n(l,u)}),i(o)}var Hh=new Uint32Array(1),na=(Object.defineProperty(Yt.prototype,"_indexes",{get:function(){return Hh[0]=this._index,Hh},enumerable:!0,configurable:!0}),Yt.prototype.setAttributes=function(e,t,n){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,e,t,n)},Yt.prototype.setAttribute=function(e,t,n){return this._ogma.modules.individualAttributes.setSingleAttribute(this,e,t,n)},Yt.prototype.getAttributes=function(e){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,e)[0]},Yt.prototype.getAttribute=function(e){return this._ogma.modules.individualAttributes.getSingleAttribute(this,e)[0]},Yt.prototype.resetAttributes=function(e,t){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,e,t)},Yt.prototype.replaceOriginalAttributes=function(e,t){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,e,t)},Yt.prototype.getPreviousAttributes=function(e){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,e)[0]},Yt.prototype.isInView=function(e){return this._ogma.modules.locate.isElementInView(this,e)},Yt.prototype.getParallelEdges=function(e){return this._ogma.modules.graph.getParallelEdges(this,e)},Yt.prototype.fastGetAdjacentElements=function(){return this._ogma.modules.graph.fastGetEdgesAdjacentElements(this)},Yt.prototype.isVisible=function(){return!this.isExcluded()},Yt.prototype.isExcluded=function(){return this._ogma.modules.graph.isExcluded(this)[0]},Yt.prototype.setExcluded=function(e){return this._ogma.modules.graph.setExcluded(this,e)},Yt.prototype.setVisible=function(e){return this.setExcluded(!e)},Yt.prototype.toList=function(){return this._ogma.modules.graph.edgeList(new Uint32Array([this._index]))},Yt.prototype.getId=function(){return qu(this._ogma.modules.graph,this)},Yt.prototype.getSource=function(){return jh(this._ogma.modules.graph,this)},Yt.prototype.getTarget=function(){return Zh(this._ogma.modules.graph,this)},Yt.prototype.getExtremities=function(){return this._ogma.modules.graph.nodeList(new Uint32Array([this.getSource()._index,this.getTarget()._index]))},Yt.prototype.setSource=function(e){this._ogma.modules.graph.setSource(this,e)},Yt.prototype.setTarget=function(e){this._ogma.modules.graph.setTarget(this,e)},Yt.prototype.slice=function(){return this.toList()},Yt.prototype.toJSON=function(e){void 0===e&&(e={});var t=kh(e),n=t.attributes,i=t.data;return{id:this.getId(),source:this.getSource().getId(),target:this.getTarget().getId(),attributes:this.getAttributes(n),data:i(un(this.getData()))}},Yt.prototype.get=function(e){return 0===e?this:void 0},Yt.prototype.setSelected=function(e){this._ogma.modules.selection.setActive(this,e)},Yt.prototype.isSelected=function(){return this._ogma.modules.selection.areActive(this)},Yt.prototype.locate=function(e){return this._ogma.modules.locate.locateElements(this,e)},Yt.prototype.getBoundingBox=function(e){return this._ogma.modules.locate.getBoundingBox(this,e)},Yt.prototype.setData=function(e,t){return arguments.length<2&&(t=e,e=null),this._ogma.modules.data.setProperty(this,e,t),this},Yt.prototype.getData=function(e){return ju(arguments.length),this._ogma.modules.data.getProperty(this,e)[0]},Yt.prototype.addClass=function(e,t){return this._ogma.modules.classes.addClassesToElements([e],this,t)},Yt.prototype.addClasses=function(e,t){return this._ogma.modules.classes.addClassesToElements(e,this,t)},Yt.prototype.removeClass=function(e,t){return this._ogma.modules.classes.removeClassesFromElements([e],this,t)},Yt.prototype.removeClasses=function(e,t){return this._ogma.modules.classes.removeClassesFromElements(e,this,t)},Yt.prototype.hasClass=function(e){return this._ogma.modules.classes.hasSingleElementClass(e,this)},Yt.prototype.getClassList=function(){return this._ogma.modules.classes.getElementsClassList(this)[0]},Yt.prototype.getAnimationInformation=function(){return this._ogma.modules.graphics.getAnimationInformation(this)[0]},Yt.prototype.isVirtual=function(){return this._ogma.modules.transformations.isElementVirtual(this)},Yt.prototype.getTransformation=function(){return this._ogma.modules.transformations.getElementTransformation(this)},Yt.prototype.getMetaEdge=function(){return this._ogma.modules.grouping.getMetaElement(this)[0]},Yt.prototype.getSubEdges=function(){return this._ogma.modules.grouping.getSubElements(this)[0]},Yt.prototype.pulse=function(e){this._ogma.modules.pulses.pulse(this,e)},Yt);function Yt(e,t){this.size=1,this.isNode=!1,this.isList=!1,this._index=e,this._ogma=t}Zu([na],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute"});var vs=(Object.defineProperty(Vt.prototype,"size",{get:function(){return this._indexes.length},enumerable:!0,configurable:!0}),Vt.prototype.setAttributes=function(e,t){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,e,t)},Vt.prototype.setAttribute=function(e,t,n){return this._ogma.modules.individualAttributes.setSingleAttribute(this,e,t,n)},Vt.prototype.getAttributes=function(e){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,e)},Vt.prototype.getAttribute=function(e){return this._ogma.modules.individualAttributes.getSingleAttribute(this,e)},Vt.prototype.resetAttributes=function(e,t){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,e,t)},Vt.prototype.replaceOriginalAttributes=function(e,t){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,e,t)},Vt.prototype.getPreviousAttributes=function(e){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,e)},Vt.prototype.getPreviousAttribute=function(e){return this._ogma.modules.individualAttributes.getSinglePreviousAttribute(this,e)},Vt.prototype.getParallelEdges=function(e){return this._ogma.modules.graph.getParallelEdges(this,e)},Vt.prototype.fastGetAdjacentElements=function(){return this._ogma.modules.graph.fastGetEdgesAdjacentElements(this)},Vt.prototype.isVisible=function(){return this.isExcluded().map(function(e){return!e})},Vt.prototype.isExcluded=function(){return this._ogma.modules.graph.isExcluded(this)},Vt.prototype.setExcluded=function(e){return this._ogma.modules.graph.setExcluded(this,e)},Vt.prototype.setVisible=function(e){return this.setExcluded(!e)},Vt.prototype.toList=function(){return this},Vt.prototype.toArray=function(){return Uh(this._ogma.modules.graph,this)},Vt.prototype.clone=function(){return this._ogma.modules.graph.edgeList(this._indexes.slice())},Vt.prototype.getId=function(){return qu(this._ogma.modules.graph,this)},Vt.prototype.getSource=function(){return jh(this._ogma.modules.graph,this)},Vt.prototype.getTarget=function(){return Zh(this._ogma.modules.graph,this)},Vt.prototype.getExtremities=function(){return this.getSource().concat(this.getTarget())},Vt.prototype.get=function(e){return Gh(this._ogma.modules.graph,this,e)},Vt.prototype.forEach=function(e){Lh(this._ogma.modules.graph,this,e)},Vt.prototype.map=function(e){return Fh(this._ogma.modules.graph,this,e)},Vt.prototype.filter=function(e){return Ph(this._ogma.modules.graph,this,e)},Vt.prototype.reduce=function(e,t){return Rh(this._ogma.modules.graph,this,e,t)},Vt.prototype.concat=function(e){return Vh(this._ogma.modules.graph,this,e)},Vt.prototype.dedupe=function(){return zh(this._ogma.modules.graph,this)},Vt.prototype.slice=function(e,t){return this._ogma.modules.graph.edgeList(this._indexes.slice(e,t))},Vt.prototype.indexOf=function(e){return e instanceof na?this._indexes.indexOf(e._index):-1},Vt.prototype.includes=function(e){return-1!==this.indexOf(e)},Vt.prototype.sort=function(e){return qh(this._ogma.modules.graph,this,e)},Vt.prototype.inverse=function(){return Bh(this._ogma.modules.graph,this)},Vt.prototype.toJSON=function(e){return void 0===e&&(e={}),this.map(function(t){return t.toJSON(e)})},Vt.prototype.setSelected=function(e){this._ogma.modules.selection.setActive(this,e)},Vt.prototype.isSelected=function(){return this._ogma.modules.selection.areActive(this)},Vt.prototype.locate=function(e){return this._ogma.modules.locate.locateElements(this,e)},Vt.prototype.getBoundingBox=function(e){return this._ogma.modules.locate.getBoundingBox(this,e)},Vt.prototype.setData=function(e,t){if(arguments.length<2&&(t=e,e=null),"function"!=typeof t&&!li(t))throw new Error("invalid argument "+t+"; expected array or function");return this._ogma.modules.data.setProperty(this,e,t,{dispatch:!0}),this},Vt.prototype.fillData=function(e,t){return arguments.length<2&&(t=e,e=null),this._ogma.modules.data.setProperty(this,e,t,{dispatch:!1}),this},Vt.prototype.getData=function(e){return ju(arguments.length),this._ogma.modules.data.getProperty(this,e)},Vt.prototype.addClass=function(e,t){return this._ogma.modules.classes.addClassesToElements([e],this,t)},Vt.prototype.addClasses=function(e,t){return this._ogma.modules.classes.addClassesToElements(e,this,t)},Vt.prototype.removeClass=function(e,t){return this._ogma.modules.classes.removeClassesFromElements([e],this,t)},Vt.prototype.removeClasses=function(e,t){return this._ogma.modules.classes.removeClassesFromElements(e,this,t)},Vt.prototype.hasClass=function(e){var t=this;return this.map(function(n){return t._ogma.modules.classes.hasSingleElementClass(e,n)})},Vt.prototype.getClassList=function(){return this._ogma.modules.classes.getElementsClassList(this)},Vt.prototype.getAnimationInformation=function(){return this._ogma.modules.graphics.getAnimationInformation(this)},Vt.prototype.getMetaEdge=function(){return this._ogma.modules.grouping.getMetaElement(this)},Vt.prototype.getSubEdges=function(){return this._ogma.modules.grouping.getSubElements(this)},Vt.prototype.pulse=function(e){this._ogma.modules.pulses.pulse(this,e)},Vt);function Vt(e,t){this.isList=!0,this.isNode=!1,this._indexes=e,this._ogma=t}Zu([vs],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute"});var ia="geo.latitude",ra="geo.longitude",nu=85.0511287798,ys={latitudePath:"latitude",longitudePath:"longitude",maxZoomLevel:22,minZoomLevel:0,wrapCoordinates:!0,tileUrlTemplate:"https://maps.wikimedia.org/osm-intl/{z}/{x}/{y}{r}.png",tileUrlSubdomains:"abc",attribution:null,attributionOptions:void 0,backgroundColor:"silver",opacity:1,duration:0,detectRetina:!1,disableNodeDragging:!0,tileBuffer:1,sizeRatio:1,tiles:{url:"https://maps.wikimedia.org/osm-intl/{z}/{x}/{y}{r}.png",subdomains:"abc",tms:!1,wms:!1},crs:null},Ly={maxBoundsViscosity:1,worldCopyJump:!0,zoomControl:!1,attributionControl:!1};function Wh(){return Yi||"undefined"!=typeof global&&!global.process}function gd(e){return Math.log2(e)+1}function Yh(e){return null!=e&&!isNaN(e)}function Xh(e,t){return Qh(e,t,"longitude")}function Jh(e,t){return Qh(e,t,"latitude")}function Qh(e,t,n){if(isNaN(t))throw new TypeError("node "+e+": "+t+" is not a valid "+n)}var Fy=Bi().createElement("div");function Hu(e,t,n,i){var r,a,l,u,c;a=t,l=i,u=(r=e).getAttribute(!0,n),r.getAttribute(true,l).setMultiple(c=a._indexes,u.getMultiple(c))}var Kh=new Uint32Array(1),mo=(Object.defineProperty(qt.prototype,"_indexes",{get:function(){return Kh[0]=this._index,Kh},enumerable:!0,configurable:!0}),qt.prototype.setAttributes=function(e,t){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,e,t)},qt.prototype.setAttribute=function(e,t,n){return this._ogma.modules.individualAttributes.setSingleAttribute(this,e,t,n)},qt.prototype.resetAttributes=function(e,t){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,e,t)},qt.prototype.getAttributes=function(e){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,e)[0]},qt.prototype.getAttribute=function(e){return this._ogma.modules.individualAttributes.getSingleAttribute(this,e)[0]},qt.prototype.getPosition=function(){return this.getAttributes(["x","y"])},qt.prototype.getPositionOnScreen=function(){return this._ogma.modules.camera.graphToScreenCoordinates(this.getPosition())},qt.prototype.isInScreen=function(){var e=this.getPositionOnScreen(),t=this._ogma.modules.camera;return 0<=e.x&&e.x<=t.width&&0<=e.y&&e.y<=t.height},qt.prototype.replaceOriginalAttributes=function(e,t){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,e,t)},qt.prototype.getPreviousAttributes=function(e){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,e)[0]},qt.prototype.isInView=function(e){return this._ogma.modules.locate.isElementInView(this,e)},qt.prototype.getAdjacentNodes=function(e){return this._ogma.modules.graph.getAdjacentNodes(this,e)},qt.prototype.getAdjacentEdges=function(e){return this._ogma.modules.graph.getAdjacentEdges(this,e)},qt.prototype.getDegree=function(e){return this._ogma.modules.graph.getDegree(this,e)[0]},qt.prototype.fastGetAdjacentElements=function(){return this._ogma.modules.graph.fastGetNodesAdjacentElements(this)},qt.prototype.getConnectedComponent=function(e){return this._ogma.modules.graph.getConnectedComponentByNode(this,e)[0]},qt.prototype.isVisible=function(){return!this.isExcluded()},qt.prototype.isExcluded=function(){return this._ogma.modules.graph.isExcluded(this)[0]},qt.prototype.setExcluded=function(e){return this._ogma.modules.graph.setExcluded(this,e)},qt.prototype.setVisible=function(e){return this.setExcluded(!e)},qt.prototype.toList=function(){return this._ogma.nodeList(new Uint32Array([+this._index]))},qt.prototype.getId=function(){return qu(this._ogma.modules.graph,this)},qt.prototype.slice=function(){return this.toList()},qt.prototype.toJSON=function(e){void 0===e&&(e={});var t=kh(e),n=t.attributes,i=t.data;return{id:this.getId(),attributes:this.getAttributes(n),data:i(un(this.getData()))}},qt.prototype.get=function(e){return 0===e?this:void 0},qt.prototype.setSelected=function(e){this._ogma.modules.selection.setActive(this,e)},qt.prototype.isSelected=function(){return this._ogma.modules.selection.areActive(this)},qt.prototype.locate=function(e){return this._ogma.modules.locate.locateElements(this,e)},qt.prototype.getBoundingBox=function(){return this._ogma.modules.locate.getBoundingBox(this)},qt.prototype.setData=function(e,t){return arguments.length<2&&(t=e,e=null),this._ogma.modules.data.setProperty(this,e,t),this},qt.prototype.getData=function(e){return ju(arguments.length),this._ogma.modules.data.getProperty(this,e)[0]},qt.prototype.addClass=function(e,t){return this._ogma.modules.classes.addClassesToElements([e],this,t)},qt.prototype.addClasses=function(e,t){return this._ogma.modules.classes.addClassesToElements(e,this,t)},qt.prototype.removeClass=function(e,t){return this._ogma.modules.classes.removeClassesFromElements([e],this,t)},qt.prototype.removeClasses=function(e,t){return this._ogma.modules.classes.removeClassesFromElements(e,this,t)},qt.prototype.hasClass=function(e){return this._ogma.modules.classes.hasSingleElementClass(e,this)},qt.prototype.getClassList=function(){return this._ogma.modules.classes.getElementsClassList(this)[0]},qt.prototype.getGeoCoordinates=function(){var e=this._ogma.modules.graph,t=e.getNodeAttribute(ia).get(this._index),n=e.getNodeAttribute(ra).get(this._index);return{latitude:Yh(t)?t:void 0,longitude:Yh(n)?n:void 0}},qt.prototype.setGeoCoordinates=function(e){var t=this;return this.toList().setGeoCoordinates([e]).then(function(){return t})},qt.prototype.getAnimationInformation=function(){return this._ogma.modules.graphics.getAnimationInformation(this)[0]},qt.prototype.isVirtual=function(){return this._ogma.modules.transformations.isElementVirtual(this)},qt.prototype.getTransformation=function(){return this._ogma.modules.transformations.getElementTransformation(this)},qt.prototype.getMetaNode=function(){return this._ogma.modules.grouping.getMetaElement(this)[0]},qt.prototype.getSubNodes=function(){return this._ogma.modules.grouping.getSubElements(this)[0]},qt.prototype.pulse=function(e){this._ogma.modules.pulses.pulse(this,e)},qt);function qt(e,t){this.size=1,this.isNode=!0,this.isList=!1,this._index=e,this._ogma=t}Zu([mo],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute",setPosition:"setAttributes"});var ar=(Object.defineProperty(Ft.prototype,"size",{get:function(){return this._indexes.length},enumerable:!0,configurable:!0}),Ft.prototype.setAttributes=function(e,t){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,e,t)},Ft.prototype.setAttribute=function(e,t,n){return this._ogma.modules.individualAttributes.setSingleAttribute(this,e,t,n)},Ft.prototype.getAttributes=function(e){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,e)},Ft.prototype.getAttribute=function(e){return this._ogma.modules.individualAttributes.getSingleAttribute(this,e)},Ft.prototype.resetAttributes=function(e,t){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,e,t)},Ft.prototype.getPosition=function(){return this.getAttributes(["x","y"])},Ft.prototype.getPositionOnScreen=function(){var e=this;return this.getPosition().map(function(t){return e._ogma.modules.camera.graphToScreenCoordinates(t)})},Ft.prototype.replaceOriginalAttributes=function(e,t){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,e,t)},Ft.prototype.getPreviousAttributes=function(e){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,e)},Ft.prototype.getPreviousAttribute=function(e){return this._ogma.modules.individualAttributes.getSinglePreviousAttribute(this,e)},Ft.prototype.getAdjacentNodes=function(e){return this._ogma.modules.graph.getAdjacentNodes(this,e)},Ft.prototype.getAdjacentEdges=function(e){return this._ogma.modules.graph.getAdjacentEdges(this,e)},Ft.prototype.getDegree=function(e){return this._ogma.modules.graph.getDegree(this,e)},Ft.prototype.getConnectedComponents=function(e){return this._ogma.modules.graph.getConnectedComponents(this,e)},Ft.prototype.fastGetAdjacentElements=function(){return this._ogma.modules.graph.fastGetNodesAdjacentElements(this)},Ft.prototype.isVisible=function(){return this.isExcluded().map(function(e){return!e})},Ft.prototype.isExcluded=function(){return this._ogma.modules.graph.isExcluded(this)},Ft.prototype.setExcluded=function(e){return this._ogma.modules.graph.setExcluded(this,e)},Ft.prototype.setVisible=function(e){return this.setExcluded(!e)},Ft.prototype.toList=function(){return this},Ft.prototype.toArray=function(){return Uh(this._ogma.modules.graph,this)},Ft.prototype.clone=function(){return this._ogma.modules.graph.nodeList(this._indexes.slice())},Ft.prototype.getId=function(){return qu(this._ogma.modules.graph,this)},Ft.prototype.get=function(e){return Gh(this._ogma.modules.graph,this,e)},Ft.prototype.forEach=function(e){Lh(this._ogma.modules.graph,this,e)},Ft.prototype.map=function(e){return Fh(this._ogma.modules.graph,this,e)},Ft.prototype.filter=function(e){return Ph(this._ogma.modules.graph,this,e)},Ft.prototype.reduce=function(e,t){return Rh(this._ogma.modules.graph,this,e,t)},Ft.prototype.concat=function(e){return Vh(this._ogma.modules.graph,this,e)},Ft.prototype.dedupe=function(){return zh(this._ogma.modules.graph,this)},Ft.prototype.slice=function(e,t){return this._ogma.modules.graph.nodeList(this._indexes.slice(e,t))},Ft.prototype.indexOf=function(e){return e instanceof mo?this._indexes.indexOf(e._index):-1},Ft.prototype.includes=function(e){return-1!==this.indexOf(e)},Ft.prototype.inverse=function(){return Bh(this._ogma.modules.graph,this)},Ft.prototype.sort=function(e){return qh(this._ogma.modules.graph,this,e)},Ft.prototype.toJSON=function(e){return void 0===e&&(e={}),this.map(function(t){return t.toJSON(e)})},Ft.prototype.setSelected=function(e){this._ogma.modules.selection.setActive(this,e)},Ft.prototype.isSelected=function(){return this._ogma.modules.selection.areActive(this)},Ft.prototype.locate=function(e){return this._ogma.modules.locate.locateElements(this,e)},Ft.prototype.getBoundingBox=function(){return this._ogma.modules.locate.getBoundingBox(this)},Ft.prototype.setData=function(e,t){if(arguments.length<2&&(t=e,e=null),"function"!=typeof t&&!li(t))throw new Error("invalid argument "+t+"; expected array or function");return this._ogma.modules.data.setProperty(this,e,t,{dispatch:!0}),this},Ft.prototype.fillData=function(e,t){return arguments.length<2&&(t=e,e=null),this._ogma.modules.data.setProperty(this,e,t,{dispatch:!1}),this},Ft.prototype.getData=function(e){return ju(arguments.length),this._ogma.modules.data.getProperty(this,e)},Ft.prototype.addClass=function(e,t){return this._ogma.modules.classes.addClassesToElements([e],this,t)},Ft.prototype.addClasses=function(e,t){return this._ogma.modules.classes.addClassesToElements(e,this,t)},Ft.prototype.removeClass=function(e,t){return this._ogma.modules.classes.removeClassesFromElements([e],this,t)},Ft.prototype.removeClasses=function(e,t){return this._ogma.modules.classes.removeClassesFromElements(e,this,t)},Ft.prototype.hasClass=function(e){var t=this;return this.map(function(n){return t._ogma.modules.classes.hasSingleElementClass(e,n)})},Ft.prototype.getClassList=function(){return this._ogma.modules.classes.getElementsClassList(this)},Ft.prototype.getGeoCoordinates=function(){for(var e=this._ogma.modules.graph,t=new Array(this._indexes.length),n=e.getNodeAttribute(ia).getMultiple(this._indexes),i=e.getNodeAttribute(ra).getMultiple(this._indexes),r=0,o=this._indexes.length;r<o;r++)t[r]={latitude:n[r],longitude:i[r]};return t},Ft.prototype.setGeoCoordinates=function(e){var t=this,n=this._ogma.modules.geo,i=this._ogma.modules.graph,r=this.getId(),o=this._indexes,a=new Array(o.length),s=new Array(o.length);if(null===e&&(e=new Array(o.length).fill(null)),e.length!==o.length)throw new RangeError("You must provide coordinates for each node in the NodeList");for(var l=0,u=o.length;l<u;l++){var d=e[l]||{latitude:null,longitude:null},c=d.latitude,h=d.longitude,p=r[l];null==c&&null==h?c=h=void 0:(Jh(p,c),Xh(p,h)),a[l]=c,s[l]=h}return this.setData(n.latitudePath,a),this.setData(n.longitudePath,s),i.getNodeAttribute(ia).setMultiple(o,a),i.getNodeAttribute(ra).setMultiple(o,s),this._ogma.modules.transformations.refresh().then(function(){return t})},Ft.prototype.getAnimationInformation=function(){return this._ogma.modules.graphics.getAnimationInformation(this)},Ft.prototype.getMetaNode=function(){return this._ogma.modules.grouping.getMetaElement(this)},Ft.prototype.getSubNodes=function(){return this._ogma.modules.grouping.getSubElements(this)},Ft.prototype.pulse=function(e){this._ogma.modules.pulses.pulse(this,e)},Ft);function Ft(e,t){this.isList=!0,this.isNode=!0,this._indexes=e,this._ogma=t}function Wu(e,t,n,i){return void 0===n&&(n={}),void 0===i&&(i={}),iu(e,t,[n],i).get(0)}function xs(e,t,n,i){if(void 0===i&&(i={}),i.batchSize){for(var r=[],o=0;o<n.length;o+=i.batchSize)r.push(n.slice(o,o+i.batchSize));return r.reduce(function(a,s){var l=null;return a.then(function(u){return l=u,e.getDom().afterNextFrame()}).then(function(){return iu(e,t,s,i)}).then(function(u){return l.concat(u)})},Promise.resolve(t?e.nodeList():e.edgeList()))}return Promise.resolve(iu(e,t,n,i))}function iu(e,t,n,i){for(var r=e.storage.fetch(t),o=[],a=[],s=[],l=[],u=new Set,d=i.virtual,c=void 0!==d&&d,h=0,p=n;h<p.length;h++){var g=p[h];if("object"!=typeof g||null===g||Array.isArray(g))throw new Error(g+" is not a valid "+(t?"node":"edge"));var m=Ny(g.id);if(!r.getIndex(m,!1)&&!u.has(m)&&(a.push(m),o.push(g),u.add(m),!t)){var b=g,v=e.getExtremityIndex(m,b.source,"source"),y=e.getExtremityIndex(m,b.target,"target");s.push(v),l.push(y)}}var E=r.addElements(a);t?e.topology.allocateNodes(E):e.topology.allocateEdges(E,s,l);for(var S=r.getFlexArray("object"),w=r.getFlexArray("excluded"),M=r.getFlexArray("removed"),O=r.getFlexArray("virtual"),F=t?e.node:e.edge,L=t?e.nodeList:e.edgeList,N=e.getCacheLists(t),B=L(E),X=0;X<E.length;X++){var J=E[X];S.set(J,F(J))}return w.setMultiple(E,0),M.setMultiple(E,0),O.setMultiple(E,c?1:0),N.visible.invalidList(),N.all.invalidList(),N._all.invalidList(),c||N.raw.invalidList(),0!==B.size&&(t?e.fireEvent(I.ADD_NODES,{virtual:c,objects:o,nodes:B}):e.fireEvent(I.ADD_EDGES,{virtual:c,objects:o,edges:B})),B}Zu([ar],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute",setPosition:"setAttributes"});var $h,Py=(wt(Pt,$h=Fe),Pt.prototype.onMounted=function(e,t){if(t.graph){var n=t.graph,i=n.nodes,r=n.edges;i&&this.addNodes(i),r&&this.addEdges(r)}},Pt.prototype.createIndexList=function(e){return this.storage.fetch(e).createIndexList()},Pt.prototype.setIndexFreeStep=function(e){this._indexFreeStep=e},Pt.prototype.getDom=function(){return this._dom},Pt.prototype.acquireIndexList=function(e){var t=e?this._nodeIndexLists:this._edgeIndexLists,n=t.find(function(i){return!i.isBusy()});return n||(n=this.createIndexList(e),t.push(n)),n.markBusy(),n},Pt.prototype.getObjectList=function(e){return e?this._nodes:this._edges},Pt.prototype.getListFactory=function(e){return e?this.nodeList:this.edgeList},Pt.prototype.getStorage=function(e){return e?this.storage.nodes:this.storage.edges},Pt.prototype.getFilter=function(e,t){var n=e?this._nodeFilters:this._edgeFilters;return n[t]||n.visible},Pt.prototype.fireEvent=function(e,t){this._events.fire(e,t)},Pt.prototype.getCacheLists=function(e){return e?this._nodeCacheLists:this._edgeCacheLists},Pt.prototype._resolvePromises=function(){var e=this._promisesToResolve;this._promisesToResolve=[],e.forEach(function(t){return t()})},Pt.prototype._initialize=function(){var e=this;this._nodeCacheLists=Nh(function(){return e.getNodeMaxIndex()},function(){return e.acquireIndexList(!0)},this._nodeFilters),this._edgeCacheLists=Nh(function(){return e.getEdgeMaxIndex()},function(){return e.acquireIndexList(!1)},this._edgeFilters),this.topology=new Oy(this),this._resolvePromises()},Pt.prototype.getNodeMaxIndex=function(){return this.storage.nodes.getMaxIndex()},Pt.prototype.getEdgeMaxIndex=function(){return this.storage.edges.getMaxIndex()},Pt.prototype.isExcluded=function(e){return this.storage.fetch(e.isNode).getFlexArray("excluded").getMultiple(e._indexes)},Pt.prototype.setExcluded=function(e,t){for(var n=t?1:0,i=e.isNode,r=this.storage.fetch(i),o=r.getFlexArray("excluded"),a=r.getFlexArray("removed"),s=this.acquireIndexList(i),l=this.getListFactory(i),u=0;u<e._indexes.length;u++){var d=e._indexes[u],c=o.get(d),h=a.get(d);n!==c&&0===h&&s.push(d)}var p=s.sliceAndReset();if(p.length){this.getCacheLists(e.isNode).visible.invalidList();var g=l(p);o.setMultiple(p,n),this._events.fire(I.EXCLUDED_STATE_CHANGE,{elements:g,value:t})}},Pt.prototype.addNode=function(e,t){return Wu(this,!0,e,t)},Pt.prototype.addEdge=function(e,t){return Wu(this,!1,e,t)},Pt.prototype.addNodes=function(e,t){return xs(this,!0,e,t)},Pt.prototype.addEdges=function(e,t){return xs(this,!1,e,t)},Pt.prototype.getExtremityIndex=function(e,t,n){if(t instanceof mo)return t._index;var i=this.storage.nodes.getIndex(t);if(!i)throw new Error("addEdge(s): invalid "+n+' for edge "'+e+'"; node "'+t+'" does not exist');return i},Pt.prototype.getNodes=function(e){return this.getElements(!0,e)},Pt.prototype.getEdges=function(e){return this.getElements(!1,e)},Pt.prototype.getElements=function(e,t){var n=e?this.nodeList:this.edgeList,i=e?ar:vs,r=e?mo:na;if(t&&"string"!=typeof t){var o=this.acquireIndexList(e),a=this.storage.fetch(e);if(t instanceof r)o.push(t._index);else if(li(t))for(var s=0,l=t;s<l.length;s++){var u=l[s];u instanceof r?o.push(u._index):(p=a.getIndex(u))&&o.push(p)}else if(t instanceof i)for(var d=this.getFilter(e,"all"),c=t,h=0;h<c._indexes.length;h++){var p;d(p=c._indexes[h])&&o.push(p)}return n(o.sliceAndReset())}var g=t||"visible",m=this.getCacheLists(e)[g];if(!m)throw new Error('getNodes/getEdges: unexpected argument "'+g+'"');return n(m.getList())},Pt.prototype.getNode=function(e){return this._getElement(!0,e)},Pt.prototype.getEdge=function(e){return this._getElement(!1,e)},Pt.prototype._getElement=function(e,t){if(t instanceof(e?mo:na))return t;var n=this.getStorage(e),i=this.getObjectList(e),r=n.getIndex(t);return r?i.get(r):void 0},Pt.prototype.clear=function(){this._events.fire(I.CLEAR_GRAPH),this.storage.nodes.clear(),this.storage.edges.clear(),this._initialize()},Pt.prototype.createAttribute=function(e,t){return this.storage.fetch(e).createFlexArray(t)},Pt.prototype.createNodeAttribute=function(e){return this.createAttribute(!0,e)},Pt.prototype.createEdgeAttribute=function(e){return this.createAttribute(!1,e)},Pt.prototype.getAttribute=function(e,t){return this.storage.fetch(e).getFlexArray(t)},Pt.prototype.getAttributes=function(e,t){var n=this;return t.map(function(i){return n.getAttribute(e,i)})},Pt.prototype.getNodeAttribute=function(e){return this.storage.nodes.getFlexArray(e)},Pt.prototype.getNodeAttributes=function(e){return this.getAttributes(!0,e)},Pt.prototype.getEdgeAttribute=function(e){return this.storage.edges.getFlexArray(e)},Pt.prototype.getEdgeAttributes=function(e){return this.getAttributes(!1,e)},Pt.prototype.getAllNodeAttributes=function(){return this.storage.nodes.getAllFlexArrays()},Pt.prototype.getAllEdgeAttributes=function(){return this.storage.edges.getAllFlexArrays()},Pt.prototype.setSource=function(e,t){var n=this.getNode(t);this.topology.setExtremities(e._indexes,n._indexes,null)},Pt.prototype.setTarget=function(e,t){var n=this.getNode(t);this.topology.setExtremities(e._indexes,null,n._indexes)},Pt.prototype.getParallelEdges=function(e,t){return void 0===t&&(t={}),this.topology.getParallelEdges(e,t)},Pt.prototype.getEdgesBetweenTwoNodes=function(e,t){return this.edgeList(this.topology.getEdgesBetweenTwoNodes(e._index,t._index))},Pt.prototype.getAdjacentDirections=function(e){return this.topology.getAdjacentDirections(e)},Pt.prototype.getEdgeIndexesInDirection=function(e){return this.topology.getEdgeIndexesInDirection(e)},Pt.prototype.fastGetNodesAdjacentElements=function(e){return this.topology.fastGetNodesAdjacentElements(e._indexes)},Pt.prototype.fastGetEdgesAdjacentElements=function(e){return this.topology.fastGetEdgesAdjacentElements(e._indexes)},Pt.prototype.getAdjacentNodes=function(e,t){return this.nodeList(this.topology.getAdjacentElements(!0,e._indexes,t))},Pt.prototype.getAdjacentEdges=function(e,t){return this.edgeList(this.topology.getAdjacentElements(!1,e._indexes,t))},Pt.prototype.getDegree=function(e,t){return this.topology.getDegree(e._indexes,t)},Pt.prototype.degrees=function(e,t){return this.topology.degrees(e,t)},Pt.prototype.getAdjacencyList=function(e){var t=void 0===e?{}:e,n=t.directed,r=t.internalIndexes,a=t.weight;return this.topology.getAdjacencyList({directed:void 0!==n&&n,weight:void 0===a?1:a,ids:!(void 0!==r&&r),nodes:t.indexes||this.getNodes(t.nodes)._indexes})},Pt.prototype.getConnectedComponents=function(e,t){return this.topology.getConnectedComponents(e._indexes,t)},Pt.prototype.getConnectedComponentByNode=function(e,t){return this.topology.getConnectedComponents(e._indexes,t)},Pt);function Pt(e,t){var n=e.dom,i=e.events,r=$h.call(this)||this;return r.storage={nodes:new go(!0),edges:new go(!1),fetch:function(o){return o?this.nodes:this.edges}},r._promisesToResolve=[],r._indexFreeStep=0,r._nodeIndexLists=[],r._edgeIndexLists=[],r._events=i,r._dom=n,r._events.register([I.ADD_NODES,I.ADD_EDGES,I.EXCLUDED_STATE_CHANGE],[I.CLEAR_GRAPH,I.BEFORE_REMOVE_NODES,I.REMOVE_NODES,I.BEFORE_REMOVE_EDGES,I.REMOVE_EDGES]),[{name:"excluded",storage:1,default:1},{name:"removed",storage:1,default:1},{name:"virtual",storage:1,default:0}].forEach(function(o){r.createNodeAttribute(o),r.createEdgeAttribute(o)}),r.node=t.node,r.edge=t.edge,r.nodeList=t.nodeList,r.edgeList=t.edgeList,r._nodes=r.createAttribute(!0,{name:"object",storage:"any"}),r._edges=r.createAttribute(!1,{name:"object",storage:"any"}),r.createAttribute(!1,{name:"source",storage:32}),r.createAttribute(!1,{name:"target",storage:32}),r._nodeFilters=Oh(r.storage.nodes),r._edgeFilters=Oh(r.storage.edges),r._initialize(),r._events.on({newFrame:function(){1===r._indexFreeStep?r._indexFreeStep=2:2===r._indexFreeStep&&(r.storage.nodes.freeIndexes(),r.storage.edges.freeIndexes(),r._indexFreeStep=0)}}),r}var _d=["AliceBlue","#F0F8FF","AntiqueWhite","#FAEBD7","Aqua","#00FFFF","Aquamarine","#7FFFD4","Azure","#F0FFFF","Beige","#F5F5DC","Bisque","#FFE4C4","Black","#000000","BlanchedAlmond","#FFEBCD","Blue","#0000FF","BlueViolet","#8A2BE2","Brown","#A52A2A","BurlyWood","#DEB887","CadetBlue","#5F9EA0","Chartreuse","#7FFF00","Chocolate","#D2691E","Coral","#FF7F50","CornflowerBlue","#6495ED","Cornsilk","#FFF8DC","Crimson","#DC143C","Cyan","#00FFFF","DarkBlue","#00008B","DarkCyan","#008B8B","DarkGoldenRod","#B8860B","DarkGray","#A9A9A9","DarkGrey","#A9A9A9","DarkGreen","#006400","DarkKhaki","#BDB76B","DarkMagenta","#8B008B","DarkOliveGreen","#556B2F","DarkOrange","#FF8C00","DarkOrchid","#9932CC","DarkRed","#8B0000","DarkSalmon","#E9967A","DarkSeaGreen","#8FBC8F","DarkSlateBlue","#483D8B","DarkSlateGray","#2F4F4F","DarkSlateGrey","#2F4F4F","DarkTurquoise","#00CED1","DarkViolet","#9400D3","DeepPink","#FF1493","DeepSkyBlue","#00BFFF","DimGray","#696969","DimGrey","#696969","DodgerBlue","#1E90FF","FireBrick","#B22222","FloralWhite","#FFFAF0","ForestGreen","#228B22","Fuchsia","#FF00FF","Gainsboro","#DCDCDC","GhostWhite","#F8F8FF","Gold","#FFD700","GoldenRod","#DAA520","Gray","#808080","Grey","#808080","Green","#008000","GreenYellow","#ADFF2F","HoneyDew","#F0FFF0","HotPink","#FF69B4","IndianRed","#CD5C5C","Indigo","#4B0082","Ivory","#FFFFF0","Khaki","#F0E68C","Lavender","#E6E6FA","LavenderBlush","#FFF0F5","LawnGreen","#7CFC00","LemonChiffon","#FFFACD","LightBlue","#ADD8E6","LightCoral","#F08080","LightCyan","#E0FFFF","LightGoldenRodYellow","#FAFAD2","LightGray","#D3D3D3","LightGrey","#D3D3D3","LightGreen","#90EE90","LightPink","#FFB6C1","LightSalmon","#FFA07A","LightSeaGreen","#20B2AA","LightSkyBlue","#87CEFA","LightSlateGray","#778899","LightSlateGrey","#778899","LightSteelBlue","#B0C4DE","LightYellow","#FFFFE0","Lime","#00FF00","LimeGreen","#32CD32","Linen","#FAF0E6","Magenta","#FF00FF","Maroon","#800000","MediumAquaMarine","#66CDAA","MediumBlue","#0000CD","MediumOrchid","#BA55D3","MediumPurple","#9370DB","MediumSeaGreen","#3CB371","MediumSlateBlue","#7B68EE","MediumSpringGreen","#00FA9A","MediumTurquoise","#48D1CC","MediumVioletRed","#C71585","MidnightBlue","#191970","MintCream","#F5FFFA","MistyRose","#FFE4E1","Moccasin","#FFE4B5","NavajoWhite","#FFDEAD","Navy","#000080","OldLace","#FDF5E6","Olive","#808000","OliveDrab","#6B8E23","Orange","#FFA500","OrangeRed","#FF4500","Orchid","#DA70D6","PaleGoldenRod","#EEE8AA","PaleGreen","#98FB98","PaleTurquoise","#AFEEEE","PaleVioletRed","#DB7093","PapayaWhip","#FFEFD5","PeachPuff","#FFDAB9","Peru","#CD853F","Pink","#FFC0CB","Plum","#DDA0DD","PowderBlue","#B0E0E6","Purple","#800080","RebeccaPurple","#663399","Red","#FF0000","RosyBrown","#BC8F8F","RoyalBlue","#4169E1","SaddleBrown","#8B4513","Salmon","#FA8072","SandyBrown","#F4A460","SeaGreen","#2E8B57","SeaShell","#FFF5EE","Sienna","#A0522D","Silver","#C0C0C0","SkyBlue","#87CEEB","SlateBlue","#6A5ACD","SlateGray","#708090","SlateGrey","#708090","Snow","#FFFAFA","SpringGreen","#00FF7F","SteelBlue","#4682B4","Tan","#D2B48C","Teal","#008080","Thistle","#D8BFD8","Tomato","#FF6347","Turquoise","#40E0D0","Violet","#EE82EE","Wheat","#F5DEB3","White","#FFFFFF","WhiteSmoke","#F5F5F5","Yellow","#FFFF00","YellowGreen","#9ACD32"],Dy=/^rgba?\((\d+),?\s*(\d+),?\s*(\d+),?\s*((\d+)?\.?\d+)*\)$/;function md(e,t){void 0===t&&(t=[0,0,0,0]);var n=Dy.exec(e);return n?(t[0]=parseInt(n[1])/255,t[1]=parseInt(n[2])/255,t[2]=parseInt(n[3])/255,t[3]=void 0===n[4]?1:parseFloat(n[4]),t):null}function Yu(e){return e<16?"0"+e.toString(16):e.toString(16)}function ep(e){var r=e[3];return"rgba("+(256*e[0]|0)+","+(256*e[1]|0)+","+(256*e[2]|0)+","+(void 0===r?1:r)+")"}function vd(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(n,i,r,o){return i+i+r+r+o+o});var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?[parseInt(t[1],16)/255,parseInt(t[2],16)/255,parseInt(t[3],16)/255,1]:null}var ru=[0,0,0,0],ou=(Xu.prototype.parseColor=function(e){var t=this._colorByName[e];if(void 0===t){var n=e+"";t="#"===n.charAt(0)?vd(n):md(n),this._colorByName[e]=t}return t},Xu.prototype.toHexa=function(e){var t=this.parseColor(e),i=t[1],r=t[2];return"#"+Yu(255*t[0])+Yu(255*i)+Yu(255*r)},Xu.prototype.rgbaToRgb=function(e){var t=1,n=e;return n&&md(e,ru)&&(n="rgb("+255*ru[0]+","+255*ru[1]+","+255*ru[2]+")",t=parseFloat(ru[3].toString())),{color:n,opacity:t}},Xu);function Xu(){this._colorByName={},this._colorByName.null=[0,0,0,0],this._colorByName.transparent=[0,0,0,0];for(var e=0;e<_d.length;e+=2){var t=_d[e].toLowerCase();this._colorByName[t]=vd(_d[e+1])}}var bs,Ry=((bs={})[2]="image",bs[4]="piechart",bs[3]="text",bs[5]="icon",bs[6]="badge",bs),zy=(Qi.prototype.reset=function(){this._init_()},Qi.prototype._init_=function(){this._mustUpdate=!0,this._nextPatternId=1,this._patterns=[null],this._patternsByHash={},this._pixelRatio=1,this._nullPattern={id:-1,type:1,attributes:{}}},Qi.prototype._increaseNextId=function(){var e=this._nextPatternId++;for(e%256==255&&(e=this._nextPatternId++);this._patterns.length<=e;)this._patterns.push(void 0);return e},Qi.prototype._createPattern=function(e){var t=e.type,n=e.attributes,i={id:this._increaseNextId(),type:t,attributes:this._cloneAttributes(t,n)};return this._patterns[i.id]=i,this._mustUpdate=!0,i},Qi.prototype._cloneAttributes=function(e,t){return 2===e?{image:t.image,scaled:t.scaled,duplicated:t.duplicated}:3===e||5===e||6===e?{font:t.font,size:t.size,style:t.style,text:t.text,align:t.align||"center",offset:t.offset||0}:4===e?{colors:t.colors,colorArray:t.colors.split(";").map(function(n){return n.trim()})}:void 0},Qi.prototype.getPatternList=function(){return this._patterns.filter(function(e){return e})},Qi.prototype.update=function(){this._mustUpdate&&(this._version+=1,this._mustUpdate=!1)},Qi.prototype.setPixelRatio=function(e){e!==this._pixelRatio&&(this._pixelRatio=e,this._mustUpdate=!0)},Qi.prototype.getPixelRatio=function(){return this._pixelRatio},Qi.prototype.notifyUpdate=function(){this._mustUpdate=!0},Qi.prototype.getIdFromDefinition=function(e){var t=e.type,n=e.attributes,r=0;return t&&1!==t&&7!==t&&(2!==t||n.image)&&(!(3===t||5===t||6===t)||n.text&&n.font)&&(r=this._addPattern(e),3===t&&"normal"===n.style&&(n.style="bold",this._addPattern(e))),r},Qi.prototype._addPattern=function(e){var t=this._getPatternHash(e),n=this._patternsByHash[t];return n||(65500<this._nextPatternId?eo("maximum number of pattern exceeded"):(n=this._createPattern(e).id,this._patternsByHash[t]=n)),n},Qi.prototype._getPatternHash=function(e){var t=e.type,n=e.attributes,i=[Ry[t]];return 2===t?i.push(n.scaled?"scaled":"non-scaled",n.duplicated?"duplicated":"non-duplicated",n.image.src||n.image.toDataURL()):3===t?i.push(n.text,n.font,n.style,n.size,n.align||"center",n.offset||0):5===t||6===t?i.push(n.text,n.font,n.style,n.size):i.push(n.colors),i.join("+")},Qi.prototype.getDefinitionFromId=function(e){return e?this._patterns[e]:this._nullPattern},Qi.prototype.getVersion=function(){return this._version},Qi);function Qi(){this._pixelRatio=1,this._nextPatternId=1,this._version=0,this._init_()}var tp=Math.round(Math.log2(512)),bd=Math.round(Math.log2(128)),By=tp+bd,Ed=Math.round(Math.sqrt(16)),Sd=128*Ed,wr=256;function np(e){return e.map(function(t){var r=t.r;return{x:t.x,y:t.y,r:void 0===r?0:r}})}var Vy=(ua.prototype.register=function(e,t){var n=t.getDistanceFromStrokeVertically,i=t.getDistanceFromStrokeHorizontally,r=t.points,o=t.hole,a=t.isSimple;if(!this._byName[e]){for(var s=a?1:8,l=a?7:15;this._byId[s];)s+=1;if(l<s)throw new Error("max number of shape exceeded");var u={id:s,name:e,getDistanceFromStrokeVertically:n,getDistanceFromStrokeHorizontally:i,points:np(r.slice()),hole:o?np(o.slice()):null,isSimple:!!a};return this._mustUpdate=!0,this._byId[s]=u,this._byName[e]=u}},ua.prototype.getIdFromName=function(e){return this._byName[e].id},ua.prototype.getNameFromId=function(e){var t=this._byId[e];return t?t.name:null},ua.prototype.getDefinitionFromName=function(e){return this._byName[e]||null},ua.prototype.update=function(){this._mustUpdate&&(this._version+=1,this._mustUpdate=!1)},ua.prototype.getVersion=function(){return this._version},ua.prototype.getShapeList=function(){return this._byId.filter(function(e){return e})},ua);function ua(){this._version=0,this._mustUpdate=!0,this._byName={},this._byId=new Array(16)}var Uy=(ri.prototype.update=function(){this._mustUpdate&&(this._version+=1,this._mustUpdate=!1,this._isFullyAllocated&&this._nbCellsFreed===this._nbCellsAllocated&&(this._isFullyFreed=!0))},ri.prototype.allocate=function(e){var t=-1;return!this._isFullyAllocated&&this._nbCellsAllocated+e<=this._capacity?(t=this._nbCellsAllocated,this._nbCellsAllocated+=e,this._mustUpdate=!0):this._isFullyAllocated=!0,t},ri.prototype.free=function(e,t){for(var n=0;n<t;n++){var i=(e+n)*this._elementSize;if(0===this._dataView.getUint16(i))throw new Error('"free": invalid address provided');this._dataView.setUint16(i,0)}this._mustUpdate=!0,this._nbCellsFreed+=t},ri.prototype.triggerUpdate=function(){this._mustUpdate=!0},ri.prototype.isEmpty=function(){return this._nbCellsFreed===this._nbCellsAllocated},ri.prototype.isFullyFreed=function(){return this._isFullyFreed},ri.prototype.getId=function(){return this._id},ri.prototype.getDepth=function(){return this._depth},ri.prototype.getElementType=function(){return this._elementType},ri.prototype.getDataView=function(){return this._dataView},ri.prototype.getByteArray=function(){return this._byteArray},ri.prototype.getElementSize=function(){return this._elementSize},ri.prototype.isAnimated=function(){return this._animated},ri.prototype.getCapacity=function(){return this._capacity},ri.prototype.getSize=function(){return this._nbCellsAllocated},ri.prototype.getNbSideElementsPerMainElement=function(){return this._nbSideElementsPerMainElement},ri.prototype.hasSideData=function(){return 0<this._nbSideElementsPerMainElement},ri.prototype.getSideDataView=function(){return this._sideDataView},ri.prototype.getSideByteArray=function(){return this._sideByteArray},ri.prototype.getTotalSideElementsSize=function(){return this._totalSideElementsSize},ri.prototype.getVersion=function(){return this._version},ri.prototype.getStencilUsage=function(){return this._stencilUsage},ri);function ri(e){var t=e.elementSize,n=e.sideElementSize,i=e.nbSideElementsPerMainElement,r=e.id,o=e.depth,a=e.elementType,s=e.animated,l=e.stencilUsage;this._version=0,this._nbCellsAllocated=0,this._nbCellsFreed=0,this._isFullyAllocated=!1,this._isFullyFreed=!1,this._mustUpdate=!0,this._capacity=512,this._id=r,this._depth=o,this._elementType=a,this._animated=s,this._stencilUsage=l,this._elementSize=t,this._sideElementSize=n,this._nbSideElementsPerMainElement=i,this._totalSideElementsSize=i*n,this._byteCapacity=this._capacity*this._elementSize,this._byteArray=new Uint8Array(this._byteCapacity),this._dataView=new DataView(this._byteArray.buffer),this._sideByteCapacity=this._capacity*this._totalSideElementsSize,this._sideByteArray=new Uint8Array(this._sideByteCapacity),this._sideDataView=new DataView(this._sideByteArray.buffer)}var jy=(sr.prototype.reset=function(){this._init_()},sr.prototype._init_=function(){this._buffersByDepth=new Array(100),this._buffersById=[],this._buffersByAscendingDepth=[],this._buffersByDescendingDepth=[],this._mustUpdate=!0},sr.prototype._fillBlockInfo=function(e,t,n,i){return this._blockInfo.buffer=e,this._blockInfo.offset=t,this._blockInfo.size=n,this._blockInfo.address=i,this._blockInfo},sr.prototype._createBuffer=function(e,t,n,i,r){var s=new Uy({elementSize:t?120:52,sideElementSize:4,nbSideElementsPerMainElement:i,id:this._buffersById.length,depth:n,elementType:e,animated:t,stencilUsage:r});return this._buffersById.push(s),s},sr.prototype.getBlockInfo=function(e){return this._getBlockInfo(e)},sr.prototype._getBlockInfo=function(e){return this._fillBlockInfo(this._buffersById[e>>By],(e>>bd)%512,e%128,e)},sr.prototype.allocateBlock=function(e,t,n,i,r,o,a){var s=function(J,ae){for(var ie=0;ie<J;)ie+=8;return ie}(o);this._mustUpdate=!0;var l=null,u=-1;if(e){var d=this._getBlockInfo(e),c=d.buffer,h=d.offset,p=d.size,g=d.size===r,m=c.getDepth()===i,b=c.getElementType()===t,v=c.isAnimated()===n,y=c.getNbSideElementsPerMainElement()===s,E=c.getStencilUsage()===a;g&&m&&b&&v&&y&&E?(c.triggerUpdate(),l=c,u=h):c.free(h,p)}if(-1===u){var S=+n,w=s/8,M=this._buffersByDepth[i]||Array(2),O=(this._buffersByDepth[i]=M)[S]||[],F=(M[S]=O)[t]||Array(16),L=(O[t]=F)[w]||Array(4),N=(F[w]=L)[a]||[],B=(L[a]=N)[N.length-1];B&&(u=(l=B).allocate(r)),-1===u&&(u=(l=this._createBuffer(t,n,i,s,a)).allocate(r),N.push(l))}var X=((l.getId()<<tp)+u<<bd)+r;return this._fillBlockInfo(l,u,r,X)},sr.prototype.freeBlock=function(e){if(e){this._mustUpdate=!0;var t=this._getBlockInfo(e);t.buffer.free(t.offset,t.size)}return 0},sr.prototype._sortBuffersByDepth=function(){for(var e=[],t=0;t<this._buffersByDepth.length;t++){var n=this._buffersByDepth[t];if(n)for(var i=0;i<n.length;i++){var r=n[i];if(r)for(var o=0;o<r.length;o++){var a=r[o];if(a)for(var s=0;s<a.length;s++){var l=a[s];if(l)for(var u=0;u<l.length;u++){var d=l[u];if(d)for(var c=0;c<d.length;c++){var h=d[c];h.update(),h.isFullyFreed()?(this._buffersById[h.getId()]=void 0,d.splice(c,1),--c):e.push(h)}}}}}}this._buffersByAscendingDepth=e,this._buffersByDescendingDepth=e.slice().reverse()},sr.prototype.update=function(){this._mustUpdate&&(this._sortBuffersByDepth(),this._version+=1,this._mustUpdate=!1)},sr.prototype.getBuffers=function(){return this._buffersById},sr.prototype.getBuffersByAscendingDepth=function(){return this._buffersByAscendingDepth},sr.prototype.getBuffersByDescendingDepth=function(){return this._buffersByDescendingDepth},sr.prototype.getVersion=function(){return this._version},sr);function sr(){this._version=0,this._version=0,this._blockInfo={buffer:null,offset:0,size:0,address:0},this._init_()}var ip=(Object.defineProperty(la.prototype,"__dummy",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(la.prototype,"parentNode",{get:function(){return null},enumerable:!0,configurable:!0}),la.prototype.getContext=function(e){return"2d"===e?this.__context:null},la.prototype.toDataURL=function(e){return void 0===e&&(e="png"),"data:image/"+e+";base64,"},la.prototype.addEventListener=function(){},la.prototype.removeEventListener=function(){},la.prototype.getBoundingClientRect=function(){return{left:0,top:0,bottom:0,right:0,width:this.width,height:this.height}},la);function la(){this.style={},this.width=300,this.height=150,this.__context=new rp,this.style={},this.width=300,this.height=150}var rp=(Object.defineProperty(Mn.prototype,"font",{set:function(e){var t=e.match(/\d+/);t&&(this._fontSize=parseFloat(t[0]))},enumerable:!0,configurable:!0}),Object.defineProperty(Mn.prototype,"fillStyle",{set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(Mn.prototype,"textBaseline",{set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(Mn.prototype,"textAlign",{set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(Mn.prototype,"strokeStyle",{set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(Mn.prototype,"lineWidth",{set:function(e){},enumerable:!0,configurable:!0}),Mn.prototype.fill=function(){},Mn.prototype.stroke=function(){},Mn.prototype.clearRect=function(){},Mn.prototype.fillRect=function(){},Mn.prototype.strokeRect=function(){},Mn.prototype.beginPath=function(){},Mn.prototype.closePath=function(){},Mn.prototype.moveTo=function(){},Mn.prototype.lineTo=function(){},Mn.prototype.rect=function(){},Mn.prototype.arc=function(){},Mn.prototype.save=function(){},Mn.prototype.restore=function(){},Mn.prototype.clip=function(){},Mn.prototype.translate=function(){},Mn.prototype.rotate=function(){},Mn.prototype.fillText=function(){},Mn.prototype.setLineDash=function(){},Mn.prototype.quadraticCurveTo=function(){},Mn.prototype.bezierCurveTo=function(){},Mn.prototype.drawImage=function(){},Mn.prototype.measureText=function(e){return{width:e.length*Math.ceil(.625*this._fontSize)}},Mn.prototype.getImageData=function(){return{width:0,height:0,data:new Uint8ClampedArray(0)}},Mn);function Mn(){this._fontSize=10}var nl=bi("canvas")||bi("canvas-prebuilt");function ci(){var e=null;return rr?e=document.createElement("canvas"):nl?(e=nl.createCanvas?nl.createCanvas(300,150):new nl(300,150)).style={}:e=new ip,e}function Za(e,t,n,i){void 0===n&&(n=e.width),void 0===i&&(i=e.height),t.clearRect(0,0,n,i)}function da(e,t,n,i){void 0===i&&(i=""),e.font=i+" "+n+"px "+t}function op(){return null!==Ad(ci(),{})}function Ad(e,t){var n=e.getContext("webgl",t);return(n=n||e.getContext("experimental-webgl",t))||null}function sp(e){return e.pieceId=0,e.shape="",e.x1=0,e.y1=0,e.x2=0,e.y2=0,e.rectWidthOrSourceRadiusScaled=0,e.rectWidthOrSourceRadiusFixed=0,e.rectHeightOrTargetRadiusScaled=0,e.rectHeightOrTargetRadiusFixed=0,e.thicknessOrFontSizeScaled=0,e.thicknessOrFontSizeFixed=0,e.strokeWidthScaled=0,e.strokeWidthFixed=0,e.offsetScaled=0,e.offsetFixed=0,e.pattern.type=0,e.opacity=1,e.fillColor=null,e.strokeColor=null,e.patternColor=null,e.globalMinVisibleSize=0,e.strokeMinVisibleSize=0,e.patternMinVisibleSize=0,e.offsetAngle=0,e.patternScale=0,e.symbolicSize=0,e.curvature=0,e.dashLength=0,e.gapLength=0,e.hasHead=!1,e.hasTail=!1,e.isBodyTriangle=!1,e.isSelfLoop=!1,e.isText=!1,e.adjustTextAngle=!1,e.unusedFlag1=!1,e.unusedFlag2=!1,e.unusedFlag3=!1,e}function up(e,t,n,i){e.width=t*i,e.height=n*i,e.style.width=t+"px",e.style.height=n+"px"}var Cd=(Vn.createInitData=function(){return null},Vn.getName=function(){return null},Vn.isAvailable=function(){return!0},Vn.prototype.getDomElement=function(){return null},Vn.prototype._initCanvas=function(e){e.style.touchAction="none"},Vn.prototype.export=function(e){return Promise.resolve()},Vn.prototype.extractElement=function(e,t){return this._memoryManager.extractGenericElement(e,t,this._scales)},Vn.prototype._compareDimensions=function(e,t,n){return(e!==this._width||t!==this._height||n!==this._pixelRatio)&&(this._width=e,this._height=t,this._pixelRatio=n,!0)},Vn.prototype._compareView=function(e,t,n,i){return(e!==this._viewX||t!==this._viewY||n!==this._viewZoom||i!==this._viewAngle)&&(this._viewX=e,this._viewY=t,this._viewZoom=n,this._viewAngle=i,this._viewAngleCos=Math.cos(i),this._viewAngleSin=Math.sin(i),!0)},Vn.prototype._compareCurrentTime=function(e){return e!==this._currentTime&&(this._currentTime=e,!0)},Vn.prototype._compareBackgroundColor=function(e,t){return(e!==this._backgroundColor||t!==this._renderBackground)&&(this._renderBackground=t,this._backgroundColor=e,this._backgroundRgba=this._colorManager.parseColor(this._backgroundColor),!0)},Vn.prototype._compareShapes=function(){return this._shapesVersion!==this._shapeManager.getVersion()&&(this._shapesVersion=this._shapeManager.getVersion(),!0)},Vn.prototype._comparePatterns=function(){return this._patternsVersion!==this._patternManager.getVersion()&&(this._patternsVersion=this._patternManager.getVersion(),!0)},Vn.prototype._compareBoundaries=function(){return this._boundariesVersion!==this._boundariesManager.getVersion()&&(this._boundariesVersion=this._boundariesManager.getVersion(),!0)},Vn.prototype._compareTexts=function(){return this._textsVersion!==this._textManager.getVersion()&&(this._textsVersion=this._textManager.getVersion(),!0)},Vn.prototype._compareIsDisplayableBuffer=function(e){return this._isBufferDisplayable!==e&&(this._isBufferDisplayable=e,!0)},Vn.prototype._compareHideImages=function(e){return this._hideImages!==e&&(this._hideImages=e,!0)},Vn.prototype.renderFrame=function(e){var t=e.x,n=e.y,i=e.zoom,r=e.angle,o=e.width,a=e.height,s=e.pixelRatio,l=e.backgroundColor,u=e.currentTime,d=e.isBufferDisplayable,c=e.hideImages,h=e.renderBackground,p=this._compareShapes(),g=this._comparePatterns(),m=this._compareBoundaries(),b=this._compareTexts(),v=this._compareDimensions(o,a,s),y=this._compareView(t,n,i,r),E=this._compareCurrentTime(u),S=this._compareBackgroundColor(l,h),w=this._compareIsDisplayableBuffer(d),M=this._compareHideImages(c);if(m){var O=this._boundariesManager,F=this._scales;F.bytesToActualCoord=1,F.bytesToActualScaledSize=O.maxScaledSize/65535,F.bytesToActualMinVisibleSize=O.maxMinVisibleSize/15,F.bytesToActualSymbolicSize=O.maxSymbolicSize/255,F.bytesToActualDashLength=O.maxDashLength/3,F.bytesToActualGapLength=O.maxGapLength/3,F.bytesToActualPatternScale=O.maxPatternScale/255}this._firstFrame&&this._beforeFirstFrame(),this._render({shapesChanged:p,patternsChanged:g,boundariesChanged:m,textsChanged:b,dimensionsChanged:v,viewChanged:y,currentTimeChanged:E,backgroundColorChanged:S,isBufferDisplayableChanged:w,isHideImagesChanged:M}),this._firstFrame&&(this._afterFirstFrame(),this._firstFrame=!1)},Vn.prototype._render=function(e){},Vn.prototype._beforeFirstFrame=function(){},Vn.prototype._afterFirstFrame=function(){},Vn.prototype.destroy=function(){},Vn.prototype.ensureAnimationsReady=function(){},Vn.prototype.getImageData=function(){return null},Vn.prototype.setViewportClipping=function(e){},Vn);function Vn(e){var t=e.bufferList,n=e.patternManager,i=e.boundariesManager,r=e.colorManager,o=e.shapeManager,a=e.textManager,s=e.easingManager,l=e.memoryManager;this._firstFrame=!0,this._width=0,this._height=0,this._pixelRatio=0,this._viewX=0,this._viewY=0,this._viewZoom=0,this._viewAngle=0,this._viewAngleCos=0,this._viewAngleSin=0,this._currentTime=0,this._scales={bytesToActualCoord:0,bytesToActualScaledSize:0,bytesToActualMinVisibleSize:0,bytesToActualSymbolicSize:0,bytesToActualDashLength:0,bytesToActualGapLength:0,bytesToActualPatternScale:0},this._shapesVersion=0,this._patternsVersion=0,this._boundariesVersion=0,this._textsVersion=0,this._backgroundColor=null,this._backgroundRgba=[1,1,1,0],this._renderBackground=!1,this._isBufferDisplayable=null,this._hideImages=!1,this._genericObject={valid:!1,id:void 0,end:{pieceId:0,shape:"circle",x1:0,y1:0,x2:0,y2:0,rectWidthOrSourceRadiusScaled:0,rectWidthOrSourceRadiusFixed:0,rectHeightOrTargetRadiusScaled:0,rectHeightOrTargetRadiusFixed:0,thicknessOrFontSizeScaled:0,thicknessOrFontSizeFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,offsetScaled:0,offsetFixed:0,pattern:{id:void 0,type:0,attributes:{}},opacity:1,fillColor:null,strokeColor:null,patternColor:null,globalMinVisibleSize:0,strokeMinVisibleSize:0,patternMinVisibleSize:0,offsetAngle:0,patternScale:0,symbolicSize:-1,curvature:0,dashLength:0,gapLength:0,hasHead:!1,hasTail:!1,isBodyTriangle:!1,isSelfLoop:!1,isText:!1,adjustTextAngle:!1,unusedFlag1:!1,unusedFlag2:!1,unusedFlag3:!1},start:{pieceId:0,shape:"circle",x1:0,y1:0,x2:0,y2:0,rectWidthOrSourceRadiusScaled:0,rectWidthOrSourceRadiusFixed:0,rectHeightOrTargetRadiusScaled:0,rectHeightOrTargetRadiusFixed:0,thicknessOrFontSizeScaled:0,thicknessOrFontSizeFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,offsetScaled:0,offsetFixed:0,pattern:{id:void 0,type:0,attributes:{}},opacity:1,fillColor:null,strokeColor:null,patternColor:null,globalMinVisibleSize:0,strokeMinVisibleSize:0,patternMinVisibleSize:0,offsetAngle:0,patternScale:0,symbolicSize:-1,curvature:0,dashLength:0,gapLength:0,hasHead:!1,hasTail:!1,isBodyTriangle:!1,isSelfLoop:!1,isText:!1,adjustTextAngle:!1,unusedFlag1:!1,unusedFlag2:!1,unusedFlag3:!1},animation:{duration:0,beginTime:-1,easing:"linear"}},this._littleEndian=fr(),this._bufferList=t,this._shapeManager=o,this._patternManager=n,this._boundariesManager=i,this._textManager=a,this._colorManager=r,this._easingManager=s,this._memoryManager=l}var ca,Ss,Td="#define D3D9_FIX 0\n#define ANIMATED 0\nprecision highp float;\nprecision mediump int;\nattribute /*ushort*/ vec4 a_final_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature;\nattribute /*ushort*/ vec4 a_final_patternId_fillRGBA_strokeRGBA_patternRGBA;\nattribute /*float*/ vec4 a_final_x1_y1_x2_y2;\nattribute /*ushort*/ vec4 a_final_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed;\nattribute /*ushort*/ vec4 a_final_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed;\nattribute /*ushort*/ vec2 a_final_offsetScaled_offsetFixed;\nattribute /*ushort*/ vec4 a_prev_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature;\nattribute /*ushort*/ vec4 a_prev_patternId_fillRGBA_strokeRGBA_patternRGBA;\nattribute /*float*/ vec4 a_prev_x1_y1_x2_y2;\nattribute /*ushort*/ vec4 a_prev_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed;\nattribute /*ushort*/ vec4 a_prev_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed;\nattribute /*ushort*/ vec2 a_prev_offsetScaled_offsetFixed;\nattribute /*float*/ vec2 a_animationBeginTime_animationDuration; \nattribute /*ushort*/ vec4 a_animationEasing; \nattribute /*ushort*/ vec2 a_text_charId_charOffsetXY; \nattribute vec3 a_vertexInfo;\nuniform float u_viewWidth;\nuniform float u_viewHeight;\nuniform float u_viewX;\nuniform float u_viewY;\nuniform float u_viewAngle;\nuniform float u_viewZoom;\nuniform float u_currentTime;\nuniform float u_pixelRatio;\nuniform sampler2D u_patternInfoTexture;\nvarying vec4 a;\nvarying vec4 b;\nvarying vec4 c;\nvarying vec2 d;\nvarying vec2 e;\n#if D3D9_FIX\nvarying vec4 f;\nvarying vec3 g;\nvarying vec4 h;\nvarying vec4 i;\n#else\nvarying float j;\nvarying vec2 k;\nvarying vec2 l;\nvarying vec2 m;\nvarying float n;\nvarying float o;\nvarying vec2 p;\nvarying vec2 q;\nvarying float r;\nvarying float s;\n#endif\nconst float EPSILON = 0.000001;\nconst float INFINITY = 10000000.0;\nconst float PI = 3.14159265359;\nconst float P2_12 = 4096.0;\nconst float P2_8 = 256.0;\nconst float P2_7 = 128.0;\nconst float P2_6 = 64.0;\nconst float P2_5 = 32.0;\nconst float P2_4 = 16.0;\nconst float P2_3 = 8.0;\nconst float P2_2 = 4.0;\nconst float P2_1 = 2.0;\nuniform float BYTES_TO_COORD;\nuniform float BYTES_TO_SCALED_SIZE;\nuniform float BYTES_TO_MIN_VISIBLE_SIZE;\nuniform float BYTES_TO_SYMBOLIC_SIZE;\nuniform float BYTES_TO_CURVATURE;\nuniform float BYTES_TO_DASH_LENGTH;\nuniform float BYTES_TO_GAP_LENGTH;\nuniform float BYTES_TO_PATTERN_SCALE;\nuniform float PATTERN_POSITION_GRANULARITY;\nuniform float PATTERN_INFO_TEXTURE_SIZE;\nuniform float PATTERN_NEAREST_TEXTURE_SIZE;\nuniform float PATTERN_LINEAR_TEXTURE_SIZE;\nuniform float PATTERN_LINEAR_SDF_TEXTURE_SIZE;\nuniform float PATTERN_MIPMAP_TEXTURE_SIZE;\nconst float BYTES_TO_OFFSET_ANGLE = 0.0;\nconst float BYTES_TO_COLOR = 0.0;\nconst float SDF_FONT_SIZE = 0.0;\nconst float CURVATURE_RATIO = 0.0;\nconst float PATTERN_MARGIN = 0.0;\nconst float TEXT_WIDTH_MULTIPLIER = 0.0;\nconst float TEXT_HEIGHT_MULTIPLIER = 0.0;\nconst float SELF_LOOP_CURVATURE_MULTIPLIER = 0.0;\nconst float EDGE_ARROW_SIZE_RATIO = 0.0;\nconst float NB_PIECES_PER_CURVE = 0.0;\nconst float PIECE_NODE_COMPONENT = 0.0;\nconst float PIECE_EDGE_BODY = 0.0;\nconst float PIECE_EDGE_HEAD = 0.0;\nconst float PIECE_EDGE_TAIL = 0.0;\nconst float PIECE_EDGE_TEXT = 0.0;\nconst float MAX_TEXT_SIZE = 0.0;\nconst float BYTES_TO_TEXT_OFFSET = 0.0;\nconst float FILTER_NEAREST = 0.0;\nconst float FILTER_LINEAR = 0.0;\nconst float FILTER_LINEAR_SDF = 0.0;\nconst float FILTER_MIPMAP = 0.0;\nconst float SHAPE_TEXTURE_SIZE = 0.0;\nconst float SIMPLE_SHAPE_SAMPLING_SIZE = 0.0;\nconst float COMPLEX_SHAPE_SAMPLING_SIZE = 0.0;\nconst float SHAPE_SAMPLING_BUFFER_RATIO = 0.0;\nconst float MAX_NB_SHAPES = 0.0;\nconst float FIRST_COMPLEX_SHAPE_ID = 0.0;\nconst float SELF_LOOP_TO_CIRCLE_APPROX = 0.0;\nconst float NB_SHAPES_BY_SIDE = SHAPE_TEXTURE_SIZE / COMPLEX_SHAPE_SAMPLING_SIZE;\nconst float SHAPE_FILL_PERCENT = 1.0 - SHAPE_SAMPLING_BUFFER_RATIO;\nconst float T_STEP_PER_CURVE_PIECE = 1.0 / NB_PIECES_PER_CURVE;\nconst float HEAD_TAIL_PX_ADJUST = 1.5;\nstruct ne {\nfloat nf;\nfloat ng;\nfloat nh;\nfloat ni;\nfloat nj;\nfloat nk;\nfloat nl;\nfloat nm;\n};\nstruct nn {\nfloat no;\nfloat np;\nfloat nq;\nfloat nr;\nfloat ns;\nfloat nt;\nfloat nu;\n};\nstruct nv {\nfloat nf;\nfloat ng;\nfloat nh;\nfloat ni;\nfloat nj;\nfloat nk;\nfloat nl;\nfloat nm;\nfloat no;\nfloat np;\nfloat nq;\nfloat nr;\nfloat ns;\nfloat nt;\nfloat nu;\nfloat bu;\nfloat nw;\nfloat nx;\nfloat ny;\nfloat nz;\nfloat oa;\nfloat ob;\nvec4 az;\nvec4 ba;\nvec4 bl;\nfloat oc;\nfloat od;\nfloat oe;\nfloat of;\nfloat og;\nfloat oh;\nfloat oi;\nfloat oj;\nfloat ok;\nfloat ol;\nfloat om;\nfloat on;\nfloat oo;\nfloat op;\nfloat oq;\nfloat or;\nfloat os;\n};\nstruct ot {\nfloat ou;\nvec2 ov;\nvec4 az;\nvec4 ba;\nfloat bu;\nfloat ow;\nfloat ox;\nfloat nh;\nfloat oy;\nvec2 oz;\nfloat pa;\nvec2 bb;\nvec2 pb;\nvec2 pc;\nfloat pd;\nfloat pe;\nvec4 bl;\nvec2 pf;\nfloat pg;\nfloat ph;\nvec2 pi;\nvec2 pj;\nvec2 pk;\n};\nfloat pl(float lh, float pm, float pn) {\nfloat po = mod(lh, pow(2.0, pn));\nreturn floor(po / pow(2.0, pm));\n}\nne pp(float lh) {\nne pq;\npq.nf = pl(lh, 0.0, 4.0);\npq.ng = pl(lh, 4.0, 8.0);\npq.nh = pl(lh, 8.0, 10.0);\npq.ni = pl(lh, 10.0, 12.0);\npq.nj = pl(lh, 12.0, 13.0);\npq.nk = pl(lh, 13.0, 14.0);\npq.nl = pl(lh, 14.0, 15.0);\npq.nm = pl(lh, 15.0, 16.0);\nreturn pq;\n}\nnn pr(float lh) {\nnn pq;\npq.no = pl(lh, 0.0, 8.0);\npq.np = pl(lh, 8.0, 11.0);\npq.nq = pl(lh, 11.0, 12.0);\npq.nr = pl(lh, 12.0, 13.0);\npq.ns = pl(lh, 13.0, 14.0);\npq.nt = pl(lh, 14.0, 15.0);\npq.nu = pl(lh, 15.0, 16.0);\nreturn pq;\n}\nvec4 ps(in float lh) {\nreturn vec4(\npl(lh, 0.0, 4.0),\npl(lh, 4.0, 8.0),\npl(lh, 8.0, 12.0),\npl(lh, 12.0, 16.0)\n);\n}\nvec2 pt(in float lh) {\nreturn vec2(mod(lh, 256.0), floor(lh / 256.0));\n}\nvec2 pu(in float lh) {\nfloat pv = floor(lh / P2_6);\nfloat pw = lh - (pv * P2_6);\nreturn vec2(pv, pw);\n}\nvec2 px(in float lh) {\nfloat py = floor(lh / P2_7);\nfloat pz = lh - (py * P2_7);\nreturn vec2(py, pz);\n}\nvec2 qa(in vec2 qb, in float qc) {\nfloat qd = cos(qc);\nfloat qe = sin(qc);\nreturn vec2(qd * qb.x + qe * qb.y, -qe * qb.x + qd * qb.y);\n}\nvec4 qf(in vec4 qg) {\nreturn floor(qg / 256.0) - 128.0;\n}\nvec4 qh(in vec4 qg) {\nreturn mod(qg, 256.0) - 128.0;\n}\nfloat qi(float lh) {\nreturn lh - 128.0;\n}\nvec2 qi(vec2 lh) {\nreturn lh - 128.0;\n}\nvec2 qj(vec2 qk) {\nreturn vec2(-qk.y, qk.x);\n}\nvec2 ql(vec2 qm, vec2 fn, vec2 qn, float t) {\nfloat qo = 1.0 - t;\nreturn (qo * qo * qm) + (2.0 * qo * t * fn) + (t * t * qn);\n}\nvec2 qp(vec2 qm, vec2 qq, vec2 qr, vec2 qn, float t) {\nfloat qo = 1.0 - t;\nfloat qs = qo * qo;\nfloat qt = qs * qo;\nfloat qu = t * t;\nfloat qv = qu * t;\nreturn (qt * qm) + (3.0 * qs * t * qq) + (3.0 * qo * qu * qr) + (qv * qn);\n}\nvec2 qw(vec2 qm, vec2 fn, vec2 qn, float t) {\nfloat qo = (1.0 - t);\nvec2 qb = (qo * fn + t * qn) - (qo * qm + t * fn);\nreturn normalize(qb);\n}\nvec2 qx(vec2 qm, vec2 fn, vec2 qn, float t) {\nreturn qj(qw(qm, fn, qn, t));\n}\nvec2 qy(vec2 qm, vec2 qq, vec2 qr, vec2 qn, float t) {\nfloat qo = 1.0 - t;\nfloat qs = qo * qo;\nfloat qu = t * t;\nvec2 qb = qs * (qq - qm) + 2.0 * qo * t * (qr - qq) + qu * (qn - qr);\nreturn normalize(qb);\n}\nvec2 qz(vec2 qm, vec2 qq, vec2 qr, vec2 qn, float t) {\nreturn qj(qy(qm, qq, qr, qn, t));\n}\nfloat rk(float oa, float rl, float t) {\nfloat y = abs(oa) / CURVATURE_RATIO + EPSILON;\nfloat of = y * y;\nfloat qo = t - 0.5;\nfloat qs = qo * qo;\nfloat rm = 1.0 / (16.0 * of);\nfloat rn = sqrt(qs + rm);\nfloat ro = (0.5 / y) * sqrt(of + 0.25);\nfloat rp = (abs(2.0 * y)) * ((qo * rn) + (0.5 * ro) + (rm * log(abs((qo + rn) / (-0.5 + ro)))));\nreturn rp * rl;\n}\nfloat rq(vec2 qm, vec2 rr, vec2 rs, vec2 qn, float rt) {\nvec2 pf = (qm + rr + rs) / 3.0;\nvec2 ru = pf - rr;\nvec2 rv = rr - rs;\nfloat rw = dot(ru, ru);\nfloat rx = dot(rv, rv) / 4.0;\nfloat sf = sqrt(rw - rx) * SELF_LOOP_TO_CIRCLE_APPROX * 1.55;\nreturn 2.0 * PI * sf * rt;\n}\nfloat sg(float lh) {\nreturn lh - 32.0;\n}\nfloat sh(float lh) {\nreturn lh - 512.0;\n}\nfloat si(float lh) {\nreturn lh - 32768.0;\n}\nvoid sj() {\ngl_Position = vec4(-10.0, -10.0, 1.0, 1.0);\n}\nvec4 sk(vec2 sl) {\nreturn vec4(((vec2(sl.x, u_viewHeight - sl.y) / vec2(u_viewWidth, u_viewHeight)) * 2.0 - 1.0), 0.5, 1.0);\n}\nfloat sp(float ap, float aq) {\nreturn step(ap - EPSILON, aq) * step(aq, ap + EPSILON);\n}\nbool ao(float ap, float aq) {\nreturn abs(ap - aq) < EPSILON;\n}\nbool sq(float lh) {\nreturn lh > 0.5;\n}\nvec2 sr(vec2 ss) {\nreturn qa((ss - vec2(u_viewX, u_viewY)) * u_viewZoom, u_viewAngle) + vec2(u_viewWidth, u_viewHeight) / 2.0;\n}\nfloat st(float ph) {\nreturn ph * EDGE_ARROW_SIZE_RATIO;\n}\nfloat su(float sv, float sw) {\nreturn sv * BYTES_TO_SCALED_SIZE * u_viewZoom + sw;\n}\nfloat tc(float ow, float ta, float tb) {\nfloat td = tb - ta;\nfloat a = 1.0 / td;\nfloat b = -ta / td;\nreturn ow * a + b;\n}\nstruct te {\nvec2 tf;\nvec2 tg;\n};\nte th(vec2 ti, float sf, float oa) {\nte lj;\nfloat tj = (sf + sf / SELF_LOOP_CURVATURE_MULTIPLIER * oa) * SELF_LOOP_CURVATURE_MULTIPLIER;\nfloat tk = -u_viewAngle + PI;\nfloat tl = -u_viewAngle + PI / 2.0;\nlj.tf = ti + vec2(cos(tk), sin(tk)) * tj;\nlj.tg = ti + vec2(cos(tl), sin(tl)) * tj;\nreturn lj;\n}\nfloat tq(vec2 tr, vec2 rr, vec2 rs, vec2 ts, float tt) {\nvec2 tu = tr;\nfloat t = 0.0;\nfloat tv = 0.0;\nfloat tw = rq(tr, rr, rs, ts, 1.0);\nreturn tt / tw;\n}\nnv tx(\nvec4 ty,\nvec4 tz,\nvec4 ua,\nvec4 ub,\nvec4 uc,\nvec2 ud,\nvec2 ue\n) {\nnv a;\nne av = pp(ty.x);\nnn uf = pr(ty.y);\nvec4 ug = ps(ty.z);\nvec2 uh = pt(ty.w);\nvec2 ui = pu(ue.y);\na.nf = av.nf;\na.ng = av.ng;\na.nh = av.nh;\na.ni = av.ni;\na.nj = av.nj;\na.nk = av.nk;\na.nl = av.nl;\na.nm = av.nm;\na.no = uf.no;\na.np = uf.np;\na.nq = uf.nq;\na.nr = uf.nr;\na.ns = uf.ns;\na.nt = uf.nt;\na.nu = uf.nu;\na.bu = ug.x;\na.nw = ug.y;\na.nx = ug.z;\na.ny = ug.w;\na.nz = uh.x;\na.oa = uh.y;\na.ob = tz.x;\na.az = ps(tz.y);\na.ba = ps(tz.z);\na.bl = ps(tz.w);\na.oc = ua.x;\na.od = ua.y;\na.oe = ua.z;\na.of = ua.w;\na.og = ub.x;\na.oh = ub.y;\na.oi = ub.z;\na.oj = ub.w;\na.ok = uc.x;\na.ol = uc.y;\na.om = uc.z;\na.on = uc.w;\na.oo = ud.x;\na.op = ud.y;\na.oq = ue.x;\na.or = sh(ui.x);\na.os = sg(ui.y);\nreturn a;\n}\nbool uu(const in nv a, out ot lj) {\nfloat nf = a.nf;\nfloat ng = a.ng;\nfloat nh = a.nh * BYTES_TO_DASH_LENGTH;\nfloat ni = a.ni * BYTES_TO_GAP_LENGTH;\nfloat nj = a.nj;\nfloat nk = a.nk;\nfloat nl = a.nl;\nfloat nm = a.nm;\nfloat no = a.no * BYTES_TO_PATTERN_SCALE;\nfloat np = a.np * BYTES_TO_OFFSET_ANGLE;\nfloat nq = a.nq;\nfloat nr = a.nr;\nfloat ns = a.ns;\nfloat nt = a.nt;\nfloat nu = a.nu;\nfloat bu = a.bu * BYTES_TO_COLOR;\nfloat nw = a.nw * BYTES_TO_MIN_VISIBLE_SIZE - EPSILON;\nfloat nx = a.nx * BYTES_TO_MIN_VISIBLE_SIZE - EPSILON;\nfloat ny = a.ny * BYTES_TO_MIN_VISIBLE_SIZE - EPSILON;\nfloat nz = a.nz * BYTES_TO_SYMBOLIC_SIZE * u_viewZoom + step(a.nz, EPSILON) * INFINITY;\nfloat oa = qi(a.oa);\nfloat ob = a.ob;\nvec4 az = a.az * BYTES_TO_COLOR;\nvec4 ba = a.ba * BYTES_TO_COLOR;\nvec4 bl = a.bl * BYTES_TO_COLOR;\nvec2 uv = vec2(a.oc, a.od) * BYTES_TO_COORD;\nvec2 uw = vec2(a.oe, a.of) * BYTES_TO_COORD;\nvec2 tr = sr(uv);\nvec2 ts = sr(uw);\nfloat ux = su(a.og, a.oh);\nfloat uy = su(a.oi, a.oj);\nfloat uz = su(a.ok, a.ol);\nfloat ou = su(a.om, a.on);\nfloat va = su(a.oo, a.op);\nvec2 vb = a_vertexInfo.xy;\nvec2 vc = vec2(0.0, 0.0);\nfloat vd = ux;\nfloat ve = uy;\nfloat vf = uy * no;\nif (nq > EPSILON) {\nif (a.oq < EPSILON) {\nreturn false;\n}\nvf = uz;\nob = a.oq;\nux = vf * TEXT_WIDTH_MULTIPLIER * u_pixelRatio;\nuy = vf * TEXT_HEIGHT_MULTIPLIER * u_pixelRatio;\n}\nbool vz = abs(oa) > EPSILON && sp(ng, PIECE_EDGE_BODY) < EPSILON;\nbool wa = vz && a_vertexInfo.z > EPSILON;\nif (nf < EPSILON || ng < EPSILON || nz < nw || wa) {\nreturn false;\n}\nou *= step(nx, nz);\nfloat wo = 0.0;\nfloat wp = 1.0;\nfloat wl = 0.0;\nfloat wn = 1.0;\nfloat wq = 0.0;\nfloat xa = 1.0;\nfloat xc = 1.0;\nfloat xn = 0.0;\nfloat xo = 0.0;\nvec2 pf;\nvec2 pi;\nvec2 pj;\nvec2 pk;\nfloat ph;\nfloat pg;\nfloat yh = 0.0;\nfloat yi = 1.0;\nif (sp(ng, PIECE_NODE_COMPONENT) > EPSILON) {\npf = ceil((tr + ts) / 2.0);\npi = normalize(vec2(uw.x - uv.x + 0.001, uv.y - uw.y));\npj = qj(pi);\npk = pj;\nph = ux;\npg = uy;\n} else {\nxc = 0.0;\nfloat yy = distance(tr, ts);\nvec2 yz = normalize(ts - tr);\nvec2 za = (tr + ts) / 2.0;\nvec2 zb = qj(yz);\nvec2 zc = za + (zb * yy * -oa / CURVATURE_RATIO);\nif (sp(ng, PIECE_EDGE_TEXT) > 0.0) {\nfloat zd;\nfloat ze = ou;\nou = 0.0;\nif (nm > EPSILON) {\nte fn = th(tr, ze / 2.0, oa);\npf = qp(tr, fn.tf, fn.tg, ts, 0.5);\npi = qy(tr, fn.tf, fn.tg, ts, 0.5);\npj = qj(pi);\npk = pj;\nzd = rq(tr, fn.tf, fn.tg, ts, 0.5);\n} else if (abs(oa) > EPSILON) {\npf = ql(tr, zc, ts, 0.5);\npi = qw(tr, zc, ts, 0.5);\npj = qj(pi);\npk = pj;\nzd = rk(oa, yy, 1.0);\n} else {\npf = za;\npi = yz;\npj = zb;\npk = zb;\nzd = yy;\n}\nph = ux;\npg = uy;\nif (nr > EPSILON && nm < EPSILON && vd > zd - ze) {\npi = vec2(1.0, 0.0);\npj = vec2(0.0, 1.0);\npk = vec2(0.0, 1.0);\n} else {\nfloat qc = -atan(pi.y, pi.x);\nyh = qc;\nnp -= qc;\nif ((qc > PI / 2.0 || qc < -PI / 2.0)) {\nnp += (1.0 - nm) * PI;\nyi = -1.0;\npi *= -1.0;\npj *= -1.0;\npk *= -1.0;\n}\n}\n} else {\nfloat xg = uz;\nfloat zm = ux;\nfloat zn = uy;\nfloat zo = nj + nk;\nfloat zp = st(xg);\nfloat zq = nj * zp;\nfloat zr = nk * zp;\nfloat zs = sp(ng, PIECE_EDGE_HEAD);\nfloat zt = sp(ng, PIECE_EDGE_TAIL);\nfloat zu = INFINITY * nm + yy - zm - zn;\nfloat zv = min(zu / zo, zp);\nfloat aae =\nnk * (zp + max(zm + zv - zr, 0.0))\n+ (1.0 - nk) * nl * zm;\nfloat aaf =\nnj * (zp + max(zn + zv - zq, 0.0))\n+ (1.0 - nj) * nl * zn;\nif (zs > EPSILON || zt > EPSILON) {\nvec2 aai = zs * ts + zt * tr;\nfloat va = zs * aaf + zt * aae + (HEAD_TAIL_PX_ADJUST - 0.5);\nfloat aaj = zs * zq + zt * zr;\nvec2 aak;\nif (nm > EPSILON) {\nte fn = th(tr, zm, oa);\nfloat zd = rq(tr, fn.tf, fn.tg, ts, 1.0);\nfloat tt = zs * (zd - aaf) + zt * aae;\nfloat t = tq(tr, fn.tf, fn.tg, ts, tt);\naak = qp(tr, fn.tf, fn.tg, ts, t);\n} else {\nfloat zd = rk(oa, yy, 1.0);\nfloat t = (zs * (zd - aaf) + zt * aae) / zd;\naak = ql(tr, zc, ts, t);\n}\npi = normalize(aai - aak);\npj = qj(pi);\npk = pj;\npf = aai - pi * (va - aaj / 2.0);\nph = aaj;\npg = aaj;\nnh = 0.0;\nni = 0.0;\n} else {\nfloat aao;\nfloat aap;\nfloat aaq;\nif (abs(oa) < EPSILON) {\npf = za;\npi = yz;\npj = zb;\npk = pj;\nph = yy;\naao = yy;\naap = 0.0;\naaq = yy;\n} else {\nfloat aas = a_vertexInfo.z;\nfloat aat = aas * T_STEP_PER_CURVE_PIECE;\nfloat qu = aat + T_STEP_PER_CURVE_PIECE;\nif (nm < EPSILON) {\nvec2 aau = ql(tr, zc, ts, aat);\nvec2 aav = ql(tr, zc, ts, qu);\npf = (aau + aav) / 2.0;\npi = normalize(aav - aau);\npj = qx(tr, zc, ts, aat);\npk = qx(tr, zc, ts, qu);\nph = distance(aau, aav);\naao = rk(oa, yy, 1.0);\naap = rk(oa, yy, aat);\naaq = rk(oa, yy, qu);\n} else {\nte fn = th(tr, zm, oa);\nvec2 rr = fn.tf;\nvec2 rs = fn.tg;\nvec2 aau = qp(tr, rr, rs, ts, aat);\nvec2 aav = qp(tr, rr, rs, ts, qu);\npf = (aau + aav) / 2.0;\npi = normalize(aav - aau);\npj = qz(tr, rr, rs, ts, aat);\npk = qz(tr, rr, rs, ts, qu);\nph = distance(aau, aav);\naao = rq(tr, rr, rs, ts, 1.0);\naap = rq(tr, rr, rs, ts, aat);\naaq = rq(tr, rr, rs, ts, qu);\n}\n}\npg = uz;\nwl = (aae - 1.0) / aao;\nwn = 1.0 - (aaf - HEAD_TAIL_PX_ADJUST) / aao;\nwo = aap / aao;\nwp = aaq / aao;\nwq = aao;\nif (nl > 0.0 && zu > 5.0) {\nfloat abb = (aao * pg) / (aao - aae);\nfloat tw = aao;\nfloat oc = aae;\nfloat oe = aao - aaf;\nfloat a = -abb / tw;\nfloat b = abb;\nfloat od = a * oc + b;\nfloat of = a * oe + b;\nfloat abc = od / (oc - oe);\nfloat abd = -abc * oe;\npg = abd;\nxo = abc * tw + abd + 1.0;\n}\n}\n}\n}\nvec2 bb = vec2(0.0, 0.0);\nvec2 pb = vec2(EPSILON, EPSILON);\nvec2 pc = vec2(-EPSILON, -EPSILON);\nfloat pd = -1.0;\nfloat pe = 0.0;\nbool abe = false;\nif (ob > EPSILON && nz > ny) {\nfloat abf = floor(ob / PATTERN_INFO_TEXTURE_SIZE);\nfloat abg = ob - (abf * PATTERN_INFO_TEXTURE_SIZE);\nvec4 abh = texture2D(u_patternInfoTexture, vec2(abg, abf) / 255.0) * 255.0;\nvec2 abi = px(abh.z);\nvec2 abj = px(abh.w);\npd = abi.x * 2.0 + abj.x;\nfloat abk = 0.0;\nif (ao(pd, FILTER_NEAREST)) {\nabk = PATTERN_NEAREST_TEXTURE_SIZE;\n} else if (ao(pd, FILTER_LINEAR)) {\nabk = PATTERN_LINEAR_TEXTURE_SIZE;\n} else if (ao(pd, FILTER_LINEAR_SDF)) {\nabk = PATTERN_LINEAR_SDF_TEXTURE_SIZE;\nabe = true;\n} else if (ao(pd, FILTER_MIPMAP)) {\nabk = PATTERN_MIPMAP_TEXTURE_SIZE;\n}\nfloat abl = 1.0 / abk;\nvec2 abm = (vec2(abi.y, abj.y) * PATTERN_POSITION_GRANULARITY) * abl / 2.0;\nvec2 abn = (abh.xy * PATTERN_POSITION_GRANULARITY * abl) + abm;\nabn += PATTERN_MARGIN * abl;\nabm -= PATTERN_MARGIN * abl * 2.0;\nvec2 abo = vec2(ph / 2.0, pg / 2.0) * abl;\nvec2 abp = vec2(ou, ou) * abl;\nfloat abq = 1.0 * u_pixelRatio;\nif (no > EPSILON) {\nif (abe) {\npe = 2.0 / vf;\nabq = SDF_FONT_SIZE / vf;\n} else {\nabq = (abm.y / abo.y) / no;\n}\n}\nvec2 abr = (abo + abp) * abq;\nabm += PATTERN_MARGIN * abl;\nbb = abn + abr * vb;\npb = abn - abm;\npc = abn + abm;\n}\nif (nq > EPSILON) {\nvc.y = a.os * vf / 2.0 - 1.0;\nxa = 0.0;\nxc = 0.0;\nif (abe) {\nvc.x = ceil(a.or * BYTES_TO_TEXT_OFFSET * vf);\n} else {\nvc.x = floor(a.or);\n}\nvc += vec2(1.0, 1.0);\nvc = qa(vc, yh);\nvc *= yi;\n}\nvec2 abu = vec2(cos(np), sin(np)) * va;\nvec2 abv = pf + abu + vc;\nif (nq > EPSILON && sp(ng, PIECE_NODE_COMPONENT) > EPSILON) {\nabv = ceil(abv);\n}\nfloat abw = ou * 2.0;\nfloat abx = ph + xc * (abw + 1.0);\nfloat aby = pg + xa * (abw + 1.0);\nvec2 abz = pi * abx / 2.0;\nvec2 aca = pj * aby / 2.0;\nvec2 acb = pk * aby / 2.0;\nfloat acc = (wp - wo);\nfloat acd = vb.x / 2.0 + 0.5;\nfloat ow = wo + acc * acd;\nfloat pa = xn + (xo - xn) * ow / 2.0;\nfloat ace = step(nf, FIRST_COMPLEX_SHAPE_ID - EPSILON);\nfloat acf = ace * SIMPLE_SHAPE_SAMPLING_SIZE + (1.0 - ace) * COMPLEX_SHAPE_SAMPLING_SIZE;\nfloat acg = acf / COMPLEX_SHAPE_SAMPLING_SIZE;\nfloat ach = acg * SHAPE_SAMPLING_BUFFER_RATIO / 2.0;\nfloat aci = acg * (1.0 - SHAPE_SAMPLING_BUFFER_RATIO);\nvec2 acr = vec2(mod(nf, NB_SHAPES_BY_SIDE), floor(nf / NB_SHAPES_BY_SIDE));\nvec2 acs = acr + vec2(ach) + vec2(wo * aci, 0.0);\nvec2 acv = vec2(acc, 1.0) * aci;\nvec2 ov = (acs + acv * (vb / 2.0 + 0.5)) / NB_SHAPES_BY_SIDE;\nvec2 oz = vec2(abx / acc, aby) / 2.0;\nfloat adc = nh * uz;\nfloat add = ni * uz;\nfloat ox = adc + add;\nfloat oy = (ow * wq) / ox;\nlj.ov = ov;\nlj.oz = oz;\nlj.ou = ou;\nlj.az = az;\nlj.ba = ba;\nlj.bu = bu;\nlj.ow = tc(ow, wl, wn);\nlj.ox = ox;\nlj.nh = adc;\nlj.oy = oy;\nlj.pa = pa;\nlj.bb = bb;\nlj.pb = pb;\nlj.pc = pc;\nlj.pd = pd;\nlj.pe = pe;\nlj.bl = bl;\nlj.pf = abv;\nlj.ph = abx;\nlj.pg = aby;\nlj.pi = pi;\nlj.pj = pj;\nlj.pk = pk;\nreturn true;\n}\nfloat ade(float adf, float adg, vec4 adh) {\nfloat adi = clamp(((u_currentTime - adf) / adg), 0.0, 1.0);\nfloat r = adi;\nfloat adj = r * r;\nfloat adk = adj * r;\nvec4 adl = adi < 0.5 ? qf(adh) : qh(adh);\nfloat adm = adl.x;\nfloat adn = adl.y;\nfloat ado = adl.z;\nfloat adp = adl.w;\nfloat adq = adm + adn * r + ado * adj + adp * adk;\nreturn adq;\n}\nvoid main() {\nnv a_final = tx(\na_final_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature,\na_final_patternId_fillRGBA_strokeRGBA_patternRGBA,\na_final_x1_y1_x2_y2,\na_final_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed,\na_final_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed,\na_final_offsetScaled_offsetFixed,\na_text_charId_charOffsetXY\n);\n#if ANIMATED\nfloat adf = a_animationBeginTime_animationDuration.x;\nfloat adg = a_animationBeginTime_animationDuration.y;\nvec4 adh = a_animationEasing;\nfloat ut = ade(adf, adg, adh);\nnv a_prev = tx(\na_prev_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature,\na_prev_patternId_fillRGBA_strokeRGBA_patternRGBA,\na_prev_x1_y1_x2_y2,\na_prev_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed,\na_prev_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed,\na_prev_offsetScaled_offsetFixed,\na_text_charId_charOffsetXY\n);\nconst float ONE = 1.0;\na_final.nf = mix(a_prev.nf, a_final.nf, ONE);\na_final.nh = mix(a_prev.nh, a_final.nh, ut);\na_final.ni = mix(a_prev.ni, a_final.ni, ut);\na_final.nj = mix(a_prev.nj, a_final.nj, ONE);\na_final.nk = mix(a_prev.nk, a_final.nk, ONE);\na_final.ng = mix(a_prev.ng, a_final.ng, ONE);\na_final.no = mix(a_prev.no, a_final.no, ONE);\na_final.nq = mix(a_prev.nq, a_final.nq, ONE);\na_final.nr = mix(a_prev.nr, a_final.nr, ONE);\na_final.ns = mix(a_prev.ns, a_final.ns, ONE);\na_final.nt = mix(a_prev.nt, a_final.nt, ONE);\na_final.nm = mix(a_prev.nm, a_final.nm, ONE);\na_final.np = mix(a_prev.np, a_final.np, ut);\na_final.bu = mix(a_prev.bu, a_final.bu, ut);\na_final.nw = mix(a_prev.nw, a_final.nw, ut);\na_final.nx = mix(a_prev.nx, a_final.nx, ut);\na_final.ny = mix(a_prev.ny, a_final.ny, ut);\na_final.nz = mix(a_prev.nz, a_final.nz, ut);\na_final.oa = mix(a_prev.oa, a_final.oa, ut);\na_final.ob = mix(a_prev.ob, a_final.ob, ONE);\na_final.az = mix(a_prev.az, a_final.az, ut);\na_final.ba = mix(a_prev.ba, a_final.ba, ut);\na_final.bl = mix(a_prev.bl, a_final.bl, ut);\na_final.oc = mix(a_prev.oc, a_final.oc, ut);\na_final.od = mix(a_prev.od, a_final.od, ut);\na_final.oe = mix(a_prev.oe, a_final.oe, ut);\na_final.of = mix(a_prev.of, a_final.of, ut);\na_final.og = mix(a_prev.og, a_final.og, ut);\na_final.oh = mix(a_prev.oh, a_final.oh, ut);\na_final.oi = mix(a_prev.oi, a_final.oi, ut);\na_final.oj = mix(a_prev.oj, a_final.oj, ut);\na_final.ok = mix(a_prev.ok, a_final.ok, ut);\na_final.ol = mix(a_prev.ol, a_final.ol, ut);\na_final.om = mix(a_prev.om, a_final.om, ut);\na_final.on = mix(a_prev.on, a_final.on, ut);\na_final.oo = mix(a_prev.oo, a_final.oo, ut);\na_final.op = mix(a_prev.op, a_final.op, ut);\na_final.oq = mix(a_prev.oq, a_final.oq, ONE);\na_final.or = mix(a_prev.or, a_final.or, ONE);\na_final.os = mix(a_prev.os, a_final.os, ONE);\n#endif\not lj;\nbool adr = uu(a_final, lj);\nif (!adr) {\nsj();\nreturn;\n}\nvec2 vb = a_vertexInfo.xy;\na = lj.az;\nb = lj.ba;\nc = lj.bl;\nd = lj.ov;\ne = lj.bb;\n#if D3D9_FIX\nf = vec4(lj.pb, lj.pc);\ng = vec3(lj.ou, lj.bu, lj.pa);\nh = vec4(lj.ow, lj.ox, lj.nh, lj.oy);\ni = vec4(lj.oz, lj.pe, lj.pd);\n#else\nj = lj.ou;\nk = lj.pb;\nl = lj.pc;\nm = vec2(lj.bu, lj.pa);\nn = lj.ow;\no = lj.ox;\np = vec2(lj.nh, lj.oy);\nq = lj.oz;\nr = lj.pe;\ns = lj.pd;\n#endif\nfloat ads = step(vb.x, 0.0);\nfloat adt = 1.0 - ads;\nvec2 sl = lj.pf\n+ (lj.pi * (lj.ph / 2.0) * vb.x)\n+ ((ads * lj.pj + adt * lj.pk) * (lj.pg / 2.0) * vb.y);\ngl_Position = sk(sl);\n}\n",Md="#define D3D9_FIX 0\nprecision highp float;\nprecision mediump int;\nuniform vec3 u_backgroundColor;\nuniform sampler2D u_patternNearestTexture;\nuniform sampler2D u_patternLinearTexture;\nuniform sampler2D u_patternLinearSdfTexture;\nuniform sampler2D u_patternMipmapTexture;\nuniform sampler2D u_shapeTexture;\nvarying vec4 a;\nvarying vec4 b;\nvarying vec4 c;\nvarying vec2 d;\nvarying vec2 e;\n#if D3D9_FIX\nvarying vec4 f;\nvarying vec3 g;\nvarying vec4 h;\nvarying vec4 i;\n#else\nvarying float j;\nvarying vec2 k;\nvarying vec2 l;\nvarying vec2 m;\nvarying float n;\nvarying float o;\nvarying vec2 p;\nvarying vec2 q;\nvarying float r;\nvarying float s;\n#endif\nconst float FILTER_NEAREST = 0.0;\nconst float FILTER_LINEAR = 0.0;\nconst float FILTER_LINEAR_SDF = 0.0;\nconst float FILTER_MIPMAP = 0.0;\nconst float EPSILON = 0.000000001;\nconst float SDF_BUFFER = (256.0 - 64.0) / 256.0; \nvec4 ad(in vec4 ae, in vec4 af) {\nfloat ag = af.a;\nfloat ah = ae.a + EPSILON;\nfloat ai = min(ag + ah, 1.0);\nfloat r = ag / ai;\nreturn vec4(mix(ae.rgb, af.rgb, r), ai);\n}\nfloat aj(in float ak, in float al) {\nfloat am = (ak * 256.0 + al) * 256.0;\nfloat an = am / 32768.0;\nreturn an * 2.0 - 1.0;\n}\nbool ao(float ap, float aq) {\nreturn abs(ap - aq) < EPSILON;\n}\nvoid main() {\n#if D3D9_FIX\nfloat j = g.x;\nfloat ar = g.y;\nfloat as = g.z;\nvec2 k = f.xy;\nvec2 l = f.zw;\nfloat n = h.x;\nfloat o = h.y;\nfloat at = h.z;\nfloat au = h.w;\nvec2 q = i.xy;\nfloat r = i.z;\nfloat s = i.w;\n#else\nfloat ar = m.x;\nfloat as = m.y;\nfloat at = p.x;\nfloat au = p.y;\n#endif\nvec4 av = texture2D(u_shapeTexture, d);\nfloat aw = aj(av.b, av.a) * q.x;\nfloat ax = aj(av.r, av.g) * q.y;\nax += as;\nfloat ay = min(aw, ax);\nvec4 az = a;\nvec4 ba = b;\nif (s > -EPSILON) {\nvec2 bb = e;\nfloat bj =\nstep(k.x, bb.x) *\nstep(bb.x, l.x) *\nstep(k.y, bb.y) *\nstep(bb.y, l.y);\nfloat bk = bj;\nvec4 bl;\nif (ao(s, FILTER_NEAREST)) {\nbl = texture2D(u_patternNearestTexture, bb);\n} else if (ao(s, FILTER_LINEAR)) {\nbl = texture2D(u_patternLinearTexture, bb);\n} else if (ao(s, FILTER_LINEAR_SDF)) {\nbl = texture2D(u_patternLinearSdfTexture, bb);\nbl.a = smoothstep(SDF_BUFFER - r, SDF_BUFFER + r, bl.a);\n} else if (ao(s, FILTER_MIPMAP)) {\nbl = texture2D(u_patternMipmapTexture, bb);\n}\nbl.rgb += c.rgb;\nbl.a *= bk;\naz = ad(az, bl);\n}\nfloat bm = clamp(ay, 0.0, 1.0);\nfloat bn = clamp(ay - j, 0.0, 1.0);\nfloat bo = bm - bn;\nbo = 1.0 - clamp(ay - j, 0.0, 1.0);\naz.a *= bn;\nba.a *= bo;\nvec4 bp = ad(az, ba);\nfloat bq = bm;\nbp.rgb = mix(u_backgroundColor, bp.rgb, ar);\nif (o > EPSILON) {\nfloat ch = fract(au) * o;\nfloat ci = clamp(min(ch, at - ch), 0.0, 1.0);\nbq *= ci;\n}\nif (n < 0.0 || n > 1.0 || bq < EPSILON) {\ndiscard;\n}\nbp.a *= bq;\nbp.rgb *= bp.a;\ngl_FragColor = bp;\n}\n";(Ss=ca=ca||{})[Ss.INIT=0]="INIT",Ss[Ss.COMPILING=1]="COMPILING",Ss[Ss.DONE=2]="DONE";var lp=(Ga.prototype.setConstant=function(e,t){this._constants[e]=t},Ga.prototype.setMacro=function(e,t){this._macros[e]=t},Ga.prototype.getState=function(){return this._state},Ga.prototype.getProgram=function(){return this._program},Ga.prototype.compile=function(){var e=this._gl,t=dp(this._vertexSource,this._macros,this._constants),n=dp(this._fragmentSource,this._macros,this._constants);this._program&&(e.deleteProgram(this._program),e.deleteShader(this._vertexShader),e.deleteShader(this._fragmentShader)),this._program=e.createProgram(),this._vertexShader=e.createShader(e.VERTEX_SHADER),this._fragmentShader=e.createShader(e.FRAGMENT_SHADER),e.shaderSource(this._vertexShader,t),e.compileShader(this._vertexShader),e.attachShader(this._program,this._vertexShader),e.shaderSource(this._fragmentShader,n),e.compileShader(this._fragmentShader),e.attachShader(this._program,this._fragmentShader),e.linkProgram(this._program),this._state=ca.COMPILING},Ga.prototype.getError=function(){var e=this._gl;return e.getShaderParameter(this._vertexShader,e.COMPILE_STATUS)?e.getShaderParameter(this._fragmentShader,e.COMPILE_STATUS)?e.getProgramParameter(this._program,e.LINK_STATUS)?(this._state=ca.DONE,null):{step:"link",message:e.getProgramInfoLog(this._program)}:{step:"fragment",message:e.getShaderInfoLog(this._fragmentShader)}:{step:"vertex",message:e.getShaderInfoLog(this._vertexShader)}},Ga);function Ga(e,t){var n=t.vertex,i=t.fragment,r=t.constants,o=t.macros;this._program=null,this._vertexShader=null,this._fragmentShader=null,this._state=ca.INIT,this._gl=e,this._vertexSource=n,this._fragmentSource=i,this._constants=un(r||{}),this._macros=un(o||{})}function dp(e,t,n){for(var i=Object.keys(t),r=Object.keys(n),o=0;o<i.length;++o){var a=i[o];e=e.replace("#define "+a+" 0","#define "+a+" "+t[a])}for(o=0;o<r.length;++o){var l=r[o],u=n[l];e=e.replace("const float "+l+" = 0.0;","const float "+l+" = "+u+(u%1==0?".0":"")+";")}return e}var su,Id,Zy=((su={})[0]={min:"NEAREST",mag:"NEAREST",mipmap:!1},su[1]={min:"LINEAR",mag:"LINEAR",mipmap:!1},su[2]={min:"LINEAR",mag:"LINEAR",mipmap:!1},su[3]={min:"LINEAR_MIPMAP_LINEAR",mag:"LINEAR",mipmap:!0},su),Gy=((Id={})[0]="ALPHA",Id[1]="RGBA",Id);function As(e){return 16*Math.ceil((e+2)/16)}function qy(e,t,n,i,r){for(var o=0,a=e.length;o<a;++o){var s=e[o],l=s.x,u=s.y,d=l+i,c=u+r,h=d<n&&c<n;if(h)for(var p=l;p<d;++p)if(1===t[p+u*n]){h=!1;break}if(h)for(p=u;p<c;++p)if(1===t[l+p*n]){h=!1;break}if(h){for(p=l;p<d;++p)for(var g=u;g<c;++g)t[p+g*n]=1;return e.splice(o,1),e.push({x:l,y:c},{x:d,y:u}),s}}return null}function cp(e,t,n,i,r,o,a){var s=4*e,l=t>>1<<7,u=t%2<<7;a[s]=n/16,a[1+s]=i/16,a[2+s]=l+r/16,a[3+s]=u+o/16}function Hy(e,t,n,i,r,o,a){i|=0,r|=0,o|=0,a|=0,t|=0;for(var s=0;s<o;++s)for(var l=0;l<a;++l){var u=4*(i+s+(r+l)*t),d=4*(s+l*o);e[u]=n[d],e[1+u]=n[1+d],e[2+u]=n[2+d],e[3+u]=n[3+d]}}function Wy(e,t){for(var n=0,i=4,r=0;r<e.length;++r){var o=e[r],s=o.height,l=As(o.width),u=As(s);n+=l*u,i=Math.max(i,Math.max(l,u))}var d=Li(Math.max(i,Math.sqrt(n)));return Math.min(d,t)}function hp(e,t){return Math.floor((t-e)/2)}function pp(e,t,n,i,r,o,a){var s=Zy[o],l=s.min,u=s.mag,d=s.mipmap,c=e[Gy[a]];if(0===a){for(var h=new Uint8Array(r*r),p=0;p<h.length;++p)h[p]=i[4*p+3];i=h}e.activeTexture(e.TEXTURE0+n),e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,c,r,r,0,c,e.UNSIGNED_BYTE,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e[u]),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e[l]),d&&e.generateMipmap(e.TEXTURE_2D)}function fp(e,t,n,i,r){for(var o=new Uint8Array(n*n*4),a=Math.ceil(n/16),s=new Uint8Array(a*a),l=[{x:0,y:0}],u=0;u<t.length;++u){var d=t[u],c=d.id,h=As(d.width)/16,p=As(d.height)/16,g=qy(l,s,a,h,p);if(g){var m=d.width,b=d.height,v=d.pixels,y=16*h,E=16*p,S=16*g.x+hp(m,y),w=16*g.y+hp(b,E);Hy(o,n,v,S,w,m,b),cp(c,e,S,w,y,E,r)}else{if(n<i)return fp(e,t,2*n,i,r);eo("exceeded max WebGL texture size of "+i+"; some texts/icons/images won't be displayed"),cp(c,e,0,0,0,0,r)}}return{texture:o,size:n}}function Yy(e,t,n,i){for(var r=e.getDistanceFromStrokeVertically,o=e.getDistanceFromStrokeHorizontally,a=t*(1-n)/2,s=(t-1)/2,l=0;l<t;++l)for(var u=0;u<t;++u){var d=4*(u*t+l),c=(l-s)/a,h=(u-s)/a,p=ve(r(c,h),-1,1),g=ve(o(c,h),-1,1);Xy(i,d,gp(p),gp(g))}}function gp(e){return(e+1)/2*32768}function Xy(e,t,n,i){e[t]=n>>8,e[t+1]=n%256,e[t+2]=i>>8,e[t+3]=i%256}function _p(e,t){for(var n=-Math.PI/2,i=2*Math.PI/e.length,r=0,o=e;r<o.length;r++){var a=n+i;t(o[r],n,a),n=a}}function mp(e,t,n,i,r){_p(t,function(o,a,s){e.beginPath(),e.moveTo(n,i),e.arc(n,i,r,a,s),e.fillStyle=o,e.fill()})}var Jy=(qa.prototype.refresh=function(e){for(var t=0,n=e.getShapeList();t<n.length;t++){var i=n[t];if(!this._shapesWritten.includes(i.id)){var r=i.isSimple?32:128,o=i.isSimple?this._simpleShapePixels:this._complexShapePixels;Yy(i,r,1/16,o),this._loadShapeInGpu(i.id,r,o),this._shapesWritten.push(i.id)}}},qa.prototype._loadShapeInGpu=function(e,t,n){var i=this._gl,r=Sd,o=e%Ed*128,a=128*Math.floor(e/Ed);if(this._texture)i.bindTexture(i.TEXTURE_2D,this._texture);else{var s=new Uint8Array(r*r*4);this._texture=i.createTexture(),i.activeTexture(i.TEXTURE0+this._glTextureUnit),i.bindTexture(i.TEXTURE_2D,this._texture),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,r,r,0,i.RGBA,i.UNSIGNED_BYTE,s)}i.texSubImage2D(i.TEXTURE_2D,0,o,a,t,t,i.RGBA,i.UNSIGNED_BYTE,n)},qa.prototype.getTextureSize=function(){return Sd},qa.prototype.getSamplingSize=function(){return 128},qa.prototype.getBufferRatio=function(){return 1/16},qa.prototype.getTextureUnit=function(){return this._glTextureUnit},qa);function qa(e,t){this._gl=e,this._glTextureUnit=t,this._simpleShapePixels=new Uint8Array(4096),this._complexShapePixels=new Uint8Array(65536),this._texture=null,this._shapesWritten=[]}var uu=1e20,Qy=(Od.prototype.getFontToImageSizeRatio=function(){return 1+2*this._buffer/this._fontSize},Od.prototype.draw=function(e,t,n){da(this._ctx,t,this._fontSize,n);var r=this._ctx.measureText(e).width+2*this._buffer,o=16*Math.ceil((r+2)/16)-2,a=this._height,s=o*a,l=Math.max(o,a);this._canvas.width<o&&(this._canvas.width=o,da(this._ctx,t,this._fontSize,n),this._ctx.textAlign="center",this._ctx.textBaseline="middle",this._ctx.fillStyle="black"),s>this._gridSize&&(this._gridOuter=new Float64Array(s),this._gridInner=new Float64Array(s),this._gridSize=s),l>this._maxDimension&&(this._f=new Float64Array(l),this._d=new Float64Array(l),this._z=new Float64Array(l+1),this._v=new Int16Array(l),this._maxDimension=l),this._ctx.clearRect(0,0,o,a),this._ctx.fillText(e,o/2,a/2);for(var u=this._ctx.getImageData(0,0,o,a),d=new Uint8ClampedArray(s),c=0;c<s;c++){var h=u.data[4*c+3]/255;this._gridOuter[c]=1==h?0:0==h?uu:Math.pow(Math.max(0,.5-h),2),this._gridInner[c]=1==h?uu:0==h?0:Math.pow(Math.max(0,h-.5),2)}for(vp(this._gridOuter,o,a,this._f,this._d,this._v,this._z),vp(this._gridInner,o,a,this._f,this._d,this._v,this._z),c=0;c<s;c++)d[c]=Math.max(0,Math.min(255,Math.round(255-255*((this._gridOuter[c]-this._gridInner[c])/this._radius+this._cutoff))));return{height:a,width:o,distance:d}},Od);function Od(e){var t=void 0===e?{}:e,n=t.fontSize,i=void 0===n?24:n,r=t.buffer,o=void 0===r?6:r,a=t.radius,s=void 0===a?8:a,l=t.cutoff,u=void 0===l?.25:l;this._maxDimension=1,this._gridSize=1,this._gridOuter=null,this._gridInner=null,this._f=null,this._d=null,this._z=null,this._v=null,this._fontSize=i,this._buffer=o,this._radius=s,this._cutoff=u,this._height=Math.ceil(this._fontSize+2*this._buffer*1.5),this._canvas=ci(),this._canvas.height=this._height,this._canvas.width=1,this._ctx=this._canvas.getContext("2d"),this._ctx.textBaseline="middle",this._ctx.textAlign="center",this._ctx.fillStyle="black"}function vp(e,t,n,i,r,o,a){for(var s=0;s<t;s++){for(var l=0;l<n;l++)i[l]=e[l*t+s];for(yp(i,r,o,a,n),l=0;l<n;l++)e[l*t+s]=r[l]}for(l=0;l<n;l++){for(s=0;s<t;s++)i[s]=e[l*t+s];for(yp(i,r,o,a,t),s=0;s<t;s++)e[l*t+s]=Math.sqrt(r[s])}}function yp(e,t,n,i,r){i[n[0]=0]=-uu,i[1]=+uu;for(var o=1,a=0;o<r;o++){for(var s=(e[o]+o*o-(e[n[a]]+n[a]*n[a]))/(2*o-2*n[a]);s<=i[a];)a--,s=(e[o]+o*o-(e[n[a]]+n[a]*n[a]))/(2*o-2*n[a]);n[++a]=o,i[a]=s,i[a+1]=+uu}for(o=0,a=0;o<r;o++){for(;i[a+1]<o;)a++;t[o]=(o-n[a])*(o-n[a])+e[n[a]]}}var e0=(Un.prototype.refresh=function(e){this._pixelRatio=e.getPixelRatio();for(var t=this._gl,n=this._getPatternsByFilter(e.getPatternList()),i=0;i<n.length;++i){var r=i,o=n[i],a=fp(r,o,Wy(o,this._maxTextureSize),this._maxTextureSize,this._patternIdToInfoTexture),s=a.texture,l=a.size,u=this._glTextures[r]||(this._glTextures[r]=t.createTexture());pp(t,u,this._glUnit+1+r,s,l,r,0===r?0:1),this._textureSizes[r]=l}var c=this._glTextureInfo||(this._glTextureInfo=t.createTexture());pp(t,c,this._glUnit,this._patternIdToInfoTexture,256,0,1)},Un.prototype.bindMetDataTexture=function(){var e=this._gl;e.activeTexture(e.TEXTURE0+this._glUnit),e.bindTexture(e.TEXTURE_2D,this._glTextureInfo)},Un.prototype.getGranularity=function(){return 16},Un.prototype.getInfoTextureUnit=function(){return this._glUnit},Un.prototype.getNearestTextureUnit=function(){return this._glUnit+1+0},Un.prototype.getLinearTextureUnit=function(){return this._glUnit+1+1},Un.prototype.getLinearSdfTextureUnit=function(){return this._glUnit+1+2},Un.prototype.getMipmapTextureUnit=function(){return this._glUnit+1+3},Un.prototype.getInfoTextureSize=function(){return 256},Un.prototype.getNearestTextureSize=function(){return this._textureSizes[0]},Un.prototype.getLinearTextureSize=function(){return this._textureSizes[1]},Un.prototype.getLinearSdfTextureSize=function(){return this._textureSizes[2]},Un.prototype.getMipmapTextureSize=function(){return this._textureSizes[3]},Un.prototype._getPatternsByFilter=function(e){for(var t=new Array(4),n=0;n<4;++n)t[n]=[];for(n=0;n<e.length;++n){var i=this._getPatternPixels(e[n]);t[i.filter].push(i)}return t},Un.prototype._getPatternPixels=function(e){var t=e.id,n=e.type,i=e.attributes,r=null;switch(n){case 2:r=i.duplicated?this._getDuplicatedImagePixels(i.image):i.scaled?this._getScaledImagePixels(i.image):this._getNonScaledImagePixels(i.image);break;case 3:var o=i.text,a=i.font,s=i.style,l=i.size,u=i.offset;r="sdf"===i.size?this._getSdfTextPixels(o,a,s):this._getRegularTextPixels(o,a,s,l,u);break;case 5:r=this._getIconPixels(i.text,i.font,i.style);break;case 6:r=this._getBadgeIconPixels(i.text,i.font,i.style);break;case 4:r=this._getPieChartPixels(i.colorArray);break;default:throw new Error('pattern type "'+n+'" does not exist')}return r.id=t,r},Un.prototype._getScaledImagePixels=function(e){var t=e.width,n=e.height;if(wr<t||wr<n){var i=wr/Math.max(e.width,e.height);t*=i,n*=i}return t&&n&&(t=As(t),n=As(n)),this._getImagePixels(e,t-=2,n-=2)},Un.prototype._getNonScaledImagePixels=function(e){return this._getImagePixels(e,e.width,e.height)},Un.prototype._getDuplicatedImagePixels=function(e){if(0===e.width||0===e.height)return this._getImagePixels(e,0,0);this._canvasForDuplicatedImage||(this._canvasForDuplicatedImage=ci(),this._canvasForDuplicatedImage.width=wr,this._canvasForDuplicatedImage.height=wr);for(var t=this._canvasForDuplicatedImage,n=t.getContext("2d"),i=e.width,r=e.height,o=(wr-i)/2,a=(wr-r)/2;0<o;)o-=i;for(;0<a;)a-=r;for(var s=o;s<wr;s+=i)for(var l=a;l<wr;l+=r)n.drawImage(e,s,l);return this._getImagePixels(t,wr,wr)},Un.prototype._getImagePixels=function(e,t,n){var i;if(0===t||0===n)i=new Uint8Array(0);else{(this._imageCanvas.width<t||this._imageCanvas.height<n)&&(this._imageCanvas.width=t,this._imageCanvas.height=n);var r=this._imageCanvasContext;Za(this._imageCanvas,r,t,n);try{r.drawImage(e,0,0,t,n)}catch(o){}i=r.getImageData(0,0,t,n).data}return{width:t,height:n,pixels:i,filter:3}},Un.prototype._getPieChartPixels=function(e){var t=126,n=this._imageCanvasContext;return Za(this._imageCanvas,n,t,t),n.save(),n.rect(0,0,t,t),n.clip(),mp(n,e,63,63,t),n.restore(),{width:t,height:t,pixels:n.getImageData(0,0,t,t).data,filter:1}},Un.prototype._getTextPixels=function(e,t,n,i,r,o){var a=this._imageCanvasContext,s=r*this._pixelRatio;da(a,n,s,i);var l=a.measureText(t).width;0===l&&(l=s);var u=0,d=0;3===e||(u=2*Math.ceil(1.5*s/2),d=2*Math.ceil(1.2*l/2));var c=Math.ceil(l+d),h=Math.ceil(s+u),p=this._imageCanvas.height<h||this._imageCanvas.width<c;return this._imageCanvas.height<h&&(this._imageCanvas.height=h),this._imageCanvas.width<c&&(this._imageCanvas.width=c),p&&da(a,n,s,i),a.clearRect(0,0,c,h),a.fillStyle="black",a.textBaseline="middle",a.textAlign="left",a.fillText(t,o+d/2,h/2),{width:c,height:h,pixels:a.getImageData(0,0,c,h).data,filter:e}},Un.prototype._getRegularTextPixels=function(e,t,n,i,r){return this._getTextPixels(0,e,t,n,i,r)},Un.prototype._getIconPixels=function(e,t,n){return this._getTextPixels(3,e,t,n,126,0)},Un.prototype._getBadgeIconPixels=function(e,t,n){return this._getSdfTextPixels(e,t,n)},Un.prototype._getSdfTextPixels=function(e,t,n){for(var i=this._sdfGenerator.draw(e,t,n),r=i.width,o=i.height,a=i.distance,s=new Uint8Array(r*o*4),l=0;l<a.length;++l)s[4*l+3]=a[l];return{width:r,height:o,pixels:s,filter:2}},Un);function Un(e,t){this._patternIdToInfoTexture=new Uint8Array(262144),this._glTextureInfo=null,this._glTextures=[],this._textureSizes=[],this._pixelRatio=1,this._gl=e,this._glUnit=t,this._imageCanvas=ci(),this._imageCanvas.width=wr,this._imageCanvas.height=wr,this._imageCanvasContext=this._imageCanvas.getContext("2d"),this._canvasForDuplicatedImage=null,this._sdfGenerator=new Qy({fontSize:24}),this._maxTextureSize=Math.min(4096,e.getParameter(e.MAX_TEXTURE_SIZE))}function xp(){var e=Bi(),t=e.styleSheets;if(!t||!e.location)return Promise.resolve([]);for(var n=_(e),i=[],r=[],o=0;o<t.length;o++){var a=t[o];null===a.href?i.push({href:n,content:a.ownerNode.textContent}):r.push(a.href)}var s=/@font-face\s*\{[^}]+\}/g;return Promise.all(r.map(function(l){return mi(l).then(function(u){return{href:l,content:u}}).catch(function(){return null})})).then(function(l){return l.concat(i)}).then(function(l){for(var u=[],d=0;d<l.length;d++){var c=l[d];if(null!==c){var h=c.href,p=c.content.match(s);if(p){var g=n0(p,h);u.push.apply(u,g)}}}return u})}function bp(e,t){return Promise.all(e.map(function(n){var r=n.originalRule;return Promise.all(n.formats.map(function(o){var a=o.format,s=o.url;return t?Ro(s).then(function(l){return{format:a,src:l}}).catch(function(){return null}):{format:a,src:s}})).then(function(o){for(var a=[],s=0;s<o.length;s++){var l=o[s];null!==l&&a.push("url('"+l.src+"') format('"+l.format+"')")}if(0===a.length)return r;var u="src: "+a.join(",")+";";return r.replace(/src\s*:[^;]+;/g,u)})}))}var t0={"embedded-opentype":!0,svg:!0};function n0(e,t){for(var n=/url\(['"]?([^'")]+)['"]?\)\s+format\(['"]?([^'")]+)['"]?\)/g,i=/font-family\s*:\s*['"]?([^;'"]+)['"]?;/,r=[],o=0;o<e.length;o++){for(var a=e[o],s=a.match(i)[1],l=[],u=void 0;u=n.exec(a);){var d=u[1],c=u[2];t0[c.toLowerCase()]||l.push({format:c,url:Ep(d,t)})}r.push({name:s,formats:l,originalRule:a})}return r}function Ep(e,t){if(/^http(s)?:/.test(e))return e;if("/"===e[0]){var n=t.match(/((\w+:\/\/)([^/]+))/);return n?n[1]+e:e}var i=e.split("/"),r=t.split("/");for("/"!==t[t.length-1]&&r.pop();".."===i[0];)i.shift(),r.pop();return r.concat(i).join("/").replace(/[\w](\/{2,})/g,function(o){return o[0]+"/"})}function il(e){if(e.keys)return Array.from(e.keys());var t=[];return e.forEach(function(n,i){return t.push(i)}),t}function ws(e){if(e.values)return Array.from(e.values());var t=[];return e.forEach(function(n){return t.push(n)}),t}var Sp=(zo.prototype.reserve=function(e){if(this._capacity<e){e=Math.pow(2,Math.ceil(Math.log2(e+1)));var t=new Uint32Array(e);t.set(this._array),this._capacity=e,this._array=t}},zo.prototype.has=function(e){var t=lu(this._array,e,0,this.length);return t<this.length&&this._array[t]===e},zo.prototype.add=function(e){var t=lu(this._array,e,0,this.length),n=t<this.length&&this._array[t]===e;return n||(this.length===this._capacity&&this.reserve(this.length+1),this._array.copyWithin(t+1,t,this.length),this._array[t]=e,this.length+=1),!n},zo.prototype.remove=function(e){var t=lu(this._array,e,0,this.length),n=t<this.length&&this._array[t]===e;return n&&(this._array.copyWithin(t,t+1,this.length),--this.length),n},zo.prototype.removeByPosition=function(e){return!(e>=this.length||(this._array.copyWithin(e,e+1,this.length),--this.length,0))},zo.prototype.get=function(e){return this._array[e]},zo.prototype.clear=function(){this.length=0},zo.prototype.slice=function(){return this._array.slice(0,this.length)},zo);function zo(){this._array=new Uint32Array(8),this._capacity=8,this.length=0,this._array=new Uint32Array(8),this._capacity=8,this.length=0}function lu(e,t,n,i){if(n===i)return n;var r=n+((i-n)/2|0),o=t-e[r];return 0==o?r:o<0?lu(e,t,n,r):lu(e,t,r+1,i)}var i0="undefined"==typeof HTMLElement?function(e){return!1}:function(e){return e instanceof HTMLElement};function rl(e,t,n){if(void 0===t&&(t=[]),void 0===n&&(n=[]),!i0(e)){if(function(e){return"object"!=typeof e||null===e||li(e)||(t=e)instanceof RegExp||t instanceof Date;var t}(e))t.push({path:n.slice(),value:e});else for(var i=Object.keys(e),r=0;r<i.length;++r){var o=i[r],a=n.slice();a.push(o),rl(e[o],t,a)}return t}}var Ap=(Object.defineProperty(Ha.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Ha.prototype.set=function(e,t){var n=this._getIndex(e);-1!==n?this._values[n]=t:(Nd(this._cachedPath,e)&&(this._cachedIndex=this._keys.length),this._keys.push(e),this._values.push(t),this._size+=1)},Ha.prototype.get=function(e){var t=this._getIndex(e);if(-1!==t)return this._values[t]},Ha.prototype.has=function(e){return-1!==this._getIndex(e)},Ha.prototype.keys=function(){return this._keys.slice()},Ha.prototype._getIndex=function(e){if(Nd(e,this._cachedPath))return this._cachedIndex;this._cachedPath=e.slice();for(var t=this._keys,n=0;n<t.length;++n)if(Nd(t[n],e))return this._cachedIndex=n;return this._cachedIndex=-1},Ha);function Ha(){this._keys=[],this._values=[],this._size=0,this._cachedPath=[],this._cachedIndex=-1}function Nd(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}var o0=Set.prototype.keys?function(e){return Array.from(e.keys())}:function(e){var t=[];return e.forEach(function(n){return t.push(n)}),t},du=Set.prototype.values?function(e){return Array.from(e.values())}:function(e){var t=[];return e.forEach(function(n,i){return t.push(i)}),t},wp=bi("webworker-threads"),Ld=wp?wp.Worker:null;function Cp(e){return Ld?function t(n){if(ArrayBuffer.isView(n))return Array.from(n);if(Array.isArray(n)){for(var i=0;i<n.length;++i)n[i]=t(n[i]);return n}if(en(n)){for(var o=0,a=Object.keys(n);o<a.length;o++){var s=a[o];n[s]=t(n[s])}return n}return n}(e):e}function Tp(e){return Ld?new Ld(new Function(e)):"undefined"==typeof URL||-1!==navigator.appVersion.indexOf("MSIE 10")?new Mp(e):function(t){try{var n=new Blob([t],{type:"application/javascript"}),i=URL.createObjectURL(n);return new Worker(i)}catch(r){return new Mp(t)}}(e)}var Mp=(ol.prototype.terminate=function(){this._terminated=!1,this._otherSide._terminated=!0},ol.prototype.addEventListener=function(e,t){this._listeners.push(t)},ol.prototype.postMessage=function(e){setTimeout(kp,0,this._otherSide,{data:e})},ol);function ol(e){this._main=!0,this._listeners=[],this._terminated=!1,this._f=new Function("self",e),this._otherSide=new a0(this),this._f(this._otherSide)}var Ip,a0=(Fd.prototype.addEventListener=function(e,t){this._listeners.push(t)},Fd.prototype.postMessage=function(e){setTimeout(kp,0,this._otherSide,{data:e})},Fd);function Fd(e){this._listeners=[],this._main=!1,this._terminated=!1,this._otherSide=e}function kp(e,t){if(!e._terminated)for(var n=0;n<e._listeners.length;++n)e._listeners[n](t)}var Op=bi("xmldom");Ip="undefined"!=typeof XMLSerializer?XMLSerializer:Op?Op.XMLSerializer:null;var s0=(vo.prototype.setAttribute=function(e,t){this._attributes[e]=t},vo.prototype.appendChild=function(e){this._children.push(e)},Object.defineProperty(vo.prototype,"tagName",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(vo.prototype,"children",{get:function(){return this._children},enumerable:!0,configurable:!0}),Object.defineProperty(vo.prototype,"childNodes",{get:function(){return this._children},enumerable:!0,configurable:!0}),Object.defineProperty(vo.prototype,"firstChild",{get:function(){return this._children[0]||null},enumerable:!0,configurable:!0}),vo.prototype.serialize=function(){var e=this._name,t=this._attributes,n=this._children,i=Object.keys(t).filter(function(o){return void 0!==t[o]}).map(function(o){return" "+o+'="'+t[o]+'"'}).join(""),r=n.map(function(o){return o.serialize()}).join("");return r.length?"<"+e+i+">"+r+"</"+e+">":"<"+e+i+"/>"},vo.prototype.cloneNode=function(e){for(var t=new vo(this._name),n=0,i=Object.keys(this._attributes);n<i.length;n++){var r=i[n];t.setAttribute(r,this._attributes[r])}if(e)for(var o=0;o<this._children.length;o++)t.appendChild(this._children[o].cloneNode(e));return t},vo);function vo(e){this._attributes={},this._children=[],this._name=e}var u0=(al.prototype.serialize=function(){return this._text},al.prototype.cloneNode=function(){return new al(this._text)},al);function al(e){this._text=e}var l0=(cu.prototype.appendChild=function(e){this._children.push(e)},cu.prototype.serialize=function(){return this._meta.concat(this._children.map(function(e){return e.serialize()})).join("")},cu.prototype.createElement=function(e){return new s0(e)},cu.prototype.createTextNode=function(e){return new u0(e)},cu);function cu(){this._children=[],this._meta=[],this._children=[],this._meta=[]}function Np(){return new l0}function Pd(e){return(new Ip).serializeToString(e)}function Lp(){return Bi().implementation.createDocument("","",null)}var Fp=(to.prototype.add=function(e){var t=this._keyToIndex[e];-1===t&&(t=this._size++,this._heap[t]=e),this._keyToIndex[e]=this._bubble(t)},to.prototype.removeMin=function(){if(0===this._size)return NaN;var e=this._heap[0];return this._heap[0]=this._heap[--this._size],this._bubble(0),e},to.prototype.isEmpty=function(){return 0===this._size},to.prototype.has=function(e){return-1!==this._keyToIndex[e]},to.prototype._bubble=function(e){var t=this._indexToValue(e),n=this._getParentIndex(e),i=this._indexToValue(n),r=e;if(0!==e&&t<i)r=this._swap(e,n);else{var o=this._getLeftChildIndex(e),a=this._getRightChildIndex(e),s=this._indexToValue(o),l=this._indexToValue(a),u=Math.min(t,s,l);u===t||(r=this._swap(e,u===s?o:a))}return r===e?e:this._bubble(r)},to.prototype._indexToValue=function(e){return e>=this._size?1/0:this._keyToValue[this._heap[e]]},to.prototype._getParentIndex=function(e){return(e-1)/2|0},to.prototype._getLeftChildIndex=function(e){return 2*e+1},to.prototype._getRightChildIndex=function(e){return 2*e+2},to.prototype._swap=function(e,t){var n=this._heap[e],i=this._heap[t];return this._heap[e]=i,this._heap[t]=n,this._keyToIndex[n]=t,this._keyToIndex[i]=e,t},to);function to(e){this._heap=[],this._size=0,this._keyToValue=e,this._keyToIndex=new Int32Array(e.length),this._keyToIndex.fill(-1)}var hu=(Bo.prototype._get=function(e){return e.isNode?this._nodes:this._edges},Bo.prototype.addOrRemoveElements=function(e,t){return t?this.addElements(e):this.removeElements(e)},Bo.prototype.addElements=function(e){for(var t=this._get(e),n=t.elementList,i=t.flexArray,r=t.indexList,o=r.getLength(),a=0;a<e._indexes.length;a++){var s=e._indexes[a];1!==i.get(s)&&(i.set(s,1),r.pushUnchecked(s))}return n(r.slice(o))},Bo.prototype.removeElements=function(e){for(var t=this._get(e),n=t.elementList,i=t.flexArray,r=t.indexList,o=r.getLength(),a=r.getBuffer(),s=0,l=0;l<e._indexes.length;l++){var u=e._indexes[l];0!==i.get(u)&&(i.set(u,0),s+=1)}if(s===o)return n(r.sliceAndReset());if(0===s)return n();var d=this._graph.acquireIndexList(e.isNode),c=0;for(l=0;l<o;++l)0===i.get(u=a[l])?(c+=1,d.pushUnchecked(u)):a[l-c]=u;return r.setLength(o-s),n(d.sliceAndReset())},Bo.prototype.hasElement=function(e){return!!this._get(e).flexArray.get(e._index)},Bo.prototype.clear=function(){this._nodes.indexList.isEmpty()||(this._nodes.indexList.reset(),this._nodes.flexArray.reset()),this._edges.indexList.isEmpty()||(this._edges.indexList.reset(),this._edges.flexArray.reset())},Bo.prototype.isEmpty=function(){return this._nodes.indexList.isEmpty()&&this._edges.indexList.isEmpty()},Bo.prototype.getElements=function(){return{nodes:this._nodes.elementList(this._nodes.indexList.slice()),edges:this._edges.elementList(this._edges.indexList.slice())}},Bo);function Bo(e,t){this._graph=e,this._nodes={elementList:e.nodeList,flexArray:e.createNodeAttribute({storage:1,name:t}),indexList:e.createIndexList(!0)},this._edges={elementList:e.edgeList,flexArray:e.createEdgeAttribute({storage:1,name:t}),indexList:e.createIndexList(!1)}}var Cr=(mr.prototype.reset=function(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.minScaledSize=1/0,this.maxScaledSize=-1/0,this.minFixedSize=1/0,this.maxFixedSize=-1/0,this.width=0,this.height=0,this.cx=0,this.cy=0,this},mr.prototype.addPoint=function(e,t,n,i){return this.minX=Math.min(this.minX,e),this.minY=Math.min(this.minY,t),this.maxX=Math.max(this.maxX,e),this.maxY=Math.max(this.maxY,t),void 0!==n&&void 0!==i&&("scaled"===i?(this.minScaledSize=Math.min(this.minScaledSize,n),this.maxScaledSize=Math.max(this.maxScaledSize,n)):(this.minFixedSize=Math.min(this.minFixedSize,n),this.maxFixedSize=Math.max(this.maxFixedSize,n))),this.cx=this.minX+(this.maxX-this.minX)/2,this.cy=this.minY+(this.maxY-this.minY)/2,this.width=this.maxX-this.minX,this.height=this.maxY-this.minY,this},mr.prototype.computeForZoom=function(e){var t=Math.max(this.maxScaledSize,this.maxFixedSize/e);return mr.from({minX:this.minX-t/2,minY:this.minY-t/2,maxX:this.maxX+t/2,maxY:this.maxY+t/2,width:this.width+t,height:this.height+t})},mr.from=function(e){var t=void 0===e?{}:e,n=t.minX,i=t.minY,r=t.maxX,o=t.maxY,a=t.width,s=t.height,l=new mr;return l.minX=n,l.minY=i,l.maxX=r,l.maxY=o,l.width=a||(r-n)/2,l.height=s||(o-i)/2,l.cx=(n+r)/2,l.cy=(i+o)/2,l},mr.fromValues=function(e,t,n){for(var i=1/0,r=1/0,o=-1/0,a=-1/0,s=-1/0,l=0;l<e.length;l++){var u=e[l],d=t[l],c=n[l];u-c<i&&(i=u-c),d-c<r&&(r=d-c),o<u+c&&(o=u+c),a<d+c&&(a=d+c),s<c&&(s=c)}var h=mr.from({minX:i,minY:r,maxX:o,maxY:a});return h.maxScaledSize=s,h},mr.prototype.pad=function(e){return this.minX-=e,this.minY-=e,this.maxX+=e,this.maxY+=e,this.width+=2*e,this.height+=2*e,this},mr.prototype.isValid=function(){return isFinite(this.width)&&isFinite(this.height)},mr.prototype.extend=function(e){return this.addPoint(e.minX,e.minY),this.addPoint(e.maxX,e.maxY),this},mr.prototype.bottomLeft=function(){return{x:this.minX,y:this.minY}},mr.prototype.topRight=function(){return{x:this.maxX,y:this.maxY}},mr);function mr(e){void 0===e&&(e={});var t=e.xValues,n=void 0===t?[]:t,i=e.yValues,r=void 0===i?[]:i,o=e.scaledSizeValues,a=void 0===o?[]:o,s=e.fixedSizeValues,l=void 0===s?[]:s;this.minX=mn(n),this.minY=mn(r),this.maxX=on(n),this.maxY=on(r),this.minScaledSize=mn(a),this.maxScaledSize=on(a),this.minFixedSize=mn(l),this.maxFixedSize=on(l),this.cx=this.minX+(this.maxX-this.minX)/2,this.cy=this.minY+(this.maxY-this.minY)/2,this.width=this.maxX-this.minX,this.height=this.maxY-this.minY}var Rd=(Wa.prototype.on=function(e,t){if("string"!=typeof e)throw new TypeError("Event name must be string");if("function"!=typeof t)throw new TypeError("Event handler must be function");var n=this._events=this._events||{};return(n[e]=n[e]||[]).push(t),this},Wa.prototype.off=function(e,t){if("string"!=typeof e)throw new TypeError("Event name must be string");var n=this._events=this._events||{},i=n[e];if(li(i))if("function"!=typeof t)n[e]=null;else{var r=i.indexOf(t);-1!==r&&i.splice(r,1),0===i.length&&(n[e]=null)}return this},Wa.prototype.fire=function(e){for(var t=arguments,n=[],i=1;i<arguments.length;i++)n[i-1]=t[i];if("string"!=typeof e)throw new TypeError("Event name must be string");var r=(this._events=this._events||{})[e];if(li(r))for(var o=n,a=0;a<r.length;a++){var s=r[a];s&&s.apply(this,o)}return this},Wa.prototype.once=function(e,t){var n=this,i=function(){for(var r=arguments,o=[],a=0;a<arguments.length;a++)o[a]=r[a];t.apply(n,o),n.off(e,i)};return i.handler=t,this.on(e,i)},Wa.prototype.hasListener=function(e,t){if(!e||!t)return!1;var n=(this._events=this._events||{})[e];if(li(n))for(var i=0,r=n.length;i<r;i++){var o=n[i];if(o===t||o.handler===t)return!0}return!1},Wa.prototype.getListeners=function(e){return(this._events=this._events||{})[e]},Wa);function Wa(){}var d0=Object.freeze({__proto__:null,BoundingBox:Cr,FlexArray:Pn,EventTarget:Rd,ColorManager:ou,Table:fd,setKeys:o0,setValues:du,requestAnimFrame:No,cancelAnimFrame:di,DummyCanvas:ip,DummyCanvasRenderingContext2D:rp,createCanvas:ci,clearCanvas:Za,setCtxFont:da,isWebGLSupported:op,getWebglContext:Ad,getDocumentFontRules:xp,getEmbeddedFontRules:bp,resolvePath:Ep,IndexList:ms,mapKeys:il,mapValues:ws,isInteger:function(e){return"number"==typeof e&&e%1==0},toPropertyPath:Pr,throttle:Pa,debounce:function(e,t,n){var i,r,o,a,s;function l(){var d=Date.now()-a;d<t&&0<=d?i=setTimeout(l,t-d):(i=null,n||(s=e.apply(o,r),o=r=null))}function u(){o=this,r=arguments,a=Date.now();var d=n&&!i;return i=i||setTimeout(l,t),d&&(s=e.apply(o,r),o=r=null),s}return 0!==t&&void 0!==t||(t=100),u.clear=function(){i&&(clearTimeout(i),i=null)},u.flush=function(){i&&(s=e.apply(o,r),o=r=null,clearTimeout(i),i=null)},u},processQueue:function(e,t){return new Promise(function(n,i){return function r(o,a,s,l,u){s(o[a],a,o,l,u).then(function(d){a===o.length-1?l(d):r(o,a+1,s,l,u)}).catch(u)}(e,0,t,n,i)})},isLittleEndian:fr,promiseQueue:Hi,hash8:Jr,isRawObject:Qr,getValues:Da,forEach:vt,deepCopy:un,updateObject:function e(t,n){vt(n,function(i,r){"object"==typeof r&&null!==r?("object"==typeof t[i]&&null!==t[i]||(t[i]={}),e(t[i],r)):t[i]=r})},extendList:function(e,t){t.forEach(function(n){-1===e.indexOf(n)&&e.push(n)})},setProperty:Xt,getProperty:En,flatten:Ht,unflatten:Sn,getFlattenedKeys:Ei,getLeafValues:Qn,ensureTransferable:Wi,getOptions:ln,isObject:en,mergeValues:ir,pick:Ra,objToValueList:rl,PathMap:Ap,smartRequire:bi,getDocument:Bi,getStyle:fo,DummyDomElement:Vi,createDummyDomElement:$o,getPixelRatio:Fn,dataUrlToBlob:Hn,createBlob:gr,isBlob:function(e){return"undefined"!=typeof Blob&&e instanceof Blob||e instanceof Wn},promptDownload:hn,resizeElement:Po,setAttributes:ea,SVG_NS:ta,XML_NS:On,XLINK:dt,createSvgElement:gn,createTextNode:Ti,getImage:_s,fetch:mi,isHTMLElement:Do,applyCursorStyle:$r,fetchBinary:Va,fetchBinaryAsBase64:Ro,escapeDOMAttribute:_r,BUTTON_MAPPING:Mi,baseURI:_,fadeElement:A,getCurrentTime:P,getDate:V,getTime:le,formatWorkerMessage:Cp,createWorker:Tp,insertSortAsc:Xr,insertSortDesc:pr,isArray:li,toArray:f,flattenArray:Fr,concatenateArrays:function(){for(var e=arguments,t=[],n=0;n<arguments.length;n++)t[n]=e[n];if(0===t.length)return[];for(var i=t[0].constructor,r=0,o=0,a=t;o<a.length;o++)r+=(c=a[o]).length;for(var s=new i(r),l=0,u=0,d=t;u<d.length;u++){for(var c=d[u],h=0;h<c.length;h++)s[l+h]=c[h];l+=c.length}return s},removeFromArray:Fa,binaryIndexOf:ps,parseColorRgba:md,toHexa:Yu,componentsToRGBA:ep,parseColorHex:vd,createDummyXmlDocument:Np,serializeXMLDocument:Pd,createXmlDocument:Lp,PrioritySet:Fp,nextPowerOfTwo:Li,computeSum:An,clamp:ve,mix:Dt,lerp:Lt,computeMax:on,computeMin:mn,getBaseLog:Ar,ElementSet:hu,displayPixelsOnScreen:function(e,t,n,i){void 0===i&&(i=0),void 0===t&&(t=n=Math.sqrt(e.length/4)),void 0===n&&(n=t);var r=document.createElement("canvas"),o=r.getContext("2d"),a=o.createImageData(t,n);r.style.imageRendering="pixelated",r.style.border="1px solid black",r.style.margin="2px",r.style.position="absolute",r.style.top=r.style.left="0px",r.width=t,r.height=n,a.data.set(e),o.putImageData(a,0,0);var s=document.getElementById("graph-container");s&&(s.style.position="static"),setTimeout(function(){return document.body.appendChild(r)},i)}}),c0={byte:1,ubyte:1,short:2,ushort:2,float:4},h0={byte:"BYTE",ubyte:"UNSIGNED_BYTE",short:"SHORT",ushort:"UNSIGNED_SHORT",float:"FLOAT"},Pp=(yo.prototype._finishInit=function(){var e=this,t=this._gl,n=this._ext,i=this._programWrapper.getError();if(i)throw new Error('WebGL compilation at step "'+i.step+":\n"+i.message+'"');var r=this._programWrapper.getProgram();this._program=r,t.useProgram(r),this._metaData.attributes.forEach(function(d){d.location=t.getAttribLocation(e._program,d.name),d.byteSize=d.size*c0[d.type],d.glType=h0[d.type]}),this._specialAttributes=this._createSpecialAttributesFunctions();for(var o=[],a=[],s=0,l=this._metaData.attributes;s<l.length;s++){var u=l[s];-1!==u.location&&(u.name.startsWith("a_text")?a.push(u):o.push(u))}this._baseAttributes=zd(o,t,n),this._textAttributes=zd(a,t,n),this._setupUniforms=function(d,c,h){for(var p={},g=[],m=0;m<d.length;++m){var b=d[m],v=b.id,E=b.type,S=c.getUniformLocation(h,b.name),w=p0[E](v);p[v]=S,g.push(w)}var M=new Function("gl","l","u",g.join("\n"));return function(O){return M(c,p,O)}}(this._metaData.uniforms,t,r)},yo.prototype._createSpecialAttributesFunctions=function(){return zd([{location:this._gl.getAttribLocation(this._program,this._metaData.vertexInfoAttribute),size:3,glType:"BYTE",byteSize:3,type:"byte",name:"special"}],this._gl,this._ext)},yo.prototype.startPass=function(e){this._program||this._finishInit(),this._gl.useProgram(this._program),this._resetStencil(),this._setupUniforms(e),this._specialAttributes.enable(),this._specialAttributes.setup(this._specialGlBuffers.vertexInfo,null,0)},yo.prototype._setupAttributes=function(e,t){var n=t.glBuffer,i=t.dataBuffer,r=t.divisor;e.enabled&&!n?e.disable():!e.enabled&&n&&e.enable(),n&&e.setup(n,i,r)},yo.prototype.setupBaseAttributes=function(e){this._setupAttributes(this._baseAttributes,e)},yo.prototype.setupTextAttributes=function(e){this._setupAttributes(this._textAttributes,e)},yo.prototype._resetStencil=function(){var e=this._gl;this._stencilUsage=1,e.disable(e.STENCIL_TEST)},yo.prototype.setupStencil=function(e){if(e!==this._stencilUsage){var t=this._gl;1!==e?(t.enable(t.STENCIL_TEST),2===e?(t.stencilOp(t.KEEP,t.KEEP,t.REPLACE),t.stencilFunc(t.ALWAYS,1,1)):3===e&&(t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.stencilFunc(t.EQUAL,0,1))):t.disable(t.STENCIL_TEST),this._stencilUsage=e}},yo.prototype.endPass=function(){this._specialAttributes.disable(),this._baseAttributes.disable(),this._textAttributes.disable()},yo);function yo(e){var t=e.gl,n=e.ext,i=e.specialGlBuffers,r=e.metaData,o=e.programWrapper;this._setupUniforms=null,this._specialAttributes=null,this._baseAttributes=null,this._textAttributes=null,this._stencilUsage=1,this._gl=t,this._ext=n,this._specialGlBuffers=i,this._metaData=un(r),this._programWrapper=o}var p0={int:function(e){return"gl.uniform1i(l."+e+", u."+e+");"},sampler2D:function(e){return"gl.uniform1i(l."+e+", u."+e+");"},float:function(e){return"gl.uniform1f(l."+e+", u."+e+");"},vec2:function(e){return"gl.uniform2f(l."+e+", u."+e+"[0], u."+e+"[1]);"},vec3:function(e){return"gl.uniform3f(l."+e+", u."+e+"[0], u."+e+"[1], u."+e+"[2]);"},vec4:function(e){return"gl.uniform4f(l."+e+", u."+e+"[0], u."+e+"[1], u."+e+"[2], u."+e+"[3]);"}};function zd(e,t,n){var i,r,o,a,s,l,u,d,c,h,p,g,m,b=(i=t,r=e.map(function(y){return"gl.enableVertexAttribArray("+y.location+");"}).join("\n"),o=new Function("gl",r),function(){return o(i)}),v=(a=t,s=e.map(function(y){return"gl.disableVertexAttribArray("+y.location+");"}).join("\n"),l=new Function("gl",s),function(){return l(a)});return{enable:function(){b(),this.enabled=!0},disable:function(){v(),this.enabled=!1},setup:(d=t,c=n,h=(u=e).reduce(function(y,E){return y+E.byteSize},0),p=0,g=["gl.bindBuffer(gl.ARRAY_BUFFER, glBuffer);","if (dataBuffer) gl.bufferData(gl.ARRAY_BUFFER, dataBuffer, gl.STATIC_DRAW);"].concat(u.map(function(y){var O="gl.vertexAttribPointer(\n        "+y.location+", "+y.size+", gl."+y.glType+",\n        false, "+h+", "+p+"\n      );";return p+=y.byteSize,O}),u.map(function(y){return"ext.vertexAttribDivisorANGLE("+y.location+", divisor);"})).join("\n"),m=new Function("gl","ext","glBuffer","dataBuffer","divisor",g),function(y,E,S){return m(d,c,y,E,S)}),enabled:!1}}var f0=(ha.prototype.setDataBuffer=function(e){this._dataBuffer!==e&&(this._program=e.isAnimated()?this._animationProgram:this._staticProgram,this._dataBuffer=e,this._dataBufferChanged=!0,e.hasSideData()&&!this._sideGlBuffer?this._sideGlBuffer=this._gl.createBuffer():!e.hasSideData()&&this._sideGlBuffer&&(this._gl.deleteBuffer(this._sideGlBuffer),this._sideGlBuffer=null))},ha.prototype.markAsUnused=function(){return this._used=!1,this},ha.prototype.getProgram=function(){return this._program},ha.prototype.markAsUsed=function(){return this._used=!0,this},ha.prototype.isUsed=function(){return this._used},ha.prototype.draw=function(){var e=this._gl,t=this._dataBuffer.getElementType(),n=2===t,i=n?this._dataBuffer.getNbSideElementsPerMainElement():1,r=3===t?41:1,o=this._dataBuffer.getSize(),a=this._dataBuffer.getStencilUsage(),s=this._dataBuffer.getVersion(),l=this._version!==s||this._dataBufferChanged;this._program.setupBaseAttributes({glBuffer:this._glBuffer,dataBuffer:l?this._dataBuffer.getByteArray():null,divisor:i}),this._program.setupTextAttributes({glBuffer:this._sideGlBuffer,dataBuffer:l&&n?this._dataBuffer.getSideByteArray():null,divisor:1}),this._program.setupStencil(a),l&&(this._version=s,this._dataBufferChanged=!1),this._ext.drawArraysInstancedANGLE(e.TRIANGLES,0,6*r,o*i)},ha.prototype.destroy=function(){this._gl.deleteBuffer(this._glBuffer),this._sideGlBuffer&&this._gl.deleteBuffer(this._sideGlBuffer)},ha);function ha(e){var t=e.gl,n=e.ext,i=e.staticProgram,r=e.animationProgram;this._program=null,this._dataBuffer=null,this._version=0,this._used=!1,this._dataBufferChanged=!1,this._glBuffer=null,this._sideGlBuffer=null,this._gl=t,this._ext=n,this._staticProgram=i,this._animationProgram=r,this._glBuffer=this._gl.createBuffer()}function Bd(e,t){if(t<2)return e;for(var n=e.split("\n"),i=[],r=0;r<n.length;++r){var o=n[r];if(o.length<t)i.push(o);else for(var a=Dp(n[r],t),s=0;s<a.length;++s)i.push(a[s])}return i.join("\n")}function Dp(e,t){for(var n=e.split(" "),i=[],r=0,o=-1,a=[],s=!0,l=0;l<n.length;++l)if(s){if(n[l].length>t){for(var u=g0(n[l],t),d=0;d<u.length;++d)i.push([u[d]]),++o;r=u[u.length-1].length}else i.push([n[l]]),++o,r=n[l].length+1;s=!1}else r+n[l].length<=t?(i[o].push(n[l]),r+=n[l].length+1):(s=!0,--l);for(l=0;l<i.length;++l)a.push(i[l].join(" "));return a}function g0(e,t){for(var n=[],i=0;i<e.length;i+=t-1)n.push(e.substr(i,t-1)+"-");return n[n.length-1]=n[n.length-1].substr(0,n[n.length-1].length-1)+" ",n}function Rp(e,t){if(null===e)return null;for(var n=(e=e.toString()).split("\n"),i=[],r=0,o=0;o<n.length;o++){var a=n[o];if(!t||t<=1||a.length<t)i.push(a),r=Math.max(r,a.length);else for(var s=Dp(n[o],t),l=0;l<s.length;l++)i.push(a=s[l]),r=Math.max(r,a.length)}return{data:i,maxLength:r,lines:i.length}}function zp(){var e=bi("@mapbox/mapbox-gl-rtl-text")||bi("mapbox-gl-rtl-text"),t=e?e.processBidirectionalText:Yi?window.processBidirectionalText:null,n=e?e.applyArabicShaping:Yi?window.applyArabicShaping:null;return{processBidirectionalText:t?function(i){return t(i,[]).join("")}:function(i){return i},applyArabicShaping:n?function(i){return null===i?null:"number"==typeof i?i.toString():n(i)}:function(i){return null===i?null:i.toString()}}}var pu=fr(),fu="\n".charCodeAt(0),_0=(ur.prototype._init_=function(){this._mustClear=!1,this._byFont={},this._widthAtlases={normal:{},bold:{},italic:{}}},ur.prototype.reset=function(){this._init_()},ur.prototype.clear=function(){this._mustClear=!0},ur.prototype._measureChar=function(e,t,n){return da(this._ctx,t,12,n),this._ctx.measureText(e).width/12},ur.prototype._getAtlas=function(e,t,n){var i="sdf"===n?0:n,r=this._byFont[e]||(this._byFont[e]={}),o=r[t]||(r[t]=new Array(50));return o[i]||(o[i]=new Array(256))},ur.prototype._getMeasurementAtlas=function(e,t){var n=this._widthAtlases[t];return n[e]||(n[e]=new Array(256))},ur.prototype.measureText=function(e,t,n,i){if(void 0===i&&(i=1),!t)return this._textDimensions.width=0,this._textDimensions.height=0,this._textDimensions;for(var r=this._getMeasurementAtlas(t,n),o=0,a=0,s=1,l=0;l<e.length;++l){var u=e.charCodeAt(l);if(u===fu)o<a&&(o=a),a=0,s+=1;else{var d=r[u];void 0===d&&(d=this._measureChar(e[l],t,n),r[u]=d),a+=d}}return o<a&&(o=a),this._textDimensions.width=o*i,this._textDimensions.height=s*i,this._textDimensions},ur.prototype._getCharInfo=function(e,t,n,i,r,o){var a=e[t];if(!a){var s=String.fromCharCode(t),l="sdf"===r?1:3;a={ratio:this._measureChar(s,n,i),patternId:new Array(l)};for(var u=0;u<l;++u)a.patternId[u]=this._patternManager.getIdFromDefinition({id:0,type:3,attributes:{text:s,font:n,style:i,size:r,align:o,offset:u/l}});e[t]=a}return a},ur.prototype.storeTextInDataView=function(e,t,n,i){var r=t;if(i&&7===i.type){var o=i.attributes,a=o.text,s=o.font,l=o.style,u=o.size,d=o.align,c="center"===d,h=this._getAtlas(s,l,u),p=0,g=1,m=0,b=0,v=this._lineWidthList;a=this._processBidirectionalText(a);for(var y=0;y<a.length;++y)(J=a.charCodeAt(y))===fu?(p<m&&(p=m),v[b]=m,b+=1,m=0,g+=1):m+=(O=this._getCharInfo(h,J,s,l,u,d)).ratio;if(p<(v[b]=m)&&(p=m),"sdf"===u){var E=0,S=-(c?v[E]:p)/2,w=(1-g)/2,M=0;for(y=0;y<a.length;++y){var O=h[J=a.charCodeAt(y)];if(J===fu)E+=1,S=-(c?v[E]:p)/2,w+=1,M=0;else{var F=O.ratio,L=O.patternId[0];S+=(F+M)/2,M=F;var N=Vp(20.44*S),B=Bp(2*w);e.setUint16(r,L,pu),e.setUint16(r+2,(N<<6)+B,pu),r+=4}}}else{var X=0;for(S=Math.ceil(-(c?v[X]:p)*u/2),w=(1-g)/2,y=0;y<a.length;++y){var J;if(O=h[J=a.charCodeAt(y)],J===fu)X+=1,S=Math.ceil(-(c?v[X]:p)*u/2),w+=1;else{var ae=O.ratio*u,ie=Math.floor(S),Y=Math.round(3*(S-ie));3===Y&&(Y=0,ie+=1),ie+=Math.ceil(ae/2),S+=ae,L=O.patternId[Y],N=Vp(ie),B=Bp(2*w),e.setUint16(r,L,pu),e.setUint16(r+2,(N<<6)+B,pu),r+=4}}}}this._fillWithZeros(e,r,n)},ur.prototype.extractTextFromDataView=function(e,t,n){for(var i=e,r=pu,o=i.getUint16(t,r),a=this._textPattern,s=this._patternManager.getDefinitionFromId(o).attributes,l=s.font,u=s.style,d=s.size,c=s.align,h=this._getAtlas(l,u,d),p=[],g=0,m=0,b=0,v=null,y=t;y<n;y+=4){var E=i.getUint16(y,r);if(!E)break;var S=i.getUint16(y+2,r)%64-32,w=this._patternManager.getDefinitionFromId(E);if(!w)break;var M=w.attributes.text.charCodeAt(0),O=h[M];null===v?v=S:v<S&&(m<g&&(m=g),g=0,b+=1,p.push(fu),v=S),p.push(M),O&&(g+=O.ratio)}m<g&&(m=g);var F=String.fromCharCode.apply(null,p);return a.attributes.style=u,a.attributes.font=l,a.attributes.size=d,a.attributes.align=c,a.attributes.text=this._processBidirectionalText(F),a.dimensions.width=m,a.dimensions.height=b,a},ur.prototype._fillWithZeros=function(e,t,n){for(var i=t;i<n;i+=4)e.setUint16(i,0)},ur.prototype._clear=function(){this._byFont={},this._widthAtlases={normal:{},bold:{},italic:{}}},ur.prototype.update=function(){this._mustClear&&(this._clear(),this._mustClear=!1)},ur.prototype.getVersion=function(){return 0},ur);function ur(e){this._patternManager=e,this._canvas=ci(),this._ctx=this._canvas.getContext("2d"),this._processBidirectionalText=zp().processBidirectionalText,this._textPattern={id:0,type:7,attributes:{text:"",font:"",size:0,style:"normal",align:"center"},dimensions:{width:0,height:0}},this._textDimensions={width:0,height:0},this._lineWidthList=new Array(64),this._init_()}function Bp(e){return ve(e+32,0,63)}function Vp(e){return ve(e+512,0,1023)}var Vd,m0=op(),v0={stencil:!0,antialias:!1,alpha:!0,premultipliedAlpha:!0,failIfMajorPerformanceCaveat:!("undefined"!=typeof window&&window.FORCE_WEBGL)},y0={NO_WEBGL:'Unable to create a WebGL context: `canvas.getContext("webgl")` and `canvas.getContext("experimental-webgl")` returned `null`',NO_ANGLE_INSTANCED_ARRAYS:'WebGL extension "ANGLE_instanced_arrays" unavailable: `gl.getExtension("ANGLE_instanced_arrays")` returned `null`'},x0=(wt(Up,Vd=Error),Up);function Up(){return null!==Vd&&Vd.apply(this,arguments)||this}function jp(e,t){if(!e){var n=new x0(y0[t]);throw n.code=t,n}}var Zp,b0=(wt(hi,Zp=Cd),hi.isAvailable=function(){return m0},hi.createInitData=function(){var e=ci(),t=Ad(e,v0),n=t&&"function"==typeof t.getExtension?t.getExtension("ANGLE_instanced_arrays"):null,i={BYTES_TO_OFFSET_ANGLE:2*Math.PI/8,BYTES_TO_COLOR:1/15,SDF_FONT_SIZE:24,CURVATURE_RATIO:5,PATTERN_MARGIN:1,TEXT_WIDTH_MULTIPLIER:1.2,TEXT_HEIGHT_MULTIPLIER:1.5,SELF_LOOP_CURVATURE_MULTIPLIER:5,EDGE_ARROW_SIZE_RATIO:3,NB_PIECES_PER_CURVE:41,PIECE_NODE_COMPONENT:1,PIECE_EDGE_BODY:2,PIECE_EDGE_HEAD:3,PIECE_EDGE_TAIL:4,PIECE_EDGE_TEXT:5,MAX_TEXT_SIZE:25,BYTES_TO_TEXT_OFFSET:1/20.44,FILTER_NEAREST:0,FILTER_LINEAR:1,FILTER_LINEAR_SDF:2,FILTER_MIPMAP:3,SHAPE_TEXTURE_SIZE:Sd,SIMPLE_SHAPE_SAMPLING_SIZE:32,COMPLEX_SHAPE_SAMPLING_SIZE:128,SHAPE_SAMPLING_BUFFER_RATIO:1/16,MAX_NB_SHAPES:15..toString(),FIRST_COMPLEX_SHAPE_ID:8,SELF_LOOP_TO_CIRCLE_APPROX:.9721},r=new lp(t,{vertex:Td,fragment:Md,constants:i,macros:{ANIMATED:0}}),o=new lp(t,{vertex:Td,fragment:Md,constants:i,macros:{ANIMATED:1}});return t&&n&&(r.compile(),t.flush()),{canvas:e,gl:t,ext:n,staticProgramWrapper:r,animationProgramWrapper:o}},hi.getName=function(){return"WebGL"},hi.prototype._afterFirstFrame=function(){this._animationProgramWrapper.getState()===ca.INIT&&this._animationProgramWrapper.compile()},hi.prototype.ensureAnimationsReady=function(){var e=this._animationProgramWrapper.getState();e!==ca.DONE&&(e===ca.INIT&&this._animationProgramWrapper.compile(),this._animationProgramWrapper.getError())},hi.prototype.getDomElement=function(){return this._glCanvas},hi.prototype._initGl=function(){var e=this._gl;e.clearColor(0,0,0,0),e.enable(e.BLEND),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA)},hi.prototype._computeShaderInfo=function(){var t;this._shaderMetadata=(Md,Gp(t={vertexInfoAttribute:"a_vertexInfo",attributes:[],uniforms:[]},Td),Gp(t,"#define D3D9_FIX 0\nprecision highp float;\nprecision mediump int;\nuniform vec3 u_backgroundColor;\nuniform sampler2D u_patternNearestTexture;\nuniform sampler2D u_patternLinearTexture;\nuniform sampler2D u_patternLinearSdfTexture;\nuniform sampler2D u_patternMipmapTexture;\nuniform sampler2D u_shapeTexture;\nvarying vec4 a;\nvarying vec4 b;\nvarying vec4 c;\nvarying vec2 d;\nvarying vec2 e;\n#if D3D9_FIX\nvarying vec4 f;\nvarying vec3 g;\nvarying vec4 h;\nvarying vec4 i;\n#else\nvarying float j;\nvarying vec2 k;\nvarying vec2 l;\nvarying vec2 m;\nvarying float n;\nvarying float o;\nvarying vec2 p;\nvarying vec2 q;\nvarying float r;\nvarying float s;\n#endif\nconst float FILTER_NEAREST = 0.0;\nconst float FILTER_LINEAR = 0.0;\nconst float FILTER_LINEAR_SDF = 0.0;\nconst float FILTER_MIPMAP = 0.0;\nconst float EPSILON = 0.000000001;\nconst float SDF_BUFFER = (256.0 - 64.0) / 256.0; \nvec4 ad(in vec4 ae, in vec4 af) {\nfloat ag = af.a;\nfloat ah = ae.a + EPSILON;\nfloat ai = min(ag + ah, 1.0);\nfloat r = ag / ai;\nreturn vec4(mix(ae.rgb, af.rgb, r), ai);\n}\nfloat aj(in float ak, in float al) {\nfloat am = (ak * 256.0 + al) * 256.0;\nfloat an = am / 32768.0;\nreturn an * 2.0 - 1.0;\n}\nbool ao(float ap, float aq) {\nreturn abs(ap - aq) < EPSILON;\n}\nvoid main() {\n#if D3D9_FIX\nfloat j = g.x;\nfloat ar = g.y;\nfloat as = g.z;\nvec2 k = f.xy;\nvec2 l = f.zw;\nfloat n = h.x;\nfloat o = h.y;\nfloat at = h.z;\nfloat au = h.w;\nvec2 q = i.xy;\nfloat r = i.z;\nfloat s = i.w;\n#else\nfloat ar = m.x;\nfloat as = m.y;\nfloat at = p.x;\nfloat au = p.y;\n#endif\nvec4 av = texture2D(u_shapeTexture, d);\nfloat aw = aj(av.b, av.a) * q.x;\nfloat ax = aj(av.r, av.g) * q.y;\nax += as;\nfloat ay = min(aw, ax);\nvec4 az = a;\nvec4 ba = b;\nif (s > -EPSILON) {\nvec2 bb = e;\nfloat bj =\nstep(k.x, bb.x) *\nstep(bb.x, l.x) *\nstep(k.y, bb.y) *\nstep(bb.y, l.y);\nfloat bk = bj;\nvec4 bl;\nif (ao(s, FILTER_NEAREST)) {\nbl = texture2D(u_patternNearestTexture, bb);\n} else if (ao(s, FILTER_LINEAR)) {\nbl = texture2D(u_patternLinearTexture, bb);\n} else if (ao(s, FILTER_LINEAR_SDF)) {\nbl = texture2D(u_patternLinearSdfTexture, bb);\nbl.a = smoothstep(SDF_BUFFER - r, SDF_BUFFER + r, bl.a);\n} else if (ao(s, FILTER_MIPMAP)) {\nbl = texture2D(u_patternMipmapTexture, bb);\n}\nbl.rgb += c.rgb;\nbl.a *= bk;\naz = ad(az, bl);\n}\nfloat bm = clamp(ay, 0.0, 1.0);\nfloat bn = clamp(ay - j, 0.0, 1.0);\nfloat bo = bm - bn;\nbo = 1.0 - clamp(ay - j, 0.0, 1.0);\naz.a *= bn;\nba.a *= bo;\nvec4 bp = ad(az, ba);\nfloat bq = bm;\nbp.rgb = mix(u_backgroundColor, bp.rgb, ar);\nif (o > EPSILON) {\nfloat ch = fract(au) * o;\nfloat ci = clamp(min(ch, at - ch), 0.0, 1.0);\nbq *= ci;\n}\nif (n < 0.0 || n > 1.0 || bq < EPSILON) {\ndiscard;\n}\nbp.a *= bq;\nbp.rgb *= bp.a;\ngl_FragColor = bp;\n}\n"),t)},hi.prototype._initGlPrograms=function(){this._staticProgram=new Pp({gl:this._gl,ext:this._ext,specialGlBuffers:this._specialGlBuffers,metaData:this._shaderMetadata,programWrapper:this._staticProgramWrapper}),this._animationProgram=new Pp({gl:this._gl,ext:this._ext,specialGlBuffers:this._specialGlBuffers,metaData:this._shaderMetadata,programWrapper:this._animationProgramWrapper})},hi.prototype._initSpecialGlBuffers=function(){for(var e=this._gl,t=e.createBuffer(),n=new Int8Array(738),i=0;i<41;++i)for(var r=[-1,-1,i,1,-1,i,1,1,i,-1,-1,i,-1,1,i,1,1,i],o=i*r.length,a=0;a<r.length;a++)n[a+o]=r[a];e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW),this._specialGlBuffers={vertexInfo:t}},hi.prototype._computeUniforms=function(){return{viewWidth:this._width,viewHeight:this._height,viewX:this._viewX,viewY:this._viewY,viewZoom:this._viewZoom,viewAngle:this._viewAngle,currentTime:this._currentTime,pixelRatio:this._pixelRatio,backgroundColor:this._backgroundRgba,patternInfoTexture:this._patternTexture.getInfoTextureUnit(),patternNearestTexture:this._patternTexture.getNearestTextureUnit(),patternLinearTexture:this._patternTexture.getLinearTextureUnit(),patternLinearSdfTexture:this._patternTexture.getLinearSdfTextureUnit(),patternMipmapTexture:this._patternTexture.getMipmapTextureUnit(),shapeTexture:this._shapeTexture.getTextureUnit(),BYTES_TO_COORD:this._scales.bytesToActualCoord,BYTES_TO_SCALED_SIZE:this._scales.bytesToActualScaledSize,BYTES_TO_MIN_VISIBLE_SIZE:this._scales.bytesToActualMinVisibleSize,BYTES_TO_SYMBOLIC_SIZE:this._scales.bytesToActualSymbolicSize,BYTES_TO_DASH_LENGTH:this._scales.bytesToActualDashLength,BYTES_TO_GAP_LENGTH:this._scales.bytesToActualGapLength,BYTES_TO_PATTERN_SCALE:this._scales.bytesToActualPatternScale,PATTERN_INFO_TEXTURE_SIZE:this._patternTexture.getInfoTextureSize(),PATTERN_NEAREST_TEXTURE_SIZE:this._patternTexture.getNearestTextureSize(),PATTERN_LINEAR_TEXTURE_SIZE:this._patternTexture.getLinearTextureSize(),PATTERN_LINEAR_SDF_TEXTURE_SIZE:this._patternTexture.getLinearSdfTextureSize(),PATTERN_MIPMAP_TEXTURE_SIZE:this._patternTexture.getMipmapTextureSize(),PATTERN_POSITION_GRANULARITY:this._patternTexture.getGranularity(),SHAPE_TEXTURE_SIZE:this._shapeTexture.getTextureSize(),SHAPE_SAMPLING_SIZE:this._shapeTexture.getSamplingSize(),SHAPE_SAMPLING_BUFFER_RATIO:this._shapeTexture.getBufferRatio(),NB_SHAPES_BY_SIDE:this._shapeTexture.getTextureSize()/this._shapeTexture.getSamplingSize(),SHAPE_DIMENSIONS:this._shapeTexture.getSamplingSize()/this._shapeTexture.getTextureSize(),SHAPE_ACTUAL_RATIO:1-this._shapeTexture.getBufferRatio()}},hi.prototype._render=function(e){var n=e.patternsChanged,i=e.dimensionsChanged,r=e.backgroundColorChanged,o=this._gl;if(e.shapesChanged&&(this._shapeTexture.refresh(this._shapeManager),this._patternTexture.bindMetDataTexture()),n&&this._patternTexture.refresh(this._patternManager),i&&(this._mustResize=!0),r){var a=this._renderBackground?this._backgroundRgba:[0,0,0,0],d=a[3];o.clearColor(a[0]*d,a[1]*d,a[2]*d,d)}var c=this._computeUniforms(),h=this._startFrame();this._mustResize&&h.length&&(Po(this._glCanvas,this._width,this._height,this._pixelRatio),o.viewport(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio),this._mustResize=!1),o.clear(o.COLOR_BUFFER_BIT|o.STENCIL_BUFFER_BIT);for(var p=0;p<h.length;++p)this._displayBuffer(h[p],c);this._endFrame()},hi.prototype._displayBuffer=function(e,t){var n=e.getProgram();n!==this._currentProgram&&(this._currentProgram&&this._currentProgram.endPass(),this._currentProgram=n,this._currentProgram.startPass(t)),e.markAsUsed(),e.draw()},hi.prototype._startFrame=function(){for(var e=this._bufferList.getBuffersByAscendingDepth(),t=[],n=0;n<this._glBuffers.length;++n)(r=this._glBuffers[n])&&r.markAsUnused();for(n=0;n<e.length;++n){var i=e[n];(r=this._getAssociatedGlBuffer(i)).markAsUsed(),!i.isEmpty()&&this._isBufferDisplayable(i)&&t.push(r)}for(n=0;n<this._glBuffers.length;++n){var r;(r=this._glBuffers[n])&&!r.isUsed()&&(r.destroy(),this._glBuffers[n]=void 0)}return t},hi.prototype._endFrame=function(){this._currentProgram&&(this._currentProgram.endPass(),this._currentProgram=null)},hi.prototype._getAssociatedGlBuffer=function(e){var t=e.getId(),n=this._glBuffers[t];if(!n){for(;this._glBuffers.length<=t;)this._glBuffers.push(void 0);n=new f0({gl:this._gl,ext:this._ext,staticProgram:this._staticProgram,animationProgram:this._animationProgram}),this._glBuffers[t]=n}return n.setDataBuffer(e),n},hi.prototype.destroy=function(){var e=this._gl.getExtension("WEBGL_lose_context");e&&e.loseContext()},hi.prototype.getImageData=function(){var e=this._glCanvas.width,t=this._glCanvas.height;return(this._2dcanvas.width<e||this._2dcanvas.height<t)&&(this._2dcanvas.width=e,this._2dcanvas.height=t),this._ctx.drawImage(this._glCanvas,0,0),this._ctx.getImageData(0,0,e,t)},hi.prototype._getImageDataFlippedYAxis=function(){var e=this._gl,t=this._glCanvas.width,n=this._glCanvas.height,i=this._ctx.createImageData(t,n),r=new Uint8Array(i.data.buffer);return e.readPixels(0,0,t,n,e.RGBA,e.UNSIGNED_BYTE,r),i},hi);function hi(e){var t=Zp.call(this,e)||this;t._2dcanvas=ci(),t._ctx=t._2dcanvas.getContext("2d"),t._glBuffers=[],t._staticProgram=null,t._animationProgram=null,t._currentProgram=null,t._specialGlBuffers=null,t._shaderMetadata=null,t._mustResize=!1;var n=e.initData||hi.createInitData(),i=n.canvas,r=n.gl,o=n.ext,a=n.staticProgramWrapper,s=n.animationProgramWrapper;return jp(r,"NO_WEBGL"),jp(o,"NO_ANGLE_INSTANCED_ARRAYS"),t._glCanvas=i,t._gl=r,t._ext=o,t._staticProgramWrapper=a,t._animationProgramWrapper=s,t._shapeTexture=new Jy(t._gl,0),t._patternTexture=new e0(t._gl,1),t._initCanvas(t._glCanvas),t._computeShaderInfo(),t._initSpecialGlBuffers(),t._initGlPrograms(),t._initGl(),t}var E0={float:1,vec2:2,vec3:3,vec4:4};function Gp(e,t){for(var n=/(?:attribute\s+\/\*\s*(byte|ubyte|short|ushort|float)\s*\*\/\s*(float|vec2|vec3|vec4)\s+(\w+)\s*;)|(?:#if\s*(\w+))|(?:#endif)/g,i=/uniform\s+(float|vec2|vec3|vec4|sampler2D|int)\s+(\w+)\s*;/g,r=[],o=n.exec(t);o;){var a=o[0];"#endif"===a?r.pop():a.startsWith("#if")?r.push(o[4]):e.attributes.push({name:o[3],size:E0[o[2]],type:o[1],tags:r.slice(),location:null,byteSize:null,glType:null}),o=n.exec(t)}for(o=i.exec(t);o;){if(!e.uniforms.some(function(d){return d.id===o[1]})){var s=o[1],l=o[2],u=l.replace("u_","");e.uniforms.push({id:u,name:l,type:s})}o=i.exec(t)}}var Br=Math.PI,gu=2*Math.PI,Yp=Br*(5/4),Xp=Br*(7/4),Jp=.75*Br,Qp=.25*Br,k0=-Br/2,O0=Br/2,L0={plain:{dash:0,gap:0},dashed:{dash:3,gap:1},dotted:{dash:1,gap:3}},F0={right:0,top:-Math.PI/2,left:Math.PI,bottom:Math.PI/2,center:0},P0={right:Math.PI,top:-Math.PI/2,left:0,bottom:Math.PI/2,center:0};function sl(e,t,n,i,r){var o=1-r;return o*o*o*e+3*r*o*o*t+3*r*r*o*n+r*r*r*i}function Cs(e,t,n,i){var r=1-i;return r*r*e+2*r*i*t+i*i*n}function pa(e,t,n,i,r,o){var a=o||{x:0,y:0},s=(e+n)/2,l=(t+i)/2,u=e-n,d=t-i,c=Math.sqrt(u*u+d*d);if(0===c)return a.x=s,a.y=l,a;var p=-u/c,g=-c*r/5;return a.x=s+d/c*g,a.y=l+p*g,a}function Ya(e,t,n,i,r,o){var a=o||{x1:0,y1:0,x2:0,y2:0},s=5*(i+i/5*n),l=-r+Br,u=Br/2-r;return a.x1=e+Math.cos(l)*s,a.y1=t+Math.sin(l)*s,a.x2=e+Math.cos(u)*s,a.y2=t+Math.sin(u)*s,a}var nf,rf=(wt(tn,nf=Cd),tn.prototype._resetCachePoints=function(){this._nextCachePoint=0},tn.prototype._point=function(e,t){var n=this._cachePoints[this._nextCachePoint++];return n||this._cachePoints.push(n={x:0,y:0}),n.x=e,n.y=t,n},tn.prototype.setViewportClipping=function(e){this._clipViewport=e},tn.prototype._formatAngle=function(e){return e<-Math.PI?e+2*Math.PI:e>Math.PI?e-2*Math.PI:e},tn.prototype._computeAnimationRatio=function(e){var r=(this._currentTime-e.beginTime)/e.duration,o=r*r,a=o*r,s=this._easingManager.getCoefficients(e.easing),l=r<.5?0:4;return ve(s[l]+s[1+l]*r+s[2+l]*o+s[3+l]*a,0,1)},tn.prototype._mixColor=function(e,t,n,i){if(e===t)return e;var r=this._colorManager.parseColor(e),o=r[0],a=r[1],s=r[2],l=r[3],u=this._colorManager.parseColor(t),c=u[1],h=u[2],p=u[3];return"rgba("+Math.round(255*Lt(o,u[0],n))+","+Math.round(255*Lt(a,c,n))+","+Math.round(255*Lt(s,h,n))+","+Lt(l,p,i)+")"},tn.prototype._displayBuffer=function(e){for(var t=e.getSize(),n=e.isAnimated(),i=0;i<t;++i){var r=this.extractElement(e,i);r.valid&&this._displayElement(r,n)}},tn.prototype._mixAttributes=function(e,t,n){var i=this._computeAnimationRatio(n);return e.dashLength=Lt(t.dashLength,e.dashLength,i),e.gapLength=Lt(t.gapLength,e.gapLength,i),e.offsetAngle=Lt(t.offsetAngle,e.offsetAngle,i),e.opacity=Lt(t.opacity,e.opacity,i),e.globalMinVisibleSize=Lt(t.globalMinVisibleSize,e.globalMinVisibleSize,i),e.strokeMinVisibleSize=Lt(t.strokeMinVisibleSize,e.strokeMinVisibleSize,i),e.patternMinVisibleSize=Lt(t.patternMinVisibleSize,e.patternMinVisibleSize,i),e.symbolicSize=Lt(t.symbolicSize,e.symbolicSize,i),e.curvature=Lt(t.curvature,e.curvature,i),e.fillColor=this._mixColor(t.fillColor,e.fillColor,i,i),e.strokeColor=this._mixColor(t.strokeColor,e.strokeColor,i,i),e.patternColor=this._mixColor(t.patternColor,e.patternColor,i,i),e.x1=Lt(t.x1,e.x1,i),e.y1=Lt(t.y1,e.y1,i),e.x2=Lt(t.x2,e.x2,i),e.y2=Lt(t.y2,e.y2,i),e.rectWidthOrSourceRadiusScaled=Lt(t.rectWidthOrSourceRadiusScaled,e.rectWidthOrSourceRadiusScaled,i),e.rectWidthOrSourceRadiusFixed=Lt(t.rectWidthOrSourceRadiusFixed,e.rectWidthOrSourceRadiusFixed,i),e.rectHeightOrTargetRadiusScaled=Lt(t.rectHeightOrTargetRadiusScaled,e.rectHeightOrTargetRadiusScaled,i),e.rectHeightOrTargetRadiusFixed=Lt(t.rectHeightOrTargetRadiusFixed,e.rectHeightOrTargetRadiusFixed,i),e.thicknessOrFontSizeScaled=Lt(t.thicknessOrFontSizeScaled,e.thicknessOrFontSizeScaled,i),e.thicknessOrFontSizeFixed=Lt(t.thicknessOrFontSizeFixed,e.thicknessOrFontSizeFixed,i),e.strokeWidthScaled=Lt(t.strokeWidthScaled,e.strokeWidthScaled,i),e.strokeWidthFixed=Lt(t.strokeWidthFixed,e.strokeWidthFixed,i),e.offsetScaled=Lt(t.offsetScaled,e.offsetScaled,i),e.offsetFixed=Lt(t.offsetFixed,e.offsetFixed,i),e},tn.prototype._computeRenderInfo=function(e){var t=this._viewZoom,n=this._point(e.x1,e.y1),i=this._point(e.x2,e.y2);return{shape:this._shapeManager.getDefinitionFromName(e.shape),pieceId:e.pieceId,dashLength:e.dashLength,gapLength:e.gapLength,hasHead:e.hasHead,hasTail:e.hasTail,isBodyTriangle:e.isBodyTriangle,isSelfLoop:e.isSelfLoop,patternScale:e.patternScale,offsetAngle:this._formatAngle(e.offsetAngle),isText:e.isText,adjustTextAngle:e.adjustTextAngle,unusedFlag1:e.unusedFlag1,unusedFlag2:e.unusedFlag2,unusedFlag3:e.unusedFlag3,opacity:e.opacity,globalMinVisibleSize:e.globalMinVisibleSize,strokeMinVisibleSize:e.strokeMinVisibleSize,patternMinVisibleSize:e.patternMinVisibleSize,symbolicSize:0===e.symbolicSize?1/0:e.symbolicSize*t,curvature:e.curvature,pattern:e.pattern,fillColor:e.fillColor,strokeColor:e.strokeColor,patternColor:e.patternColor,pos1OnGraph:n,pos2OnGraph:i,pos1:this._graphToScreenCoordinates(n),pos2:this._graphToScreenCoordinates(i),rectWidthOrSourceRadius:e.rectWidthOrSourceRadiusScaled*t+e.rectWidthOrSourceRadiusFixed,rectHeightOrTargetRadius:e.rectHeightOrTargetRadiusScaled*t+e.rectHeightOrTargetRadiusFixed,thicknessOrFontSize:e.thicknessOrFontSizeScaled*t+e.thicknessOrFontSizeFixed,strokeWidth:e.strokeWidthScaled*t+e.strokeWidthFixed,offset:e.offsetScaled*t+e.offsetFixed}},tn.prototype._applyBackgroundBlending=function(e){1!==e.opacity&&(e.fillColor=this._blendColor(e.fillColor,e.opacity),e.strokeColor=this._blendColor(e.strokeColor,e.opacity),e.textColor=this._blendColor(e.textColor,e.opacity))},tn.prototype._pointArray=function(e){var t=this._pointCopies[e];if(!t){t=new Array(e),this._pointCopies[e]=t;for(var n=0;n<e;++n)t[n]={x:0,y:0,r:0}}return t},tn.prototype._scalePoints=function(e,t,n,i){for(var r=e.shape.points.length,o=this._pointArray(r),a=0;a<r;++a){var s=e.shape.points[a],l=o[a];l.x=t.x+s.x*n,l.y=t.y+s.y*i,l.r=s.r*n}var u=e.pos2OnGraph.x-e.pos1OnGraph.x,d=e.pos2OnGraph.y-e.pos1OnGraph.y;if(0!=u||0!=d)for(var c=Math.sqrt(u*u+d*d),h=u/c,p=d/c,g=0,m=o;g<m.length;g++){var b=m[g],v=b.x-t.x,y=b.y-t.y;b.x=t.x+h*v+p*y,b.y=t.y-p*v+h*y}return o},tn.prototype._drawPoints=function(e){1===e.length?this._drawCircle(e[0],e[0].r):this._drawPolygon(e)},tn.prototype._computeCenter=function(e){var t=Math.cos(e.offsetAngle),n=Math.sin(e.offsetAngle);return this._point((e.pos1.x+e.pos2.x)/2+t*e.offset,(e.pos1.y+e.pos2.y)/2+n*e.offset)},tn.prototype._displayNodeComponent=function(e,t,n,i){var r=this,o=this._computeCenter(e);if(7!==e.pattern.type){var a=e.rectWidthOrSourceRadius/2,s=e.rectHeightOrTargetRadius/2,l=this._scalePoints(e,o,a,s);if((t||i)&&this._drawPoints(l),t&&this._fill(e.fillColor),i){if(this._startClip(),4===e.pattern.type){var u=e.pattern.attributes.colorArray;1!==e.opacity&&(u=u.map(function(B){return r._blendColor(B,e.opacity)})),this._displayPieChart(o,a,u)}else if(5===e.pattern.type||6===e.pattern.type){var d=0,c=Math.round(e.rectHeightOrTargetRadius*e.patternScale),h=e.pattern.attributes.text,p=e.patternColor,g=e.pattern.attributes.font,m=e.pattern.attributes.style,b=e.pattern.attributes.align,v=e.rectWidthOrSourceRadius;this._displayText(o,d,h,p,g,c,m,b,v)}else if(2===e.pattern.type){var y=e.pattern.attributes.image;if(y.isDummy||y.width&&y.height){var E=e.pattern.attributes.duplicated,S=E?1:e.patternScale;this._displayImage(o,e.rectWidthOrSourceRadius*S,e.rectHeightOrTargetRadius*S,y,e.pattern.attributes.scaled,E,e.opacity)}}this._endClip()}if(n){var L=e.strokeWidth/2,N=this._scalePoints(e,o,a+L,s+L);this._drawPoints(N),this._stroke(e.strokeColor,e.strokeWidth)}}else i&&this._displayText(o,d=0,h=e.pattern.attributes.text,p=e.patternColor,g=e.pattern.attributes.font,c=e.thicknessOrFontSize,m=e.pattern.attributes.style,b=e.pattern.attributes.align,v=e.rectWidthOrSourceRadius)},tn.prototype._displayElement=function(e,t){if(e.end.shape&&e.end.pieceId){this._resetCachePoints();var n=t?this._mixAttributes(e.end,e.start,e.animation):e.end,i=this._computeRenderInfo(n);if(!(i.symbolicSize<i.globalMinVisibleSize||0===i.opacity)){this._applyBackgroundBlending(i);var o,s,l,d,c,h,p,g,m,b,S,w,M,O,N=i.strokeColor&&0<i.strokeWidth&&i.symbolicSize>=i.strokeMinVisibleSize,X=!!i.fillColor;if(1===i.pieceId)this._displayNodeComponent(i,X,N,1!==i.pattern.type&&i.symbolicSize>=i.patternMinVisibleSize);else{var J=i.pos2.x-i.pos1.x,ae=i.pos2.y-i.pos1.y,ie=Math.sqrt(J*J+ae*ae),U=null,Y=null,he=null;if(i.isSelfLoop){var we=this._getSelfLoopControlPoints(i.pos1,i.curvature,5===i.pieceId?i.strokeWidth/2:i.rectWidthOrSourceRadius),st=we.x2,Xe=we.y2;U=this._point(we.x1,we.y1),Y=this._point(st,Xe),1,S=((g=i.pos1).x+(m=U).x+(b=Y).x)/3-m.x,w=(g.y+m.y+b.y)/3-m.y,M=m.x-b.x,O=m.y-b.y,he=1.9442*Math.sqrt(S*S+w*w-(M*M+O*O)/4)*3.14159265359*1}else he=i.curvature?(U=this._getQuadraticCurveControlPoint(i),o=ie,d=.5*.5,c=1/(16*(l=(s=Math.abs(i.curvature)/5+1e-6)*s)),h=Math.sqrt(d+c),p=.5/s*Math.sqrt(.25+l),Math.abs(2*s)*(.5*h+.5*p+c*Math.log(Math.abs((.5+h)/(p-.5))))*o):ie;if(5===i.pieceId){var xt=i.strokeWidth,It=this._getPointOnLine(i.pos1,U,Y,i.pos2,.5),Ge=this._getTangentOnLine(i.pos1,U,Y,i.pos2,.5);i.adjustTextAngle&&!i.isSelfLoop&&i.rectWidthOrSourceRadius>=he-xt&&(Ge.x=1,Ge.y=0,i.offset=0);var He=-Math.atan2(Ge.y,Ge.x),Pe=this._formatAngle(i.offsetAngle-He);(!i.isSelfLoop&&Pe<0||i.isSelfLoop&&i.offsetAngle<0)&&(Ge.x*=-1,Ge.y*=-1),(He>Math.PI/2||He<-Math.PI/2)&&(He+=Math.PI);var We=this._getOrthogonal(Ge),Qe=It.x+We.x*i.offset,nt=It.y+We.y*i.offset;if(i.fillColor){var Me=this._pointArray(4),ze=i.rectWidthOrSourceRadius/2,qe=i.rectHeightOrTargetRadius/2,Ke=Ge.x*ze,ht=Ge.y*ze,Wt=We.x*qe,$t=We.y*qe,dn=Me[0],sn=Me[1],pn=Me[2],W=Me[3];dn.x=Qe+Ke+Wt,dn.y=nt+ht+$t,sn.x=Qe+Ke-Wt,sn.y=nt+ht-$t,pn.x=Qe-Ke-Wt,pn.y=nt-ht-$t,W.x=Qe-Ke+Wt,W.y=nt-ht+$t,this._drawPoints(Me),this._fill(i.fillColor)}else{var Z=this._point(Qe,nt);this._displayText(Z,He,i.pattern.attributes.text,i.patternColor,i.pattern.attributes.font,i.thicknessOrFontSize,i.pattern.attributes.style,i.pattern.attributes.align,i.rectWidthOrSourceRadius)}}else{var Ve=3===i.pieceId,Re=4===i.pieceId,Be=Math.cos(i.offsetAngle),Oe=Math.sin(i.offsetAngle);i.pos1.x+=Be*i.offset,i.pos1.y+=Oe*i.offset,i.pos2.x+=Be*i.offset,i.pos2.y+=Oe*i.offset;var Le="line"===i.shape.name,Ce=i.thicknessOrFontSize,et=i.rectWidthOrSourceRadius,lt=i.rectHeightOrTargetRadius,je=+i.hasHead,Ze=+i.hasTail,Ue=+i.isBodyTriangle,Je=3*Ce,ot=je*Je,St=Ze*Je,Ot=Math.min((i.isSelfLoop?1/0:ie-et-lt)/(je+Ze),Je),bt=Ze*(Je+Math.max(et+Ot-St,0))+(1-Ze)*Ue*et,Mt=je*(Je+Math.max(lt+Ot-ot,0))+(1-je)*Ue*lt;if(Ve||Re){var it=Re?-1:1,pt=(Ve?he-Mt:bt)-it,Et=null,Ct=null;if(i.isSelfLoop){var jt=this._getTFromLengthOnCubicCurve(i.pos1,U,Y,i.pos2,pt-i.strokeWidth/2*it);Et=this._getPointOnCubicCurve(i.pos1,U,Y,i.pos2,jt),Ct=this._getTangentOnCubicCurve(i.pos1,U,Y,i.pos2,jt)}else Ct=i.curvature?(jt=this._getTFromLengthOnQuadraticCurve(i.pos1,U,i.pos2,pt-i.strokeWidth/2*it),Et=this._getPointOnQuadraticCurve(i.pos1,U,i.pos2,jt),this._getTangentOnQuadraticCurve(i.pos1,U,i.pos2,jt)):(Et=this._mixPoints(i.pos1,i.pos2,jt=pt/he),this._point(J/ie,ae/ie));if(Ct.x*=it,Ct.y*=it,X){if(i.shape.hole){var Bt=this._makeEdgeExtremityPoints(Et,Ct,Je,i.shape.hole);this._drawPoints(Bt),this._startReverseClip()}Me=this._makeEdgeExtremityPoints(Et,Ct,Je,i.shape.points),this._drawPoints(Me),this._fill(i.fillColor),i.shape.hole&&this._endReverseClip()}N&&(i.shape.hole&&(Bt=this._makeEdgeExtremityPoints(Et,Ct,Je,i.shape.hole),this._drawPoints(Bt),this._stroke(i.strokeColor,i.strokeWidth)),Me=this._makeEdgeExtremityPoints(Et,Ct,Je+i.strokeWidth/2,i.shape.points),this._drawPoints(Me),this._stroke(i.strokeColor,i.strokeWidth))}else{if(he-bt-Mt<=0)return;if(Le){var nn=function(In,Gn,rn,fn,zn,kn){var Ln=[];if(rn&&Ln.push(0,rn),zn&&kn){for(var fi=zn*Gn,bn=kn*Gn,br=fi+bn,wi=In-fn-rn-br,ni=0;ni<wi;)Ln.push(fi,bn),ni+=br;var tr=In-fn-rn-ni,Oi=Math.min(fi,tr),Ni=Math.max(tr-Oi,0);Ln.push(Oi,Ni)}else Ln.push(In-fn-rn,0);return fn&&Ln.push(0,fn),Ln}(he,Ce,bt,Mt,i.dashLength,i.gapLength);N&&(this._drawLine(i.pos1,U,Y,i.pos2),this._stroke(i.strokeColor,Ce+2*i.strokeWidth,nn)),X&&(this._drawLine(i.pos1,U,Y,i.pos2),this._stroke(i.fillColor,Ce,nn))}else{var Tn=bt,Rn=he-Mt;N&&(Me=this._makeTriangleEdgeBody(i.pos1,U,Y,i.pos2,Tn,Rn,Ce+i.strokeWidth/2,i.strokeWidth/2),this._drawPoints(Me),this._stroke(i.strokeColor,i.strokeWidth)),X&&(Me=this._makeTriangleEdgeBody(i.pos1,U,Y,i.pos2,Tn,Rn,Ce,0),this._drawPoints(Me),this._fill(i.fillColor))}}}}}}},tn.prototype._makeTriangleEdgeBody=function(e,t,n,i,r,o,a,s){return t?n?this._makeSelfLoopTriangleEdge(e,t,n,i,r,o,a,s):this._makeCurveTriangleEdge(e,t,i,r,o,a,s):this._makeStraightTriangleEdge(e,i,r,o,a,s)},tn.prototype._makeCurveTriangleEdge=function(e,t,n,i,r,o,a){for(var s=this._pointArray(84),l=this._getTFromLengthOnQuadraticCurve(e,t,n,i),u=(this._getTFromLengthOnQuadraticCurve(e,t,n,r)-l)/41,d=(a-o)/41/2,c=o/2,h=l,p=0;p<=41;++p){var g=this._getPointOnQuadraticCurve(e,t,n,h),m=this._getTangentOnQuadraticCurve(e,t,n,h),b=this._getOrthogonal(m),v=b.x*c,y=b.y*c,E=s[p],S=s[83-p];E.x=g.x+v,E.y=g.y+y,S.x=g.x-v,S.y=g.y-y,h+=u,c+=d}return s},tn.prototype._makeSelfLoopTriangleEdge=function(e,t,n,i,r,o,a,s){for(var l=this._pointArray(84),u=this._getTFromLengthOnCubicCurve(e,t,n,i,r),d=(this._getTFromLengthOnCubicCurve(e,t,n,i,o)-u)/41,c=(s-a)/41/2,h=a/2,p=u,g=0;g<=41;++g){var m=this._getPointOnCubicCurve(e,t,n,i,p),b=this._getTangentOnCubicCurve(e,t,n,i,p),v=this._getOrthogonal(b),y=v.x*h,E=v.y*h,S=l[g],w=l[83-g];S.x=m.x+y,S.y=m.y+E,w.x=m.x-y,w.y=m.y-E,p+=d,h+=c}return l},tn.prototype._makeStraightTriangleEdge=function(e,t,n,i,r,o){var a=t.x-e.x,s=t.y-e.y,l=Math.sqrt(a*a+s*s),u=this._point(a/l,s/l),d=this._getOrthogonal(u),c=r/2,h=o/2,p=this._pointArray(4),g=p[0],m=p[1],b=p[2],v=p[3],y=e.x+u.x*n,E=e.y+u.y*n,S=e.x+u.x*i,w=e.y+u.y*i,M=d.x*c,O=d.y*c,F=d.x*h,L=d.y*h;return g.x=y+M,g.y=E+O,m.x=y-M,m.y=E-O,b.x=S-F,b.y=w-L,v.x=S+F,v.y=w+L,p},tn.prototype._makeEdgeExtremityPoints=function(e,t,n,i){for(var r=this._pointArray(i.length),o=n/2,a=e.x+t.x*o,s=e.y+t.y*o,l=t.x,u=t.y,d=0;d<i.length;++d){var c=i[d],h=r[d],g=(u*c.x+l*c.y)*o;h.x=a+(l*c.x-u*c.y)*o,h.y=s+g,h.r=c.r*o}return r},tn.prototype._drawLine=function(e,t,n,i){t?n?this._drawCubicCurve(e,t,n,i):this._drawQuadraticCurve(e,t,i):this._drawStraightLine(e,i)},tn.prototype._getSelfLoopControlPoints=function(e,t,n){return Ya(e.x,e.y,t,n,this._viewAngle,this._tmp)},tn.prototype._getQuadraticCurveControlPoint=function(e){return pa(e.pos1.x,e.pos1.y,e.pos2.x,e.pos2.y,e.curvature,this._point(0,0))},tn.prototype._graphToScreenCoordinates=function(e){var i=(e.x-this._viewX)*this._viewZoom,r=(e.y-this._viewY)*this._viewZoom,o=this._viewAngleCos,a=this._viewAngleSin;return this._point(o*i+a*r+this._width/2,-a*i+o*r+this._height/2)},tn.prototype._blendColor=function(e,t){return e?this._mixColor(this._backgroundColor,e,t,1):null},tn.prototype._getTangentOnLine=function(e,t,n,i,r){return t?n?this._getTangentOnCubicCurve(e,t,n,i,r):this._getTangentOnQuadraticCurve(e,t,i,r):this._getTangentOnStraightLine(e,i)},tn.prototype._getTangentOnStraightLine=function(e,t){var n=t.x-e.x,i=t.y-e.y,r=Math.sqrt(n*n+i*i);return this._point(n/r,i/r)},tn.prototype._getTangentOnQuadraticCurve=function(e,t,n,i){var r=1-i,o=r*t.x+i*n.x-(r*e.x+i*t.x),a=r*t.y+i*n.y-(r*e.y+i*t.y),s=Math.sqrt(o*o+a*a);return this._point(o/s,a/s)},tn.prototype._getTangentOnCubicCurve=function(e,t,n,i,r){var o=1-r,a=o*o,s=r*r,l=a*(t.x-e.x)+2*o*r*(n.x-t.x)+s*(i.x-n.x),u=a*(t.y-e.y)+2*o*r*(n.y-t.y)+s*(i.y-n.y),d=Math.sqrt(l*l+u*u);return this._point(l/d,u/d)},tn.prototype._mixPoints=function(e,t,n){var i=Lt(e.x,t.x,n),r=Lt(e.y,t.y,n);return this._point(i,r)},tn.prototype._getOrthogonal=function(e){return this._point(-e.y,e.x)},tn.prototype._getPointOnLine=function(e,t,n,i,r){return t?n?this._getPointOnCubicCurve(e,t,n,i,r):this._getPointOnQuadraticCurve(e,t,i,r):this._mixPoints(e,i,r)},tn.prototype._getPointOnQuadraticCurve=function(e,t,n,i){var r=Cs(e.x,t.x,n.x,i),o=Cs(e.y,t.y,n.y,i);return this._point(r,o)},tn.prototype._getPointOnCubicCurve=function(e,t,n,i,r){var o=sl(e.x,t.x,n.x,i.x,r),a=sl(e.y,t.y,n.y,i.y,r);return this._point(o,a)},tn.prototype._getTFromLengthOnCubicCurve=function(e,t,n,i,r){for(var o=e.x,a=e.y,s=0,l=0,u=0;u<41;++u){var d=sl(e.x,t.x,n.x,i.x,s+=1/41),c=sl(e.y,t.y,n.y,i.y,s),h=d-o,p=c-a,g=Math.sqrt(h*h+p*p),m=l+g;if(r<m)return s-1/41*((m-r)/g);l=m,o=d,a=c}return 1},tn.prototype._getTFromLengthOnQuadraticCurve=function(e,t,n,i){for(var r=e.x,o=e.y,a=0,s=0,l=0;l<41;++l){var u=Cs(e.x,t.x,n.x,a+=1/41),d=Cs(e.y,t.y,n.y,a),c=u-r,h=d-o,p=Math.sqrt(c*c+h*h),g=s+p;if(i<g)return a-1/41*((g-i)/p);s=g,r=u,o=d}return 1},tn);function tn(e){var t=nf.call(this,e)||this;return t._cachePoints=[],t._nextCachePoint=0,t._tmp={x1:0,y1:0,x2:0,y2:0},t._pointCopies=Array(128),t._clipViewport=!0,t}var of,D0=!ci().__dummy,R0=(wt(pi,of=rf),pi.getName=function(){return"Canvas"},pi.isAvailable=function(){return D0},pi.prototype.getDomElement=function(){return this._canvas},pi.prototype._render=function(e){e.dimensionsChanged&&up(this._canvas,this._width,this._height,this._pixelRatio);var t=this._ctx,n=this._width*this._pixelRatio,i=this._height*this._pixelRatio;t.clearRect(0,0,n,i),this._backgroundColor&&this._renderBackground&&(t.fillStyle=this._backgroundColor,t.fillRect(0,0,n,i));for(var r=this._bufferList.getBuffersByAscendingDepth(),o=0;o<r.length;++o){var a=r[o];this._isBufferDisplayable(a)&&this._displayBuffer(a)}},pi.prototype._drawCircle=function(e,t){var n=this._ctx,i=this._pixelRatio,r=e.x*i,o=e.y*i,a=t*i;n.beginPath(),n.arc(r,o,a,0,2*Math.PI)},pi.prototype._drawPolygon=function(e){var t=this._ctx,n=this._pixelRatio;t.beginPath();var i=e[0];t.moveTo(i.x*n,i.y*n);for(var r=1;r<e.length;++r){var o=e[r];t.lineTo(o.x*n,o.y*n)}t.closePath()},pi.prototype._drawStraightLine=function(e,t){var n=this._ctx,i=this._pixelRatio;n.beginPath(),n.moveTo(e.x*i,e.y*i),n.lineTo(t.x*i,t.y*i)},pi.prototype._drawQuadraticCurve=function(e,t,n){var i=this._ctx,r=this._pixelRatio;i.beginPath(),i.moveTo(e.x*r,e.y*r),i.quadraticCurveTo(t.x*r,t.y*r,n.x*r,n.y*r)},pi.prototype._drawCubicCurve=function(e,t,n,i){var r=this._ctx,o=this._pixelRatio;r.beginPath(),r.moveTo(e.x*o,e.y*o),r.bezierCurveTo(t.x*o,t.y*o,n.x*o,n.y*o,i.x*o,i.y*o)},pi.prototype._fill=function(e){var t=this._ctx;t.fillStyle=e,t.fill()},pi.prototype._stroke=function(e,t,n){var i=this;void 0===n&&(n=[]);var r=this._ctx;r.setLineDash(n.map(function(o){return o*i._pixelRatio})),r.lineWidth=t,r.strokeStyle=e,r.stroke()},pi.prototype._startClip=function(){this._ctx.save(),this._ctx.clip()},pi.prototype._endClip=function(){this._ctx.restore()},pi.prototype._startReverseClip=function(){this._ctx.save(),this._ctx.rect(0,0,this._canvas.width,this._canvas.height),this._ctx.clip("evenodd")},pi.prototype._endReverseClip=function(){this._ctx.restore()},pi.prototype._displayText=function(e,t,n,i,r,o,a,s,l){var u=this._ctx,d=this._pixelRatio,c=e.x*d,h=e.y*d,p=o*d,g="center"===s?0:-l/2;if(u.save(),u.translate(c,h),u.rotate(-t),u.textAlign=s,u.textBaseline="middle",da(u,r,p,a),u.fillStyle=i,-1!==n.indexOf("\n"))for(var m=n.split("\n"),b=m.length,v=(1-b)/2*p,y=0;y<b;++y)u.fillText(m[y],g,v),v+=p;else u.fillText(n,g,-1);u.restore()},pi.prototype._displayImage=function(e,t,n,i,r,o,a){if(!this._hideImages&&!("isDummy"in i)){var s=i;1!==a&&(s=this._blendImageOnBackground(i,a));var l=this._ctx,u=this._pixelRatio,d=e.x*u,c=e.y*u,h=t*u,p=n*u,g=s.width*u,m=s.height*u;if(r)l.drawImage(s,d-h/2,c-p/2,h,p);else if(o){for(var b=d-h/2,v=c-p/2,y=d+h/2,E=c+p/2,S=d-g/2,w=c-m/2;b<S;)S-=g;for(;v<w;)w-=m;for(var M=w;S<y;){for(;w<E;)l.drawImage(s,S,w,g,m),w+=m;S+=g,w=M}}else l.drawImage(s,d-g/2,c-m/2,g,m)}},pi.prototype._displayPieChart=function(e,t,n){var i=this._ctx,r=this._pixelRatio,o=e.x*r,a=e.y*r,s=t*r*2,l=2*s;1===n.length?(i.fillStyle=n[0],i.fillRect(o-s,a-s,l,l)):2===n.length?(i.fillStyle=n[0],i.fillRect(o-s,a,l,s),i.fillStyle=n[1],i.fillRect(o-s,a-s,l,s)):mp(i,n,o,a,s)},pi.prototype._blendImageOnBackground=function(e,t){var n=this._backgroundRgba,i="rgb("+Math.round(255*n[0])+","+Math.round(255*n[1])+","+Math.round(255*n[2])+")";return this._imgCanvas.width=e.width,this._imgCanvas.height=e.height,this._imgCtx.clearRect(0,0,e.width,e.height),this._imgCtx.globalAlpha=1,this._imgCtx.fillStyle=i,this._imgCtx.fillRect(0,0,e.width,e.height),this._imgCtx.globalAlpha=t,this._imgCtx.drawImage(e,0,0),this._imgCanvas},pi.prototype.getImageData=function(){return this._ctx.getImageData(0,0,this._canvas.width,this._canvas.height)},pi);function pi(e){var t=of.call(this,e)||this;return t._canvas=ci(),t._imgCanvas=ci(),t._initCanvas(t._canvas),t._ctx=t._canvas.getContext("2d"),t._imgCtx=t._imgCanvas.getContext("2d"),t}var af=[1/0,1/0,-1/0,-1/0];function Gd(e,t,n,i,r,o){void 0===o&&(o={x:0,y:0});var a=Math.cos(r),s=Math.sin(r),l=e-n,u=t-i;return o.x=a*l-s*u+n,o.y=s*l+a*u+i,o}function yi(e,t,n,i){return Math.sqrt((e-n)*(e-n)+(t-i)*(t-i))}function ul(e,t,n,i){var r=e-n,o=t-i;return r*r+o*o}function sf(e){return 180*e/Math.PI}var uf=!1;try{uf=!!gn("svg")}catch(e){}var ll="none",z0={left:"start",center:"middle",right:"end"},no="data-element-id";function Xa(e){return Math.round(1e3*e)/1e3}function lf(e,t,n,i,r,o){var a=gn("image");return a.setAttribute("width",Xa(i)),a.setAttribute("height",Xa(r)),a.setAttribute("x",Xa(t)),a.setAttribute("y",Xa(n)),a.setAttribute("href",e),o&&o.appendChild(a),a}function qd(e,t,n,i,r,o,a){void 0===o&&(o=1);var s=gn("rect");return s.setAttribute("x",e),s.setAttribute("y",t),s.setAttribute("width",n),s.setAttribute("height",i),s.setAttribute("fill",r),s.setAttribute("fill-opacity",o),a&&a.appendChild(s),s}var Hd,B0=(wt(oi,Hd=rf),oi.getName=function(){return"SVG"},oi.isAvailable=function(){return uf},oi.prototype.getDomElement=function(){return this._svg},oi.prototype._render=function(e){if(e.dimensionsChanged&&ea(this._svg,{width:this._width,height:this._height}),this._backgroundColor&&this._renderBackground){var t=this._colorManager.rgbaToRgb(this._backgroundColor);this._background.setAttribute("fill",t.color),this._background.setAttribute("fill-opacity",t.opacity)}var n=this._bufferList.getBuffersByAscendingDepth();this._clear(),this._svg.removeChild(this._container);for(var i=0;i<n.length;++i){var r=n[i];this._isBufferDisplayable(r)&&this._displayBuffer(r)}this._svg.appendChild(this._container)},oi.prototype._clear=function(){this._container&&this._svg.removeChild(this._container),this._container=gn("g"),this._svg.appendChild(this._container),this._clipPaths&&this._defs.removeChild(this._clipPaths),this._clipPaths=gn("g"),this._defs.appendChild(this._clipPaths),this._filters&&this._defs.removeChild(this._filters),this._filters=gn("g"),this._defs.appendChild(this._filters)},oi.prototype._displayElement=function(e,t){this._currentElementId=0<=e.id?"n"+e.id:"e"+-e.id,Hd.prototype._displayElement.call(this,e,t)},oi.prototype._addBackgroundBlendingFilter=function(e){var t=this._colorManager.parseColor(this._backgroundColor),n=1-e,i=[e,0,0,0,t[0]*n,0,e,0,0,t[1]*n,0,0,e,0,t[2]*n,0,0,0,1,0].join(" "),r="filter-"+this._currentElementId,o=gn("filter",{id:r}),a=gn("feColorMatrix",{in:"SourceGraphic",type:"matrix",values:i});return o.appendChild(a),this._filters.appendChild(o),r},oi.prototype._drawCircle=function(e,t){var n="M "+(e.x-t)+", "+e.y+" a "+t+","+t+" 0 1,0 "+2*t+",0 a "+t+","+t+" 0 1,0 -"+2*t+",0",i=gn("path");i.setAttribute("d",n),i.setAttribute("fill",ll),i.setAttribute(no,this._currentElementId),this._container.appendChild(i),this._element=i},oi.prototype._drawPolygon=function(e){for(var t=gn("path"),n="",i=0;i<e.length;i++){var r=e[i];n+=(0===i?"M":"L")+r.x+","+r.y+" "}t.setAttribute("d",n+="Z"),t.setAttribute(no,this._currentElementId),t.setAttribute("fill",ll),this._container.appendChild(t),this._element=t},oi.prototype._drawStraightLine=function(e,t){var n=gn("path");n.setAttribute("d","M "+e.x+","+e.y+" L"+t.x+","+t.y),n.setAttribute(no,this._currentElementId),this._container.appendChild(n),this._element=n},oi.prototype._drawQuadraticCurve=function(e,t,n){var i=gn("path");i.setAttribute("d","M "+e.x+","+e.y+" Q"+t.x+","+t.y+" "+n.x+","+n.y),i.setAttribute("fill",ll),i.setAttribute(no,this._currentElementId),this._container.appendChild(i),this._element=i},oi.prototype._drawCubicCurve=function(e,t,n,i){var r=gn("path");r.setAttribute("d","M "+e.x+","+e.y+" C"+t.x+","+t.y+" "+n.x+","+n.y+" "+i.x+","+i.y),r.setAttribute("fill",ll),r.setAttribute(no,this._currentElementId),this._container.appendChild(r),this._element=r},oi.prototype._fill=function(e){var t=this._colorManager.rgbaToRgb(e);this._element.setAttribute("fill",t.color),this._element.setAttribute("fill-opacity",t.opacity),this._currentClipPathId&&this._element.setAttribute("clip-path","url(#"+this._currentClipPathId+")")},oi.prototype._stroke=function(e,t,n){void 0===n&&(n=[]);var i=this._element;i.setAttribute("stroke-width",t);var r=this._colorManager.rgbaToRgb(e);i.setAttribute("stroke",r.color),i.setAttribute("stroke-opacity",r.opacity),0<n.length&&i.setAttribute("stroke-dasharray",n.map(Xa).toString())},oi.prototype._startClip=function(){var e=gn("clipPath"),t=this._element.cloneNode(!1);this._currentClipPathId="clip-path-"+this._clipPathCounter++,e.appendChild(t),this._clipPaths.appendChild(e),e.setAttribute("id",this._currentClipPathId)},oi.prototype._endClip=function(){this._currentClipPathId=null},oi.prototype._startReverseClip=function(){var e=gn("clipPath"),t=this._element.cloneNode(!1),n=t.getAttribute("d");t.setAttribute("clip-rule","evenodd"),t.setAttribute("d",n+" M 0 0 L "+this._width+" 0 L "+this._width+" "+this._height+" L 0 "+this._height),this._currentClipPathId="clip-path-"+this._clipPathCounter++,e.appendChild(t),this._clipPaths.appendChild(e),e.setAttribute("id",this._currentClipPathId)},oi.prototype._endReverseClip=function(){this._currentClipPathId=null},oi.prototype._displayText=function(e,t,n,i,r,o,a,s,l){var u=gn("text");u.setAttribute(no,this._currentElementId);var d=this._colorManager.rgbaToRgb(i),c=d.opacity,h=this._colorManager.rgbaToRgb(d.color),p=e.x,g=e.y;a=a||"normal";var m=Xa(p);u.setAttribute("x",m),u.setAttribute("font-family",r),u.setAttribute("font-size",o),u.setAttribute("bold"===a?"font-weight":"font-style",a),u.setAttribute("fill",h.color),u.setAttribute("fill-opacity",c),t&&u.setAttribute("transform","rotate("+sf(-t)+" "+p+", "+g+")"),u.setAttribute("text-anchor",z0[s]||"middle");var b=n.split("\n"),v=b.length;u.setAttribute("y",Xa(g-((v+1)/2-1/3)*o));for(var E=0;E<v;E++){var S=gn("tspan");S.appendChild(Ti(b[E])),S.setAttribute("x",m),S.setAttribute("dy",o),u.appendChild(S)}this._currentClipPathId&&u.setAttribute("clip-path","url(#"+this._currentClipPathId+")"),this._container.appendChild(u)},oi.prototype._displayImage=function(e,t,n,i,r,o,a){var s=e.x,l=e.y;if(!this._hideImages&&("isDummy"in i||i.width&&i.height)){var u,d=i.width,c=i.height;if(r&&(d=t,c=n),o){var h=s-t/2,p=l-n/2,g=s+t/2,m=l+n/2,b=s-d/2,v=l-c/2;for((u=gn("g")).setAttribute(no,this._currentElementId);h<b;)b-=d;for(;p<v;)v-=c;for(var y=v;b<g;){for(;v<m;)lf(i.src,b,v,d,c,u),v+=c;v=y,b+=d}}else(u=lf(i.src,s-d/2,l-c/2,d,c)).setAttribute(no,this._currentElementId);if(this._currentClipPathId&&u.setAttribute("clip-path","url(#"+this._currentClipPathId+")"),1!==a){var E=this._addBackgroundBlendingFilter(a);u.setAttribute("filter","url(#"+E+")")}this._container.appendChild(u)}},oi.prototype._displayPieChart=function(e,t,n){var i,r=2*t,o=2*r,a=e.x,s=e.y,l=gn("g");l.setAttribute(no,this._currentElementId),1===n.length?i=qd(a-r,s-r,o,o,n[0],1,l):2===n.length?(i=qd(a-r,s,o,r,n[0],1,l),i=qd(a-r,s-r,o,r,n[1],1,l)):_p(n,function(u,d,c){var h=a+t*Math.cos(c),p=s+t*Math.sin(c),g=a+t*Math.cos(d),m=s+t*Math.sin(d),b=c-d<=Math.PI?0:1,v="M "+h+","+p+" A "+t+","+t+" 0 "+b+" 0 "+g+","+m+" L "+a+","+s+" L "+h+","+p;(i=gn("path")).setAttribute("d",v),i.setAttribute("fill",u),i.setAttribute("stroke-width",0),l.appendChild(i)}),this._currentClipPathId&&l.setAttribute("clip-path","url(#"+this._currentClipPathId+")"),this._container.appendChild(l)},oi);function oi(e){var t=Hd.call(this,e)||this;return t._svg=gn("svg"),t._defs=gn("defs"),t._styles=gn("g",{class:"styles"}),t._background=gn("rect",{width:"100%",height:"100%",fill:"none",class:"ogma-svg-background"}),t._currentElementId="0",t._currentClipPathId=null,t._clipPathCounter=1,t._defs.appendChild(t._styles),t._svg.setAttribute("pointer-events","none"),t._svg.style.userSelect="none",t._svg.appendChild(t._defs),t._svg.appendChild(t._background),t._clear(),t}var V0=(Ts.prototype.reset=function(){this._initialize()},Ts.prototype._initialize=function(){this._mustUpdate=!0,this.maxCoord=0,this.maxScaledSize=0,this.maxMinVisibleSize=0,this.maxSymbolicSize=0,this.maxDashLength=0,this.maxGapLength=0,this.maxPatternScale=0},Ts.prototype.set=function(e){var t=e.maxCoord,n=e.maxScaledSize,i=e.maxMinVisibleSize,r=e.maxSymbolicSize,o=e.maxDashLength,a=e.maxGapLength,s=e.maxPatternScale,l=this.maxCoord<t||this.maxScaledSize<n||this.maxMinVisibleSize<i||this.maxSymbolicSize<r||this.maxDashLength<o||this.maxGapLength<a||this.maxPatternScale<s;return l&&(this.maxCoord=t,this.maxScaledSize=n,this.maxMinVisibleSize=i,this.maxSymbolicSize=r,this.maxDashLength=o,this.maxGapLength=a,this.maxPatternScale=s,this._mustUpdate=!0),l},Ts.prototype.update=function(){return this._mustUpdate&&(this._version+=1,this._mustUpdate=!1),this},Ts.prototype.getVersion=function(){return this._version},Ts);function Ts(){this._version=0,this._initialize()}var U0={linear:[0,1,0,0],quadraticIn:[0,0,1,0],quadraticOut:[0,2,-1,0],quadraticInOut:[0,0,2,0,-1,4,-2,0],cubicIn:[0,0,0,1],cubicOut:[0,3,-3,1],cubicInOut:[0,0,0,4,-3,12,-12,4]},j0=(dl.prototype.add=function(e){var t=this;Object.keys(e).forEach(function(n){var i=e[n].slice();i.length<8&&(i[4]=i[0],i[5]=i[1],i[6]=i[2],i[7]=i[3]);var r=Jr(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]);t._nameToPolygon[n]=i,t._polygonToName[r]=n})},dl.prototype.getCoefficients=function(e){return this._nameToPolygon[e]||this._linearEasing},dl.prototype.getName=function(e,t,n,i,r,o,a,s){var l=Jr(e,t,n,i,r,o,a,s);return this._polygonToName[l]||"linear"},dl);function dl(){this._linearEasing=[0,1,0,0,0,1,0,0],this._nameToPolygon={},this._polygonToName={},this.add(U0)}var Z0=(jn.prototype.resizeBoundaries=function(e,t,n,i,r,o){this._maxScaledSize=e,this._maxMinVisibleSize=t,this._maxSymbolicSize=n,this._maxDashLength=i,this._maxGapLength=r,this._maxPatternScale=o,this._actualScaledSizeToBytes=65535/e,this._actualMinVisibleSizeToBytes=15/t,this._actualSymbolicSizeToBytes=255/n,this._actualDashLengthToBytes=3/i,this._actualGapLengthToBytes=3/r,this._actualPatternScaleToBytes=255/o},jn.prototype.storeGenericObject=function(e,t,n){var i=this._shapeManager.getIdFromName(n.shape),r=n.pieceId,o=this._dashLengthToBytes(n.dashLength),a=this._gapLengthToBytes(n.gapLength),s=+n.hasHead,l=+n.hasTail,u=+n.isBodyTriangle,d=+n.isSelfLoop,c=this._patternScaleToBytes(n.patternScale),h=this._offsetAngleToBytes(n.offsetAngle),p=+n.isText,g=+n.adjustTextAngle,m=+n.unusedFlag1,b=+n.unusedFlag2,v=+n.unusedFlag3,y=this._opacityToBytes(n.opacity),E=this._minVisibleSizeToBytes(n.globalMinVisibleSize),S=this._minVisibleSizeToBytes(n.strokeMinVisibleSize),w=this._minVisibleSizeToBytes(n.patternMinVisibleSize),M=this._symbolicSizeToBytes(n.symbolicSize),O=this._curvatureToBytes(n.curvature),F=this._patternManager.getIdFromDefinition(n.pattern),L=this._colorToBytes(n.fillColor),N=this._colorToBytes(n.strokeColor),B=this._colorToBytes(n.patternColor),X=this._coordToBytes(n.x1),J=this._coordToBytes(n.y1),ae=this._coordToBytes(n.x2),ie=this._coordToBytes(n.y2),U=this._scaledSizeToBytes(n.rectWidthOrSourceRadiusScaled),Y=this._fixedSizeToBytes(n.rectWidthOrSourceRadiusFixed),he=this._scaledSizeToBytes(n.rectHeightOrTargetRadiusScaled),pe=this._fixedSizeToBytes(n.rectHeightOrTargetRadiusFixed),we=this._scaledSizeToBytes(n.thicknessOrFontSizeScaled),ke=this._fixedSizeToBytes(n.thicknessOrFontSizeFixed),at=this._scaledSizeToBytes(n.strokeWidthScaled),st=this._fixedSizeToBytes(n.strokeWidthFixed),Xe=this._scaledSizeToBytes(n.offsetScaled),xt=this._fixedSizeToBytes(n.offsetFixed),Ge=c+(h<<8)+(p<<11)+(g<<12)+(m<<13)+(b<<14)+(v<<15),He=y+(E<<4)+(S<<8)+(w<<12),Pe=M+(O<<8);this._setUint16(e,t+0,i+(r<<4)+(o<<8)+(a<<10)+(s<<12)+(l<<13)+(u<<14)+(d<<15)),this._setUint16(e,t+2,Ge),this._setUint16(e,t+4,He),this._setUint16(e,t+6,Pe),this._setUint16(e,t+8,F),this._setUint16(e,t+10,L),this._setUint16(e,t+12,N),this._setUint16(e,t+14,B),this._setFloat32(e,t+16,X),this._setFloat32(e,t+20,J),this._setFloat32(e,t+24,ae),this._setFloat32(e,t+28,ie),this._setUint16(e,t+32,U),this._setUint16(e,t+34,Y),this._setUint16(e,t+36,he),this._setUint16(e,t+38,pe),this._setUint16(e,t+40,we),this._setUint16(e,t+42,ke),this._setUint16(e,t+44,at),this._setUint16(e,t+46,st),this._setUint16(e,t+48,Xe),this._setUint16(e,t+50,xt)},jn.prototype._setUint16=function(e,t,n){e.setUint16(t,n,this._littleEndian)},jn.prototype._setFloat32=function(e,t,n){e.setFloat32(t,n,this._littleEndian)},jn.prototype._colorToBytes=function(e){var t=this._colorParser(e);return Math.round(15*t[0])+(Math.round(15*t[1])<<4)+(Math.round(15*t[2])<<8)+(Math.round(15*t[3])<<12)},jn.prototype._coordToBytes=function(e){return e},jn.prototype._scaledSizeToBytes=function(e){return Math.ceil(Math.min(e,this._maxScaledSize)*this._actualScaledSizeToBytes)},jn.prototype._fixedSizeToBytes=function(e){return e},jn.prototype._minVisibleSizeToBytes=function(e){return Math.round(Math.min(e,this._maxMinVisibleSize)*this._actualMinVisibleSizeToBytes)},jn.prototype._symbolicSizeToBytes=function(e){return Math.round(Math.min(e,this._maxSymbolicSize)*this._actualSymbolicSizeToBytes)},jn.prototype._dashLengthToBytes=function(e){return Math.round(Math.min(e,this._maxDashLength)*this._actualDashLengthToBytes)},jn.prototype._gapLengthToBytes=function(e){return Math.round(Math.min(e,this._maxGapLength)*this._actualGapLengthToBytes)},jn.prototype._patternScaleToBytes=function(e){return Math.round(Math.min(e,this._maxPatternScale)*this._actualPatternScaleToBytes)},jn.prototype._offsetAngleToBytes=function(e){return Math.round((e+gu)%gu*(8/gu))},jn.prototype._opacityToBytes=function(e){return Math.round(15*Math.min(e,1))},jn.prototype._curvatureToBytes=function(e){return this._signedToUnsignedByte(e)},jn.prototype._signedToUnsignedByte=function(e){return ve(e,-128,127)+128},jn.prototype.storeAnimationInformation=function(e,t,n,i){var o=n.duration;this._setAnimationBeginTime(e,t,n.beginTime),this._setAnimationDuration(e,t,o),this._setAnimationEasing(e,t,i)},jn.prototype._setAnimationBeginTime=function(e,t,n){this._setFloat32(e,t,n)},jn.prototype._setAnimationDuration=function(e,t,n){this._setFloat32(e,t+4,n)},jn.prototype._setAnimationEasing=function(e,t,n){this._setUint16(e,t+8,(n[0]+128<<8)+(n[4]+128)),this._setUint16(e,t+10,(n[1]+128<<8)+(n[5]+128)),this._setUint16(e,t+12,(n[2]+128<<8)+(n[6]+128)),this._setUint16(e,t+14,(n[3]+128<<8)+(n[7]+128))},jn.prototype.extractGenericElement=function(e,t,n){var i=e.getElementType(),r=e.isAnimated(),o=e.getDataView(),a=t*e.getElementSize(),s=this._genericObject;if(s.valid=!1,o.getUint16(a)&&(s.valid=!0,this._extractGenericObject(s.end,o,a,n),r&&(this._extractGenericObject(s.start,o,52+a,n),this._extractAnimationInformation(s.animation,o,104+a)),s.id=this._idRecorder.get(e,t),2===i)){var l=e.getSideDataView(),u=t*e.getTotalSideElementsSize(),d=u+e.getTotalSideElementsSize();this._extractTextCharacters(s.end,l,u,d)}return s},jn.prototype._extractGenericObject=function(e,t,n,i){var r=i.bytesToActualCoord,o=i.bytesToActualScaledSize,a=i.bytesToActualMinVisibleSize,s=i.bytesToActualPatternScale,l=i.bytesToActualSymbolicSize,u=i.bytesToActualDashLength,d=i.bytesToActualGapLength,c=t,h=n,p=this._littleEndian,g=c.getUint16(h,p),m=Yn(g,0,4),b=Yn(g,4,8),v=Yn(g,8,10),y=Yn(g,10,12),E=Yn(g,12,13),S=Yn(g,13,14),w=Yn(g,14,15),M=Yn(g,15,16),O=c.getUint16(h+2,p),F=Yn(O,0,8),L=Yn(O,8,11),N=Yn(O,11,12),B=Yn(O,12,13),X=Yn(O,13,14),J=Yn(O,14,15),ae=Yn(O,15,16),ie=c.getUint16(h+4,p),U=Yn(ie,0,4),Y=Yn(ie,4,8),he=Yn(ie,8,12),pe=Yn(ie,12,16),we=c.getUint16(h+6,p),ke=Yn(we,0,8),at=Yn(we,8,16),st=c.getUint16(h+8,p),Xe=c.getUint16(h+10,p),xt=c.getUint16(h+12,p),It=c.getUint16(h+14,p),Ge=c.getFloat32(h+16,p),He=c.getFloat32(h+20,p),Pe=c.getFloat32(h+24,p),We=c.getFloat32(h+28,p),Qe=c.getUint16(h+32,p),nt=c.getUint16(h+34,p),Me=c.getUint16(h+36,p),ze=c.getUint16(h+38,p),qe=c.getUint16(h+40,p),Ke=c.getUint16(h+42,p),ht=c.getUint16(h+44,p),Wt=c.getUint16(h+46,p),$t=c.getUint16(h+48,p),dn=c.getUint16(h+50,p);e.pieceId=b,e.shape=this._shapeManager.getNameFromId(m),e.x1=Vr(Ge,r),e.y1=Vr(He,r),e.x2=Vr(Pe,r),e.y2=Vr(We,r),e.rectWidthOrSourceRadiusScaled=Vr(Qe,o),e.rectWidthOrSourceRadiusFixed=nt,e.rectHeightOrTargetRadiusScaled=Vr(Me,o),e.rectHeightOrTargetRadiusFixed=ze,e.thicknessOrFontSizeScaled=Vr(qe,o),e.thicknessOrFontSizeFixed=Ke,e.strokeWidthScaled=Vr(ht,o),e.strokeWidthFixed=Wt,e.offsetScaled=Vr($t,o),e.offsetFixed=dn,e.pattern=this._patternManager.getDefinitionFromId(st),e.opacity=U/15,e.fillColor=Wd(Xe),e.strokeColor=Wd(xt),e.patternColor=Wd(It),e.globalMinVisibleSize=Vr(Y,a),e.strokeMinVisibleSize=Vr(he,a),e.patternMinVisibleSize=Vr(pe,a),e.offsetAngle=L*(2*Math.PI/8),e.patternScale=F*s,e.symbolicSize=ke*l,e.curvature=at-128,e.dashLength=v*u,e.gapLength=y*d,e.hasHead=!!E,e.hasTail=!!S,e.isBodyTriangle=!!w,e.isSelfLoop=!!M,e.isText=!!N,e.adjustTextAngle=!!B,e.unusedFlag1=!!X,e.unusedFlag2=!!J,e.unusedFlag3=!!ae},jn.prototype._extractAnimationInformation=function(e,t,n){var i=t,r=n,o=this._littleEndian,a=i.getFloat32(r,o),s=i.getFloat32(r+4,o),l=i.getUint16(r+8,o),u=i.getUint16(r+10,o),d=i.getUint16(r+12,o),c=i.getUint16(r+14,o),h=(l>>8)-128,p=(u>>8)-128,g=(d>>8)-128,m=(c>>8)-128,b=l%256-128,v=u%256-128,y=d%256-128,E=c%256-128;e.beginTime=a,e.duration=s,e.easing=this._easingManager.getName(h,p,g,m,b,v,y,E)},jn.prototype._extractTextCharacters=function(e,t,n,i){e.pattern=this._textManager.extractTextFromDataView(t,n,i)},jn);function jn(e,t,n,i,r,o){this._littleEndian=fr(),this._maxScaledSize=0,this._maxMinVisibleSize=0,this._maxSymbolicSize=0,this._maxDashLength=0,this._maxGapLength=0,this._maxPatternScale=0,this._actualScaledSizeToBytes=32767,this._actualMinVisibleSizeToBytes=15,this._actualSymbolicSizeToBytes=255,this._actualDashLengthToBytes=3,this._actualGapLengthToBytes=3,this._actualPatternScaleToBytes=255,this._genericObject={valid:!1,id:void 0,end:{pieceId:0,shape:"circle",x1:0,y1:0,x2:0,y2:0,rectWidthOrSourceRadiusScaled:0,rectWidthOrSourceRadiusFixed:0,rectHeightOrTargetRadiusScaled:0,rectHeightOrTargetRadiusFixed:0,thicknessOrFontSizeScaled:0,thicknessOrFontSizeFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,offsetScaled:0,offsetFixed:0,pattern:{id:void 0,type:0,attributes:{}},opacity:1,fillColor:null,strokeColor:null,patternColor:null,globalMinVisibleSize:0,strokeMinVisibleSize:0,patternMinVisibleSize:0,offsetAngle:0,patternScale:0,symbolicSize:-1,curvature:0,dashLength:0,gapLength:0,hasHead:!1,hasTail:!1,isBodyTriangle:!1,isSelfLoop:!1,isText:!1,adjustTextAngle:!1,unusedFlag1:!1,unusedFlag2:!1,unusedFlag3:!1},start:{pieceId:0,shape:"circle",x1:0,y1:0,x2:0,y2:0,rectWidthOrSourceRadiusScaled:0,rectWidthOrSourceRadiusFixed:0,rectHeightOrTargetRadiusScaled:0,rectHeightOrTargetRadiusFixed:0,thicknessOrFontSizeScaled:0,thicknessOrFontSizeFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,offsetScaled:0,offsetFixed:0,pattern:{id:void 0,type:0,attributes:{}},opacity:1,fillColor:null,strokeColor:null,patternColor:null,globalMinVisibleSize:0,strokeMinVisibleSize:0,patternMinVisibleSize:0,offsetAngle:0,patternScale:0,symbolicSize:-1,curvature:0,dashLength:0,gapLength:0,hasHead:!1,hasTail:!1,isBodyTriangle:!1,isSelfLoop:!1,isText:!1,adjustTextAngle:!1,unusedFlag1:!1,unusedFlag2:!1,unusedFlag3:!1},animation:{duration:0,beginTime:-1,easing:"linear"}},this._shapeManager=t,this._patternManager=e,this._textManager=n,this._idRecorder=i,this._easingManager=r,this._colorParser=o}function Yn(e,t,n){return e%(1<<n)>>t}function Vr(e,t){return e*t}var df=new Array(65535);function Wd(e){var t=df[e];if(!t){var n=Yn(e,0,4)/15,i=Yn(e,4,8)/15,r=Yn(e,8,12)/15,o=Yn(e,12,16)/15;t="rgba("+(255*n|0)+", "+(255*i|0)+", "+(255*r|0)+", "+o+")",n+i+r+o==0&&(t=null),df[e]=t}return t}var G0=(ji.prototype.setDepth=function(e){return this._depth=e,this},ji.prototype.reset=function(e,t,n,i){return this._elementType=e,this._animated=t,this._depth=n,this._id=i,this._stencilUsage=1,this._size=0,this},ji.prototype.setStencilUsage=function(e){this._stencilUsage=e},ji.prototype.next=function(){if(this._size>=this._capacity)throw new Error("internal error: block.next() was called on a full block");return this._list[this._size++]},ji.prototype.nextAndReset=function(){var e,t=this.next();return sp(t.end),sp(t.start),(e=t.animation).duration=0,e.beginTime=-1,e.easing="linear",t},ji.prototype.forEach=function(e){this._list.forEach(e)},ji.prototype.getElement=function(e){return this._list[e]},ji.prototype.getCurrentElement=function(){return this._list[this._size-1]},ji.prototype.getSize=function(){return this._size},ji.prototype.getDepth=function(){return this._depth},ji.prototype.getElements=function(){return this._list},ji.prototype.getType=function(){return this._elementType},ji.prototype.getId=function(){return this._id},ji.prototype.isAnimated=function(){return this._animated},ji.prototype.getStencilUsage=function(){return this._stencilUsage},ji.prototype.setGlobalAnimation=function(e,t,n){for(var i=0;i<this._size;++i){var r=this._list[i].animation;r.duration=e,r.beginTime=t,r.easing=n}},ji);function ji(){this._elementType=1,this._animated=!1,this._size=0,this._capacity=128,this._depth=0,this._id=0,this._stencilUsage=1,this._list=Array(this._capacity);for(var e=0;e<this._capacity;++e)this._list[e]={valid:!1,id:void 0,end:{pieceId:0,shape:"circle",x1:0,y1:0,x2:0,y2:0,rectWidthOrSourceRadiusScaled:0,rectWidthOrSourceRadiusFixed:0,rectHeightOrTargetRadiusScaled:0,rectHeightOrTargetRadiusFixed:0,thicknessOrFontSizeScaled:0,thicknessOrFontSizeFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,offsetScaled:0,offsetFixed:0,pattern:{id:void 0,type:0,attributes:{}},opacity:1,fillColor:null,strokeColor:null,patternColor:null,globalMinVisibleSize:0,strokeMinVisibleSize:0,patternMinVisibleSize:0,offsetAngle:0,patternScale:0,symbolicSize:-1,curvature:0,dashLength:0,gapLength:0,hasHead:!1,hasTail:!1,isBodyTriangle:!1,isSelfLoop:!1,isText:!1,adjustTextAngle:!1,unusedFlag1:!1,unusedFlag2:!1,unusedFlag3:!1},start:{pieceId:0,shape:"circle",x1:0,y1:0,x2:0,y2:0,rectWidthOrSourceRadiusScaled:0,rectWidthOrSourceRadiusFixed:0,rectHeightOrTargetRadiusScaled:0,rectHeightOrTargetRadiusFixed:0,thicknessOrFontSizeScaled:0,thicknessOrFontSizeFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,offsetScaled:0,offsetFixed:0,pattern:{id:void 0,type:0,attributes:{}},opacity:1,fillColor:null,strokeColor:null,patternColor:null,globalMinVisibleSize:0,strokeMinVisibleSize:0,patternMinVisibleSize:0,offsetAngle:0,patternScale:0,symbolicSize:-1,curvature:0,dashLength:0,gapLength:0,hasHead:!1,hasTail:!1,isBodyTriangle:!1,isSelfLoop:!1,isText:!1,adjustTextAngle:!1,unusedFlag1:!1,unusedFlag2:!1,unusedFlag3:!1},animation:{duration:0,beginTime:-1,easing:"linear"}}}var q0=(cl.prototype.reset=function(){this._maps=[]},cl.prototype.set=function(e,t,n){for(var i=e.getId();this._maps.length<=i;)this._maps.push(new Array(512));this._maps[i][t]=n},cl.prototype.get=function(e,t){return this._maps[e.getId()][t]},cl);function cl(){this._maps=[]}var H0={x:0,y:0,zoom:1,angle:0,width:80,height:60,pixelRatio:1,backgroundColor:null,currentTime:0,isBufferDisplayable:function(){return!0},hideImages:!1,renderBackground:!1},hl={webgl:b0,canvas:R0,svg:B0},cf=[0,0,0,0],Yd={webgl:null,svg:null,canvas:null},_u=(Zt.createInitData=function(){var e={};for(var t in hl)e[t]=hl[t].createInitData();return e},Zt.cacheInitData=function(e){Yd=e},Zt.getCachedInitData=function(){return Yd},Zt.clearCachedInitData=function(){Yd={webgl:null,svg:null,canvas:null}},Zt.prototype.addCanvas=function(e){e.style.touchAction="none",e.style.msContentZooming="none",this._resizeCanvas(e),this._additionalCanvases.push(e),this._updateDomElement()},Zt.prototype.removeCanvas=function(e){e.style.touchAction="",e.style.msContentZooming="",Fa(this._additionalCanvases,e),this._updateDomElement()},Zt.prototype._ensureDomElementsFitParent=function(){if(this._domElement.offsetWidth!==this._view.width||this._domElement.offsetHeight!==this._view.height){this._domElement.style.width=this._view.width+"px",this._domElement.style.height=this._view.height+"px";for(var e=0;e<this._additionalCanvases.length;++e)this._resizeCanvas(this._additionalCanvases[e])}},Zt.prototype._ensureCorrectBackgroundColor=function(){this._backgroundColor!==this._view.backgroundColor&&(this._domElement.style.backgroundColor=this._view.backgroundColor,this._backgroundColor=this._view.backgroundColor)},Zt.prototype.createBlock=function(){return new G0},Zt.prototype.parseColor=function(e){return this._colorManager.parseColor(e)},Zt.prototype.clear=function(){this._blockIdToAddress.fill(0),this._patternManager.reset(),this._boundariesManager.reset(),this._textManager.reset(),this._bufferList.reset(),this._idRecorder.reset()},Zt.prototype.notifyFontsReloaded=function(){this._patternManager.notifyUpdate(),this._textManager.clear(),this._refreshTexts=!0},Zt.prototype.notifyPatternUpdate=function(){this._patternManager.notifyUpdate()},Zt.prototype.getShapePoints=function(e){return this._shapeManager.getDefinitionFromName(e).points},Zt.prototype.checkShapeHit=function(e,t,n){var i=this._shapeManager.getDefinitionFromName(e),o=i.getDistanceFromStrokeHorizontally;return 0<=Math.min((0,i.getDistanceFromStrokeVertically)(t,n),o(t,n))},Zt.prototype.setGlobalBoundaries=function(e){var t=e.maxBlockId,n=void 0===t?0:t,i=e.maxScaledSize,r=e.maxMinVisibleSize,o=e.maxSymbolicSize,a=e.maxDashLength,s=e.maxGapLength,l=e.maxPatternScale;return n>this._blockIdToAddress.length&&this._resizeBlockArray(n),!!this._boundariesManager.set(e)&&(this._memoryManager.resizeBoundaries(i,r,o,a,s,l),!0)},Zt.prototype._resizeBlockArray=function(e){var t=new Uint32Array(e);t.set(this._blockIdToAddress),this._blockIdToAddress=t},Zt.prototype.registerShape=function(e,t){this._shapeManager.register(e,t)},Zt.prototype._bindBlock=function(e,t,n,i,r,o,a){this._checkBlockId(e);var l=this._bufferList.allocateBlock(this._blockIdToAddress[e],t,n,i,r,o,a);return this._blockIdToAddress[e]=l.address,this._currentDataView=l.buffer.getDataView(),this._currentElementSize=l.buffer.getElementSize(),this._currentBlockOffset=l.offset,this._currentByteOffset=this._currentBlockOffset*this._currentElementSize,this._currentSideDataView=l.buffer.getSideDataView(),this._currentSideElementSize=l.buffer.getTotalSideElementsSize(),this._currentSideByteOffset=this._currentBlockOffset*this._currentSideElementSize,l},Zt.prototype._setItemIndex=function(e){var t=this._currentBlockOffset+e;this._currentByteOffset=t*this._currentElementSize,this._currentSideByteOffset=t*this._currentSideElementSize},Zt.prototype._freeBlock=function(e){this._checkBlockId(e);var n=this._bufferList.freeBlock(this._blockIdToAddress[e]);return this._blockIdToAddress[e]=n},Zt.prototype._checkBlockId=function(e){e>=this._blockIdToAddress.length&&this._resizeBlockArray(Li(e+1))},Zt.prototype._setTextCharacters=function(e){this._textManager.storeTextInDataView(this._currentSideDataView,this._currentSideByteOffset,this._currentSideByteOffset+this._currentSideElementSize,e)},Zt.prototype._storeElement=function(e,t){this._memoryManager.storeGenericObject(this._currentDataView,this._currentByteOffset,e.end),t&&(this._memoryManager.storeGenericObject(this._currentDataView,this._currentByteOffset+52,e.start),this._memoryManager.storeAnimationInformation(this._currentDataView,this._currentByteOffset+104,e.animation,this._easingManager.getCoefficients(e.animation.easing)))},Zt.prototype.storeBlock=function(e,t){if(!t||!t.getSize())return this._freeBlock(e);var n=t.getType(),i=t.getDepth(),r=t.getSize(),o=t.getElements(),a=t.isAnimated(),s=t.getStencilUsage(),l=t.getId(),u=0;if(2===n)for(var d=0;d<r;++d)7===(p=o[d]).end.pattern.type&&(u=Math.max(u,p.end.pattern.attributes.text.length)),a&&7===p.start.pattern.type&&(u=Math.max(u,p.start.pattern.attributes.text.length));var c=this._bindBlock(e,n,a,i,r,u,s);for(d=0;d<r;++d){var h=o[d];this._setItemIndex(d),this._storeElement(h,a),this._idRecorder.set(c.buffer,c.offset+d,l)}if(2===n)for(d=0;d<r;++d){var p=o[d];this._setItemIndex(d),this._setTextCharacters(p.end.pattern)}return c.address},Zt.prototype.freeBlock=function(e){return this._freeBlock(e)},Zt.prototype._refreshTextElements=function(){for(var e=0,t=this._bufferList.getBuffers();e<t.length;e++){var n=t[e];if(n&&2===n.getElementType()){for(var i=n.getSideDataView(),r=n.getTotalSideElementsSize(),o=n.getSize(),a=0,s=r,l=0;l<o;++l){var u=this._textManager.extractTextFromDataView(i,a,s);this._textManager.storeTextInDataView(i,a,s,u),a=s,s+=r}n.triggerUpdate()}}},Zt.prototype._extractElement=function(e,t){if(!e)return null;var n=this._bufferList.getBlockInfo(e);return this._renderer.extractElement(n.buffer,n.offset+t)},Zt.prototype.extractElement=function(e,t){return void 0===t&&(t=0),this._extractElement(e,t)},Zt.prototype.getDomElement=function(){return this._domElement},Zt.prototype.measureText=function(e,t,n,i){return void 0===i&&(i=1),this._textManager.measureText(e,t,n,i)},Zt.prototype.setRenderType=function(e){this._renderType!==e&&(this._renderType=e,this._switchMainRenderer=!0)},Zt.prototype._ensureMainRendererReady=function(){if(this._switchMainRenderer){var e=hl[this._renderType];e&&e.isAvailable()||(this._renderType="canvas"),this._renderer=this._renderersByType[this._renderType],this._renderer||(this._renderer=this._instanciateRenderer(this._renderType),this._renderersByType[this._renderType]=this._renderer),this._updateDomElement()}},Zt.prototype._updateDomElement=function(){for(var e=this._renderer&&this._renderer.getDomElement();this._domElement.firstChild;)this._domElement.removeChild(this._domElement.firstChild);e&&this._appendDomChild(e);for(var t=0;t<this._additionalCanvases.length;++t)this._appendDomChild(this._additionalCanvases[t])},Zt.prototype._appendDomChild=function(e){e.style.position="absolute",e.style.left="0",e.style.top="0",this._domElement.appendChild(e)},Zt.prototype._instanciateRenderer=function(e){return new(hl[e]||Cd)({initData:this._initData[e],bufferList:this._bufferList,shapeManager:this._shapeManager,patternManager:this._patternManager,boundariesManager:this._boundariesManager,textManager:this._textManager,colorManager:this._colorManager,easingManager:this._easingManager,memoryManager:this._memoryManager})},Zt.prototype.setView=function(e){this._view=Nt({},this._view,e)},Zt.prototype._updateManagers=function(){this._patternManager.setPixelRatio(this._view.pixelRatio),this._shapeManager.update(),this._patternManager.update(),this._textManager.update(),this._boundariesManager.update(),this._bufferList.update(),this._refreshTexts&&(this._refreshTexts=!1,this._refreshTextElements())},Zt.prototype._resizeCanvas=function(e){up(e,this._view.width,this._view.height,this._view.pixelRatio)},Zt.prototype.render=function(){this._ensureMainRendererReady(),this._ensureDomElementsFitParent(),this._ensureCorrectBackgroundColor(),this._updateManagers(),this._renderer.renderFrame(this._view)},Zt.prototype.ensureAnimationsReady=function(){this._ensureMainRendererReady(),this._renderer.ensureAnimationsReady()},Zt.prototype.export=function(e,t,n){var i=this._instanciateRenderer(e),r=Nt({},this._view,t);return"setViewportClipping"in i&&i.setViewportClipping(!1),r.renderBackground=!0,this._updateManagers(),i.renderFrame(r),i.export(n).then(function(){return i.getDomElement()})},Zt.prototype.getCurrentTime=function(){return P()},Zt.prototype.getImageData=function(){return this._renderer&&this._renderer.getImageData()},Zt.prototype.destroy=function(){for(var e=0,t=Object.keys(this._renderersByType);e<t.length;e++){var i=this._renderersByType[t[e]];i&&i.destroy()}},Zt.prototype.transparentify=function(e){var t=this.parseColor(e)||cf;return"rgba("+Math.round(255*t[0])+","+Math.round(255*t[1])+","+Math.round(255*t[2])+",0)"},Zt.prototype.initDebugRenderingLoop=function(e){var t=this,n=void 0===e?{}:e,i=n.triggerKey,r=void 0===i?"r":i,o=n.start,a=void 0===o||o;document.addEventListener("keydown",function(l){l.key===r&&(a=!a)});var s=function(l){(a||l)&&(t.setView({currentTime:P()}),t.render()),window.requestAnimationFrame(function(){s()})};window.requestAnimationFrame(function(){document.body.appendChild(t.getDomElement()),s(!0)})},Zt);function Zt(e){var t=this;this._view=un(H0),this._domElement=rr?document.createElement("div"):$o(),this._currentDataView=null,this._currentElementSize=0,this._currentBlockOffset=0,this._currentByteOffset=0,this._blockIdToAddress=new Uint32Array(0),this._renderersByType={},this._switchMainRenderer=!0,this._renderer=null,this._additionalCanvases=[],this._refreshTexts=!1,this._backgroundColor=null,this._initData=e||{},this._colorManager=new ou,this._easingManager=new j0,this._patternManager=new zy,this._shapeManager=new Vy,this._boundariesManager=new V0,this._textManager=new _0(this._patternManager),this._idRecorder=new q0,this._memoryManager=new Z0(this._patternManager,this._shapeManager,this._textManager,this._idRecorder,this._easingManager,function(n){return t.parseColor(n)||cf}),this._bufferList=new jy}var hf,W0=(wt(pl,hf=Rd),Object.defineProperty(pl.prototype,"src",{get:function(){return this._src},set:function(e){var t=this;e&&(this._src=e,setTimeout(function(){t.onload&&t.onload.call(t),t.width=1,t.height=1,t.fire("load")},10))},enumerable:!0,configurable:!0}),pl.prototype.addEventListener=function(e,t){this.on(e,t)},pl);function pl(e,t){var n=hf.call(this)||this;return n.isDummy=!0,n.width=0,n.height=0,n}var Y0=(fa.prototype.setImgCrossOrigin=function(e){this._crossOrigin=e},fa.prototype.clear=function(){this._images={},this._nbLoaded=0,this._nbToLoad=0},fa.prototype.getImage=function(e){var i=this,r=this._images[e];return void 0===r&&(this._nbToLoad+=1,(r=new("undefined"!=typeof Image?Image:W0)(undefined,undefined)).crossOrigin=this._crossOrigin,r.onload=function(){return i._onImgLoad(e)},r.onerror=function(){i._onImgLoad(e),i._images[e]=null},r.src=e,this._images[e]=r),r},fa.prototype._onImgLoad=function(e){this._nbLoaded+=1,this._onFetch.forEach(function(t){return t(e)}),this._nbLoaded===this._nbToLoad&&(this._whenReady.forEach(function(t){return t()}),this._whenReady=[])},fa.prototype.onFetch=function(e){this._onFetch.push(e)},fa.prototype.whenReady=function(){var e=this;return this._nbLoaded===this._nbToLoad?Promise.resolve():new Promise(function(t){return e._whenReady.push(t)})},fa.prototype.destroy=function(){this._whenReady=[],this._onFetch=[]},fa);function fa(){this._images={},this._crossOrigin="anonymous",this._whenReady=[],this._onFetch=[],this._nbLoaded=0,this._nbToLoad=0}function pf(e,t,n,i,r,o,a,s,l){void 0===s&&(s=0),void 0===l&&(l=!1);var u=yi(n,i,r,o),d=(a/2*(l?yi(e,t,r,o)/u:1)+s)/u,c=(r-n)*d,h=(o-i)*d,p=n+h,g=i-c,m=e-p,b=t-g,v=n-h-p,y=i+c-g,E=r+h-p,S=o-c-g,w=m*v+b*y,M=m*E+b*S;return 0<w&&w<v*v+y*y&&0<M&&M<E*E+S*S}function fl(e,t){return e.x===t.x&&e.y===t.y}function Ms(e,t,n,i){return Math.atan2(i-t,n-e)}function mu(e,t,n,i,r,o,a,s){var l=e-n,u=t-i,d=r-a,c=o-s,h=l*c-d*u,p=(u*(e-r)-l*(t-o))/h;if(p<0||1<p)return null;var g=(d*(o-t)+c*(e-r))/h;return 0<=g&&g<=1?{x:e-g*l,y:t-g*u}:null}function ff(e,t,n,i,r,o,a,s){var l,u=[];return(l=mu(e,t,n,i,r,o,r,s))&&u.push(l),(l=mu(e,t,n,i,r,s,a,s))&&u.push(l),(l=mu(e,t,n,i,a,s,a,o))&&u.push(l),(l=mu(e,t,n,i,a,o,r,o))&&u.push(l),u}function Is(e,t,n,i,r,o,a,s){var l=((a-r)*(t-o)-(s-o)*(e-r))/((s-o)*(n-e)-(a-r)*(i-t)),u=((n-e)*(t-o)-(i-t)*(e-r))/((s-o)*(n-e)-(a-r)*(i-t));return 0<=l&&l<=1&&0<=u&&u<=1}function Xd(e,t,n,i,r,o,a,s){return r<=e&&o<=t&&e<=a&&t<=s||r<=n&&o<=i&&n<=a&&i<=s||!!Is(e,t,n,i,r,o,r,s)||!!Is(e,t,n,i,a,o,a,s)||!!Is(e,t,n,i,r,o,a,o)||!!Is(e,t,n,i,r,s,a,s)}function gf(e,t,n){return Math.sqrt(Jd(e.x,e.y,t.x,t.y,n.x,n.y))}function Jd(e,t,n,i,r,o){var a=ul(n,i,r,o);if(0===a)return ul(e,t,n,i);var s=((e-n)*(r-n)+(t-i)*(o-i))/a;return ul(e,t,n+(s=Math.max(0,Math.min(1,s)))*(r-n),i+s*(o-i))}function _f(e,t,n,i,r,o){var a=r-n,s=o-i;if(0==a&&0==s)return{x:n,y:i};var l=((e-n)*a+(t-i)*s)/(a*a+s*s);return l<0?{x:n,y:i}:1<l?{x:r,y:o}:{x:n+l*a,y:i+l*s}}function mf(){for(var e=arguments,t=e.length-1,n=t,i=[],r=0;r<=t&&Math.abs(e[r])<=1e-12;r++)t--;switch(t){case 1:o=e[n],void 0===(s=i)&&(s=[]),0!==(a=e[n-1])&&s.push(-o/a);break;case 2:!function(o,a,s,l){void 0===l&&(l=[]);var u=a/s,d=u*u-o/s*4;if(0<d){var c=Math.sqrt(d);l.push(.5*(-u+c)),l.push(.5*(-u-c))}else 0==d&&l.push(.5*-u)}(e[n],e[n-1],e[n-2],i);break;case 3:!function(o,a,s,l,u){void 0===u&&(u=[]);var d,c,h=s/l,p=a/l,g=(3*p-h*h)/3,m=(2*h*h*h-9*p*h+o/l*27)/27,b=h/3,v=m*m/4+g*g*g/27,y=m/2;if(Math.abs(v)<=1e-6&&(v=0),0<v){var E=Math.sqrt(v);c=0<=(d=-y+E)?Math.pow(d,1/3):-Math.pow(-d,1/3),0<=(d=-y-E)?c+=Math.pow(d,1/3):c-=Math.pow(-d,1/3),u.push(c-b)}else if(v<0){var S=Math.sqrt(-g/3),w=Math.atan2(Math.sqrt(-v),-y)/3,M=Math.cos(w),O=Math.sin(w),F=Math.sqrt(3);u.push(2*S*M-b),u.push(-S*(M+F*O)-b),u.push(-S*(M-F*O)-b)}else d=0<=y?-Math.pow(y,1/3):Math.pow(-y,1/3),u.push(2*d-b),u.push(-d-b)}(e[n],e[n-1],e[n-2],e[n-3],i)}var o,a,s;return i}function ga(e,t,n,i,r,o,a,s,l,u,d){for(var c,h,p=Math.min(a,l),g=Math.min(s,u),m=Math.max(a,l),b=Math.max(s,u),v=mf((c=s-u)*(e+-2*n+r)+(h=l-a)*(t+-2*i+o),c*(-2*e+2*n)+h*(-2*t+2*i),c*e+h*t+(a*u-l*s)),y=0;y<v.length;y++){var E=v[y];if(0<=E&&E<=1){var S=e+(n-e)*E,w=t+(i-t)*E,M=S+(n+(r-n)*E-S)*E,O=w+(i+(o-i)*E-w)*E;if(a===l){if(g<=O&&O<=b){if(!d)return 1;d.push(M,O)}}else if(s===u){if(p<=M&&M<=m){if(!d)return 1;d.push(M,O)}}else if(p<=M&&g<=O&&M<=m&&O<=b){if(!d)return 1;d.push(M,O)}}}return d?d.length/2:0}function vf(e,t,n,i,r,o,a,s,l,u,d){return d?(ga(e,t,n,i,r,o,a,s,l,s,d),ga(e,t,n,i,r,o,l,s,l,u,d),ga(e,t,n,i,r,o,a,u,l,u,d),ga(e,t,n,i,r,o,a,s,a,u,d),d.length/2):a<=e&&e<=l&&s<=t&&t<=u||a<=r&&r<=l&&s<=o&&o<=u||ga(e,t,n,i,r,o,a,s,l,s)||ga(e,t,n,i,r,o,l,s,l,u)||ga(e,t,n,i,r,o,a,u,l,u)||ga(e,t,n,i,r,o,a,s,a,u)?1:0}function _a(e,t,n,i,r,o,a,s,l,u,d,c,h){for(var p,g,m=Math.min(l,d),b=Math.min(u,c),v=Math.max(l,d),y=Math.max(u,c),E=mf((p=u-c)*(-1*e+3*n+-3*r+a)+(g=d-l)*(-1*t+3*i+-3*o+s),p*(3*e+-6*n+3*r)+g*(3*t+-6*i+3*o),p*(-3*e+3*n)+g*(-3*t+3*i),p*e+g*t+(l*c-d*u)),S=0;S<E.length;S++){var w=E[S];if(0<=w&&w<=1){var M=e+(n-e)*w,O=t+(i-t)*w,F=n+(r-n)*w,L=i+(o-i)*w,N=M+(F-M)*w,B=O+(L-O)*w,X=N+(F+(r+(a-r)*w-F)*w-N)*w,J=B+(L+(o+(s-o)*w-L)*w-B)*w;if(l===d){if(b<=J&&J<=y){if(!h)return 1;h.push(X,J)}}else if(u===c){if(m<=X&&X<=v){if(!h)return 1;h.push(X,J)}}else if(m<=X&&b<=J&&X<=v&&J<=y){if(!h)return 1;h.push(X,J)}}}return h?h.length/2:0}function yf(e,t,n,i,r,o,a,s,l,u,d,c,h){return h?(_a(e,t,n,i,r,o,a,s,l,u,d,u,h),_a(e,t,n,i,r,o,a,s,d,u,d,c,h),_a(e,t,n,i,r,o,a,s,l,c,d,c,h),_a(e,t,n,i,r,o,a,s,l,u,l,c,h),h.length/2):l<=e&&e<=d&&u<=t&&t<=c||l<=a&&a<=d&&u<=s&&s<=c||_a(e,t,n,i,r,o,a,s,l,u,d,u)||_a(e,t,n,i,r,o,a,s,d,u,d,c)||_a(e,t,n,i,r,o,a,s,l,c,d,c)||_a(e,t,n,i,r,o,a,s,l,u,l,c)?1:0}function Qd(e,t,n,i,r,o,a,s){return void 0===s&&(s={x:0,y:0}),s.x=(1-e)*(1-e)*t+2*(1-e)*e*o+e*e*i,s.y=(1-e)*(1-e)*n+2*(1-e)*e*a+e*e*r,s}function xf(e,t,n,i,r,o,a,s,l,u,d){void 0===u&&(u=0),void 0===d&&(d=!1);var c=n-2*a+r,h=i-2*s+o,p=-((n-e)*h-(i-t)*c)/((2*a-2*n)*h-(2*s-2*i)*c);if(p<0||1<p)return!1;var g=l/2;return d&&(g*=1-p),g+=u,yi(Cs(n,a,r,p),Cs(i,s,o,p),e,t)<=g}function vu(e,t,n,i,r,o,a,s,l,u){void 0===u&&(u={x:0,y:0});var d=(1-e)*(1-e)*(1-e),c=3*e*(1-e)*(1-e),h=3*e*e*(1-e),p=e*e*e;return u.x=d*t+c*o+h*s+p*i,u.y=d*n+c*a+h*l+p*r,u}function bf(e,t,n,i,r,o,a,s,l,u,d,c){var h=yi(n,i,a,s);if(Math.abs(e-n)>h||Math.abs(t-i)>h)return!1;for(var p,g=.5,m=yi(e,t,n,i)<yi(e,t,r,o)?-.01:.01,b=100,v=vu(g,n,i,r,o,a,s,l,u),y=yi(e,t,v.x,v.y),E=d/2+c;0<b--&&0<=g&&g<=1&&E<y&&(.001<m||m<-.001);)p=y,vu(g,n,i,r,o,a,s,l,u,v),p<(y=yi(e,t,v.x,v.y))?g+=m=-m/2:g+m<0||1<g+m?(m/=2,y=p):g+=m;return y<E}function Kd(e,t,n,i,r,o,a){void 0===a&&(a={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0});var s=e+2/3*(n-e),l=t+2/3*(i-t);return gl(e,t,s,l,s+1/3*(r-e),l+1/3*(o-t),r,o,a)}function gl(e,t,n,i,r,o,a,s,l){void 0===l&&(l={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0});var u,d,c,h,p,g=Math.min,m=Math.max,b=Math.sqrt;l.minX=g(e,a),l.maxX=m(e,a),l.minY=g(t,s),l.maxY=m(t,s);for(var v=void 0,y=void 0,E=void 0,S=void 0,w=void 0,M=void 0,O=void 0,F=0;F<2;++F)if(p=0===F?(d=e,c=n,h=r,a):(d=t,c=i,h=o,s),y=6*d-12*c+6*h,v=-3*d+9*c-9*h+3*p,E=3*c-3*d,y|=0,E|=0,0!=(v|=0))(w=y*y-4*E*v)<0||(0<(M=(-y+b(w))/(2*v))&&M<1&&(u=$d(M,d,c,h,p),0===F?(l.minX=g(l.minX,u),l.maxX=m(l.maxX,u)):(l.minY=g(l.minY,u),l.maxY=m(l.maxY,u))),0<(O=(-y-b(w))/(2*v))&&O<1&&(u=$d(O,d,c,h,p),0===F?(l.minX=g(l.minX,u),l.maxX=m(l.maxX,u)):(l.minY=g(l.minY,u),l.maxY=m(l.maxY,u))));else{if(0===y)continue;0<(S=-E/y)&&S<1&&(u=$d(S,d,c,h,p),0===F?(l.minX=g(l.minX,u),l.maxX=m(l.maxX,u)):(l.minY=g(l.minY,u),l.maxY=m(l.maxY,u)))}return l}function $d(e,t,n,i,r){return Math.pow(1-e,3)*t+3*Math.pow(1-e,2)*e*n+3*(1-e)*Math.pow(e,2)*i+Math.pow(e,3)*r}var Q0={left:{x:-1,y:0},right:{x:1,y:0},top:{x:0,y:-1},bottom:{x:0,y:1},center:{x:0,y:0}},K0=(Vo.prototype.getDefinition=function(){return this._attributesManager.getAttributeLayerDefinition(this._id)},Vo.prototype.update=function(e){this._attributesManager.updateAttributeLayer(this._id,e)},Vo.prototype.destroy=function(){this._attributesManager.destroyAttributeLayer(this._id)},Vo.prototype.updateElements=function(e){this._attributesManager.updateElementsForAttributeLayer(this._id,e)},Vo.prototype.updateAll=function(){this._attributesManager.updateAllForAttributeLayer(this._id)},Vo.prototype.setAttributeValues=function(e,t,n){this._attributesManager.setAttributeLayerValues(this._id,e,t,n)},Vo.prototype.getUsedAttributeNames=function(e){return this._attributesManager.getUsedAttributeLayerAttributes(this._id,e)},Vo.prototype.getFlexArrays=function(){return this._attributesManager.getAttributeLayerFlexArrays(this._id)},Vo);function Vo(e,t){this._attributesManager=e,this._id=t}var Ef={storage:1,default:0},_l=(io.prototype._getAllIndexes=function(){for(var e=this._isNode?this._graph.getNodeMaxIndex():this._graph.getEdgeMaxIndex(),t=new Uint32Array(e),n=1;n<=e;++n)t[n-1]=n;return t},io.prototype.addAll=function(){this._all=!0},io.prototype.add=function(e){if(!this._all)for(var t=0;t<e._indexes.length;t++)this._addIndex(e._indexes[t])},io.prototype._addIndex=function(e){0===this._flexArray.get(e)&&(this._flexArray.set(e,1),this._indexList.push(e))},io.prototype.isEmpty=function(){return!this._all&&this._indexList.isEmpty()},io.prototype.isFull=function(){return this._all},io.prototype.getListAndClear=function(){var e=this.getList();return this.clear(),e},io.prototype.getList=function(){var e=null;if(this._all&&!this._includeRemovedElements)e=this._isNode?this._graph.getNodes("all"):this._graph.getEdges("all");else{var t=this._all?this._getAllIndexes():this._indexList.slice();e=this._eltList(t)}return e},io.prototype.clear=function(){this._all=!1,this._indexList.isEmpty()||(this._indexList.reset(),this._flexArray.reset())},io.prototype.addSet=function(e){if(e._all)this.addAll();else for(var t=e._indexList.getBuffer(),n=e._indexList.getLength(),i=0;i<n;++i)this._addIndex(t[i])},io);function io(e){var t=e.graph,n=e.isNode,i=e.includeRemovedElements;this._all=!1,this._isNode=n,this._graph=t,this._includeRemovedElements=i,this._eltList=n?this._graph.nodeList:this._graph.edgeList,this._flexArray=n?this._graph.createNodeAttribute(Ef):this._graph.createEdgeAttribute(Ef),this._all=!1,this._indexList=this._graph.createIndexList(n)}function yu(e){return"string"==typeof e}function ec(e,t){return e?e+"."+t:t}function Fi(e){return"boolean"==typeof e||0===e||1===e?e:void 0}function ma(e){return"number"==typeof e&&isFinite(e)?e:void 0}function Zn(e){return"number"==typeof e&&isFinite(e)&&0<=e?e:void 0}var Af=new Function("x","return (typeof x === 'number' && isFinite(x) && x % 1 === 0 && x >= -1 && x <= 4) ? x : undefined;");function Uo(e){return null===e||"string"==typeof e||"number"==typeof e?e:void 0}function va(e){return"fixed"===e||"scaled"===e?e:void 0}function ya(e,t){return t.parseColor(e)?e:void 0}function $i(e,t){return"inherit"===e||t.parseColor(e)?e:void 0}function ks(e){return null===e?null:"string"==typeof e?e.split(",").map(function(t){var n=t.trim(),i=-1!==n.indexOf(" "),r=n[0];return i&&'"'!==r&&"'"!==r?'"'+n+'"':n}).join(","):void 0}function Os(e){return"none"===e?"normal":"normal"===e||"italic"===e||"bold"===e||"italic bold"===e?e:void 0}function ml(e){return"left"===e||"center"===e?e:void 0}function wf(e){return[null,"arrow","circle-hole-arrow","triangle-hole-arrow","short-arrow","sharp-arrow","circle","square"].includes(e)?e:void 0}function _n(e){return new Function("x",["if (typeof x === 'number') { return (typeof x === 'number' && isFinite(x) && x >= 0) ? x : undefined; }","else if (typeof x !== 'string' || x.charAt(x.length - 1) !== '%') { return undefined; }","else { var p = parseFloat(x); return isNaN(p) ? undefined : ("+e+" * p / 100); }"].join("\n"))}function vl(e){return{_check:Uo,_set:new Function("flexArrays","index","value",["flexArrays.badges."+e+".text.content.set(index, value);","if (value === null || value === undefined) flexArrays.badges."+e+".image.url.set(index, value);"].join("\n")),_get:new Function("flexArrays","index","return flexArrays.badges."+e+".text.content.get(index);"),color:{_flexArray:"white",_check:$i},scale:{_flexArray:.45,_check:_n(.45)},positionScale:{_flexArray:1,_check:Zn},minVisibleSize:{_flexArray:12,_check:_n(12)},image:{_alias:"badges."+e+".image.url",url:{_flexArray:null,_check:Uo},scale:{_flexArray:1,_check:_n(1)}},stroke:{color:{_flexArray:"black",_check:$i},width:{_flexArray:2,_check:_n(2)},scalingMethod:{_flexArray:"fixed",_check:va}},text:{_alias:"badges."+e+".text.content",content:{_flexArray:null,_check:Uo},color:{_flexArray:"black",_check:$i},font:{_flexArray:"Arial",_check:ks},style:{_flexArray:"normal",_check:Os},scale:{_flexArray:.5,_check:_n(.5)}},threshold:"badges."+e+".minVisibleSize"}}var Cf={_check:Fi,_get:function(e,t){return 0===e.opacity.get(t)},_set:function(e,t,n){e.opacity.set(t,void 0===n?void 0:+!n)}},$0={x:{_flexArray:0,_check:ma,_disableMemoryOptimization:!0},y:{_flexArray:0,_check:ma,_disableMemoryOptimization:!0},radius:{_flexArray:5,_check:_n(5)},scalingMethod:{_flexArray:"scaled",_check:va},color:{_flexArray:"grey",_check:function(e,t){if(t.parseColor(e))return e;if(Array.isArray(e)){if(e.length<1)return;for(var n=0;n<e.length;++n)if(!t.parseColor(e[n]))return;return e}}},opacity:{_flexArray:1,_check:Zn},hidden:Cf,shape:{_flexArray:"circle",_check:function(e){return"equilateral"===e?"pentagon":"circle"===e||"square"===e||"cross"===e||"diamond"===e||"pentagon"===e||"star"===e?e:void 0}},layer:{_flexArray:0,_check:Af},detectable:{_flexArray:!0,_check:Fi},draggable:{_flexArray:!0,_check:Fi},layoutable:{_flexArray:!0,_check:Fi},innerStroke:{_alias:"innerStroke.color",width:{_flexArray:2,_check:_n(2)},scalingMethod:{_flexArray:"fixed",_check:va},color:{_flexArray:"white",_check:$i},minVisibleSize:{_flexArray:12,_check:_n(12)},threshold:"innerStroke.minVisibleSize"},outerStroke:{_alias:"outerStroke.color",width:{_flexArray:5,_check:_n(5)},scalingMethod:{_flexArray:"fixed",_check:va},color:{_flexArray:null,_check:$i},minVisibleSize:{_flexArray:0,_check:_n(0)},threshold:"outerStroke.minVisibleSize"},badges:{_check:function(e){return null===e?e:void 0},_set:function(e,t,n){e.badges.topLeft.text.content.set(t,n),e.badges.topLeft.image.url.set(t,n),e.badges.topRight.text.content.set(t,n),e.badges.topRight.image.url.set(t,n),e.badges.bottomLeft.text.content.set(t,n),e.badges.bottomLeft.image.url.set(t,n),e.badges.bottomRight.text.content.set(t,n),e.badges.bottomRight.image.url.set(t,n)},topLeft:vl("topLeft"),topRight:vl("topRight"),bottomLeft:vl("bottomLeft"),bottomRight:vl("bottomRight")},halo:{_alias:"halo.color",color:{_flexArray:null,_check:ya},width:{_flexArray:50,_check:_n(50)},scalingMethod:{_flexArray:"fixed",_check:va},strokeColor:{_flexArray:null,_check:ya},strokeWidth:{_flexArray:1,_check:_n(1)},clustering:{_flexArray:!1,_check:Fi},hideNonAdjacentEdges:{_flexArray:!1,_check:Fi},size:"halo.width"},pulse:{enabled:{_flexArray:!1,_check:Fi},duration:{_flexArray:1e3,_check:Zn},interval:{_flexArray:800,_check:Zn},startColor:{_flexArray:"rgba(0, 0, 0, 0.6)",_check:$i},endColor:{_flexArray:"rgba(0, 0, 0, 0)",_check:$i},width:{_flexArray:50,_check:Zn},startRatio:{_flexArray:1,_check:Zn},endRatio:{_flexArray:2,_check:Zn}},icon:{_alias:"icon.content",content:{_flexArray:null,_check:Uo},font:{_flexArray:"Arial",_check:ks},color:{_flexArray:"black",_check:ya},scale:{_flexArray:.7,_check:_n(.7)},style:{_flexArray:"normal",_check:Os},minVisibleSize:{_flexArray:12,_check:_n(12)},threshold:"icon.minVisibleSize"},image:{_alias:"image.url",url:{_flexArray:null,_check:Uo},scale:{_flexArray:1,_check:_n(1)},fit:{_flexArray:!0,_check:Fi},tile:{_flexArray:!1,_check:Fi},minVisibleSize:{_flexArray:12,_check:_n(12)},rescale:"image.fit",duplicate:"image.tile",threshold:"image.minVisibleSize"},outline:{_alias:"outline.enabled",enabled:{_flexArray:!1,_check:Fi},color:{_flexArray:"rgba(0, 0, 0, 0.36)",_check:ya},minVisibleSize:{_flexArray:12,_check:_n(12)}},text:{_alias:"text.content",content:{_flexArray:null,_check:Uo},font:{_flexArray:"Arial",_check:ks},color:{_flexArray:"black",_check:$i},size:{_flexArray:12,_check:_n(12)},scale:{_flexArray:.1,_check:Zn},style:{_flexArray:"normal",_check:Os},align:{_flexArray:"center",_check:ml},margin:{_flexArray:10,_check:_n(10)},padding:{_flexArray:2,_check:_n(2)},backgroundColor:{_flexArray:null,_check:$i},tip:{_flexArray:!0,_check:Fi},minVisibleSize:{_flexArray:24,_check:_n(24)},scaling:{_flexArray:!1,_check:Fi},position:{_flexArray:"bottom",_check:function(e){return"top"===e||"bottom"===e||"left"===e||"right"===e||"center"===e?e:void 0}},maxLineLength:{_flexArray:0,_check:Zn},truncateLength:{_flexArray:0,_check:Zn},backgroundArrowBaseSize:"text.margin",backgroundMargin:"text.padding",threshold:"text.minVisibleSize",secondary:{_alias:"text.secondary.content",content:{_flexArray:null,_check:Uo},font:{_flexArray:"Arial",_check:ks},color:{_flexArray:"black",_check:$i},size:{_flexArray:10,_check:_n(10)},scale:{_flexArray:.08,_check:Zn},style:{_flexArray:"normal",_check:Os},align:{_flexArray:"center",_check:ml},margin:{_flexArray:5,_check:_n(5)},padding:{_flexArray:2,_check:_n(2)},backgroundColor:{_flexArray:null,_check:$i},minVisibleSize:{_flexArray:24,_check:_n(24)},backgroundArrowBaseSize:"text.secondary.margin",backgroundMargin:"text.secondary.padding",threshold:"text.secondary.minVisibleSize"}}},ex={width:{_flexArray:1,_check:_n(1)},scalingMethod:{_flexArray:"scaled",_check:va},color:{_flexArray:"grey",_check:function(e,t){return"source"===e||"target"===e||t.parseColor(e)?e:void 0}},opacity:{_flexArray:1,_check:Zn},hidden:Cf,minVisibleSize:{_flexArray:0,_check:Zn},threshold:"minVisibleSize",layer:{_flexArray:0,_check:Af},detectable:{_flexArray:!0,_check:Fi},curvature:{_flexArray:0,_check:ma},adjustAnchors:{_flexArray:!0,_check:Fi},shape:{_check:function(e){return["line","tapered","arrow","dashed","dotted"].includes(e)?e:void 0},_set:function(e,t,n){var i=void 0,r=void 0,o=void 0,a=void 0;"line"===n?(i="line",r="plain",a=o=null):"arrow"===n?(i="line",r="plain",o="arrow",a=null):"tapered"===n?(i="triangle",r="plain",a=o=null):"dashed"===n?(i="line",r="dashed",a=o=null):"dotted"===n&&(i="line",r="dotted",a=o=null),e.shape.type.set(t,i),e.shape.style.set(t,r),e.shape.head.set(t,o),e.shape.tail.set(t,a)},type:{_flexArray:"line",_check:function(e){return"line"===e||"triangle"===e?e:void 0}},head:{_flexArray:null,_check:wf},tail:{_flexArray:null,_check:wf},style:{_flexArray:"plain",_check:function(e){return"plain"===e||"dashed"===e||"dotted"===e?e:void 0}}},stroke:{color:{_flexArray:"inherit",_check:$i},width:{_flexArray:0,_check:_n(0)},scalingMethod:{_flexArray:"fixed",_check:va},minVisibleSize:{_flexArray:0,_check:Zn}},strokeWidth:"stroke.width",halo:{_alias:"halo.color",color:{_flexArray:null,_check:ya},width:{_flexArray:10,_check:_n(10)},scalingMethod:{_flexArray:"fixed",_check:va},size:"halo.width"},pulse:{enabled:{_flexArray:!1,_check:Fi},duration:{_flexArray:1e3,_check:Zn},interval:{_flexArray:800,_check:Zn},startColor:{_flexArray:"rgba(0, 0, 0, 0.6)",_check:$i},endColor:{_flexArray:"rgba(0, 0, 0, 0)",_check:$i},width:{_flexArray:10,_check:Zn},startRatio:{_flexArray:1,_check:Zn},endRatio:{_flexArray:2,_check:Zn}},outline:{_alias:"outline.enabled",enabled:{_flexArray:!1,_check:Fi},color:{_flexArray:"rgba(0, 0, 0, 0.36)",_check:ya},minVisibleSize:{_flexArray:0,_check:Zn}},text:{_alias:"text.content",content:{_flexArray:null,_check:Uo},font:{_flexArray:"Arial",_check:ks},color:{_flexArray:"black",_check:ya},size:{_flexArray:12,_check:_n(12)},scale:{_flexArray:1,_check:Zn},style:{_flexArray:"normal",_check:Os},align:{_flexArray:"center",_check:ml},margin:{_flexArray:2,_check:_n(2)},padding:{_flexArray:2,_check:_n(2)},backgroundColor:{_flexArray:null,_check:$i},minVisibleSize:{_flexArray:4,_check:Zn},threshold:"text.minVisibleSize",adjustAngle:{_flexArray:!0,_check:Fi},scaling:{_flexArray:!1,_check:Fi},maxLineLength:{_flexArray:0,_check:Zn},secondary:{_alias:"text.secondary.content",content:{_flexArray:null,_check:Uo},font:{_flexArray:"Arial",_check:ks},color:{_flexArray:"black",_check:ya},size:{_flexArray:12,_check:_n(12)},scale:{_flexArray:.8,_check:Zn},style:{_flexArray:"normal",_check:Os},align:{_flexArray:"center",_check:ml},margin:{_flexArray:2,_check:_n(2)},padding:{_flexArray:2,_check:_n(2)},backgroundColor:{_flexArray:null,_check:$i},minVisibleSize:{_flexArray:4,_check:Zn},threshold:"text.secondary.minVisibleSize"}}};function tx(){}function nx(){}function Tf(e,t){if(!e._check)throw new Error("error somewhere for "+t);return{check:e._check,set:new Function("flexArrays","index","value","flexArrays."+t+".set(index, value);"),get:new Function("flexArrays","index","return flexArrays."+t+".get(index);"),nested:{}}}function tc(e,t,n){if(void 0!==(t=t||e)._flexArray)return Tf(t,n);var i={check:null,get:null,set:null,nested:null};if(yu(t)||t._alias){var r=yu(t)?t:t._alias;i=Tf(u=En(e,r),r)}else{if(t._set?(i.set=t._set,i.check=t._check):(i.set=tx,i.check=nx),t._get)i.get=t._get;else{var o="return "+function d(c,h){if(void 0!==c._flexArray)return"flexArrays."+h+".get(index)";for(var p=[],g=0,m=Object.keys(c);g<m.length;g++){var b=m[g],v=c[b];if(!b.startsWith("_")&&en(v)){var y=d(c[b],ec(h,b));y&&p.push(b+": "+y)}}return p.length?"{\n"+p.join(",\n").split("\n").map(function(E){return"  "+E}).join("\n")+"\n}":""}(t,n)+";";i.get=new Function("flexArrays","index",o)}i.nested={}}if(!yu(t))for(var a=0,s=Object.keys(t);a<s.length;a++){var l=s[a],u=t[l];l.startsWith("_")||(i.nested[l]=tc(e,u,ec(n,l)))}return i}function Mf(e){return e}function nc(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}var ix=tc($0),rx=tc(ex),ox={name:"animationStart",storage:32,default:0},ax={name:"animationDuration",storage:16,default:0},sx={name:"animationEasing",storage:"resource",default:"linear"},ux={self:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},adjacentNodes:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},adjacentEdges:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},allNodes:null,allEdges:null},lx={self:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},extremities:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},parallelEdges:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},allNodes:null,allEdges:null},dx={x:1,y:1,radius:1,"halo.hideNonAdjacentEdges":1},If=Object.freeze({__proto__:null,linear:Mf,quadraticIn:function(e){return e*e},quadraticOut:function(e){return e*(2-e)},quadraticInOut:nc,cubicIn:function(e){return e*e*e},cubicOut:function(e){return--e*e*e+1},cubicInOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}}),ic="_visible",rc="_data",Ja="_hovered",oc="_hoverExtremityHighlighted",xi="_selected",yl="_selectionExtremityHighlighted",xl="_dragged",kf="_rewirable",Qa="_export",ai="_faded",xa="_transparent",Of=[xi,xl,yl,Ja,oc,kf,Qa,ai,xa],cx=["hover","zoom","panning","rotation","gesture","drag","selection","tooltip","user","interactions","resizing","rewiring","connectNodes","lasso"];function Nf(e,t){return{attributes:Lf(e),tags:t?[t]:[]}}function Lf(e){var i=null;return void 0===e.output?("function"==typeof e.attributes&&(i="all"),en(e.attributes)&&(i=Ei(e.attributes))):i=e.output.attributes,bl(i,e.allAttributePaths)}function xo(e,t,n,i,r,o){!function(a,s,l,u){if(l<u)for(var d=0,c=s.attributes;d<c.length;d++)for(var h=c[d],p=0,g=a.attributes;p<g.length;p++)if(g[p]===h)return!0;for(var m=0,b=s.tags;m<b.length;m++)for(var v=b[m],y=0,E=a.tags;y<E.length;y++)if(v===E[y])return!0;return!1}(n,i,r,o)||e.push(t)}function hx(e){var t=e.dependencies;void 0===t?t=ux:en(t)||(t={});var r=Qn(e.attributes).some(function(a){return"function"==typeof a})||e.selector&&!e.standaloneSelector,o=t.adjacentEdges;return!o&&t.adjacentNodes&&(o=!0),{self:bo(t.self,r,e.allAttributePaths),adjacentNodes:bo(t.adjacentNodes,r,e.allAttributePaths),adjacentEdges:bo(o,r,e.allAttributePaths),allNodes:bo(t.allNodes,r,e.allAttributePaths),allEdges:bo(t.allEdges,r,e.allAttributePaths)}}function px(e){var t=e.dependencies;void 0===t?t=lx:en(t)||(t={});var r=Qn(e.attributes).some(function(o){return"function"==typeof o})||e.selector&&!e.standaloneSelector;return{self:bo(t.self,r,e.allAttributePaths),extremities:bo(t.extremities,r,e.allAttributePaths),parallelEdges:bo(t.parallelEdges,r,e.allAttributePaths),allNodes:bo(t.allNodes,r,e.allAttributePaths),allEdges:bo(t.allEdges,r,e.allAttributePaths)}}function bo(e,t,n){if(!t)return{attributes:[],tags:[]};if(!0===e)return{attributes:[],tags:[ic]};var i,r={attributes:bl((e=e||{}).attributes,n),tags:(i=e.tags,Array.isArray(i)?i.filter(yu):[])};return e.data&&r.tags.push(rc),e.selection&&r.tags.push(xi),e.hover&&r.tags.push(Ja),r}function fx(e){return Array.isArray(e)?e.join("."):e}function bl(e,t){if("all"===e)return t.slice();if(!Array.isArray(e))return[];var n=e.map(fx).filter(yu);return t?t.filter(function(i){return n.some(function(r){return i.startsWith(r)})}):n}var Ff=(wn.prototype.clear=function(){this._elementsToRedraw.clear(),this._elementsUpdated.clear(),this._updatedAttributes.clear(),this._updatedAttributesTmp.clear()},wn.prototype.getAttributeFlexArrays=function(){return this._finalFlexArraysWrapped},wn.prototype.getPrevAttributeFlexArrays=function(){return this._prevFlexArrays},wn.prototype.getAnimationInformation=function(e){for(var t=e._indexes,n=Array(t.length),i=0;i<t.length;i++){var r=t[i];n[i]={duration:this._finalFlexArraysWrapped.animationDuration.get(r),start:this._finalFlexArraysWrapped.animationStart.get(r),easing:this._finalFlexArraysWrapped.animationEasing.get(r)}}return n},wn.prototype.startUpdate=function(){},wn.prototype.prepareFlexArraysUpdate=function(e){this._currentFlexArrays=e.inputFlexArrays},wn.prototype.setLastFlexArrays=function(e){this._lastFlexArrays=e},wn.prototype.updateFlexArrays=function(e){var t=e.attributes,n=e.selector,i=e.context,r=e.outputFlexArrays,o=e.toUpdate,a=e.formattedOutput;this._elementsUpdated.addSet(o),this._elementsToRedraw.addSet(o);var s=o.getListAndClear();if(t&&s.size){for(var l=Dh(this._graph,s,n,i),u=l.valid,d=l.invalid,c=0,h=a.attributes;c<h.length;c++)for(var p=En(r,h[c]),g=0;g<d._indexes.length;g++)p.set(d._indexes[g],void 0);this._assignAttributesToFlexArrays(this._accessors,r,u,t,i),this._addUpdatedAttributes(e)}},wn.prototype.endUpdate=function(){for(var e=this._elementsUpdated.getList(),t=0,n=du(this._updatedAttributesTmp);t<n.length;t++)for(var i=n[t],r=En(this._lastFlexArrays,i),o=En(this._finalFlexArrays,i),a=0;a<e._indexes.length;a++){var s=e._indexes[a];o.set(s,r.get(s))}this._updatedAttributesTmp.clear(),this._currentFlexArrays=this._finalFlexArrays},wn.prototype.setAttributeValues=function(e,t,n,i){this._assignAttributesToFlexArrays(this._accessors,e.outputFlexArrays,t,n,null),this._addUpdatedAttributes(e,i),this._elementsUpdated.add(t),this._elementsToRedraw.add(t)},wn.prototype.notifyLayerDestroyed=function(e){this._addUpdatedAttributes(e)},wn.prototype._addUpdatedAttributes=function(e,t){for(var n=e.outputFlexArrays,i=e.formattedOutput,r=0,o=Array.isArray(t)?bl(t):i.attributes;r<o.length;r++){var a=o[r];En(n,a).isInitialized()&&(this._updatedAttributes.add(a),this._updatedAttributesTmp.add(a),this._allUsedAttributes.add(a))}},wn.prototype.getUsedAttributeNames=function(e){return function t(n,i,r){return void 0===i&&(i=[]),void 0===r&&(r=""),n.constructor===Pn?n.isInitialized()&&i.push(r):n.constructor===Object&&Object.keys(n).forEach(function(o){t(n[o],i,ec(r,o))}),i}(e.outputFlexArrays)},wn.prototype.redrawElements=function(e){this._elementsToRedraw.add(e)},wn.prototype.redrawAll=function(){this._elementsToRedraw.addAll()},wn.prototype.getAndResetElementsToRedraw=function(){return this._elementsToRedraw.getListAndClear()},wn.prototype.getAndResetElementsUpdated=function(){return this._elementsUpdated.getListAndClear()},wn.prototype.getAndResetAttributesUpdated=function(){var e=du(this._updatedAttributes);return this._updatedAttributes.clear(),e},wn.prototype.createFlexArrays=function(){return this._createFlexArrays(this._graph,{named:!1,useDefaultValues:!1})},wn.prototype.getAttributeValues=function(e,t,n,i){var r=i?this._prevFlexArrays:this._currentFlexArrays;return n?this._getMultipleAttributeValues(e,t,r):this._getSingleAttributeValues(e,t,r)},wn.prototype._getAccessor=function(e){void 0===e&&(e="");for(var t=this._accessors,n=Pr(e),i=0,r=n;i<r.length;i++)if(!(t=t.nested[r[i]]))throw new Error(this._eltName+' attribute "'+n.join("")+'" does not exist');return t},wn.prototype._getSingleAttributeValues=function(e,t,n){for(var i=this._getAccessor(t),r=e._indexes,o=Array(r.length),a=0;a<r.length;a++)o[a]=i.get(n,r[a]);return o},wn.prototype._getMultipleAttributeValues=function(e,t,n){if(!t||"all"===t)return this._getSingleAttributeValues(e,"",n);for(var i=Array(e.size),r=0;r<i.length;++r)i[r]={};for(r=0;r<t.length;r++)for(var o=t[r],a=this._getSingleAttributeValues(e,o,n),s=0;s<i.length;++s)Xt(i[s],o,a[s]);return i},wn.prototype.setAnimationAttributes=function(e,t){var n=t.duration,i=t.startTime,r=t.easing,o=e._indexes,a=this._finalFlexArraysWrapped.animationDuration,s=this._finalFlexArraysWrapped.animationStart,l=this._finalFlexArraysWrapped.animationEasing,u=du(this._allUsedAttributes);if(n){for(var d=!1,c=0,h=u;c<h.length;c++){var p=h[c];if("x"!==p&&"y"!==p)for(var g=En(this._finalFlexArrays,p),m=En(this._prevFlexArrays,p),b=0;b<o.length;b++){var v=o[b];m.set(v,g.get(v))}else d=!0}if(d){var y=P(),E=this._finalFlexArrays.x,S=this._finalFlexArrays.y,w=this._prevFlexArrays.x,M=this._prevFlexArrays.y;for(b=0;b<o.length;b++){var O=a.get(v=o[b]);if(O){var F=s.get(v),L=l.get(v),N=(If[L]||Mf)(Math.min((y-F)/O,1)),B=Dt(w.get(v),E.get(v),N),X=Dt(M.get(v),S.get(v),N);w.set(v,B),M.set(v,X)}else w.set(v,E.get(v)),M.set(v,S.get(v))}}}a.fill(o,n),s.fill(o,i),l.fill(o,r)},wn.prototype.resetAnimationAttributes=function(e){this._finalFlexArraysWrapped.animationDuration.fill(e._indexes,0)},wn.prototype.getUsedAttributes=function(){return du(this._allUsedAttributes)},wn.prototype.getDefaultFlexArrays=function(){return this._defaultFlexArrays},wn.prototype._assignAttributesToFlexArrays=function(e,t,n,i,r,o){if(void 0===o&&(o=[]),"function"==typeof i)for(var a=o.join("."),s=0;s<n.size;++s){var l=i(m=n.get(s),r,a);this._assignSingleValueToFlexArray(t,m,e,l,o)}else if(en(i)){var u=Object.keys(i);for(s=0;s<u.length;++s){var d=u[s];o.push(d);var c=this._getNestedAccessor(e,d,o);this._assignAttributesToFlexArrays(c,t,n,i[d],r,o),o.pop()}}else if((Array.isArray(i)||ArrayBuffer.isView(i))&&"color"!==o[0])if(o.length)for(s=0;s<n.size;++s){var p=n._indexes[s],g=e.check(i[s],this._colorManager);e.set(t,p,g)}else for(s=0;s<n.size;++s)this._assignSingleValueToFlexArray(t,n.get(s),e,i[s],o);else for(g=e.check(i,this._colorManager),s=0;s<n.size;++s){var m=n.get(s);e.set(t,m._index,g)}},wn.prototype._getNestedAccessor=function(e,t,n){var i=e.nested[t];if(!i)throw new Error(this._eltName+' attribute "'+n.join(".")+'" does not exist');return i},wn.prototype._assignSingleValueToFlexArray=function(e,t,n,i,r){if(en(i))for(var o=0,a=Object.keys(i);o<a.length;o++){var s=a[o];r.push(s);var l=i[s],u=this._getNestedAccessor(n,s,r);this._assignSingleValueToFlexArray(e,t,u,l,r),r.pop()}else{var d=n.check(i,this._colorManager);n.set(e,t._index,d)}},wn);function wn(e,t,n,i){this._lastFlexArrays=null,this._updatedAttributes=new Set,this._updatedAttributesTmp=new Set,this._allUsedAttributes=new Set,this._colorManager=t,this._graph=e,this._eltName=n?"node":"edge",this._accessors=n?ix:rx,this._createFlexArrays=i,this._finalFlexArrays=this._createFlexArrays(this._graph,{named:!0,useDefaultValues:!0}),this._prevFlexArrays=this._createFlexArrays(this._graph,{named:!1,useDefaultValues:!0}),this._defaultFlexArrays=this._createFlexArrays(this._graph,{named:!1,useDefaultValues:!0}),this._currentFlexArrays=this._defaultFlexArrays,this.setLastFlexArrays(this._defaultFlexArrays),this._elementsToRedraw=new _l({graph:this._graph,isNode:n,includeRemovedElements:!0}),this._elementsUpdated=new _l({graph:this._graph,isNode:n,includeRemovedElements:!1}),this._finalFlexArraysWrapped=Nt({},this._finalFlexArrays,{excluded:this._graph.getAttribute(n,"excluded"),textHidden:this._graph.getAttribute(n,"textHidden"),animationStart:this._graph.createAttribute(n,ox),animationDuration:this._graph.createAttribute(n,ax),animationEasing:this._graph.createAttribute(n,sx),id:this._graph.getAttribute(n,"id")},!n&&{source:this._graph.getEdgeAttribute("source"),target:this._graph.getEdgeAttribute("target")})}function gx(e,t){var n=t.named,i=t.useDefaultValues,r="resource";return{x:e.createAttribute(!0,{storage:"any",default:i?0:void 0,name:n?"x":void 0}),y:e.createAttribute(!0,{storage:"any",default:i?0:void 0,name:n?"y":void 0}),radius:e.createAttribute(!0,{storage:r,default:i?5:void 0,name:n?"radius":void 0}),scalingMethod:e.createAttribute(!0,{storage:r,default:i?"scaled":void 0,name:n?"scalingMethod":void 0}),color:e.createAttribute(!0,{storage:r,default:i?"grey":void 0,name:n?"color":void 0}),opacity:e.createAttribute(!0,{storage:r,default:i?1:void 0,name:n?"opacity":void 0}),shape:e.createAttribute(!0,{storage:r,default:i?"circle":void 0,name:n?"shape":void 0}),layer:e.createAttribute(!0,{storage:r,default:i?0:void 0,name:n?"layer":void 0}),detectable:e.createAttribute(!0,{storage:r,default:!!i||void 0,name:n?"detectable":void 0}),draggable:e.createAttribute(!0,{storage:r,default:!!i||void 0,name:n?"draggable":void 0}),layoutable:e.createAttribute(!0,{storage:r,default:!!i||void 0,name:n?"layoutable":void 0}),innerStroke:{width:e.createAttribute(!0,{storage:r,default:i?2:void 0,name:n?"innerStroke.width":void 0}),scalingMethod:e.createAttribute(!0,{storage:r,default:i?"fixed":void 0,name:n?"innerStroke.scalingMethod":void 0}),color:e.createAttribute(!0,{storage:r,default:i?"white":void 0,name:n?"innerStroke.color":void 0}),minVisibleSize:e.createAttribute(!0,{storage:r,default:i?12:void 0,name:n?"innerStroke.minVisibleSize":void 0})},outerStroke:{width:e.createAttribute(!0,{storage:r,default:i?5:void 0,name:n?"outerStroke.width":void 0}),scalingMethod:e.createAttribute(!0,{storage:r,default:i?"fixed":void 0,name:n?"outerStroke.scalingMethod":void 0}),color:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"outerStroke.color":void 0}),minVisibleSize:e.createAttribute(!0,{storage:r,default:i?0:void 0,name:n?"outerStroke.minVisibleSize":void 0})},badges:{topLeft:{color:e.createAttribute(!0,{storage:r,default:i?"white":void 0,name:n?"badges.topLeft.color":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?.45:void 0,name:n?"badges.topLeft.scale":void 0}),positionScale:e.createAttribute(!0,{storage:r,default:i?1:void 0,name:n?"badges.topLeft.positionScale":void 0}),minVisibleSize:e.createAttribute(!0,{storage:r,default:i?12:void 0,name:n?"badges.topLeft.minVisibleSize":void 0}),image:{url:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"badges.topLeft.image.url":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?1:void 0,name:n?"badges.topLeft.image.scale":void 0})},stroke:{color:e.createAttribute(!0,{storage:r,default:i?"black":void 0,name:n?"badges.topLeft.stroke.color":void 0}),width:e.createAttribute(!0,{storage:r,default:i?2:void 0,name:n?"badges.topLeft.stroke.width":void 0}),scalingMethod:e.createAttribute(!0,{storage:r,default:i?"fixed":void 0,name:n?"badges.topLeft.stroke.scalingMethod":void 0})},text:{content:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"badges.topLeft.text.content":void 0}),color:e.createAttribute(!0,{storage:r,default:i?"black":void 0,name:n?"badges.topLeft.text.color":void 0}),font:e.createAttribute(!0,{storage:r,default:i?"Arial":void 0,name:n?"badges.topLeft.text.font":void 0}),style:e.createAttribute(!0,{storage:r,default:i?"normal":void 0,name:n?"badges.topLeft.text.style":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?.5:void 0,name:n?"badges.topLeft.text.scale":void 0})}},topRight:{color:e.createAttribute(!0,{storage:r,default:i?"white":void 0,name:n?"badges.topRight.color":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?.45:void 0,name:n?"badges.topRight.scale":void 0}),positionScale:e.createAttribute(!0,{storage:r,default:i?1:void 0,name:n?"badges.topRight.positionScale":void 0}),minVisibleSize:e.createAttribute(!0,{storage:r,default:i?12:void 0,name:n?"badges.topRight.minVisibleSize":void 0}),image:{url:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"badges.topRight.image.url":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?1:void 0,name:n?"badges.topRight.image.scale":void 0})},stroke:{color:e.createAttribute(!0,{storage:r,default:i?"black":void 0,name:n?"badges.topRight.stroke.color":void 0}),width:e.createAttribute(!0,{storage:r,default:i?2:void 0,name:n?"badges.topRight.stroke.width":void 0}),scalingMethod:e.createAttribute(!0,{storage:r,default:i?"fixed":void 0,name:n?"badges.topRight.stroke.scalingMethod":void 0})},text:{content:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"badges.topRight.text.content":void 0}),color:e.createAttribute(!0,{storage:r,default:i?"black":void 0,name:n?"badges.topRight.text.color":void 0}),font:e.createAttribute(!0,{storage:r,default:i?"Arial":void 0,name:n?"badges.topRight.text.font":void 0}),style:e.createAttribute(!0,{storage:r,default:i?"normal":void 0,name:n?"badges.topRight.text.style":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?.5:void 0,name:n?"badges.topRight.text.scale":void 0})}},bottomLeft:{color:e.createAttribute(!0,{storage:r,default:i?"white":void 0,name:n?"badges.bottomLeft.color":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?.45:void 0,name:n?"badges.bottomLeft.scale":void 0}),positionScale:e.createAttribute(!0,{storage:r,default:i?1:void 0,name:n?"badges.bottomLeft.positionScale":void 0}),minVisibleSize:e.createAttribute(!0,{storage:r,default:i?12:void 0,name:n?"badges.bottomLeft.minVisibleSize":void 0}),image:{url:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"badges.bottomLeft.image.url":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?1:void 0,name:n?"badges.bottomLeft.image.scale":void 0})},stroke:{color:e.createAttribute(!0,{storage:r,default:i?"black":void 0,name:n?"badges.bottomLeft.stroke.color":void 0}),width:e.createAttribute(!0,{storage:r,default:i?2:void 0,name:n?"badges.bottomLeft.stroke.width":void 0}),scalingMethod:e.createAttribute(!0,{storage:r,default:i?"fixed":void 0,name:n?"badges.bottomLeft.stroke.scalingMethod":void 0})},text:{content:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"badges.bottomLeft.text.content":void 0}),color:e.createAttribute(!0,{storage:r,default:i?"black":void 0,name:n?"badges.bottomLeft.text.color":void 0}),font:e.createAttribute(!0,{storage:r,default:i?"Arial":void 0,name:n?"badges.bottomLeft.text.font":void 0}),style:e.createAttribute(!0,{storage:r,default:i?"normal":void 0,name:n?"badges.bottomLeft.text.style":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?.5:void 0,name:n?"badges.bottomLeft.text.scale":void 0})}},bottomRight:{color:e.createAttribute(!0,{storage:r,default:i?"white":void 0,name:n?"badges.bottomRight.color":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?.45:void 0,name:n?"badges.bottomRight.scale":void 0}),positionScale:e.createAttribute(!0,{storage:r,default:i?1:void 0,name:n?"badges.bottomRight.positionScale":void 0}),minVisibleSize:e.createAttribute(!0,{storage:r,default:i?12:void 0,name:n?"badges.bottomRight.minVisibleSize":void 0}),image:{url:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"badges.bottomRight.image.url":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?1:void 0,name:n?"badges.bottomRight.image.scale":void 0})},stroke:{color:e.createAttribute(!0,{storage:r,default:i?"black":void 0,name:n?"badges.bottomRight.stroke.color":void 0}),width:e.createAttribute(!0,{storage:r,default:i?2:void 0,name:n?"badges.bottomRight.stroke.width":void 0}),scalingMethod:e.createAttribute(!0,{storage:r,default:i?"fixed":void 0,name:n?"badges.bottomRight.stroke.scalingMethod":void 0})},text:{content:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"badges.bottomRight.text.content":void 0}),color:e.createAttribute(!0,{storage:r,default:i?"black":void 0,name:n?"badges.bottomRight.text.color":void 0}),font:e.createAttribute(!0,{storage:r,default:i?"Arial":void 0,name:n?"badges.bottomRight.text.font":void 0}),style:e.createAttribute(!0,{storage:r,default:i?"normal":void 0,name:n?"badges.bottomRight.text.style":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?.5:void 0,name:n?"badges.bottomRight.text.scale":void 0})}}},halo:{color:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"halo.color":void 0}),width:e.createAttribute(!0,{storage:r,default:i?50:void 0,name:n?"halo.width":void 0}),scalingMethod:e.createAttribute(!0,{storage:r,default:i?"fixed":void 0,name:n?"halo.scalingMethod":void 0}),strokeColor:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"halo.strokeColor":void 0}),strokeWidth:e.createAttribute(!0,{storage:r,default:i?1:void 0,name:n?"halo.strokeWidth":void 0}),clustering:e.createAttribute(!0,{storage:r,default:!i&&void 0,name:n?"halo.clustering":void 0}),hideNonAdjacentEdges:e.createAttribute(!0,{storage:r,default:!i&&void 0,name:n?"halo.hideNonAdjacentEdges":void 0})},pulse:{enabled:e.createAttribute(!0,{storage:r,default:!i&&void 0,name:n?"pulse.enabled":void 0}),duration:e.createAttribute(!0,{storage:r,default:i?1e3:void 0,name:n?"pulse.duration":void 0}),interval:e.createAttribute(!0,{storage:r,default:i?800:void 0,name:n?"pulse.interval":void 0}),startColor:e.createAttribute(!0,{storage:r,default:i?"rgba(0, 0, 0, 0.6)":void 0,name:n?"pulse.startColor":void 0}),endColor:e.createAttribute(!0,{storage:r,default:i?"rgba(0, 0, 0, 0)":void 0,name:n?"pulse.endColor":void 0}),width:e.createAttribute(!0,{storage:r,default:i?50:void 0,name:n?"pulse.width":void 0}),startRatio:e.createAttribute(!0,{storage:r,default:i?1:void 0,name:n?"pulse.startRatio":void 0}),endRatio:e.createAttribute(!0,{storage:r,default:i?2:void 0,name:n?"pulse.endRatio":void 0})},icon:{content:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"icon.content":void 0}),font:e.createAttribute(!0,{storage:r,default:i?"Arial":void 0,name:n?"icon.font":void 0}),color:e.createAttribute(!0,{storage:r,default:i?"black":void 0,name:n?"icon.color":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?.7:void 0,name:n?"icon.scale":void 0}),style:e.createAttribute(!0,{storage:r,default:i?"normal":void 0,name:n?"icon.style":void 0}),minVisibleSize:e.createAttribute(!0,{storage:r,default:i?12:void 0,name:n?"icon.minVisibleSize":void 0})},image:{url:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"image.url":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?1:void 0,name:n?"image.scale":void 0}),fit:e.createAttribute(!0,{storage:r,default:!!i||void 0,name:n?"image.fit":void 0}),tile:e.createAttribute(!0,{storage:r,default:!i&&void 0,name:n?"image.tile":void 0}),minVisibleSize:e.createAttribute(!0,{storage:r,default:i?12:void 0,name:n?"image.minVisibleSize":void 0})},outline:{enabled:e.createAttribute(!0,{storage:r,default:!i&&void 0,name:n?"outline.enabled":void 0}),color:e.createAttribute(!0,{storage:r,default:i?"rgba(0, 0, 0, 0.36)":void 0,name:n?"outline.color":void 0}),minVisibleSize:e.createAttribute(!0,{storage:r,default:i?12:void 0,name:n?"outline.minVisibleSize":void 0})},text:{content:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"text.content":void 0}),font:e.createAttribute(!0,{storage:r,default:i?"Arial":void 0,name:n?"text.font":void 0}),color:e.createAttribute(!0,{storage:r,default:i?"black":void 0,name:n?"text.color":void 0}),size:e.createAttribute(!0,{storage:r,default:i?12:void 0,name:n?"text.size":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?.1:void 0,name:n?"text.scale":void 0}),style:e.createAttribute(!0,{storage:r,default:i?"normal":void 0,name:n?"text.style":void 0}),align:e.createAttribute(!0,{storage:r,default:i?"center":void 0,name:n?"text.align":void 0}),margin:e.createAttribute(!0,{storage:r,default:i?10:void 0,name:n?"text.margin":void 0}),padding:e.createAttribute(!0,{storage:r,default:i?2:void 0,name:n?"text.padding":void 0}),backgroundColor:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"text.backgroundColor":void 0}),tip:e.createAttribute(!0,{storage:r,default:!!i||void 0,name:n?"text.tip":void 0}),minVisibleSize:e.createAttribute(!0,{storage:r,default:i?24:void 0,name:n?"text.minVisibleSize":void 0}),scaling:e.createAttribute(!0,{storage:r,default:!i&&void 0,name:n?"text.scaling":void 0}),position:e.createAttribute(!0,{storage:r,default:i?"bottom":void 0,name:n?"text.position":void 0}),maxLineLength:e.createAttribute(!0,{storage:r,default:i?0:void 0,name:n?"text.maxLineLength":void 0}),truncateLength:e.createAttribute(!0,{storage:r,default:i?0:void 0,name:n?"text.truncateLength":void 0}),secondary:{content:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"text.secondary.content":void 0}),font:e.createAttribute(!0,{storage:r,default:i?"Arial":void 0,name:n?"text.secondary.font":void 0}),color:e.createAttribute(!0,{storage:r,default:i?"black":void 0,name:n?"text.secondary.color":void 0}),size:e.createAttribute(!0,{storage:r,default:i?10:void 0,name:n?"text.secondary.size":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?.08:void 0,name:n?"text.secondary.scale":void 0}),style:e.createAttribute(!0,{storage:r,default:i?"normal":void 0,name:n?"text.secondary.style":void 0}),align:e.createAttribute(!0,{storage:r,default:i?"center":void 0,name:n?"text.secondary.align":void 0}),margin:e.createAttribute(!0,{storage:r,default:i?5:void 0,name:n?"text.secondary.margin":void 0}),padding:e.createAttribute(!0,{storage:r,default:i?2:void 0,name:n?"text.secondary.padding":void 0}),backgroundColor:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"text.secondary.backgroundColor":void 0}),minVisibleSize:e.createAttribute(!0,{storage:r,default:i?24:void 0,name:n?"text.secondary.minVisibleSize":void 0})}}}}function _x(e,t){var n=t.named,i=t.useDefaultValues,r="resource";return{width:e.createAttribute(!1,{storage:r,default:i?1:void 0,name:n?"width":void 0}),scalingMethod:e.createAttribute(!1,{storage:r,default:i?"scaled":void 0,name:n?"scalingMethod":void 0}),color:e.createAttribute(!1,{storage:r,default:i?"grey":void 0,name:n?"color":void 0}),opacity:e.createAttribute(!1,{storage:r,default:i?1:void 0,name:n?"opacity":void 0}),minVisibleSize:e.createAttribute(!1,{storage:r,default:i?0:void 0,name:n?"minVisibleSize":void 0}),layer:e.createAttribute(!1,{storage:r,default:i?0:void 0,name:n?"layer":void 0}),detectable:e.createAttribute(!1,{storage:r,default:!!i||void 0,name:n?"detectable":void 0}),curvature:e.createAttribute(!1,{storage:r,default:i?0:void 0,name:n?"curvature":void 0}),adjustAnchors:e.createAttribute(!1,{storage:r,default:!!i||void 0,name:n?"adjustAnchors":void 0}),shape:{type:e.createAttribute(!1,{storage:r,default:i?"line":void 0,name:n?"shape.type":void 0}),head:e.createAttribute(!1,{storage:r,default:i?null:void 0,name:n?"shape.head":void 0}),tail:e.createAttribute(!1,{storage:r,default:i?null:void 0,name:n?"shape.tail":void 0}),style:e.createAttribute(!1,{storage:r,default:i?"plain":void 0,name:n?"shape.style":void 0})},stroke:{color:e.createAttribute(!1,{storage:r,default:i?"inherit":void 0,name:n?"stroke.color":void 0}),width:e.createAttribute(!1,{storage:r,default:i?0:void 0,name:n?"stroke.width":void 0}),scalingMethod:e.createAttribute(!1,{storage:r,default:i?"fixed":void 0,name:n?"stroke.scalingMethod":void 0}),minVisibleSize:e.createAttribute(!1,{storage:r,default:i?0:void 0,name:n?"stroke.minVisibleSize":void 0})},halo:{color:e.createAttribute(!1,{storage:r,default:i?null:void 0,name:n?"halo.color":void 0}),width:e.createAttribute(!1,{storage:r,default:i?10:void 0,name:n?"halo.width":void 0}),scalingMethod:e.createAttribute(!1,{storage:r,default:i?"fixed":void 0,name:n?"halo.scalingMethod":void 0})},pulse:{enabled:e.createAttribute(!1,{storage:r,default:!i&&void 0,name:n?"pulse.enabled":void 0}),duration:e.createAttribute(!1,{storage:r,default:i?1e3:void 0,name:n?"pulse.duration":void 0}),interval:e.createAttribute(!1,{storage:r,default:i?800:void 0,name:n?"pulse.interval":void 0}),startColor:e.createAttribute(!1,{storage:r,default:i?"rgba(0, 0, 0, 0.6)":void 0,name:n?"pulse.startColor":void 0}),endColor:e.createAttribute(!1,{storage:r,default:i?"rgba(0, 0, 0, 0)":void 0,name:n?"pulse.endColor":void 0}),width:e.createAttribute(!1,{storage:r,default:i?10:void 0,name:n?"pulse.width":void 0}),startRatio:e.createAttribute(!1,{storage:r,default:i?1:void 0,name:n?"pulse.startRatio":void 0}),endRatio:e.createAttribute(!1,{storage:r,default:i?2:void 0,name:n?"pulse.endRatio":void 0})},outline:{enabled:e.createAttribute(!1,{storage:r,default:!i&&void 0,name:n?"outline.enabled":void 0}),color:e.createAttribute(!1,{storage:r,default:i?"rgba(0, 0, 0, 0.36)":void 0,name:n?"outline.color":void 0}),minVisibleSize:e.createAttribute(!1,{storage:r,default:i?0:void 0,name:n?"outline.minVisibleSize":void 0})},text:{content:e.createAttribute(!1,{storage:r,default:i?null:void 0,name:n?"text.content":void 0}),font:e.createAttribute(!1,{storage:r,default:i?"Arial":void 0,name:n?"text.font":void 0}),color:e.createAttribute(!1,{storage:r,default:i?"black":void 0,name:n?"text.color":void 0}),size:e.createAttribute(!1,{storage:r,default:i?12:void 0,name:n?"text.size":void 0}),scale:e.createAttribute(!1,{storage:r,default:i?1:void 0,name:n?"text.scale":void 0}),style:e.createAttribute(!1,{storage:r,default:i?"normal":void 0,name:n?"text.style":void 0}),align:e.createAttribute(!1,{storage:r,default:i?"center":void 0,name:n?"text.align":void 0}),margin:e.createAttribute(!1,{storage:r,default:i?2:void 0,name:n?"text.margin":void 0}),padding:e.createAttribute(!1,{storage:r,default:i?2:void 0,name:n?"text.padding":void 0}),backgroundColor:e.createAttribute(!1,{storage:r,default:i?null:void 0,name:n?"text.backgroundColor":void 0}),minVisibleSize:e.createAttribute(!1,{storage:r,default:i?4:void 0,name:n?"text.minVisibleSize":void 0}),adjustAngle:e.createAttribute(!1,{storage:r,default:!!i||void 0,name:n?"text.adjustAngle":void 0}),scaling:e.createAttribute(!1,{storage:r,default:!i&&void 0,name:n?"text.scaling":void 0}),maxLineLength:e.createAttribute(!1,{storage:r,default:i?0:void 0,name:n?"text.maxLineLength":void 0}),secondary:{content:e.createAttribute(!1,{storage:r,default:i?null:void 0,name:n?"text.secondary.content":void 0}),font:e.createAttribute(!1,{storage:r,default:i?"Arial":void 0,name:n?"text.secondary.font":void 0}),color:e.createAttribute(!1,{storage:r,default:i?"black":void 0,name:n?"text.secondary.color":void 0}),size:e.createAttribute(!1,{storage:r,default:i?12:void 0,name:n?"text.secondary.size":void 0}),scale:e.createAttribute(!1,{storage:r,default:i?.8:void 0,name:n?"text.secondary.scale":void 0}),style:e.createAttribute(!1,{storage:r,default:i?"normal":void 0,name:n?"text.secondary.style":void 0}),align:e.createAttribute(!1,{storage:r,default:i?"center":void 0,name:n?"text.secondary.align":void 0}),margin:e.createAttribute(!1,{storage:r,default:i?2:void 0,name:n?"text.secondary.margin":void 0}),padding:e.createAttribute(!1,{storage:r,default:i?2:void 0,name:n?"text.secondary.padding":void 0}),backgroundColor:e.createAttribute(!1,{storage:r,default:i?null:void 0,name:n?"text.secondary.backgroundColor":void 0}),minVisibleSize:e.createAttribute(!1,{storage:r,default:i?4:void 0,name:n?"text.secondary.minVisibleSize":void 0})}}}}var mx=(an.prototype._getLayerById=function(e){for(var t=0;t<this._layers.length;++t){var n=this._layers[t];if(n.id===e)return n.index=t,n}throw new Error("usage of a destroyed style rule or class")},an.prototype._fetch=function(e){return e.isNode?this._nodes:this._edges},an.prototype.getFlexArrays=function(){return{nodes:{current:this._nodes.getAttributeFlexArrays(),previous:this._nodes.getPrevAttributeFlexArrays()},edges:{current:this._edges.getAttributeFlexArrays(),previous:this._edges.getPrevAttributeFlexArrays()}}},an.prototype.createFlexArrays=function(){return{nodes:this._nodes.createFlexArrays(),edges:this._edges.createFlexArrays()}},an.prototype.clear=function(){this._updateOngoing=!1,this._needUpdate=!1,this._destroyedLayers=[],this._nodes.clear(),this._edges.clear(),this.updateAllForAllAttributeLayers()},an.prototype.redrawElements=function(e){e.size&&(this._fetch(e).redrawElements(e),this._dom.refresh())},an.prototype.redrawAll=function(){this._nodes.redrawAll(),this._edges.redrawAll(),this._dom.refresh()},an.prototype._triggerUpdate=function(){this._needUpdate=!0,this._dom.refresh()},an.prototype._reconstructAttributeLayersIfNecessary=function(){return!!this._layersNeedUpdate&&(this._reconstructAttributeLayers(),this._layersNeedUpdate=!1,this._dom.refresh(),!0)},an.prototype.getAnimationInformation=function(e){return this._fetch(e).getAnimationInformation(e)},an.prototype.update=function(){if(!this._needUpdate||this._updateOngoing||!this._ogma._token)return!1;this._reconstructAttributeLayersIfNecessary(),this._updateOngoing=!0,this._nodes.startUpdate(),this._edges.startUpdate();for(var e=0,t=this._destroyedLayers;e<t.length;e++)(r=t[e]).initialized&&(this._nodes.notifyLayerDestroyed(r.nodes),this._edges.notifyLayerDestroyed(r.edges));for(var n=0,i=this._layers;n<i.length;n++){var r,o=(r=i[n]).nodes,a=r.edges;this._nodes.prepareFlexArraysUpdate(o),this._edges.prepareFlexArraysUpdate(a),this._nodes.updateFlexArrays(o),this._edges.updateFlexArrays(a)}return this._nodes.endUpdate(),this._edges.endUpdate(),this._updateOngoing=!1,!(this._needUpdate=!1)},an.prototype.setAttributeLayerValues=function(e,t,n,i){var r=this._getLayerById(e),o=t.isNode?r.nodes:r.edges;this._reconstructAttributeLayersIfNecessary(),this._fetch(t).setAttributeValues(o,t,n,i),this._updateElementsForAttributeLayers([r],t)},an.prototype.getAttributeLayerFlexArrays=function(e){var t=this._getLayerById(e);return{nodes:t.nodes.outputFlexArrays,edges:t.edges.outputFlexArrays}},an.prototype.getUsedAttributeLayerAttributes=function(e,t){var n=this._getLayerById(e);return this._fetch(t).getUsedAttributeNames(t.isNode?n.nodes:n.edges)},an.prototype.getAndResetElementsUpdated=function(){return{nodes:this._nodes.getAndResetElementsUpdated(),edges:this._edges.getAndResetElementsUpdated(),nodeAttributes:this._nodes.getAndResetAttributesUpdated(),edgeAttributes:this._edges.getAndResetAttributesUpdated()}},an.prototype.getAndResetElementsToRedraw=function(){return{nodes:this._nodes.getAndResetElementsToRedraw(),edges:this._edges.getAndResetElementsToRedraw()}},an.prototype.addAttributeLayer=function(e){if(void 0===e&&(e={}),e.name&&this._layers.find(function(n){return n.name===e.name}))throw new Error('attribute layer with name "'+e.name+'" already exists');var t={id:++this._layerIdCounter,name:e.name,tag:e.tag,priority:0,depsNodeSelf:[],depsNodeAdjacentNodes:[],depsNodeAdjacentEdges:[],depsNodeAllNodes:[],depsNodeAllEdges:[],depsEdgeSelf:[],depsEdgeExtremities:[],depsEdgeParallelEdges:[],depsEdgeAllNodes:[],depsEdgeAllEdges:[],initialized:!1,nodes:{type:"node",name:e.name,standaloneSelector:!!e.standaloneSelectors,toUpdate:new _l({graph:this._graph,isNode:!0,includeRemovedElements:!1}),outputFlexArrays:this._nodes.createFlexArrays(),inputFlexArrays:null,formattedDependencies:null,formattedOutput:null},edges:{type:"edge",name:e.name,standaloneSelector:!!e.standaloneSelectors,toUpdate:new _l({graph:this._graph,isNode:!1,includeRemovedElements:!1}),outputFlexArrays:this._edges.createFlexArrays(),inputFlexArrays:null,formattedDependencies:null,formattedOutput:null}};return this._layers.push(t),this._updateLayer(t,e),new K0(this,this._layerIdCounter)},an.prototype._reconstructAttributeLayers=function(){this._layers.sort(function(B,X){return B.priority-X.priority});for(var e=un(this._nodes.getDefaultFlexArrays()),t=un(this._edges.getDefaultFlexArrays()),n=Ei(e),i=Ei(t),r=0,o=this._layers;r<o.length;r++)(N=o[r]).nodes.allAttributePaths=n,N.edges.allAttributePaths=i,N.nodes.formattedDependencies=hx(N.nodes),N.edges.formattedDependencies=px(N.edges),N.nodes.formattedOutput=Nf(N.nodes,N.tag),N.edges.formattedOutput=Nf(N.edges,N.tag),N.nodes.redrawAdjacentEdges=N.nodes.formattedOutput.attributes.some(function(B){return dx[B]}),N.initialized=!0;for(var a=0,s=this._layers;a<s.length;a++){(N=s[a]).nodes.inputFlexArrays=un(e),N.edges.inputFlexArrays=un(t),N.depsNodeSelf=[],N.depsNodeAdjacentNodes=[],N.depsNodeAdjacentEdges=[],N.depsNodeAllNodes=[],N.depsNodeAllEdges=[],N.depsEdgeSelf=[],N.depsEdgeExtremities=[],N.depsEdgeParallelEdges=[],N.depsEdgeAllNodes=[],N.depsEdgeAllEdges=[],N.nodes.toUpdate.addAll(),N.edges.toUpdate.addAll();for(var l=0,u=N.nodes.formattedOutput.attributes;l<u.length;l++){var d=En(e,p=u[l]);(g=En(N.nodes.outputFlexArrays,p)).setFallback(d),Xt(e,p,g)}for(var c=0,h=N.edges.formattedOutput.attributes;c<h.length;c++){var p,g;d=En(t,p=h[c]),(g=En(N.edges.outputFlexArrays,p)).setFallback(d),Xt(t,p,g)}for(var m=0,b=this._layers;m<b.length;m++){var v=b[m];if(N!==v){var y=N.priority,E=v.priority,S=N.nodes.formattedOutput,w=N.edges.formattedOutput,M=v.nodes.formattedDependencies,O=v.edges.formattedDependencies;xo(N.depsNodeSelf,v,S,M.self,y,E),xo(N.depsNodeAdjacentNodes,v,S,M.adjacentNodes,y,E),xo(N.depsNodeAdjacentEdges,v,w,O.extremities,y,E),xo(N.depsNodeAllNodes,v,S,M.allNodes,y,E),xo(N.depsNodeAllEdges,v,w,O.allNodes,y,E),xo(N.depsEdgeSelf,v,w,O.self,y,E),xo(N.depsEdgeExtremities,v,S,M.adjacentEdges,y,E),xo(N.depsEdgeParallelEdges,v,w,O.parallelEdges,y,E),xo(N.depsEdgeAllNodes,v,S,M.allEdges,y,E),xo(N.depsEdgeAllEdges,v,w,O.allEdges,y,E)}}}this._nodes.setLastFlexArrays(e),this._edges.setLastFlexArrays(t);for(var F=0,L=this._layers;F<L.length;F++){var N;(N=L[F]).nodes.needAdjacentElements=N.nodes.redrawAdjacentEdges||0<N.depsNodeAdjacentNodes.length||0<N.depsNodeAdjacentEdges.length,N.edges.needAdjacentElements=0<N.depsEdgeExtremities.length||0<N.depsEdgeParallelEdges.length}},an.prototype._updateLayer=function(e,t){void 0===t&&(t={});var n=t.priority,i=t.fullOverwrite,r=t.nodeAttributes,o=t.nodeSelector,a=t.nodeContext,s=t.nodeDependencies,l=t.nodeOutput,u=t.edgeAttributes,d=t.edgeSelector,c=t.edgeContext,h=t.edgeDependencies,p=t.edgeOutput;void 0!==r&&(e.nodes.attributes=i?r:ir(e.nodes.attributes,r)),void 0!==o&&(e.nodes.selector=o),void 0!==a&&(e.nodes.context=a),void 0!==s&&(e.nodes.dependencies=s),void 0!==l&&(e.nodes.output=l),void 0!==u&&(e.edges.attributes=i?u:ir(e.edges.attributes,u)),void 0!==d&&(e.edges.selector=d),void 0!==c&&(e.edges.context=c),void 0!==h&&(e.edges.dependencies=h),void 0!==p&&(e.edges.output=p),void 0!==n&&(e.priority=n),this._triggerLayerUpdate()},an.prototype._triggerLayerUpdate=function(){this._layersNeedUpdate=!0,this._triggerUpdate()},an.prototype.updateAllForAttributeLayer=function(e){var t=this._getLayerById(e);this._updateAllForAttributeLayer(t)},an.prototype.updateAllForAllAttributeLayers=function(){for(var e=0,t=this._layers;e<t.length;e++)this._updateAllForAttributeLayer(t[e])},an.prototype._updateAllForAttributeLayer=function(e,t,n){if(void 0===t&&(t=!0),void 0===n&&(n=!0),t&&!e.nodes.toUpdate.isFull()){e.nodes.toUpdate.addAll();for(var i=0,r=e.depsNodeSelf;i<r.length;i++){var o=r[i];this._updateAllForAttributeLayer(o,!0,!1)}for(var a=0,s=e.depsNodeAdjacentNodes;a<s.length;a++)this._updateAllForAttributeLayer(o=s[a],!0,!1);for(var l=0,u=e.depsNodeAdjacentEdges;l<u.length;l++)this._updateAllForAttributeLayer(o=u[l],!1,!0);for(var d=0,c=e.depsNodeAllNodes;d<c.length;d++)this._updateAllForAttributeLayer(o=c[d],!0,!1);for(var h=0,p=e.depsNodeAllEdges;h<p.length;h++)this._updateAllForAttributeLayer(o=p[h],!1,!0)}if(n&&!e.edges.toUpdate.isFull()){e.edges.toUpdate.addAll();for(var g=0,m=e.depsEdgeSelf;g<m.length;g++)this._updateAllForAttributeLayer(o=m[g],!1,!0);for(var b=0,v=e.depsEdgeExtremities;b<v.length;b++)this._updateAllForAttributeLayer(o=v[b],!0,!1);for(var y=0,E=e.depsEdgeParallelEdges;y<E.length;y++)this._updateAllForAttributeLayer(o=E[y],!1,!0);for(var S=0,w=e.depsEdgeAllNodes;S<w.length;S++)this._updateAllForAttributeLayer(o=w[S],!0,!1);for(var M=0,O=e.depsEdgeAllEdges;M<O.length;M++)this._updateAllForAttributeLayer(o=O[M],!1,!0)}this._triggerUpdate()},an.prototype.updateElementsForAttributeLayer=function(e,t){var n=this._getLayerById(e);this._updateElementsForAttributeLayers([n],t)},an.prototype.updateForAllAttributeLayers=function(e){this._updateElementsForAttributeLayers(this._layers,e)},an.prototype._updateElementsForAttributeLayers=function(e,t){var n=null;if(t.isNode){for(var i=0,r=e;i<r.length;i++)if(!(y=r[i]).nodes.toUpdate.isFull()){y.nodes.needAdjacentElements&&(n=n||t.fastGetAdjacentElements()),y.nodes.toUpdate.add(t);for(var o=0,a=y.depsNodeSelf;o<a.length;o++)(p=a[o]).nodes.toUpdate.add(t);for(var s=0,l=y.depsNodeAdjacentNodes;s<l.length;s++)(p=l[s]).nodes.toUpdate.add(n.nodes);for(var u=0,d=y.depsNodeAdjacentEdges;u<d.length;u++)(p=d[u]).edges.toUpdate.add(n.edges);for(var c=0,h=y.depsNodeAllNodes;c<h.length;c++){var p=h[c];this._updateAllForAttributeLayer(p,!0,!1)}for(var g=0,m=y.depsNodeAllEdges;g<m.length;g++)this._updateAllForAttributeLayer(p=m[g],!1,!0);y.nodes.redrawAdjacentEdges&&this._edges.redrawElements(n.edges)}}else for(var b=0,v=e;b<v.length;b++){var y;if(!(y=v[b]).edges.toUpdate.isFull()){y.edges.needAdjacentElements&&(n=n||t.fastGetAdjacentElements()),y.edges.toUpdate.add(t);for(var E=0,S=y.depsEdgeSelf;E<S.length;E++)(p=S[E]).edges.toUpdate.add(t);for(var w=0,M=y.depsEdgeExtremities;w<M.length;w++)(p=M[w]).nodes.toUpdate.add(n.nodes);for(var O=0,F=y.depsEdgeParallelEdges;O<F.length;O++)(p=F[O]).edges.toUpdate.add(n.edges);for(var L=0,N=y.depsEdgeAllNodes;L<N.length;L++)this._updateAllForAttributeLayer(p=N[L],!0,!1);for(var B=0,X=y.depsEdgeAllEdges;B<X.length;B++)this._updateAllForAttributeLayer(p=X[B],!1,!0)}}this._triggerUpdate()},an.prototype.destroyAttributeLayer=function(e){var t=this._getLayerById(e);this._destroyedLayers.push(t),this._layers.splice(t.index,1),this._triggerLayerUpdate()},an.prototype.updateAttributeLayer=function(e,t){var n=this._getLayerById(e);this._updateLayer(n,t)},an.prototype.getAttributeLayerDefinition=function(e){var t=this._getLayerById(e),i=t.nodes,r=t.edges;return{priority:t.priority,nodeAttributes:i.attributes,nodeSelector:i.selector,nodeContext:i.context,nodeDependencies:i.dependencies,nodeOutput:i.output,edgeAttributes:r.attributes,edgeSelector:r.selector,edgeContext:r.context,edgeDependencies:r.dependencies,edgeOutput:r.output}},an.prototype.getAttributeValues=function(e,t,n,i){return this.update(),this._fetch(e).getAttributeValues(e,t,n,i)},an.prototype.setAnimationAttributes=function(e,t){var i=e.edges;this._nodes.setAnimationAttributes(e.nodes,t),this._edges.setAnimationAttributes(i,t)},an.prototype.resetAnimationAttributes=function(e){var n=e.edges;this._nodes.resetAnimationAttributes(e.nodes),this._edges.resetAnimationAttributes(n)},an.prototype.setTextHidden=function(e,t){var n=this._textHiddenSet.addOrRemoveElements(e,t);this.redrawElements(n)},an.prototype.resetTextHidden=function(){var e=this._textHiddenSet.getElements(),t=e.nodes,n=e.edges;this._textHiddenSet.clear(),this._nodes.redrawElements(t),this._edges.redrawElements(n)},an.prototype.getUsedNodeAttributes=function(){return this._nodes.getUsedAttributes()},an.prototype.getUsedEdgeAttributes=function(){return this._edges.getUsedAttributes()},an);function an(e,t,n){this._colorManager=new ou,this._layerIdCounter=0,this._layers=[],this._destroyedLayers=[],this._layersNeedUpdate=!1,this._updateOngoing=!1,this._needUpdate=!1,this._ogma=n,this._graph=e,this._dom=t,this._textHiddenSet=new hu(this._graph,"textHidden"),this._nodes=new Ff(e,this._colorManager,!0,gx),this._edges=new Ff(e,this._colorManager,!1,_x)}function ro(e,t,n){return void 0===n&&(n=0),"inherit"===e?Array.isArray(t)?t[n/(2*Math.PI)*t.length|0]:t:e}function El(e,t){var n=e(),i=Ei(n).map(function(r){var o=En(n,r);return Array.isArray(o)?"for (var i = 0; i < "+o.length+"; ++i) {\n        target."+r+"[i] = source."+r+"[i]."+t+";\n      }\n      return target;":"target."+r+" = source."+r+"."+t+";"}).join("\n");return new Function("source, target",i)}function Pf(e){var t=e(),n=Ei(t).map(function(i){var r=En(t,i);return Array.isArray(r)?"for (var i = 0; i < "+r.length+"; ++i) {\n        target."+i+"[i] = target."+i+"[i] || source."+i+"[i];\n      }":"target."+i+" = target."+i+" || source."+i+";"}).join("\n");return new Function("target","source",n)}function Df(e){var t=(e.getDepth()-3)%6;return 0<=t&&0!==t&&3!==t}function Rf(e,t,n,i){var r,o,a,s,l,u,d,c,h,p;r=e,o=t,l=+("scaled"===(a=n).scalingMethod.get(s=i)),u=2*a.radius.get(s),d=a.innerStroke.width.get(s),c=+("scaled"===a.innerStroke.scalingMethod.get(s)),h=a.outerStroke.width.get(s),p=+("scaled"===a.outerStroke.scalingMethod.get(s)),o.x=a.x.get(s),o.y=a.y.get(s),o.shape=a.shape.get(s),o.color=a.color.get(s),o.opacity=a.opacity.get(s),o.diameterScaled=u*l,o.diameterFixed=u*(1-l),o.innerStroke.color=ro(a.innerStroke.color.get(s),o.color),o.innerStroke.widthScaled=d*c,o.innerStroke.widthFixed=d*(1-c),o.innerStroke.minVisibleSize=a.innerStroke.minVisibleSize.get(s),o.outerStroke.color=ro(a.outerStroke.color.get(s),o.color),o.outerStroke.widthScaled=h*p,o.outerStroke.widthFixed=h*(1-p),o.halo.color=a.halo.color.get(s),o.halo.strokeColor=a.halo.strokeColor.get(s),o.icon.content=r.formatText(a.icon.content.get(s)),o.image.url=a.image.url.get(s),o.outline.enabled=a.outline.enabled.get(s),o.textHidden=!!a.textHidden.get(s),zf(e,t.texts.primary,n.text,i,t),zf(e,t.texts.secondary,n.text.secondary,i,t),Sl(e,t.badges.topLeft,n.badges.topLeft,i),Sl(e,t.badges.topRight,n.badges.topRight,i),Sl(e,t.badges.bottomLeft,n.badges.bottomLeft,i),Sl(e,t.badges.bottomRight,n.badges.bottomRight,i)}function zf(e,t,n,i,r){if(t.hidden=r.textHidden,t.content=e.formatText(n.content.get(i)),t.backgroundColor=ro(n.backgroundColor.get(i),r.color),t===r.texts.primary){var o=n;t.tip=o.tip.get(i),t.position=o.position.get(i)}else t.position="bottom"}function Sl(e,t,n,i){t.textContent=e.formatText(n.text.content.get(i)),t.imageUrl=n.image.url.get(i)}function Bf(){return{x:0,y:0,shape:"",color:"",opacity:0,diameterScaled:0,diameterFixed:0,innerStroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},outerStroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},icon:{content:"",font:"",color:"",scale:0,size:0,style:"none",minVisibleSize:0},image:{url:"",content:null,scale:0,rescale:!1,duplicate:!1,minVisibleSize:0},halo:{widthScaled:0,widthFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,color:"",strokeColor:""},outline:{enabled:!1,color:"",minVisibleSize:0},badges:{topLeft:Al(Yp),topRight:Al(Xp),bottomLeft:Al(Jp),bottomRight:Al(Qp)},textHidden:!1,texts:{primary:{hidden:!1,content:"",position:"",backgroundColor:"",tip:!1,font:"",color:"",sizeScaled:0,sizeFixed:0,style:"none",align:"left",minVisibleSize:0,margin:0,padding:0,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,isPositionCenter:!1,isPositionVertical:!1,isPositionHorizontal:!1},secondary:{hidden:!1,content:"",position:"",backgroundColor:"",tip:!1,font:"",color:"",sizeScaled:0,sizeFixed:0,style:"none",align:"left",minVisibleSize:0,margin:0,padding:0,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,isPositionCenter:!1,isPositionVertical:!1,isPositionHorizontal:!1}}}}function Al(e){return{angle:e,color:"",scale:0,positionScale:0,minVisibleSize:0,strokeColor:"",strokeWidthScaled:0,strokeWidthFixed:0,textContent:"",textFont:"",textColor:"",textScale:0,textStyle:"none",imageUrl:"",imageContent:null,imageScale:0}}function xu(e,t){var n=t||{edgeHalo:0,nodeHaloStroke:0,nodeHalo:0,edgeBody:0,edgeTextBackground:0,edgeText:0,nodeBody:0,nodeTextBackground:0,nodeText:0},i=6*(e- -1)+3;return n.edgeHalo=0,n.nodeHaloStroke=1,n.nodeHalo=2,n.edgeBody=i+0,n.edgeTextBackground=i+1,n.edgeText=i+2,n.nodeBody=i+3,n.nodeTextBackground=i+4,n.nodeText=i+5,n}function Uf(e,t){var n,i;i=t,(n=e).body=!0,n.icon=!!i.icon.content,n.image=!!i.image.url,n.pieChart=Array.isArray(i.color),n.outerStroke=!!i.outerStroke.color,n.outline=!!i.outline.enabled,n.halo=!!i.halo.color,n.haloStroke=n.halo&&!!i.halo.strokeColor,jf(e.texts.primary,t.texts.primary),jf(e.texts.secondary,t.texts.secondary),wl(e.badges.topLeft,t.badges.topLeft),wl(e.badges.topRight,t.badges.topRight),wl(e.badges.bottomLeft,t.badges.bottomLeft),wl(e.badges.bottomRight,t.badges.bottomRight)}function jf(e,t){e.text=!t.hidden&&!!t.content,e.background=e.text&&!!t.backgroundColor,e.tip=e.background&&t.tip&&"center"!==t.position}function wl(e,t){e.text=!!t.textContent,e.image=!!t.imageUrl}function Cl(e,t){e.pieceId=1,e.x1=t.x,e.y1=t.y,e.x2=t.x,e.y2=t.y,e.rectWidthOrSourceRadiusScaled=t.diameterScaled,e.rectWidthOrSourceRadiusFixed=t.diameterFixed,e.rectHeightOrTargetRadiusScaled=t.diameterScaled,e.rectHeightOrTargetRadiusFixed=t.diameterFixed,e.shape=t.shape,e.opacity=t.opacity,e.symbolicSize=t.diameterScaled,e.thicknessOrFontSizeScaled=0,e.thicknessOrFontSizeFixed=0,e.strokeWidthScaled=0,e.strokeWidthFixed=0,e.offsetScaled=0,e.offsetFixed=0,e.fillColor=null,e.strokeColor=null,e.globalMinVisibleSize=0,e.strokeMinVisibleSize=0,e.offsetAngle=0,e.curvature=0,e.dashLength=0,e.gapLength=0,e.hasHead=!1,e.hasTail=!1,e.isSelfLoop=!1,e.isText=!1}function Zf(e,t,n){var i=n.diameterScaled*t.scale,r=n.diameterFixed*t.scale,o=n.diameterScaled*t.positionScale/2,a=n.diameterFixed*t.positionScale/2;e.pieceId=1,e.shape="circle",e.x1=n.x,e.y1=n.y,e.x2=n.x,e.y2=n.y,e.rectWidthOrSourceRadiusScaled=i,e.rectWidthOrSourceRadiusFixed=r,e.rectHeightOrTargetRadiusScaled=i,e.rectHeightOrTargetRadiusFixed=r,e.thicknessOrFontSizeScaled=0,e.thicknessOrFontSizeFixed=0,e.strokeWidthScaled=t.strokeWidthScaled,e.strokeWidthFixed=t.strokeWidthFixed,e.offsetScaled=o,e.offsetFixed=a,e.pattern.type=0,e.opacity=n.opacity,e.fillColor=t.color,e.strokeColor=t.strokeColor,e.patternColor=null,e.globalMinVisibleSize=t.minVisibleSize,e.strokeMinVisibleSize=0,e.patternMinVisibleSize=0,e.offsetAngle=t.angle,e.patternScale=0,e.symbolicSize=n.diameterScaled,e.curvature=0,e.dashLength=0,e.gapLength=0,e.hasHead=!1,e.hasTail=!1,e.isSelfLoop=!1,e.isText=!1}function Gf(e,t,n){var i,r,o=0,a=0;if(t.isPositionCenter||(o+=n.innerStroke.widthScaled+n.outerStroke.widthScaled+n.diameterScaled/2,a+=n.innerStroke.widthFixed+n.outerStroke.widthFixed+n.diameterFixed/2+t.margin+t.padding),t.isPositionVertical){if(o+=t.heightScaled/2,a+=t.heightFixed/2,t===n.texts.secondary&&"bottom"===n.texts.primary.position){var s=n.texts.primary;o+=s.heightScaled,a+=s.heightFixed+s.margin+2*s.padding}}else t.isPositionHorizontal&&(o+=t.widthScaled/2,a+=t.widthFixed/2);r=0<t.sizeScaled?(i="sdf",1):(i=t.sizeFixed,0),e.pieceId=1,e.shape="square",e.x1=n.x,e.y1=n.y,e.x2=n.x,e.y2=n.y,e.rectWidthOrSourceRadiusScaled=t.widthScaled,e.rectWidthOrSourceRadiusFixed=t.widthFixed+2*t.padding,e.rectHeightOrTargetRadiusScaled=t.heightScaled,e.rectHeightOrTargetRadiusFixed=t.heightFixed+2*t.padding,e.thicknessOrFontSizeScaled=0,e.thicknessOrFontSizeFixed=0,e.strokeWidthScaled=0,e.strokeWidthFixed=0,e.offsetScaled=o,e.offsetFixed=a,e.pattern.type=0,e.pattern.attributes.size=i,e.opacity=n.opacity,e.fillColor=null,e.strokeColor=null,e.patternColor=null,e.globalMinVisibleSize=t.minVisibleSize,e.strokeMinVisibleSize=0,e.patternMinVisibleSize=0,e.offsetAngle=t.positionAngle,e.patternScale=r,e.symbolicSize=n.diameterScaled,e.curvature=0,e.dashLength=0,e.gapLength=0,e.hasHead=!1,e.hasTail=!1,e.isSelfLoop=!1,e.isText=!1}function qf(e,t,n,i,r,o){var a=r.badges,s=i.badges,l=o.badges;(function(u,d,c,h,p){if(h.halo){var g=c.halo.width.get(d),m=+("scaled"===c.halo.scalingMethod.get(d));p.halo.widthScaled=g*m,p.halo.widthFixed=g*(1-m),E=(y=p).diameterScaled+2*y.halo.widthScaled,S=y.diameterFixed+2*y.halo.widthFixed,(v=h.halo).pieceId=1,v.shape="circle",v.x1=y.x,v.y1=y.y,v.x2=y.x,v.y2=y.y,v.rectWidthOrSourceRadiusScaled=E,v.rectWidthOrSourceRadiusFixed=S,v.rectHeightOrTargetRadiusScaled=E,v.rectHeightOrTargetRadiusFixed=S,v.thicknessOrFontSizeScaled=0,v.thicknessOrFontSizeFixed=0,v.strokeWidthScaled=0,v.strokeWidthFixed=0,v.offsetScaled=0,v.offsetFixed=0,v.pattern.type=0,v.opacity=y.opacity,v.fillColor=y.halo.color,v.strokeColor=null,v.patternColor=null,v.globalMinVisibleSize=0,v.strokeMinVisibleSize=0,v.patternMinVisibleSize=0,v.offsetAngle=0,v.patternScale=0,v.symbolicSize=y.diameterScaled,v.curvature=0,v.dashLength=0,v.gapLength=0,v.hasHead=!1,v.hasTail=!1,v.isSelfLoop=!1,v.isText=!1,h.haloStroke&&(p.halo.strokeWidthScaled=0,p.halo.strokeWidthFixed=c.halo.strokeWidth.get(d),function(v,y){var E=y.diameterScaled+2*y.halo.widthScaled,S=y.diameterFixed+2*y.halo.widthFixed;v.pieceId=1,v.shape="circle",v.x1=y.x,v.y1=y.y,v.x2=y.x,v.y2=y.y,v.rectWidthOrSourceRadiusScaled=E,v.rectWidthOrSourceRadiusFixed=S,v.rectHeightOrTargetRadiusScaled=E,v.rectHeightOrTargetRadiusFixed=S,v.thicknessOrFontSizeScaled=0,v.thicknessOrFontSizeFixed=0,v.strokeWidthScaled=y.halo.strokeWidthScaled,v.strokeWidthFixed=y.halo.strokeWidthFixed,v.offsetScaled=0,v.offsetFixed=0,v.pattern.type=0,v.opacity=y.opacity,v.fillColor=null,v.strokeColor=y.halo.strokeColor,v.patternColor=null,v.globalMinVisibleSize=0,v.strokeMinVisibleSize=0,v.patternMinVisibleSize=0,v.offsetAngle=0,v.patternScale=0,v.symbolicSize=y.diameterScaled,v.curvature=0,v.dashLength=0,v.gapLength=0,v.hasHead=!1,v.hasTail=!1,v.isSelfLoop=!1,v.isText=!1}(h.haloStroke,p))}var v,y,E,S;h.outline&&(p.outline.color=c.outline.color.get(d),p.outline.minVisibleSize=c.outline.minVisibleSize.get(d),function(v,y){var E=1.1*y.diameterScaled,S=1.1*y.diameterFixed,w=.07*y.diameterScaled,M=.07*y.diameterFixed+1;y.outerStroke.color&&(w+=y.outerStroke.widthScaled/2,M+=y.outerStroke.widthFixed/2),v.pieceId=1,v.shape=y.shape,v.x1=y.x,v.y1=y.y,v.x2=y.x,v.y2=y.y,v.rectWidthOrSourceRadiusScaled=E,v.rectWidthOrSourceRadiusFixed=S,v.rectHeightOrTargetRadiusScaled=E,v.rectHeightOrTargetRadiusFixed=S,v.thicknessOrFontSizeScaled=0,v.thicknessOrFontSizeFixed=0,v.strokeWidthScaled=0,v.strokeWidthFixed=0,v.offsetScaled=w,v.offsetFixed=M,v.pattern.type=0,v.opacity=y.opacity,v.fillColor=y.outline.color,v.strokeColor=null,v.patternColor=null,v.globalMinVisibleSize=y.outline.minVisibleSize,v.strokeMinVisibleSize=0,v.patternMinVisibleSize=0,v.offsetAngle=1.5707963267948966,v.patternScale=0,v.symbolicSize=y.diameterScaled,v.curvature=0,v.dashLength=0,v.gapLength=0,v.hasHead=!1,v.hasTail=!1,v.isSelfLoop=!1,v.isText=!1}(h.outline,p)),h.outerStroke&&(p.outerStroke.minVisibleSize=c.outerStroke.minVisibleSize.get(d),function(v,y){var E=y.diameterScaled+2*y.innerStroke.widthScaled,S=y.diameterFixed+2*y.innerStroke.widthFixed;v.pieceId=1,v.shape=y.shape,v.x1=y.x,v.y1=y.y,v.x2=y.x,v.y2=y.y,v.rectWidthOrSourceRadiusScaled=E,v.rectWidthOrSourceRadiusFixed=S,v.rectHeightOrTargetRadiusScaled=E,v.rectHeightOrTargetRadiusFixed=S,v.thicknessOrFontSizeScaled=0,v.thicknessOrFontSizeFixed=0,v.strokeWidthScaled=y.outerStroke.widthScaled,v.strokeWidthFixed=y.outerStroke.widthFixed,v.offsetScaled=0,v.offsetFixed=0,v.pattern.type=0,v.opacity=y.opacity,v.fillColor=null,v.strokeColor=y.outerStroke.color,v.patternColor=null,v.globalMinVisibleSize=y.outerStroke.minVisibleSize,v.strokeMinVisibleSize=0,v.patternMinVisibleSize=0,v.offsetAngle=0,v.patternScale=0,v.symbolicSize=y.diameterScaled,v.curvature=0,v.dashLength=0,v.gapLength=0,v.hasHead=!1,v.hasTail=!1,v.isSelfLoop=!1,v.isText=!1}(h.outerStroke,p)),h.pieChart&&function(v,y){Cl(v,y),Array.isArray(y.color)&&(v.pattern.type=4,v.pattern.attributes.colors=y.color.join(";"),v.patternScale=1,v.patternMinVisibleSize=0,v.patternColor=null)}(h.pieChart,p),h.image&&(p.image.content=u.imageManager.getImage(p.image.url),p.image.fit=c.image.fit.get(d),p.image.tile=c.image.tile.get(d),p.image.scale=c.image.scale.get(d),p.image.minVisibleSize=c.image.minVisibleSize.get(d),function(v,y){var E=y.image.fit&&!y.image.tile;Cl(v,y),v.pattern.type=2,v.pattern.attributes.image=y.image.content,v.pattern.attributes.scaled=E,v.pattern.attributes.duplicated=y.image.tile,v.patternScale=E?y.image.scale:0,v.patternMinVisibleSize=y.image.minVisibleSize,v.patternColor=null}(h.image,p)),h.icon&&(p.icon.font=u.fontManager.getFont(c.icon.font.get(d)),p.icon.style=c.icon.style.get(d),p.icon.color=c.icon.color.get(d),p.icon.scale=c.icon.scale.get(d),p.icon.minVisibleSize=c.icon.minVisibleSize.get(d),function(v,y){Cl(v,y),v.pattern.type=5,v.pattern.attributes.text=y.icon.content,v.pattern.attributes.font=y.icon.font,v.pattern.attributes.style=y.icon.style,v.pattern.attributes.size="sdf",v.patternMinVisibleSize=y.icon.minVisibleSize,v.patternColor=y.icon.color,v.patternScale=y.icon.scale}(h.icon,p)),h.body&&function(v,y,E){Cl(v,y),v.fillColor=Array.isArray(y.color)?null:y.color,v.strokeColor=y.innerStroke.color,v.strokeMinVisibleSize=y.innerStroke.minVisibleSize,v.strokeWidthScaled=y.innerStroke.widthScaled,v.strokeWidthFixed=y.innerStroke.widthFixed,E&&(v.pattern.type=0)}(h.body,p,!h.pieChart&&!h.image&&!h.icon)})(t,n,i,r,o),Hf(e,t,n,i.text,r.texts.primary,o.texts.primary,o),Hf(e,t,n,i.text.secondary,r.texts.secondary,o.texts.secondary,o),Tl(e,t,n,s.topLeft,a.topLeft,l.topLeft,o),Tl(e,t,n,s.topRight,a.topRight,l.topRight,o),Tl(e,t,n,s.bottomLeft,a.bottomLeft,l.bottomLeft,o),Tl(e,t,n,s.bottomRight,a.bottomRight,l.bottomRight,o)}function Tl(e,t,n,i,r,o,a){if(r.image||r.text){var s=i.stroke.width.get(n),l=+("scaled"===i.stroke.scalingMethod.get(n));o.color=ro(i.color.get(n),a.color,o.angle),o.strokeColor=i.stroke.color.get(n),o.strokeWidthScaled=s*l,o.strokeWidthFixed=s*(1-l),o.minVisibleSize=i.minVisibleSize.get(n),o.positionScale=i.positionScale.get(n),o.scale=i.scale.get(n)}var u,d,c,h;if(r.image&&(o.imageContent=t.imageManager.getImage(o.imageUrl),o.imageScale=i.image.scale.get(n),Zf(u=r.image,d=o,a),d.imageContent?(u.pattern.type=2,u.pattern.attributes.image=d.imageContent,u.pattern.attributes.scaled=!0,u.pattern.attributes.duplicated=!1,u.patternScale=d.imageScale,u.patternMinVisibleSize=0,u.patternColor=null):(u.fillColor=null,u.strokeColor=null)),r.text){if(o.textFont=t.fontManager.getFont(i.text.font.get(n)),o.textStyle=i.text.style.get(n),o.textColor=ro(i.text.color.get(n),a.color),o.textScale=i.text.scale.get(n),1<e.measureText(o.textContent,o.textFont,o.textStyle,o.textScale).width){for(var p=0,g=0;g<o.textContent.length&&p<1;)p+=e.measureText(o.textContent[g],o.textFont,o.textStyle,o.textScale).width,g+=1;g!==o.textContent.length&&(o.textContent=o.textContent.substring(0,g-1)+"\u2025")}Zf(c=r.text,h=o,a),h.textContent&&(c.pattern.type=6,c.pattern.attributes.text=h.textContent,c.pattern.attributes.font=h.textFont,c.pattern.attributes.style=h.textStyle,c.pattern.attributes.size="sdf",c.patternMinVisibleSize=0,c.patternColor=h.textColor,c.patternScale=h.textScale),!h.imageUrl&&h.textContent||(c.fillColor=null,c.strokeColor=null)}}function Hf(e,t,n,i,r,o,a){if(r.text){var s=i,l=s.scaling.get(n);if(o.font=t.fontManager.getFont(s.font.get(n)),o.color=ro(s.color.get(n),a.color),o.style=s.style.get(n),o.align=s.align.get(n),o.minVisibleSize=s.minVisibleSize.get(n),o.margin=s.margin.get(n),o.padding=s.padding.get(n),o.maxLineLength=s.maxLineLength.get(n),o.content=Bd(o.content,o.maxLineLength),l){var u=s.scale.get(n);o.sizeScaled=a.diameterScaled*u,o.sizeFixed=a.diameterFixed*u}else o.sizeFixed=s.size.get(n),o.sizeScaled=0;var d=e.measureText(o.content,o.font,o.style);o.widthScaled=d.width*o.sizeScaled,o.widthFixed=d.width*o.sizeFixed,o.heightScaled=d.height*o.sizeScaled,o.heightFixed=d.height*o.sizeFixed,o.positionAngle=F0[o.position],o.isPositionCenter="center"===o.position,o.isPositionVertical="top"===o.position||"bottom"===o.position,o.isPositionHorizontal="left"===o.position||"right"===o.position,Gf(M=r.text,O=o,a),M.pattern.type=7,M.pattern.attributes.text=O.content,M.pattern.attributes.font=O.font,M.pattern.attributes.style=O.style,M.pattern.attributes.align=O.align,M.patternMinVisibleSize=0,M.patternColor=O.color,M.thicknessOrFontSizeScaled=O.sizeScaled,M.thicknessOrFontSizeFixed=O.sizeFixed,M.isText=!0,r.background&&(Gf(S=r.background,w=o,a),S.fillColor=w.backgroundColor,r.tip&&(c=r.tip,h=o,p=a,g=Math.ceil(h.margin/2)+1,m=p.diameterScaled/2+p.innerStroke.widthScaled+p.outerStroke.widthScaled,b=p.diameterFixed/2+p.innerStroke.widthFixed+p.outerStroke.widthFixed+g,v=P0[h.position],y=Math.cos(v),E=Math.sin(v),c.pieceId=1,c.shape="triangle",c.x1=p.x-y,c.y1=p.y-E,c.x2=p.x+y,c.y2=p.y+E,c.rectWidthOrSourceRadiusScaled=0,c.rectWidthOrSourceRadiusFixed=h.margin,c.rectHeightOrTargetRadiusScaled=0,c.rectHeightOrTargetRadiusFixed=.6666666666666666*h.margin,c.thicknessOrFontSizeScaled=0,c.thicknessOrFontSizeFixed=0,c.strokeWidthScaled=0,c.strokeWidthFixed=0,c.offsetScaled=m,c.offsetFixed=b,c.pattern.type=0,c.opacity=p.opacity,c.fillColor=h.backgroundColor,c.strokeColor=null,c.patternColor=null,c.globalMinVisibleSize=h.minVisibleSize,c.strokeMinVisibleSize=0,c.patternMinVisibleSize=0,c.offsetAngle=h.positionAngle,c.patternScale=0,c.symbolicSize=p.diameterScaled,c.curvature=0,c.dashLength=0,c.gapLength=0,c.hasHead=!1,c.hasTail=!1,c.isSelfLoop=!1))}var c,h,p,g,m,b,v,y,E,S,w,M,O}var vx=El(ba,"start"),yx=El(ba,"end"),xx=Pf(ba),bx=(Tr.prototype.drawNode=function(e){if(this._computeBlockIds(e),this._attributes.excluded.get(e))return this._freeBlocks();var t=this._engine,n=this._helper,i=e,r=xu(this._attributes.layer.get(e),this._depthInfo),o=this._attributes.animationDuration.get(e),a=0<o;if(this._prepareBlocks(a,r,i),Rf(n,this._endInput,this._attributes,e),Uf(this._endFlags,this._endInput),a&&(Rf(n,this._startInput,this._attributesPrev,e),Uf(this._startFlags,this._startInput),xx(this._endFlags,this._startFlags)),this._initComponents(this._fullComponents,this._endFlags,this._blocks),yx(this._fullComponents,this._endComponents),qf(t,n,e,this._attributes,this._endComponents,this._endInput),a&&(vx(this._fullComponents,this._startComponents),qf(t,n,e,this._attributesPrev,this._startComponents,this._startInput)),a){var s=this._attributes.animationStart.get(e),l=this._attributes.animationEasing.get(e);this._setBlocksAnimation(o,s,l)}this._endFlags.halo&&this._attributes.halo.hideNonAdjacentEdges.get(e)&&(this._blocks.halo.setStencilUsage(2),this._blocks.haloStroke.setStencilUsage(2)),this._storeBlocks()},Tr.prototype._computeBlockIds=function(e){var t=10*e,n=this._blockIds;n.body=0+t,n.text=1+t,n.textBg=2+t,n.halo=3+t,n.haloStroke=4+t},Tr.prototype._prepareBlocks=function(e,t,n){var i=this._blocks;i.body.reset(1,e,t.nodeBody,n),i.text.reset(2,e,t.nodeText,n),i.textBg.reset(1,e,t.nodeTextBackground,n),i.halo.reset(1,e,t.nodeHalo,n),i.haloStroke.reset(1,e,t.nodeHaloStroke,n)},Tr.prototype._storeBlocks=function(){var e=this._engine,t=this._blocks,n=this._blockIds;e.storeBlock(n.body,t.body),e.storeBlock(n.text,t.text),e.storeBlock(n.textBg,t.textBg),e.storeBlock(n.halo,t.halo),e.storeBlock(n.haloStroke,t.haloStroke)},Tr.prototype._freeBlocks=function(){var e=this._engine,t=this._blockIds;e.freeBlock(t.body),e.freeBlock(t.text),e.freeBlock(t.textBg),e.freeBlock(t.halo),e.freeBlock(t.haloStroke)},Tr.prototype._setBlocksAnimation=function(e,t,n){var i=this._blocks;i.body.setGlobalAnimation(e,t,n),i.text.setGlobalAnimation(e,t,n),i.textBg.setGlobalAnimation(e,t,n),i.halo.setGlobalAnimation(e,t,n),i.haloStroke.setGlobalAnimation(e,t,n)},Tr.prototype._initComponents=function(e,t,n){this._nodePatternAssigned=!1,this._initBaseComponents(e,t,n),this._initBadgeComponents(e.badges.topLeft,t.badges.topLeft,n),this._initBadgeComponents(e.badges.topRight,t.badges.topRight,n),this._initBadgeComponents(e.badges.bottomLeft,t.badges.bottomLeft,n),this._initBadgeComponents(e.badges.bottomRight,t.badges.bottomRight,n),this._initTextComponents(e.texts.primary,t.texts.primary,n),this._initTextComponents(e.texts.secondary,t.texts.secondary,n)},Tr.prototype._initBaseComponents=function(e,t,n){e.haloStroke=this._nextElement(t.haloStroke,n.haloStroke),e.halo=this._nextElement(t.halo,n.halo),e.outline=this._nextElement(t.outline,n.body),e.outerStroke=this._nextElement(t.outerStroke,n.body),e.body=this._nextElement(t.body,n.body),e.pieChart=this._getNodePatternElement(t.pieChart,n),e.image=this._getNodePatternElement(t.image,n),e.icon=this._getNodePatternElement(t.icon,n)},Tr.prototype._initBadgeComponents=function(e,t,n){e.image=this._nextElement(t.image,n.body),e.text=this._nextElement(t.text,n.body)},Tr.prototype._initTextComponents=function(e,t,n){e.background=this._nextElement(t.background,n.textBg),e.tip=this._nextElement(t.tip,n.textBg),e.text=this._nextElement(t.text,n.text)},Tr.prototype._nextElement=function(e,t){return e?t.next():this._nullElt},Tr.prototype._getNodePatternElement=function(e,t){return e?this._nodePatternAssigned?t.body.next():(this._nodePatternAssigned=!0,t.body.getCurrentElement()):this._nullElt},Tr);function Tr(e){var t=e.engine,n=e.imageManager,i=e.fontManager,r=e.formatText,o=e.attributes,a=e.attributesPrev;this._fullComponents={haloStroke:void 0,halo:void 0,outline:void 0,outerStroke:void 0,body:void 0,pieChart:void 0,image:void 0,icon:void 0,badges:{topLeft:{text:void 0,image:void 0},topRight:{text:void 0,image:void 0},bottomLeft:{text:void 0,image:void 0},bottomRight:{text:void 0,image:void 0}},texts:{primary:{text:void 0,background:void 0,tip:void 0},secondary:{text:void 0,background:void 0,tip:void 0}}},this._startComponents={haloStroke:void 0,halo:void 0,outline:void 0,outerStroke:void 0,body:void 0,pieChart:void 0,image:void 0,icon:void 0,badges:{topLeft:{text:void 0,image:void 0},topRight:{text:void 0,image:void 0},bottomLeft:{text:void 0,image:void 0},bottomRight:{text:void 0,image:void 0}},texts:{primary:{text:void 0,background:void 0,tip:void 0},secondary:{text:void 0,background:void 0,tip:void 0}}},this._endComponents={haloStroke:void 0,halo:void 0,outline:void 0,outerStroke:void 0,body:void 0,pieChart:void 0,image:void 0,icon:void 0,badges:{topLeft:{text:void 0,image:void 0},topRight:{text:void 0,image:void 0},bottomLeft:{text:void 0,image:void 0},bottomRight:{text:void 0,image:void 0}},texts:{primary:{text:void 0,background:void 0,tip:void 0},secondary:{text:void 0,background:void 0,tip:void 0}}},this._startFlags={haloStroke:void 0,halo:void 0,outline:void 0,outerStroke:void 0,body:void 0,pieChart:void 0,image:void 0,icon:void 0,badges:{topLeft:{text:void 0,image:void 0},topRight:{text:void 0,image:void 0},bottomLeft:{text:void 0,image:void 0},bottomRight:{text:void 0,image:void 0}},texts:{primary:{text:void 0,background:void 0,tip:void 0},secondary:{text:void 0,background:void 0,tip:void 0}}},this._endFlags={haloStroke:void 0,halo:void 0,outline:void 0,outerStroke:void 0,body:void 0,pieChart:void 0,image:void 0,icon:void 0,badges:{topLeft:{text:void 0,image:void 0},topRight:{text:void 0,image:void 0},bottomLeft:{text:void 0,image:void 0},bottomRight:{text:void 0,image:void 0}},texts:{primary:{text:void 0,background:void 0,tip:void 0},secondary:{text:void 0,background:void 0,tip:void 0}}},this._startInput=Bf(),this._endInput=Bf(),this._depthInfo={edgeHalo:0,nodeHaloStroke:0,nodeHalo:0,edgeBody:0,edgeTextBackground:0,edgeText:0,nodeBody:0,nodeTextBackground:0,nodeText:0},this._nodePatternAssigned=!1,this._nullElt={id:-1,valid:!0,animation:null,start:null,end:null},this._engine=t,this._attributes=o,this._attributesPrev=a,this._helper={imageManager:n,fontManager:i,formatText:r},this._blocks=Wf(function(){return t.createBlock()}),this._blockIds=Wf(function(){return 0})}function Wf(e){return{body:e(),text:e(),textBg:e(),halo:e(),haloStroke:e()}}function ba(){return{haloStroke:void 0,halo:void 0,outline:void 0,outerStroke:void 0,body:void 0,pieChart:void 0,image:void 0,icon:void 0,badges:{topLeft:{text:void 0,image:void 0},topRight:{text:void 0,image:void 0},bottomLeft:{text:void 0,image:void 0},bottomRight:{text:void 0,image:void 0}},texts:{primary:{text:void 0,background:void 0,tip:void 0},secondary:{text:void 0,background:void 0,tip:void 0}}}}function sc(e,t,n,i,r,o){var a,s,l,u,d,c,h,p,g;return s=i-e,l=r-t,n+o<(u=Math.sqrt(s*s+l*l))||u<Math.abs(n-o)?null:(g=t+l*(a=(n*n-o*o+u*u)/(2*u))/u,[[(p=e+s*a/u)+(c=(d=Math.sqrt(n*n-a*a))/u*-l),g+(h=d/u*s)],[p-c,g-h]])}function uc(e,t,n,i,r,o){if(0<=e-r&&n-r<0)return 1;if(e-r<0&&0<=n-r)return-1;if(e-r==0&&n-r==0)return 0<=t-i||0<=i-o?t-i:i-t;var a=(e-r)*(i-o)-(n-r)*(t-o);return a<0?1:0<a?-1:(e-r)*(e-r)+(t-o)*(t-o)-((n-r)*(n-r)+(i-o)*(i-o))}function Yf(e,t,n){var r=e[1],o=e[2],a=Math.abs(e[0]-t),s=Math.abs(r-n);return a+s<=o||!(o<a||o<s)&&Math.sqrt(a*a+s*s)<o+1e-12}function Xf(e,t,n,i){var r=e[0]-t,o=e[1]-n,a=e[2]-i;return r*r+o*o<a*a+1e-6}function lc(e,t,n,i,r,o,a){var s=e-Math.max(i,Math.min(o,e)),l=t-Math.max(r,Math.min(a,t));return s*s+l*l<n*n}function Jf(e,t,n,i,r,o,a,s){void 0===s&&(s={x:0,y:0});var l,u,d,c,h=s||{x:0,y:0};if(n===e){var p=e-r,g=a*a-p*p;if(g<0)return null;var m=Math.sqrt(g);d=l=e,u=o+m,c=o-m}else{var b=(i-t)/(n-e),v=t-b*e,y=v-o,E=b*b+1,S=2*(b*y-r),w=S*S-4*E*(r*r+y*y-a*a);if(w<0)return null;var M=-S,O=Math.sqrt(w),F=2*E;u=b*(l=(M+O)/F)+v,c=b*(d=(M-O)/F)+v}var L=e-l,N=t-u,B=e-d,X=t-c;return L*L+N*N<B*B+X*X?(h.x=l,h.y=u):(h.x=d,h.y=c),h}function Qf(e,t,n,i,r,o){(function(a,s,l,u,d){var xt,c=u.source,h=u.target,p=s.source.get(l),g=s.target.get(l),m=c.x.get(p),b=c.y.get(p),v=c.radius.get(p),y=c.color.get(p),E=+("scaled"===c.scalingMethod.get(p)),S=h.x.get(g),w=h.y.get(g),M=h.radius.get(g),O=h.color.get(g),F=+("scaled"===h.scalingMethod.get(g)),L="source"===(xt=s.color.get(l))?y:"target"===xt?O:xt,N=s.width.get(l),B=+("scaled"===s.scalingMethod.get(l)),X=s.stroke.width.get(l),J=+("scaled"===s.stroke.scalingMethod.get(l)),ae=L0[s.shape.style.get(l)],ie=s.adjustAnchors.get(l);if(a.source=p,a.target=g,a.sourceX=m,a.sourceY=b,a.targetX=S,a.targetY=w,a.sourceRadiusScaled=v*E,a.sourceRadiusFixed=v*(1-E),a.targetRadiusScaled=M*F,a.targetRadiusFixed=M*(1-F),a.widthScaled=N*B,a.widthFixed=N*(1-B),a.curvature=s.curvature.get(l),a.isSelfLoop=p===g,a.color=L,a.opacity=s.opacity.get(l),a.minVisibleSize=s.minVisibleSize.get(l),a.shape.type=s.shape.type.get(l),a.shape.head=s.shape.head.get(l),a.shape.tail=s.shape.tail.get(l),a.shape.dashLength=ae.dash,a.shape.gapLength=ae.gap,a.shape.isBodyTriangle="triangle"===a.shape.type,a.stroke.color=ro(s.stroke.color.get(l),L),a.stroke.widthScaled=X*J,a.stroke.widthFixed=X*(1-J),a.stroke.minVisibleSize=s.stroke.minVisibleSize.get(l),a.halo.color=s.halo.color.get(l),a.outline.enabled=s.outline.enabled.get(l),a.textHidden=1===s.textHidden.get(l),ie&&(a.shape.head||a.shape.tail||"triangle"===a.shape.type)){var U=a,Y=U.curvature,he=U.sourceX,pe=U.sourceY,we=U.targetX,ke=U.targetY,at=1,st=1;if(Y){if(!U.isSelfLoop){var Xe=pa(he,pe,we,ke,Y/2);at=Ml(0,d,c,p,he,pe,Xe.x,Xe.y),st=Ml(0,d,h,g,we,ke,Xe.x,Xe.y)}}else at=Ml(0,d,c,p,he,pe,we,ke),st=Ml(0,d,h,g,we,ke,he,pe);a.sourceRadiusScaled*=at,a.sourceRadiusFixed*=at,a.targetRadiusScaled*=st,a.targetRadiusFixed*=st}})(t,n,i,r,o),Kf(e,t.texts.primary,n.text,i,t),Kf(e,t.texts.secondary,n.text.secondary,i,t)}function Kf(e,t,n,i,r){t.hidden=r.textHidden,t.content=e.formatText(n.content.get(i)),t.backgroundColor=ro(n.backgroundColor.get(i),r.color)}function Ml(e,t,n,i,r,o,a,s){var l=t.angle,u=Math.atan2(s-o,a-r)-l,d=1,c=0,h=null;u<-Br?u+=gu:Br<u&&(u-=gu),h=u<-Br/2?(c=Yp,n.badges.topLeft):u<0?(c=Xp,n.badges.topRight):u<Br/2?(c=Qp,n.badges.bottomRight):(c=Jp,n.badges.bottomLeft),c+=l;var p,g=h.text.content.get(i),m=h.image.url.get(i);if((p=g)||0===p||m){var b=h.positionScale.get(i),v=h.scale.get(i),y=Jf(a,s,r,o,r+(M=Math.cos(c))*b,o+(O=Math.sin(c))*b,v);if(y){var E=y.x-r,S=y.y-o,w=Math.sqrt(E*E+S*S);d=Math.max(d,w)}}if("square"===n.shape.get(i)){var M=Math.abs(Math.cos(u)),O=Math.abs(Math.sin(u)),F=1/Math.max(M,O);d=Math.max(d,F)}return d}function tg(e,t){dc(e.body,t,!0,!0),dc(e.outline,t,t.outline.enabled,!0),dc(e.halo,t,!!t.halo.color,!1),ng(e.texts.primary,t.texts.primary),ng(e.texts.secondary,t.texts.secondary)}function dc(e,t,n,i){e.body=n,e.head=n&&i&&!!t.shape.head,e.tail=n&&i&&!!t.shape.tail}function ng(e,t){e.text=!t.hidden&&!!t.content,e.background=e.text&&!!t.backgroundColor}function Ex(e,t,n,i){cc(e,t,n,i),e.thicknessOrFontSizeScaled=t.widthScaled,e.thicknessOrFontSizeFixed=t.widthFixed,e.strokeWidthScaled=t.stroke.widthScaled,e.strokeWidthFixed=t.stroke.widthFixed,e.offsetScaled=0,e.offsetFixed=0,e.fillColor=t.color,e.strokeColor=t.stroke.color,e.globalMinVisibleSize=t.minVisibleSize,e.strokeMinVisibleSize=t.stroke.minVisibleSize,e.offsetAngle=0,e.symbolicSize=t.widthScaled,e.dashLength=t.shape.dashLength,e.gapLength=t.shape.gapLength,e.hasHead=!!t.shape.head,e.hasTail=!!t.shape.tail,e.isBodyTriangle=t.shape.isBodyTriangle}function cc(e,t,n,i){e.pieceId=n,e.shape=i,e.x1=t.sourceX,e.y1=t.sourceY,e.x2=t.targetX,e.y2=t.targetY,e.rectWidthOrSourceRadiusScaled=t.sourceRadiusScaled,e.rectWidthOrSourceRadiusFixed=t.sourceRadiusFixed,e.rectHeightOrTargetRadiusScaled=t.targetRadiusScaled,e.rectHeightOrTargetRadiusFixed=t.targetRadiusFixed,e.thicknessOrFontSizeScaled=0,e.thicknessOrFontSizeFixed=0,e.strokeWidthScaled=0,e.strokeWidthFixed=0,e.offsetScaled=0,e.offsetFixed=0,e.pattern.type=0,e.opacity=t.opacity,e.fillColor=null,e.strokeColor=null,e.patternColor=null,e.globalMinVisibleSize=t.minVisibleSize,e.strokeMinVisibleSize=null,e.patternMinVisibleSize=0,e.offsetAngle=0,e.patternScale=0,e.symbolicSize=t.widthScaled,e.curvature=t.curvature,e.dashLength=0,e.gapLength=0,e.hasHead=!1,e.hasTail=!1,e.isSelfLoop=t.isSelfLoop,e.isText=!1}function Sx(e,t,n){var i=t.widthScaled+2*t.halo.widthScaled,r=t.widthFixed+2*t.halo.widthFixed;cc(e,t,n,"line"),e.thicknessOrFontSizeScaled=i,e.thicknessOrFontSizeFixed=r,e.strokeWidthScaled=0,e.strokeWidthFixed=0,e.offsetScaled=0,e.offsetFixed=0,e.fillColor=t.halo.color,e.strokeColor=null,e.globalMinVisibleSize=t.minVisibleSize,e.strokeMinVisibleSize=0,e.offsetAngle=0,e.symbolicSize=t.widthScaled,e.dashLength=0,e.gapLength=0,e.hasHead=!1,e.hasTail=!1,e.isBodyTriangle=!1}function Ax(e,t,n,i){cc(e,t,n,i),e.thicknessOrFontSizeScaled=1*t.widthScaled,e.thicknessOrFontSizeFixed=1*t.widthFixed,e.strokeWidthScaled=0,e.strokeWidthFixed=0,e.offsetScaled=.17*t.widthScaled,e.offsetFixed=.17*t.widthFixed+1,e.fillColor=t.outline.color,e.strokeColor=null,e.globalMinVisibleSize=Math.max(t.minVisibleSize,t.outline.minVisibleSize),e.strokeMinVisibleSize=0,e.offsetAngle=Math.PI/2,e.symbolicSize=t.widthScaled,e.dashLength=t.shape.dashLength,e.gapLength=t.shape.gapLength,e.hasHead=!!t.shape.head,e.hasTail=!!t.shape.tail,e.isBodyTriangle=t.shape.isBodyTriangle}function ig(e,t,n){var i=(n.widthScaled+t.heightScaled)/2+n.stroke.widthScaled,r=(n.widthFixed+t.heightFixed)/2+n.stroke.widthFixed+t.padding+t.margin;e.pieceId=5,e.shape="square",e.x1=n.sourceX,e.y1=n.sourceY,e.x2=n.targetX,e.y2=n.targetY,e.rectWidthOrSourceRadiusScaled=t.widthScaled,e.rectWidthOrSourceRadiusFixed=t.widthFixed+2*t.padding+1,e.rectHeightOrTargetRadiusScaled=t.heightScaled,e.rectHeightOrTargetRadiusFixed=t.heightFixed+2*t.padding,e.thicknessOrFontSizeScaled=0,e.thicknessOrFontSizeFixed=0,e.strokeWidthScaled=n.sourceRadiusScaled+n.targetRadiusScaled,e.strokeWidthFixed=n.sourceRadiusFixed+n.targetRadiusFixed,e.offsetScaled=i,e.offsetFixed=r,e.pattern.type=0,e.opacity=n.opacity,e.fillColor=null,e.strokeColor=null,e.patternColor=null,e.globalMinVisibleSize=Math.max(t.minVisibleSize,n.minVisibleSize),e.strokeMinVisibleSize=0,e.patternMinVisibleSize=0,e.offsetAngle=t.offsetAngle,e.patternScale=0,e.symbolicSize=n.widthScaled,e.curvature=n.curvature,e.dashLength=0,e.gapLength=0,e.hasHead=!1,e.hasTail=!1,e.isSelfLoop=n.isSelfLoop,e.isText=!1,e.adjustTextAngle=t.adjustAngle}function rg(e,t,n,i,r,o){(function(a,s,l,u){if(hc(l.body,u,Ex),l.halo.body){var d=s.halo.width.get(a),c=+("scaled"===s.halo.scalingMethod.get(a));u.halo.widthScaled=d*c,u.halo.widthFixed=d*(1-c),hc(l.halo,u,Sx)}l.outline.body&&(u.outline.color=s.outline.color.get(a),u.outline.minVisibleSize=s.outline.minVisibleSize.get(a),hc(l.outline,u,Ax))})(n,i,r,o),og(e,t,n,i.text,r.texts.primary,o.texts.primary,o),og(e,t,n,i.text.secondary,r.texts.secondary,o.texts.secondary,o)}function hc(e,t,n){n(e.body,t,2,t.shape.type),e.head&&n(e.head,t,3,t.shape.head),e.tail&&n(e.tail,t,4,t.shape.tail)}function og(e,t,n,i,r,o,a){if(r.text){var s=i,l=s.scaling.get(n);if(o.font=t.fontManager.getFont(s.font.get(n)),o.color=ro(s.color.get(n),a.color),o.style=s.style.get(n),o.minVisibleSize=s.minVisibleSize.get(n),o.margin=s.margin.get(n),o.padding=s.padding.get(n),o.maxLineLength=s.maxLineLength.get(n),o.content=Bd(o.content,o.maxLineLength),o.adjustAngle=s.adjustAngle.get(n),o.align=s.align.get(n),l){var u=s.scale.get(n);o.sizeScaled=a.widthScaled*u,o.sizeFixed=a.widthFixed*u}else o.sizeFixed=s.size.get(n),o.sizeScaled=0;var d=e.measureText(o.content,o.font,o.style);o.widthScaled=d.width*o.sizeScaled,o.widthFixed=d.width*o.sizeFixed,o.heightScaled=d.height*o.sizeScaled,o.heightFixed=d.height*o.sizeFixed,o.offsetAngle=o===a.texts.primary?k0:O0,ig(p=r.text,g=o,a),p.pattern.type=7,p.pattern.attributes.text=g.content,p.pattern.attributes.size="sdf",p.pattern.attributes.font=g.font,p.pattern.attributes.style=g.style,p.pattern.attributes.align=g.align,p.patternColor=g.color,p.patternScale=1,p.thicknessOrFontSizeScaled=g.sizeScaled,p.thicknessOrFontSizeFixed=g.sizeFixed,p.isText=!0,r.background&&(ig(c=r.background,h=o,a),c.fillColor=h.backgroundColor)}var c,h,p,g}var wx=El(Ea,"start"),Cx=El(Ea,"end"),Tx=Pf(Ea),Mx=(Ur.prototype.drawEdge=function(e){if(this._computeBlockIds(e),this._attributes.excluded.get(e))this._freeBlocks();else{var t=this._engine,n=this._helper,i=this._extremitiesAttributes,r=-e,o=xu(this._attributes.layer.get(e),this._depthInfo),a=this._attributes,s=a.source.get(e),l=a.target.get(e),u=a.curvature.get(e),d=this._attributesPrev.curvature.get(e),c=a.animationDuration.get(e),h=a.animationStart.get(e),p=a.animationEasing.get(e),g=0<c;if(this._prepareBlocks(g,o,r,0!==u||g&&0!==d),i.source=this._nodeAttributes,i.target=this._nodeAttributes,Qf(n,this._endInput,a,e,i,this._view),tg(this._endFlags,this._endInput),g){var b=0<this._nodeAttributes.animationDuration.get(s),v=0<this._nodeAttributes.animationDuration.get(l);i.source=b?this._nodeAttributesPrev:this._nodeAttributes,i.target=v?this._nodeAttributesPrev:this._nodeAttributes,Qf(n,this._startInput,this._attributesPrev,e,i,this._view),tg(this._startFlags,this._startInput),Tx(this._endFlags,this._startFlags)}this._initComponents(this._fullComponents,this._endFlags,this._blocks),Cx(this._fullComponents,this._endComponents),rg(t,n,e,this._attributes,this._endComponents,this._endInput),g&&(wx(this._fullComponents,this._startComponents),rg(t,n,e,this._attributesPrev,this._startComponents,this._startInput),this._setBlocksAnimation(c,h,p)),this._setupHaloMasking(s,l),this._storeBlocks()}},Ur.prototype._setupHaloMasking=function(e,t){var n=this._nodeAttributes.halo,i=this._blocks,r=n.color.get(e)&&n.hideNonAdjacentEdges.get(e),o=n.color.get(t)&&n.hideNonAdjacentEdges.get(t),a=r||o?1:3;i.body.setStencilUsage(a),i.text.setStencilUsage(a),i.textBg.setStencilUsage(a)},Ur.prototype._computeBlockIds=function(e){var t=10*e,n=this._blockIds;n.body=5+t,n.halo=8+t,n.text=6+t,n.textBg=7+t},Ur.prototype._prepareBlocks=function(e,t,n,i){var r=this._blocks;r.body.reset(i?3:1,e,t.edgeBody,n),r.halo.reset(i?3:1,e,t.edgeHalo,n),r.text.reset(2,e,t.edgeText,n),r.textBg.reset(1,e,t.edgeTextBackground,n)},Ur.prototype._storeBlocks=function(){var e=this._engine,t=this._blocks,n=this._blockIds;e.storeBlock(n.body,t.body),e.storeBlock(n.halo,t.halo),e.storeBlock(n.text,t.text),e.storeBlock(n.textBg,t.textBg)},Ur.prototype._freeBlocks=function(){var e=this._engine,t=this._blockIds;e.freeBlock(t.body),e.freeBlock(t.halo),e.freeBlock(t.text),e.freeBlock(t.textBg)},Ur.prototype._setBlocksAnimation=function(e,t,n){var i=this._blocks;i.body.setGlobalAnimation(e,t,n),i.halo.setGlobalAnimation(e,t,n),i.text.setGlobalAnimation(e,t,n),i.textBg.setGlobalAnimation(e,t,n)},Ur.prototype._initComponents=function(e,t,n){this._initEdgeComponents(e.halo,t.halo,n.halo),this._initEdgeComponents(e.outline,t.outline,n.body),this._initEdgeComponents(e.body,t.body,n.body),this._initTextComponents(e.texts.primary,t.texts.primary,n),this._initTextComponents(e.texts.secondary,t.texts.secondary,n)},Ur.prototype._initEdgeComponents=function(e,t,n){e.head=this._nextElement(t.head,n),e.tail=this._nextElement(t.tail,n),e.body=this._nextElement(t.body,n)},Ur.prototype._initTextComponents=function(e,t,n){e.background=this._nextElement(t.background,n.textBg),e.text=this._nextElement(t.text,n.text)},Ur.prototype._nextElement=function(e,t){return e?t.next():this._nullElt},Ur);function Ur(e){var t=e.engine,n=e.imageManager,i=e.fontManager,r=e.formatText,o=e.view,a=e.attributes,s=e.attributesPrev,l=e.nodeAttributes,u=e.nodeAttributesPrev;this._extremitiesAttributes={source:null,target:null},this._fullComponents={halo:{body:void 0,head:void 0,tail:void 0},outline:{body:void 0,head:void 0,tail:void 0},body:{body:void 0,head:void 0,tail:void 0},texts:{primary:{text:void 0,background:void 0},secondary:{text:void 0,background:void 0}}},this._startComponents={halo:{body:void 0,head:void 0,tail:void 0},outline:{body:void 0,head:void 0,tail:void 0},body:{body:void 0,head:void 0,tail:void 0},texts:{primary:{text:void 0,background:void 0},secondary:{text:void 0,background:void 0}}},this._endComponents={halo:{body:void 0,head:void 0,tail:void 0},outline:{body:void 0,head:void 0,tail:void 0},body:{body:void 0,head:void 0,tail:void 0},texts:{primary:{text:void 0,background:void 0},secondary:{text:void 0,background:void 0}}},this._startFlags={halo:{body:void 0,head:void 0,tail:void 0},outline:{body:void 0,head:void 0,tail:void 0},body:{body:void 0,head:void 0,tail:void 0},texts:{primary:{text:void 0,background:void 0},secondary:{text:void 0,background:void 0}}},this._endFlags={halo:{body:void 0,head:void 0,tail:void 0},outline:{body:void 0,head:void 0,tail:void 0},body:{body:void 0,head:void 0,tail:void 0},texts:{primary:{text:void 0,background:void 0},secondary:{text:void 0,background:void 0}}},this._startInput={source:0,target:0,sourceX:0,sourceY:0,targetX:0,targetY:0,sourceRadiusScaled:0,sourceRadiusFixed:0,targetRadiusScaled:0,targetRadiusFixed:0,widthScaled:0,widthFixed:0,curvature:0,isSelfLoop:!1,color:"",opacity:0,minVisibleSize:0,shape:{type:"line",head:null,tail:null,dashLength:0,gapLength:0,isBodyTriangle:!1},stroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},halo:{widthScaled:0,widthFixed:0,color:""},outline:{enabled:!1,color:"",minVisibleSize:0},textHidden:!1,texts:{primary:{align:"left",hidden:!1,content:"",backgroundColor:"",font:"",color:"",sizeScaled:0,sizeFixed:0,style:"none",minVisibleSize:0,margin:0,padding:0,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,adjustAngle:!1,offsetAngle:0},secondary:{align:"left",hidden:!1,content:"",backgroundColor:"",font:"",color:"",sizeScaled:0,sizeFixed:0,style:"none",minVisibleSize:0,margin:0,padding:0,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,adjustAngle:!1,offsetAngle:0}}},this._endInput={source:0,target:0,sourceX:0,sourceY:0,targetX:0,targetY:0,sourceRadiusScaled:0,sourceRadiusFixed:0,targetRadiusScaled:0,targetRadiusFixed:0,widthScaled:0,widthFixed:0,curvature:0,isSelfLoop:!1,color:"",opacity:0,minVisibleSize:0,shape:{type:"line",head:null,tail:null,dashLength:0,gapLength:0,isBodyTriangle:!1},stroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},halo:{widthScaled:0,widthFixed:0,color:""},outline:{enabled:!1,color:"",minVisibleSize:0},textHidden:!1,texts:{primary:{align:"left",hidden:!1,content:"",backgroundColor:"",font:"",color:"",sizeScaled:0,sizeFixed:0,style:"none",minVisibleSize:0,margin:0,padding:0,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,adjustAngle:!1,offsetAngle:0},secondary:{align:"left",hidden:!1,content:"",backgroundColor:"",font:"",color:"",sizeScaled:0,sizeFixed:0,style:"none",minVisibleSize:0,margin:0,padding:0,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,adjustAngle:!1,offsetAngle:0}}},this._depthInfo={edgeHalo:0,nodeHaloStroke:0,nodeHalo:0,edgeBody:0,edgeTextBackground:0,edgeText:0,nodeBody:0,nodeTextBackground:0,nodeText:0},this._nullElt={id:-1,valid:!0,animation:null,start:null,end:null},this._engine=t,this._view=o,this._helper={imageManager:n,fontManager:i,formatText:r},this._attributes=a,this._attributesPrev=s,this._nodeAttributes=l,this._nodeAttributesPrev=u,this._blocks=ag(function(){return t.createBlock()}),this._blockIds=ag(function(){return 0})}function ag(e){return{body:e(),halo:e(),text:e(),textBg:e()}}function Ea(){return{halo:{body:void 0,head:void 0,tail:void 0},outline:{body:void 0,head:void 0,tail:void 0},body:{body:void 0,head:void 0,tail:void 0},texts:{primary:{text:void 0,background:void 0},secondary:{text:void 0,background:void 0}}}}var kx=po&&document.fonts,pc="/qwerty/ [HELLO] \uf155\uf155\uf155",Ox=(Il.prototype._measureText=function(e,t){return this._ctx.font="12px "+t,this._ctx.measureText(e).width},Il.prototype.check=function(e){if(this._checkReliable)return this._fontFaceSet.check("12px "+e);var t=this._measureText(pc,"serif");return this._measureText(pc,e)!==t},Il.prototype.load=function(e){return this._fontFaceSet&&this._fontFaceSet.load?this._fontFaceSet.load("12px "+e):(this._ctx.font="12px "+e,this._ctx.fillText(pc,10,50),Promise.resolve())},Il);function Il(){this._fontFaceSet=kx?document.fonts:null,this._canvas=ci(),this._checkReliable=this._fontFaceSet&&this._fontFaceSet.check&&!this._fontFaceSet.check("12px FontThatDoesNotExist"),this._ctx=this._canvas.getContext("2d")}var Nx=(Ka.prototype._setLoaded=function(){this._loaded=!0,this._value=this._fontName},Ka.prototype.getValue=function(){return this._value},Ka.prototype.isLoaded=function(){return this._loaded},Ka.prototype.destroy=function(){clearTimeout(this._timeout)},Ka.prototype.load=function(){var e=this;return this._tryLoad(200).then(function(){e._setLoaded()})},Ka.prototype._tryLoad=function(e){var t=this;return this._fontFaceSet.load(this._fontName).then(function(){if(!t._fontFaceSet.check(t._fontName))return new Promise(function(n){e<6e4&&(t._timeout=setTimeout(n,e))}).then(function(){return t._tryLoad(1.5*e)})})},Ka);function Ka(e,t){this._loaded=!1,this._value=null,this._timeout=null,this._fontFaceSet=e,this._fontName=t,this._loaded=!1,this._value=null,this._timeout=null,po&&!this._fontFaceSet.check(this._fontName)||this._setLoaded()}var Lx=(Ns.prototype.setHideUntilFontsLoaded=function(e){this._hideUntilFontsLoaded=e},Ns.prototype.getFont=function(e){var t=this,n=this._fonts[e];return n||(n=new Nx(this._fontFaceSet,e),(this._fonts[e]=n).isLoaded()||n.load().then(function(){return t._triggerFontLoaded(e)})),!this._hideUntilFontsLoaded&&e||n.getValue()},Ns.prototype.onFontLoaded=function(e){this._onFontLoaded.push(e)},Ns.prototype.destroy=function(){var e=this;this._onFontLoaded=[],Object.keys(this._fonts).forEach(function(t){return e._fonts[t].destroy()})},Ns.prototype._triggerFontLoaded=function(e){this._onFontLoaded.forEach(function(t){return t(e)})},Ns);function Ns(){this._fontFaceSet=new Ox,this._fonts={},this._onFontLoaded=[],this._hideUntilFontsLoaded=!0}function bu(e,t,n){for(var i=n.length,r=i-1,o=!1,a=0;a<i;++a)(n[a].y<t&&n[r].y>=t||n[r].y<t&&n[a].y>=t)&&(n[a].x<=e||n[r].x<=e)&&(o=o!==n[a].x+(t-n[a].y)/(n[r].y-n[a].y)*(n[r].x-n[a].x)<e),r=a;return o}function kl(e){var t=e.x*e.x+e.y*e.y;return{x:e.x/t,y:e.y/t}}function sg(e,t){for(var n=1/0,i=-1/0,r=0,o=e.length;r<o;r++){var a=e[r],s=a.x*t.x+a.y*t.y;s<n&&(n=s),i<s&&(i=s)}return{x:n,y:i}}function fc(e,t){for(var n=function(l,u){var d=l[1],c=l[0],h=kl({x:d.x-c.x,y:d.y-c.y}),p=h.x;h.x=-h.y,h.y=p;var g=h;p=(h=kl({x:(d=l[2]).x-(c=l[1]).x,y:d.y-c.y})).x,h.x=-h.y,h.y=p;var m=h;p=(h=kl({x:(d=u[1]).x-(c=u[0]).x,y:d.y-c.y})).x,h.x=-h.y,h.y=p;var b=h;return p=(h=kl({x:(d=u[2]).x-(c=u[1]).x,y:d.y-c.y})).x,h.x=-h.y,h.y=p,[g,m,b,h]}(e,t),i=0,r=n.length;i<r;i++){var o=n[i],a=sg(e,o),s=sg(t,o);if(0==(a.x<=s.y&&a.y>=s.x?Math.min(a.y,s.y)-Math.max(a.x,s.x):0))return!1}return!0}function gc(e){var t=0,n=0,i=e.length;if(0===i)throw new Error("Compute centroid: at least one point is required");for(var r=0;r<i;++r){var o=e[r];t+=o.x,n+=o.y}return{x:t/=i,y:n/=i}}var Ls,vc,Fx=mc(4),Px=mc(5),Dx=mc(10,.4),Sa=1/3,Rx=[{x:-1,y:-Sa},{x:-.55,y:-Sa},{x:-1,y:-1},{x:1,y:0},{x:-1,y:1},{x:-.55,y:Sa},{x:-1,y:Sa}],ug=[{x:-.6,y:-.3},{x:.1,y:0},{x:-.6,y:.3}],zx={circle:{getDistanceFromStrokeVertically:function(e,t){return 1},getDistanceFromStrokeHorizontally:function(e,t){return 1-Math.sqrt(e*e+t*t)},points:[{x:0,y:0,r:1}],isSimple:!0},square:{getDistanceFromStrokeVertically:function(e,t){return 1-Math.abs(t)},getDistanceFromStrokeHorizontally:function(e,t){return 1-Math.abs(e)},points:[{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],isSimple:!0},line:{getDistanceFromStrokeVertically:function(e,t){return 1-Math.abs(t)},getDistanceFromStrokeHorizontally:function(e,t){return 1},points:[{x:-1,y:0},{x:1,y:0}],isSimple:!0},triangle:{getDistanceFromStrokeVertically:function(e,t){return(1-e)/2-Math.abs(t)},getDistanceFromStrokeHorizontally:function(e,t){return 1-Math.abs(e)},points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],isSimple:!0},arrow:{getDistanceFromStrokeVertically:function(e,t){return(1-e)/2-Math.abs(t)},getDistanceFromStrokeHorizontally:function(e,t){return 1-Math.abs(e)},points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],isSimple:!0},"circle-hole-arrow":{getDistanceFromStrokeVertically:function(e,t){return Math.min(Math.sqrt((e+.4)*(e+.4)+t*t)-.27,(1-e)/2-Math.abs(t))},getDistanceFromStrokeHorizontally:function(e,t){return 1-Math.abs(e)},points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],hole:[{x:-.4,y:0,r:.3}],isSimple:!0},"triangle-hole-arrow":{getDistanceFromStrokeVertically:function(e,t){var n=Math.min((1-e)/2-Math.abs(t),1-Math.abs(e)),i=-dg(e,t,ug);return Math.min(n,i)},getDistanceFromStrokeHorizontally:function(e,t){return 1},points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],hole:ug,isSimple:!0},"short-arrow":Eu([{x:-1,y:-Sa},{x:0,y:-Sa},{x:0,y:-1},{x:1,y:0},{x:0,y:1},{x:0,y:Sa},{x:-1,y:Sa}],!1),"sharp-arrow":Eu(Rx,!1),cross:{getDistanceFromStrokeVertically:function(e,t){return 1},getDistanceFromStrokeHorizontally:function(e,t){var n=Math.abs(e),i=Math.abs(t),r=.31-Math.min(n,i),o=1-Math.max(n,i);return Math.min(r,o)},points:[{x:-1,y:.31},{x:-1,y:-.31},{x:-.31,y:-.31},{x:-.31,y:-1},{x:.31,y:-1},{x:.31,y:-.31},{x:1,y:-.31},{x:1,y:.31},{x:.31,y:.31},{x:.31,y:1},{x:-.31,y:1},{x:-.31,y:.31}],isSimple:!1},diamond:Eu(Fx),pentagon:Eu(Px),star:Eu(Dx)},Bx=["circle","square","triangle","line"],Vx=["cross","diamond","pentagon","star"],Ux=["arrow","triangle-hole-arrow","circle-hole-arrow","short-arrow","sharp-arrow"];function lg(e,t){for(var n=0,i=Bx;n<i.length;n++)_c(e,i[n]);for(var r=t.nodes.current.shape.getValues(),o=t.edges.current.shape.head.getValues(),a=t.edges.current.shape.tail.getValues(),s=0,l=Vx;s<l.length;s++){var u=l[s];r.includes(u)&&_c(e,u)}for(var d=0,c=Ux;d<c.length;d++){var h=c[d];(o.includes(h)||a.includes(h))&&_c(e,h)}}function _c(e,t){e.registerShape(t,zx[t])}function dg(e,t,n){for(var i=1/0,r={x:e,y:t},o=0;o<n.length;++o)i=Math.min(i,gf(r,n[o],n[(o+1)%n.length]));return i*(bu(e,t,n)?1:-1)}function mc(e,t){void 0===t&&(t=1);for(var n=-Math.PI/2+1e-6,i=[],r=2*Math.PI/e,o=n,a=0;a<e;++a){var s=a%2==1?t:1;i.push({x:Math.cos(o)*s,y:Math.sin(o)*s}),o+=r}return i}function Eu(e,t){return void 0===t&&(t=!1),{getDistanceFromStrokeVertically:function(){return 1},getDistanceFromStrokeHorizontally:function(n,i){return dg(n,i,e)},points:e,isSimple:t}}(vc=Ls=Ls||{}).ZOOM="zoom",vc.ROTATE="rotate";var yc={duration:0,easing:"linear",startAfter:0,ignoreZoomLimits:!(vc.PAN="pan"),callback:function(){}};function Ol(e){return Math.abs(e)<1e-9}var cg,jx=(wt(xn,cg=Fe),Object.defineProperty(xn.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(xn.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(xn.prototype,"zoom",{get:function(){return this._zoom},enumerable:!0,configurable:!0}),Object.defineProperty(xn.prototype,"angle",{get:function(){return this._angle},enumerable:!0,configurable:!0}),Object.defineProperty(xn.prototype,"width",{get:function(){return this._dimensions.width},enumerable:!0,configurable:!0}),Object.defineProperty(xn.prototype,"height",{get:function(){return this._dimensions.height},enumerable:!0,configurable:!0}),xn.prototype.moveEnd=function(e){var t=this;this._dom.clearTimeout(this._timeout),this._timeout=this._dom.setTimeout(function(){t._timeout=null,t._events.fire(I.VIEW_CHANGED,{type:e})},80)},xn.prototype.getSize=function(){return{width:this._dimensions.width,height:this._dimensions.height}},xn.prototype.getCenter=function(){return{x:this._x,y:this._y}},xn.prototype.setCenter=function(e,t){var n=this,i=e.x,r=e.y,o=Nt({},yc,t),a=this._x,s=this._y,l=i-this._x,u=r-this._y;return Ol(l)&&Ol(u)?Promise.resolve():new Promise(function(d){o.callback=function(){n.moveEnd(Ls.PAN),d()},n._moveAnimation&&n._animations.end(n._moveAnimation,!1),n._moveAnimation=n._animations.play(function(c){n._x=a+l*c,n._y=s+u*c,n._events.fire(I.CAMERA_MOVE),n._events.fire(I.CAMERA_PAN)},o)})},xn.prototype.move=function(e,t){var n=hg({x:e.x,y:e.y},this._zoom,this._sinAngle,this._cosAngle);return this.setCenter({x:this._x+n.x,y:this._y+n.y},t)},xn.prototype.getZoom=function(){return this._zoom},xn.prototype.setZoom=function(e,t,n){var i=this;void 0===n&&(n={refX:void 0,refY:void 0}),t=Nt({},yc,t);var r=n.refX,o=n.refY,a=ve(e,this._minZoom,this._maxZoom);return t.ignoreZoomLimits||(a=this._applyZoomLimits(a)),Ol(this._zoom-a)?Promise.resolve():new Promise(function(s){var l=i._dimensions.width/2,u=i._dimensions.height/2,d=i._zoom,c=l/d-l/a;if(t.callback=function(){i.moveEnd(Ls.ZOOM),s()},void 0!==r&&void 0!==o){var h=(r-l)/d-(r-l)/a,p=(o-u)/d-(o-u)/a,g=i._cosAngle,m=i._sinAngle;i.setCenter({x:i._x+(g*h-m*p),y:i._y+(m*h+g*p)},t)}i._zoomAnimation&&i._animations.end(i._zoomAnimation,!1),i._dom.setTimeout(function(){i._events.fire(I.START_ZOOM,{duration:t.duration,easing:t.easing,startZoom:d,endZoom:a})}),i._zoomAnimation=i._animations.play(function(y){i._zoom=l/(l/d-c*y),i._events.fire(I.CAMERA_MOVE),i._events.fire(I.CAMERA_ZOOM)},t)})},xn.prototype._applyZoomLimits=function(e){var t=this._settings.get("interactions.zoom.minValue"),n=this._settings.get("interactions.zoom.maxValue"),i=this._modules.locate.getGraphBoundingBox(),r=this._zoom,o=this.getSize(),a=e;if(!isNaN(i.cx)){var s={smallestNodeSize:i.minScaledSize,biggestNodeSize:i.maxScaledSize,graphWidth:i.width+i.maxScaledSize,graphHeight:i.height+i.maxScaledSize,viewWidth:o.width,viewHeight:o.height},l=t&&t(s),u=n&&n(s);pg(l)&&a<l?a<r&&(a=Math.min(r,l)):pg(u)&&u<a&&r<a&&(a=Math.max(r,u))}return a},xn.prototype.zoomIn=function(e,t,n){return void 0===n&&(n={refX:void 0,refY:void 0}),"number"!=typeof e&&(n=t,t=e,e=this._settings.get("interactions.zoom.modifier")),this.setZoom(this._zoom*e,t,n)},xn.prototype.zoomOut=function(e,t,n){return void 0===n&&(n={refX:void 0,refY:void 0}),"number"!=typeof e&&(n=t,t=e,e=this._settings.get("interactions.zoom.modifier")),this.setZoom(this._zoom/e,t,n)},xn.prototype.getAngle=function(){return this._angle},xn.prototype.setAngle=function(e,t){var n=this;t=Nt({},yc,t);var i=this._angle,r=e-i;return Ol(r)?Promise.resolve():new Promise(function(o){t.callback=function(){n.moveEnd(Ls.ROTATE),o()},n._rotateAnimation&&n._animations.end(n._rotateAnimation,!1),n._rotateAnimation=n._animations.play(function(a){for(n._angle=i+r*a;n._angle>Math.PI;)n._angle-=2*Math.PI;for(;n._angle<-Math.PI;)n._angle+=2*Math.PI;n._sinAngle=Math.sin(n._angle),n._cosAngle=Math.cos(n._angle),n._events.fire(I.CAMERA_MOVE),n._events.fire(I.CAMERA_ROTATE)},t)})},xn.prototype.rotate=function(e,t){return this.setAngle(this._angle+e,t)},xn.prototype.getScreenCenter=function(){return{x:this._dimensions.width/2,y:this._dimensions.height/2}},xn.prototype.graphToScreenCoordinates=function(e,t){void 0===t&&(t={x:0,y:0});var r=this._dimensions.width/2,o=this._dimensions.height/2;return Gd((e.x-this._x)*this._zoom+r,(e.y-this._y)*this._zoom+o,r,o,-this._angle,t)},xn.prototype.screenToGraphCoordinates=function(e,t){return void 0===t&&(t={x:0,y:0}),Gd(this._x+(e.x-this._dimensions.width/2)/this._zoom,this._y+(e.y-this._dimensions.height/2)/this._zoom,this._x,this._y,this._angle,t)},xn.prototype.projectBounds=function(e,t){void 0===t&&(t=e);for(var n=e[0],i=e[1],r=e[2],o=e[3],a=this._x,s=this._y,l=this._dimensions.width/2,u=this._dimensions.height/2,d=this._sinAngle,c=this._cosAngle,h=1/this._zoom,p=1/0,g=1/0,m=-1/0,b=-1/0,v=[n,i,n,o,r,o,r,i],y=0;y<v.length;y+=2){var E=v[y],S=v[y+1],w=(E=a+(E-l)*h)-a,M=(S=s+(S-u)*h)-s;(E=c*w-d*M+a)<p&&(p=E),m<E&&(m=E),(S=d*w+c*M+s)<g&&(g=S),b<S&&(b=S)}return t[0]=p,t[1]=g,t[2]=m,t[3]=b,t},xn.prototype.screenToGraphVector=function(e){return hg({x:e.x,y:e.y},this._zoom,this._sinAngle,this._cosAngle)},xn.prototype.getView=function(){return{x:this._x,y:this._y,zoom:this._zoom,angle:this._angle,width:this._dimensions.width,height:this._dimensions.height}},xn.prototype.setView=function(e,t){var n=Nt({x:this._x,y:this._y,zoom:this._zoom,angle:this._angle},e),o=n.zoom,a=n.angle;return Promise.all([this.setCenter({x:n.x,y:n.y},t),this.setZoom(o,t),this.setAngle(a,t)]).then(function(){})},xn.prototype._reloadDimensions=function(){this._dimensions=this._dom.getDimensions()},xn.prototype.animationInProgress=function(){var e=this._moveAnimation,t=this._zoomAnimation;return e&&!e.done||t&&!t.done},xn.prototype.getProjectedScreenBounds=function(e){void 0===e&&(e=0);var t=this._dimensions,n=t.width,i=t.height,r=Math.max(n,i)*e;return this.projectBounds([0-r,0-r,n+r,i+r])},xn.prototype._reset=function(){this._zoom=1,this._x=0,this._y=0,this._angle=0,this._sinAngle=0,this._cosAngle=1,this._dimensions=this._dom.getDimensions()},xn);function xn(e){var t=cg.call(this)||this;return t._modules=e,t._events=e.events,t._dom=e.dom,t._animations=e.animations,t._settings=e.settings,t._zoomAnimation=null,t._moveAnimation=null,t._reset(),t._minZoom=1e-8,t._maxZoom=1e8,t._settings.register("minZoom",1e-8,function(n){t._minZoom=n,t._zoom<n&&(t._zoom=n,t._events.fire(I.CAMERA_MOVE))}),t._settings.register("maxZoom",1e8,function(n){t._maxZoom=n,t._zoom>n&&(t._zoom=n,t._events.fire(I.CAMERA_MOVE))}),t._timeout=null,t._events.on({setContainer:function(){t._reset(),t._events.fire(I.CAMERA_MOVE)},resize:function(){t._reloadDimensions(),t._events.fire(I.CAMERA_MOVE)}}),t}function hg(e,t,n,i){var r=e.x,o=e.y;return{x:i*(r/=t)-n*(o/=t),y:n*r+i*o}}function pg(e){return"number"==typeof e&&isFinite(e)}var fg,Zx={maxBlockId:1024,maxScaledSize:16,maxPixelSize:255,maxMinVisibleSize:64,maxDashOffset:4,maxDashLength:3,maxGapLength:1,maxSymbolicSize:0,maxPatternScale:0},gg=Rr?"webgl":null,Gx=(wt(Rt,fg=Fe),Rt.prototype.onMounted=function(e,t){var n=this;void 0!==t.renderer&&e.setOptions({renderer:t.renderer}),void 0!==t.imgCrossOrigin&&e.setOptions({imgCrossOrigin:t.imgCrossOrigin}),this._dom.addWindowEventListener("unload",function(){n.destroy()})},Rt.prototype.getTransparentBackgroundColor=function(){var e=this._settings.get("backgroundColor");return e?this._engine.transparentify(e):null},Rt.prototype._render=function(){var e=this._dom.getDimensions(),t=this._camera.getView(),n=Fn(),i=P(),r=this._settings.get("backgroundColor");this._engine.setView({x:t.x,y:t.y,zoom:t.zoom,angle:t.angle,width:e.width,height:e.height,pixelRatio:n,currentTime:i,backgroundColor:r,isBufferDisplayable:this._isBufferDisplayable});try{this._engine.render(),"requested"===this._rendererState.state&&this._updateRendererState({state:"ok"})}catch(p){if(this._debug)throw p;var a=p.message,s=p.code,l=void 0===s?"OTHER":s,u=this._rendererState.type,d=this._formatRendererName(u),c="requested"===this._rendererState.state?"Error while initializing the "+d+" renderer":"The "+d+" renderer encountered an unexpected runtime error",h=null;"webgl"===u&&(c+="; fallbacking on canvas renderer",h="canvas"),eo(a),eo(c),this._updateRendererState({state:"error",code:l,message:a}),this._settings.set("renderer",h)}},Rt.prototype._formatRendererName=function(e){return"webgl"===e?"WebGL":"svg"===e?"SVG":e},Rt.prototype._fireRendererStateChangeEvent=function(){this._events.fire(I.RENDERER_STATE_CHANGE,{type:this._rendererState.type,state:this._rendererState.state,code:this._rendererState.code,message:this._rendererState.message})},Rt.prototype._updateRendererState=function(e){var t=e.type,n=e.state,i=e.code,r=e.message,o=!1;void 0!==t&&this._rendererState.type!==t&&(this._rendererState.type=t,o=!0),void 0!==n&&this._rendererState.state!==n&&(this._rendererState.state=n,o=!0),void 0!==i&&this._rendererState.code!==i&&(this._rendererState.code=i,o=!0),void 0!==r&&this._rendererState.message!==r&&(this._rendererState.message=r,o=!0),o&&this._initDone&&this._fireRendererStateChangeEvent()},Rt.prototype.getImageData=function(){var e=this;return this._dom.afterNextFrame().then(function(){return e._engine.getImageData()})},Rt.prototype.addCanvas=function(e){this._engine.addCanvas(e)},Rt.prototype.removeCanvas=function(e){this._engine.removeCanvas(e)},Rt.prototype.getNodeAttributes=function(){return this._attributesManager.getFlexArrays().nodes.current},Rt.prototype.getEdgeAttributes=function(){return this._attributesManager.getFlexArrays().edges.current},Rt.prototype.getGraphicsEngine=function(){return this._engine},Rt.prototype.getImageManager=function(){return this._imageManager},Rt.prototype.getFontManager=function(){return this._fontManager},Rt.prototype.allocateGraphicsEngineBlockId=function(){return this._availableGeIndexes.length?this._availableGeIndexes.pop():10*this._nextGeIndex+++9},Rt.prototype.releaseGraphicsEngineBlockId=function(e){this._engine.freeBlock(e),this._availableGeIndexes.push(e),this._dom.refresh()},Rt.prototype.addCursorStyle=function(e){e&&(this._cursorStyle.push(e),this._applyCursorStyle())},Rt.prototype.removeCursorStyle=function(e){if(e){var t=this._cursorStyle.lastIndexOf(e);-1!==t&&(this._cursorStyle.splice(t,1),this._applyCursorStyle())}},Rt.prototype.reloadFonts=function(){this._events.fire(I.RELOAD_FONTS),this._engine.notifyFontsReloaded(),this._dom.refresh()},Rt.prototype.getDomElement=function(){return this._domElement},Rt.prototype.setTextHidden=function(e,t){this._attributesManager.setTextHidden(e,t)},Rt.prototype.resetTextHidden=function(){this._attributesManager.resetTextHidden(),this._dom.refresh()},Rt.prototype.getAttributesManager=function(){return this._attributesManager},Rt.prototype._checkFontsNewlyLoaded=function(){return!!this._fontsNewlyLoaded.length&&(this._fontsNewlyLoaded=[],!0)},Rt.prototype._loadGraphInGraphicsEngine=function(){this._attributesManager.update(),this._checkFontsNewlyLoaded()&&this._attributesManager.redrawAll();var e=this._attributesManager.getAndResetElementsToRedraw(),t=this._attributesManager.getAndResetElementsUpdated(),n=0<t.nodes.size||0<t.edges.size;(t.nodeAttributes.includes("radius")||t.edgeAttributes.includes("width"))&&(this._boundaries.maxSize=function(i){for(var r=i.getNodeAttribute("radius"),o=i.getEdgeAttribute("width"),a=i.getNodes(),s=i.getEdges(),l=0,u=0,d=0;d<a._indexes.length;d++){var c=a._indexes[d],h=r.get(c);l<h&&(l=h)}for(d=0;d<s._indexes.length;d++){var p=o.get(c=s._indexes[d]);u<p&&(u=p)}return Math.max(2*l,u)}(this._graph)),(t.nodeAttributes.includes("shape")||t.edgeAttributes.includes("shape.head")||t.edgeAttributes.includes("shape.tail"))&&lg(this._engine,this._attributesManager.getFlexArrays()),function(e){var t,n,a=e.graph,s=e.elements,l=e.engine,u=e.imageManager,d=e.fontManager,c=e.view,p=e.boundaries,g=e.formatText,m={nodeAttributes:n=ir((t=e.attributes).nodes.current,{text:{secondary:{scaling:t.nodes.current.text.scaling,maxLineLength:t.nodes.current.text.maxLineLength}}}),nodeAttributesPrev:ir(t.nodes.previous,{textHidden:n.textHidden,text:{secondary:{scaling:t.nodes.previous.text.scaling,maxLineLength:t.nodes.previous.text.maxLineLength}}}),edgeAttributes:ir(t.edges.current,{text:{secondary:{scaling:t.edges.current.text.scaling,maxLineLength:t.edges.current.text.maxLineLength,adjustAngle:t.edges.current.text.adjustAngle}}}),edgeAttributesPrev:ir(t.edges.previous,{source:t.edges.current.source,target:t.edges.current.target,textHidden:t.edges.current.textHidden,text:{secondary:{scaling:t.edges.previous.text.scaling,maxLineLength:t.edges.previous.text.maxLineLength,adjustAngle:t.edges.previous.text.adjustAngle}}})},b=m.nodeAttributes,v=m.nodeAttributesPrev,y=m.edgeAttributes,E=m.edgeAttributesPrev,S=s.nodes,w=s.edges,M=p.maxSize,O=p.maxMinVisibleSize;if(S.size||w.size){var F=10*(Math.max(a.getNodeMaxIndex(),a.getEdgeMaxIndex())+1),L=l.setGlobalBoundaries({maxBlockId:Li(F),maxScaledSize:Li(8*M),maxMinVisibleSize:Li(O),maxSymbolicSize:Li(M),maxDashLength:3,maxGapLength:1,maxPatternScale:2}),N=(L?a.getNodes("_all"):S)._indexes,B=(L?a.getEdges("_all"):w)._indexes;if(N.length)for(var X=new bx({engine:l,imageManager:u,fontManager:d,formatText:g,attributes:b,attributesPrev:v}),J=0;J<N.length;++J)X.drawNode(N[J]);if(B.length){var ae=new Mx({engine:l,imageManager:u,fontManager:d,formatText:g,view:c,attributes:y,attributesPrev:E,nodeAttributes:b,nodeAttributesPrev:v});for(J=0;J<B.length;++J)ae.drawEdge(B[J])}}}({graph:this._graph,elements:e,engine:this._engine,imageManager:this._imageManager,fontManager:this._fontManager,view:this._camera.getView(),attributes:this._attributesManager.getFlexArrays(),boundaries:this._boundaries,formatText:this._formatText}),n&&this._events.fire(I.UPDATE_ATTRIBUTES,t)},Rt.prototype._forceCompleteGraphRefresh=function(){this._attributesManager.redrawAll(),this._loadGraphInGraphicsEngine()},Rt.prototype.export=function(e,t,n,i){var r,o=this;return Promise.all([this._graph.getNodes().addClass(Qa),this._graph.getEdges().addClass(Qa)]).then(function(){return o.resolveAtNextFrame()}).then(function(){return o._imageManager.whenReady()}).then(function(){var a;return"all"===n?(r={nodes:_g(a=o._graph,!0),edges:_g(a,!1)},o._forceCompleteGraphRefresh()):o._loadGraphInGraphicsEngine(),o._engine.export(e,t,i)}).then(function(a){return Promise.all([o._graph.getNodes().removeClass(Qa),o._graph.getEdges().removeClass(Qa)]).then(function(){return a})}).then(function(a){var s,l,u;return"all"===n&&(l=(s=r).nodes,u=s.edges,mg(l),mg(u),o._forceCompleteGraphRefresh()),a})},Rt.prototype.addAttributeLayer=function(e){return this._attributesManager.addAttributeLayer(e)},Rt.prototype.createFlexArrays=function(){return this._attributesManager.createFlexArrays()},Rt.prototype.getAttributeValues=function(e,t,n,i){return this._attributesManager.getAttributeValues(e,t,n,i)},Rt.prototype.forceAttributesComputation=function(){this._attributesManager.update()},Rt.prototype.resolveAtNextFrame=function(e){return this._dom.afterNextFrame().then(function(){return e})},Rt.prototype.animate=function(e,t,n){var r,o,i=("number"==typeof(r=n)?r={duration:r}:"object"==typeof r&&null!==r||(r={duration:0}),{duration:(o=r.duration,"number"!=typeof o||!isFinite(o)||o<0?0:o),easing:r.easing||"linear",chain:!!r.chain});return i.duration&&this._engine.ensureAnimationsReady(),this._animate(e,t,i)},Rt.prototype.isAnimating=function(){return 0<this._animations.length},Rt.prototype.getAnimationInformation=function(e){return this._attributesManager.getAnimationInformation(e)},Rt.prototype._toSubGraph=function(e){if(e instanceof ar||e instanceof mo)return{nodes:e.toList(),edges:e.getAdjacentEdges()};if(e instanceof vs||e instanceof na)return{nodes:this._graph.nodeList(),edges:e.toList()};var t=e,n={nodes:t.nodes||this._graph.nodeList(),edges:t.edges||this._graph.edgeList()};return n.nodes.size&&(n.edges=n.edges.size?n.edges.concat(n.nodes.getAdjacentEdges()).dedupe():n.nodes.getAdjacentEdges()),n},Rt.prototype._animate=function(e,t,n){var i=n.duration,r=n.easing;if(!this._animations.length&&!i)return t(e),Promise.resolve(e);var o=this._toSubGraph(e),a=o.nodes,s=o.edges;if(!a.size&&!s.size)return Promise.resolve(e);a.size&&this._events.fire(I.ANIMATE,{elements:a,duration:i,easing:r}),s.size&&this._events.fire(I.ANIMATE,{elements:s,duration:i,easing:r});for(var l={id:this._nextAnimationId++,startTime:-1,finished:!1,func:function(){return t(e)},duration:i,easing:r,nodes:a,edges:s,resolve:void 0},u=new Promise(function(c){return l.resolve=function(){return c(e)}}),d=0;d<a._indexes.length;d++)this._nodeAnimationList.set(a._indexes[d],l.id);for(d=0;d<s._indexes.length;d++)this._edgeAnimationList.set(s._indexes[d],l.id);return this._animations.push(l),this._dom.refresh(),i||this._processAnimations(),u},Rt.prototype._endAnimation=function(e){e.resolve(e.elements),e.finished=!0},Rt.prototype._removeFinishedAnimations=function(){this._animations=this._animations.filter(function(e){return!e.finished})},Rt.prototype._getAnimationElements=function(e){for(var t=[],n=[],i=0;i<e.nodes._indexes.length;i++){var r=e.nodes._indexes[i];this._nodeAnimationList.get(r)===e.id&&t.push(r)}for(i=0;i<e.edges._indexes.length;i++)this._edgeAnimationList.get(r=e.edges._indexes[i])===e.id&&n.push(r);return{nodes:this._graph.nodeList(new Uint32Array(t)),edges:this._graph.edgeList(new Uint32Array(n))}},Rt.prototype._resetAnimationAttributes=function(e){var t=e.nodes,n=e.edges;this._attributesManager.resetAnimationAttributes({nodes:t,edges:n}),this._nodeAnimationList.fill(t._indexes,0),this._edgeAnimationList.fill(n._indexes,0)},Rt.prototype._processAnimations=function(){if(this._animations.length){var e=P(),t=[];this._attributesManager.update();for(var n=0,i=this._animations;n<i.length;n++)-1===(l=i[n]).startTime&&(l.startTime=e,t.push(l.func),0<l.duration&&this._attributesManager.setAnimationAttributes(this._getAnimationElements(l),l));for(var r=0,o=t;r<o.length;r++)(0,o[r])();for(var a=0,s=this._animations;a<s.length;a++){var l;e>=(l=s[a]).startTime+l.duration&&(this._resetAnimationAttributes(this._getAnimationElements(l)),this._endAnimation(l))}this._removeFinishedAnimations(),this._animations.length&&this._dom.refresh()}},Rt.prototype.hideTexts=function(){this.setNodeTextsVisibility(!1),this.setEdgeTextsVisibility(!1)},Rt.prototype.showTexts=function(){this.setNodeTextsVisibility(!0),this.setEdgeTextsVisibility(!0)},Rt.prototype.setNodesVisibility=function(e){return this._updateVisibilityCounter("nodes",e)},Rt.prototype.setNodeTextsVisibility=function(e){return this._updateVisibilityCounter("nodeTexts",e)},Rt.prototype.setEdgesVisibility=function(e){return this._updateVisibilityCounter("edges",e)},Rt.prototype.setEdgeTextsVisibility=function(e){return this._updateVisibilityCounter("edgeTexts",e)},Rt.prototype._updateVisibilityCounter=function(e,t){this._visibility[e]+=t?-1:1,this._dom.refresh()},Rt.prototype.detectNode=function(e){return function(t,n,i,r,o,a){var s=t.x,l=t.y,u=t.margin,d=t.texts,c=t.indexes;c=c||n.getNodes()._indexes;var h=r.getZoom(),p=n.getObjectList(!0),g=i.getFlexArrays().nodes.current,m=0;i.update();for(var b=0;b<c.length;++b){var v=c[b];if(!g.excluded.get(v)&&g.detectable.get(v)&&0===g.animationDuration.get(v)){var y=g.x.get(v),E=g.y.get(v),S=r.graphToScreenCoordinates({x:y,y:E}),w=S.x,M=S.y,O=g.shape.get(v),F="scaled"===g.scalingMethod.get(v),L=g.radius.get(v)*(F?h:1),N=L+u;if(o.checkShapeHit(O,(s-w)/N,(l-M)/N))m=v;else if(d){var J=a(g.text.content.get(v)),ae=g.textHidden.get(v),ie=g.text.minVisibleSize.get(v);if(!ae&&J&&ie<=(F?2*L:1/0)){var U=Bd(J,g.text.maxLineLength.get(v)),Y=g.innerStroke.width.get(v),he=g.outerStroke.width.get(v),pe=g.text.margin.get(v),we=g.text.padding.get(v),ke=g.text.size.get(v),at=g.text.scale.get(v),st=g.text.scaling.get(v),Xe=g.text.font.get(v),xt=g.text.style.get(v),It=g.text.position.get(v),Ge=o.measureText(U,Xe,xt,1),He=st?at*L:ke,Pe=Ge.width*He/2+we+u,We=Ge.height*He/2+we+u,Qe=Q0[It],nt=Y+he+pe+L,Me=w+(nt+Pe)*Qe.x,ze=M+(nt+We)*Qe.y;Me-Pe<s&&s<Me+Pe&&ze-We<l&&l<ze+We&&(m=v)}}}}return p.get(m)||null}(e,this._graph,this._attributesManager,this._camera,this._engine,this._formatText)},Rt.prototype.detectEdge=function(e){return function(t,n,i,r){var o=t.margin,a=t.indexes,s=void 0===a?n.getEdges()._indexes:a,l=n.getObjectList(!1),u=r.getFlexArrays(),d=u.edges.current,c=u.nodes.current,h=i.getZoom(),p=o/h,g=i.screenToGraphCoordinates(t),m=g.x,b=g.y,v=0;r.update();for(var y=0;y<s.length;++y){var E=s[y],S=d.source.get(E),w=d.target.get(E),M=d.excluded.get(E),O=d.detectable.get(E),F=0!==d.animationDuration.get(E),L=0!==c.animationDuration.get(S),N=0!==c.animationDuration.get(w);if(!M&&O&&!F&&!L&&!N){var B=S===w,X=d.curvature.get(E),J="triangle"===d.shape.type.get(E),ae="scaled"===d.scalingMethod.get(E),ie=d.width.get(E)/(ae?1:h),U=c.x.get(S),Y=c.y.get(S),he=c.x.get(w),pe=c.y.get(w);if(B){var we="scaled"===c.scalingMethod.get(S);bf(m,b,U,Y,U,Y,(ke=Ya(U,Y,X,c.radius.get(S)/(we?1:h),0)).x1,ke.y1,ke.x2,ke.y2,ie,p)&&(v=E)}else if(0!==X){var ke;xf(m,b,U,Y,he,pe,(ke=pa(U,Y,he,pe,X)).x,ke.y,ie,p,J)&&(v=E)}else pf(m,b,U,Y,he,pe,ie,p,J)&&(v=E)}}return l.get(v)||null}(e,this._graph,this._camera,this._attributesManager)},Rt.prototype.getVisibilityCounters=function(){return this._visibility},Rt.prototype.destroy=function(){this.getGraphicsEngine().destroy(),this.getImageManager().destroy(),this.getFontManager().destroy()},Rt);function Rt(e,t){var n,i=e.dom,r=e.graph,o=e.camera,a=e.events,s=e.settings,l=fg.call(this)||this;return l._debug=!1,l._initDone=!1,l._boundaries={maxSize:10,maxMinVisibleSize:64},l._visibility={nodes:0,edges:0,nodeTexts:0,edgeTexts:0},l._nextAnimationId=1,l._animations=[],l._rendererState={type:null,code:null,state:"ok",message:""},l._cursorStyle=[],l._fontsNewlyLoaded=[],l._nextGeIndex=1,l._availableGeIndexes=[],l._isBufferDisplayable=function(u){var d,c=2===(d=u.getDepth())||1===d||3<=(d-3)%6,h=Df(u);return 0===(c?l._visibility.nodes:l._visibility.edges)&&(!h||0===(c?l._visibility.nodeTexts:l._visibility.edgeTexts))},l._applyCursorStyle=function(){var u=l._cursorStyle[l._cursorStyle.length-1]||l._settings.get("cursor.default");$r(l._domElement,u)},l._updateImageCrossOrigin=function(){l._imageManager.setImgCrossOrigin(l._settings.get("imgCrossOrigin"))},l._debug=t.isDebug(),l._events=a,l._dom=i,l._graph=r,l._camera=o,l._events=a,l._settings=s,l._formatText=zp().applyArabicShaping,l._attributesManager=new mx(r,i,t),l._imageManager=new Y0,l._fontManager=new Lx,l._engine=new _u(_u.getCachedInitData()),l._domElement=l._engine.getDomElement(),l._nodeAnimationList=l._graph.createNodeAttribute({storage:32,default:0}),l._edgeAnimationList=l._graph.createEdgeAttribute({storage:32,default:0}),l._events.register([I.RELOAD_FONTS,I.RENDERER_STATE_CHANGE,I.UPDATE_ATTRIBUTES,I.ANIMATE,I.CAMERA_MOVE,I.CAMERA_PAN,I.CAMERA_ZOOM,I.CAMERA_ROTATE,I.VIEW_CHANGED,I.START_ZOOM]),l._settings.register("renderer",gg,function(u){l._updateRendererState({type:u,state:"requested",code:null,message:null}),l._engine.setRenderType(u),l._dom.refresh()}),l._settings.register("backgroundColor","white",function(u){l._engine.parseColor(u)?l._dom.refresh():(eo('Invalid background color "'+u+'" specified; will default to black.'),l._settings.set("backgroundColor","black"))}),l._settings.register("texts.hideUntilFontsLoaded",!0,function(u){l._fontManager.setHideUntilFontsLoaded(u)}),l._settings.register("imgCrossOrigin","anonymous",l._updateImageCrossOrigin),l._settings.register("cursor.default","default",l._applyCursorStyle),l._dom.setLayer("graphics",l._domElement),l._engine.setGlobalBoundaries(Zx),l._dom.beforeNextFrame().then(function(){l._initDone=!0,l._fireRendererStateChangeEvent()}),l._imageManager.onFetch(function(){l._engine.notifyPatternUpdate(),l._dom.refresh()}),l._fontManager.onFontLoaded(function(u){l._fontsNewlyLoaded.push(u),l._engine.notifyPatternUpdate(),l._dom.refresh()}),l._dom.addMediaListener("(min-resolution: 2dppx)",function(){l._dom.refresh()}),l._visibleAttributeLayer=l._attributesManager.addAttributeLayer({priority:0,name:"internal("+ic+")",tag:ic,nodeOutput:{attributes:"all"},edgeOutput:{attributes:"all"},nodeDependencies:null,edgeDependencies:null}),l._dataAttributeLayer=l._attributesManager.addAttributeLayer({priority:0,name:"internal(_data)",tag:rc,nodeDependencies:null,edgeDependencies:null}),lg(l._engine,l._attributesManager.getFlexArrays()),l._events.on(((n={})[I.CAMERA_MOVE]=function(){return l._dom.refresh()},n[I.NEW_FRAME]=function(){l._processAnimations(),l._loadGraphInGraphicsEngine(),l._render()},n[I.CLEAR_GRAPH]=function(){l._nextGeIndex=1,l._availableGeIndexes=[],l._engine.clear(),l._attributesManager.clear(),l._dom.refresh()},n[I.VIEW_CHANGED]=function(u){if(u.type===Ls.ROTATE){var d=l._graph.getEdges().filter(function(c){return c.getAttribute("adjustAnchors")});l._attributesManager.redrawElements(d)}},n[I.ADD_NODES+" "+I.ADD_EDGES]=function(u){l._attributesManager.updateForAllAttributeLayers(u.nodes||u.edges)},n[I.EXCLUDED_STATE_CHANGE]=function(u){l._visibleAttributeLayer.updateElements(u.elements)},n[I.SET_DATA]=function(u){l._dataAttributeLayer.updateElements(u.elements)},n)),_u.clearCachedInitData(),l}function _g(e,t){var n=t?e.getNodeAttribute("excluded"):e.getEdgeAttribute("excluded"),i=(t?e.getNodes("all"):e.getEdges("all"))._indexes,r=n.getMultiple(i);return n.fill(i,0),{excludedList:n,indexes:i,values:r}}function mg(e){e.excludedList.setMultiple(e.indexes,e.values)}var xc,qx=(wt(Aa,xc=Fe),Aa.prototype.register=function(e,t){var n=this;void 0===t&&(t=[]),e.forEach(function(i){if(n._events[i])throw new Error('event "'+i+'" already exists');n._events[i]=new vg(!1,i)}),t.forEach(function(i){if(n._events[i])throw new Error('event "'+i+'" already exists');n._events[i]=new vg(!0,i)})},Aa.prototype.onAnyEvent=function(e){this._onAnyEvents.push(e)},Aa.prototype.on=function(e,t){var n=this;return"string"==typeof e?e.split(" ").filter(function(i){return!!i}).forEach(function(i){return yg(n._events,i,"event").on(t)}):vt(e,function(i,r){return n.on(r,i)}),this},Aa.prototype.removeListener=function(e){vt(this._events,function(t){t.off(e)})},Aa.prototype.fire=function(e,t){void 0===t&&(t=null);var n=yg(this._events,e,"event");return this._onAnyEvents.forEach(function(i){return i(e,t)}),n.trigger(t),this},Aa.prototype.once=function(e,t){var n=this,i=function(){t.apply(null,arguments),n.removeListener(i)};this.on(e,i)},Aa);function Aa(){var e=null!==xc&&xc.apply(this,arguments)||this;return e._events={},e._onAnyEvents=[],e}var vg=(Nl.prototype.trigger=function(e){for(var t=0,n=this._handlers;t<n.length;t++)(0,n[t])(e,this._name);return this},Nl.prototype.on=function(e){if("function"!=typeof e)throw new Error("handler is not a function");var t=this._reverseOrder?0:this._subscribers.length;return this._handlers.splice(t,0,e),this._subscribers.splice(t,0,e),this},Nl.prototype.off=function(e){for(var t;-1!==(t=this._subscribers.indexOf(e));)this._subscribers.splice(t,1),this._handlers.splice(t,1);return this},Nl);function Nl(e,t){this._subscribers=[],this._handlers=[],this._reverseOrder=e,this._name=t}function yg(e,t,n){if(!(t in e))throw new Error(n+" "+t+" does not exist");return e[t]}var xg,Hx=(wt(oo,xg=Fe),oo.prototype.getOriginalAttributes=function(){return this._originalAttributesLayer.getFlexArrays()},oo.prototype.setMultipleAttributes=function(e,t,n,i){var r=this;return this._graphics.animate(e,function(){r._individualAttributesLayer.setAttributeValues(e,t,i)},n)},oo.prototype.setSingleAttribute=function(e,t,n,i){var r={};return Xt(r,t,n),this.setMultipleAttributes(e,r,i)},oo.prototype.resetMultipleAttributes=function(e,t,n){var i=this;t=t||this._individualAttributesLayer.getUsedAttributeNames(e);for(var r={},o=0,a=t;o<a.length;o++)Xt(r,a[o],void 0);return this._graphics.animate(e,function(){i._individualAttributesLayer.setAttributeValues(e,r)},n)},oo.prototype.getMultipleAttributes=function(e,t){return this._graphics.getAttributeValues(e,t,!0,!1)},oo.prototype.getSingleAttribute=function(e,t){return this._graphics.getAttributeValues(e,t,!1,!1)},oo.prototype.replaceOriginalAttributes=function(e,t,n){void 0===n&&(n=[]);for(var i={},r=this._originalAttributesLayer.getUsedAttributeNames(e).filter(function(a){return!n.includes(a)}),o=0;o<r.length;++o)Xt(i,r[o],void 0);this._originalAttributesLayer.setAttributeValues(e,i),this._originalAttributesLayer.setAttributeValues(e,t)},oo.prototype.getSinglePreviousAttribute=function(e,t){return this._graphics.getAttributeValues(e,t,!1,!0)},oo.prototype.getMultiplePreviousAttributes=function(e,t){return this._graphics.getAttributeValues(e,t,!0,!0)},oo);function oo(e){var t=e.events,n=e.graphics,i=xg.call(this)||this;return i._events=t,i._graphics=n,i._events.on({"addNodes addEdges":function(r){var s=r.nodes||r.edges,l=r.objects.map(function(u){return u.attributes});i._originalAttributesLayer.setAttributeValues(s,l)}}),i._originalAttributesLayer=i._graphics.addAttributeLayer({name:"original-attributes",priority:1,nodeOutput:{attributes:"all"},edgeOutput:{attributes:"all"},nodeDependencies:null,edgeDependencies:null}),i._individualAttributesLayer=i._graphics.addAttributeLayer({name:"individual-attributes",priority:4,nodeOutput:{attributes:"all"},edgeOutput:{attributes:"all"},nodeDependencies:null,edgeDependencies:null}),i}var bc,Wx=(wt($a,bc=Fe),$a.prototype.onMounted=function(e,t){t.renderer&&this.update({renderer:t.renderer}),t.options&&this.update(t.options)},$a.prototype.register=function(e,t,n,i){return void 0===i&&(i=!0),this._keys.push(e),this._currentValue[e]=t,this._defaultValues[e]=t,this._onChange[e]=n||function(){},n&&i&&n(t),this},$a.prototype.update=function(e){e=Ht(e);for(var t=this._keys,n={},i=0;i<t.length;++i){var r=t[i];if(r in e){var o=e[r];void 0===o&&(o=this._defaultValues[r]),n[r]=this._currentValue[r],this._currentValue[r]=o}}var a=Object.keys(n);for(i=0;i<a.length;++i){var s=a[i],l=this._currentValue[s],u=n[s];l!==u&&this._onChange[s](l,u)}return Sn(n)},$a.prototype.get=function(e){return arguments.length?this._currentValue[e]:Sn(this._currentValue)},$a.prototype.set=function(e,t){var n=this._currentValue[e],i=this._onChange[e];this._currentValue[e]=t,i&&i(t,n)},$a);function $a(){var e=null!==bc&&bc.apply(this,arguments)||this;return e._currentValue={},e._onChange={},e._defaultValues={},e._keys=[],e}var Yx=(jr.prototype.getName=function(){return this._name},jr.prototype.getIndex=function(){return this._classes.getIndex(this._name)},jr.prototype.setIndex=function(e){return this._classes.setIndex(this._name,e)},jr.prototype.update=function(e){return this._classes.update(this._name,e),this},jr.prototype.getDefinition=function(){return this._classes.getDefinition(this._name)},jr.prototype.getNodes=function(){return this._classes.getElementsByClass(this._name).nodes},jr.prototype.getEdges=function(){return this._classes.getElementsByClass(this._name).edges},jr.prototype.clearNodes=function(){this.getNodes().removeClass(this._name)},jr.prototype.clearEdges=function(){this.getEdges().removeClass(this._name)},jr.prototype.add=function(e){e.addClass(this._name)},jr.prototype.remove=function(e){e.removeClass(this._name)},jr);function jr(e,t){this._classes=e,this._name=t}var bg,Xx=(wt($n,bg=Fe),$n.prototype._getClassList=function(e){return e?this._builtinClasses:this._userClasses},$n.prototype.createClass=function(e){void 0===e&&(e={});var t=e.name,n=e.isBuiltin,i=e.after,r=e.nodeAttributes,o=e.nodeDependencies,a=e.nodeOutput,s=e.edgeAttributes,l=e.edgeDependencies,u=e.edgeOutput;if("string"!=typeof t)throw new Error('the "name" argument should be a string');var d=this._getClassList(n),c=i?function(m,b){for(var v=0;v<m.length;++v)if(m[v].name===b)return v;return-1}(d,i)+1:d.length;if(-1===c)throw new Error('createClass: class specified as `after` parameter "'+i+'" does not exist');if(n&&!t.startsWith("_"))throw new Error('invalid builtin class name "'+t+"\": builtin classes should start with '_'");var h=new hu(this._graph),p=new Yx(this,t),g={name:t,elementSet:h,attributeLayer:this._graphics.addAttributeLayer({name:"class("+t+")",tag:t,standaloneSelectors:!0,nodeAttributes:r,edgeAttributes:s,nodeSelector:function(m,b){return b.hasElement(m)},edgeSelector:function(m,b){return b.hasElement(m)},nodeContext:h,edgeContext:h,nodeOutput:a,edgeOutput:u,nodeDependencies:o,edgeDependencies:l}),isBuiltin:n,wrapper:p};return d.splice(c,0,g),n&&d.sort(function(m,b){return Of.indexOf(m.name)-Of.indexOf(b.name)}),this._updatePriorities(n),this._classesByName[t]=g,this._events.register([Fs(t,!0,!0),Fs(t,!0,!1),Fs(t,!1,!0),Fs(t,!1,!1)]),p},$n.prototype._updatePriorities=function(e){for(var t=this._getClassList(e),n=5+(e?.5:0),i=0;i<t.length;++i)t[i].attributeLayer.update({priority:n+5e-4*i})},$n.prototype._get=function(e){var t=this._classesByName[e];if(!t)throw new Error('class "'+e+'" does not exist');return t},$n.prototype.getIndex=function(e){var t=this._get(e);return this._getClassList(t.isBuiltin).indexOf(t)},$n.prototype.setIndex=function(e,t){var n=this._get(e),i=this._getClassList(n.isBuiltin),r=i.indexOf(n),o=ve(t,0,i.length-1);i.splice(r,1),i.splice(o,0,n),this._updatePriorities(n.isBuiltin)},$n.prototype.update=function(e,t){void 0===t&&(t={}),this._get(e).attributeLayer.update({nodeAttributes:t.nodeAttributes,edgeAttributes:t.edgeAttributes,nodeDependencies:t.nodeDependencies,edgeDependencies:t.edgeDependencies,nodeOutput:t.nodeOutput,edgeOutput:t.edgeOutput,fullOverwrite:t.fullOverwrite})},$n.prototype.getDefinition=function(e){var t=this._get(e).attributeLayer.getDefinition();return{nodeAttributes:t.nodeAttributes,edgeAttributes:t.edgeAttributes,nodeDependencies:t.nodeDependencies,edgeDependencies:t.edgeDependencies,nodeOutput:t.nodeOutput,edgeOutput:t.edgeOutput}},$n.prototype._addOrRemoveClassesToElements=function(e,t,n){for(var i=t.isNode,r=0;r<e.length;++r){var o=e[r],a=this._get(o),l=a.attributeLayer,u=a.elementSet.addOrRemoveElements(t,n),d=Fs(o,i,n);u.size&&(l.updateElements(u),this._events.fire(d,i?{nodes:u}:{edges:u}))}},$n.prototype.addClassesToElements=function(e,t,n){var i=this,r=t.toList();return this._graphics.animate(t,function(){i._addOrRemoveClassesToElements(e,r,!0)},n)},$n.prototype.removeClassesFromElements=function(e,t,n){var i=this,r=t.toList();return this._graphics.animate(t,function(){i._addOrRemoveClassesToElements(e,r,!1)},n)},$n.prototype.hasSingleElementClass=function(e,t){return this._get(e).elementSet.hasElement(t)},$n.prototype.getElementsClassList=function(e,t){void 0===t&&(t={});for(var n=t.includeBuiltinClasses,i=void 0!==n&&n,r=new Array(e.size),o=0;o<r.length;++o)r[o]=[];return this._addClassNamesToList(r,e,this._userClasses),i&&this._addClassNamesToList(r,e,this._builtinClasses),r},$n.prototype._addClassNamesToList=function(e,t,n){for(var i=t.toList(),r=0;r<n.length;++r)for(var o=this._userClasses[r],a=o.name,s=o.elementSet,l=0;l<i.size;++l){var u=i.get(l);s.hasElement(u)&&e[l].push(a)}},$n.prototype.getClassByName=function(e,t){void 0===t&&(t=!1);var n=this._classesByName[e]||null;if(t&&!n)throw new Error('class "'+e+'" does not exist');return n&&n.wrapper},$n.prototype.getClassList=function(){return this._userClasses.map(function(e){return e.wrapper})},$n.prototype.getElementsByClass=function(e){var t=this._get(e).elementSet.getElements();return{nodes:t.nodes.filter(function(n){return n.isVisible()}),edges:t.edges.filter(function(n){return n.isVisible()})}},$n.prototype._onClassEvent=function(e,t,n,i){var r=Fs(e,n,i);this._events.on(r,t)},$n.prototype.onNodeClassAdded=function(e,t){this._onClassEvent(e,t,!0,!0)},$n.prototype.onNodeClassRemoved=function(e,t){this._onClassEvent(e,t,!0,!1)},$n.prototype.onEdgeClassAdded=function(e,t){this._onClassEvent(e,t,!1,!0)},$n.prototype.onEdgeClassRemoved=function(e,t){this._onClassEvent(e,t,!1,!1)},$n);function $n(e){var t,n=bg.call(this)||this;return n._builtinClasses=[],n._userClasses=[],n._classesByName={},n._events=e.events,n._graphics=e.graphics,n._graph=e.graph,n._events.on(((t={})[I.EXCLUDED_STATE_CHANGE]=function(i){var r=i.elements;if(i.value){var o=n._builtinClasses.map(function(a){return a.name});n._addOrRemoveClassesToElements(o,r,!1)}},t.clear=function(){n._builtinClasses.concat(n._userClasses).forEach(function(i){return i.elementSet.clear()})},t)),n}function Fs(e,t,n){return(t?"node":"edge")+"Class"+(n?"Added":"Removed")+"_"+e}for(var Ps,Su,es=[0,1],Ll=[0,2],Fl=4;Fl<65535;Fl<<=2)for(var Pl=0,Jx=es.length;Pl<Jx;Pl++)es.push(es[Pl]|Fl),Ll.push((es[Pl]|Fl)<<1);function ao(e,t){return(Ll[255&t]|es[255&e])+65536*(Ll[t>>8&255]|es[e>>8&255])+4294967296*(Ll[t>>16&255]|es[e>>16&255])}function Eg(e,t){if(void 0===t&&(t=[]),0xffffffffffff<e)throw"Only morton codes up to 48 bits are supported.";if(!Ps){Ps={},Su={};for(var n=0;n<256;n++)Ps[ao(n,0)]=n,Su[ao(0,n)]=n}var i=Ps[21845&e],r=Su[43690&e];return 65535<e&&(i|=Ps[21845&(e/=65536)]<<8,r|=Su[43690&e]<<8,65535<e&&(i|=Ps[21845&(e/=65536)]<<16,r|=Su[43690&e]<<16)),t[0]=i,t[1]=r,t}function vr(e,t,n){void 0===e&&(e=Int32Array),void 0===t&&(t=16),void 0===n&&(n=8),this._BIG_LIST=new Uint8Array([-1])[0],this._ArrayType=e,this._capacity=t,this._MAX_LIST_SIZE=n,this._freeIndex=-1,this.clear()}ao.code=function(e,t,n){if(24<e)throw"Morton codes are only supported up to Z=24";var i=1<<24-e;return ao(t*i,n*i)},ao.range=function(e,t,n){if(24<e)throw"Morton ranges are only supported up to Z=24";var i=1<<24-e,r=ao(t*i,n*i);return[r,r+i*i-1]},ao.reverse=Eg,ao.decode=function(e,t){var n=Eg(t),i=1<<24-e;return[n[0]/i,n[1]/i]},ao.min=function(e,t){var r=2863311530&e,o=2863311530&t;return Math.min(1431655765&e,1431655765&t)+Math.min(r,o)};var Sg={averageSize:{configurable:!0}};function Ag(e,t){var n=new e.constructor(t);return n.set(e),n}function Dl(e,t,n){return n|ao(e,t)<<4}function Ec(e,t){return void 0===t&&(t=[]),ao.reverse(e>>4,t),t[2]=e&Kx,t}function Zi(e,t,n,i,r){void 0===n&&(n=16),void 0===i&&(i=65536),void 0===r&&(r=Int32Array),this._intersects=e,this._getBounds=t,this._occupied=0,this._cells=new vr(r),this._objectsAtLevel=new Array(16).fill(0),this._idToCode=new wg,this._codeCache=[],this._offset=i,this._min=-i,this._max=i,this._resolution=65535/(this._max-this._min),this._minCellSize=n*this._resolution,this._bounds=new Array(64);for(var o=0;o<16;o++)this._bounds[4*o]=1/0,this._bounds[4*o+1]=1/0,this._bounds[4*o+2]=-1/0,this._bounds[4*o+3]=-1/0}vr.prototype.clear=function(){this._buffer=new this._ArrayType(this._capacity*this._MAX_LIST_SIZE),this._sizes=new Uint8Array(this._capacity),this._bigLists=[],this._nextIndex=0,this._idToIndex={},this._constList=new Array(this._MAX_LIST_SIZE)},vr.prototype.addEntry=function(e){var t;return-1===this._freeIndex?t=this._nextIndex++:(t=this._freeIndex,this._freeIndex=-1),(this._idToIndex[e]=t)>=this._capacity&&this._expand(t+1),this._sizes[t]=0,t},vr.prototype.getItems=function(e){var t=this._idToIndex[e];if(void 0!==t){var n=this._sizes[t],i=this._MAX_LIST_SIZE*t;if(n<=this._MAX_LIST_SIZE){for(var r=0,o=this._constList.length=n;r<o;++r)this._constList[r]=this._buffer[i+r];return this._constList}if(n===this._BIG_LIST)return this._bigLists[this._buffer[i]]}},vr.prototype.removeEntry=function(e){var t=this._idToIndex[e];this._sizes[t]===this._BIG_LIST&&(this._bigLists[this._buffer[this._MAX_LIST_SIZE*t]].length=0),this._sizes[t]=0,this._freeIndex=t},vr.prototype.size=function(e){var t=this._idToIndex[e],n=this._sizes[t];return n<=this._MAX_LIST_SIZE?n:this._bigLists[this._buffer[t*this._MAX_LIST_SIZE]].length},vr.prototype.sizes=function(e){for(var t=this._sizes,n=this._bigLists,i=this._buffer,r=this._MAX_LIST_SIZE,o=e.length,a=new Array(o),s=0;s<o;s++){var l=this._idToIndex[e[s]],u=t[l];a[s]=u<=r?u:n[i[l*r]].length}return a},vr.prototype.addTo=function(e,t){var n=this._idToIndex[e],i=this._sizes[n],r=n*this._MAX_LIST_SIZE;if(i<this._MAX_LIST_SIZE)this._buffer[r+i]=t,this._sizes[n]=i+1;else if(i===this._BIG_LIST)this._bigLists[this._buffer[r]].push(t);else{for(var a=new Array(this._MAX_LIST_SIZE),s=0;s<this._MAX_LIST_SIZE;++s)a[s]=this._buffer[r+s];a.push(t),this._bigLists.push(a),this._sizes[n]=this._BIG_LIST,this._buffer[r]=this._bigLists.length-1}},vr.prototype.removeFrom=function(e,t){this.removeFromAndGetSize(e,t)},vr.prototype.removeFromAndGetSize=function(e,t){var n=this._idToIndex[e],i=this._sizes[n],r=this._MAX_LIST_SIZE*n;if(i<=this._MAX_LIST_SIZE){for(var o=r,a=r+i;o<a;++o)if(this._buffer[o]===t)return--i,this._buffer[o]=this._buffer[a-1],this._sizes[n]=i}else if(i===this._BIG_LIST){var l=this._bigLists[this._buffer[r]],u=l.indexOf(t);if(-1!==u)return l.splice(u,1),l.length}},vr.prototype.reserve=function(e){this._capacity<e&&this._expand(e)},vr.prototype._expand=function(e){this._capacity=Math.pow(2,Math.ceil(Math.log2(e))),this._buffer=Ag(this._buffer,this._capacity*this._MAX_LIST_SIZE),this._sizes=Ag(this._sizes,this._capacity)},vr.prototype.has=function(e){var t=this._idToIndex[e];return!(void 0===t||t>=this._capacity)&&0!==this._sizes[t]},Sg.averageSize.get=function(){for(var e=0,t=0;t<this._capacity;t++)e+=this._sizes[t];return e/this._capacity},Object.defineProperties(vr.prototype,Sg);var wg="undefined"==typeof Map?function(){function e(){this._values={},this._size=0}var t={size:{configurable:!0}};return t.size.get=function(){return this._size},e.prototype.has=function(n){return!!this._values[n]},e.prototype.set=function(n,i){n in this._values||this._size++,this._values[n]=i},e.prototype.get=function(n){return this._values[n]},e.prototype.delete=function(n){n in this._values&&(delete this._values[n],this._size--)},e.prototype.keys=function(){return Object.keys(this._values)},e.prototype.clear=function(){this._values={},this._size=0},Object.defineProperties(e.prototype,t),e}():Map,Qx="undefined"==typeof Set?function(){function e(){this._values={},this._size=0}var t={size:{configurable:!0}};return t.size.get=function(){return this._size},e.prototype.has=function(n){return!!this._values[n]},e.prototype.add=function(n){n in this._values||this._size++,this._values[n]=!0},e.prototype.delete=function(n){n in this._values&&(delete this._values[n],this._size--)},e.prototype.keys=function(){return Object.keys(this._values)},e.prototype.clear=function(){this._values={},this._size=0},Object.defineProperties(e.prototype,t),e}():Set,Kx=(1<<Math.log2(16))-1,Sc={averageCellOccupancy:{configurable:!0},size:{configurable:!0}};Zi.prototype.setMinCellSize=function(e){return this._minCellSize=e,this},Zi.prototype.setOffset=function(e){return this._offset=e,this._min=-e,this._max=e,this._resolution=65535/(this._max-this._min),this},Zi.prototype.setIntersector=function(e){return this._intersects=e,this},Zi.prototype.setBoundsGetter=function(e){return this._getBounds=e,this},Zi.prototype.insert=function(e,t){void 0===t&&(t=this._getBounds(e));var n,i=Math.max(t[2]-t[0],t[3]-t[1]),r=this._minCellSize;for(n=0;r<i&&n<16;n++)r*=2;var o=this._resolution,a=this._min,s=o*(.5*(t[2]+t[0])-a)/r|0,l=o*(.5*(t[3]+t[1])-a)/r|0,u=Dl(s,l,n);this._cells.has(u)||this._cells.addEntry(u),this._cells.addTo(u,e),this._objectsAtLevel[n]++,this._occupied|=1<<n;var d=4*n,c=this._bounds;return s<c[d]&&(c[d]=s),l<c[1+d]&&(c[1+d]=l),s>c[2+d]&&(c[2+d]=s),l>c[3+d]&&(c[3+d]=l),this._idToCode.set(e,u),u},Zi.prototype.has=function(e){return this._idToCode.has(e)},Zi.prototype.update=function(e,t){return this.remove(e),this.insert(e,t)},Zi.prototype.remove=function(e){var t=this._idToCode.get(e);Ec(t,this._codeCache);var n=this._codeCache[2];return 0==--this._objectsAtLevel[n]&&(this._occupied&=~(1<<n),this._bounds[4*n]=1/0,this._bounds[4*n+1]=1/0,this._bounds[4*n+2]=-1/0,this._bounds[4*n+3]=-1/0),this._cells.removeFrom(t,e),this._idToCode.delete(e),this},Zi.prototype.query=function(e){var t=e[0],n=e[1],i=e[2],r=e[3],o=this._cells,a=this._bounds,s=this._intersects,l=this._min,u=this._resolution,d=this._minCellSize,c=this._occupied,h=[];t=u*(t-l),n=u*(n-l),i=u*(i-l),r=u*(r-l);for(var p=0;p<16&&0!==c;d*=2,c>>=1,p++)if(0!=(1&c))for(var g=1/d,m=4*p,b=Math.max(a[m],t*g-1>>0),v=Math.max(a[1+m],n*g-1>>0),y=Math.min(a[2+m],i*g+1>>0),E=Math.min(a[3+m],r*g+1>>0),S=b;S<=y;S++)for(var w=v;w<=E;w++){var M=Dl(S,w,p),O=o.getItems(M);if(void 0!==O)for(var F=0;F<O.length;F++){var L=O[F];s(L,e)&&h.push(L)}}return h},Zi.prototype.collisions=function(e,t){if(void 0===t&&(t=this._getBounds),"function"!=typeof t)throw new Error("getBounds function is required to get the object bounds");for(var n=Array.from(this._idToCode.keys()),i=this._min,r=this._resolution,o=this._cells,a=new wg,s=[],l=0;l<n.length;l++){var u=0,d=this._minCellSize,c=this._occupied,h=n[l],p=t(h),g=p[0],m=p[1],b=p[2],v=p[3],y=Math.max(b-g,v-m);for(u=0;d<y;u++)d*=2,c>>=1;g=r*(g-i),m=r*(m-i),b=r*(b-i),v=r*(v-i);for(var E=u;E<16&&0!==c;d*=2,c>>=1,E++)if(0!=(1&c))for(var S=1/d,w=m*S-1>>0,M=b*S+1>>0,O=v*S+1>>0,F=g*S-1>>0;F<=M;F++)for(var L=w;L<=O;L++){var N=Dl(F,L,E);if(a.get(N)!==l){a.set(N,l);var B=o.getItems(N);if(void 0!==B)for(var X=0;X<B.length;X++){var J=B[X];J!==h&&e(h,J)&&s.push(h,J)}}}}return function(ae){for(var ie=new Qx,U=[],Y=0;Y<ae.length;Y+=2){var he=ae[Y],pe=ae[Y+1],we=he<pe?he*pe+(pe-he-1)*(pe-he-1)/4:he*pe+(he-pe-1)*(he-pe-1)/4;ie.has(we)||(ie.add(we),U.push(he,pe))}return U}(s)},Zi.prototype.clear=function(){this._occupied=0,this._cells.clear(),this._idToCode.clear(),this._objectsAtLevel=new Array(16).fill(0),this._bounds=new Array(64);for(var e=0;e<16;e++)this._bounds[4*e]=1/0,this._bounds[4*e+1]=1/0,this._bounds[4*e+2]=-1/0,this._bounds[4*e+3]=-1/0;return this},Zi.prototype.keyToBBox=function(e){var t=Ec(e),n=t[0],i=t[1],o=this._minCellSize*(1<<t[2]),a=this._min,s=this._resolution;return[n*o/s+a,i*o/s+a,(n+1)*o/s+a,(i+1)*o/s+a]},Zi.prototype.keys=function(){return Object.keys(this._cells._idToIndex)},Sc.averageCellOccupancy.get=function(){return this._cells.averageSize},Sc.size.get=function(){return this._idToCode.size},Object.defineProperties(Zi.prototype,Sc),Zi.code=Dl,Zi.decode=Ec;var Tg,$x=["x","y","radius"],eb=["width","curvature"],tb=(wt(Pi,Tg=Fe),Pi.prototype._getIntersector=function(){var e=this._graph,t=e.getNodeAttributes(["x","y","radius"]),n=t[0],i=t[1],r=t[2],o=e.getEdgeAttributes(["source","target","width","curvature"]),a=o[0],s=o[1],l=o[2],u=o[3],d={x:0,y:0,x1:0,y1:0,x2:0,y2:0};return function(c,h){if(c<0){var p=a.get(c=-c),g=s.get(c),m=u.get(c),b=l.get(c)/2,v=n.get(p),y=i.get(p),E=n.get(g),S=i.get(g);return p===g?(Ya(v,y,m,r.get(p),0,d),yf(v,y,d.x1,d.y1,d.x2,d.y2,E,S,h[0]-b,h[1]-b,h[2]+b,h[3]+b)):0===m?Xd(v,y,E,S,h[0]-b,h[1]-b,h[2]+b,h[3]+b):(pa(v,y,E,S,m,d),vf(v,y,d.x,d.y,E,S,h[0]-b,h[1]-b,h[2]+b,h[3]+b))}return lc(n.get(c),i.get(c),r.get(c),h[0],h[1],h[2],h[3])}},Pi.prototype._boundsGetter=function(){var e=this._graph,t=e.getNodeAttributes(["x","y","radius"]),n=t[0],i=t[1],r=t[2],o=e.getEdgeAttributes(["source","target","curvature"]),a=o[0],s=o[1],l=o[2],u={x:0,y:0,x1:0,y1:0,x2:0,y2:0},d={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(c){if(c<0){var h=a.get(c=-c),p=s.get(c),g=l.get(c),m=n.get(h),b=i.get(h),v=n.get(p),y=i.get(p);h===p?(Ya(m,b,g,r.get(h),0,u),gl(m,b,u.x1,u.y1,u.x2,u.y2,v,y,d)):0===g?(d.minX=Math.min(m,v),d.minY=Math.min(b,y),d.maxX=Math.max(m,v),d.maxY=Math.max(b,y)):(pa(m,b,v,y,g,u),Kd(m,b,u.x,u.y,v,y,d))}else{var E=n.get(c),S=i.get(c),w=r.get(c);d.minX=E-w,d.minY=S-w,d.maxX=E+w,d.maxY=S+w}return[d.minX,d.minY,d.maxX,d.maxY]}},Pi.prototype.reindex=function(){this._graphics.forceAttributesComputation(),this._index.clear(),this._elementsToUpdate.clear(),this._updateItems(this._graph.getNodes("all")._indexes,this._graph.getEdges("all")._indexes)},Pi.prototype._updateIndex=function(){if(!this._elementsToUpdate.isEmpty()){var e=this._elementsToUpdate.getElements();this._updateItems(e.nodes._indexes,e.edges._indexes),this._elementsToUpdate.clear()}},Pi.prototype._updateItems=function(e,t){for(var n=this._index,i=this._removedNodes,r=this._removedEdges,o=[],a=[],s=0;s<e.length;s++){var l=e[s];0!==i.get(l)?o.push(l):(n.has(l)&&o.push(l),a.push(l))}for(s=0;s<t.length;s++)0!==r.get(-(l=-t[s]))?o.push(l):(n.has(l)&&o.push(l),a.push(l));for(var u=0,d=o;u<d.length;u++)n.remove(l=d[u]);for(var c=0,h=a;c<h.length;c++)n.insert(l=h[c])},Pi.prototype.getNodesInScreenByDistance=function(e){var t=e.getPositionOnScreen(),n=t.x,i=t.y;return this._graph.getNodes().filter(function(r){return r.isInScreen()&&r!==e}).sort(function(r,o){var a=r.getPositionOnScreen(),s=o.getPositionOnScreen();return yi(a.x,a.y,n,i)-yi(s.x,s.y,n,i)})},Pi.prototype.getNearestNodesForNode=function(e,t,n){void 0===t&&(t=240);var i=e.getPosition();return this.getNearestNodes(i.x,i.y,t,n,e)},Pi.prototype.getNearestNodes=function(e,t,n,i,r){if(this._updateIndex(),i){var o=this._camera.screenToGraphVector({x:n,y:n});n=yi(0,0,o.x,o.y)}return this._getNearestNodes(e,t,n,r)},Pi.prototype._getNearestNodes=function(e,t,n,i){for(var r=[],o=n*n,a=i?i._index:0,s=this._graph.getNodes()._indexes,l=this._graph.getNodeAttributes(["x","y"]),u=l[0],d=l[1],c=0,h=s.length;c<h;c++){var p=s[c];if(p!==a){var g=e-u.get(p),m=t-d.get(p);g*g+m*m<=o&&r.push(p)}}return this._graph.nodeList(new Uint32Array(r))},Pi.prototype.queryRaw=function(e,t,n,i){this._updateIndex();var r=this._queryBounds;r[0]=e,r[1]=t,r[2]=n,r[3]=i;var o=this._index.query(r),a=this._queryResult,s=a.nodes,l=a.edges;s.length=l.length=0;for(var u=0;u<o.length;u++){var d=o[u];d<0?l.push(-d):s.push(d)}return this._queryResult},Pi.prototype.queryRawProjected=function(e,t,n,i){var r=this._queryBounds;return r[0]=e,r[1]=t,r[2]=n,r[3]=i,this._camera.projectBounds(r),this.queryRaw(r[0],r[1],r[2],r[3])},Pi.prototype.query=function(e,t,n,i){var r=this._graph,o=this.queryRaw(e,t,n,i),s=o.edges;return{nodes:r.nodeList(new Uint32Array(o.nodes.slice())),edges:r.edgeList(new Uint32Array(s.slice()))}},Pi.prototype.queryProjected=function(e,t,n,i){var r=this._graph,o=this.queryRawProjected(e,t,n,i),s=o.edges;return{nodes:r.nodeList(new Uint32Array(o.nodes.slice())),edges:r.edgeList(new Uint32Array(s.slice()))}},Pi.prototype.getNodesByBoundingBox=function(e,t,n,i,r){if(this._updateIndex(),r){var o=void 0;e=(o=this._camera.screenToGraphVector({x:e,y:t})).x,t=o.y,n=(o=this._camera.screenToGraphVector({x:n,y:i})).x,i=o.y}for(var a=this._graph,s=a.getNodes()._indexes,l=[],u=a.getNodeAttribute("excluded"),d=a.getNodeAttributes(["x","y"]),c=d[0],h=d[1],p=0,g=s.length;p<g;p++){var m=s[p];if(!u.get(m)){var b=c.get(m),v=h.get(m);e<=b&&b<=n&&t<=v&&v<=i&&l.push(m)}}return a.nodeList(new Uint32Array(l))},Pi.prototype.toggleDebug=function(e){e?(this._canvas=ci(),this._graphics.addCanvas(this._canvas),this._ctx=this._canvas.getContext("2d")):this._canvas&&(this._graphics.removeCanvas(this._canvas),this._canvas=this._ctx=null)},Pi.prototype.renderDebug=function(e){this._ctx||this.toggleDebug(!0),function(t,n){function i(B,X){return{x:(B-y)*v,y:(X-E)*v}}var r=void 0===n?{}:n,o=r.cells,a=void 0===o||o,s=r.boxes,l=void 0===s||s,u=r.query,d=void 0===u||u,c=Fn(),h=t._ctx,p=t._canvas,g=t._camera,m=t._index,b=-g.getAngle(),v=g.getZoom()*c,y=g._x,E=g._y,S=g._dimensions.width*c/2,w=g._dimensions.height*c/2,M=m.keys().map(function(B){return m.keyToBBox(B)}),O=Array.from(m._idToCode.keys()).map(function(B){return m._getBounds(B)});if(h.clearRect(0,0,p.width,p.height),h.save(),h.translate(S,w),h.rotate(b),a&&(h.beginPath(),h.lineWidth=1,h.strokeStyle="#707070",M.forEach(function(B){var X=i(B[0],B[1]),J=i(B[2],B[3]);h.rect(X.x,X.y,J.x-X.x,J.y-X.y)}),h.stroke()),l&&(h.beginPath(),h.lineWidth=1,h.strokeStyle="#ff7070",O.forEach(function(B){var X=i(B[0],B[1]),J=i(B[2],B[3]);h.rect(X.x,X.y,J.x-X.x,J.y-X.y)}),h.closePath(),h.stroke()),d&&t._queryBounds){var F=t._queryBounds;h.beginPath(),h.lineWidth=2,h.strokeStyle="#3030ff";var L=i(F[0],F[1]),N=i(F[2],F[3]);h.rect(L.x,L.y,N.x-L.x,N.y-L.y),h.closePath(),h.stroke()}h.restore()}(this,e)},Pi);function Pi(e){var t=Tg.call(this)||this;t._minCellSize=8;var n=e.graph,i=e.camera,r=e.graphics,o=e.events;return t._graph=n,t._camera=i,t._graphics=r,t._index=new Zi(t._getIntersector(),t._boundsGetter(),t._minCellSize,1e6),t._elementsToUpdate=new hu(t._graph),t._removedNodes=n.getNodeAttribute("removed"),t._removedEdges=n.getEdgeAttribute("removed"),t._queryResult={edges:[],nodes:[]},t._queryBounds=[0,0,0,0],o.on({"addNodes addEdges removeNodes removeEdges updateAttributes":function(a){if(a.nodes&&(!a.nodeAttributes||a.nodeAttributes.some(function(l){return $x.includes(l)}))){var s=a.nodes.fastGetAdjacentElements().edges;t._elementsToUpdate.addElements(a.nodes),t._elementsToUpdate.addElements(s)}a.edges&&(a.edgeAttributes&&!a.edgeAttributes.some(function(l){return eb.includes(l)})||t._elementsToUpdate.addElements(a.edges))},clear:function(){t._index.clear(),t._elementsToUpdate.clear()}}),t}var Mg,Kt,Ac,nb=(wt(Xn,Mg=Fe),Xn.prototype.onMounted=function(){this.locateGraph({},!0)},Xn.prototype.locateGraph=function(e,t){var n=this;return void 0===t&&(t=!1),t?this._locateGraph(e):this._transformations.whenApplied().then(function(){return n._locateGraph(e)})},Xn.prototype._locateGraph=function(e){return this._locateBoundingBox(this.getGraphBoundingBox(),e)},Xn.prototype.locateElements=function(e,t){var n=this;return this._transformations.whenApplied().then(function(){return n._locateBoundingBox(n.getBoundingBox(e),t)})},Xn.prototype.locateRawGraph=function(e,t){return this._locateBoundingBox(this.getRawGraphBoundingBox(e),t)},Xn.prototype.getGraphBoundingBox=function(){return this._cacheValid||this._updateCache(),Object.assign({},this._cachedGraphBoundingBox)},Xn.prototype.forceInvalidCache=function(){this._invalidCache()},Xn.prototype._invalidCache=function(){this._cacheValid=!1},Xn.prototype._updateCache=function(){this._cacheValid=!0,this._cachedGraphBoundingBox=this.getBoundingBox(this._graph.getNodes())},Xn.prototype.getBoundingBox=function(e,t){return e.isNode?this._getNodesBoundingBox(e.toList()):this._getEdgesBoundingBox(e.toList(),t)},Xn.prototype._getNodesBoundingBox=function(e){this._graphics.forceAttributesComputation();for(var t=this._graphics.getNodeAttributes(),n=[],i=[],r=[],o=[],a=0;a<e.size;++a){var s=e._indexes[a];if(0===t.excluded.get(s)){var l=t.x.get(s),u=t.y.get(s),d=2*t.radius.get(s);"scaled"===t.scalingMethod.get(s)?r.push(d):o.push(d),n.push(l),i.push(u)}}return new Cr({xValues:n,yValues:i,scaledSizeValues:r,fixedSizeValues:o})},Xn.prototype._getEdgesBoundingBox=function(e,t){void 0===t&&(t=!1),this._graphics.forceAttributesComputation();for(var n=this._graphics.getEdgeAttributes(),i=this._graphics.getNodeAttributes(),r={x1:0,y1:0,x2:0,y2:0},o={x:0,y:0},a={minX:0,minY:0,maxX:0,maxY:0},s=[],l=[],u=[],d=[],c=0;c<e.size;++c){var h=e._indexes[c],p=n.source.get(h),g=n.target.get(h),m=n.curvature.get(h),b=i.x.get(p),v=i.y.get(p),y="scaled"===i.scalingMethod.get(p),E=2*i.radius.get(p),S=i.x.get(g),w=i.y.get(g),M="scaled"===i.scalingMethod.get(g),O=2*i.radius.get(g);y?u.push(E):d.push(E),M?u.push(O):d.push(O),t||0===m?(s.push(b,S),l.push(v,w)):(p===g?(Ya(b,v,m,E/2,0,r),gl(b,v,r.x1,r.y1,r.x2,r.y2,S,w,a)):(pa(b,v,S,w,m,o),Kd(b,v,o.x,o.y,S,w,a)),s.push(a.minX,a.maxX),l.push(a.minY,a.maxY))}return new Cr({xValues:s,yValues:l,scaledSizeValues:u,fixedSizeValues:d})},Xn.prototype.getRawGraphBoundingBox=function(e){for(var t=e.nodes.length,n=new Array(t),i=new Array(t),r=new Array(t),o=0;o<t;o++){var a=e.nodes[o].attributes||{};n[o]=a.x||0,i[o]=a.y||0,r[o]=a.radius||5}return new Cr({xValues:n,yValues:i,scaledSizeValues:r})},Xn.prototype._computeCameraConfig=function(e,t,n){"number"==typeof t&&(t={left:t,right:t,top:t,bottom:t});var i,r=void 0===t.left?40:t.left,o=void 0===t.right?40:t.right,a=void 0===t.top?40:t.top,s=void 0===t.bottom?40:t.bottom,l=this._dom.getDimensions(),u=r+o,d=a+s,c=0===e.width?e.maxFixedSize:e.width,h=0===e.height?e.maxFixedSize:e.height,y=(i=[(l.width-u)/(c+e.maxScaledSize),(l.height-d)/(h+e.maxScaledSize),(l.width-u-e.maxFixedSize)/c,(l.height-d-e.maxFixedSize)/h,n/e.maxScaledSize||NaN].filter(function(E){return isFinite(E)&&0<E})).length?mn(i):1;return{x:e.cx+(o-r)/(2*y),y:e.cy+(s-a)/(2*y),zoom:y}},Xn.prototype._locateBoundingBox=function(e,t){if(void 0===t&&(t={}),isNaN(e.cx))return Promise.resolve();var n=t.padding,r=t.easing,o=void 0===r?"quadraticInOut":r,a=t.duration,s=void 0===a?0:a,l=t.maxNodeSizeOnScreen,d=t.ignoreZoomLimits,c=void 0!==d&&d,h=this._computeCameraConfig(e,void 0===n?{}:n,void 0===l?200:l),p=h.x,g=h.y,m=h.zoom,b=m/this._camera.getZoom();return this._moveCamera(p,g,m,s,o,b,c)},Xn.prototype._moveCamera=function(e,t,n,i,r,o,a){return 1.01<o?(this._camera.setCenter({x:e,y:t},{duration:i,easing:r,ignoreZoomLimits:a}),this._camera.setZoom(n,{duration:i,easing:r,ignoreZoomLimits:a,startAfter:.5})):o<.99?(this._camera.setCenter({x:e,y:t},{duration:i,easing:r,ignoreZoomLimits:a,startAfter:.5}),this._camera.setZoom(n,{duration:i,easing:r,ignoreZoomLimits:a})):this._camera.setCenter({x:e,y:t},{duration:i,easing:r,ignoreZoomLimits:a})},Xn.prototype.computeConfigForBounds=function(e,t){void 0===t&&(t={});var n=t.padding,r=t.maxNodeSizeOnScreen;return this._computeCameraConfig(e,void 0===n?{}:n,void 0===r?200:r)},Xn.prototype.layoutDataBoundingBox=function(e){for(var t=e.x,n=e.y,i=e.indexes,r=this._graphics.getNodeAttributes(),o=[],a=[],s=[],l=[],u=0;u<i.length;++u){var d=i[u],c=t[u],h=n[u],p=2*r.radius.get(d),g="scaled"===r.scalingMethod.get(d);o.push(c),a.push(h),g?s.push(p):l.push(p)}return new Cr({xValues:o,yValues:a,scaledSizeValues:s,fixedSizeValues:l})},Xn.prototype.isEdgeInPolygon=function(e,t){var n=e.getSource(),i=e.getTarget(),r=n.getPositionOnScreen(),o=i.getPositionOnScreen();if(bu(r.x,r.y,t)||bu(o.x,o.y,t))return!0;for(var a=Ig(e,this._camera.getZoom()),s=0;s<a.length-1;++s)for(var l=a[s],u=a[s+1],d=0;d<t.length-1;++d){var c=t[d],h=t[d+1];if(Is(l.x,l.y,u.x,u.y,c.x,c.y,h.x,h.y))return!0}return!1},Xn.prototype.isElementInView=function(e,t){var n=(void 0===t?{}:t).margin,i=void 0===n?0:n,r=this._camera.getSize(),o={minX:-i,minY:-i,maxX:r.width+i,maxY:r.height+i};return e.isNode?this.isNodeInRectangle(e,o):this.isEdgeInRectangle(e,o)},Xn.prototype.isNodeInRectangle=function(e,t){var n=e.getPositionOnScreen(),i=e.getAttribute("radius")*this._camera.getZoom();return n.x+i>=t.minX&&n.x-i<=t.maxX&&n.y+i>=t.minY&&n.y-i<=t.maxY},Xn.prototype.isNodeInPolygon=function(e,t){var n=e.getPositionOnScreen();return bu(n.x,n.y,t)},Xn.prototype.isEdgeInRectangle=function(e,t){for(var n=Ig(e,this._camera.getZoom()),i=0;i<n.length-1;++i){var r=n[i],o=n[i+1];if(Xd(r.x,r.y,o.x,o.y,t.minX,t.minY,t.maxX,t.maxY))return!0}return!1},Xn);function Xn(e){var t=Mg.call(this)||this;return t._cacheValid=!0,t._cachedGraphBoundingBox=new Cr,t._dom=e.dom,t._events=e.events,t._camera=e.camera,t._graph=e.graph,t._graphics=e.graphics,t._settings=e.settings,t._sync=e.sync,t._transformations=e.transformations,t._events.on({"addNodes removeNodes addEdges removeEdges excludedStateChange clear updateAttributes":function(){return t._invalidCache()}}),t}function Ig(e,t){var n=e.getAttribute("curvature"),i=e.getSource(),r=e.getTarget(),o=i.getPositionOnScreen();if(i===r){var a=5*(n+i.getAttribute("radius"))*t,s=o.x,l=o.y,u=s-a,d=l,c=s,h=l+a;return[o].concat([.2,.4,.6,.8].map(function(M){return vu(M,s,l,s,l,u,d,c,h)}),[o])}var p=r.getPositionOnScreen();if(0===n)return[o,p];var g=p.x-o.x,m=p.y-o.y,b=Math.sqrt(g*g+m*m),E=n*(b/5)*2,S=(o.x+p.x)/2+m/b*E,w=(o.y+p.y)/2+-g/b*E;return[o].concat([.25,.5,.75].map(function(M){return Qd(M,o.x,o.y,p.x,p.y,S,w)}),[p])}(Ac=Kt=Kt||{}).LEFT="left",Ac.MIDDLE="middle",Ac.RIGHT="right";var ib=Yi&&"msLaunchUri"in navigator&&!("documentMode"in document);if(Rr){var kg=[];document.documentElement.addEventListener("mousemove",function(e){for(var t=0;t<kg.length;t++)kg[t](e)})}var Og,rb=(wt(lr,Og=Fe),Object.defineProperty(lr.prototype,"x",{get:function(){return this._position.x},enumerable:!0,configurable:!0}),Object.defineProperty(lr.prototype,"y",{get:function(){return this._position.y},enumerable:!0,configurable:!0}),Object.defineProperty(lr.prototype,"left",{get:function(){return this._left},enumerable:!0,configurable:!0}),Object.defineProperty(lr.prototype,"right",{get:function(){return this._right},enumerable:!0,configurable:!0}),Object.defineProperty(lr.prototype,"middle",{get:function(){return this._middle},enumerable:!0,configurable:!0}),lr.prototype._isEnabled=function(){return this._settings.get("mouse.enabled")},lr.prototype._isWheelEnabled=function(){return this._settings.get("mouse.wheelEnabled")},lr.prototype._disableWheelUntilMouseDown=function(){return this._settings.get("mouse.disableWheelUntilMouseDown")},lr.prototype._getDoubleClickTimer=function(){return this._settings.get("mouse.doubleClickTimer")},lr.prototype._resetClickCounter=function(e,t){void 0===t&&(t=0),e?this._clickCounter[e]=t:(this._clickCounter.left=t,this._clickCounter.middle=t,this._clickCounter.right=t),this._dom.clearTimeout(this._dbclickTimer),this._lastMouseDownTarget=null},lr.prototype._setXY=function(e){var t=this._domElt.getBoundingClientRect();return!!(this._bounds=t)&&(this._evt=e,this._button=Mi[e.button],this._px=this._position.x,this._py=this._position.y,this._position.x=e.clientX-t.left,this._position.y=e.clientY-t.top,this._left=this._buttons.left,this._right=this._buttons.right,this._middle=this._buttons.middle,!0)},lr.prototype._applyMouseWheelZoom=function(e){var t;this._setXY(e)&&this._events.fire(I.MOUSE_WHEEL,{delta:(t=e,ib?t.wheelDeltaY/2:t.deltaY&&0===t.deltaMode?-t.deltaY/Fn():t.deltaY&&1===t.deltaMode?20*-t.deltaY:t.deltaY&&2===t.deltaMode?60*-t.deltaY:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?20*-t.detail:t.detail?t.detail/-32765*60:0),x:this._position.x,y:this._position.y,domEvent:this._evt})},lr.prototype._initializeListeners=function(){var e=this,t=this._domElt,n=this._dom;po&&this._dom.addElementEventListener(document,"contextmenu",function(r){e._lastMouseDownTarget&&r.target!==e._lastMouseDownTarget&&r.preventDefault()}),n.addElementEventListener(t,"contextmenu",function(r){e._setXY(r),e._dom.hasFocus()&&e._settings.get("mouse.enabled")&&r.preventDefault()},!1),n.addElementEventListener(t,"onwheel"in t?"wheel":void 0!==t.onmousewheel?"mousewheel":"DOMMouseScroll",this._onMouseWheel),n.addElementEventListener(t,"mousemove",this._onMouseMove),n.addElementEventListener(t,"mouseleave",function(){e._isEnabled()&&(e._dom.blur(),e._events.fire(I.MOUSE_LEAVE,{domEvent:e._evt}))}),n.addElementEventListener(t,"mousedown",this._onMouseDown),n.addElementEventListener(t,"mouseup",this._onMouseUp)},lr);function lr(e){var t=e.dom,n=e.position,i=e.settings,r=e.events,o=e.graphics,a=Og.call(this)||this;return a._px=0,a._py=0,a._pressX=0,a._pressY=0,a._left=!1,a._middle=!1,a._right=!1,a._evt=null,a._bounds=null,a._clickCounter={left:0,middle:0,right:0},a._buttons={left:!1,middle:!1,right:!1},a._button=null,a._lastMouseDownTarget=null,a._skipNextMove=!1,a._onMouseWheel=function(s){a._isEnabled()&&a._isWheelEnabled()&&(!a._disableWheelUntilMouseDown()||a._dom.hasFocus())&&(s.preventDefault(),s.stopPropagation(),a._applyMouseWheelZoom(s))},a._onMouseMove=function(s){if(a._isEnabled()&&a._setXY(s)){var l=a._position.x,u=a._position.y,d=l-a._px,c=u-a._py;0==d&&0==c||(a._skipNextMove?a._skipNextMove=!1:6<=yi(l,u,a._pressX,a._pressY)&&(a._resetClickCounter(),a._events.fire(I.MOUSE_MOVE,{x:l,y:u,dx:d,dy:c,domEvent:a._evt})))}},a._onDocumentMouseMove=function(s){if(a._isEnabled()&&a._setXY(s)){var l=a._position.x,u=a._position.y,d=a._bounds;(l<0||l>d.width||u<0||u>d.height)&&a._events.fire(I.DOCUMENT_MOUSE_MOVE,{x:l,y:u,dx:l-a._px,dy:u-a._py,domEvent:a._evt})}},a._onMouseUp=function(s){if(a._isEnabled()&&a._setXY(s)){var l=a._position.x,u=a._position.y,d=a._button,c=a._evt;a._buttons[d]=!1,1===a._clickCounter[a._button]?a._events.fire(I.MOUSE_CLICK,{button:d,x:l,y:u,domEvent:c}):1<a._clickCounter[d]&&(a._events.fire(I.MOUSE_DOUBLE_CLICK,{button:d,x:l,y:u,domEvent:c}),a._resetClickCounter(d)),a._events.fire(I.MOUSE_UP,{button:d,x:l,y:u,domEvent:c})}},a._onDocumentMouseup=function(s){if(a._isEnabled()&&a._setXY(s)){var l=a._position.x,u=a._position.y,d=a._button;a._buttons[d]=!1,a._events.fire(I.DOCUMENT_MOUSE_UP,{button:d,x:l,y:u,domEvent:a._evt}),a._dom.removeDocumentEventListener(I.MOUSE_MOVE,a._onDocumentMouseMove),a._dom.removeDocumentEventListener(I.MOUSE_UP,a._onDocumentMouseup)}},a._onMouseDown=function(s){if(a._isEnabled()&&a._setXY(s)){var l=a._position.x,u=a._position.y,d=a._button;a._skipNextMove=!0,a._pressX=l,a._pressY=u,a._lastMouseDownTarget=s.target,a._dom.focus(),a._buttons[d]=!0,a._clickCounter[d]+=1;var c=d;a._dbclickTimer=a._dom.setTimeout(function(){a._resetClickCounter(c,0)},a._getDoubleClickTimer()),a._events.fire(I.MOUSE_DOWN,{button:d,x:l,y:u,domEvent:a._evt}),a._dom.addDocumentEventListener(I.MOUSE_MOVE,a._onDocumentMouseMove),a._dom.addDocumentEventListener(I.MOUSE_UP,a._onDocumentMouseup)}},a._dom=t,a._settings=i,a._events=r,a._graphics=o,a._position=n,a._domElt=a._graphics.getDomElement(),i.register("mouse.enabled",!0),i.register("mouse.wheelEnabled",!0),i.register("mouse.disableWheelUntilMouseDown",!1),i.register("mouse.doubleClickTimer",500),r.register([I.MOUSE_DOWN,I.MOUSE_UP,I.MOUSE_MOVE,I.MOUSE_WHEEL,I.MOUSE_CLICK,I.MOUSE_DOUBLE_CLICK,I.MOUSE_LEAVE,I.DOCUMENT_MOUSE_UP,I.DOCUMENT_MOUSE_MOVE]),t.afterNextFrame().then(function(){return a._initializeListeners()}),a}var Ng,ab=(wt(ts,Ng=Fe),Object.defineProperty(ts.prototype,"x",{get:function(){return this._position.x},enumerable:!0,configurable:!0}),Object.defineProperty(ts.prototype,"y",{get:function(){return this._position.y},enumerable:!0,configurable:!0}),Object.defineProperty(ts.prototype,"pressed",{get:function(){return this._pressed},enumerable:!0,configurable:!0}),ts.prototype._listen=function(e,t,n){if(ye){if(t===re.START)return function(e,t,n){function i(r){Ne(r)||(Te(r)&&r.preventDefault(),oe(r,n))}return e(t,G,i,!1),i}(this._addEvent,e,n);if(t===re.MOVE)return function(e,t,n){function i(r){Ne(r)&&0===r.buttons||oe(r,n)}return e(t,Q,i,!1),i}(this._addDocEvent,e,n);if(t===re.END)return function(e,t,n){function i(r){return oe(r,n)}return e(t,$,i,!1),e(t,se,i,!1),i}(this._addDocEvent,e,n);if(t===re.CANCEL)return function(e,t,n){function i(r){Te(r)&&r.preventDefault(),oe(r,n)}return e(t,se,i,!1),i}(this._addDocEvent,e,n)}return this._dom.addElementEventListener(e,t,n)},ts.prototype._initialize=function(e){function t(){s._position.x=l,s._position.y=u,s._pressed=h}function n(w,M){var O=s._domElt.getBoundingClientRect();if(!O)return null;var F=w.touches[0].clientX-O.left,L=w.touches[0].clientY-O.top,N=w.touches[1].clientX-O.left,B=w.touches[1].clientY-O.top,X=(F+N)/2,J=(L+B)/2,ae=X-l,ie=J-u,U=yi(F,L,N,B),Y=U/v,he=Ms(F,L,N,B),pe={dx:ae,dy:ie,rotation:he-y,scale:Y};return v=U,y=he,l=X,u=J,t(),pe}function i(w){if(p=Mi[w.button],1!==w.touches.length)return h=!1,1<w.touches.length&&s._events.fire(I.TOUCH_UP,{x:l,y:u,domEvent:E,button:p}),!1;var M=s._domElt.getBoundingClientRect();return M&&(d=l,c=u,l=w.touches[0].clientX-M.left|0,u=w.touches[0].clientY-M.top|0,h=!0,E=w,t()),!0}function r(){g=0,s._dom.clearTimeout(S)}function o(w){if(w.preventDefault(),2!==w.touches.length&&b&&(b=!1,s._events.fire(I.TOUCH_END_GESTURE,{domEvent:E})),i(w),0===w.touches.length){var M={x:l,y:u,domEvent:E,button:p};1===g&&s._events.fire(I.TOUCH_TAP,M),1<g&&(s._events.fire(I.TOUCH_DOUBLE_TAP,M),r()),s._events.fire(I.TOUCH_UP,M)}var O=Bi().documentElement;Ee(s._removeDocEvent,O,re.MOVE,s._onMove),Ee(s._removeDocEvent,O,re.END,s._onEnd)}function a(w){(function(M){if(2===M.touches.length&&b){var O=n(M);O&&s._events.fire(I.TOUCH_PROGRESS_GESTURE,{dx:O.dx,dy:O.dy,rotation:O.rotation,scale:O.scale,x:l,y:u,domEvent:E,button:p})}})(w),m?m=!1:(r(),i(w)&&s._events.fire(I.TOUCH_MOVE,{x:l,y:u,dx:l-d,dy:u-c,domEvent:E,button:p}))}var s=this,l=0,u=0,d=0,c=0,h=!1,p=Kt.LEFT,g=0,m=!1,b=!1,v=1,y=0,E=null,S=null;this._listen(this._domElt,re.START,function(w){2!==w.touches.length||b||n(w)&&(b=!0,s._events.fire(I.TOUCH_START_GESTURE,{domEvent:E})),i(w)&&(s._dom.focus(),s._events.fire(I.TOUCH_DOWN,{x:l,y:u,domEvent:E,button:p}),g+=1,S=s._dom.setTimeout(r,500),m=!0);var M=Bi().documentElement;s._onMove=s._listen(M,re.MOVE,a),s._onEnd=s._listen(M,re.END,o)})},ts);function ts(e){var t=e.dom,n=e.events,i=e.settings,r=e.graphics,o=e.position,a=Ng.call(this)||this;return a._pressed=!1,a._addEvent=function(s,l,u,d){a._dom.addElementEventListener(s,l,u,d)},a._addDocEvent=function(s,l,u,d){a._dom.addDocumentEventListener(l,u,d)},a._removeDocEvent=function(s,l,u){a._dom.removeDocumentEventListener(l,u)},a._dom=t,a._events=n,a._settings=i,a._graphics=r,a._position=o,a._domElt=a._graphics.getDomElement(),a._settings.register("touch.enabled",!0),a._events.register([I.TOUCH_DOWN,I.TOUCH_UP,I.TOUCH_TAP,I.TOUCH_DOUBLE_TAP,I.TOUCH_MOVE,I.TOUCH_START_GESTURE,I.TOUCH_PROGRESS_GESTURE,I.TOUCH_END_GESTURE,I.DOCUMENT_TOUCH_MOVE,I.DOCUMENT_TOUCH_UP]),a._dom.afterNextFrame().then(function(){a._initialize(a)}),a}var Lg,sb=(wt(wa,Lg=Fe),wa.prototype._fetchSubEltsList=function(e){return e?this._subNodesList:this._subEdgesList},wa.prototype._fetchMetaEltList=function(e){return e?this._metaNodeList:this._metaEdgeList},wa.prototype.setSubElements=function(e,t){this._fetchSubEltsList(e.isNode).setMultiple(e._indexes,t)},wa.prototype.setMetaElement=function(e,t){this._fetchMetaEltList(e.isNode).setMultiple(e._indexes,t)},wa.prototype.getSubElements=function(e){return this._fetchSubEltsList(e.isNode).getMultiple(e._indexes)},wa.prototype.getMetaElement=function(e){return this._fetchMetaEltList(e.isNode).getMultiple(e._indexes)},wa);function wa(e){var t=e.graph,n=Lg.call(this)||this;return n._graph=t,n._subNodesList=n._graph.createNodeAttribute({storage:"any",default:null}),n._subEdgesList=n._graph.createEdgeAttribute({storage:"any",default:null}),n._metaNodeList=n._graph.createNodeAttribute({storage:"any",default:null}),n._metaEdgeList=n._graph.createEdgeAttribute({storage:"any",default:null}),n}var ub=(Mr.prototype.getName=function(){return this._module.getName(this._id)},Mr.prototype.getId=function(){return this._id},Mr.prototype.whenApplied=function(){return this._whenApplied},Mr.prototype.isEnabled=function(){return this._module.isEnabled(this._id)},Mr.prototype.enable=function(e){return this._module.enable(this._id,e)},Mr.prototype.disable=function(e){return this._module.disable(this._id,e)},Mr.prototype.toggle=function(e){return this._module.toggle(this._id,e)},Mr.prototype.getIndex=function(){return this._module.getIndex(this._id)},Mr.prototype.setIndex=function(e){return this._module.setIndex(this._id,e)},Mr.prototype.destroy=function(e){return this._module.remove(this._id,e)},Mr.prototype.refresh=function(){return this._module.refresh(this._id)},Mr.prototype.delete=function(e){return this.destroy(e)},Mr);function Mr(e,t){var n=this;this._module=e,this._id=t,this._whenApplied=e.whenApplied().then(function(){return n})}var Au=(Fg.prototype.cleanup=function(e){return Promise.resolve()},Fg);function Fg(e){}var Pg,lb=(wt(Dn,Pg=Fe),Dn.prototype._invalidState=function(){var e=this;this._afterCurrentUpdate.then(function(){(e._list.length||e._currentPipeline.length)&&(e._mustRefresh=!0,e._dom.refresh())})},Dn.prototype._onUpdate=function(){var e=this;return this._afterCurrentUpdate.then(function(){return e._dom.refresh(),new Promise(function(t,n){return e._resolvers.push({resolve:t,reject:n})})})},Dn.prototype._resetEltTransformationIds=function(){this._nodeTransformationIdList.reset(),this._edgeTransformationIdList.reset()},Dn.prototype._assignTransformationIds=function(e){this._assignTransformationIdsToElements(!0,e),this._assignTransformationIdsToElements(!1,e)},Dn.prototype._assignTransformationIdsToElements=function(e,t){for(var n=e?this._graph.getNodes("all"):this._graph.getEdges("all"),i=this._graph.getAttribute(e,"virtual"),r=this._graph.getAttribute(e,"excluded"),o=e?this._nodeTransformationIdList:this._edgeTransformationIdList,a=0;a<n._indexes.length;a++){var s=n._indexes[a];if(!o.get(s)){var l=r.get(s),u=i.get(s);!l&&u&&o.set(s,t)}}},Dn.prototype._resolveTransformations=function(e,t,n){var i=this;n||(e.forEach(function(d){return d.duration=0}),t.forEach(function(d){return d.duration=0})),this._resetEltTransformationIds();for(var r=this._selection.getSelectedNodes().getId(),o=this._selection.getSelectedEdges().getId(),a=Promise.resolve(),s=function(d){var c=e[d];null!==c.context&&(a=a.then(function(){return c.methods.undo(c)})),t.some(function(h){return h.id===c.id})||(a=a.then(function(){return c.methods.cleanup(c)}).then(function(){c.context=null}))},l=e.length-1;0<=l;--l)s(l);var u=function(d){var c=t[d],h=null;a=a.then(function(){return c.methods.run(c)}).catch(function(p){return c.error=p,!0}).then(function(p){if(h=p,c.context)return c.methods.cleanup(c)}).then(function(){i._assignTransformationIds(c.id),c.context=h})};for(l=0;l<t.length;++l)u(l);return a=a.then(function(){i._destroyed||(i._graph.getNodes(r).setSelected(!0),i._graph.getEdges(o).setSelected(!0))})},Dn.prototype.getList=function(){return this._list.map(function(e){return e.wrapper})},Dn.prototype.clear=function(){return this._list=[],this._invalidState(),this._onUpdate()},Dn.prototype._get=function(e,t){void 0===t&&(t=!0);for(var n=0;n<this._list.length;++n){var i=this._list[n];if(i.id===e)return i.index=n,i}if(t)throw new Error("calling a method on a destroyed transformation");return null},Dn.prototype.getName=function(e){return this._get(e).methods.getName()},Dn.prototype.enable=function(e,t){var n=this;return this._afterCurrentUpdate.then(function(){var i=n._get(e);return i.enabled||(i.enabled=!0,i.duration=t,n._invalidState()),n._onUpdate()})},Dn.prototype._setRemovalDuration=function(e,t){for(var n=0;n<this._currentPipeline.length;++n){var i=this._currentPipeline[n];i.id===e&&(i.duration=t)}},Dn.prototype.disable=function(e,t){var n=this;return this._afterCurrentUpdate.then(function(){var i=n._get(e);return i.enabled&&(i.enabled=!1,n._setRemovalDuration(e,t),n._invalidState()),n._onUpdate()})},Dn.prototype.remove=function(e,t){var n=this;return this._afterCurrentUpdate.then(function(){var i=n._get(e);return n._list.splice(i.index,1),n._setRemovalDuration(e,t),n._invalidState(),n._onUpdate()})},Dn.prototype.toggle=function(e,t){var n=this;return this._afterCurrentUpdate.then(function(){return n._get(e).enabled?n.disable(e,t):n.enable(e,t)})},Dn.prototype.setIndex=function(e,t){var n=this;return this._afterCurrentUpdate.then(function(){var i=n._get(e);return n._list.splice(i.index,1),n._list.splice(ve(t,0,n._list.length),0,i),n._invalidState(),n._onUpdate()})},Dn.prototype.getIndex=function(e){return this._get(e).index},Dn.prototype.add=function(e,t){var n=void 0===t?{}:t,i=n.duration,r=void 0===i?0:i,o=n.enabled,a=void 0===o||o;e.cleanup||(e.cleanup=function(){return Promise.resolve()});var s={ogma:this._ogma,id:++this._idCounter,methods:e,duration:r,enabled:a,context:null,wrapper:new ub(this,this._idCounter),index:-1,error:null};return this._list.push(s),this._invalidState(),s.wrapper},Dn.prototype.whenApplied=function(){return this._onUpdate()},Dn.prototype.refresh=function(){return this._invalidState(),this._onUpdate()},Dn.prototype.isEnabled=function(e){return this._get(e).enabled},Dn.prototype._getElementTransformationId=function(e){return(e.isNode?this._nodeTransformationIdList:this._edgeTransformationIdList).get(e._index)},Dn.prototype.isElementVirtual=function(e){return!!this._getElementTransformationId(e)},Dn.prototype.getElementTransformation=function(e){var t=this._get(this._getElementTransformationId(e),!1);return t&&t.wrapper},Dn.prototype.destroy=function(){this._destroyed=!0},Dn);function Dn(e,t){var n,i=Pg.call(this)||this;return i._list=[],i._currentPipeline=[],i._idCounter=0,i._mustRefresh=!1,i._safeGuard=!1,i._resolvers=[],i._afterCurrentUpdate=Promise.resolve(),i._destroyed=!1,i._computeTransformations=function(){if(!i._safeGuard){if(i._safeGuard=!0,i._afterCurrentUpdate=Promise.resolve(),i._mustRefresh){i._captor.setDetectionEnabled(!1);var r,o,l,a=i._currentPipeline.filter(function(u){return u.enabled}),s=i._list.filter(function(u){return u.enabled});l=a.length===s.length+1&&Dg(a,s,s.length)?(r=[a.pop()],o=[],!0):s.length===a.length+1&&Dg(a,s,a.length)?(r=[],o=[s.pop()],!0):(r=a,o=s,!1),i._afterCurrentUpdate=i._afterCurrentUpdate.then(function(){return i._resolveTransformations(r,o,l)}).then(function(){return i._captor.setDetectionEnabled(!0),i._currentPipeline=i._list.map(function(u){return Nt({},u)}),i._mustRefresh=!1,i._dom.afterNextFrame()})}i._afterCurrentUpdate=i._afterCurrentUpdate.then(function(){i._safeGuard=!1,i._resolvers.forEach(function(u,d){var c=u.resolve,p=i._list[d];return p&&p.error?(0,u.reject)(p.error):c()}),i._resolvers=[]})}},i._settings=e.settings,i._dom=e.dom,i._events=e.events,i._graph=e.graph,i._captor=e.captor,i._classes=e.classes,i._selection=e.selection,i._ogma=t,i._classes.createClass({name:ai,isBuiltin:!0,nodeAttributes:{opacity:0,radius:0},edgeAttributes:{opacity:0,width:0}}),i._classes.createClass({name:xa,isBuiltin:!0,nodeAttributes:{opacity:0},edgeAttributes:{opacity:0}}),i._nodeTransformationIdList=i._graph.createNodeAttribute({storage:16,default:0}),i._edgeTransformationIdList=i._graph.createEdgeAttribute({storage:16,default:0}),i._settings.register("transformations.updateOnDataChange",!0),i._events.on(((n={})[[I.ADD_NODES,I.ADD_EDGES,I.REMOVE_NODES,I.REMOVE_EDGES].join(" ")]=function(r){r.virtual||i._invalidState()},n[I.UPDATE_NODE_DATA+" "+I.UPDATE_EDGE_DATA]=function(){i._settings.get("transformations.updateOnDataChange")&&!i._safeGuard&&i._invalidState()},n[I.AFTER_NEW_FRAME]=i._computeTransformations,n)),i}function Dg(e,t,n){for(var i=0;i<n;++i)if(e[i].id!==t[i].id)return!1;return!0}var Rg,zg={layer:2,outline:!0,outerStroke:{color:"red",width:5},innerStroke:{minVisibleSize:0},text:{backgroundColor:"rgb(220, 220, 220)",minVisibleSize:0}},db={layer:2,color:"red",outline:!0,text:{backgroundColor:"rgb(220, 220, 220)",minVisibleSize:0},stroke:{width:2}},cb=(wt(Ir,Rg=Fe),Ir.prototype.onMounted=function(e){function t(){n._selectionExtremityHighlightedClass.clearNodes(),n._selectedClass.getEdges().getExtremities().addClass(yl)}var n=this;e.events.onEdgesClassAdded(xi,t),e.events.onEdgesClassRemoved(xi,t)},Ir.prototype.setNodeAttributes=function(e,t){this._selectedClass.update({nodeAttributes:e,fullOverwrite:t}),this._selectionExtremityHighlightedClass.update({nodeAttributes:e,fullOverwrite:t}),this._updateExtremityHighlightLayer()},Ir.prototype.setEdgeAttributes=function(e,t){this._selectedClass.update({edgeAttributes:e,fullOverwrite:t}),this._updateExtremityHighlightLayer()},Ir.prototype._updateExtremityHighlightLayer=function(){var e=this._selectedClass.getDefinition().edgeAttributes;this._selectionExtremityHighlightedClass.update({nodeAttributes:{layer:e?e.layer:void 0},fullOverwrite:!1})},Ir.prototype.setActive=function(e,t){if(li(t)){var n=[],i=[];e.toList().forEach(function(r,o){(t[o]?n:i).push(r.getId())}),0!==n.length&&this._graph.getElements(e.isNode,n).addClass(xi),0!==i.length&&this._graph.getElements(e.isNode,i).removeClass(xi)}else e[t?"addClass":"removeClass"](xi)},Ir.prototype.areActive=function(e){return e.hasClass(xi)},Ir.prototype.getSelectedNodes=function(){return this._selectedClass.getNodes()},Ir.prototype.getSelectedEdges=function(){return this._selectedClass.getEdges()},Ir.prototype.getNonSelectedNodes=function(){return this._graph.getNodes().filter(function(e){return!e.hasClass(xi)})},Ir.prototype.getNonSelectedEdges=function(){return this._graph.getEdges().filter(function(e){return!e.hasClass(xi)})},Ir.prototype.clear=function(){this._selectedClass.clearNodes(),this._selectedClass.clearEdges()},Ir);function Ir(e){var t=Rg.call(this)||this;return t._events=e.events,t._settings=e.settings,t._graph=e.graph,t._keyboard=e.keyboard,t._graphics=e.graphics,t._interactions=e.interactions,t._selectionExtremityHighlightedClass=e.classes.createClass({name:yl,isBuiltin:!0,nodeAttributes:zg}),t._selectedClass=e.classes.createClass({name:xi,isBuiltin:!0,nodeAttributes:zg,edgeAttributes:db}),t._settings.register("interactions.selection.enabled",!0),t._settings.register("interactions.selection.multiSelectionKey","ctrl"),t._interactions.onClick({priority:"selection",check:function(n){var i=n.button,r=t._settings.get("interactions.selection.enabled");return"left"===i&&r&&!t._graphics.isAnimating()},handler:function(n){var i=n.target;if(i){var r=t._settings.get("interactions.selection.multiSelectionKey"),o=r&&t._keyboard.isPressed(r);i.isNode?t._selectedClass.clearEdges():t._selectedClass.clearNodes(),o?i.hasClass(xi)?i.removeClass(xi):i.addClass(xi):((i.isNode?t._selectedClass.getNodes():t._selectedClass.getEdges()).filter(function(a){return a!==i}).removeClass(xi),i.hasClass(xi)||i.addClass(xi))}else t._selectedClass.clearNodes(),t._selectedClass.clearEdges()}}),t._events.on(I.BEFORE_REMOVE_EDGES,function(n){return n.edges.setSelected(!1)}),t}var Bg,hb=(wt(Rl,Bg=Fe),Rl.prototype._nextTimeIdle=function(e){var t=this,n=new pb(this._dom,this._idIdle,e);return this._delayedCalls.push(n),n.whenDone().then(function(){t._delayedCalls.splice(t._delayedCalls.indexOf(n),1)})},Rl.prototype.debounceIdle=function(e,t){var n=this;function i(){var a=o;r=!1,o=[],e(),a.forEach(function(s){return s()})}void 0===t&&(t=0);var r=!1,o=[];return function(){return new Promise(function(a){o.push(a),r||(r=!0,n._nextTimeIdle(t).then(i))})}},Rl);function Rl(e){var t=Bg.call(this)||this;return t._dom=e.dom,t._events=e.events,t._captor=e.captor,t._delayedCalls=[],t._idIdle=function(){return!t._captor.isAnyButtonPressed()&&!t._dom.isPlayingFrame()},t._events.on({"down up beforeNewFrame newFrame":function(){t._delayedCalls.forEach(function(n){return n.reset()})}}),t}var pb=(zl.prototype._startTimeout=function(){var e=this;this._timeout=this._dom.setTimeout(function(){e._isIdle()?(e._done=!0,e._resolve()):e._startTimeout()},this._delay)},zl.prototype.reset=function(){this._done||(this._dom.clearTimeout(this._timeout),this._startTimeout())},zl.prototype.whenDone=function(){return this._promise},zl);function zl(e,t,n){var i=this;this._timeout=null,this._done=!1,this._dom=e,this._promise=new Promise(function(r){return i._resolve=r}),this._isIdle=t,this._delay=n,this._startTimeout()}var Vg,fb={number:1,duration:1e3,interval:800,startColor:"rgba(0,0,0,0.6)",endColor:"rgba(0,0,0,0.0)",width:50,startRatio:1,endRatio:2},gb={number:1,duration:1e3,interval:800,startColor:"rgba(0,0,0,0.6)",endColor:"rgba(0,0,0,0.0)",width:10,startRatio:1,endRatio:2},_b=(wt(Ca,Vg=Fe),Ca.prototype._onElementsAttributeChange=function(e,t){if(t.includes("pulse.enabled")){var n=Dh(this._graph,e,function(o){return o.getAttribute("pulse.enabled")}),i=n.valid,r=n.invalid;this._hasPulses.removeElements(r),this._hasPulses.addElements(i),this._removePulses(r)}},Ca.prototype._removePulses=function(e){for(var t=e.isNode?this._nodePulses:this._edgePulses,n=0;n<e._indexes.length;n++){var i=e._indexes[n],r=t.get(i);if(r){for(var o=0;o<r.length;o++)this._graphics.releaseGraphicsEngineBlockId(r[o].blockId);t.set(i,null)}}},Ca.prototype._refreshElementsPulses=function(e,t){for(var n=e.isNode,i=n?this._nodePulses:this._edgePulses,r=n?this._nodeFlexArrays.pulse.duration:this._edgeFlexArrays.pulse.duration,o=n?"_createNodePulseBlock":"_createEdgePulseBlock",a=n?this._nodeFlexArrays.pulse.interval:this._edgeFlexArrays.pulse.interval,s=n?this._nodeNbPulsesRemaining:this._edgeNbPulsesRemaining,l=0;l<e._indexes.length;l++){var u=e._indexes[l],d=i.get(u);d||i.set(u,d=[]);for(var c=0;c<d.length;c++){var h=d[c],g=h.duration;h.startTime+g<=t&&(this._graphics.releaseGraphicsEngineBlockId(h.blockId),d.splice(c--,1))}var b=d[d.length-1];if(!b||t>=b.startTime+a.get(u)){g=r.get(u);var v=s.get(u);0!==v&&d.push({blockId:this[o](u,t,g),startTime:t,duration:g}),0<v&&s.set(u,v-1)}}},Ca.prototype._createNodePulseBlock=function(e,t,n){var i=this._nodeFlexArrays,r=i.color.get(e),o=i.layer.get(e),a=i.x.get(e),s=i.y.get(e),l=i.radius.get(e),u="scaled"===i.scalingMethod.get(e),d=i.pulse.startRatio.get(e),c=i.pulse.endRatio.get(e),h=i.pulse.width.get(e),p=2*l*d,g=2*l*c,m=xu(o).nodeBody,b=i.pulse.startColor.get(e),v=i.pulse.endColor.get(e),y=this._graphics.allocateGraphicsEngineBlockId(),E=this._block.reset(1,!0,m),S=E.nextAndReset(),w=ro(b,r),M=ro(v,r);return S.end.shape="circle",S.end.pieceId=1,S.end.x1=a,S.end.y1=s,S.end.x2=a,S.end.y2=s,S.end.rectWidthOrSourceRadiusScaled=u?g:0,S.end.rectHeightOrTargetRadiusScaled=u?g:0,S.end.rectWidthOrSourceRadiusFixed=u?0:g,S.end.rectHeightOrTargetRadiusFixed=u?0:g,S.end.strokeWidthFixed=h,S.end.strokeColor=M,S.start.shape="circle",S.start.pieceId=1,S.start.x1=a,S.start.y1=s,S.start.x2=a,S.start.y2=s,S.start.rectWidthOrSourceRadiusScaled=u?p:0,S.start.rectHeightOrTargetRadiusScaled=u?p:0,S.start.rectWidthOrSourceRadiusFixed=u?0:p,S.start.rectHeightOrTargetRadiusFixed=u?0:p,S.start.strokeWidthFixed=h,S.start.strokeColor=w,S.animation.duration=n,S.animation.beginTime=t,this._engine.storeBlock(y,E),y},Ca.prototype._createEdgePulseBlock=function(e,t,n){var i=this._edgeFlexArrays,r=this._nodeFlexArrays,o=i.pulse.startRatio.get(e),a=i.pulse.endRatio.get(e),s=i.pulse.startColor.get(e),l=i.pulse.endColor.get(e),u=xu(i.layer.get(e)).edgeBody,d=this._edgeSourceList.get(e),c=this._edgeTargetList.get(e),h=i.curvature.get(e),p=0!==h,g=this._graphics.allocateGraphicsEngineBlockId(),m=this._block.reset(p?3:1,!0,u),b=m.nextAndReset(),v={isSelfLoop:d===c,curvature:h,sourceX:r.x.get(d),sourceY:r.y.get(d),targetX:r.x.get(c),targetY:r.y.get(c),sourceRadius:r.radius.get(d),targetRadius:r.radius.get(c),isSourceRadiusScaled:"scaled"===r.scalingMethod.get(d),isTargetRadiusScaled:"scaled"===r.scalingMethod.get(c),width:i.width.get(e),isWidthScaled:"scaled"===i.scalingMethod.get(e),strokeWidth:i.pulse.width.get(e)};return Ug(b.start,v),Ug(b.end,v),b.start.strokeColor=s,b.end.strokeColor=l,b.start.thicknessOrFontSizeScaled*=o,b.start.thicknessOrFontSizeFixed*=o,b.end.thicknessOrFontSizeScaled*=a,b.end.thicknessOrFontSizeFixed*=a,b.animation.duration=n,b.animation.beginTime=t,this._engine.storeBlock(g,m),g},Ca.prototype.pulse=function(e,t){var n=e.isNode,i=Nt({},n?fb:gb,t),r=i.number,s=n?this._nodeNbPulsesRemaining:this._edgeNbPulsesRemaining,l=(r-1)*i.interval+i.duration;delete i.number,i.enabled=!0,e.setAttributes({pulse:i}),s.setMultiple(e._indexes,r),this._dom.setTimeout(function(){e.setAttribute("pulse.enabled",!1),s.setMultiple(e._indexes,-1)},l)},Ca);function Ca(e){var t=e.graphics,n=e.graph,i=e.dom,r=e.events,o=Vg.call(this)||this;return o._onAttributeChange=function(a){var l=a.edges,d=a.edgeAttributes;o._onElementsAttributeChange(a.nodes,a.nodeAttributes),o._onElementsAttributeChange(l,d)},o._refreshPulses=function(){var a=o._hasPulses.getElements(),s=a.nodes,l=a.edges;if(0!==s.size||0!==l.size){var u=o._engine.getCurrentTime();o._refreshElementsPulses(s,u),o._refreshElementsPulses(l,u),o._dom.refresh()}},o._graph=n,o._dom=i,o._graphics=t,r.on(I.UPDATE_ATTRIBUTES,o._onAttributeChange),r.on(I.NEW_FRAME,o._refreshPulses),r.on(I.BEFORE_REMOVE_NODES+" "+I.BEFORE_REMOVE_EDGES,function(a){(a.nodes||a.edges).setAttribute("pulse.enabled",!1)}),r.on(I.CLEAR_GRAPH,function(){return o._hasPulses.clear()}),o._engine=o._graphics.getGraphicsEngine(),o._block=o._engine.createBlock(),o._nodePulses=n.createNodeAttribute({storage:"any"}),o._edgePulses=n.createEdgeAttribute({storage:"any"}),o._nodeNbPulsesRemaining=n.createNodeAttribute({storage:"int16",default:-1}),o._edgeNbPulsesRemaining=n.createEdgeAttribute({storage:"int16",default:-1}),o._nodeFlexArrays=o._graphics.getNodeAttributes(),o._edgeFlexArrays=o._graphics.getEdgeAttributes(),o._edgeSourceList=n.getEdgeAttribute("source"),o._edgeTargetList=n.getEdgeAttribute("target"),o._hasPulses=new hu(o._graph),o}function Ug(e,t){var n=t.sourceX,i=t.sourceY,r=t.targetX,o=t.targetY,a=t.isSourceRadiusScaled,s=t.isTargetRadiusScaled,l=t.targetRadius,u=t.sourceRadius,d=t.isWidthScaled,c=t.width,h=t.strokeWidth,p=t.curvature,g=t.isSelfLoop;e.pieceId=2,e.shape="line",e.x1=n,e.y1=i,e.x2=r,e.y2=o,e.rectWidthOrSourceRadiusScaled=a?u:0,e.rectWidthOrSourceRadiusFixed=a?0:u,e.rectHeightOrTargetRadiusScaled=s?l:0,e.rectHeightOrTargetRadiusFixed=s?0:l,e.thicknessOrFontSizeScaled=d?c:0,e.thicknessOrFontSizeFixed=d?0:c,e.strokeWidthFixed=h,e.curvature=p,e.isSelfLoop=g}var jg,mb={duration:0,easing:"linear",callback:function(){},startAfter:0},vb=(wt(Bl,jg=Fe),Bl.prototype.play=function(e,t){var n=ln(t,mb),i=n.duration,r=n.easing,o=n.callback,a=n.startAfter,s=null;return i<=0?(e(1),o()):(s={func:e,easing:"function"==typeof r?r:If[r],duration:i,callback:o,startAfter:a,creationDate:P(),done:!1},this._animationList.push(s),this._dom.refresh()),s},Bl.prototype.end=function(e,t){void 0===t&&(t=!0);var n=this._animationList.indexOf(e);-1!==n&&(e.func(1),this._animationList.splice(n,1),e.done=!0,t&&e.callback(!0))},Bl);function Bl(e){var t=jg.call(this)||this;return t._animationList=[],t._update=function(){if(0!==t._animationList.length){for(var n=P(),i=[],r=0;r<t._animationList.length;++r){var o=t._animationList[r],a=(n-o.creationDate)/o.duration,s=o.startAfter,l=o.easing(a);1<=a?(o.func(1),o.done=!0,t._animationList.splice(r,1),--r,i.push(o.callback)):s<=l&&o.func(l=1/(1-s)*(l-s))}for(var u=0;u<i.length;++u)i[u](!1);t._dom.refresh()}},t._dom=e.dom,t._events=e.events,t._animationList=[],t._events.on(I.BEFORE_NEW_FRAME,t._update),t}function Zg(e){return e+(-1===e.indexOf("?")?"?":"&")+"noCache="+Date.now()}var yb={tileLayers:function(e,t,n,i,r){var o=n._getMapPanePos(),a=i.DomUtil.getPosition(e.getContainer());n.removeLayer(e),e.options.crossOrigin="anonymous";var s=[],l=[];return e.on("tileload",function(u){var d=u.tile,c=i.DomUtil.getPosition(d),h=c.x,p=c.y;s.push(d),l.push({x:h-a.x+o.x-r.x,y:p-a.y+o.y-r.y})}),n.addLayer(e),new Promise(function(u){e.once("load",function(){var d=e.getTileSize();s.forEach(function(c,h){var p=l[h];t.drawImage(c,p.x,p.y,d.x,d.y)}),u()})})},imageOverlays:function(e,t,n,i,r){return new Promise(function(o){n.removeLayer(e),e.setUrl(Zg(e.getUrl())),e.options.crossOrigin="anonymous",e.once("load",function(){var a=e.getBounds(),s=n.latLngToContainerPoint(a.getNorthWest()),l=n.latLngToContainerPoint(a.getSouthEast());t.drawImage(e._image,s.x-r.x,s.y-r.y,l.x-s.x,l.y-s.y),o()}),n.addLayer(e)})},vectorLayers:function(e,t,n,i,r,o){return new Promise(function(a){var s=e.options.renderer;n.removeLayer(e),e.options.renderer=o,n.addLayer(e),o._updatePaths();var l=n._getMapPanePos(),u=o._container,d=i.DomUtil.getPosition(u),c=Fn();t.drawImage(o._container,d.x+l.x-r.x,d.y+l.y-r.y,u.width/c,u.height/c),n.removeLayer(e),e.options.renderer=s,n.addLayer(e),a()})},markers:function(e,t,n,i,r){return new Promise(function(o){var a=n.getPixelBounds().min,s=n.project(e.getLatLng(),n.getZoom()),l=/^data\:/.test(e._icon.src),u=l?e._icon.src:Zg(e._icon.src),d=new Image,c=e.options.icon.options,h=c.iconSize,p=s.subtract(a),g=c.iconAnchor;Array.isArray(h)||(h=[h.x,h.y]),Array.isArray(g)||(g=[g.x,g.y]);var m=Math.round(p.x-h[0]+g[0])-r.x,b=Math.round(p.y-g[1])-r.y;function v(){t.drawImage(d,m,b,h[0],h[1]),o()}d.crossOrigin="",d.onload=v,d.src=u,l&&v()})},vectorMap:function(e,t,n,i,r){var o=n._getMapPanePos(),a=e.getMapboxMap(),s=e.getCanvas(),l=e.getSize().round(),u=i.DomUtil.getPosition(e.getContainer()),d=u.x+o.x-r.x,c=u.y+o.y-r.y;return new Promise(function(h){function p(){t.drawImage(s,d,c,l.x,l.y),h()}if(a.loaded())return p();a.once("idle",p)})}};var Gg,qg={"top-left":"left","bottom-left":"left","top-right":"right","bottom-right":"right"},Eb={"top-left":"top","bottom-left":"bottom","top-right":"top","bottom-right":"bottom"},Hg={position:"bottom-right",horizontalMargin:0,verticalMargin:0,className:null},Sb=(wt(Vl,Gg=Fe),Vl.prototype.set=function(e,t){var n=Nt({},Hg,t),i=n.position,r=n.horizontalMargin,o=n.verticalMargin,a=n.className;qg[i]||(i=Hg.position),this.remove();var s=document.createElement("div");return s.innerHTML=e,s.style.position="absolute",Wg(s,i,r,o),s.style.padding="0px 0px 0px 0px",s.style.zIndex="10",a&&s.setAttribute("class",a),this._brand=s,this._dom.setLayer("brand",this._brand),s},Vl.prototype.remove=function(){this._dom.setLayer("brand",null),this._brand=null},Vl);function Vl(e){var t=Gg.call(this)||this;return t._dom=e.dom,t._brand=null,t}function Wg(e,t,n,i){var o=void 0===i?"":i+"px";e.style[qg[t]]=void 0===n?"":n+"px",e.style[Eb[t]]=o}var Yg,Ab=(wt(zt,Yg=Fe),zt.prototype._onCameraUpdate=function(){var e=this;if(this._enabled&&this._map&&this._map._loaded&&(this._x-this._camera.x||this._y-this._camera.y)){this._updating||(this._updating=!0,this._layer.setLocked(!0),this._map._moveStart(!0,!1));var i=this._fromPointToLatLng(this._camera.x,this._camera.y),r=gd(this._camera.zoom),o=this.L.latLng(i.latitude,i.longitude);this._map._move(o,r,{pinch:!0,round:!1}),clearTimeout(this._updateRequest),this._updateRequest=setTimeout(function(){e._updating=!1,e._layer.setLocked(!1),e._map&&e._map._move(o,r,{pinch:!0})._moveEnd(!0)},this._updateRate)}},zt.prototype._onNodesDragStart=function(){this._enabled&&(this._setMapDragging(!1),this._nodeDragOffsetX=this._nodeDragOffsetY=0)},zt.prototype._onNodesDragged=function(e){var t=this,n=e.nodes,i=e.dx,r=e.dy;if(this._enabled){var o=n.map(function(a){var s=a.getAttributes(["x","y"]);return t._fromPointToLatLng(s.x+i-t._nodeDragOffsetX,s.y+r-t._nodeDragOffsetY)});return this._nodeDragOffsetX=i,this._nodeDragOffsetY=r,n.setGeoCoordinates(o)}},zt.prototype._onDataChange=function(e){var t=this,n=e.filter(function(r){var o=r.property;return o===t.latitudePath||o===t.longitudePath});if(n.length){var i=n.reduce(function(r,o){var a=o.nodes,s=o.newValues;if(!a)return r;var l=a.filter(function(u,d){return null!=s[d]});return r?r.concat(l):l},null);this._refreshOrAddNodes(i)}},zt.prototype._refreshOrAddNodes=function(e){this._updateNodesCoordinates(e),this._enabled&&(this._filter.refresh(),this._updatePrevNodesCoordinates(e))},zt.prototype._updatePrevNodesCoordinates=function(e){Hu(this._graph,e,ia,"geo.prevLat"),Hu(this._graph,e,ra,"geo.prevLng")},zt.prototype._restorePrevNodesCoordinates=function(e){Hu(this._graph,e,"geo.prevLat",ia),Hu(this._graph,e,"geo.prevLng",ra)},zt.prototype._updateNodesCoordinates=function(e){!function(t,n,i){for(var r=i.longitudePath,o=i.latitudePath,a=i.wrapCoordinates,s=t.getAttributes(!0,[ia,ra]),l=s[0],u=s[1],d=n._indexes,c=n.getId(),h=d.length,p=n.getData(o),g=n.getData(r),m=0;m<h;m++){var b=g[m],v=p[m],y=d[m],E=c[m];null!=v&&null!=b&&(Xh(E,b),Jh(E,v),a&&(b%=180,v=ve(+v,-nu,nu)),u.set(y,b),l.set(y,v))}}(this._graph,e,this._settings)},zt.prototype._createMapTileLayer=function(e,t){return en(e)?(e.wms?this.L.tileLayer.wms:this.L.tileLayer)(e.url,Nt({attribution:null==t&&e.url===ys.tiles.url?'Map data &copy; <a target="_blank" href="http://osm.org/copyright">OpenStreetMap contributors</a>':null},e)):e},zt.prototype._setupTileLayer=function(e,t){var n=this,i=this._createMapTileLayer(e,t);return i.once("load",function(){n._events.fire(I.GEO_LOADED)}),i.addTo(this._map),i},zt.prototype._onSettingsChanged=function(e,t){var n,i;(e.wrapCoordinates!==t.wrapCoordinates||e.latitudePath!==t.latitudePath||e.longitudePath!==t.longitudePath)&&this._updateNodesCoordinates(this._graph.getNodes("all")),this._enabled&&((n=e).attribution===(i=t).attribution&&n.tiles===i.tiles||!this._map||(this._map.removeLayer(this._tileLayer),this._tileLayer=this._setupTileLayer(t.tiles,t.attribution)),e.sizeRatio!==t.sizeRatio&&this._updateSizes(),e.maxZoomLevel!==t.maxZoomLevel&&this._settingsModule.update({minZoom:1,maxZoom:Math.pow(2,t.maxZoomLevel)}),e.disableNodeDragging!==t.disableNodeDragging&&this._setDragging(!t.disableNodeDragging),e.attributionOptions!==t.attributionOptions&&this._setAttributionOptions(t.attributionOptions,t.attribution))},zt.prototype._setMapDragging=function(e){this._map&&this._map.dragging[e?"enable":"disable"]()},zt.prototype._fromLatLngToPoint=function(e,t){return this._map.options.crs.latLngToPoint(this.L.latLng(e,t),1)},zt.prototype._fromPointToLatLng=function(e,t){var n=this._map.options.crs.pointToLatLng(this.L.point({x:e,y:t}),1);return{latitude:n.lat,longitude:n.lng}},zt.prototype._updateSizes=function(){this._enabled&&this._projection&&this._projection.updateAll()},zt.prototype.enable=function(e){return this.setEnabled(!0,e)},zt.prototype.getMap=function(){if(this._enabled)return this._map},zt.prototype.getOptions=function(){if(this._enabled)return Nt({},this._settings,{tiles:Nt({},this._settings.tiles)})},zt.prototype.setOptions=function(e){if(this._enabled){!function(n,i){void 0===n&&(n={});var r=n.tileUrlSubdomains,o=n.tileUrlTemplate,a=n.attribution,s=n.attributionOptions,l=n.latitudePath,u=n.longitudePath,d=n.sizeRatio,c=n.tiles;if(null!=o&&"string"!=typeof o)throw new TypeError("Geo mode: tileUrlTemplate must be a URL string");if(null!=r&&"string"!=typeof r)throw new TypeError("Geo mode: tileUrlTemplate must be a string");if(null!=c){if(!(en(c)||c instanceof i.Layer))throw new TypeError("Geo mode: tiles must be a object or L.Layer instance");var h=c;if(null!=h.url&&"string"!=typeof h.url)throw new TypeError("Geo mode: tiles.url must be a string");if(null!=h.subdomains&&"string"!=typeof h.subdomains)throw new TypeError("Geo mode: tiles.subdomains must be a string");if(h.tms&&"boolean"!=typeof h.tms)throw new TypeError("Geo mode: tiles.tms must be a boolean");if(h.wms&&"boolean"!=typeof h.wms)throw new TypeError("Geo mode: tiles.wms must be a boolean")}if(null!=a&&"string"!=typeof a)throw new TypeError("Geo mode: Map attribution must be a string");if(null!=s&&!en(s))throw new TypeError("Geo mode: attributionOptions must to be a BrandOptions object");if(null!=l&&"string"!=typeof l&&!Array.isArray(l))throw new TypeError("Geo mode: Latitude path must be a valid property path: a string or an array of strings.");if(null!=u&&"string"!=typeof u&&!Array.isArray(u))throw new TypeError("Geo mode: Longitude path must be a valid property path: a string or an array of strings.");if(null!=d&&(!isFinite(d)||d<=0))throw new TypeError("Geo mode: sizeRatio must be a positive number.")}(e,this.L);var t=this._settings;this._settings=Nt({},ys,e,{tiles:function(n,i){if(void 0===i&&(i={}),void 0===i.tiles||i.tileUrlTemplate||i.tileUrlSubdomains){var r=ys.tiles;return Nt({},i.tiles||{},ys.tiles,{url:i.tileUrlTemplate||r.url,subdomains:i.tileUrlSubdomains||r.subdomains})}return en(i.tiles)?Nt({},n.tiles,i.tiles):i.tiles}(ys,e)}),this._onSettingsChanged(t,this._settings)}},zt.prototype.disable=function(e){return this.setEnabled(!1,e)},zt.prototype.isEnabled=function(){return this._enabled},zt.prototype.toggle=function(e){return this.setEnabled(!this._enabled,e)},zt.prototype.getContainerCoords=function(e){var t=this;return e.getGeoCoordinates().map(function(n){return t._map.latLngToContainerPoint([n.latitude,n.longitude])})},zt.prototype.setEnabled=function(e,t){var n=this;if(!Wh())throw new Error("Ogma Geo cannot be used outside a browser");if(!this.L)throw new Error("You are trying to use Geo mode but Leaflet has not been found. Please follow our migration guide: https://bit.ly/2SYkF8A");if(this._transition||e===this._enabled)return Promise.resolve();this._enabled=e,this._transition=!0,this.setOptions(t);var r=this._settings;return e?(this._nodeDraggingSetting=this._settingsModule.get("interactions.drag.enabled"),this._setDragging(!r.disableNodeDragging),this._show().then(function(){n._setDragging(!r.disableNodeDragging),n._setMapDragging(r.disableNodeDragging),n._transition=!1,n._updating=!1,n._events.fire(I.GEO_ENABLED),n._events.fire(I.GEO_READY)})):this._hide().then(function(){n._transition=!1,n._events.fire(I.GEO_DISABLED),n._setDragging(n._nodeDraggingSetting,!0)})},zt.prototype._setDragging=function(e,t){void 0===t&&(t=!1),this._settingsModule.update({interactions:{drag:{enabled:e,applyResult:t}}})},zt.prototype._setAttributionOptions=function(e,t){if(this._attribution&&(this._attribution.remove(),this._attribution=null),this._attribution=this.L.control.attribution({prefix:!1}).addTo(this._map),en(e)){this._attribution.setPrefix(""),e.position=e.position||"bottom-right";var n=e.position.replace("-","");this._attribution.setPosition(n);var i=this._attribution.getContainer();e.className&&this.L.DomUtil.addClass(i,e.className),Wg(i,e.position||"bottom-right",e.horizontalMargin,e.verticalMargin)}void 0!==t&&this._attribution.addAttribution(t)},zt.prototype._nodeIsVisible=function(e){return t=e,n=this._settings,i=this._hasCustomProjection(),o=n.latitudePath,a=n.wrapCoordinates,s=t.getData(n.longitudePath),l=t.getData(o),null!=s&&null!=l&&(!(!a&&!i)||Math.abs(l)<=nu&&Math.abs(s)<=180);var t,n,i,o,a,s,l},zt.prototype._updateSettingsForMap=function(){var e=this._graphics.getGraphicsEngine().parseColor(this._settings.backgroundColor);e[3]=0,this._prevSettings=this._settingsModule.update({backgroundColor:ep(e),minZoom:1e-6,interactions:{rotation:{enabled:!1},drag:{enabled:!1},pan:{enabled:!1},zoom:{enabled:!1,onDoubleClick:!1}},mouse:{wheelEnabled:!1}})},zt.prototype.getGraphPosition=function(e){var t,n=this.L.latLngBounds((t=[[1/0,1/0],[-1/0,-1/0]],e.getGeoCoordinates().reduce(function(i,r){var o=r.latitude,a=r.longitude,s=i[0],l=i[1];return s[0]=Math.min(s[0],o),s[1]=Math.min(s[1],a),l[0]=Math.max(l[0],o),l[1]=Math.max(l[1],a),i},t)));return{center:0<e.size?n.getCenter():this.L.latLng([0,0]),zoom:this._map.getBoundsZoom(n)}},zt.prototype._initMap=function(){this._updateSettingsForMap(),this._mapContainer=function(t){var n=Bi().createElement("div");n.className="ogma-geo-container",n.style.width=n.style.height="100%";var i=t||Fy;return i.insertBefore(n,i.firstChild),n}(this._dom.getContainer());var e=Nt({},Ly,{minZoom:this._settings.minZoomLevel,maxZoom:this._settings.maxZoomLevel});this._hasCustomProjection()&&(e.crs=this._settings.crs,e.worldCopyJump=!1,e.maxBoundsViscosity=0),this._map=new this.L.Map(this._mapContainer,e),this._hasCustomProjection()||this._map.setMaxBounds(this.L.latLngBounds([[nu,-180],[-nu,180]])),this._setAttributionOptions(this._settings.attributionOptions,this._settings.attribution),this._setupLayers()},zt.prototype._show=function(){var e=this;return this._filter=this._filters.addNodeFilter(function(t){return e._nodeIsVisible(t)}),this._filter.whenApplied().then(function(){e._initMap();var t=e._graph.getNodes(),n=e._graph.getEdges(),i=e.getGraphPosition(t),r=i.center,o=i.zoom;e._zoom=o;var a=e._transformToGeo(),s=a.offset;return e._camera.setView(a.newCameraView,{ignoreZoomLimits:!0}).then(function(){return e._updatePrevNodesCoordinates(t),e._map.setView(r,o),e._zoom=o,e._graphics.animate({nodes:t,edges:n},function(){e._projection=e._createFinalPositionLayer()},e._settings.duration)}).then(function(){return s.destroy()})})},zt.prototype._hasCustomProjection=function(){return null!=this._settings.crs},zt.prototype._setupLayers=function(){var e=this;this._settings.tiles&&(this._tileLayer=this._setupTileLayer(this._settings.tiles,this._settings.attribution)),this._layer=new this.L.OgmaOverlay({container:this._graphics.getDomElement(),mapContainer:this._mapContainer,onUpdate:function(){return e._onMapUpdate()}}),this._layer.addTo(this._map)},zt.prototype._onMapUpdate=function(){var e,t=this._map.getCenter(),r=this._fromLatLngToPoint(t.lat,t.lng);return this._x=r.x,this._y=r.y,this._camera.setView({zoom:(e=this._map.getZoom(),Math.pow(2,e-1)),x:r.x,y:r.y},{ignoreZoomLimits:!0})},zt.prototype._hide=function(){var e=this;if(!this._map)return Promise.resolve();this._settingsModule.update(this._prevSettings),this._map.removeLayer(this._layer);var t=this._dom.getContainer(),n=this._graphics.getDomElement();t&&t.appendChild(n),this._map.getContainer().style.zIndex=0;var i=this._graph.getNodes("all"),r=this._graph.getEdges("all"),o=this._transformToGraph(),a=o.offset;return this._camera.setView(o.newCameraView).then(function(){return Promise.all([A(e._map.getContainer(),1,0,e._settings.duration/2).then(function(){e._map.remove(),e._mapContainer.parentNode.removeChild(e._mapContainer)}),e._graphics.animate({nodes:i,edges:r},function(){return a.destroy()},e._settings.duration)])}).then(function(){return e._map=null,e._filter.delete()})},zt.prototype._transformToGeo=function(){var e=this,t=function(e,t,n,i){var r=e.filter(function(L){return L.isVisible()}),o=0===r.size,a=r.reduce(function(L,N){var B=N.getGeoCoordinates(),ae=i(B.latitude,B.longitude),U=ae.y;return L.mapX.push(ae.x),L.mapY.push(U),L},{mapX:[],mapY:[]}),s=a.mapX,l=a.mapY,u=r.getAttribute("x"),d=r.getAttribute("y"),c=r.getAttribute("radius"),h=new Cr({xValues:u,yValues:d,scaledSizeValues:c}),p=new Cr({xValues:s,yValues:l});o&&(h.cx=h.cy=0,h.width=h.height=0),isFinite(p.width)&&isFinite(p.height)||(p.cx=p.cy=0,p.width=p.height=0);var g=p.cx-h.cx,m=p.cy-h.cy,b=o?1:Math.max(p.width,p.height)/Math.max(h.width,h.height),v=c.reduce(function(L,N){return L[0]=Math.min(L[0],N*b),L[1]=Math.max(L[1],N*b),L},[1/0,0]),y=v[0],E=v[1];p.pad(E),p.minScaledSize=y,p.maxScaledSize=E;var w=n.computeConfigForBounds(p),M=t.zoom/Math.pow(2,Math.ceil(Math.log2(w.zoom))),O=h.cx+(g+=(h.cx-t.x)*M),F=h.cy+(m+=(h.cy-t.y)*M);return{offsetChanges:{name:"graph-to-geo",nodeAttributes:{radius:function(L){return L.getAttribute("radius")*M},x:function(L){return(L.getAttribute("x")+g-O)*M+O},y:function(L){return(L.getAttribute("y")+m-F)*M+F}},edgeAttributes:{width:function(L){return L.getAttribute("width")*M}}},camera:Nt({zoom:t.zoom/M,x:(t.x+g-O)*M+O,y:(t.y+m-F)*M+F,angle:0},t.getSize())}}(this._graph.getNodes(),this._camera,this._locate,function(r,o){return e._fromLatLngToPoint(r,o)}),i=t.camera;return{offset:this._addGraphAttributesLayer(t.offsetChanges),newCameraView:i}},zt.prototype._addGraphAttributesLayer=function(e){return this._graphics.addAttributeLayer(Nt({priority:6,nodeSelector:function(t){return t.isVisible()},edgeSelector:function(t){return t.isVisible()}},e))},zt.prototype._transformToGraph=function(){var e=this,t=function(r,o,a,s){var l=r.getAttributes(["x","y","radius"]),u=r.getBoundingBox(),d=0===r.size,c=r.reduce(function(F,L,N){return F[L._index]=N,F},{});e._projection&&(e._projection.destroy(),e._projection=null);var h=r.getAttribute("x"),p=r.getAttribute("y"),g=r.getAttribute("radius"),m=new Cr({xValues:h,yValues:p,scaledSizeValues:g.map(function(F){return 2*F})});d&&(u.reset(),m.reset());var b,v,y=m.cx-u.cx,E=m.cy-u.cy,S=0,w=0,M=a.computeConfigForBounds(m),O=o.zoom/M.zoom;return v=isNaN(u.cx)||isNaN(u.cy)?(u.cx=o.x,u.cy=o.y,b=M.x,M.y):(b=(o.x+(y+=(u.cx-o.x)*O)-(S=u.cx+y))*O+S,(o.y+(E+=(u.cy-o.y)*O)-(w=u.cy+E))*O+w),{offsetChanges:{name:"geo-to-graph",nodeAttributes:{x:function(F){return(l[c[F._index]].x+y-S)*O+S},y:function(F){return(l[c[F._index]].y+E-w)*O+w}}},camera:Nt({zoom:M.zoom,x:b,y:v,angle:0},o.getSize())}}(this._graph.getNodes("all"),this._camera,this._locate),i=t.camera;return{offset:this._addGraphAttributesLayer(t.offsetChanges),newCameraView:i}},zt.prototype.getPointFromLatLng=function(e){var t=e.getGeoCoordinates(),n=t.latitude,i=t.longitude;return null==n?e.getAttributes(["x","y"]):this._fromLatLngToPoint(n,i)},zt.prototype._createFinalPositionLayer=function(){var e=this;return this._addGraphAttributesLayer({name:"graph-2-geo-animation",nodeAttributes:{scalingMethod:"fixed",radius:function(t){return t.getAttribute("radius")*e._settings.sizeRatio},x:function(t){return e.getPointFromLatLng(t).x},y:function(t){return e.getPointFromLatLng(t).y}},edgeAttributes:{scalingMethod:"fixed",width:function(t){return t.getAttribute("width")*e._settings.sizeRatio}}})},zt.prototype.destroy=function(){return Promise.resolve()},zt.prototype.setCenter=function(e,t){return this._enabled?this.setView(e,t,gd(this._camera.getZoom())):Promise.resolve()},zt.prototype.setZoom=function(e){return this._enabled?(this._zoom=e,this._map.setZoom(e),this._onMapUpdate()):Promise.resolve()},zt.prototype.setView=function(e,t,n){if(this._enabled)return this._map.setView(this.L.latLng([e,t]),n,{animate:!1}),this._zoom=n,this._onMapUpdate()},zt.prototype.getView=function(){if(this._enabled){var e=this._map.getCenter();return{zoom:this._zoom,latitude:e.lat,longitude:e.lng}}},zt.prototype.getCenter=function(){if(this._enabled){var e=this._map.getCenter();return{latitude:e.lat,longitude:e.lng}}},zt.prototype.getZoom=function(){if(this._enabled)return this._zoom},zt.prototype.resetCoordinates=function(){if(this._enabled){var e=this._graph.getNodes();this._restorePrevNodesCoordinates(this._graph.getNodes());var t=this._graph.getNodeAttribute(ia).getMultiple(e._indexes),n=this._graph.getNodeAttribute(ra).getMultiple(e._indexes);e.setData(this._settings.latitudePath,t),e.setData(this._settings.longitudePath,n),this._projection.update()}},zt.prototype.updateCoordinates=function(){eo("The ogma.geo.updateCoordinates() API has been deprecated. The coordinates are updated by default now.")},zt.prototype.getUnprojectedCoordinates=function(e){eo("The ogma.geo.getUnprojectedCoordinates() API has been deprecated. Original graph coordinates are only available when in graph mode."),this._projection.destroy();var t=e.getPosition();return this._projection=this._createFinalPositionLayer(),t},Object.defineProperty(zt.prototype,"latitudePath",{get:function(){return this._settings.latitudePath},enumerable:!0,configurable:!0}),Object.defineProperty(zt.prototype,"longitudePath",{get:function(){return this._settings.longitudePath},enumerable:!0,configurable:!0}),zt.prototype.exportBackground=function(e){var t=this,n=ci();n.width=e.width,n.height=e.height;var i=n.getContext("2d"),r=this._map.getSize(),o=this.getView(),a=Nt({zoom:gd(e.zoom)},this._fromPointToLatLng(e.x,e.y)),s={x:(r.x-e.width)/2,y:(r.y-e.height)/2},l=new this.L.Canvas;this._map.addLayer(l);var u=function(e,t,n,i,r,o){var a={vectorMap:[],tileLayers:[],vectorLayers:[],imageOverlays:[],markers:[]};return t.eachLayer(function(s){if(s!==e){var l=(d=s)instanceof(c=i).TileLayer?"tileLayers":d instanceof c.ImageOverlay?"imageOverlays":d instanceof c.Path?"vectorLayers":d instanceof c.Marker?"markers":"MapboxGL"in c&&d instanceof c.MapboxGL?"vectorMap":void 0;if(l in a){var u=yb[l];a[l].push(function(){return u(s,n,t,i,r,o)})}}var d,c}),a}(this._layer,this._map,i,this.L,s,l),d=u.vectorMap,c=u.tileLayers,h=u.vectorLayers,p=u.imageOverlays,g=u.markers,m=this._map.options.zoomSnap;return this.setView(a.latitude,a.longitude,a.zoom).then(function(){return t._map._onResize()}).then(function(){return Hi(d.concat(c,p,h,g))}).then(function(){t._map._onResize(),t.setView(o.latitude,o.longitude,o.zoom),t._map.options.zoomSnap=m}).then(function(){return new Promise(function(b){return t.L.Util.requestAnimFrame(b)})}).then(function(){return t._map.removeLayer(l)}).then(function(){return n})},zt);function zt(e){var t,n=e.camera,i=e.graph,r=e.settings,o=e.filters,a=e.events,s=e.dom,l=e.graphics,u=e.locate,d=Yg.call(this)||this;return d._enabled=!1,d._zoom=0,d._nodeDraggingSetting=!1,d._transition=!1,d._map=null,d._attribution=null,d._updating=!1,d._updateRate=50,d._x=0,d._y=0,d._graph=i,d._camera=n,d._settingsModule=r,d._filters=o,d._events=a,d._dom=s,d._graphics=l,d._locate=u,d._events.register(["geoEnabled","geoDisabled","geoLoaded","geoReady"]),d.L=null,Wh()&&(d.L=bi("L")||bi("leaflet"),d.L&&function(c){c.TileLayer.prototype.getUrl=function(){return this._url},c.ImageOverlay.prototype.getUrl=function(){return this._url};var h="leaflet-zoom-animated";c.OgmaOverlay||(c.OgmaOverlay=c.Layer.extend({options:{pane:"overlayPane",padding:0,onUpdate:function(){}},initialize:function(p){var g=p.container;c.Util.setOptions(this,p),this._container=g},setLocked:function(p){return this._locked=p,this},onAdd:function(p){this._map=p,this.getPane().appendChild(this._container),this._wgsOrigin=c.latLng([0,0]),this._wgsInitialShift=p.project(this._wgsOrigin,this._initialZoom),c.DomUtil.addClass(this._container,"leaflet-layer"),this._zoomAnimated&&(c.DomUtil.addClass(this._container,h),this._container.style.position="absolute",this._container.style.zIndex=9999),this._initialZoom=(this._map.getMaxZoom()+this._map.getMinZoom())/2,this._mapInitialZoom=this._map.getZoom(),this._updateBounds(),this._update({})},_updateBounds:function(){var p=this.options.padding,g=this._map.getSize(),m=this._map.containerPointToLayerPoint(g.multiplyBy(-p));this._bounds=new c.Bounds(m,m.add(g.multiplyBy(1+2*p))),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()},_update:function(p){var g=this;this._updateBounds(),this._redraw(this._bounds.min,p),this._positionTimer=c.Util.requestAnimFrame(function(){return c.DomUtil.setPosition(g._container,g._bounds.min)})},_redraw:function(p,g){this.options.onUpdate()},_updateTransform:function(p,g){if(!this._locked){var m=this._map.getZoomScale(g,this._zoom),b=this._map.getSize().multiplyBy(.5+this.options.padding),v=this._map.project(this._center,g),y=b.multiplyBy(-m).add(v).subtract(this._map._getNewPixelOrigin(p,g));c.Browser.any3d?c.DomUtil.setTransform(this._container,y,m):c.DomUtil.setPosition(this._container,y)}},_onZoom:function(p){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_onMoveEnd:function(p){this._update(p)},_onAnimZoom:function(p){this._updateTransform(p.center,p.zoom)},bringToFront:function(){c.DomUtil.toFront(this._container)},getEvents:function(){return{zoom:this._onZoom,moveend:this._onMoveEnd,zoomanim:this._onAnimZoom,layeradd:this.bringToFront,zoomend:this.options.onUpdate}},onRemove:function(){c.DomUtil.removeClass(this._container,h);var p=this._container;["transform","webkitTransform","OTransform","MozTransform","msTransform","zIndex","position"].forEach(function(g){return p.style[g]=null}),c.Util.cancelAnimFrame(this._positionTimer),this._container=null}}))}(d.L)),d._graph.createNodeAttribute({name:"geo.prevLat",storage:"float"}),d._graph.createNodeAttribute({name:"geo.prevLng",storage:"float"}),d._graph.createNodeAttribute({name:ia,storage:"float"}),d._graph.createNodeAttribute({name:ra,storage:"float"}),d._settings=Nt({},ys),d._events.on(((t={addNodes:function(c){return d._refreshOrAddNodes(c.nodes)}})[I.UPDATE_NODE_DATA]=function(c){d._enabled&&d._onDataChange(c.changes)},t.progressMoveNodesByDragging=function(c){return d._onNodesDragged(c)},t.startMoveNodesByDragging=function(){return d._onNodesDragStart()},t.endMoveNodesByDragging=function(){return d._setMapDragging(!0)},t[I.CAMERA_MOVE]=function(){return d._onCameraUpdate()},t[I.VIEW_CHANGED]=function(){return d._onCameraUpdate()},t)),d}function wc(e,t,n,i,r){for(var o=new Array(e.length),a=0;a<t.length;a++){var s=i[t[a]],l=i[n[a]];o[s]=o[s]||[],o[s].push(l),r&&(o[l]=o[l]||[],o[l].push(s))}return o}function wu(e,t){return-1===e[t]?t:wu(e,e[t])}function Xg(e,t,n,i,r,o,a,s){if(i[e]=r,n[e])return!0;if(t[e])return!1;t[e]=1,n[e]=1;var l=o[e];if(l)for(var u=0,d=l;u<d.length;u++){var c=d[u];if(Xg(c,t,n,i,e,o,a,s))return a.push(s[c]),!0}return n[e]=0,!1}function Jg(e,t,n){for(var i=e.length,r=new Uint8Array(i),o=new Uint8Array(i),a=new Int32Array(i),s={},l=0;l<i;l++)s[e[l]]=l;var u=wc(e,t,n,s,!1);for(l=0;l<i;l++){var d=[];if(Xg(l,r,o,a,-1,u,d,e)&&1<d.length){for(var c=d[0],h=1;h<d.length;h++)if(d[h]===c){d.length=h;break}return d.push(c),d.reverse()}}return!1}function Qg(e,t,n,i,r,o,a){t[e]=1,i[e]=n;var s=r[e];if(s)for(var l=0,u=s;l<u.length;l++){var d=u[l];if(t[d]){if(d!==n)return i[d]=e,o.push(a[d]),!0}else if(Qg(d,t,e,i,r,o,a))return o.push(a[d]),!0}return!1}var Kg=(Cc.prototype.getCycles=function(){this.visited=new Uint8Array(this.nodes.length),this.visitedStack=[];for(var e=0;e<this.nodes.length;e++)for(this.backtrack(e,e);0!==this.visitedLength;){var t=this.visitedStack.pop();this.visited[t]&&(this.visited[t]=0,this.visitedLength--)}return this.cycles},Cc.prototype.backtrack=function(e,t){var n=!1;this.stack.push(t),this.visited[t]||(this.visited[t]=1,this.visitedLength++),this.visitedStack.push(t);for(var i=0,r=this.adjacency[t]||[];i<r.length;i++){var o=r[i];if(this.removed[t]=this.removed[t]||{},!this.removed[t][o])if(o<e)this.removed[t][o]=!0;else if(o===e){for(var a=[],s=0,l=!(n=!0);s<this.stack.length;s++){var u=this.stack[s];e===u&&(l=!0),l&&a.push(this.nodes[u])}this.cycles.push(a)}else if(!this.visited[o]){var d=this.backtrack(e,o);n=n||d}}if(n)for(var c=void 0;c=this.visitedStack.pop(),this.visited[c]&&(this.visited[c]=null,this.visitedLength--),c!==t;);return this.stack.pop(),n},Cc);function Cc(e,t,n){this.cycles=[],this.visitedLength=0,this.visitedStack=[],this.stack=[],this.idToIndex={},this.removed={},this.nodes=e,this.visited=new Uint8Array(this.nodes.length);for(var i=0;i<e.length;i++)this.idToIndex[e[i]]=i;this.adjacency=wc(e,t,n,this.idToIndex)}var $g,wb=(wt(Ds,$g=Fe),Ds.prototype.shortestPath=function(e){void 0===e&&(e={source:void 0,target:void 0});var n=e.target,i=e.directed,r=void 0!==i&&i,o=e.filter,a=void 0===o?"visible":o,s=e.edgeCostFunction,l=void 0===s?function(){return 1}:s,u=e.heuristicFunction,d=void 0===u?function(){return 0}:u,c=this._graph.getNode(e.source),h=this._graph.getNode(n);if(!c)throw new Error("the source is not a node");if(!h)throw new Error("the target is not a node");var p=c._index,g=h._index,m=null;if(p===g)m={nodes:c.toList(),edges:this._graph.edgeList()};else{var b=this._graph.getNodeMaxIndex()+1,v=new Int32Array(b),y=new Float32Array(b),E=new Float32Array(b),S=new Set,w=new Fp(E);for(y.fill(1/0),E.fill(1/0),v.fill(-1),w.add(p),y[p]=0,E[p]=d(c,h);!w.isEmpty();){var M=w.removeMin();if(M===g){m=this._constructPath(v,p,g);break}S.add(M);var O=this._graph.getAdjacentDirections(M);if(O)for(var F=0;F<O.length;++F){for(var N=this._graph.getEdgeIndexesInDirection(O[F]),B=-1,X=0,J=-1,ae=0;ae<N.length;++ae){var ie=N[ae],U=this._sourceList.get(ie),Y=this._targetList.get(ie);if(U!==Y&&!(r&&M!==U||"visible"===a&&this._excludedList.get(ie)||"raw"===a&&this._virtualList.get(ie))){var he=l(this._edgeList.get(ie));(-1===B||he<X)&&(B=ie,X=he,J=U===M?Y:U)}}if(-1!==J||S.has(J)){var pe=y[M]+X;if(!w.has(J)||pe<y[J]){var we=this._nodeList.get(M);v[J]=B,y[J]=pe,E[J]=pe+d(we,h),w.add(J)}}}}}return Promise.resolve(m)},Ds.prototype._constructPath=function(e,t,n){for(var i=[n],r=[],o=n;o!==t;){var a=e[o],s=this._sourceList.get(a),l=this._targetList.get(a);i.push(o=o===s?l:s),r.push(a)}return i.reverse(),r.reverse(),{nodes:this._graph.nodeList(new Uint32Array(i)),edges:this._graph.edgeList(new Uint32Array(r))}},Ds.prototype.detectCycle=function(e,t){var n=t.getSource(),i=t.getTarget(),r=Jg(e._indexes,n._indexes,i._indexes);return r?this._graph.nodeList(new Uint32Array(r)).dedupe():null},Ds.prototype.getAllSimpleCycles=function(e,t){var n=this,i=t.getSource(),r=t.getTarget();return new Kg(e._indexes,i._indexes,r._indexes).getCycles().map(function(o){return n._graph.nodeList(new Uint32Array(o))})},Ds);function Ds(e){var t=e.graph,n=$g.call(this)||this;return n._graph=t,n._nodeList=t.getNodeAttribute("object"),n._edgeList=t.getEdgeAttribute("object"),n._sourceList=t.getEdgeAttribute("source"),n._targetList=t.getEdgeAttribute("target"),n._excludedList=t.getEdgeAttribute("excluded"),n._virtualList=t.getEdgeAttribute("virtual"),n}var e_,Cb=(wt(Tc,e_=Fe),Tc.prototype._addAttributeLayer=function(){return this._graphics.addAttributeLayer({name:"curvature",priority:2,edgeDependencies:{parallelEdges:!0},edgeContext:this._context,edgeAttributes:{curvature:function(e,t){var n,i=t.edgesAlwaysCurvy,r=t.directedEdges,o=e.getSource()===e.getTarget(),a=e.getParallelEdges(),s=a.indexOf(e);if(-1===s)return 0;if(o)n=s+1;else{var l=e.getSource(),u=a.size;if(1===u&&!i)return 0;if(r){for(var d=0,c=0;c<s;++c)a.get(c).getSource()===l&&(d+=1);n=d+1}else{var h=l!==a.get(0).getSource();n=u%2!=1||i?(1+(s/2|0))*(s%2==0?1:-1)*(h?-1:1):0===s?0:((s+1)/2|0)*(s%2==0?1:-1)*(h?-1:1)}}return n}}})},Tc);function Tc(e){var t=e_.call(this)||this;return t._context={edgesAlwaysCurvy:!1,directedEdges:!1},t._settings=e.settings,t._graphics=e.graphics,t._attributeLayer=t._addAttributeLayer(),t._settings.register("edgesAlwaysCurvy",!1,function(n){t._context.edgesAlwaysCurvy=n,t._attributeLayer.updateAll()}),t._settings.register("directedEdges",!1,function(n){t._context.directedEdges=n,t._attributeLayer.updateAll()}),t}function Tb(){return{}}function Mb(){}function Ib(){return!1}function kb(){}function Ob(){}function Nb(){}var t_,n_=(wt(ns,t_=Rd),ns.prototype.configure=function(e){this._onStart=e.onStart||Ob,this._onEnd=e.onEnd||Nb,this._update=e.update||Mb,this._onUpdate=e.onUpdate||kb,this._createContext=e.context||Tb,this._isRunning=e.isRunning||Ib},ns.prototype.setData=function(e){this._data=e},ns.prototype.getData=function(){return this._data},ns.prototype.onStart=function(){return this.fire("start",{target:this}),this._onStart.call(this),this},ns.prototype.stop=function(){},ns);function ns(e,t,n){var i=t_.call(this)||this;return i._complete=!1,i._data=null,i._dependencies=t,i._dom=n,i.configure(e),i}var i_,Lb=(wt(Cu,i_=n_),Cu.prototype.sync=function(e){var t=e.data.isRunning,n=e.data.result,i=this._onUpdate.call(this,n,this._dependencies,t);return this.fire("update",{target:this,isRunning:t}),t?this.send(i):this.stop(n)},Cu.prototype.stop=function(e){return this._complete||(this._onEnd.call(this,e,this._dependencies),this._worker.terminate(),this.fire("stop",{target:this})),this._complete=!0,this},Cu.prototype.send=function(e){return this._worker.postMessage(Cp(e)),this},Cu);function Cu(e,t,n){var i=i_.call(this,e,t,n)||this,r=[function(o){void 0===o&&(o={});for(var a=Object.keys(o),s=[],l=0,u=a.length;l<u;l++){var d=a[l],c=o[d];if("function"!=typeof c)throw new Error('Asynchronous task: dependency "'+d+'" is not found');var h=Fb(c);h?(s.push(o_(c,d)),h!==d&&s.push("var "+d+" = "+h+";")):s.push("var "+d+" = "+o_(c,d)+";")}return s.join("\n")}(e.imports),"","","var __CONTEXT = ("+i._createContext.toString()+")();","var __UPDATE_FUNC = "+i._update.toString()+";","var __IS_RUNNING_FUNC = "+i._isRunning.toString()+";","",'self.addEventListener("message", function (evt) {',"  var result    = __UPDATE_FUNC(evt.data, __CONTEXT);","  var isRunning = __IS_RUNNING_FUNC(__CONTEXT, evt.data);","  self.postMessage({ result: result, isRunning: isRunning });","});"].join("\n");return i._worker=Tp(r),i._worker.addEventListener("message",function(o){i._dom.isDestroyed()||i.sync(o)}),i}var r_=/^function\s*\(/;function o_(e,t){var n=e.toString();return r_.test(n)?"function "+(e.name||t)+" "+n.substring(n.indexOf("(")):n}function Fb(e){var t=e.toString();return e.name?e.name:r_.test(t)?null:t.substring("function ".length,t.indexOf("(")).trim()}var a_,Pb=(wt(Tu,a_=n_),Tu.prototype.sync=function(e){var t=this._update(e,this._context),n=this._isRunning(this._context,e),i=this._onUpdate.call(this,t,this._dependencies,n);this.fire("update",{target:this,isRunning:n}),n?this.send(i):this.stop(t)},Tu.prototype.send=function(e){var t=this;return this._complete||this._dom.setTimeout(function(){return t.sync(e)},0),this},Tu.prototype.stop=function(e){return this._complete||(this._onEnd(e,this._dependencies),this._complete=!0),this},Tu);function Tu(e,t,n){var i=a_.call(this,e,t,n)||this;return i._context=i._createContext(),i}var s_,Db=(wt(Mc,s_=Fe),Mc.prototype.run=function(e,t,n,i){var s,u,r=n,o=(void 0===(u=(e.configure||function(a){return a})(s=t,i))&&(u=s),u);return new(r?Lb:Pb)(e,i,this._dom).onStart().send(o)},Mc);function Mc(e){var t=e.dom,n=s_.call(this)||this;return n._dom=t,n}var u_,Ul="complete",Ub=(wt(jo,u_=Fe),jo.prototype.register=function(e,t){if(e in this._layouts)throw new Error("Layout "+e+" already exists");var n=Nt({},t,{name:e});this._layouts[e]=n},jo.prototype.getAvailableLayouts=function(){return Object.keys(this._layouts)},jo.prototype.start=function(e,t){var n=this;void 0===t&&(t={});var i=this._layouts[e];return new Promise(function(r){if(!i)throw new Error("layout "+e+" does not exist");n._currentLayout&&n.stop(),t.duration="number"==typeof t.duration?t.duration:500;var o=i.onSync,a=-1/0;t.skipTextDrawing=void 0===t.skipTextDrawing||t.skipTextDrawing;var s=t.locate||false;s&&"boolean"==typeof s&&(s={}),t.locate=s;var l=n._onTaskStart,u=n._onTaskUpdate,d=n._onTaskComplete,c={name:e,update:i.update,isRunning:i.isRunning,configure:i.configure,context:i.context,imports:i.imports,onStart:function(){l(i,t,this)},onUpdate:function(p,g,m){var b=P();m&&b-a<40||(a=b,u(this,e,p,m,o,t))},onEnd:function(p){var g=this;this.once(Ul,function(m){d(p,m,i,t,r,g.getData())})}};n._graphics.forceAttributesComputation(),n._currentLayout=n._tasks.run(c,t,void 0===t.useWebWorker||t.useWebWorker,n._modules)})},jo.prototype._animateCamera=function(e,t,n){if(0===e.indexes.length)return Promise.resolve();var i=this._locate.layoutDataBoundingBox(e),r=this._locate.computeConfigForBounds(i,t);return this._camera.setView(r,{duration:n,easing:t.easing})},jo.prototype.stop=function(){return null!==this._currentLayout&&(this._currentLayout.stop(),this._currentLayout.fire(Ul,null),this._currentLayout=null),Promise.resolve()},jo.prototype.isRunning=function(){return null!==this._currentLayout},jo.prototype._assignNodePositions=function(e,t,n){if(!e||n){var i=e?new Uint32Array(e.indexes):void 0,r=this._graph.nodeList(i);return Promise.resolve(r)}for(var a=e.x,s=e.y,l=this._graph.nodeList(new Uint32Array(e.indexes)),u=Ic(e),d=0;d<u.length;d++)u[d]={x:a[d],y:s[d]};return l.setAttributes(u,t)},jo);function jo(e){var t=u_.call(this)||this;return t._currentLayout=null,t._onTaskUpdate=function(n,i,r,o,a,s){var l=s.duration,u=s.onSync,d=s.onUpdate,c=s.dryRun,h=s.locate;if(u&&t._dom.setTimeout(function(){return u(r,t._modules,o)},l),a){var p=a(r,t._modules,o);t._events.fire(I.LAYOUT_COMPUTED,{type:I.LAYOUT_COMPUTED,name:i,positions:p}),d&&d(r,p,o);var g=t._assignNodePositions(p,l,c);o||(h&&t._animateCamera(p,h,s.duration),g.then(function(){return n.fire(Ul,p)}))}else o||n.fire(Ul,r)},t._onTaskComplete=function(n,i,r,o,a,s){t._currentLayout=null,r.onEnd&&n&&r.onEnd(n,t._modules),o.skipTextDrawing&&t._dom.setTimeout(function(){return t._graphics.showTexts()},50);var l=t._graph.nodeList(new Uint32Array(s.indexes)),u=o.dryRun&&n?i:l_(l),d=l.getId(),c={before:Ic(s),current:Ic(u)};t._events.fire(I.LAYOUT_END,{type:I.LAYOUT_END,name:r.name,positions:c,ids:d}),t._dom.setTimeout(function(){o.onEnd&&o.onEnd(n),a({name:r.name,positions:c,ids:d})})},t._onTaskStart=function(n,i,r){i.skipTextDrawing&&t._graphics.hideTexts();var o=l_(t._graph.getNodes(i.nodes)),a=o.ids;r.setData(o),t._events.fire(I.LAYOUT_START,{type:I.LAYOUT_START,name:n.name,ids:a,task:r})},t._modules=e,t._dom=e.dom,t._events=e.events,t._graph=e.graph,t._graphics=e.graphics,t._tasks=e.tasks,t._locate=e.locate,t._camera=e.camera,t._layouts={},t._events.register([I.LAYOUT_START,I.LAYOUT_END,I.LAYOUT_COMPUTED]),t._currentLayout=null,t._events.on(I.CLEAR_GRAPH,function(){return t.stop()}),t}function Ic(e){for(var t=e.x,n=e.y,i=e.indexes.length,r=new Array(i),o=0;o<i;o++)r[o]={x:t[o],y:n[o]};return r}function l_(e){var t=e.getAttribute("x"),n=e.getAttribute("y");return{ids:e.getId(),indexes:e._indexes,x:t,y:n}}function jl(e){return"number"==typeof e&&isFinite(e)}var jb=(Rs.prototype.onUpdate=function(e){this._onUpdateHandlers.push(e)},Rs.prototype.getPropertyInfo=function(){return this._info},Rs.prototype.getPath=function(){return this._path.slice()},Rs.prototype.destroy=function(){this._module.unwatchPropertyInformation(this._isNode,this._path,this._triggerUpdate,this._filter,this._unwindArrays)},Rs.prototype.kill=function(){return this.destroy()},Rs);function Rs(e,t,n){var i=n.path,r=n.filter,o=n.unwindArrays,a=this;this._module=e,this._isNode=t,this._path=i||[],this._filter=r,this._unwindArrays=o,this._onUpdateHandlers=[],this._triggerUpdate=function(s){for(var l=0;l<a._onUpdateHandlers.length;++l)a._onUpdateHandlers[l](s)},this._info=e.watchPropertyInformation(this._isNode,this._path,this._triggerUpdate,this._filter,this._unwindArrays)}var Zb=(Object.defineProperty(yr.prototype,"path",{get:function(){return this._path},enumerable:!0,configurable:!0}),yr.prototype.onPropertyAdded=function(e){return this._onAddHandlers.push(e),this},yr.prototype.onPropertyRemoved=function(e){return this._onRemoveHandlers.push(e),this},yr.prototype.onPropertyUpdated=function(e){return this._onUpdateHandlers.push(e),this},yr.prototype.getPath=function(){return this._path.slice()},yr.prototype.getProperties=function(){return this._propertyList.slice()},yr.prototype.getPropertyInfo=function(e){var t=this._properties[e];return t?t.info:null},yr.prototype.destroy=function(){var e=this;vt(this._properties,function(n,i){var r=n.handler,o=e._path.concat([i]);e._module.unwatchPropertyInformation(e._isNode,o,r,e._filter,e._unwindArrays)}),this._propertyList=void 0,this._properties=void 0,this._onAddHandlers=void 0,this._onRemoveHandlers=void 0,this._onUpdateHandlers=void 0;var t=this._module._objectPropertyWatchers.indexOf(this);this._module._objectPropertyWatchers.splice(t,1)},yr.prototype.kill=function(){return this.destroy()},yr.prototype.updateSubPropertiesToWatch=function(e,t){if(e===this._isNode)for(var n=t.getData(this._path),i=0;i<n.length;i++){var r=n[i];if(Qr(r))for(var o=Object.keys(r),a=0;a<o.length;a++)this._addSubPropertyToWatch(o[a])}},yr.prototype._addSubPropertyToWatch=function(e){var t=this;if(!this._properties[e]){var n=this._path.concat([e]),i=function(){return t._triggerPropertyUpdate(e)},s=this._module.watchPropertyInformation(this._isNode,n,i,this._filter,this._unwindArrays);this._properties[e]={handler:i,info:s},this._triggerPropertyUpdate(e)}},yr.prototype._triggerPropertyUpdate=function(e){var t=this._properties[e].info,n=this._propertyList.indexOf(e),i=-1!==n,r="undefined"!==t.getType();!i&&r?(this._propertyList.push(e),this._triggerHandlers("_onAddHandlers",e,t),this._triggerHandlers("_onUpdateHandlers",e,t)):i&&!r?(this._propertyList.splice(n,1),this._triggerHandlers("_onUpdateHandlers",e,t),this._triggerHandlers("_onRemoveHandlers",e,t)):i&&r&&this._triggerHandlers("_onUpdateHandlers",e,t)},yr.prototype._triggerHandlers=function(e,t,n){for(var i=this[e],r=0,o=i.length;r<o;r++)i[r](t,n)},yr);function yr(e,t,n){var i=n.path,r=n.filter,o=n.unwindArrays;this._module=e,this._isNode=t,this._path=i,this._filter=r,this._unwindArrays=o,this._propertyList=[],this._properties={},this._onAddHandlers=[],this._onRemoveHandlers=[],this._onUpdateHandlers=[]}var Gb=(Ta.prototype.isNode=function(){return this._watcher.isNode},Ta.prototype.getPath=function(){return this._watcher.property.slice()},Ta.prototype.getBoundaries=function(){var e=this._watcher.boundaries;return e?{min:e.min,max:e.max}:null},Ta.prototype.getValues=function(){return this._watcher.values.keys()},Ta.prototype.getValueCount=function(e){return this._watcher.values.get(e)||0},Ta.prototype.getCount=function(){return this._watcher.total},Ta.prototype.getType=function(){return 0<this._watcher.any?"any":0<this._watcher.numbers?"number":"undefined"},Ta);function Ta(e){this._watcher=e}function d_(e){return"number"==typeof e&&isNaN(e)}var c_=(Zo.prototype.set=function(e,t){var n=this._getIndex(e);return-1===n?(this._keys.push(e.slice()),this._values.push(t),!0):(this._values[n]=t,!1)},Zo.prototype.get=function(e){var t=this._getIndex(e);return-1===t?void 0:this._values[t]},Zo.prototype.has=function(e){return-1!==this._getIndex(e)},Zo.prototype.delete=function(e){var t=this._getIndex(e);return-1!==t&&(this._keys.splice(t,1),this._values.splice(t,1),!0)},Zo.prototype.keys=function(){return this._keys.map(function(e){return e.slice()})},Zo.prototype.values=function(){return this._values.slice()},Zo.prototype._getIndex=function(e){for(var t=0;t<this._keys.length;t++){var n=this._keys[t];if(n.length===e.length){for(var i=!0,r=0;r<e.length;r++){var o=n[r],a=e[r];if(!(o===a||d_(o)&&d_(a))){i=!1;break}}if(i)return t}}return-1},Object.defineProperty(Zo.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Zo);function Zo(){this._keys=[],this._values=[]}var qb=(Ma.prototype.clear=function(){return this._arrays=new c_,this._map.clear()},Ma.prototype.delete=function(e){return li(e)?this._arrays.delete(e):this._map.delete(e)},Ma.prototype.get=function(e){return li(e)?this._arrays.get(e):this._map.get(e)},Ma.prototype.set=function(e,t){return li(e)?this._arrays.set(e,t):this._map.set(e,t),this},Ma.prototype.keys=function(){return il(this._map).concat(this._arrays.keys())},Ma.prototype.values=function(){return ws(this._map).concat(this._arrays.values())},Object.defineProperty(Ma.prototype,"size",{get:function(){return this._map.size+this._arrays.size},enumerable:!0,configurable:!0}),Ma);function Ma(){this._map=new Map,this._arrays=new c_}var h_,Hb=(wt(Zr,h_=Fe),Zr.prototype.watchNodeObjectProperty=function(e){return this._watchObjectProperty(!0,ql(e))},Zr.prototype.watchEdgeObjectProperty=function(e){return this._watchObjectProperty(!1,ql(e))},Zr.prototype.watchNodeNonObjectProperty=function(e){return this._watchNonObjectProperty(!0,ql(e))},Zr.prototype.watchEdgeNonObjectProperty=function(e){return this._watchNonObjectProperty(!1,ql(e))},Zr.prototype.watchPropertyInformation=function(e,t,n,i,r){var o=this._findWatcher(e,t,i,r)||this._createWatcher(e,t,i,r);return n&&o.onChange.push(n),o.info},Zr.prototype.unwatchPropertyInformation=function(e,t,n,i,r){var o=this._findWatcher(e,t,i,r);if(o){var a=o.onChange,s=a.indexOf(n);if(-1!==s&&(a.splice(s,1),0===a.length)){var l=this._propertyWatchers.indexOf(o);this._propertyWatchers.splice(l,1)}}},Zr.prototype._watchObjectProperty=function(e,t){var n=new Zb(this,e,t);return this._objectPropertyWatchers.push(n),n.updateSubPropertiesToWatch(e,this._graph[e?"getNodes":"getEdges"](t.filter)),n},Zr.prototype._watchNonObjectProperty=function(e,t){return new jb(this,e,t)},Zr.prototype._findWatcher=function(e,t,n,i){for(var r=0;r<this._propertyWatchers.length;++r){var o=this._propertyWatchers[r];if(o.isNode===e&&o.filter===n&&o.unwindArrays===i&&Wb(o.property,t))return o}return null},Zr.prototype._createWatcher=function(e,t,n,i){var r={isNode:e,property:t,numbers:0,any:0,total:0,values:new qb,boundaries:null,onChange:[],filter:n,unwindArrays:i,info:void 0};return r.info=new Gb(r),Mu(r,this._graph[e?"getNodes":"getEdges"](n).getData(t)),this._propertyWatchers.push(r),r},Zr);function Zr(e){var t,n=e.graph,i=e.events,r=h_.call(this)||this;return r._onExcludedStateChange=function(o){for(var a=o.elements,s=!o.value,l=0,u=r._propertyWatchers.length;l<u;l++){var d=r._propertyWatchers[l];d.isNode===a.isNode&&"visible"===d.filter&&(s?Mu(d,a.getData(d.property)):Gl(d,a.getData(d.property)),Zl(d))}},r._onDataChange=function(o){for(var a=o.isNode,s=o.changes,l=0;l<r._propertyWatchers.length;++l){var u=(S=r._propertyWatchers[l]).property,d="all"===S.filter;if(S.isNode===a)for(var c=0;c<s.length;++c){var h=s[c],p=Yb(h.property||[],u);if(p){for(var g=h.nodes||h.edges,m=[],b=[],v=0;v<g.size;++v){var y=g.get(v);(d||y.isVisible())&&(m.push(En(h.newValues[v],p)),b.push(En(h.previousValues[v],p)))}m.length&&(Mu(S,m),Gl(S,b),Zl(S))}}}l=0;for(var E=r._objectPropertyWatchers.length;l<E;l++){var S,w=(S=r._objectPropertyWatchers[l]).path,M=function(O){var F=s[O],L=F.property,X=F.nodes||F.edges,J=X.isNode;(!L||L.length<=w.length+1&&w.every(function(ae,ie){return ae===L[ie]}))&&S.updateSubPropertiesToWatch(J,X)};for(c=0;c<s.length;++c)M(c)}},r._onElementsAdded=function(o){for(var a=o.nodes||o.edges,s=0;s<r._propertyWatchers.length;++s){var l=r._propertyWatchers[s];if(l.isNode===a.isNode){var u=a.getData(l.property);u.length&&(Mu(l,u),Zl(l))}}for(s=0;s<r._objectPropertyWatchers.length;s++)r._objectPropertyWatchers[s].updateSubPropertiesToWatch(a.isNode,a)},r._onElementsRemoved=function(o){for(var a=o.nodes||o.edges,s=0;s<r._propertyWatchers.length;++s){var l=r._propertyWatchers[s];if(l.isNode===a.isNode&&"all"===l.filter){var d=a.getData(l.property);d.length&&(Gl(l,d),Zl(l))}}},r._onGraphClear=function(){r._propertyWatchers.forEach(function(o){o.numbers=0,o.any=0,o.total=0,o.boundaries=null,o.values.clear()})},r._graph=n,r._propertyWatchers=[],r._objectPropertyWatchers=[],i.on(((t={})[I.EXCLUDED_STATE_CHANGE]=r._onExcludedStateChange,t[I.UPDATE_NODE_DATA+" "+I.UPDATE_EDGE_DATA]=r._onDataChange,t[I.ADD_NODES+" "+I.ADD_EDGES]=r._onElementsAdded,t[I.REMOVE_NODES+" "+I.REMOVE_EDGES]=r._onElementsRemoved,t[I.CLEAR_GRAPH]=r._onGraphClear,t)),r}function p_(e){return null==e?[]:Pr(e)}function Zl(e){for(var t=0;t<e.onChange.length;++t)e.onChange[t](e.info)}function Wb(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}function Yb(e,t){if(e.length>t.length)return null;for(var n=0;n<e.length;++n)if(e[n]!==t[n])return null;return t.slice(n)}function Mu(e,t,n){for(var i=e.values,r=!n&&e.unwindArrays,o=0;o<t.length;++o){var a=t[o];if(n||void 0===a||(e.total+=1),r&&Array.isArray(a))Mu(e,a,!0);else{var s=i.get(a);s?i.set(a,s+1):(i.set(a,1),jl(a)?(e.boundaries?a<e.boundaries.min?e.boundaries.min=a:a>e.boundaries.max&&(e.boundaries.max=a):e.boundaries={min:a,max:a},e.numbers+=1):void 0!==a&&(e.any+=1))}}}function Gl(e,t,n){for(var i=e.values,r=!n&&e.unwindArrays,o=e.boundaries,a=!1,s=0;s<t.length;++s){var l=t[s];if(n||void 0===l||--e.total,r&&Array.isArray(l))a=a||Gl(e,l,!0);else{var u=i.get(l);1<u?i.set(l,u-1):(i.delete(l),jl(l)?(--e.numbers,!o||o.min!==l&&o.max!==l||(a=!0)):void 0!==l&&--e.any)}}return!n&&a&&(e.boundaries=function(d){for(var c=void 0,h=void 0,p=0;p<d.length;++p){var g=d[p];jl(g)&&((void 0===c||g<c)&&(c=g),(void 0===h||h<g)&&(h=g))}return void 0===c?null:{min:c,max:h}}(i.keys())),a}function ql(e){return"object"!=typeof e||null===e||Array.isArray(e)?{path:p_(e),filter:"visible",unwindArrays:!1}:{path:p_(e.path),filter:"all"===e.filter?"all":"visible",unwindArrays:!!e.unwindArrays}}function kc(e,t,n,i){void 0===e&&(e=function(a,s){return a-s}),void 0===t&&(t=[]),void 0===n&&(n={}),void 0===i&&(i=function(a){return a});var r=t.length;function o(a){for(;;){var s=2*a+1,l=1+s,u=a;if(s<r&&e(t[s],t[u])<0&&(u=s),l<r&&e(t[l],t[u])<0&&(u=l),u===a)return a;var d=t[u];t[u]=t[a],t[a]=d,n[i(t[u])]=u,n[i(d)]=a,a=u}}return{get keys(){return n},get size(){return r},heapify:o,pop:function(){if(!(r<=0)){if(1===r)return r--,t[0];var a=t[0];return t[0]=t[r-1],r--,o(0),a}},decreaseKey:function(a,s){for(void 0!==s&&(t[a]=s,n[i(s)]=a);0<a;){var l=a-1>>1;if(!(0<e(t[l],t[a])))break;var u=t[a];t[a]=t[l],t[l]=u,n[i(t[a])]=a,a=n[i(u)]=l}return a},min:function(){return t[0]},remove:function(a){return this.decreaseKey(a,Number.NEGATIVE_INFINITY),this.pop()},push:function(a){var s=++r-1;for(t[s]=a;0<s;){var l=s-1>>1;if(!(0<e(t[l],t[s])))break;var u=t[s];t[s]=t[l],t[l]=u,n[i(t[s])]=s,s=n[i(u)]=l}return s},empty:function(){return r<=0},toArray:function(){return t.slice(0,r)}}}function Hl(e,t,n,i,r,o,a){void 0===i&&(i=e.map(function(N,B){return B+1}));var s=i?i.length:e.length,l=new Float32Array(s),u=new Int32Array(s),d=new Uint32Array(s),c=Number.POSITIVE_INFINITY,h={};if(0===s)return{distances:l,path:null,pathLength:null};if(!r){r={};for(var p=0;p<s;p++)r[i[p]]=p}for(p=0;p<s;p++)l[p]=c,u[p]=-1,d[p]=h[p]=p;var g=kc(function(N,B){return l[N]-l[B]},d,h);for(l[r[t]]=0,g.decreaseKey(h[r[t]]);0!==g.size;){var m=g.pop(),b=l[m],v=e[m];if(b===c)break;p=0;for(var y=v.nodes.length;p<y;p++){var E=v.nodes[p],S=o?1:a?a(i[m],E):v.weights[p],w=r[E];if(void 0!==w){var M=b+S;M<l[w]&&(l[w]=M,u[w]=m,g.decreaseKey(h[w]))}}}var O=null,F=null;if(void 0!==n){var L=r[n];if(l[L]!==c){for(O=[],p=L;-1!==p;p=u[p])O.push(i[p]);O.reverse(),F=l[n]}}return{distances:l,path:O,pathLength:F}}function f_(e,t){var n=e.getPosition(),i=t.getPosition();return yi(n.x,n.y,i.x,i.y)}var g_,Xb={pathLengthFunction:f_,heuristicLengthFunction:f_},Jb={pathLengthFunction:function(){return 1},heuristicLengthFunction:function(){return 0}},Qb=(wt(Iu,g_=Fe),Iu.prototype.astar=function(e,t,n){return __(this._graph,e,t,this._cachedObjectList,Nt({},Xb,n))},Iu.prototype.dijkstra=function(e,t,n){return __(this._graph,e,t,this._cachedObjectList,Nt({},Jb,n))},Iu.prototype.dijkstraBig=function(e,t,n){var i=this._graph.getNodes(),r=Hl(this._graph.getAdjacencyList({directed:n.directed,weight:1,nodes:i}),this._graph.getNode(e)._index,this._graph.getNode(t)._index,i._indexes,void 0,!1);return r.path&&this._graph.nodeList(new Uint32Array(r.path))},Iu);function Iu(e){var t=e.graph,n=g_.call(this)||this;return n._graph=t,n._cachedObjectList=t.getNodeAttribute("object"),n}function __(e,t,n,i,r){var o=void 0===r?{}:r,a=o.pathLengthFunction,s=o.heuristicLengthFunction,l=o.filter,u=o.directed,d=e.getNode(t)._index,c=e.getNode(n)._index,h=a,p=s,g=u?or.OUT:or.BOTH,m=i.get(d),b=i.get(c),v=null;if(d===c)return e.nodeList(new Uint32Array([d]));for(var y=e.getNodeMaxIndex()+1,E=new Sp,S=new Sp,w=new Int32Array(y),M=new Float32Array(y),O=new Float32Array(y),F=0;F<y;++F)w[F]=-1,M[F]=1/0,O[F]=1/0;for(S.add(d),M[d]=0,O[d]=p(m,b);0!==S.length;){var L=S.length,N=S.get(0),B=0,X=O[N];for(F=1;F<L;++F){var J=S.get(F),ae=O[J];ae<X&&(X=ae,N=J,B=F)}if(N===c){v=Kb(w,d,c);break}var ie=i.get(N);S.removeByPosition(B),E.add(N);var U=e.node(N).getAdjacentNodes({direction:g,filter:l})._indexes;for(F=0;F<U.length;++F){var Y=U[F],he=i.get(Y);if(!E.has(Y)){var pe=M[N]+h(ie,he);!S.add(Y)&&pe>=M[Y]||(w[Y]=N,M[Y]=pe,O[Y]=pe+p(he,b))}}}return v&&e.nodeList(v)}function Kb(e,t,n){for(var i=[n],r=n;r!==t;)i.push(r=e[r]);return i.reverse(),i}var m_,$b=(wt(kr,m_=Fe),Object.defineProperty(kr.prototype,"x",{get:function(){return this._position.x||0},enumerable:!0,configurable:!0}),Object.defineProperty(kr.prototype,"y",{get:function(){return this._position.y||0},enumerable:!0,configurable:!0}),kr.prototype._later=function(){return this._dom.afterNextFrame()},kr.prototype.move=function(e){var t=this,n=e.x,i=e.y;return void 0!==n&&void 0!==i?this._dom.afterNextFrame().then(function(){return t._events.fire(I.VIRTUAL_MOVE,{x:n,y:i,dx:n-t.x,dy:i-t.y}),t._later()}):Promise.resolve()},kr.prototype.down=function(e){var t=this,n=void 0===e?{}:e,o=n.button,a=void 0===o?Kt.LEFT:o;return this.move({x:n.x,y:n.y}).then(function(){return t._events.fire(I.VIRTUAL_DOWN,{x:t.x,y:t.y,button:a}),t._events.fire(I.VIRTUAL_MOVE,{x:t.x,y:t.y,dx:0,dy:0,button:a}),t._later()})},kr.prototype.up=function(e){var t=this,n=void 0===e?{}:e,i=n.x,r=n.y,o=n.button,a=void 0===o?Kt.LEFT:o;return this.move({x:i,y:r}).then(function(){return t._events.fire(I.VIRTUAL_UP,{x:i,y:r,button:a}),t._later()})},kr.prototype.click=function(e){var t=this,n=void 0===e?{}:e,i=n.x,r=n.y,o=n.button,a=void 0===o?Kt.LEFT:o;return this.move({x:i,y:r}).then(function(){return t._events.fire(I.VIRTUAL_CLICK,{x:i,y:r,button:a}),t._later()})},kr.prototype.rightClick=function(e){var t=this,n=void 0===e?{}:e,i=n.x,r=n.y,o=n.button,a=void 0===o?Kt.RIGHT:o;return this.move({x:i,y:r}).then(function(){return t._events.fire(I.VIRTUAL_CLICK,{x:i,y:r,button:a}),t._later()})},kr.prototype.doubleClick=function(e){var t=this,n=void 0===e?{}:e,i=n.x,r=n.y,o=n.button,a=void 0===o?Kt.LEFT:o;return this.move({x:i,y:r}).then(function(){return t._events.fire(I.VIRTUAL_DOUBLE_CLICK,{x:i,y:r,button:a}),t._later()})},kr.prototype.drag=function(e,t){var n=this;return this.down(e).then(function(){return n.move(t)}).then(function(){return n.up(t)})},kr.prototype.wheel=function(e){var t=this,n=e.x,i=e.y,r=e.delta;return this.move({x:n,y:i}).then(function(){return t._events.fire(I.VIRTUAL_WHEEL,{x:n,y:i,delta:r}),t._later()})},kr);function kr(e){var t=e.position,n=e.dom,i=e.events,r=m_.call(this)||this;return r._dom=n,r._events=i,r._position=t,r._events.register([I.VIRTUAL_DOWN,I.VIRTUAL_UP,I.VIRTUAL_MOVE,I.VIRTUAL_CLICK,I.VIRTUAL_DOUBLE_CLICK,I.VIRTUAL_WHEEL]),r}function Gr(e,t,n,i,r,o){var a=Fn(),s=o.graphToScreenCoordinates(e),l=o.graphToScreenCoordinates(t);r.beginPath(),r.moveTo(s.x*a,s.y*a),r.lineTo(l.x*a,l.y*a),r.strokeStyle=i,r.lineWidth=n,r.stroke()}function v_(e,t,n,i){for(var r,o,a=0,s=e.length-1;a<s;)r=(a+s)/2|0,o=Math.abs(t[e[r]]-n),Math.abs(t[e[1+r]]-n)<=o?a=1+r:s=r;return i?s:e[s]}function y_(e,t,n,i,r,o,a){for(var s,l,u,d,c,h,p=!1,g=0,m=e.length;!p&&g<m;g++)for(var b=0;!p&&b<m;b++)if(g!==b){var v=e[g],y=e[b];b<g&&(d=y,y=v,v=d);var E=t[v],S=t[y],w=o.get(v),M=o.get(y);E+w<i-r&&i+r<S-M&&Math.abs(Math.abs(E+w-(i-r))-Math.abs(S-M-(i+r)))<=a?(s=v,l=n,u=y,c=[E+w,(h=E+w+Math.abs(S-M-(E+w))/2)-r,h+r,S-M],p=!0):E+w<i-r&&S+M<i-r&&Math.abs(Math.abs(E+w-(S-M))-Math.abs(Math.max(E+w,S+M)-(i-r)))<=a?(s=v,l=y,u=n,c=[E+w,S-M,S+M,(h=S+w+Math.abs(Math.abs(E+w-(S-M)))+r)-r],p=!0):i+r<E-w&&i+r<S-M&&Math.abs(Math.abs(E+w-(S-M))-Math.abs(Math.min(E-w,S-M)-(i+r)))<=a&&(s=n,l=v,u=y,c=[(h=E-w-Math.abs(Math.abs(E+w-(S-M)))-r)+r,E-w,E+w,S-M],p=!0)}return p?{a:s,b:l,c:u,current:n,target:h,points:c}:null}var ei,qr,Oc={tolerance:5,centerSnapDistance:240,sideSnapDistanceFactor:3,guidelineWidth:1,guidelineColor:"#ff0000",preferredDistance:{enabled:!0,ratio:1.13,tolerance:10,lineColor:"#00C3FF",lineWidth:1},neighbours:{enabled:!0,offset:5,tolerance:3,lineColor:"#00C3FF",lineWidth:1}};(qr=ei=ei||{})[qr.NONE=0]="NONE",qr[qr.CENTER=1]="CENTER",qr[qr.LEFT=2]="LEFT",qr[qr.RIGHT=3]="RIGHT",qr[qr.TOP=4]="TOP",qr[qr.BOTTOM=5]="BOTTOM";var x_,e1=(wt(Eo,x_=Fe),Eo.prototype.enable=function(e){var t=this;this._enabled||(this._options=ln(e,Oc),this._enabled=!0,this._graphics.addCanvas(this._canvas),this._events.on(I.NODES_DRAG_START,this._onNodeDragStart),this._events.on(I.NODES_DRAG_END,this._onNodeDragEnd),this._settings.update({"interactions.drag.onBeforeDrag":function(n,i,r,o){return t._onBeforeDrag(i,r,o)}}))},Eo.prototype.disable=function(){this._enabled&&(this._events.removeListener(this._onNodeDragStart),this._events.removeListener(this._onNodeDragEnd),this._graphics.removeCanvas(this._canvas),this._settings.update({"interactions.drag.onBeforeDrag":null}),this._enabled=!1)},Eo.prototype.enabled=function(){return this._enabled},Eo.prototype._onBeforeDrag=function(e,t,n){if(this._node){var i=n[0];this._scan(i),this._node.setAttributes(i)}},Eo.prototype._cacheViewportData=function(){var e=this._camera,t=e.screenToGraphCoordinates({x:0,y:0}),n=e.screenToGraphCoordinates({x:e.width,y:e.height});this._nodes=this._spatial.getNodesByBoundingBox(t.x,t.y,n.x,n.y);var i=this._node._index,r=Array.from(this._nodes._indexes);r.splice(r.indexOf(i),1);var o=this._graph.getNodeAttribute("radius"),a=this._graph.getNodeAttribute("x"),s=this._graph.getNodeAttribute("y"),l=a.buffer(),u=s.buffer(),d=Xr(r.slice(),a),c=Xr(r.slice(),s),h={},p={};this._gridResolution=this._node.getAttribute("radius");for(var g=this._gridResolution,m=0,b=r.length;m<b;m++){var v=d[m],y=c[m],E=l[v]/g|0,S=u[y]/g|0;h[E]||(h[E]=[]),p[S]||(p[S]=[]),h[E].push(v),p[S].push(y)}this._nodesByX=d,this._nodesByY=c,this._xGrid=h,this._yGrid=p,this._xList=a,this._yList=s,this._X=l,this._Y=u,this._R=o},Eo.prototype._scan=function(e){Za(this._canvas,this._ctx);var t,n,i,r,o,a,s,l,u,d=this._node._index,c=e.x,h=e.y,p=this._r,g=this._options,m=this._xList,b=this._yList,v=this._R,y=this._X,E=this._Y,S=this._camera.zoom,w=Math.min(p,this._options.tolerance/S),M=2*p*g.sideSnapDistanceFactor,O=g.guidelineWidth,F=g.guidelineColor,L=d,N=d,B=!1,X=!1;if(L=v_(this._nodesByX,y,c),N=v_(this._nodesByY,E,h),Math.abs(y[L]-c)>g.centerSnapDistance&&(L=d),Math.abs(E[N]-h)>g.centerSnapDistance&&(N=d),this._xsnap=ei.NONE,L!==d){t=this._vguideline.start,n=this._vguideline.end,i=y[u=L],r=E[u],o=v.get(u),l=Math.abs(c-i);var J=Math.abs(c-p-(i-o)),ae=Math.abs(c+p-(i+o));l<Math.max(p,o)&&(r<h?(t.y=r-o,n.y=h+p):(t.y=r+o,n.y=h-p),(ie=Math.min(J,l,ae))===l?(t.x=n.x=i,n.y=h,t.y=r,this._xsnap=ei.CENTER):Math.abs(h-r)<o+p+M&&(ie===J?(t.x=n.x=i-o,this._xsnap=ei.LEFT):(t.x=n.x=i+o,this._xsnap=ei.RIGHT)),ie<w&&(B=!0)),this._xsnap!==ei.NONE&&Gr(t,n,O,F,this._ctx,this._camera)}if(this._ysnap=ei.NONE,N!==d){t=this._hguideline.start,n=this._hguideline.end,i=y[u=N],r=E[u],o=v.get(u),l=Math.abs(h-r);var ie,U=Math.abs(h-p-(r-o)),Y=Math.abs(h+p-(r+o));l<Math.max(p,o)&&(i<c?(t.x=i-o,n.x=c+p):(t.x=i+o,n.x=c-p),(ie=Math.min(U,l,Y))===l?(t.y=n.y=r,n.x=c,t.x=i,this._ysnap=ei.CENTER):Math.abs(c-i)<o+p+M&&(ie===U?(t.y=n.y=r-o,this._ysnap=ei.TOP):(t.y=n.y=r+o,this._ysnap=ei.BOTTOM)),ie<w&&(X=!0)),this._ysnap!==ei.NONE&&Gr(t,n,O,F,this._ctx,this._camera)}if(g.preferredDistance.enabled){var he=g.preferredDistance.ratio,pe=Math.min(g.preferredDistance.tolerance/S,p),we=Math.max(p,o);if(L===d||this._xsnap!==ei.NONE&&B)N!==d&&(this._ysnap===ei.NONE||!X)&&(i=y[u=N],r=E[u],o=v.get(u),(s=Math.abs(h-r)-(p+o)*(1+he))<=pe&&-pe<=s)&&(ke=h<r?-1:1,n=this._hguideline.end,(t=this._hguideline.start).x=i-we,n.x=i+we,t.y=n.y=r,Gr(t,n,O,F,this._ctx,this._camera),t.x=c-we,n.x=c+we,t.y=n.y=r+ke*(1+he)*(p+o),Gr(t,n,O,F,this._ctx,this._camera),this._ysnap=ei.CENTER,X=!0);else if(i=y[u=L],r=E[u],o=v.get(u),(a=Math.abs(c-i)-(p+o)*(1+he))<=pe&&-pe<=a){var ke=c<i?-1:1;(t=this._vguideline.start).x=(n=this._vguideline.end).x=i+ke*(1+he)*(p+o),t.y=r-we,n.y=r+we,t.x=n.x=i,Gr(t,n,O,F,this._ctx,this._camera),t.y=h-we,n.y=h+we,t.x=n.x=i+ke*(1+he)*(p+o),Gr(t,n,O,F,this._ctx,this._camera),this._xsnap=ei.CENTER,B=!0}}if(g.neighbours.enabled){var at=this._gridResolution,st=c/at|0,Xe=h/at|0,xt=this._xGrid,It=this._yGrid,Ge=[],He=[].concat(It[Xe-1]||Ge,It[Xe]||Ge,It[1+Xe]||Ge),Pe=[].concat(xt[st-1]||Ge,xt[st]||Ge,xt[1+st]||Ge),We=void 0;1<He.length&&(Xr(He,m),(We=y_(He,y,d,c,p,v,w))&&(this._drawNeighbourGuidelines(We,e,!1),B=!1)),1<Pe.length&&!We&&(Xr(Pe,b),(We=y_(Pe,E,d,h,p,v,w))&&(this._drawNeighbourGuidelines(We,e,!0),X=!1))}(B||X)&&this._snap(e,!B,!X)},Eo.prototype._drawNeighbourGuidelines=function(e,t,n){var i,r,o=e.a,a=e.b,s=e.c,l=e.points,u=e.target,d={x:0,y:0},c={x:0,y:0},p=this._X,g=this._Y,m=this._R.getMultiple([o,a,s]),b=m[0],v=m[1],y=m[2],E=this._options.neighbours,S=E.offset,w=E.lineWidth,M=E.lineColor;r=n?(t.y=u,b=-b,v=-v,y=-y,i=c.x=d.x=Math.min(p[o]+b,p[a]+v,p[s]+y)-S,p):(t.x=u,i=c.y=d.y=Math.max(g[o]+b,g[a]+v,g[s]+y)+S,g);var O=n?"y":"x",F=n?"x":"y";d[O]=l[0],c[O]=l[1],Gr(d,c,w,M,this._ctx,this._camera),d[O]=l[2],c[O]=l[3],Gr(d,c,w,M,this._ctx,this._camera),d[O]=l[0],d[F]=i-S/2,c[O]=l[0],d[F]=r[o]+b,Gr(d,c,w,M,this._ctx,this._camera),d[O]=l[1],d[F]=i-S/2,c[O]=l[1],d[F]=r[a]+v,Gr(d,c,w,M,this._ctx,this._camera),d[O]=l[2],d[F]=i-S/2,c[O]=l[2],d[F]=r[a]+v,Gr(d,c,w,M,this._ctx,this._camera),d[O]=l[3],d[F]=i-S/2,c[O]=l[3],d[F]=r[s]+y,Gr(d,c,w,M,this._ctx,this._camera)},Eo.prototype._snap=function(e,t,n){var i,r=this._xsnap,o=this._ysnap;t||r===ei.NONE||(i=this._vguideline.end,e.x=r===ei.LEFT?i.x+this._r:r===ei.RIGHT?i.x-this._r:i.x),n||o===ei.NONE||(i=this._hguideline.end,e.y=o===ei.TOP?i.y+this._r:o===ei.BOTTOM?i.y-this._r:i.y)},Eo);function Eo(e){var t=e.graph,n=e.graphics,i=e.spatial,r=e.camera,o=e.events,a=e.settings,s=x_.call(this)||this;return s._options=un(Oc),s._enabled=!1,s._ysnap=ei.NONE,s._xsnap=ei.NONE,s._node=null,s._nodes=null,s._r=0,s._vguideline={start:{x:0,y:0},end:{x:0,y:0}},s._hguideline={start:{x:0,y:0},end:{x:0,y:0}},s._gridResolution=0,s._onNodeDragStart=function(l){var u=l.nodes;1===u.size&&(s._node=u.get(0),s._cacheViewportData(),s._r=s._node.getAttribute("radius"))},s._onNodeDragEnd=function(){s._node=null,Za(s._canvas,s._ctx)},s._graph=t,s._graphics=n,s._spatial=i,s._settings=a,s._events=o,s._camera=r,s._options=un(Oc),s._enabled=!1,s._canvas=ci(),s._ctx=s._canvas.getContext("2d"),s}var t1=(So.prototype.getId=function(){return this._id},So.prototype.whenApplied=function(){return this._whenApplied},So.prototype.refresh=function(){return this._module.refreshRule(this._id)},So.prototype.getIndex=function(){return this._module.getRuleIndex(this._id)},So.prototype.setIndex=function(e){return this._module.setRuleIndex(this._id,e)},So.prototype.update=function(e){return this._module.updateRule(this._id,e)},So.prototype.getDefinition=function(){return this._module.getRuleDefinition(this._id)},So.prototype.destroy=function(){return this._module.destroyRule(this._id)},So.prototype.delete=function(){return this.destroy()},So);function So(e,t,n){var i=this;this._module=e,this._id=t,this._whenApplied=n.then(function(){return i})}var b_,n1=(wt(Or,b_=Fe),Or.prototype._get=function(e){for(var t=0;t<this._rules.length;++t){var n=this._rules[t];if(n.id===e)return n.index=t,n}throw new Error("calling a method on a destroyed style rule")},Or.prototype._updatePriorities=function(){for(var e=0;e<this._rules.length;++e)this._rules[e].attributeLayer.update({priority:3+.001*e})},Or.prototype.addRule=function(e){void 0===e&&(e={});var t=this._idCounter++,n=this._graphics.addAttributeLayer(Nt({name:"rule("+t+")"},Nc(e))),i=this._dom.afterNextFrame(),r=new t1(this,t,i);return this._rules.push({id:t,attributeLayer:n,wrapper:r}),this._updatePriorities(),r},Or.prototype.getRuleIndex=function(e){return this._get(e).index},Or.prototype.setRuleIndex=function(e,t){var n=this._get(e),i=ve(t,0,this._rules.length-1);return this._rules.splice(n.index,1),this._rules.splice(i,0,n),this._updatePriorities(),this._dom.afterNextFrame()},Or.prototype.updateRule=function(e,t){var n=this._get(e),i=Object.assign({fullOverwrite:t.fullOverwrite},Nc(t));return n.attributeLayer.update(i),this._dom.afterNextFrame()},Or.prototype.getRuleDefinition=function(e){return Nc(this._get(e).attributeLayer.getDefinition())},Or.prototype.destroyRule=function(e){var t=this._get(e);return t.attributeLayer.destroy(),this._rules.splice(t.index,1),this._dom.afterNextFrame()},Or.prototype.refreshRule=function(e){return this._get(e).attributeLayer.updateAll(),this._dom.afterNextFrame()},Or.prototype.refreshAllRules=function(){for(var e=0;e<this._rules.length;e++)this._rules[e].attributeLayer.updateAll();return this._dom.afterNextFrame()},Or.prototype.getRuleList=function(){return this._rules.map(function(e){return e.wrapper})},Or);function Or(e){var t=b_.call(this)||this;return t._idCounter=1,t._rules=[],t._graphics=e.graphics,t._dom=e.dom,t._rules=[],t}function Nc(e){return{nodeAttributes:e.nodeAttributes,edgeAttributes:e.edgeAttributes,nodeSelector:e.nodeSelector,edgeSelector:e.edgeSelector,nodeDependencies:e.nodeDependencies,edgeDependencies:e.edgeDependencies,nodeOutput:e.nodeOutput,edgeOutput:e.edgeOutput}}var E_,S_={strokeColor:"#00C3FF",fillColor:"rgba(0,195,255,0.1)",strokeWidth:1,cursorStyle:"cell",callback:function(e){return e.nodes.setSelected(!0)},bothExtremities:!1},A_=(wt(is,E_=Fe),is.prototype.enable=function(e){if(!this._enabled)return this._enabled=!0,this._captor.setDetectionEnabled(!1),this._options=ln(e,S_),this._graphics.addCanvas(this._canvas),$r(this._canvas,this._options.cursorStyle),this._captor.isLeftPressed()&&this._interaction.start(this._captor.getCursorPosition()),this},is.prototype.disable=function(){if(this._enabled)return this._enabled=!1,this._captor.setDetectionEnabled(!0),this._graphics.removeCanvas(this._canvas),this},is.prototype.enabled=function(){return this._enabled},is.prototype.savePoint=function(e,t,n){var i=Fn(),r=this._ctx,o=this._options,a=this._points;if(this._bbox.addPoint(e,t),r.clearRect(0,0,this._canvas.width,this._canvas.height),a.push({x:e,y:t}),n){var s=a[0];r.lineWidth=o.strokeWidth,r.lineJoin="bevel",r.strokeStyle=o.strokeColor,r.fillStyle=o.fillColor,r.beginPath(),r.moveTo(s.x*i,s.y*i);for(var l=1;l<a.length;++l){var u=a[l];r.lineTo(u.x*i,u.y*i)}r.stroke(),o.fillColor&&r.fill()}},is.prototype.filterByExtremities=function(e,t){var n=this._graph.getEdgeAttribute("source"),i=this._graph.getEdgeAttribute("target");return e.filter(function(r){var o=r._index,a=n.get(o),s=i.get(o);return t[a]&&t[s]})},is);function is(e){var t=e.locate,n=e.graphics,i=e.captor,r=e.graph,o=e.spatial,a=e.interactions,s=E_.call(this)||this;return s._enabled=!1,s._points=[],s._bbox=new Cr,s._onStart=function(l){var u=l.x,d=l.y;s._bbox.reset(),s.savePoint(u,d,!1)},s._onStop=function(){var l=s._bbox,p=s._spatial.queryProjected(l.minX,l.minY,l.maxX,l.maxY),m=p.edges,b={},v=p.nodes.filter(function(E){var S=E.isVisible(),w=E.getAttribute("detectable"),M=S&&w&&s._locate.isNodeInPolygon(E,s._points);return b[E._index]=M}),y=m.filter(function(E){var S=E.isVisible(),w=E.getAttribute("detectable");return S&&w&&s._locate.isEdgeInPolygon(E,s._points)});s._options.bothExtremities&&(y=s.filterByExtremities(y,b)),s._ctx.clearRect(0,0,s._canvas.width,s._canvas.height),s._points=[],s.disable(),s._options.callback({nodes:v,edges:y})},s._locate=t,s._graph=r,s._graphics=n,s._captor=i,s._interactions=a,s._spatial=o,s._options=un(S_),s._canvas=ci(),s._ctx=s._canvas.getContext("2d"),s._interaction=s._interactions.onDrag({priority:"lasso",check:function(){return s._enabled},onStart:s._onStart,onProgress:function(l){return s.savePoint(l.x,l.y,!0)},onStop:s._onStop}),s}var w_,C_={strokeColor:"#00C3FF",fillColor:"rgba(0,195,255,0.1)",strokeWidth:1,cursorStyle:"cell",callback:function(e){var t=e.nodes,n=e.edges;t.size?t.setSelected(!0):n.setSelected(!0)},bothExtremities:!1},i1=(wt(rs,w_=A_),rs.prototype.enable=function(e){this._enabled||(this._enabled=!0,this._options=ln(e,C_),this._graphics.addCanvas(this._canvas),$r(this._canvas,this._options.cursorStyle),this._captor.isLeftPressed()&&this._interaction.start(this._captor.getCursorPosition()))},rs.prototype.disable=function(){if(this._enabled)return this._enabled=!1,this._graphics.removeCanvas(this._canvas),this},rs.prototype.enabled=function(){return this._enabled},rs.prototype._formatRectangle=function(e){var t=this._start.x,n=this._start.y,i=e.x,r=e.y,o=Math.abs(t-i),a=Math.abs(n-r),s=t<i?t:i,l=n<r?n:r;return this._rectangle.reset().addPoint(s,l).addPoint(s+o,l+a)},rs.prototype._refreshRectangle=function(e){var t=this._formatRectangle(e),n=t.minX,i=t.minY,r=t.width,o=t.height,a=Fn();Za(this._canvas,this._ctx),this._ctx.strokeRect(n*a,i*a,r*a,o*a),this._options.fillColor&&this._ctx.fillRect(n*a,i*a,r*a,o*a)},rs);function rs(e){var t=w_.call(this,e)||this;return t._options=un(C_),t._canvas=ci(),t._ctx=t._canvas.getContext("2d"),t._enabled=!1,t._start=null,t._rectangle=new Cr,t._interaction=t._interactions.onDrag({priority:"lasso",disableDetection:!0,check:function(){return t._enabled},onStart:function(n){var i=n.x,r=n.y;t._rectangle.reset(),t._start={x:i,y:r},t._ctx.fillStyle=t._options.fillColor,t._ctx.strokeStyle=t._options.strokeColor,t._ctx.lineWidth=t._options.strokeWidth},onProgress:function(n){return t._refreshRectangle({x:n.x,y:n.y})},onStop:function(){var n=t._captor.getCursorPosition(),i=t._formatRectangle(n),r=t._spatial.queryProjected(i.minX,i.minY,i.maxX,i.maxY),a=r.edges,s={},l=r.nodes.filter(function(d){var c=d.isVisible(),h=d.getAttribute("detectable"),p=c&&h&&t._locate.isNodeInRectangle(d,i);return s[d._index]=p}),u=a.filter(function(d){var c=d.isVisible(),h=d.getAttribute("detectable");return c&&h&&t._locate.isEdgeInRectangle(d,i)});t._options.bothExtremities&&(u=t.filterByExtremities(u,s)),Za(t._canvas,t._ctx),t.disable(),t._options.callback({nodes:l,edges:u})}}),t}function Wl(e,t,n,i,r,o,a,s){void 0===r&&(r=0),void 0===o&&(o=Math.sin(r)),void 0===a&&(a=Math.cos(r)),void 0===s&&(s=[0,0,0,0]);var l,u,d,c,h,p,g,m,b=n/2,v=i/2,y=e+b,E=t+v;return 0===r?(s[0]=e,s[1]=t,s[2]=e+n,s[3]=t+i):(h=g=l=y+(d=-b)*a-(c=-v)*o,p=m=u=E+d*o+c*a,(l=y+(d=-b)*a-(c=v)*o)<h?h=l:g<l&&(g=l),(u=E+d*o+c*a)<p?p=u:m<u&&(m=u),(l=y+(d=b)*a-(c=v)*o)<h?h=l:g<l&&(g=l),(u=E+d*o+c*a)<p?p=u:m<u&&(m=u),(l=y+(d=b)*a-(c=-v)*o)<h?h=l:g<l&&(g=l),(u=E+d*o+c*a)<p?p=u:m<u&&(m=u),s[0]=h,s[1]=p,s[2]=g,s[3]=m),s}function zs(e,t,n,i,r){void 0===r&&(r=0);var o=n/2,a=i/2,s=e+o,l=t+a;if(0===r)return[{x:e,y:t},{x:e+n,y:t},{x:e+n,y:t+i},{x:e,y:t+i}];var u,d,c=Math.sin(r),h=Math.cos(r);return[{x:s+(u=-o)*h-(d=-a)*c,y:l+u*c+d*h},{x:s+(u=-o)*h-(d=a)*c,y:l+u*c+d*h},{x:s+(u=o)*h-(d=a)*c,y:l+u*c+d*h},{x:s+(u=o)*h-(d=-a)*c,y:l+u*c+d*h}]}function Lc(e,t,n,i){void 0===t&&(t=0),void 0===n&&(n=1),void 0===i&&(i=af.slice());var r=n*Math.sin(t),o=n*Math.cos(t);return i[0]=e[0]+r,i[1]=e[1]+o,i[2]=e[2]+r,i[3]=e[3]+o,i}function T_(e,t,n,i,r,o,a,s){return r<e&&e<a&&o<t&&t<s||r<n&&n<a&&o<i&&i<s}function Go(e,t,n,i,r,o,a,s){return o<=i&&t<=s&&r<=n&&e<=a}function os(e,t,n,i,r,o){return{minX:e,minY:t,maxX:n,maxY:i,leaf:!0,level:o,parent:r,objects:[],final:!1,children:null}}function M_(e){return[e.minX,e.minY,e.maxX,e.maxY]}function Fc(e,t,n,i,r,o,a,s){var l=(e+n)/2,u=(t+i)/2;return r<=l&&l<=a&&o<=u&&u<=s}function I_(e,t,n,i,r,o,a,s){var l=(o+s)/2,u=(t+i)/2;return(e+n)/2<=(r+a)/2?u<=l?0:1:u<=l?3:2}function u1(e){return e}var k_=(Object.defineProperty(si.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(si.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),si.prototype.clear=function(){return this._root=null,this._objects={},this._size=0,this._idToCell={},this._rootLevel=0,this._maxLevel=this._rootLevel+30,this},si.prototype.insert=function(e,t,n){if(void 0===n&&(n=this._root),t=t||this._getBBox(e),!this._objects[e]){if(this._objects[e]=!0,this._size++,!this._root){var i=Math.max(Math.abs(t[2]-t[0]),Math.abs(t[3]-t[1]));return this._root=os(t[0],t[1],t[0]+i,t[1]+i,null,this._rootLevel),this._root.objects.push(e),e}for(var r,o=[n],a=!1,s=this._nodeCapacity,l=this._idToCell,u=this._maxLevel;r=o.pop();){var d=r.minX,c=r.minY,h=r.maxX,p=r.maxY;Go(t[0],t[1],t[2],t[3],d,c,h,p)&&(r.leaf?r.objects.length<s||r.final?(r.objects.push(e),l[e]?l[e].push(r):l[e]=[r],a=!0,(r.level>=u||Math.abs(h-d)<=Math.abs(t[2]-t[0])||Math.abs(p-c)<=Math.abs(t[3]-t[1]))&&(r.final=!0)):(this.splitNode(r),o.push(r)):o.push.apply(o,r.children))}if(a)return e;if(!Fc(t[0],t[1],t[2],t[3],(n=this._root).minX,n.minY,n.maxX,n.maxY)){for(var g=this._rootLevel,m=(t[0]+t[2])/2,b=(t[1]+t[3])/2;!Fc(t[0],t[1],t[2],t[3],this._root.minX,this._root.minY,this._root.maxX,this._root.maxY);){var v=d=(n=this._root).minX,y=c=n.minY,E=h=n.maxX,S=p=n.maxY,w=Math.abs(h-d),M=Math.abs(p-c);if(0===M&&0===w)break;var O=Math.max(w,M);m<=d&&(v-=O),b<=c&&(y-=O),d<m&&(E+=O),c<b&&(S+=O);var F=os(v,y,E,S,null,--g);this.splitNode(F),F.children[I_(d,c,h,p,v,y,E,S)]=n,this._root=n.parent=F}for(o=[this._root],this._root.level=this._rootLevel;r=o.shift();)if(!r.leaf)for(var L=0;L<4;L++){var N=r.children[L];N.level=r.level+1,o.push(N)}}return(r=(n=this._root).children[I_(t[0],t[1],t[2],t[3],n.minX,n.minY,n.maxX,n.maxY)]).leaf&&(r.objects.push(e),l[e]?l[e].push(r):l[e]=[r]),e}},si.prototype.removeById=function(e){if(!this._objects[e])return e;this._size--;for(var t=this._idToCell[e],n=0;n<t.length;n++)for(var i=t[n].objects,r=0,o=i.length;r<o;r++)if(i[r]===e){i.splice(r,1);break}return delete this._objects[e],delete this._idToCell[e],e},si.prototype.remove=function(e){for(var t,n,i,r=this._getBBox(e),o=r[0],a=r[1],s=r[2],l=r[3],u=[this._root];t=u.pop();)if(Go(o,a,s,l,t.minX,t.minY,t.maxX,t.maxY))if(t.leaf){for(var d=t.objects,c=0,h=d.length;c<h;c++)if(d[c]===e){d.splice(c,1),1===h&&(i=i||[]).push(t);break}}else u.push.apply(u,t.children);if(delete this._idToCell[e],delete this._objects[e],this._size--,i)for(;n=i.pop();)for(var p=n.parent,g=!0;p&&g;){if(!p.leaf){for(c=0;c<4;c++)if(!(t=p.children[c]).leaf||0!==t.objects.length){g=!1;break}g&&(p.leaf=!0,p.children=null,p.objects=[])}p=p.parent}return e},si.prototype.splitNode=function(e){var t=e.minX,n=e.minY,i=e.maxX,r=e.maxY,o=(t+i)/2,a=(n+r)/2,s=e.level+1,l=this._idToCell,u=this._maxLevel,d=[os(t,n,o,a,e,s),os(t,a,o,r,e,s),os(o,a,i,r,e,s),os(o,n,i,a,e,s)];if(null!==e.objects)for(var c=e.objects,h=this._getBBox,p=0,g=c.length;p<g;p++){for(var m=c[p],b=h(m),v=l[m],y=0;y<4;y++){var E=d[y],S=E.minX,w=E.minY,M=E.maxX,O=E.maxY;Go(b[0],b[1],b[2],b[3],S,w,M,O)&&(E.objects.push(m),(E.level>=u||Math.abs(M-S)<=Math.abs(b[2]-b[0])||Math.abs(O-w)<=Math.abs(b[3]-b[1]))&&(E.final=!0),v?v.push(E):v=[E])}v.splice(v.indexOf(e),1)}e.children=d,e.objects=null,e.leaf=!1},si.prototype.point=function(e,t,n){for(var i,r,o,a=[],s=[this._root],l=this._getBBox;i=s.pop();)if(e>=i.minX&&e<=i.maxX&&t>=i.minY&&t<=i.maxY){if(i.leaf){n&&(a=i.objects);for(var u=i.objects,d=0,c=u.length;d<c;d++)e>=(r=l(o=u[d]))[0]&&e<=r[2]&&t>=r[1]&&t<=r[3]&&a.push(o);break}s.push.apply(s,i.children)}return a},si.prototype.neigbours=function(e,t){for(var n,i=[],r=[this._root];n=r.pop();)if(e>=n.minX&&e<=n.maxX&&t>=n.minY&&t<=n.maxY){if(n.leaf){i=n.objects;break}r.push.apply(r,n.children)}return i},si.prototype.query=function(e,t,n,i){for(var r,o,a,s=[],l=[this._root],u=this._getBBox,d={};r=l.pop();)if(Go(e,t,n,i,r.minX,r.minY,r.maxX,r.maxY))if(r.leaf)for(var c=r.objects,h=0,p=c.length;h<p;h++)d[a=c[h]]||(Go(e,t,n,i,(o=u(a))[0],o[1],o[2],o[3])&&s.push(a),d[a]=!0);else l.push.apply(l,r.children);return s},si.prototype.getOverlaps=function(){for(var e,t,n,i=[this._root],r=[],o=this._getBBox,a={};e=i.pop();)if(e.leaf){for(var s=e.objects,l=s.length,u=0;u<l;u++)for(var d=0;d<l;d++)if(t=s[u],n=s[d],u!==d&&!a[t+":"+n]&&!a[n+":"+t]){a[t+":"+n]=!0;var c=o(t),h=o(n);Go(c[0],c[1],c[2],c[3],h[0],h[1],h[2],h[3])&&r.push(t,n)}}else i.push.apply(i,e.children);return r},si.prototype.getAll=function(){return Object.keys(this._objects).map(function(e){return Number(e)})},si.prototype.forEach=function(e,t){for(var n,i=[this._root];n=i.pop();)if(n.leaf)for(var r=0,o=n.objects.length;r<o;r++)e.call(t,n.objects[r]);else i.push.apply(i,n.children);return this},si.prototype.getLeafs=function(){for(var e,t=[this._root],n=[];e=t.pop();)e.leaf?n.push(e):t.push.apply(t,e.children);return n},si.prototype.traverse=function(e,t){for(var n,i=[this._root];n=i.pop();)e.call(t,n,n.objects)||n.leaf||i.push.apply(i,n.children);return this},si.prototype.update=function(e){return this.remove(e),this.insert(e,this._getBBox(e)),this},si.prototype.getNodeBounds=function(e){return M_(e)},si.flatAccessor=function(e,t){return function(n){var i=t*n;return e.slice(i,i+t)}},si.inside=Fc,si.intersects=T_,si.overlaps=Go,si.getNodeBBox=M_,si);function si(e,t,n,i){void 0===e&&(e=u1),void 0===t&&(t=10),void 0===i&&(i=0),this._nodeCapacity=10,this._root=null,this._objects={},this._size=0,this._rootLevel=0,this._maxLevel=30,this._idToCell={},this._nodeCapacity=t,this._root=null,this._getBBox=e,this._rootLevel=i,this._maxLevel=i+30,this._idToCell={},n&&(this._root=os(n[0],n[1],n[2],n[3],null,i))}var l1={left:-1,right:1,top:0,bottom:0,center:0},d1={left:0,right:0,top:-1,bottom:1,center:0},c1={left:-1,right:0,top:-.5,bottom:-.5,center:-.5},h1={left:-.5,right:-.5,top:-1,bottom:0,center:-.5},ku={x1:0,y1:0,x2:0,y2:0},Pc={x:0,y:0},Bs={x:0,y:0},p1=Math.PI/2;function Dc(e,t,n,i){void 0===i&&(i="#ff0000"),t.strokeStyle=i,t.lineWidth=1,t.beginPath();for(var r=Fn(),o=0,a=e.length;o<a;o++){var s=n.graphToScreenCoordinates(e[o]);0===o?t.moveTo(s.x*r,s.y*r):t.lineTo(s.x*r,s.y*r)}t.closePath(),t.stroke()}var O_,g1=["x","y","radius","width","text.content","text.minVisibleSize","text.size","text.scale","text.scaling","text.padding","text.margin","text.position","text.style"],_1=(wt(xr,O_=Fe),xr.prototype.getTextsBoundingBox=function(){this._updateLabels();for(var e=this._rects,t=this._textBBoxes,n=new Cr,i=this._graphics.getNodeAttributes(),r=this._graphics.getEdgeAttributes(),o=i.excluded,a=r.excluded,s=0;s<e.length;s++){var l=5*s,d=t[6*s+4];if(!(1===t[6*s+4]?o.get(d):a.get(d))){var c=Wl(e[l],e[1+l],e[2+l],e[3+l],e[4+l]),g=c[2],m=c[3];n.addPoint(c[0],c[1]).addPoint(g,m)}}return n},xr.prototype.setRate=function(e){var t=this;this._updateDebounced=this._sync.debounceIdle(function(n){return t._updateLabels(n)},e)},xr.prototype.forceEnable=function(){this._forceEnabled=!0},xr.prototype.update=function(){this._update()},xr.prototype.forceUpdate=function(){this._updateLabels()},xr.prototype._enable=function(){this._enabled=!0,this._update()},xr.prototype._disable=function(){this._textBBoxes=[],this._rects=[],this._intersects=[],this._enabled=!1},xr.prototype._onCameraMove=function(){this._update()},xr.prototype._updateLabels=function(e){if(void 0===e&&(e=this._camera.getZoom()),this._settings.get("texts.preventOverlap")){var t=this._graphics.getNodeAttributes(),n=this._graphics.getEdgeAttributes();this._intersects=[],this._textBBoxes=[],this._rects=[];var i=this._textQuad.clear(),r=this._camera.getAngle(),o=this._camera.getProjectedScreenBounds(.25),a="bottomUp"===this._settings.get("texts.removalStrategy"),s={angle:r,zoom:e,screen:o,sin:Math.sin(r),cos:Math.cos(r)},l={remove:{nodes:[],edges:[]},redraw:{nodes:[],edges:[]},rects:this._rects,bboxes:this._textBBoxes,intersects:this._intersects},u=this._spatial.queryRaw(o[0],o[1],o[2],o[3]),d=u.nodes,c=u.edges;d.length+c.length!==0&&(function(h,p,g,m,b,v,y){var E,S,w=y.remove.nodes,M=y.remove.edges,O=y.redraw.nodes,F=g.angle,L=g.zoom,N=g.sin,B=g.cos,X=m.x,J=m.y,ae=m.radius,U=m.innerStroke.width,Y=m.outerStroke.width,he=m.scalingMethod,pe=m.text.content,we=m.text.position,ke=m.text.size,at=m.text.font,st=m.text.style,Xe=m.text.maxLineLength,xt=m.text.scaling,It=m.text.scale,Ge=m.text.minVisibleSize,He=m.text.padding,Pe=m.text.margin,We=m.animationDuration,Qe=m.textHidden,nt=m.excluded;pr(h,m.layer);for(var Me=[0,0,0,0],ze=[0,0,0,0,0],qe=y.bboxes,Ke=y.rects,ht=y.intersects,Wt=0,$t=h.length;Wt<$t;Wt++){var dn=We.get(E=h[Wt]),sn=pe.get(E);if(null!==sn&&""!==sn&&0===dn){var pn=ae.get(E),W=Ge.get(E);if(1!==nt.get(E))if(2*pn*L<W)0===Qe.get(E)&&w.push(E);else{"fixed"===he.get(E)&&(pn/=L);var Z=X.get(E),z=J.get(E);"number"==typeof sn&&(sn=sn.toString());var K=!xt.get(E),ce=we.get(E),me=He.get(E),Se=It.get(E),be=1*(K?ke.get(E):Se*pn),Ie=st.get(E),De=at.get(E),Ve=Rp(sn,Xe.get(E)).lines,Re=me+U.get(E)+Y.get(E)+Pe.get(E),Be=l1[ce],Oe=d1[ce],Le=b(sn,De,Ie,be).width/Ve,Ce=Ve*be*1,et=Le/2/L,lt=Ce/2/L,je=Re/L,Ze=c1[ce]*Le,Ue=h1[ce]*Ce;K&&(Ze/=L,Ue/=L),Ze=Ze+Be*je+et+Be*pn,Ue=Ue+Oe*je+lt+Oe*pn,Wl(Z-et,z-lt,Le/L,Ce/L,-F,N,-B,Me),ze[0]=Z-et,ze[1]=z-lt,ze[2]=Le/L,ze[3]=Ce/L,ze[4]=F;var tt=B*Ze-N*Ue,Je=N*Ze+B*Ue;Me[0]+=tt,Me[1]+=Je,Me[2]+=tt,Me[3]+=Je,ze[0]+=tt,ze[1]+=Je;var ot=p.query(Me[0],Me[1],Me[2],Me[3]);if(0!==ot.length){for(var St=!1,At=zs(ze[0],ze[1],ze[2],ze[3],ze[4]),Ot=0;Ot<ot.length;Ot++){var bt=ot[Ot],Mt=5*bt,it=zs(Ke[Mt],Ke[1+Mt],Ke[2+Mt],Ke[3+Mt],Ke[4+Mt]);if(fc(At,it)){if(ht.push(At,it),St=!0,!v)break;p.remove(bt),1===qe[6*bt+4]?w.push(qe[6*bt+5]):M.push(qe[6*bt+5])}}if(St&&!v){w.push(E);continue}}O.push(E),S=qe.length/6,qe.push(Me[0],Me[1],Me[2],Me[3],1,E),p.insert(S,Me),Ke.push(ze[0],ze[1],ze[2],ze[3],ze[4])}else w.push(E)}}}(d,i,s,t,this._measureText,a,l),function(h,p,g,m,b,v,y,E){var S,w,M=E.remove.nodes,O=E.remove.edges,F=E.redraw.edges,L=g.angle,N=g.zoom,B=b.x,X=b.y,J=b.radius,ae=Math.PI,ie=m.source,U=m.target,Y=m.scalingMethod,he=m.width,pe=m.curvature,ke=m.text.content,at=m.text.scaling,st=m.text.size,Xe=m.text.font,xt=m.text.style,It=m.text.scale,Ge=m.text.maxLineLength,He=m.text.margin,Pe=m.text.minVisibleSize,We=m.animationDuration;pr(h,m.layer);for(var Qe=[0,0,0,0],nt=[0,0,0,0,0],Me=E.bboxes,ze=E.rects,qe=E.intersects,Ke=0,ht=h.length;Ke<ht;Ke++){var Wt=We.get(S=h[Ke]),$t=ke.get(S);if(null!==$t&&""!==$t&&!Wt){var dn=ie.get(S),sn=U.get(S),pn=he.get(S),W=pe.get(S);if(!(pn*N<Pe.get(S))){"fixed"===Y.get(S)&&(pn/=N);var Z=(B.get(dn)+B.get(sn))/2,z=(X.get(dn)+X.get(sn))/2;$t=$t.toString();var K=!at.get(S),ce=It.get(S),me=Xe.get(S),Se=1*(K?st.get(S):ce*pn),be=xt.get(S),Ie=Ge.get(S),De=He.get(S),Ve=B.get(dn),Re=X.get(dn),Be=B.get(sn),Oe=X.get(sn),Le=void 0,Ce=dn===sn;if(Ce)Le=ae/4-L,Ya(Ve,Re,W,J.get(dn),0,ku),vu(.5,Ve,Re,Be,Oe,ku.x1,ku.y1,ku.x2,ku.y2,Bs),Z=Bs.x,z=Bs.y,De/=-N;else{if(Ve===Be&&Re===Oe)continue;Le=Ms(Ve,Re,Be,Oe)-L,0!==W&&(Le=Ms(Ve,Re,Be,Oe)-L,pa(Ve,Re,Be,Oe,W,Pc),Qd(.5,Ve,Re,Be,Oe,Pc.x,Pc.y,Bs),Z=Bs.x,z=Bs.y)}var et=De+4,lt=Rp($t,Ie).lines,je=lt*Se,Ze=1*v($t,me,be,Se).width/lt/N/2,Ue=je/N/2,tt=Math.abs(Le)<p1?1:-1,Je=Ce?je/N+pn/2:tt*(et/N+pn/2+Ue);nt[0]=Z-Ze,nt[1]=z-Ue,nt[2]=Z+Ze,nt[3]=z+Ue,nt[4]=Le+L,Lc(nt,-(Le+L),-Je,nt),nt[2]=nt[2]-nt[0],nt[3]=nt[3]-nt[1],Wl(Z-Ze,z-Ue,2*Ze,2*Ue,Le=ae-Le-L,void 0,void 0,Qe),Lc(Qe,Le,Je,Qe);var ot=p.query(Qe[0],Qe[1],Qe[2],Qe[3]);if(ot.length){for(var St=!1,At=zs(nt[0],nt[1],nt[2],nt[3],nt[4]),Ot=0;Ot<ot.length;Ot++){var bt=ot[Ot],Mt=5*bt,it=zs(ze[Mt],ze[1+Mt],ze[2+Mt],ze[3+Mt],ze[4+Mt]);if(fc(At,it)){if(St=!0,qe.push(At,it),!y)break;p.remove(bt),1===Me[6*bt+4]?M.push(Me[6*bt+5]):O.push(Me[6*bt+5])}}if(St&&!y){O.push(S);continue}}F.push(S),w=Me.length/6,Me.push(Qe[0],Qe[1],Qe[2],Qe[3],0,S),p.insert(w,Qe),ze.push(nt[0],nt[1],nt[2],nt[3],nt[4])}}}}(c,i,s,n,t,this._measureText,a,l),this._clearOverlaps(l),this._settings.get("texts.debug")&&this.drawAll())}},xr.prototype._clearOverlaps=function(e){var t=this._graph.nodeList,n=this._graph.edgeList,i=t(new Uint32Array(e.remove.nodes)),r=n(new Uint32Array(e.remove.edges)),o=t(new Uint32Array(e.redraw.nodes)),a=n(new Uint32Array(e.redraw.edges));this._graphics.setTextHidden(i,!0),this._graphics.setTextHidden(r,!0),this._graphics.setTextHidden(o,!1),this._graphics.setTextHidden(a,!1),this._events.fire("labelCollisionsRemoved",e)},xr.prototype._reset=function(){this._graphics.resetTextHidden()},xr.prototype.drawAll=function(){!function(e,t,n,i,r,o){e.clearRect(0,0,t.width,t.height);for(var a=0,s=i.length;a<s;a+=6)l=i.slice(a,a+4),u=e,d=n,void 0===(c="#aaaaaa")&&(c="#22ff00"),Dc([[l[0],l[1]],[l[2],l[1]],[l[2],l[3]],[l[0],l[3]]].map(function(h){return{x:h[0],y:h[1]}}),u,d,c);var l,u,d,c;for(a=0;a<r.length;a+=5)Dc(zs(r[a],r[a+1],r[a+2],r[a+3],r[a+4]),e,n,"green");o.forEach(function(h){return Dc(h,e,n,"red")})}(this._ctx,this._canvas,this._camera,this._textBBoxes,this._rects,this._intersects)},xr);function xr(e,t){var n,i=e.graph,r=e.graphics,o=e.camera,a=e.events,s=e.settings,l=e.sync,u=e.spatial,d=O_.call(this)||this;return d._textBBoxes=[],d._rects=[],d._enabled=!1,d._intersects=[],d._onZoomStart=Pa(function(c){var p=c.endZoom;d._enabled&&p<c.startZoom&&d._updateLabels(p)},80),d._onAttributesChanged=function(c){c.edgeAttributes.concat(c.nodeAttributes).some(function(h){return g1.includes(h)})&&d._update()},d._onItemsAdded=function(c){var h=c.nodes||c.edges;(d._enabled||d._forceEnabled)&&d._settings.get("texts.preventOverlap")&&d._graphics.setTextHidden(h,!0)},d._onToggle=function(c){return c?d._update():d._reset(),d},d._update=function(){(d._enabled||d._forceEnabled)&&d._updateDebounced()},d._toggleDebug=function(c){c?(d._canvas=ci(),d._graphics.addCanvas(d._canvas),d._ctx=d._canvas.getContext("2d"),d._update()):d._canvas&&(d._graphics.removeCanvas(d._canvas),d._canvas=d._ctx=null)},d._measureText=function(c,h,p,g){return d._engine.measureText(c,h,p,g)},d._graph=i,d._graphics=r,d._camera=o,d._events=a,d._settings=s,d._sync=l,d._spatial=u,d._engine=r.getGraphicsEngine(),d._textQuad=new k_(function(c){var h=6*c;return d._textBBoxes.slice(h,6+h)},5),t.forceEnableTextOverlapRemoval&&d.forceEnable(),d._events.register(["labelCollisionsRemoved"]),d.setRate(200),s.register("texts.preventOverlap",!0,d._onToggle),s.register("texts.debug",!1,d._toggleDebug),s.register("texts.removalStrategy","topDown"),d._events.on(((n={})[I.ADD_NODES+" "+I.ADD_EDGES]=d._onItemsAdded,n[I.LAYOUT_END]=function(){return d._updateLabels()},n[I.VIEW_CHANGED]=d._update,n[I.UPDATE_ATTRIBUTES]=d._onAttributesChanged,n[I.SET_CONTAINER]=function(c){if(c.element)return d._enable();d._disable()},n[I.START_ZOOM]=d._onZoomStart,n)),d}function Yl(){}function N_(){return!1}var as,L_,m1=(Di.prototype._startInteraction=function(e,t){e.onStart(t),e.onStop&&(this._current=e).disableDetection&&this._captor.setDetectionEnabled(!1)},Di.prototype._stopCurrentInteraction=function(e){this._current.disableDetection&&this._captor.setDetectionEnabled(!0),this._current.onStop(e),this._current=null},Di.prototype._forceStartInteraction=function(e,t){this._current&&this._stopCurrentInteraction(t),this._startInteraction(e,t)},Di.prototype._createWrapper=function(e){var t=this;return{start:function(n){return t._forceStartInteraction(e,n)}}},Di.prototype._addInteraction=function(e,t){var n=this._interactionsByStartEvent[e];return n?n.push(t):(this._interactionsByStartEvent[e]=[t],this._events.on(e,this._onStartInteractionEvent)),this._createWrapper(t)},Di.prototype._createProgressiveInteraction=function(e,t,n,i){var r={priority:F_(i.priority),check:i.check||N_,onStart:i.onStart||Yl,onProgress:i.onProgress||Yl,onStop:i.onStop||Yl,disableDetection:!!i.disableDetection,progressEventName:t,stopEventName:n};return this._boundProgressEvents[t]||(this._boundProgressEvents[t]=!0,this._events.on(t,this._onProgressInteractionEvent)),this._boundStopEvents[n]||(this._boundStopEvents[n]=!0,this._events.on(n,this._onStopInteractionEvent)),this._addInteraction(e,r)},Di.prototype._createNonProgressiveInteraction=function(e,t){return this._addInteraction(e,{priority:F_(t.priority),check:t.check||N_,onStart:t.handler||Yl,onProgress:null,onStop:null,disableDetection:!1,progressEventName:null,stopEventName:null})},Di.prototype.onDrag=function(e){return this._createProgressiveInteraction(I.DRAG_START,I.DRAG_PROGRESS,I.DRAG_END,e)},Di.prototype.onGesture=function(e){return this._createProgressiveInteraction(I.GESTURE_START,I.GESTURE_PROGRESS,I.GESTURE_END,e)},Di.prototype.onClick=function(e){return this._createNonProgressiveInteraction(I.CLICK,e)},Di.prototype.onDoubleClick=function(e){return this._createNonProgressiveInteraction(I.DOUBLE_CLICK,e)},Di.prototype.onHover=function(e){return this._createNonProgressiveInteraction(I.HOVER,e)},Di.prototype.onUnhover=function(e){return this._createNonProgressiveInteraction(I.UNHOVER,e)},Di.prototype.onMouseWheel=function(e){return this._createNonProgressiveInteraction(I.WHEEL,e)},Di.prototype.onMouseDown=function(e){return this._createNonProgressiveInteraction(I.DOWN,e)},Di.prototype.onMouseUp=function(e){return this._createNonProgressiveInteraction(I.UP,e)},Di.prototype.onMouseMove=function(e){return this._createNonProgressiveInteraction(I.MOVE,e)},Di);function Di(e){var t=e.captor,n=e.events,i=this;this._current=null,this._onStartInteractionEvent=function(r,o){if(!i._current){for(var a=null,s=0,l=i._interactionsByStartEvent[o];s<l.length;s++){var u=l[s];u.check(r)&&(!a||u.priority>=a.priority)&&(a=u)}a&&i._startInteraction(a,r)}},this._onProgressInteractionEvent=function(r,o){i._current&&i._current.progressEventName===o&&i._current.onProgress(r)},this._onStopInteractionEvent=function(r,o){i._current&&i._current.stopEventName===o&&i._stopCurrentInteraction(null)},this._captor=t,this._events=n,this._interactionsByStartEvent={},this._boundProgressEvents={},this._boundStopEvents={}}function F_(e){return"string"==typeof e?cx.indexOf(e):"number"!=typeof e||isNaN(e)?0:e}(L_=as=as||{}).MOUSE="mouse",L_.TOUCH="touch";var P_,v1=[I.VIRTUAL_UP,I.MOUSE_UP,I.TOUCH_UP].join(" "),y1=[I.VIRTUAL_DOWN,I.MOUSE_DOWN,I.TOUCH_DOWN].join(" "),x1=[I.VIRTUAL_MOVE,I.MOUSE_MOVE,I.TOUCH_MOVE].join(" "),b1=[I.VIRTUAL_CLICK,I.MOUSE_CLICK,I.TOUCH_TAP].join(" "),E1=[I.VIRTUAL_DOUBLE_CLICK,I.MOUSE_DOUBLE_CLICK,I.TOUCH_DOUBLE_TAP].join(" "),S1=[I.VIRTUAL_WHEEL,I.MOUSE_WHEEL].join(" "),A1=(wt(Nn,P_=Fe),Nn.prototype.triggerUnhover=function(){this._hover=!1,this._hoveredElt=null},Nn.prototype.triggerDetection=function(){this._detectElement(this._position.x,this._position.y),this._elt&&(this._hoveredElt=this._elt,this._hover=!0)},Nn.prototype.getElementAt=function(e,t){return this._detectElementAt(e.x,e.y,t)},Nn.prototype.getPointedElement=function(){return this._hoveredElt},Nn.prototype.getDraggedElement=function(){return this._draggedElt},Nn.prototype.isAnyButtonPressed=function(){return this._buttons[Kt.LEFT].isPressed||this._buttons[Kt.RIGHT].isPressed||this._buttons[Kt.MIDDLE].isPressed},Nn.prototype.isAnyButtonDragging=function(){return this._buttons[Kt.LEFT].isDragging||this._buttons[Kt.RIGHT].isDragging||this._buttons[Kt.MIDDLE].isDragging},Nn.prototype.isButtonPressed=function(e){return this._buttons[e].isPressed},Nn.prototype.isLeftPressed=function(){return this.isButtonPressed(Kt.LEFT)},Nn.prototype.getCursorPosition=function(){return{x:this._position.x,y:this._position.y}},Nn.prototype.getCursorInformation=function(){return{x:this._position.x,y:this._position.y,target:this._hoveredElt}},Nn.prototype.setDetectionEnabled=function(e){this._disabledCounter=Math.max(0,this._disabledCounter+(e?-1:1))},Nn.prototype._resetCurrent=function(e,t){for(var n in this._buttons){var i=this._buttons[n];i.isDragging&&this._events.fire(I.DRAG_END,{domEvent:null,x:e,y:t,button:n,target:this._draggedElt}),i.isPressed=!1,i.isDragging=!1}this._hover&&this._hoveredElt&&this._events.fire(I.UNHOVER,{domEvent:null,x:e,y:t,target:this._hoveredElt}),this._hover=!1,this._hoveredElt=null,this._draggedElt=null},Nn.prototype._onMove=function(e){var t=e.domEvent,n=e.x,i=e.y,r=e.source,o=this._setPointerPosition(n,i),a=o.dx,s=o.dy;for(var l in this._events.fire(I.MOVE,{domEvent:t,x:n,y:i,dx:a,dy:s,source:r}),this._buttons){var u=this._buttons[l];if(u.isPressed)if(u.isDragging){var d=this._getStoredDXY();this._events.fire(I.DRAG_PROGRESS,{domEvent:t,x:n,y:i,dx:a+=d.dx,dy:s+=d.dy,button:l,source:r,target:this._draggedElt})}else u.isDragging=!0,this._hoveredElt&&this._hover&&(this._events.fire(I.UNHOVER,{domEvent:t,x:n,y:i,source:r,target:this._hoveredElt}),this._hover=!1),this._draggedElt||(this._draggedElt=this._hoveredElt),this._storeDXY(a,s),this._events.fire(I.DRAG_START,{domEvent:t,x:n,y:i,button:l,source:r,target:this._draggedElt})}t&&!this._graphics.getDomElement().contains(t.target)||this._detectElement(n,i),this._elt!==this._hoveredElt&&(this._hoveredElt&&this._hover&&(this._hover=!0,this._events.fire(I.UNHOVER,{domEvent:t,x:n,y:i,source:r,target:this._hoveredElt})),this._hoveredElt=this._elt,this._elt&&(this._hover=!0,this._events.fire(I.HOVER,{domEvent:t,x:n,y:i,source:r,target:this._hoveredElt})))},Nn.prototype._onDocumentMove=function(e){var t=e.domEvent,n=e.x,i=e.y,r=e.source;for(var o in this._buttons)if(this._buttons[o].isDragging){var a=this._setPointerPosition(n,i);this._events.fire(I.DRAG_PROGRESS,{domEvent:t,x:n,y:i,dx:a.dx,dy:a.dy,button:o,source:r,target:this._draggedElt})}},Nn.prototype._onDocumentUp=function(e){var o=e.button;if(this._buttons[o].isDragging){this._events.fire(I.DRAG_END,{domEvent:e.domEvent,x:e.x,y:e.y,button:o,source:e.source,target:this._draggedElt});var a=this._buttons[o];a.isDragging=!1,a.isPressed=!1,this.isAnyButtonDragging()||(this._draggedElt=null)}},Nn.prototype._onDown=function(e){var t=e.domEvent,n=e.x,i=e.y,r=e.button,o=e.source;this._detectElement(n,i),this._elt!==this._hoveredElt&&this._resetCurrent(n,i);var a=this._buttons[r];this._hoveredElt=this._elt,a.isPressed=!0,this._events.fire(I.DOWN,{domEvent:t,x:n,y:i,button:r,source:o,target:this._hoveredElt})},Nn.prototype._onDoubleClick=function(e){var t=e.domEvent,n=e.x,i=e.y,r=e.button,o=e.source;R_(t,"doubleclick")||this._events.fire(I.DOUBLE_CLICK,{domEvent:t,x:n,y:i,button:r,source:o,target:this._hoveredElt})},Nn.prototype._onUp=function(e){var t=e.domEvent,n=e.x,i=e.y,r=e.button,o=e.source,a=this._buttons[r];a.isPressed&&(a.isDragging&&(this._events.fire(I.DRAG_END,{domEvent:t,x:n,y:i,button:r,source:o,target:this._draggedElt}),a.isDragging=!1,this.isAnyButtonDragging()||(this._draggedElt=null)),a.isPressed=!1,this._detectElement(n,i),this._events.fire(I.UP,{domEvent:t,x:n,y:i,button:r,source:o,target:this._elt}),this.isAnyButtonPressed()||this._hover||o===as.TOUCH||(this._hoveredElt=this._elt,this._hoveredElt&&(this._events.fire(I.HOVER,{domEvent:t,x:n,y:i,source:o,target:this._hoveredElt}),this._hover=!0)))},Nn.prototype._onClick=function(e){var t=e.domEvent,n=e.x,i=e.y,r=e.button,o=e.source;R_(t,"click")||this._events.fire(I.CLICK,{domEvent:t,x:n,y:i,button:r,source:o,target:this._hoveredElt})},Nn.prototype._onWheel=function(e){var t=e.domEvent,n=e.x,i=e.y,r=e.delta,o=e.source;this._position.x=n,this._position.y=i,this._events.fire(I.WHEEL,{domEvent:t,x:n,y:i,delta:r,source:o,target:this._hoveredElt})},Nn.prototype._storeDXY=function(e,t){this._accDx=e,this._accDy=t},Nn.prototype._getStoredDXY=function(){var e=this._accDx,t=this._accDy;return this._accDx=0,this._accDy=0,{dx:e,dy:t}},Nn.prototype._setPointerPosition=function(e,t){var n=e-this._prevX,i=t-this._prevY;return this._position.x=e,this._position.y=t,this._prevX=e,this._prevY=t,this._accDx=0,this._accDy=0,{dx:n,dy:i}},Nn.prototype._detectElement=function(e,t,n){this._elt=this._detectElementAt(e,t,n)},Nn.prototype._detectElementAt=function(e,t,n){if(0!==this._disabledCounter)return null;var i,r,o=this._settings,a=o.get("detect.enableSpatialIndex"),s=o.get("detect.nodeErrorMargin"),l=o.get("detect.edgeErrorMargin"),u=o.get("detect.nodes"),d=o.get("detect.edges"),c=null;if(!n&&a&&(u||d)){var h=o.get("detect.spatialIndexMarginRatio"),p=Math.max(s*h,l*h),g=this._spatial.queryRawProjected(e-p,t-p,e+p,t+p);i=g.nodes,r=g.edges}return u&&(c=this._graphics.detectNode({x:e,y:t,indexes:i,margin:s,texts:o.get("detect.nodeTexts")})),!c&&d&&(c=this._graphics.detectEdge({x:e,y:t,indexes:r,margin:l,texts:o.get("detect.edgeTexts")})),c},Nn);function Nn(e){var t,n,i=e.dom,r=e.events,o=e.graphics,a=e.spatial,s=e.settings,l=e.position,u=P_.call(this)||this;return u._elt=null,u._hoveredElt=null,u._draggedElt=null,u._hover=!1,u._disabledCounter=0,u._accDx=0,u._accDy=0,u._timeout=null,u._prevX=0,u._prevY=0,u._buttons=((t={})[Kt.LEFT]={isPressed:!1,isDragging:!1},t[Kt.MIDDLE]={isPressed:!1,isDragging:!1},t[Kt.RIGHT]={isPressed:!1,isDragging:!1},t),u._onGraphChanged=function(){u._resetCurrent(u._position.x,u._position.y),u._timeout||(u._timeout=u._dom.setTimeout(function(){u._onMove({x:u._position.x,y:u._position.y,source:null,domEvent:null}),u._timeout=null},0))},u._dom=i,u._graphics=o,u._events=r,u._settings=s,u._spatial=a,u._position=l,r.register([I.MOVE,I.DOWN,I.UP,I.CLICK,I.DOUBLE_CLICK,I.HOVER,I.UNHOVER,I.WHEEL,I.DRAG_START,I.DRAG_PROGRESS,I.DRAG_END,I.GESTURE_START,I.GESTURE_PROGRESS,I.GESTURE_END]),s.register("detect.nodes",!0).register("detect.edges",!0).register("detect.nodeTexts",!0).register("detect.edgeTexts",!0).register("detect.nodeErrorMargin",5).register("detect.edgeErrorMargin",7).register("detect.enableSpatialIndex",!0).register("detect.spatialIndexMarginRatio",3),r.on(((n={})[[I.REMOVE_NODES,I.REMOVE_EDGES,I.CLEAR_GRAPH].join(" ")]=u._onGraphChanged,n[x1]=function(d,c){u._onMove({domEvent:d.domEvent,x:d.x,y:d.y,source:ss(c)})},n[y1]=function(d,c){var m=d.button;u._onDown({domEvent:d.domEvent,x:d.x,y:d.y,button:void 0===m?Kt.LEFT:m,source:ss(c)})},n[v1]=function(d,c){var m=d.button;u._onUp({domEvent:d.domEvent,x:d.x,y:d.y,button:void 0===m?Kt.LEFT:m,source:ss(c)})},n[b1]=function(d,c){var m=d.button;u._onClick({domEvent:d.domEvent,x:d.x,y:d.y,button:void 0===m?Kt.LEFT:m,source:ss(c)})},n[E1]=function(d,c){var m=d.button;u._onDoubleClick({domEvent:d.domEvent,x:d.x,y:d.y,button:void 0===m?Kt.LEFT:m,source:ss(c)})},n[S1]=function(d){u._onWheel({domEvent:d.domEvent,x:d.x,y:d.y,delta:d.delta,source:as.MOUSE})},n.touchStartGesture=function(d){return r.fire(I.GESTURE_START,d)},n.touchProgressGesture=function(d){return r.fire(I.GESTURE_PROGRESS,d)},n.touchEndGesture=function(d){return r.fire(I.GESTURE_END,d)},n.documentMouseMove=function(d,c){u._onDocumentMove({domEvent:d.domEvent,x:d.x,y:d.y,source:ss(c)})},n.documentMouseUp=function(d,c){var m=d.button,b=void 0===m?Kt.LEFT:m;u._onDocumentUp({domEvent:d.domEvent,x:d.x,y:d.y,source:ss(c),button:b})},n)),u}function ss(e){return 0===e.indexOf(as.TOUCH)?as.TOUCH:as.MOUSE}var Rc=!1,D_={down:{trigger:"pointerdown",duplicate:"mousedown"},click:{trigger:"pointerdown",duplicate:"mouseup"},doubleclick:{trigger:"pointerdown",duplicate:"mouseup"}};function R_(e,t){if(e)return e.type===D_[t].trigger&&(Rc=!0),e.type===D_[t].duplicate&&Rc?!(Rc=!1):void 0}var z_,Ao,Xl,w1=(wt(B_,z_=Fe),B_);function B_(e){var t=e.graphics,n=e.camera,i=e.selection,r=e.events,o=e.captor,a=e.individualAttributes,s=e.interactions,l=e.classes,u=e.settings,d=z_.call(this)||this;return d._dragged=null,d._start=null,d._end=null,d._startDrag=null,d._shouldDrag=function(c){var h=c.target,p=c.button===Kt.LEFT,g=d._settings.get("interactions.drag.enabled"),m=null!==h&&h.isNode&&!0===h.getAttribute("draggable");return p&&g&&m},d._onDragStart=function(c){var h=c.x,p=c.y,g=c.target;d._dragged=g.isSelected()?d._selection.getSelectedNodes().filter(function(m){return m.getAttribute("draggable")}):g.toList(),d._start=d._dragged.getPosition(),d._end=un(d._start),d._onBeforeDrag=d._settings.get("interactions.drag.onBeforeDrag"),d._startDrag=d._camera.screenToGraphCoordinates({x:h,y:p}),d._dragged.addClass(xl),d._events.fire(I.NODES_DRAG_START,{nodes:d._dragged}),d._graphics.addCursorStyle(d._settings.get("interactions.drag.cursor"))},d._onDrag=function(){for(var c=d._captor.getCursorInformation(),h=c.x,p=c.y,g=d._dragged._indexes,m=d._camera.screenToGraphCoordinates({x:h,y:p}),b=m.x-d._startDrag.x,v=m.y-d._startDrag.y,y=0;y<g.length;++y){var E=d._start[y],S=d._end[y];S.x=E.x+b,S.y=E.y+v}d._onBeforeDrag&&d._onBeforeDrag(d._dragged,h,p,d._end),d._settings.get("interactions.drag.applyResult")&&d._attributes.setMultipleAttributes(d._dragged,d._end,null,["x","y"]),d._events.fire(I.NODES_DRAG_PROGRESS,{nodes:d._dragged,dx:b,dy:v})},d._onDragEnd=function(){d._dragged.removeClass(xl),d._graphics.removeCursorStyle(d._settings.get("interactions.drag.cursor")),d._events.fire(I.NODES_DRAG_END,{nodes:d._dragged,start:d._start,end:d._end}),d._dragged=null,d._start=null,d._end=null},d._camera=n,d._graphics=t,d._selection=i,d._events=r,d._settings=u,d._captor=o,d._attributes=a,d._interactions=s,l.createClass({name:xl,isBuiltin:!0,nodeAttributes:{layer:3}}),r.register([I.NODES_DRAG_START,I.NODES_DRAG_PROGRESS,I.NODES_DRAG_END]),u.register("interactions.drag.enabled",!0),u.register("interactions.drag.cursor","move"),u.register("interactions.drag.onBeforeDrag",null),u.register("interactions.drag.applyResult",!0),d._interactions.onDrag({priority:"drag",disableDetection:!0,check:d._shouldDrag,onStart:d._onDragStart,onProgress:d._onDrag,onStop:d._onDragEnd}),d}function C1(e){return.2*Math.min(e.viewWidth/e.graphWidth,e.viewHeight/e.graphHeight)}function T1(e){var t=e.smallestNodeSize;return t===1/0?1/0:Math.min(e.viewWidth,e.viewHeight)/t*.5}(Xl=Ao=Ao||{}).ROTATION="rotation",Xl.PAN="pan",Xl.ZOOM="zoom",Xl.GESTURE="gesture";var V_,M1=(wt(Vs,V_=Fe),Vs.prototype._setupInteractions=function(){var e=this;this._interactions.onMouseWheel({priority:"zoom",check:function(){return e._settings.get("interactions.zoom.enabled")},handler:Pa(function(t){return e._smoothZoom(t.delta,t.x,t.y)},50)}),this._interactions.onDoubleClick({priority:"zoom",check:function(){var t=e._settings.get("interactions.zoom.enabled"),n=e._settings.get("interactions.zoom.onDoubleClick");return t&&n},handler:function(t){return e._smoothZoom(1,t.x,t.y)}}),this._interactions.onDrag({priority:"panning",disableDetection:!0,check:function(t){var n=t.button,i=e._settings.get("interactions.pan.enabled");return"left"===n&&i},onStart:function(){return e._updateVisibility(Ao.PAN,!0)},onProgress:function(t){return e._camera.move({x:-t.dx,y:-t.dy})},onStop:function(){return e._updateVisibility(Ao.PAN,!1)}}),this._interactions.onDrag({priority:"rotation",disableDetection:!0,check:function(t){var i=t.domEvent;return("right"===t.button||i&&2===i.buttons)&&e._settings.get("interactions.rotation.enabled")},onStart:function(t){e._rotationStart={x:t.x,y:t.y},e._updateVisibility(Ao.ROTATION,!0)},onProgress:function(t){return e._rotate({x:t.x,y:t.y})},onStop:function(){return e._updateVisibility(Ao.ROTATION,!1)}}),this._interactions.onGesture({priority:"gesture",disableDetection:!0,check:function(){return e._settings.get("interactions.gesture.enabled")},onStart:function(){return e._updateVisibility(Ao.GESTURE,!0)},onProgress:function(t){var n=t.dx,i=t.dy,r=t.rotation,o=t.scale,a=t.x,s=t.y;e._settings.get("interactions.rotation.enabled")&&e._camera.rotate(-r),e._camera.zoomIn(o,void 0,{refX:a,refY:s}),e._camera.move({x:-n,y:-i})},onStop:function(){return e._updateVisibility(Ao.GESTURE,!0)}})},Vs.prototype._rotate=function(e){var t=e.x,n=e.y,i=this._camera.getSize(),r=i.width/2,o=i.height/2,l=t-r,u=n-o,d=Math.atan2(this._rotationStart.y-o,this._rotationStart.x-r)-Math.atan2(u,l);this._rotationStart.x=t,this._rotationStart.y=n,this._camera.rotate(d)},Vs.prototype._updateVisibility=function(e,t){var n=!t,i=this._settings,r=i.get("interactions."+e+".hideNodes"),o=i.get("interactions."+e+".hideEdges"),a=i.get("interactions."+e+".hideNodeTexts"),s=i.get("interactions."+e+".hideEdgeTexts");r&&this._graphics.setNodesVisibility(n),a&&this._graphics.setNodeTextsVisibility(n),o&&this._graphics.setEdgesVisibility(n),s&&this._graphics.setEdgeTextsVisibility(n)},Vs.prototype._smoothZoom=function(e,t,n){var i=this,r=this._settings,o=r.get("interactions.zoom.modifier"),a=r.get("interactions.zoom.duration"),s=r.get("interactions.zoom.easing"),l=this._camera.getZoom()*(0<e?o:1/o),u={duration:a,easing:s};this._zooming||(this._zooming=!0,this._updateVisibility(Ao.ZOOM,!0)),this._camera.setZoom(l,u,{refX:t,refY:n}).then(function(){i._zooming&&(i._zooming=!1,i._updateVisibility(Ao.ZOOM,!1))})},Vs);function Vs(e,t){var n=e.camera,i=e.graphics,r=e.settings,o=e.interactions,a=V_.call(this)||this;return a._zooming=!1,a._camera=n,a._settings=r,a._interactions=o,a._graphics=i,r.register("interactions.zoom.enabled",!0),r.register("interactions.zoom.onDoubleClick",!1),r.register("interactions.zoom.duration",150),r.register("interactions.zoom.modifier",1.8),r.register("interactions.zoom.easing","quadraticOut"),r.register("interactions.zoom.minValue",t?null:C1),r.register("interactions.zoom.maxValue",t?null:T1),r.register("interactions.zoom.hideNodes",!1),r.register("interactions.zoom.hideEdges",!1),r.register("interactions.zoom.hideNodeTexts",!1),r.register("interactions.zoom.hideEdgeTexts",!1),r.register("interactions.pan.enabled",!0),r.register("interactions.pan.hideNodes",!1),r.register("interactions.pan.hideEdges",!1),r.register("interactions.pan.hideNodeTexts",!1),r.register("interactions.pan.hideEdgeTexts",!1),r.register("interactions.rotation.enabled",!0),r.register("interactions.rotation.hideNodes",!1),r.register("interactions.rotation.hideEdges",!1),r.register("interactions.rotation.hideNodeTexts",!1),r.register("interactions.rotation.hideEdgeTexts",!1),r.register("interactions.gesture.enabled",!0),r.register("interactions.gesture.hideNodes",!1),r.register("interactions.gesture.hideEdges",!1),r.register("interactions.gesture.hideNodeTexts",!1),r.register("interactions.gesture.hideEdgeTexts",!1),a._setupInteractions(),a}var U_,I1={color:"#00C3FF",radius:7,cursorOnHover:"grab",cursorOnDrag:"grabbing"},k1=(wt(so,U_=Fe),so.prototype.onMounted=function(e){e.events.onEdgesSelected(this._refreshHandles),e.events.onEdgesUnselected(this._refreshHandles)},so.prototype.enable=function(e){this._enabled||(this._options=Nt({},I1,e),this._enabled=!0,this._graphics.addCanvas(this._canvas),this._refreshHandles())},so.prototype.disable=function(){this._enabled&&(this._interaction.stop(),this._graphics.removeCursorStyle(this._options.cursorOnDrag),this._disableCursorOnHover(),this._restoreSettings(),this._graphics.removeCanvas(this._canvas),this._rewirableClass.clearEdges(),this._enabled=!1)},so.prototype.enabled=function(){return this._enabled},so.prototype._restoreSettings=function(){this._prevSettings&&(this._settings.update(this._prevSettings),this._prevSettings=null)},so.prototype._disableCursorOnHover=function(){this._hoverHandle&&!this._grabHandle&&(this._hoverHandle=!1,this._graphics.removeCursorStyle(this._options.cursorOnHover))},so.prototype._enableCursorOnHover=function(){this._hoverHandle||(this._hoverHandle=!0,this._graphics.addCursorStyle(this._options.cursorOnHover))},so.prototype._displayMovedEdges=function(){var e=this;if(this._movedEdges){var t=this._x,n=this._y,i=this._ctx,r=Fn(),o={x:t,y:n},a=this._camera.getZoom();this._movedEdges.forEach(function(s,l){var u=e._edgeColors[l],d=s.getSource(),c=s.getTarget(),h=e._getPointedNode(),p=c===e._startNode?d:c,g=s.getAttribute("width")*a,m=p.getPositionOnScreen(),b=h?h.getPositionOnScreen():o;p.addClass(yl),i.beginPath(),i.moveTo(m.x*r,m.y*r),i.lineTo(b.x*r,b.y*r),i.strokeStyle=u,i.lineWidth=g*r,i.stroke()})}},so.prototype._getPointedNode=function(){var e=this._captor.getPointedElement();return e&&e.isNode?e:null},so);function so(e){var t=e.classes,n=e.graphics,i=e.camera,r=e.captor,o=e.selection,a=e.events,s=e.settings,l=e.interactions,u=U_.call(this)||this;return u._canvas=ci(),u._ctx=u._canvas.getContext("2d"),u._nodesToHighlight=null,u._movedEdges=null,u._startNode=null,u._hoverHandle=!1,u._grabHandle=!1,u._prevSettings=null,u._x=0,u._y=0,u._enabled=!1,u._onDragStart=function(){u._nodesToHighlight=u._nodesToHighlight.filter(function(c){return c!==u._startNode}),u._movedEdges.setExcluded(!0);var d=u._options.cursorOnDrag;u._prevSettings=u._settings.update({edgeHover:!1,cursor:{default:d,node:d,edge:d}})},u._onDragEnd=function(){u._restoreSettings();var d=u._getPointedNode();d&&u._movedEdges.forEach(function(c){c.getTarget()===u._startNode?c.setTarget(d):c.setSource(d)}),u._movedEdges.setExcluded(!1),u._movedEdges.setSelected(!0),u._movedEdges=null,u._refreshHandles()},u._refreshHandles=function(){if(u._enabled&&!u._movedEdges){var d=u._selection.getSelectedEdges();u._nodesToHighlight=d.getExtremities().dedupe(),u._rewirableClass.clearEdges(),u._rewirableClass.add(d),u._refreshCanvas()}},u._shouldInteractionStart=function(d){var c=d.target;if(!(u._enabled&&c&&c.isNode&&u._hoverHandle))return!1;var h=c.getAdjacentEdges().filter(function(p){return p.isSelected()});return!!h.size&&(u._movedEdges=h,u._edgeColors=u._movedEdges.getAttribute("color"),u._startNode=c,!0)},u._refreshCanvas=function(){if(u._enabled&&u._nodesToHighlight){var d=u._captor.getCursorPosition(),c=u._getPointedNode(),h=u._camera.zoom,p=u._canvas.getContext("2d"),g=Fn(),m=u._options.color,b=u._options.radius,v=2*b*g;p.clearRect(0,0,u._canvas.width,u._canvas.height),u._displayMovedEdges(),p.fillStyle=m,p.strokeStyle=m;var y=!1;if(u._nodesToHighlight.forEach(function(S){var w=S.getPositionOnScreen(),M=w.x,O=w.y,F=S.getAttribute("radius")*("fixed"===S.getAttribute("scalingMethod")?1:h);b<F&&(p.fillRect((M-b)*g,(O-b)*g,v,v),yi(M,O,d.x,d.y)<b&&(y=!0))}),u._movedEdges){var E=c?c.getPositionOnScreen():d;p.fillRect((E.x-b)*g,(E.y-b)*g,v,v)}y?u._enableCursorOnHover():u._disableCursorOnHover()}},u._captor=r,u._camera=i,u._graphics=n,u._selection=o,u._events=a,u._settings=s,u._interactions=l,u._classes=t,u._rewirableClass=u._classes.createClass({name:kf,isBuiltin:!0,edgeAttributes:{layer:4}}),u._events.on({cameraMove:u._refreshCanvas,move:u._refreshCanvas,progressMoveNodesByDragging:u._refreshCanvas,down:function(){u._hoverHandle&&(u._grabHandle=!0)},up:function(){u._grabHandle=!1}}),u._interaction=u._interactions.onDrag({priority:"rewiring",check:u._shouldInteractionStart,onStart:u._onDragStart,onProgress:function(d){var h=d.y;u._x=d.x,u._y=h},onStop:u._onDragEnd}),u}var j_,O1={cursor:"nesw-resize",color:"#00C3FF",lineWidth:1,handleSize:6,detectionMargin:5,snappingRatio:1.25,nbNodesToSnapTo:5,previewColor:"rgba(0, 0, 0, 0.2)",sizeIndicatorColor:"black",sizeIndicatorOffset:5,sizeIndicatorWidth:3,sizeIndicatorThickness:1},N1=(wt(er,j_=Fe),er.prototype.onMounted=function(e){e.events.onNodesSelected(this._onSelectionChange),e.events.onNodesUnselected(this._onSelectionChange)},er.prototype._enableCursor=function(){this._cursorEnabled||(this._graphics.addCursorStyle(this._options.cursor),this._cursorEnabled=!0)},er.prototype._disableCursor=function(){this._cursorEnabled&&(this._graphics.removeCursorStyle(this._options.cursor),this._cursorEnabled=!1)},er.prototype._detectBoundingBoxes=function(e,t){var n=this;if(this._enabled&&!this._nodeBeingResized&&this._nodesToHighlight){var i=this._options.handleSize/2,r=this._options.detectionMargin;return this._pointedNode=null,this._forEachNodeToHighlight(function(o,a,s){a.x+s-i-r<=e&&e<=a.x+s+i+r&&a.y-s-i-r<=t&&t<=a.y-s+i+r&&(n._pointedNode=o)}),this._pointedNode?this._enableCursor():this._disableCursor()}},er.prototype._forEachNodeToHighlight=function(e){var t=this;this._nodesToHighlight.forEach(function(n){var i=n.getPositionOnScreen(),r=t._getTotalOnScreenRadius(n);e(n,i,r)})},er.prototype._displayHandles=function(){var e=this;if(this._enabled&&this._nodesToHighlight){var t=this._canvas,n=this._ctx,i=t.width,r=t.height,o=Fn(),a=this._options,s=a.color,l=a.lineWidth,u=a.handleSize,d=0;if(n.clearRect(0,0,i,r),this._nodeBeingResized){var c=this._getTotalOnScreenRadius(this._nodeBeingResized),h=this._nodeBeingResized.getPositionOnScreen();d=Math.max(this._x-(h.x+c),-(this._y-(h.y-c)))/2}this._additionalRadiuses=[],this._forEachNodeToHighlight(function(p,g,m){var b=0;if(e._nodeBeingResized){b=d;var v=-m+p.getAttribute("innerStroke.width")+p.getAttribute("outerStroke.width")+l/2+1;b=b<v?v:e._snap(p,b),e._additionalRadiuses.push(b);var y=p.getAttribute("shape"),E=e._engine.getShapePoints(y);e._displayNodePreview(n,o,g.x+b,g.y-b,m+b,E)}n.strokeStyle=s,n.fillStyle=s,n.lineWidth=l,n.strokeRect((g.x-m)*o,(g.y-m-2*b)*o,2*(b+m)*o,2*(b+m)*o),n.fillRect((g.x+m+2*b-u/2)*o,(g.y-m-2*b-u/2)*o,u*o,u*o)})}},er.prototype._displayNodePreview=function(e,t,n,i,r,o){if(n*=t,i*=t,r*=t,e.beginPath(),1===o.length)e.arc(n,i,r,0,2*Math.PI);else for(var a=0;a<o.length;++a){var s=o[a],l=n+s.x*r,u=i+s.y*r;0===a?e.moveTo(l,u):e.lineTo(l,u)}e.fillStyle=this._options.previewColor,e.fill()},er.prototype._getTotalOnScreenRadius=function(e){return e.getAttribute("radius")*this._camera.zoom+e.getAttribute("innerStroke.width")+e.getAttribute("outerStroke.width")+this._options.lineWidth/2},er.prototype._snap=function(e,t){var n=this,i=this._spatial.getNodesInScreenByDistance(e).filter(function(p){return!p.isSelected()}).slice(0,this._options.nbNodesToSnapTo),r=this._ctx,o=this._getTotalOnScreenRadius(e),a=o+t,s=this._options.snappingRatio,u=Math.round(Ar(a/o,s)),d=o*Math.pow(s,u),c=null;if(i.forEach(function(p){var g=n._getTotalOnScreenRadius(p);Math.abs(g-a)<=Math.abs(d-a)&&(d=g,c=p)}),c){r.save(),r.strokeStyle=this._options.sizeIndicatorColor,r.lineWidth=this._options.sizeIndicatorThickness;var h=c.getAttribute("radius");this._displaySizeIndicator(e,d),i.filter(function(p){return p.getAttribute("radius")===h}).forEach(function(p){return n._displaySizeIndicator(p)}),r.restore()}return d-o},er.prototype._displaySizeIndicator=function(e,t){var n=this._ctx,i=Fn(),r=e.getPositionOnScreen(),o=this._getTotalOnScreenRadius(e),a=t||o,s=t?t-o:0,l=s-this._options.sizeIndicatorOffset-(t?e.getAttribute("innerStroke.width")+e.getAttribute("outerStroke.width"):0),u=r.x-a+l|0,d=r.y-a-s|0,c=r.y+a-s|0,h=this._options.sizeIndicatorWidth;n.beginPath(),n.moveTo((u-h)*i,d*i),n.lineTo((u+h)*i,d*i),n.moveTo(u*i,d*i),n.lineTo(u*i,c*i),n.moveTo((u-h)*i,c*i),n.lineTo((u+h)*i,c*i),n.stroke()},er.prototype.enable=function(e){this._enabled||(this._options=Nt({},O1,e),this._graphics.addCanvas(this._canvas),this._ctx=this._canvas.getContext("2d"),this._events.on({"cameraMove progressMoveNodesByDragging":this._displayHandlesHandler,"move down":this._moveHandler}),this._enabled=!0)},er.prototype.disable=function(){this._enabled&&(this._events.removeListener(this._displayHandlesHandler),this._events.removeListener(this._moveHandler),this._graphics.removeCanvas(this._canvas),this._disableCursor(),this._reset())},er.prototype._reset=function(){this._enabled=!1,this._nodesToHighlight=null,this._options=null,this._nodeBeingResized=null,this._pointedNode=null,this._cursorEnabled=!1,this._x=0,this._y=0,this._additionalRadiuses=[]},er.prototype.enabled=function(){return this._enabled},er);function er(e){var t=e.dom,n=e.interactions,i=e.camera,r=e.events,o=e.graphics,a=e.spatial,s=e.selection,l=j_.call(this)||this;return l._enabled=!1,l._nodesToHighlight=null,l._options=null,l._nodeBeingResized=null,l._pointedNode=null,l._cursorEnabled=!1,l._x=0,l._y=0,l._additionalRadiuses=[],l._onSelectionChange=function(){l._enabled&&(l._nodesToHighlight=l._selection.getSelectedNodes(),l._displayHandles())},l._displayHandlesHandler=function(){return l._displayHandles()},l._moveHandler=function(u){var d=u.x,c=u.y;l._dom.setTimeout(function(){return l._detectBoundingBoxes(d,c)})},l._dom=t,l._interactions=n,l._events=r,l._camera=i,l._dom=t,l._spatial=a,l._graphics=o,l._selection=s,l._engine=l._graphics.getGraphicsEngine(),l._canvas=ci(),l._ctx=l._canvas.getContext("2d"),l._interactions.onDrag({priority:"resizing",disableDetection:!0,check:function(){return!(!l._enabled||!l._pointedNode)},onStart:function(u){var c=u.y;l._x=u.x,l._y=c,l._nodeBeingResized=l._pointedNode},onProgress:function(u){var c=u.y;l._x=u.x,l._y=c,l._displayHandles()},onStop:function(){l._nodesToHighlight.forEach(function(u,d){var c=l._additionalRadiuses[d]/l._camera.zoom;u.setAttributes({radius:u.getAttribute("radius")+c,x:u.getPosition().x+c,y:u.getPosition().y-c})}),l._pointedNode=null,l._nodeBeingResized=null,l._displayHandles()}}),l}var Z_,zc,Bc,L1={strokeColor:"black",strokeWidth:5,dashed:!0,cursorStyle:"cell",createNodes:!0,condition:function(){return!0},onNodeCreated:function(){},onEdgeCreated:function(){},onComplete:function(){}},F1=(wt(qo,Z_=Fe),qo.prototype._onStart=function(e){e&&(this._cursorEnabled=!0,this._startNode=e,this._startPos=e.getPosition(),this._graphics.addCursorStyle(this._options.cursorStyle),this._blockId=this._graphics.allocateGraphicsEngineBlockId())},qo.prototype._onMove=function(e,t){null!==this._startNode&&(this._endPos=this._camera.screenToGraphCoordinates({x:e,y:t}),this._drawLine())},qo.prototype._onStop=function(){if(null!==this._startNode){var e=this._options,t=e.condition,n=e.onNodeCreated,i=e.onEdgeCreated,r=e.onComplete,o=e.createNodes,a=this._captor.getPointedElement(),s=null,l=null;this._graphics.releaseGraphicsEngineBlockId(this._blockId),!a&&o&&(l=a=this._graph.addNode({attributes:{x:this._endPos.x,y:this._endPos.y}}),n&&n(l)),a&&(l||!t||t(this._startNode,a))&&(s=this._graph.addEdge({source:this._startNode.getId(),target:a.getId()}),i&&i(s)),r&&(this._events.fire(I.CONNECT_NODES,{source:this._startNode,target:a,edge:s}),r(this._startNode,a,s)),this.disable()}},qo.prototype._drawLine=function(){this._block.reset(1,!1,this._depth);var e=this._block.nextAndReset().end;e.pieceId=2,e.shape="line",e.x1=this._startPos.x,e.y1=this._startPos.y,e.x2=this._endPos.x,e.y2=this._endPos.y,e.fillColor=this._options.strokeColor,e.thicknessOrFontSizeFixed=this._options.strokeWidth,this._options.dashed&&(e.dashLength=3,e.gapLength=1),this._engine.storeBlock(this._blockId,this._block),this._dom.refresh()},qo.prototype.enable=function(e){if(void 0===e&&(e={}),!this._enabled)return this._options=Nt({},L1,e),this._enabled=!0,this._cursorEnabled=!1,this._startNode=null,this._prevSettings=this._settings.update({"cursor.node":this._options.cursorStyle,"detect.edges":!1}),this._captor.isLeftPressed()&&this._interaction.start(this._captor.getCursorInformation()),this},qo.prototype.disable=function(){this._enabled&&(this._enabled=!1,this._settings.update(this._prevSettings),this._cursorEnabled&&this._graphics.removeCursorStyle(this._options.cursorStyle))},qo.prototype.enabled=function(){return this._enabled},qo);function qo(e){var t=e.dom,n=e.camera,i=e.captor,r=e.graph,o=e.graphics,a=e.interactions,s=e.events,l=e.settings,u=Z_.call(this)||this;return u._enabled=!1,u._options=null,u._blockId=null,u._startNode=null,u._startPos=null,u._endPos=null,u._cursorEnabled=!1,u._dom=t,u._camera=n,u._captor=i,u._graph=r,u._graphics=o,u._interactions=a,u._events=s,u._settings=l,u._engine=u._graphics.getGraphicsEngine(),u._block=u._engine.createBlock(),u._depth=xu(0).edgeBody,u._events.register([I.CONNECT_NODES]),u._interaction=u._interactions.onDrag({priority:"connectNodes",check:function(d){var c=d.target,h=d.button;return u._enabled&&"left"===(void 0===h?"left":h)&&c&&c.isNode},onStart:function(d){return u._onStart(d.target)},onProgress:function(d){return u._onMove(d.x,d.y)},onStop:function(){return u._onStop()}}),u._events.on({clear:function(){return u.disable()}}),u}var G_,P1=["top","bottom","left","right","cssDefined"],D1={top:{x:0,y:-1},bottom:{x:0,y:1},left:{x:-1,y:0},right:{x:1,y:0}},R1={position:"top",autoAdjust:!0,delay:100,className:null},z1={hover:{node:function(e){var t=e.target;return t&&t.isNode},edge:function(e){var t=e.target;return t&&!t.isNode}},click:((zc={})[Kt.LEFT]={node:function(e){var t=e.target;return e.button===Kt.LEFT&&t&&t.isNode},edge:function(e){var t=e.target;return e.button===Kt.LEFT&&t&&!t.isNode},background:function(e){return e.button===Kt.LEFT&&!e.target}},zc[Kt.RIGHT]={node:function(e){var t=e.target;return e.button===Kt.RIGHT&&t&&t.isNode},edge:function(e){var t=e.target;return e.button===Kt.RIGHT&&t&&!t.isNode},background:function(e){return e.button===Kt.RIGHT&&!e.target}},zc),doubleClick:((Bc={})[Kt.LEFT]={node:function(e){var t=e.target;return e.button===Kt.LEFT&&t&&t.isNode},edge:function(e){var t=e.target;return e.button===Kt.LEFT&&t&&!t.isNode},background:function(e){return e.button===Kt.LEFT&&!e.target}},Bc[Kt.RIGHT]={node:function(e){var t=e.target;return e.button===Kt.RIGHT&&t&&t.isNode},edge:function(e){var t=e.target;return e.button===Kt.RIGHT&&t&&!t.isNode},background:function(e){return e.button===Kt.RIGHT&&!e.target}},Bc)},B1=(wt(Hr,G_=Fe),Hr.prototype.hide=function(){this._hideTooltip(!0)},Hr.prototype.isShown=function(){return!!this._tooltip},Hr.prototype.refresh=function(){this._refreshTooltip()},Hr.prototype.show=function(e,t){var n=void 0===t?{}:t,i=n.position,o=n.autoAdjust,s=n.className,u=n.x,c=n.y;this._showTooltip(e,{position:void 0===i?"top":i,autoAdjust:void 0===o||o,className:void 0===s?null:s},{x:void 0===u?0:u,y:void 0===c?0:c})},Hr.prototype.setHandler=function(e,t,n){var i=Nt({},R1,n);-1===P1.indexOf(i.position)&&(i.position="top"),this._handlers[e]={handler:t,condition:En(z1,e),settings:i}},Hr.prototype._hideTooltip=function(e){if(this._timeout&&(this._dom.clearTimeout(this._timeout),this._timeout=null),e&&(this._currentHandlerName=null),this._tooltip){var t=this._tooltip;this._tooltip.parentNode&&this._tooltip.parentNode.removeChild(this._tooltip),this._tooltip=null,this._events.fire(I.TOOLTIP_HIDE,{tooltip:t})}},Hr.prototype._createInteraction=function(e,t){var n=this;return void 0===t&&(t=!1),{priority:"tooltip",check:function(i){var r=q_(e,i),o=n._handlers[r];return!(t&&n._connectNodes.enabled()||(!o||!o.condition(i))&&(t||!n._currentHandlerName||n._isHover||null===n._tooltip))},handler:function(i){var r=i.target,o=i.x,a=i.y;n._hideTooltip(!1),n._isHover=t,n._elt=r,n._x=o,n._y=a,n._currentHandlerName=q_(e,i),n._refreshTooltip()}}},Hr.prototype._refreshTooltip=function(){var e=this;if(this._currentHandlerName){var t=this._handlers[this._currentHandlerName];if(t){var n=t.settings,i=t.handler,r=this._elt;if(r&&-1===this._currentHandlerName.indexOf(r.isNode?"node":"edge"))return;var a=i(r);(a instanceof Promise?a:Promise.resolve(a)).then(function(s){e._schedule(function(){return e._showTooltip(s,n)},n.delay)})}}else this._hideTooltip(!1)},Hr.prototype._schedule=function(e,t){var n=this;this._timeout&&this._dom.clearTimeout(this._timeout),this._timeout=this._dom.setTimeout(function(){n._timeout=null,e()},t)},Hr.prototype._showTooltip=function(e,t,n){this._hideTooltip(!1);var i=t.position,r=t.className,o=t.autoAdjust,a=this._x,s=this._y,l=this._elt,u=this._dom.getDimensions(),d=0,c=0;if(n&&(a=n.x,s=n.y,l=null),"string"==typeof e)this._tooltip=rr?document.createElement("div"):$o(),this._tooltip.innerHTML=e;else{if(!Do(e))throw new Error("invalid tooltip "+e+", expected HTML string or HTML element");this._tooltip=e}var h=this._tooltip;if(r&&this._tooltip.classList.add(r),"cssDefined"!==i&&(h.style.position="absolute"),this._dom.appendElement(h),l&&l.isNode){var p=l,g=p.getPositionOnScreen(),m=p.getAttribute("radius");m="fixed"===p.getAttribute("scalingMethod")?m+p.getAttribute("innerStroke.width")+p.getAttribute("outerStroke.width"):m*this._camera.getZoom()+p.getAttribute("innerStroke.width")+p.getAttribute("outerStroke.width"),a=g.x,s=g.y,c=d=m}var b=h.offsetWidth/2,v=h.offsetHeight/2;if(d+=b,c+=v,"cssDefined"!==i){var y=D1[i],E=y.x,S=y.y;if(o){var w=a+d*y.x,M=s+c*y.y;(w-b<0||w+b>=u.width)&&("left"===i||"right"===i?E*=-1:E=w-b<0?(b-w+1)/d:(u.width-(w+b)-1)/d),(M-v<0||M+v>=u.height)&&("top"===i||"bottom"===i?S*=-1:S=M-v<0?(v-M+1)/c:(u.height-(M+v)-1)/c)}h.style.left=a+d*E-b+"px",h.style.top=s+c*S-v+"px"}this._events.fire(I.TOOLTIP_SHOW,{tooltip:h})},Hr);function Hr(e){var t=e.dom,n=e.connectNodes,i=e.interactions,r=e.camera,o=e.events,a=G_.call(this)||this;return a._x=0,a._y=0,a._dom=t,a._connectNodes=n,a._interactions=i,a._camera=r,a._events=o,a._handlers={},a._currentHandlerName=null,a._tooltip=null,a._isHover=!1,a._events.register(["showTooltip","hideTooltip"]),a._events.on({"up dragStart":function(){a._isHover||a._hideTooltip(!1)},unhover:function(){a._isHover&&a._hideTooltip(!1)},clear:function(){return a._hideTooltip(!1)}}),a._interactions.onHover(a._createInteraction("hover",!0)),a._interactions.onClick(a._createInteraction("click")),a._interactions.onDoubleClick(a._createInteraction("doubleClick")),a}function q_(e,t){var n=t.button,i=t.target;return e+(n?"."+n:"")+"."+(null!==i?i.isNode?"node":"edge":"background")}var H_,Ou={65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",13:"enter",16:"shift",17:"ctrl",18:"alt",27:"esc",46:"del",8:"backspace",32:"space",224:"cmd",91:"cmd",92:"cmd",93:"cmd",187:"+",189:"-"},W_=Object.keys(Ou).reduce(function(e,t){var n=Ou[t];return e[n]||(e[n]=[]),e[n].push(t),e},{}),V1=(wt(Us,H_=Fe),Us.prototype.setIdleTimeout=function(e){if(!isFinite(e)||e<=1)throw new TypeError("Idle timeout must be a positive number > 1");this._idleTimeout=e},Us.prototype.resetKeys=function(){for(var e=0;e<this._pressed.length;e++)this._pressed[e]&&(this._pressed[e]=!1,this._events.fire("keyUp",{key:Ou[e],code:e}))},Us.prototype.onKeyPress=function(e,t){var n,i=this;if("number"==typeof e&&(n=[e]),"string"==typeof e&&(n=e.split(" ")),Array.isArray(e)&&(n=e),!n)throw new TypeError(e+" is not a number, string or array");if(0===n.length)throw new Error("the array should contain at least one element");var r=n.map(function(s){if("number"==typeof s)return[s];if("string"!=typeof s)throw new TypeError(s+" is not a valid key identifier");var l=W_[s];if(!l)throw new Error(s+" is not a valid key identifier");return l}),o=r.pop(),a={keys:r,handler:t};o.forEach(function(s){i._binds[s]||(i._binds[s]=[]),i._binds[s].push(a)})},Us.prototype.isPressed=function(e){var t=this;if("number"==typeof e)return this._pressed[e];if("string"==typeof e){var n=W_[e];if(n)return n.some(function(i){return t._pressed[i]})}return!1},Us);function Us(e){var t=e.dom,n=e.events,i=H_.call(this)||this;return i._onBlur=function(){return i.resetKeys()},i._onKeyUp=function(r){var o=r.keyCode||r.which;i._pressed[o]=!1,i._events.fire("keyUp",{domEvent:r,key:Ou[o],code:o})},i._onKeyDown=function(r){var o=r.keyCode||r.which,a=i._binds[o];if(!i._pressed[o]){if(i._pressed[o]=!0,a)for(var s=0,l=a;s<l.length;s++){var u=l[s];u.keys.every(function(d){return d.some(function(c){return i._pressed[c]})})&&u.handler({domEvent:r})}i._events.fire("keyDown",{domEvent:r,key:Ou[o],code:o})}},i._dom=t,i._events=n,i._events.register(["keyUp","keyDown"]),i._binds=[],i._pressed=[],i._dom.addWindowEventListener("keydown",i._onKeyDown),i._dom.addWindowEventListener("keyup",i._onKeyUp),i._dom.addWindowEventListener("visibilitychange",i._onBlur),i._dom.addWindowEventListener("blur",i._onBlur,!1),i._idleTimeout=4e3,i._prevEventTimeStamp=P(),i._events.onAnyEvent(function(){var r=P();r-i._prevEventTimeStamp>i._idleTimeout&&i.resetKeys(),i._prevEventTimeStamp=r}),i}var U1=[{name:"color",isNode:!0},{name:"shape",isNode:!0},{name:"radius",isNode:!0},{name:"icon.content",isNode:!0},{name:"image.url",isNode:!0},{name:"image",isNode:!0},{name:"color",isNode:!1},{name:"shape",isNode:!1},{name:"width",isNode:!1}],Ho=Math.PI,Wo=2*Math.PI,Y_=Math.cos(Ho/2-Wo/5),X_=Math.cos(Ho/2-Wo/5*2),J_=Math.cos(Ho/2-Wo/5*3),Q_=Math.cos(Ho/2-Wo/5*4),K_=Math.sin(-Ho/2+Wo/5),$_=Math.sin(-Ho/2+Wo/5*2),em=Math.sin(-Ho/2+Wo/5*3),tm=Math.sin(-Ho/2+Wo/5*4),Vc=1/3,Z1=[8,3],G1=[3,3],im={position:"bottom",widgetWidth:130,fontFamily:"Arial",fontSize:10,fontColor:"black",titleFontSize:12,titleFontColor:"black",titleMaxLength:20,titleTextAlign:"left",shapeColor:"grey",backgroundColor:"white",borderColor:"black",borderRadius:0,borderWidth:1,innerMargin:10,outerMargin:5,circleStrokeWidth:3,titleFunction:function(e){return e[e.length-1]}},q1=["widgetWidth","fontSize","titleFontSize","borderRadius","borderWidth","innerMargin","outerMargin","circleStrokeWidth"];function Yo(e){var t=["K","M","B","T","P","E","Z","Y"];if(9999<e){for(var n=0;n<t.length&&999<e;)e/=1e3,n++;return(rm(e,3)+t[n-1]).toString()}return rm(e,4).toString()}function rm(e,t){void 0===t&&(t=3);var n=4===t?10:1;return e<10?Math.round(100*e*n)/100*n:e<100?Math.round(10*e*n)/10*n:e<1e3?Math.round(e*n)/n:Math.round(e)}function om(e){return e.innerMargin+1.6*(e.titleFontSize+e.fontSize)}function H1(e,t,n){var i,U,Y,he,pe,we,ke,at,st,Xe,o=t.getContext("2d"),a=n.x,s=n.y,u=n.isNode,d=n.styleProperty,c=n.title,h=n.mapping,p=n.iconFont,g=n.iconFontStyle;Y=a,he=s,pe=(i=e).widgetWidth,we=n.height,ke=i.borderRadius,at=i.backgroundColor,st=i.borderColor,Xe=i.borderWidth,(U=o).setLineDash([]),U.beginPath(),U.moveTo(Y+ke,he),U.lineTo(Y+pe-ke,he),U.quadraticCurveTo(Y+pe,he,Y+pe,he+ke),U.lineTo(Y+pe,he+we-ke),U.quadraticCurveTo(Y+pe,he+we,Y+pe-ke,he+we),U.lineTo(Y+ke,he+we),U.quadraticCurveTo(Y,he+we,Y,he+we-ke),U.lineTo(Y,he+ke),U.quadraticCurveTo(Y,he,Y+ke,he),U.closePath(),U.fillStyle=at,U.fill(),U.strokeStyle=st,U.lineWidth=Xe,U.stroke(),function(U,Y,he,pe,we){Nu(U,Y.fontFamily,Y.titleFontSize,Y.titleFontColor,Y.titleTextAlign);var ke="center"===Y.titleTextAlign,at=Y.widgetWidth-2*Y.innerMargin,st=U.measureText(he).width,Xe=pe+(ke?Y.widgetWidth/2:Y.innerMargin),xt=we+Y.titleFontSize/2+Y.innerMargin;at<st&&(he=he.substr(0,(he.length*(at/st)|0)-2)+"\u2026"),U.fillText(he,Xe,xt)}(o,e,c,a,s);var b=1.6*e.fontSize,v=e.fontSize/2*1.6*.9,y=3*e.fontSize,E=e.fontSize,S=e.fontSize*(u?1:3),w=s+om(e),M=a+e.innerMargin+S/2,O=a+2*e.innerMargin+S,F=Da(h),L=function U(Y){return Array.isArray(Y)?Y.reduce(function(he,pe){return he&&U(pe)},!0):"undefined"===Y||!isNaN(Number(Y))}(F),N=e.fontColor,B=e.shapeColor,X=Object.keys(h);if(L&&(X.sort(function(U,Y){return mn(h[Y])-mn(h[U])}),"radius"===d||"width"===d)){var J=function U(Y){return Array.isArray(Y)?Y.reduce(function(he,pe){return Math.min(he,U(pe))},1/0):isNaN(Y)?1/0:+Y}(F),ae=function U(Y){return Array.isArray(Y)?Y.reduce(function(he,pe){return Math.max(he,U(pe))},-1/0):isNaN(Y)?-1/0:+Y}(F),ie=Math.round((J+ae)/2);return(u?W1:Y1)(e,o,a,w,J,ie,ae,B)}X.forEach(function(U){var Y,he,pe,we,ke,st,Xe,xt,It,He,Pe,We,Qe,nt,Me,ze,qe,Ke,ht,Wt,$t,Ge=h[U];"color"===d&&(u?am(o,M,w,v,U):(he=M,pe=w,we=y,ke=E,(Y=o).fillStyle=U,Y.fillRect(he-we/2,pe-ke/2,we,ke))),"shape"===d&&(u?function(He,Pe,We,Qe,nt,Me){switch(He.fillStyle=Me,nt){case"square":return He.fillRect(Pe-Qe,We-Qe,2*Qe,2*Qe);case"circle":return am(He,Pe,We,Qe,Me);case"cross":return(ze=He).fillRect((qe=Pe)-(ht=Qe),(Ke=We)-.31*ht,2*ht,2*ht*.31),void ze.fillRect(qe-.31*ht,Ke-ht,2*ht*.31,2*ht);case"diamond":return function(ze,qe,Ke,ht){ze.beginPath(),ze.moveTo(qe-ht,Ke),ze.lineTo(qe,Ke-ht),ze.lineTo(qe+ht,Ke),ze.lineTo(qe,Ke+ht),ze.fill()}(He,Pe,We,Qe);case"equilateral":return function(ze,qe,Ke,ht){ze.beginPath(),ze.moveTo(qe,Ke-ht),ze.lineTo(qe+Y_*ht,Ke+K_*ht),ze.lineTo(qe+X_*ht,Ke+$_*ht),ze.lineTo(qe+J_*ht,Ke+em*ht),ze.lineTo(qe+Q_*ht,Ke+tm*ht),ze.fill()}(He,Pe,We,Qe);case"star":!function(ze,qe,Ke,ht){ze.beginPath(),ze.moveTo(qe,Ke-ht),ze.lineTo(qe+X_*ht,Ke+$_*ht),ze.lineTo(qe+Q_*ht,Ke+tm*ht),ze.lineTo(qe+Y_*ht,Ke+K_*ht),ze.lineTo(qe+J_*ht,Ke+em*ht),ze.fill()}(He,Pe,We,Qe)}var ze,qe,Ke,ht}(o,M,w,v,U,B):(Pe=M,We=w,Qe=y,nt=E,Me=U,(He=o).fillStyle=ze=B,"line"===Me&&He.fillRect(Pe-Qe/2,We-nt/4,Qe,nt/2),"arrow"===Me?((qe=He).fillRect((Ke=Pe)-(Wt=Qe)/2,(ht=We)-($t=nt)/4,Wt*(1-Vc),$t/2),qe.beginPath(),qe.moveTo(Ke+Wt*(1-Vc-.5),ht-$t/2),qe.lineTo(Ke+Wt*(1-Vc-.5),ht+$t/2),qe.lineTo(Ke+Wt/2,ht),qe.fill()):"dashed"===Me||"dotted"===Me?function(qe,Ke,ht,Wt,$t,dn,sn){qe.beginPath(),qe.moveTo(Ke-Wt/2,ht),qe.lineTo(Ke+Wt/2,ht),qe.strokeStyle=dn,qe.lineWidth=$t/2,qe.setLineDash("dashed"===sn?Z1:G1),qe.stroke()}(He,Pe,We,Qe,nt,ze,Me):"tapered"===Me&&function(qe,Ke,ht,Wt,$t){qe.beginPath(),qe.moveTo(Ke-Wt/2,ht-$t/2),qe.lineTo(Ke-Wt/2,ht+$t/2),qe.lineTo(Ke+Wt/2,ht),qe.fill()}(He,Pe,We,Qe,nt))),"icon.content"===d&&(Xe=M,xt=w,It=U,Nu(st=o,p,2*v,N,"center",g),st.fillText(It,Xe,xt)),"image"!==d&&"image.url"!==d||function(He,Pe,We,Qe,nt){if("undefined"!=typeof Image){He._imgStore||(He._imgStore={});var Me=He._imgStore[nt];if(Me)return He.drawImage(Me,Pe-Qe,We-Qe,2*Qe,2*Qe);(Me=new Image).src=nt,Me.onload=function(){He.drawImage(Me,Pe-Qe,We-Qe,2*Qe,2*Qe)},He._imgStore[nt]=Me}}(o,M,w,v,U),function(He,Pe,We,Qe,nt,Me){var ze=nt.join();if(Me)if(1===nt.length)ze=Yo(nt[0]);else{var qe=mn(nt),Ke=on(nt);ze=Yo(qe)+" - "+Yo(Ke)}Nu(He,Pe.fontFamily,Pe.fontSize,Pe.fontColor),He.fillText(ze,We,Qe)}(o,e,O,w,Ge,L),w+=b})}function Nu(e,t,n,i,r,o){void 0===r&&(r="left"),void 0===o&&(o="normal"),e.textAlign=r,e.textBaseline="middle",e.fillStyle=i,e.font=o+" "+n+'px "'+t+'"'}function am(e,t,n,i,r){e.beginPath(),e.arc(t,n,i,0,2*Ho),e.fillStyle=r,e.fill()}function W1(e,t,n,i,r,o,a,s){for(var l,u,d,c,h,p,g=.7*e.fontSize,m=3*g,b=(g+m)/2,v=n+e.innerMargin+m,y=v+m+e.innerMargin,E=i+2*m-.5*e.innerMargin,S=e.circleStrokeWidth,w=0,M=[g,b,m];w<M.length;w++){var O=M[w];u=v,d=E-O,c=O,h=s,p=S,(l=t).beginPath(),l.arc(u,d,c,0,Wo),l.strokeStyle=h,l.lineWidth=p,l.stroke()}Nu(t,e.fontFamily,e.fontSize,e.fontColor,"left"),t.fillText(Yo(r),y,E+g-2*g),t.fillText(Yo(o),y,E+g-2*b),t.fillText(Yo(a),y,E+g-2*m)}function Y1(e,t,n,i,r,o,a,s){var l=(e.widgetWidth-2*e.innerMargin)/3,u=e.fontSize,d=i-e.innerMargin/2,c=d+2*u,h=n+e.innerMargin;t.fillStyle=s,t.fillRect(h,d-u/2,1+l,u),t.fillRect(h+l,d-u/3,1+l,u/1.5),t.fillRect(h+2*l,d-u/6,l,u/3),Nu(t,e.fontFamily,e.fontSize,e.fontColor,"center"),t.fillText(Yo(a),h+.5*l,c),t.fillText(Yo(o),h+1.5*l,c),t.fillText(Yo(r),h+2.5*l,c)}function J1(e,t,n){for(var i=null,r=0;r<t.length;++r){var o=t[r];o.isNode!==e.isNode&&1!==t.length||!(null===i||o.height<t[i].height)||(i=r)}(o=t[i]).content.push(e),o.height+=e.height+n.outerMargin}function Q1(e){for(var t=0,n=1;n<e.length;++n)e[n].height>e[t].height&&(t=n);return t}function K1(e,t){return e.isNode!==t.isNode?e.isNode?-1:1:e.title<=t.title?-1:1}function $1(e,t){return e.height-t.height}function eE(e,t){return e.isNode!==t.isNode?e.isNode?-1:1:t.height-e.height}function tE(e,t){return e.isNode!==t.isNode?e.isNode?-1:1:e.content[0].title<=t.content[0].title?-1:1}var sm,nE=(wt(Ri,sm=Fe),Ri.prototype.enable=function(e){var t=this._settings;return this._settings=Nt({},im,e),this._mustRefresh=!this._enabled||!this._sameOptions(t,this._settings),this._enabled?Promise.resolve():(this._enabled=!0,this._graphics.addCanvas(this._canvas),this.refresh())},Ri.prototype._afterNextUpdate=function(){var e=this;return new Promise(function(t){return e._promises.push(t)})},Ri.prototype._formatSettings=function(e,t){var n=Nt({},im,e);return q1.forEach(function(i){return n[i]*=t}),n},Ri.prototype.disable=function(){this._enabled&&(this._enabled=!1,this._graphics.removeCanvas(this._canvas))},Ri.prototype.enabled=function(){return this._enabled},Ri.prototype.refresh=function(){return this._mustRefresh=!0,this._dom.refresh(),this._afterNextUpdate()},Ri.prototype.destroy=function(){this._enabled=!1,this._mustRefresh=!1,this._settings=null,this._promises=[]},Ri.prototype.getOptions=function(){if(this.enabled)return Nt({},this._settings)},Ri.prototype.getCurrentOptions=function(){return this._settings},Ri.prototype._sameOptions=function(e,t){return e===t||Object.keys(e).reduce(function(n,i){return n&&e[i]===t[i]},!0)},Ri.prototype._drawOnCanvas=function(e,t,n){var i=this._formatSettings(e,n);!function(e,t,n){var i={width:t.width,height:t.height},r=!1;!!(i.width&&i.height&&n)&&((r="top"===e.position||"bottom"===e.position?function(o,a,s,l){s=s.slice();for(var u=a.widgetWidth+a.outerMargin,d=Math.floor((o.width-a.outerMargin)/u),c=o.height-a.outerMargin,h=new Array(Math.min(d,s.length)),p=s.length,g=0,m=0,b=0,v=0,y=0;y<p;++y){var E=s[y];E.isNode?(g+=1,m+=E.height):(b+=1,v+=E.height)}var S=m+v,M=v/S,O=Math.round(m/S*d),F=Math.round(M*d);if(g<O?O=g:b<F&&(O=d-b),0===d)return!1;for(y=0;y<h.length;y++)h[y]={content:[],height:0,isNode:y<O};for(y=0;y<p;++y){var L=Q1(s);J1(s[L],h,a),s.splice(L,1)}h.every(function(ie){return 1===ie.content.length})?h.sort(tE):h.sort(eE);var N=a.outerMargin;for(y=0;y<h.length;++y){var B=h[y];if(B.height>c)return!1;B.content.sort($1);for(var X=0,J=0;J<B.content.length;++J){var ae=B.content[J];ae.x=N,ae.y=l?o.height-X-ae.height-a.outerMargin:X+a.outerMargin,X+=ae.height+a.outerMargin}N+=u}return!0}(i,e,n,"bottom"===e.position):function(o,a,s,l){var u=a.widgetWidth+a.outerMargin,d=Math.floor((o.width-a.outerMargin)/u),c=o.height,h=a.outerMargin,p=l?a.outerMargin:o.width-u,g=1;s=s.slice().sort(K1);for(var m=0;m<s.length;++m){var b=s[m];if(h+b.height>c){if(h===a.outerMargin)return!1;h=a.outerMargin,g+=1,l?p+=u:p-=u}b.x=p,b.y=h,h+=b.height}return g<=d}(i,e,n,"left"===e.position))&&n.forEach(function(o){return H1(e,t,o)}))}(i,t,this._computeWidgetList(i))},Ri.prototype.exportOnCanvas=function(e,t){return this._drawOnCanvas(t,e,1)},Ri.prototype._computeWidgetList=function(e){var t=this,n=[];return U1.forEach(function(i){var a=t._computeWidget(e,i.name,i.isNode);a&&n.push(a)}),n},Ri.prototype._computeWidget=function(e,t,n){var i=this._computePropertyMapping(e,t,n);if(i){if("icon.content"!==t)return i;var r=this._getRulesForAttribute(n,"icon.font"),o=this._getRulesForAttribute(n,"icon.style"),a=null,s=null;if(r.length||(a="Arial",s="normal"),"string"==typeof r[0]&&(a=r[0],s=o[0]),a)return i.iconFont=a,i.iconFontStyle=s,i}return null},Ri.prototype._computePropertyMapping=function(e,t,n){var i,r,o,a,s,l,u,d=this._getRulesForAttribute(n,t)[0],c=d&&d.mapping,h=c&&c.getValues(n);if(c&&h){var p=c.getField(),g={};return vt(h,function(m,b){void 0!==m&&"undefined"!==b&&(g[m]=g[m]||[],g[m].push(b))}),0===Object.keys(g).length?null:{isNode:n,title:e.titleFunction(p),styleProperty:t,dataProperty:p,mapping:g,height:(i=g,r=t,o=n,s=(a=e).outerMargin+om(a),l=1.6*a.fontSize,u=s-.8*a.innerMargin,"radius"===r||"width"===r?u+l*(o?3:2):u+Object.keys(i).length*l)}}return null},Ri.prototype._getRulesForAttribute=function(e,t){return this._styleRules.getRuleList().map(function(n){var i=n.getDefinition();return En(e?i.nodeAttributes:i.edgeAttributes,t)}).filter(function(n){return n}).sort(function(n,i){return n.mapping&&i.mapping?0:n.mapping?-1:1})},Ri);function Ri(e){var t,n=e.graphics,i=e.dom,r=e.events,o=e.styleRules,a=sm.call(this)||this;return a._enabled=!1,a._mustRefresh=!1,a._settings=null,a._promises=[],a._graphics=n,a._dom=i,a._events=r,a._styleRules=o,a._canvas=ci(),a._ctx=a._canvas.getContext("2d"),a._events.on(((t={})[I.NEW_FRAME]=function(){if(a._enabled&&a._mustRefresh){a._ctx.clearRect(0,0,a._canvas.width,a._canvas.height),a._drawOnCanvas(a._settings,a._canvas,Fn());var s=a._promises;a._promises=[],s.forEach(function(l){return l()}),a._mustRefresh=!1}},t[I.RESIZE+" "+I.RELOAD_FONTS]=function(){a._mustRefresh=!0},t)),a}var um,lm={layer:3,outline:!0,outerStroke:{color:"red",width:5},innerStroke:{minVisibleSize:0},text:{backgroundColor:"rgb(220, 220, 220)",minVisibleSize:0}},iE={layer:3,outline:!0,color:"red",text:{backgroundColor:"rgb(220, 220, 220)",minVisibleSize:0}},rE=(wt(Nr,um=Fe),Nr.prototype.setRate=function(e){this._delay=e},Nr.prototype.updateNodeAttributes=function(e,t){this._hoverClass.update({nodeAttributes:e,fullOverwrite:t}),this._hoverExtremityHighlightedClass.update({nodeAttributes:e,fullOverwrite:t}),this._updateExtremityHighlightLayer()},Nr.prototype.updateEdgeAttributes=function(e,t){this._hoverClass.update({edgeAttributes:e,fullOverwrite:t}),this._updateExtremityHighlightLayer()},Nr.prototype.onMounted=function(e){function t(){n._hoverExtremityHighlightedClass.clearNodes(),n._hoverClass.getEdges().getExtremities().addClass(oc)}var n=this;this._classes.onEdgeClassAdded(Ja,t),this._classes.onEdgeClassRemoved(Ja,t)},Nr.prototype._registerSettings=function(){var e=this;this._settings.register("cursor.node","pointer",function(t,n){e._hovered&&e._hovered.isNode&&(e._graphics.removeCursorStyle(n),e._graphics.addCursorStyle(t))}),this._settings.register("cursor.edge","pointer",function(t,n){e._hovered&&!e._hovered.isNode&&(e._graphics.removeCursorStyle(n),e._graphics.addCursorStyle(t))}),this._settings.register("nodeHover",!0,function(t){!t&&e._hovered&&e._hovered.isNode&&e._unhoverElement(e._hovered)}),this._settings.register("edgeHover",!0,function(t){t||!e._hovered||e._hovered.isNode||e._unhoverElement(e._hovered)})},Nr.prototype._updateExtremityHighlightLayer=function(){var e=this._hoverClass.getDefinition().edgeAttributes;this._hoverExtremityHighlightedClass.update({nodeAttributes:{layer:e?e.layer:void 0},fullOverwrite:!1})},Nr.prototype._removeTimeout=function(){this._timeout&&(this._dom.clearTimeout(this._timeout),this._timeout=null)},Nr.prototype._isAnimating=function(){return this._graphics.isAnimating()},Nr.prototype._hoverElement=function(e){var t=this;this._settings.get(e.isNode?"nodeHover":"edgeHover")&&!this._isAnimating()&&(this._removeTimeout(),this._timeout=this._dom.setTimeout(function(){t._isAnimating()||(t._setElementHighlight(!0,e),t._hovered=e),t._timeout=null},this._delay))},Nr.prototype._unhoverElement=function(e){this._removeTimeout(),this._hovered===e&&(this._setElementHighlight(!1,e),this._hovered=null)},Nr.prototype._setElementHighlight=function(e,t){var n=this._settings.get(t.isNode?"cursor.node":"cursor.edge");e?(this._graphics.addCursorStyle(n),t.addClass(Ja)):(this._graphics.removeCursorStyle(n),t.removeClass(Ja)),t.isNode&&e&&this._graph.getAttribute(t.isNode,"textHidden").set(t._index,!1)},Nr);function Nr(e){var t,n=e.dom,i=e.classes,r=e.captor,o=e.graph,a=e.graphics,s=e.settings,l=e.events,u=um.call(this)||this;return u._delay=100,u._manualTriggerDetection=!1,u._hovered=null,u._timeout=null,u._onAnimate=function(d){d.duration&&(u._manualTriggerDetection=!0,u._resetHover())},u._onBeforeNewFrame=function(){if(u._manualTriggerDetection&&!u._graphics.isAnimating()){u._manualTriggerDetection=!1,u._captor.triggerDetection();var d=u._captor.getPointedElement();d&&u._hoverElement(d)}},u._onClear=function(){u._hovered=null,u._timeout&&u._dom.clearTimeout(u._timeout)},u._resetHover=function(){u._hovered&&(u._unhoverElement(u._hovered),u._captor.triggerUnhover()),u._timeout&&(u._dom.clearTimeout(u._timeout),u._timeout=null)},u._dom=n,u._graph=o,u._graphics=a,u._settings=s,u._captor=r,u._events=l,u._classes=i,u._registerSettings(),u._hoverExtremityHighlightedClass=u._classes.createClass({name:oc,isBuiltin:!0,nodeAttributes:lm}),u._hoverClass=u._classes.createClass({name:Ja,isBuiltin:!0,nodeAttributes:lm,edgeAttributes:iE}),u._events.on(((t={})[I.HOVER]=function(d){return u._hoverElement(d.target)},t[I.UNHOVER]=function(d){return u._unhoverElement(d.target)},t[I.ANIMATE]=u._onAnimate,t[I.BEFORE_NEW_FRAME]=u._onBeforeNewFrame,t[I.MOUSE_LEAVE]=u._resetHover,t[I.CLEAR_GRAPH]=u._onClear,t)),u}var oE=function(){this.x=0,this.y=0},aE=(Lu.prototype.getValue=function(e,t){var n=e.isNode,i=n?this._nodeMapping:this._edgeMapping;i.valid||(i.values=this._computeMapping(n),i.valid=!0);var r=e.getData(this._field);return Array.isArray(r)?"color"===t?r.map(function(o){return i.values[o]}):i.values[r[0]]:i.values[r]},Lu.prototype.markAsInvalid=function(){this._nodeMapping.valid=!1,this._edgeMapping.valid=!1},Lu.prototype.getValues=function(e){return e?this._nodeMapping.values:this._edgeMapping.values},Lu.prototype.getField=function(){return this._field},Lu);function Lu(e,t){this._nodeMapping={valid:!1,values:null},this._edgeMapping={valid:!1,values:null},this._computeMapping=t,this._field=e}function dm(e,t,n){var i=(t?e.getNodes():e.getEdges()).getData(n),r={};return i.forEach(function(o){if(!Array.isArray(o))return r[o]=1;o.forEach(function(a){return r[a]=1})}),"undefined"in r&&delete r[void 0],Object.keys(r).sort()}function sE(e,t,n,i){for(var r=n.values,o=n.fallback,a=dm(e,i,t),s={},l=0,u=0;u<a.length;++u){var d=a[u];d in r?s[d]=r[d]:(s[d]=o[l],l=(l+1)%o.length)}return s}function uE(e,t,n,i){for(var r=n.fallback,o=n.stops,a=n.values,s=n.reverse,l=dm(e,i,t),u=1/0,d=-1/0,c=0;c<l.length;c++)jl(m=+l[c])&&(u=Math.min(u,m),d=Math.max(d,m),l[c]=m);var h={};if(!isFinite(u)){for(c=0;c<l.length;c++)h[l[c]]=r;return h}var p=function(v,y){var E=y.nbSlices,S=y.minValue,w=y.maxValue;if(Array.isArray(v))return v.slice();for(var M=v.min,O=void 0===M?S:M,F=v.max,L=((void 0===F?w:F)-O)/E,N=[],B=1;B<E;++B)N.push(O+L*B);return N}(o,{nbSlices:Array.isArray(a)?a.length:a.nbSlices,minValue:u,maxValue:d}),g=function(v,y){if(Array.isArray(v))return v;for(var E=v.min,w=y.length+1,M=(v.max-E)/y.length,O=[],F=0;F<w;F++)O.push(E+F*M);return O}(a,p);for(s&&g.reverse(),c=0;c<l.length;++c){var m=l[c];if(isFinite(m)){for(var b=0;b<p.length&&p[b]<=m;)b+=1;h[m]=g[b]}else h[m]=r}return h}var cm,lE=(wt(js,cm=Fe),js.prototype.createMapping=function(e){var t=void 0===e?{field:""}:e,n=t.field,i=t.values,r=void 0===i?{}:i,o=t.fallback,a=void 0===o?void 0:o;if(n=Pr(n),Array.isArray(a)?0===a.length&&(a=[void 0]):a=[a],!Qr(r))throw new Error('"mapping" should be an object');return this._createMappingFunction(sE,n,{values:r,fallback:a})},js.prototype.createSlices=function(e){var t=void 0===e?{field:"",values:[]}:e,n=t.field,i=t.fallback,r=void 0===i?void 0:i,o=t.stops,a=void 0===o?{}:o,s=t.values,l=t.reverse,u=void 0!==l&&l;if(n=Pr(n),Array.isArray(s)||s.nbSlices||(s.nbSlices=7),Array.isArray(a)&&Array.isArray(s)&&a.length!==s.length-1)throw new Error("there should be exactly one more value that stops");return this._createMappingFunction(uE,n,{fallback:r,stops:a,values:s,reverse:u})},js.prototype._createMappingFunction=function(e,t,n){var i=this,r=new aE(t,function(a){return e(i._graph,t,n,a)});function o(a,s,l){return r.getValue(a,l)}return this._mappingList.push(r),o.mapping=r,o},js.prototype.createTemplate=function(e){if("string"!=typeof e)throw new TypeError('"template" should be a string');for(var t=[],n=0,i=!1;!i;){var r=-1,o=e.indexOf("{{",n);-1!==o&&(r=e.indexOf("}}",o+2)),-1!==r?(t.push(e.substring(n,o)),t.push(e.substring(o+2,r)),n=r+2):(t.push(e.slice(n)),i=!0)}return function(a){for(var s=t[0],l=1;l<t.length;l+=2)s+=a.getData(t[l]),s+=t[l+1];return s}},js);function js(e){var t,n=e.graph,i=e.events,r=e.styleRules,o=e.legend,a=cm.call(this)||this;return a._mappingList=[],a._graph=n,a._styleRules=r,a._events=i,a._legend=o,a._events.on(((t={})[[I.ADD_NODES,I.ADD_EDGES,I.UPDATE_NODE_DATA,I.UPDATE_EDGE_DATA,I.REMOVE_NODES,I.BEFORE_REMOVE_EDGES,I.EXCLUDED_STATE_CHANGE,I.CLEAR_GRAPH].join(" ")]=function(){if(a._mappingList.length){for(var s=0;s<a._mappingList.length;++s)a._mappingList[s].markAsInvalid();a._styleRules.refreshAllRules(),a._legend.refresh()}},t)),a}var wo,Zs,hm=(Uc.prototype.run=function(e){var t=e.ogma,n=e.duration,i=this._getNodesToFilter(t),r=this._getEdgesToFilter(t,i);return Promise.all([i.addClass(xa,n),r.addClass(xa,n)]).then(function(){return i.setExcluded(!0),r.setExcluded(!0),{nodes:i,edges:r}})},Uc.prototype.undo=function(e){var t=e.duration,n=e.context,i=n.nodes,r=n.edges;return i.setExcluded(!1),r.setExcluded(!1),i.addClass(xa),r.addClass(xa),Promise.all([i.removeClass(xa,t),r.removeClass(xa,t)])},Uc);function Uc(e){var n=e.getEdgesToFilter;this._getNodesToFilter=e.getNodesToFilter,this._getEdgesToFilter=n}(Zs=wo=wo||{}).NodeFilter="node-filter",Zs.EdgeFilter="edge-filter",Zs.NodeCollapsing="node-collapsing",Zs.VirtualProperties="virtual-properties",Zs.NeighborGeneration="neighbor-generation",Zs.NeighborMerging="neighbor-merging";var pm,dE=(wt(jc,pm=hm),jc.prototype.getName=function(){return wo.NodeFilter},jc);function jc(e){return pm.call(this,{getNodesToFilter:function(t){return t.getNodes().filter(function(n){return!e(n)})},getEdgesToFilter:function(t,n){return n.getAdjacentEdges()}})||this}var fm,cE=(wt(Zc,fm=hm),Zc.prototype.getName=function(){return wo.EdgeFilter},Zc);function Zc(e){return fm.call(this,{getNodesToFilter:function(t){return t.createNodeList()},getEdgesToFilter:function(t){return t.getEdges().filter(function(n){return!e(n)})}})||this}function gm(e){return"object"!=typeof e?{criteria:e,enabled:!0,duration:0}:e}var _m,hE=(wt(Kl,_m=Fe),Kl.prototype.addNodeFilter=function(e){var t=gm(e),n=t.criteria,i=Io(t,["criteria"]);return this._transformations.add(new dE(n),i)},Kl.prototype.addEdgeFilter=function(e){var t=gm(e),n=t.criteria,i=Io(t,["criteria"]);return this._transformations.add(new cE(n),i)},Kl);function Kl(e){var t=e.transformations,n=_m.call(this)||this;return n._transformations=t,n}var pE=(mm.prototype.destroy=function(){var e=this;Object.keys(this).forEach(function(t){var n=e[t];n instanceof Fe&&n.destroy(e._ogma)})},mm);function mm(e,t){var n=this;this._ogma=e,"webgl"===gg&&_u.cacheInitData(_u.createInitData()),this.settings=new Wx,this.events=new qx,this.dom=new H(this,t.dimensions),this.animations=new vb(this),this.camera=new jx(this),this.graph=new Py(this,e),this.data=new R(this),this.graphics=new Gx(this,e),this.individualAttributes=new Hx(this),this.algorithms=new wb(this),this.position=new oE,this.touch=new ab(this),this.mouse=new rb(this),this.virtualMouse=new $b(this),this.spatial=new tb(this),this.captor=new A1(this),this.interactions=new m1(this),this.classes=new Xx(this),this.cameraInteractions=new M1(this,!!t.debug),this.hover=new rE(this),this.keyboard=new V1(this),this.selection=new cb(this),this.styleRules=new n1(this),this.legend=new nE(this),this.sync=new hb(this),this.rules=new lE(this),this.transformations=new lb(this,e),this.filters=new hE(this),this.locate=new nb(this),this.grouping=new sb(this),this.pulses=new _b(this),this.drag=new w1(this),this.curvatureManager=new Cb(this),this.tasks=new Db(this),this.layouts=new Ub(this),this.watcher=new Hb(this),this.pathfinding=new Qb(this),this.rectangleSelect=new i1(this),this.labels=new _1(this,t),this.brand=new Sb(this),this.lasso=new A_(this),this.rewiring=new k1(this),this.resizing=new N1(this),this.snapping=new e1(this),this.connectNodes=new F1(this),this.tooltip=new B1(this),this.geo=new Ab(this),e.onReady(function(){Object.keys(n).forEach(function(i){var r=n[i];r instanceof Fe&&r.onMounted(n._ogma,t)})})}var vm=(ym.initNamespace=function(e){var t;e.algorithms=(t=e,{shortestPath:function(n){return t.modules.algorithms.shortestPath(n)},hasCycle:function(n){var i=void 0===n?{}:n;return null!==t.algorithms.detectCycle({nodes:i.nodes,edges:i.edges})},getAllSimpleCycles:function(n){var i=void 0===n?{}:n,r=i.nodes,o=i.edges;return r=r||t.getNodes(),o=o||r.getAdjacentEdges({bothExtremities:!0}),t.modules.algorithms.getAllSimpleCycles(r,o)},detectCycle:function(n){var i=void 0===n?{}:n,r=i.nodes,o=i.edges;return r=r||t.getNodes(),o=o||r.getAdjacentEdges({bothExtremities:!0}),t.modules.algorithms.detectCycle(r,o)}})},ym);function ym(){}var fE=(Fu.prototype.createClass=function(e,t){return this.modules.classes.createClass(Object.assign({},t,{name:e}))},Fu.prototype.updateClass=function(e,t){return this.modules.classes.getClassByName(e,!0).update(t)},Fu.prototype.getNodesByClassName=function(e){return this.modules.classes.getClassByName(e,!0).getNodes()},Fu.prototype.getEdgesByClassName=function(e){return this.modules.classes.getClassByName(e,!0).getEdges()},Fu);function Fu(){}var gE=(Gc.prototype.getHoveredElement=function(){return this.modules.captor.getPointedElement()},Gc.prototype.getPointerInformation=function(){return this.modules.captor.getCursorInformation()},Gc);function Gc(){}var xm=(bm.initNamespace=function(e){var t;e.debug=(t=e,{wait:function(n){return new Promise(function(i){return setTimeout(i,n)})},initRandomGraph:function(n){return t.generate.random(n).then(t.setGraph).then(function(){return t.view.locateGraph()}).then(function(){return t.view.afterNextFrame()})},initGrid:function(n){var i=Math.ceil(Math.sqrt(n));return t.generate.grid({rows:i,columns:i}).then(function(r){return t.setGraph(r)}).then(function(){return t.view.locateGraph()})},initLine:function(n){return t.setGraph({nodes:[{id:0,attributes:{x:0,y:0}},{id:1,attributes:n?{x:0,y:50}:{x:50,y:0}}],edges:[{id:0,source:1,target:0}]}),t.view.locateGraph()},initSingleNode:function(){return t.setGraph({nodes:[{id:0,attributes:{x:0,y:0}}],edges:[]}),t.view.locateGraph()},initContinuousRenderLoop:function(n){var i=void 0===n?{}:n,r=i.triggerKey,o=void 0===r?"r":r,a=i.start,s=void 0===a||a,l=function(){s&&t.modules.dom.beforeNextFrame().then(l)};document.addEventListener("keydown",function(u){u.key===o&&(s=!s,l())}),l()},appendToBody:function(){var n=document.createElement("div");n.style.position="absolute",n.style.top="0",n.style.left="0",n.style.bottom="0",n.style.right="0",document.body.appendChild(n),t.setContainer(n)},loadFile:function(n){return(n.endsWith(".gexf")?t.parse.gexfFromUrl(n):t.parse.jsonFromUrl(n)).then(function(i){return t.setGraph(i)}).then(function(){return t.view.locateGraph()}).then(function(){return t.view.afterNextFrame()})},enableLasso:function(n){t.events.onDragStart(function(){t.keyboard.isKeyPressed("ctrl")&&t.tools.lasso.enable(n)})},randomizeGraph:function(n){var i=void 0===n?{}:n,r=i.minX,o=void 0===r?0:r,a=i.minY,s=void 0===a?0:a,l=i.maxX,u=void 0===l?500:l,d=i.maxY,c=void 0===d?500:d;return t.getNodes().setAttributes(t.getNodes().map(function(){return{x:o+Math.random()*(u-o),y:s+Math.random()*(c-s)}}))}})},bm);function bm(){}var _E=(qc.prototype.setContainer=function(e){this.modules.dom.setContainer(e)},qc.prototype.getContainer=function(){return this.modules.dom.getContainer()},qc);function qc(){}var Em=(Sm.initNamespace=function(e){var t;e.events=(t=e,{removeListener:function(n){t.modules.events.removeListener(n)},onNodesAdded:function(n){return t.modules.events.on(I.ADD_NODES,n),t},onBeforeNodesRemoved:function(n){return t.modules.events.on(I.BEFORE_REMOVE_NODES,n),t},onNodesRemoved:function(n){return t.modules.events.on(I.REMOVE_NODES,n),t},onEdgesAdded:function(n){return t.modules.events.on(I.ADD_EDGES,n),t},onBeforeEdgesRemoved:function(n){return t.modules.events.on(I.BEFORE_REMOVE_EDGES,n),t},onEdgesRemoved:function(n){return t.modules.events.on(I.REMOVE_EDGES,n),t},onNodesClassAdded:function(n,i){return t.modules.classes.onNodeClassAdded(n,i),t},onNodesClassRemoved:function(n,i){return t.modules.classes.onNodeClassRemoved(n,i),t},onEdgesClassAdded:function(n,i){return t.modules.classes.onEdgeClassAdded(n,i),t},onEdgesClassRemoved:function(n,i){return t.modules.classes.onEdgeClassRemoved(n,i),t},onNodeDragStart:function(n){return t.modules.events.on(I.NODES_DRAG_START,n),t},onNodeDragProgress:function(n){return t.modules.events.on(I.NODES_DRAG_PROGRESS,n),t},onNodeDragEnd:function(n){return t.modules.events.on(I.NODES_DRAG_END,n),t},onKeyPress:function(n,i){return t.modules.keyboard.onKeyPress(n,i),t},onNodesSelected:function(n){return t.events.onNodesClassAdded(xi,n)},onNodesUnselected:function(n){return t.events.onNodesClassRemoved(xi,n)},onEdgesSelected:function(n){return t.events.onEdgesClassAdded(xi,n)},onEdgesUnselected:function(n){return t.events.onEdgesClassRemoved(xi,n)},onNodeDataChange:function(n){return t.modules.events.on(I.UPDATE_NODE_DATA,n),t},onEdgeDataChange:function(n){return t.modules.events.on(I.UPDATE_EDGE_DATA,n),t},onMouseMove:function(n){return t.modules.events.on(I.MOVE,n),t},onMouseButtonDown:function(n){return t.modules.events.on(I.DOWN,n),t},onMouseButtonUp:function(n){return t.modules.events.on(I.UP,n),t},onClick:function(n){return t.modules.events.on(I.CLICK,n),t},onDoubleClick:function(n){return t.modules.events.on(I.DOUBLE_CLICK,n),t},onMouseWheel:function(n){return t.modules.events.on(I.WHEEL,n),t},onHover:function(n){return t.modules.events.on(I.HOVER,n),t},onUnhover:function(n){return t.modules.events.on(I.UNHOVER,n),t},onDragStart:function(n){return t.modules.events.on(I.DRAG_START,n),t},onDragProgress:function(n){return t.modules.events.on(I.DRAG_PROGRESS,n),t},onDragEnd:function(n){return t.modules.events.on(I.DRAG_END,n),t},onGestureStart:function(n){return t.modules.events.on(I.GESTURE_START,n),t},onGestureProgress:function(n){return t.modules.events.on(I.GESTURE_PROGRESS,n),t},onGestureEnd:function(n){return t.modules.events.on(I.GESTURE_END,n),t},onRendererStateChange:function(n){return t.modules.events.on(I.RENDERER_STATE_CHANGE,n),t},onZoomProgress:function(n){return t.modules.events.on(I.CAMERA_ZOOM,n),t},onViewChanged:function(n){return t.modules.events.on(I.VIEW_CHANGED,n),t},onNodesConnected:function(n){return t.modules.events.on(I.CONNECT_NODES,n),t},onGeoModeEnabled:function(n){return t.modules.events.on(I.GEO_ENABLED,n),t},onGeoModeDisabled:function(n){return t.modules.events.on(I.GEO_DISABLED,n),t},onGeoModeLoaded:function(n){return t.modules.events.on(I.GEO_LOADED,n),t},onLayoutStart:function(n){return t.modules.events.on(I.LAYOUT_START,n),t},onLayoutComplete:function(n){return t.modules.events.on(I.LAYOUT_END,n),t},onLayoutComputed:function(n){return t.modules.events.on(I.LAYOUT_COMPUTED,n),t},onTooltipShown:function(n){return t.modules.events.on(I.TOOLTIP_SHOW,n),t},onTooltipHidden:function(n){return t.modules.events.on(I.TOOLTIP_HIDE,n),t}})},Sm);function Sm(){}function Am(e){return e instanceof mo?e.getId():e}function wm(e){return e instanceof na?e.getId():e}function Cm(e){return e instanceof ar?e.getId():e instanceof mo?[e.getId()]:li(e)?e.map(Am):[Am(e)]}function Tm(e){return e instanceof vs?e.getId():e instanceof na?[e.getId()]:li(e)?e.map(wm):[wm(e)]}function Gs(e,t,n){if(null!=e)return Array.isArray(e)?e[0]:"source"===e?Gs(n.color.get(t.getSource()._index)):"target"===e?Gs(n.color.get(t.getTarget()._index)):e}function Hc(e){return null==e?null:"string"==typeof e||"number"==typeof e?""+e:e&&Hc(e.content)}var mE=["color","radius","shape","text.content","x","y"],vE=["color","width","shape.type","text.content"];function Mm(e,t,n,i){var r,o,a,s,l=(o=i,(r=t)?Cm(r):"object"==typeof o?Cm(o.nodes):o),u=(s=i,(a=n)?Tm(a):"object"==typeof s?Tm(s.edges):s);return{nodes:e.getNodes(l),edges:e.getEdges(u)}}function Im(e,t){var n=t.nodeAttributes,i=t.edgeAttributes,s=t.nodeData,l=t.edgeData,u=Mm(e,t.nodes,t.edges,t.filter);return{nodes:u.nodes.toJSON({attributes:n,data:s}),edges:u.edges.toJSON({attributes:i,data:l})}}function $l(e,t,n){var i,r,o,a,s,l=n.styles,u=n.nodes,d=n.edges,c=n.filter,g="all"!==l?{nodes:["x","y"],edges:[]}:{nodes:mE,edges:vE},m=Im(e,{nodeAttributes:g.nodes,edgeAttributes:g.edges,nodes:u,edges:d,filter:c,nodeData:n.nodeData,edgeData:n.edgeData});if("original"===l){for(var b=(i=t,o=(r=Mm(e,u,d,c)).nodes,a=r.edges,s=i.getOriginalAttributes(),{nodes:o.reduce(function(O,F){return O[F.getId()]={x:s.nodes.x.get(F._index),y:s.nodes.y.get(F._index),color:Gs(s.nodes.color.get(F._index)),radius:s.nodes.radius.get(F._index),shape:s.nodes.shape.get(F._index),text:{content:s.nodes.text.content.get(F._index)}},O},{}),edges:a.reduce(function(O,F){return O[F.getId()]={color:Gs(s.edges.color.get(F._index)),width:s.edges.width.get(F._index),shape:{type:s.edges.shape.type.get(F._index)},text:{content:s.edges.text.content.get(F._index)}},O},{})}),v=0,y=m.nodes;v<y.length;v++){var E=y[v];E.attributes=b[E.id]}for(var S=0,w=m.edges;S<w.length;S++){var M=w[S];M.attributes=b[M.id]}}return"all"===l&&m.edges.forEach(function(O){var L=O.target,N=O.attributes;"source"===N.color&&(N.color=e.getNode(O.source).getAttribute("color")),"target"===N.color&&(N.color=e.getNode(L).getAttribute("color"))}),function(e){return{nodes:e.nodes.map(function(t){var i=t.attributes,r=void 0===i?{}:i,o=t.data,s=r.radius,l=r.shape,u=r.text;return{id:t.id,x:r.x,y:r.y,color:Gs(r.color),size:s,shape:l,text:Hc(u),data:o}}),edges:e.edges.map(function(t){var o=t.attributes,a=void 0===o?{}:o,s=t.data,u=a.width,d=a.text,c=a.shape;return{id:t.id,source:t.source,target:t.target,color:Gs(a.color),size:u,shape:function(h){if(null!=h)return"string"==typeof h?h:h.type}(c),text:Hc(d),data:s}})}}(m)}function km(e,t){return null==e||Array.isArray(e)&&!e.length?t:e}function xE(e){return"string"==typeof e}function bE(e,t,n,i){for(var r="edges"===t,o={},a=function(u){var d=f(km(n(u),t));if(!d.every(xE))throw Error("The tab "+t+" function returned an invalid value.");var c=f(i(u.data,d));d.forEach(function(h,p){var g=km(c[p],{}),m=rl(Nt({},g,{id:u.id},r?{source:u.source,target:u.target}:{})).reduce(function(b,v){var E=v.value;return b[v.path.join(".")]=E,b},{});o[h]=o[h]||[],o[h].push(m)})},s=0,l=e;s<l.length;s++)a(l[s]);return o}function EE(e){if(!e.length)return[];for(var t=function(l){for(var u=Nt({},l[0]),d=0,c=l;d<c.length;d++)for(var p=0,g=Object.keys(c[d]);p<g.length;p++){var m=g[p];m in u||(u[m]=void 0)}return Object.keys(u)}(e),n=-1<t.indexOf("source")?["id","source","target"]:["id"],i=n.concat(t.filter(function(l){return-1===n.indexOf(l)})),r=[i],o=function(l){r.push(i.map(function(u){return l[u]}))},a=0,s=e;a<s.length;a++)o(s[a]);return r}function AE(e){return{csv:function(t){var n=ln("string"==typeof t?{what:t}:t,wE),i=n.what,r=n.dataProperties,s=n.separator,l=n.textSeparator,u=n.download,h=n.filename,g=$l(e.modules.graph,e.modules.individualAttributes,{styles:"none",nodes:n.nodes,edges:n.edges,filter:n.filter,nodeData:n.nodeData,edgeData:n.edgeData});try{var m=function(b,v){var y=v.what,E=v.separator,S=v.textSeparator,w=v.dataProperties,M=new RegExp(""+S,"g");if(S&&'"'!==S&&"'"!==S)throw new TypeError('Invalid argument :"textSeparator" is not single-quote or double-quote, was '+S);if("nodes"!==y&&"edges"!==y)throw new TypeError('missing argument: "what": should have value "nodes" or "edges"');var F="nodes"===y;return function(e,t,n){for(var i=new Ap,r=t?1:3,o=[],a=function(u){var d=e[u],c=new Array(r),h=d.data;if(n){var p={};n.forEach(function(E){var S=Pr(E),w=function(M,O){for(var F=0;F<O.length;++F){if(null==M)return;M=M[O[F]]}return M}(h,S);!function(M,O,F){for(var L=0;L<O.length-1;++L){var N=O[L],B=M[N];void 0===B&&(M[N]=B={}),M=B}M[O[O.length-1]]=F}(p,S,w)}),h=p}var g=rl(h);c[0]=d.id,t||(c[1]=d.source,c[2]=d.target);for(var m=0;m<g.length;++m){var b=g[m],v=b.path,y=b.value;v.length&&(i.has(v)?c[i.get(v)]=y:(i.set(v,r),c[r]=y,r++))}o.push(c)},s=0;s<e.length;++s)a(s);var l=[];return l.push("id"),t||(l.push("source"),l.push("target")),i.keys().forEach(function(u){return l.push(u[u.length-1])}),o.unshift(l),o.forEach(function(u){return u.length=r}),o}(F?b.nodes:b.edges,F,w).map(function(L){return L.map(function(N){return function(L){return L=(N=L)instanceof Date?N.toISOString():""+N,S+L.replace(M,"\\$&")+S;var N}(N)})}).map(function(L){return L.join(E)}).join("\n")}(g,{what:i,separator:s,textSeparator:l,dataProperties:r});return u&&hn(m,h,"text"),Promise.resolve(m)}catch(b){return Promise.reject(b)}}}}var wE={what:void 0,dataProperties:void 0,separator:",",textSeparator:'"',download:!0,filename:"graph.csv",filter:"visible",nodes:void 0,edges:void 0,nodeData:function(e){return e},edgeData:function(e){return e},styles:"none"};var TE={creator:void 0,description:void 0,styles:"all",download:!0,filename:"graph.gexf",nodes:void 0,edges:void 0,nodeData:function(e){return e},edgeData:function(e){return e},filter:"visible"};function qs(e){return Math.round(255*e)}function Om(e,t){if("integer"===t&&"number"==typeof e){if(e%1!=0)return"float"}else if("number"!=typeof e)return"boolean"==typeof e?"boolean":"string";return t}function Wc(e){return"object"==typeof e&&null!==e&&e.constructor===Object}function Yc(e,t){return void 0===t&&(t={}),vt(e,function(n,i){Wc(n)?Yc(n,t):t[i]=n}),t}function ME(e){return{graphml:function(t){void 0===t&&(t={});var n=ln(t,IE),i=n.styles,a=n.download,s=n.filename,l=n.graphId,u=n.directedEdges,p=function(g,m){var b=new ou,v=Lp();function y(J){return b.toHexa(J)}function S(J,ae,ie,U,Y){ie=ie||{};var he=v.createElement(ae);for(var pe in ie)if(ie.hasOwnProperty(pe)){var we=ie[pe];void 0!==we&&he.setAttribute(pe,we)}return void 0===U&&!Y||("[object Object]"===Object.prototype.toString.call(U)&&(U=JSON.stringify(U)),he.appendChild(v.createTextNode(U))),J.appendChild(he),he}var w=["id","source","target"],M=["size","x","y","shape","text","color"],O={size:{for:"all",type:"double"},x:{for:"node",type:"double"},y:{for:"node",type:"double"},shape:{for:"all",type:"string"},color:{for:"all",type:"string"},r:{for:"all",type:"int"},g:{for:"all",type:"int"},b:{for:"all",type:"int"},a:{for:"all",type:"double"},text:{for:"all",type:"string"}};m.noStyles&&(delete O.color,delete O.r,delete O.g,delete O.b,delete O.a,delete O.shape,M.pop());var F=[],L=[];function N(J,ae){var ie={id:J.id};M.forEach(function(U){var Y=J[U];"y"===U&&Y&&(Y=-parseFloat(Y)),void 0!==Y&&(ie[("edge"===ae?"edge_":"")+U]=Y,"color"===U&&function(J,ae){var U=b.parseColor(ae);J.r=U[0],J.g=U[1],J.b=U[2]}(ie,Y))}),vt(J.data||{},function(U,Y){-1===M.indexOf(Y)&&-1===w.indexOf(Y)&&(O[Y]?O[Y].for!==ae&&(O[Y].for="all"):O[Y]={for:ae,type:"string"},ie[Y]=U)}),"edge"===ae?(ie.source=J.source,ie.target=J.target,L.push(ie)):F.push(ie)}g.nodes.forEach(function(J){return N(J,"node")}),g.edges.forEach(function(J){return N(J,"edge")});var B=S(v,"graphml",{xmlns:"http://graphml.graphdrawing.org/xmlns","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xsi:schemaLocation":"http://graphml.graphdrawing.org/xmlns http://www.yworks.com/xml/schema/graphml/1.1/ygraphml.xsd","xmlns:y":"http://www.yworks.com/xml/graphml","xmlns:java":"http://www.yworks.com/xml/yfiles-common/1.0/java","xmlns:sys":"http://www.yworks.com/xml/yfiles-common/markup/primitives/2.0","xmlns:x":"http://ww.yworks.com/xml/yfiles-common/markup/2.0"});vt(O,function(J,ae){"node"!==J.for&&"all"!==J.for||S(B,"key",{"attr.name":ae,"attr.type":J.type,for:"node",id:ae}),"edge"!==J.for&&"all"!==J.for||S(B,"key",{"attr.name":ae,"attr.type":J.type,for:"edge",id:"edge_"+ae})}),S(B,"key",{id:"nodegraphics",for:"node","yfiles.type":"nodegraphics","attr.type":"string"}),S(B,"key",{id:"edgegraphics",for:"edge","yfiles.type":"edgegraphics","attr.type":"string"});var X=S(B,"graph",{edgedefault:m.directedEdges||void 0===m.directedEdges?"directed":"undirected",id:m.graphId?m.graphId:"G","parse.nodes":g.nodes.length,"parse.edges":g.edges.length,"parse.order":"nodesfirst"});return F.forEach(function(J){var U,Y,he,ae=S(X,"node",{id:J.id});U=J,Y=S(ae,"data",{key:"nodegraphics"}),he=S(Y,"y:ShapeNode"),S(he,"y:Geometry",{x:U.x,y:U.y,width:U.size,height:U.size}),m.noStyles||S(he,"y:Fill",{color:y(U.color),transparent:!1}),S(he,"y:NodeLabel",null,U.text||""),S(he,"y:Shape",{type:U.shape}),vt(J,function(ie,U){-1===w.indexOf(U)&&S(ae,"data",{key:U},ie,!0)})}),L.forEach(function(J){var ae,ie,U,Y=S(X,"edge",{id:J.id,source:J.source,target:J.target});ae=J,ie=S(Y,"data",{key:"edgegraphics"}),U=S(ie,"y:PolyLineEdge"),S(U,"y:LineStyle",{type:ae.edge_type,color:m.noStyles?void 0:y(ae.edge_color),width:ae.edge_size}),S(U,"y:EdgeLabel",null,ae.edge_label),vt(J,function(he,pe){-1===w.indexOf(pe)&&S(Y,"data",{key:pe},he,!0)})}),'<?xml version="1.0" encoding="UTF-8"?>\n'+Pd(v)}($l(e.modules.graph,e.modules.individualAttributes,{styles:i,nodes:n.nodes,edges:n.edges,filter:n.filter,nodeData:n.nodeData,edgeData:n.edgeData}),{graphId:l,directedEdges:u,noStyles:"none"===i});return a&&hn(p,s,"text"),Promise.resolve(p)}}}var IE={graphId:"G",directedEdges:!0,styles:"all",download:!0,filename:"graph.graphml",nodes:void 0,edges:void 0,nodeData:function(e){return e},edgeData:function(e){return e},filter:"visible"},kE={nodeAttributes:["x","y","color","radius","shape","text"],edgeAttributes:["color","width","text"],nodeData:function(e){return e},edgeData:function(e){return e},filter:"visible",pretty:!1,download:!0,filename:"graph.json"};function Nm(e,t){var n=e.view.get(),i="number"==typeof t.margin?t.margin:0,r={pixelRatio:1,angle:0,backgroundColor:null,zoom:0,x:0,y:0,width:0,height:0,hideImages:!1};if(t.width&&t.height?(r.width=t.width,r.height=t.height):(r.width=n.width,r.height=n.height),t.clip)r.zoom=n.zoom,r.x=n.x,r.y=n.y;else{var o=e.getNodes(t.filter),a=o.getBoundingBox().computeForZoom(n.zoom).extend(Cr.fromValues(o.getAttribute("x"),o.getAttribute("y"),o.map(function(p){return p.getAttribute("radius")+p.getAttribute("innerStroke.width")+p.getAttribute("outerStroke.width")})));if(t.texts){var s=e.modules.labels.getTextsBoundingBox();s.isValid()&&a.extend(s)}if(!isFinite(t.width)||!isFinite(t.height)){var l=e.view.graphToScreenCoordinates(a.bottomLeft()),u=e.view.graphToScreenCoordinates(a.topRight()),d=u.x-l.x,c=u.y-l.y,h=Math.min(r.width/d,r.height/c);r.width=d*h,r.height=c*h}r.x=a.cx,r.y=a.cy,r.width=Math.max(r.width,2*i+1),r.height=Math.max(r.height,2*i+1),r.zoom=Math.min((r.width-2*i)/a.width,(r.height-2*i)/a.height)}return e.modules.geo.isEnabled()?r.backgroundColor=null:void 0!==t.background&&(r.backgroundColor=t.background),r}function Xc(e,t,n,i,r){void 0===r&&(r=!1);var o=Nt({},n,{renderBackground:!1,hideImages:r,angle:n.angle||0,isBufferDisplayable:function(l){return t.texts||!Df(l)}}),a={};if(!1===t.badges){var s={text:null,image:null};a.badges={topLeft:s,topRight:s,bottomRight:s,bottomLeft:s}}return e.styles.getClass(Qa).update({nodeAttributes:a}),e.modules.graphics.export(i,o,t.filter,t)}function ed(e){return{download:!0,filter:"visible",filename:"graph."+e,clip:!1,margin:10,width:void 0,height:void 0,background:null,badges:!0,legend:void 0,texts:!0,images:!0,textWatermark:{content:null,fontFamily:"Arial",fontSize:48,fontStyle:null,fontColor:"red",repeat:!1,angle:0,alpha:.65,space:50,x:void 0,y:void 0},imageWatermark:{url:null,width:void 0,height:void 0,repeat:!1,angle:0,alpha:.65,space:50,x:void 0,y:void 0},imageCrossOrigin:void 0}}var OE={png:ed("png"),jpg:ed("jpg"),tiff:ed("tiff"),gif:ed("gif")};function NE(e){var t=e.canvas,n=e.parameters;return n.textWatermark.content&&Fm(t,n.textWatermark,RE,zE),n.imageWatermark.url?_s(n.imageWatermark.url).then(function(i){return i&&(n.imageWatermark.content=i,Fm(t,n.imageWatermark,VE,BE)),e}):e}function LE(e){var n=e.canvas,i=e.parameters,r=e.ogma.modules.legend,o=null;return void 0===i.legend&&(o=!!r.enabled()&&r.getCurrentOptions()),!0===i.legend&&(o={}),o&&r.exportOnCanvas(n,o),e}function FE(e){var t=e.ogma,n=e.view;return t.modules.geo.isEnabled()?t.modules.geo.exportBackground(n).then(function(i){var r=Lm(e.view),o=r.getContext("2d");return o.drawImage(i,(n.width-i.width)/2,(n.height-i.height)/2),o.drawImage(e.canvas,0,0),e.canvas=r,e}):e}function PE(e){var t=e.ogma,n=e.parameters,r=e.view,o=e.canvas.getContext("2d");return Xc(t,n,r,"canvas",!n.images).then(function(a){try{return a.getContext("2d").getImageData(0,0,1,1),o.drawImage(a,0,0),e}catch(s){return eo(s),Xc(t,n,r,"canvas",!0).then(function(l){return o.drawImage(l,0,0),e})}})}function DE(e){var n=e.parameters,r=e.canvas.toDataURL("image/"+e.type);return n.download&&hn(r,n.filename,"dataURL"),r}function Lm(e){var t=e.width,n=e.height,i=ci();return i.width=t,i.height=n,i}function td(e,t,n){null===(t=ln(t,OE[n])).background&&(t.background=e.modules.graphics.getTransparentBackgroundColor());var i=Nm(e,t),r={ogma:e,parameters:t,canvas:Lm(i),view:i,type:n};return Promise.resolve(r).then(FE).then(PE).then(NE).then(LE).then(DE)}function RE(e,t,n,i){e.textAlign="center",e.textBaseline="middle",e.fillText(t,n,i)}function zE(e,t,n){return{width:e.measureText(t).width,height:n}}function BE(e,t,n,i,r){return{width:void 0===i?t.width:i,height:void 0===r?t.height:r}}function VE(e,t,n,i,r,o){e.drawImage(t,n-r/2,i-o/2,r,o)}function Fm(e,t,n,i){if(t){if("object"!=typeof t)t={content:t};else if(!t.content)return;var r=t.fontFamily,o=t.fontSize,a=t.fontStyle,s=t.fontColor,l=t.repeat,u=t.angle,d=t.alpha,c=t.space,h=t.content,p=e.getContext("2d"),g=e.width,m=e.height,b=void 0===t.x?g/2:t.x,v=void 0===t.y?m/2:t.y,y=t.height,E=t.width;u=u/180*Math.PI,da(p,r,o,a),p.fillStyle=s,p.globalAlpha=d;var S=i(p,h,o,E,y);if(l){var w=S.width+c,M=S.height+c,O=Math.sqrt(g*g+m*m);p.save(),p.translate(0,0),p.rotate(u);for(var F=0;F<O;F+=w)for(var L=0;L<O;L+=M)n(p,h,F,L,S.width,S.height),0!==L&&n(p,h,F,-L,S.width,S.height);p.restore()}else p.save(),p.translate(b,v),p.rotate(u),n(p,h,0,0,S.width,S.height),p.restore()}}var jE={download:!0,filename:"graph.svg",width:void 0,height:void 0,background:null,texts:!0,images:!0,badges:!0,embedFonts:!1,clip:!1,margin:10,prefix:"ogma"};var GE={what:void 0,dataProperties:void 0,filter:"visible",nodes:void 0,edges:void 0,download:!0,filename:"graph.xlsx",tab:void 0,nodeData:void 0,edgeData:void 0};function qE(e,t){for(var n,i={},r={s:{c:1e7,r:1e7},e:{c:0,r:0}},o=0;o!==t.length;++o)for(var a=t[o],s=0;s!==a.length;++s){var l=a[s];r.s.r>o&&(r.s.r=o),r.s.c>s&&(r.s.c=s),r.e.r<o&&(r.e.r=o),r.e.c<s&&(r.e.c=s);var u={v:void 0===(n=l)?"":n instanceof Date?n.toISOString():""+n};i[e.utils.encode_cell({c:s,r:o})]=u}return r.s.c<1e7&&(i["!ref"]=e.utils.encode_range(r)),i}var HE=function(){this.SheetNames=[],this.Sheets={}};function WE(e){return e.styles.createClass({name:Qa,isBuiltin:!0}),Nt({},AE(e),function(e){return{gexf:function(t){void 0===t&&(t={});var n=ln(t,TE),a=n.download,s=n.filename,l=n.creator,u=n.description,p=function(g,m){var b,v=new ou,y=Np(),E={},S={},w=0,M=0,O=y.createElement("gexf");O.setAttribute("xmlns","http://www.gexf.net/1.2draft"),O.setAttribute("xmlns:viz","http://www.gexf.net/1.2draft/viz"),O.setAttribute("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance"),O.setAttribute("xsi:schemaLocation","http://www.gexf.net/1.2draft http://www.gexf.net/1.2draft/gexf.xsd"),O.setAttribute("version","1.2");var F=y.createElement("meta");if(F.setAttribute("lastmodifieddate",V()),m.creator){var L=y.createElement("creator");b=y.createTextNode(""+m.creator),L.appendChild(b),F.appendChild(L)}if(m.description){var N=y.createElement("description");b=y.createTextNode(""+m.description),N.appendChild(b),F.appendChild(N)}var B=y.createElement("graph");B.setAttribute("mode","static");var X=y.createElement("nodes");g.nodes.forEach(function(U){var Y=y.createElement("node");if(Y.setAttribute("id",String(U.id)),U.text&&Y.setAttribute("label",_r(U.text)),Wc(U.data)){var he=Yc(U.data),pe=y.createElement("attvalues");Object.keys(he).forEach(function(Xe){Xe in E||(E[Xe]={id:w,type:"integer"},w++);var xt=he[Xe];E[Xe].type=Om(xt,E[Xe].type);var It=y.createElement("attvalue");It.setAttribute("for",E[Xe].id),It.setAttribute("value",_r(xt)),pe.appendChild(It)}),Y.appendChild(pe)}if(U.color){var we=v.parseColor(U.color),ke=y.createElement("viz:color");ke.setAttribute("r",qs(we[0])),ke.setAttribute("g",qs(we[1])),ke.setAttribute("b",qs(we[2])),ke.setAttribute("a",we[3]),Y.appendChild(ke)}var at=y.createElement("viz:position");if(at.setAttribute("x",U.x),at.setAttribute("y",-U.y),Y.appendChild(at),U.size){var st=y.createElement("viz:size");st.setAttribute("value",U.size),Y.appendChild(st)}X.appendChild(Y)});var J=y.createElement("attributes");J.setAttribute("class","node"),Object.keys(E).forEach(function(U){var Y=y.createElement("attribute");Y.setAttribute("id",E[U].id),Y.setAttribute("title",U),Y.setAttribute("type",E[U].type),J.appendChild(Y)});var ae=y.createElement("edges");g.edges.forEach(function(U){var Y=y.createElement("edge");if(Y.setAttribute("id",U.id.toString()),Y.setAttribute("source",U.source),Y.setAttribute("target",U.target),U.size&&Y.setAttribute("weight",U.size),U.text&&Y.setAttribute("label",_r(U.text)),Wc(U.data)){var he=Yc(U.data),pe=y.createElement("attvalues");Object.keys(he).forEach(function(st){st in S||(S[st]={id:M,type:"integer"},M++);var Xe=he[st];S[st].type=Om(Xe,S[st].type);var xt=y.createElement("attvalue");xt.setAttribute("for",S[st].id),xt.setAttribute("value",_r(Xe)),pe.appendChild(xt)}),Y.appendChild(pe)}if(U.color){var we=v.parseColor(U.color),ke=y.createElement("viz:color");ke.setAttribute("r",qs(we[0])),ke.setAttribute("g",qs(we[1])),ke.setAttribute("b",qs(we[2])),ke.setAttribute("a",we[3]),Y.appendChild(ke)}if(U.size){var at=y.createElement("viz:size");at.setAttribute("value",U.size),Y.appendChild(at)}ae.appendChild(Y)});var ie=y.createElement("attributes");return ie.setAttribute("class","edge"),Object.keys(S).forEach(function(U){var Y=y.createElement("attribute");Y.setAttribute("id",S[U].id),Y.setAttribute("title",U),Y.setAttribute("type",S[U].type),ie.appendChild(Y)}),B.appendChild(J),B.appendChild(ie),B.appendChild(X),B.appendChild(ae),O.appendChild(F),O.appendChild(B),y.appendChild(O),'<?xml version="1.0" encoding="UTF-8"?>'+y.serialize()}($l(e.modules.graph,e.modules.individualAttributes,{styles:n.styles,nodes:n.nodes,edges:n.edges,filter:n.filter,nodeData:n.nodeData,edgeData:n.edgeData}),{creator:l,description:u});return a&&hn(p,s,"text"),Promise.resolve(p)}}}(e),ME(e),{json:function(i){void 0===i&&(i={});var r=ln(i,kE),d=r.pretty,c=r.download,h=r.filename,p=Im(n.modules.graph,{nodeAttributes:r.nodeAttributes,edgeAttributes:r.edgeAttributes,filter:r.filter,nodeData:r.nodeData,edgeData:r.edgeData}),g=d?JSON.stringify(p,null," "):JSON.stringify(p);return c&&hn(g,h,"text"),Promise.resolve(g)}},{png:function(i){return void 0===i&&(i={}),td(t,i,"png")},jpg:function(i){return void 0===i&&(i={}),td(t,i,"jpg")},tiff:function(i){return void 0===i&&(i={}),td(t,i,"tiff")},gif:function(i){return void 0===i&&(i={}),td(t,i,"gif")}},function(e){return{svg:function(t){return void 0===t&&(t={}),function(n,i){var r=(i=ln(i,jE)).background,o=i.filename,a=i.download;null===r&&(i.background=n.modules.graphics.getTransparentBackgroundColor());var l=Nm(n,i);return Xc(n,i,l,"svg",!i.images).then(function(u){return u.removeAttribute("pointer-events"),u.setAttribute("version","1.1"),u.setAttributeNS(On,"xmlns",ta),u.setAttributeNS(On,"xmlns:xlink",dt),u}).then(function(u){return function(d,c,h){for(var p=c.childNodes[2],g=p.childNodes,m={},b=h.prefix,v=0;v<g.length;v++){var y=(U=g[v]).getAttribute(no);m[y]=m[y]||[],m[y].push(U)}var E=Object.keys(m),S=d.modules.graph,w=S.getNodeAttribute("id"),M=S.getEdgeAttribute("id"),O=gn("g",{class:b+"-edges"}),F=gn("g",{class:b+"-nodes"});for(v=0;v<E.length;v++){var L=E[v],N="n"===L.charAt(0),B=parseInt(L.substring(1)),X=m[L],J=_r((N?w:M).get(B).toString()),ae=gn("g");ae.setAttribute("data-"+(N?"node":"edge")+"-id",J),ae.setAttribute("class",b+"-"+(N?"node":"edge"));for(var ie=0;ie<X.length;ie++){var U=X[ie];ae.appendChild(U),U.removeAttribute(no)}(N?F:O).appendChild(ae)}return p.appendChild(O),p.appendChild(F),c}(n,u,i)}).then(function(u){return c=i,h=function(p){for(var g=[].concat(Array.prototype.slice.call(p.getElementsByTagName("text")||[]),Array.prototype.slice.call(p.getElementsByTagName("tspan")||[])),m=[],b={},v=0;v<g.length;v++){var y=g[v].getAttribute("font-family");if("string"==typeof y)for(var E=y.split(","),S=0;S<E.length;S++){var w=E[S].replace(/['"]/g,"");""===w||b[w]||(b[w]=!0,m.push(w))}}return{list:m,map:b}}(d=u).map,xp().then(function(p){return p.filter(function(g){return h[g.name]})}).then(function(p){return bp(p,!!c.embedFonts)}).then(function(p){if(0!==p.length){for(var g=gn("style"),m=0;m<p.length;m++)g.appendChild(Ti(p[m]));d.childNodes[0].appendChild(g)}return d});var d,c,h}).then(function(u){var d='<?xml version="1.0" encoding="utf-8"?>'+Pd(u);return a&&hn(d,o,"text/xml"),d})}(e,t)}}}(t=n=e),function(e){return{xlsx:function(t){"string"==typeof t&&(t={what:t});var n=ln(t,GE),i=n.what,r=n.nodes,o=n.edges,a=n.tab,s=void 0===a?{nodes:void 0,edges:void 0}:a,l=n.download,u=n.filename,d=n.dataProperties,c=n.filter,h=n.nodeData,p=n.edgeData;s.nodes||(s.nodes=function(){return"nodes"}),s.edges||(s.edges=function(){return"edges"});var g=function(m,b){var v=b.what,y=b.tabFunctions,E=b.tabContentFunctions,S=bi("XLSX")||bi("xlsx",{throwOnError:!0}),w=new HE;if(v){if("nodes"!==v&&"edges"!==v)throw new TypeError('Invalid argument: "what" is not "nodes" or "edges", was '+v);"nodes"===v&&(m.edges=[]),"edges"===v&&(m.nodes=[])}for(var M={},O=0,F=["nodes","edges"];O<F.length;O++)for(var L=F[O],N=bE(m[L],L,y[L],E[L]),B=0,X=Object.keys(N);B<X.length;B++){var J=X[B];M[J]=(M[J]||[]).concat(N[J])}for(var ae=0,ie=Object.keys(M);ae<ie.length;ae++)w.SheetNames.push(J=ie[ae]),w.Sheets[J]=qE(S,EE(M[J]));return gr([function(U){for(var Y=new ArrayBuffer(U.length),he=new Uint8Array(Y),pe=0;pe!==U.length;++pe)he[pe]=255&U.charCodeAt(pe);return Y}(S.write(w,{bookType:"xlsx",bookSST:!1,type:"binary"}))])}($l(e.modules.graph,e.modules.individualAttributes,{styles:"none",nodes:r,edges:o,filter:c,nodeData:function(m){return m},edgeData:function(m){return m}}),{what:i,tabFunctions:s,tabContentFunctions:{nodes:h||function(m){return Ra(Ht(m||{}),d)},edges:p||function(m){return Ra(Ht(m||{}),d)}}});return l&&hn(g,u,"blob"),Promise.resolve(g)}}}(e));var t,n}var Pm=(Dm.initNamespace=function(e){e.export=WE(e)},Dm);function Dm(){}var Rm_configure=function(e){var t,n=void 0===e?{}:e,i=n.children,r=void 0===i?2:i,o=n.height,a=void 0===o?3:o;if(!("number"==typeof(t=r)&&isFinite(t)&&0<t?t:void 0))throw new TypeError('Invalid argument: "children" is not a positive number, was '+r);if(!Zn(a))throw new TypeError('Invalid argument: "height" is not a positive number, was '+a);return{children:r,height:a}},Rm_generate=function(e){var t=e.children,n=e.height;n+=1;for(var i=Math.pow(t,n),r=[],o=[],a=1,s=0,l=0,u=0;u<n;++u){for(var d=i/(a+1)/1.5,c=0;c<a;++c){var h=s++;if(r.push({id:h,attributes:{x:(c+1)*d*10,y:20*u}}),u!==n-1)for(var p=0;p<t;++p)o.push({id:l,source:h,target:h*t+p+1}),l+=1}a*=t}return{nodes:r,edges:o}},zm_configure=function(e){var t=void 0===e?{}:e,n=t.nodes,i=void 0===n?40:n,r=t.m0,o=void 0===r?5:r,a=t.m,s=void 0===a?1:a,l=t.scale,u=void 0===l?100:l;if(!ma(i)||i<3)throw new TypeError("Invalid argument: options.nodes is not a number >= 3, was "+i);if(!ma(o)||i<=o)throw new TypeError("Invalid argument: options.m0 is not a number < "+i+", was "+o);if(!ma(o)||o<=s)throw new TypeError("Invalid argument: options.m is not a number <= "+o+", was "+s);if(!ma(u)||u<0)throw new TypeError("Invalid argument: options.scale is not a number or is less than 0");return{nodes:i,m0:o,m:s,scale:u}},zm_generate=function(e){for(var t=e.scale,n=e.nodes,i=e.m0,r=e.m,o={nodes:[],edges:[]},a={},s=[],l=t/10,u=0,d=0;d<i;d++)o.nodes.push({id:d,attributes:{x:Math.random()*l,y:Math.random()*l}}),s[d]=0;for(d=0;d<i;d++)for(var c=d+1;c<i;c++)a[(v={id:u++,source:d,target:c}).source+"-"+v.target]=v,o.edges.push(v),s[d]++,s[c]++;for(d=i;d<n;d++){o.nodes.push({id:d,attributes:{x:Math.random()*t,y:Math.random()*t}});var h=s[d]=0;for(c=0;c<d;c++)h+=s[c];for(var p=0,g=0;g<r;g++){var m=Math.random(),b=0;for(c=0;c<d;c++)if(!a[d+"-"+c]&&!a[c+"-"+d]&&m<=(b=1===d?1:b+s[c]/h+p/(d-g))){var v;p+=s[c]/h,a[(v={id:u++,source:d,target:c}).source+"-"+v.target]=v,o.edges.push(v),s[d]++,s[c]++;break}}}return o},Bm_configure=function(e){var t=void 0===e?{}:e,n=t.nodes,i=void 0===n?20:n,r=t.edges,o=t.p,a=t.scale,s=void 0===a?100:a;if(!ma(i)||i<3)throw new TypeError("Invalid argument: options.nodes is not a number >= 3, was "+i);if(void 0!==r&&void 0!==o)throw new TypeError("Invalid argument: choose between options.edges and options.p");return void 0===r&&void 0===o&&(o=.1),{nodes:i,edges:r,p:o,scale:s}},Bm_generate=function(e){var t={nodes:[],edges:[]},n=e.nodes,i=e.p,r=e.scale;if(0<=i)for(var o=0,a=0;a<n;a++){t.nodes.push({id:a,attributes:{x:Math.random()*r,y:Math.random()*r}});for(var s=0;s<a;s++)Math.random()<i&&t.edges.push({id:o++,source:a,target:s})}else{var l=[],u=e.edges;for(a=0;a<n;a++)for(t.nodes.push({id:a,attributes:{x:100*Math.random(),y:100*Math.random()}}),s=a+1;s<n;s++)l.push({source:a,target:s});for(o=l.length-1,a=0;a<u;a++){var d=l.splice(Math.floor(Math.random()*o),1)[0];d.id=a,t.edges.push(d),o--}}return t};function Vm(e){return 10*Math.pow(2.7,e)}function Um(e){return 5+Vm(e)/10}var jm_configure=function(e){var t=e.depth,n=void 0===t?3:t,i=e.breadth,r=void 0===i?3:i,o=e.nbNodes;return void 0!==o&&(r=5,n=Math.ceil(Math.log(o)/Math.log(5))),{depth:n,breadth:r,nbNodes:o}},jm_generate=function(e){var t=e.depth,n=e.breadth,i=e.nbNodes,r={id:0,attributes:{x:0,y:0,radius:Um(t+1)}},o={nodes:[r],edges:[]};return function a(s,l,u,d,c){if(0===u)return c;for(var h=Vm(u),p=Um(u),g=.2*p,m=-Math.PI,b=2*Math.PI/l,v=d.attributes.x,y=d.attributes.y,E=0;E<l;++E){var M={id:c,attributes:{x:v+h*Math.cos(m),y:y+h*Math.sin(m),radius:p}},O={id:c,source:d.id,target:c,attributes:{width:g}};s.nodes.push(M),s.edges.push(O),c=a(s,l,u-1,M,c+1),m+=b}return c}(o,n,t,r,1),void 0!==i&&(o.nodes=o.nodes.slice(0,i),o.edges=o.edges.slice(0,Math.max(i-1,0))),o},Zm_configure=function(e){var t=void 0===e?{}:e,n=t.rows,r=t.columns,a=t.columnDistance,l=t.rowDistance,d=t.xmin,h=t.ymin;return{rows:void 0===n?4:n,columns:void 0===r?4:r,columnDistance:void 0===a?20:a,rowDistance:void 0===l?20:l,xmin:void 0===d?0:d,ymin:void 0===h?0:h}},Zm_generate=function(e){for(var t=e.rows,n=e.columns,i=e.columnDistance,r=e.rowDistance,o=e.xmin,a=e.ymin,s={nodes:[],edges:[]},l=0,u=0;u<t;++u)for(var d=0;d<n;++d){var c=u*n+d;s.nodes.push({id:c,attributes:{x:o+d*i,y:a+u*r}}),d!==n-1&&(s.edges.push({id:l,source:c,target:u*n+d+1}),l++),u!==t-1&&(s.edges.push({id:l,source:c,target:(u+1)*n+d}),l++)}return s},Gm_configure=function(e){var t=void 0===e?{}:e,n=t.nodes,r=t.edges,a=t.texts,l=t.scale;return{nodes:void 0===n?10:n,edges:void 0===r?10:r,texts:void 0!==a&&a,scale:void 0===l?100:l}},Gm_generate=function(e){for(var t=e.nodes,n=e.edges,i=e.texts,r=e.scale,o=[],a=[],s=0;s<t;s++)o.push({id:s,attributes:{x:Math.random()*r,y:Math.random()*r,text:i?"Node "+s:void 0}});for(s=0;s<n;s++)a.push({id:s,source:Math.random()*t|0,target:Math.random()*t|0,attributes:{text:i?"Edge "+s:void 0}});return{nodes:o,edges:a}},qm_configure=function(e){var t=void 0===e?{}:e,n=t.nodes,i=void 0===n?50:n,r=t.width,o=void 0===r?100:r,a=t.height,s=void 0===a?100:a,l=t.x,u=void 0===l?0:l,d=t.y,c=void 0===d?0:d;if(!isFinite(i)||i<1)throw new RangeError("Tree generator: number of nodes must be a positive integer");return{nodes:i,width:o,height:s,x:u,y:c}},qm_generate=function(e){var t=e.nodes,r=e.width,o=e.height,a=e.x-r/2,s=e.y-o/2;return{nodes:new Array(t).fill(0).map(function(l,u){return{id:u,attributes:{x:a+Math.random()*r,y:s+Math.random()*o}}}),edges:new Array(t-1).fill(0).map(function(l,u){return{id:u,source:Math.floor(Math.sqrt(u)),target:u+1}})}},Hm_configure=function(e){var t=void 0===e?{}:e,n=t.length,r=t.scale;return{length:void 0===n?5:n,scale:void 0===r?100:r}},Hm_generate=function(e){var t=e.length,n=e.scale,i={nodes:[],edges:[]};if(t<=0)return i;i.nodes.push({id:0,attributes:{x:Math.random()*n,y:Math.random()*n}});for(var r=1;r<t;++r)i.nodes.push({id:r,attributes:{x:Math.random()*n,y:Math.random()*n}}),i.edges.push({id:r-1,source:r-1,target:r});return i},Wm=(Ym.initNamespace=function(e){e.generate={balancedTree:function(t){return Promise.resolve(Rm_generate(Rm_configure(t)))},barabasiAlbert:function(t){return Promise.resolve(zm_generate(zm_configure(t)))},erdosRenyi:function(t){return Promise.resolve(Bm_generate(Bm_configure(t)))},flower:function(t){return Promise.resolve(jm_generate(jm_configure(t)))},grid:function(t){return Promise.resolve(Zm_generate(Zm_configure(t)))},path:function(t){return Promise.resolve(Hm_generate(Hm_configure(t)))},random:function(t){return Promise.resolve(Gm_generate(Gm_configure(t)))},randomTree:function(t){return Promise.resolve(qm_generate(qm_configure(t)))}}},Ym);function Ym(){}var Xm=(Jm.initNamespace=function(e){var t;e.geo=(t=e,{enable:function(n){return t.modules.geo.enable(n)},disable:function(n){return t.modules.geo.disable(n)},setOptions:function(n){return t.modules.geo.setOptions(n)},getOptions:function(){return t.modules.geo.getOptions()},getMap:function(){return t.modules.geo.getMap()},enabled:function(){return t.modules.geo.isEnabled()},getCenter:function(){return t.modules.geo.getCenter()},getView:function(){return t.modules.geo.getView()},getZoom:function(){return t.modules.geo.getZoom()},setZoom:function(n){return t.modules.geo.setZoom(n)},setView:function(n,i,r){return t.modules.geo.setView(n,i,r)},setCenter:function(n,i){return t.modules.geo.setCenter(n,i)},toggle:function(n){return t.modules.geo.toggle(n)},resetCoordinates:function(){return t.modules.geo.resetCoordinates()},updateCoordinates:function(){return t.modules.geo.updateCoordinates()},getUnprojectedCoordinates:function(n){return t.modules.geo.getUnprojectedCoordinates(t.getNodes(n))}})},Jm);function Jm(){}function Pu(e,t,n,i,r){var o;void 0===i&&(i={}),void 0===r&&(r=!1),Array.isArray(n)||n instanceof(t?ar:vs)||(n=[n]);var a=e.getElements(t,n);if(r||(a=a.dedupe()),!a.size)return Promise.resolve();t&&Pu(e,!1,a.getAdjacentEdges({filter:"all"}),i,!0);var s=i.virtual,l=void 0!==s&&s,u=a._indexes,d=e.storage.fetch(t),c=e.getCacheLists(t),h=d.getFlexArray("removed");if(An(d.getFlexArray("virtual").getMultiple(u))!==(l?u.length:0))throw new Error("Attempting to remove virtual elements; you should not do that");var p=((o={virtual:l})[t?"nodes":"edges"]=a,o);if(e.fireEvent(t?I.BEFORE_REMOVE_NODES:I.BEFORE_REMOVE_EDGES,p),c.visible.invalidList(),c.all.invalidList(),l||c.raw.invalidList(),e.setExcluded(a,!0),h.setMultiple(u,1),!t)for(var g=0;g<u.length;++g)e.topology.removeFromAdjacencyList(u[g]);return d.removeElements(u),e.setIndexFreeStep(1),e.fireEvent(t?I.REMOVE_NODES:I.REMOVE_EDGES,p),Promise.resolve()}var $E=(Ai.prototype.addNodes=function(e,t){return xs(this.modules.graph,!0,e,t)},Ai.prototype.addEdges=function(e,t){return xs(this.modules.graph,!1,e,t)},Ai.prototype.addNode=function(e,t){return Wu(this.modules.graph,!0,e,t)},Ai.prototype.addEdge=function(e,t){return Wu(this.modules.graph,!1,e,t)},Ai.prototype.removeNodes=function(e,t){return Pu(this.modules.graph,!0,e,t)},Ai.prototype.removeEdges=function(e,t){return Pu(this.modules.graph,!1,e,t)},Ai.prototype.removeNode=function(e,t){return Pu(this.modules.graph,!0,[e],t)},Ai.prototype.removeEdge=function(e,t){return Pu(this.modules.graph,!1,[e],t)},Ai.prototype.getNodes=function(e){return this.modules.graph.getNodes(e)},Ai.prototype.getEdges=function(e){return this.modules.graph.getEdges(e)},Ai.prototype.getNode=function(e){return this.modules.graph.getNode(e)},Ai.prototype.getEdge=function(e){return this.modules.graph.getEdge(e)},Ai.prototype.clearGraph=function(){this.modules.graph.clear()},Ai.prototype.setGraph=function(e,t){return this.modules.graph.clear(),this.addGraph(e,t)},Ai.prototype.addGraph=function(e,t){return n=this.modules.graph,s=void 0===(a=(i=e).nodes)?[]:a,u=void 0===(l=i.edges)?[]:l,void 0===(r=t)&&(r={}),r.batchSize?xs(n,!0,s,r).then(function(d){return o=d,xs(n,!1,u,r)}).then(function(d){return{nodes:o,edges:d}}):Promise.resolve({nodes:iu(n,!0,s,r),edges:iu(n,!1,u,r)});var n,i,r,o,a,s,l,u},Ai.prototype.createNodeList=function(){return this.getNodes([])},Ai.prototype.createEdgeList=function(){return this.getEdges([])},Ai.prototype.getConnectedComponents=function(e){return void 0===e&&(e={}),this.modules.graph.getConnectedComponents(this.getNodes(e.filter),e)},Ai.prototype.getConnectedComponentByNode=function(e,t){var n=this.modules.graph.getNode(e);if(void 0===n)throw new Error("getComponentByNode: cannot find node "+e);return this.modules.graph.getConnectedComponentByNode(n,t)[0]},Ai);function Ai(){}var eS=(Qm.prototype.reloadFonts=function(){this.modules.graphics.reloadFonts()},Qm);function Qm(){}function dr(e){return e.charCodeAt(0)}var tS=dr(" "),Km=dr("<"),nd=dr(">"),$m=dr('"'),nS=dr("\n"),iS=dr("\r"),id=dr("/"),rS=dr("\\"),oS=dr("a"),aS=dr("z"),sS=dr("A"),uS=dr("Z"),lS=dr("0"),dS=dr("9"),cS=dr(":");function hS(e,t,n,i){var r=i.length;if(n-t!==r)return!1;for(var o=0;o<r;++o)if(e[t+o]!==i[o])return!1;return!0}function iv(e,t,n,i){for(var r=e.length,o=0;o<r;++o)if(hS(t,n,i,e[o]))return o;return e.push(t.slice(n,i)),r}function pS(e,t,n){var i=rd(t,n),r=t[i];if(r===nd||r===id)return i;var o=i;i=ov(t,i);for(var u=iv(e.attributes,t,o,i);t[i]!==$m;)++i;for(o=++i;(r=t[i])!==$m;)r===rS&&++i,++i;return e.tokens.push(-3,u,o,i),i+1}function rv(e){return e===tS||e===nS||e===iS}function rd(e,t){for(;rv(e[t]);)++t;return t}function ov(e,t){for(;oS<=(n=e[t])&&n<=aS||sS<=n&&n<=uS||n===cS||lS<=n&&n<=dS;)++t;var n;return t}function av(e,t){var n=["return {","  id: undefined,","  attributes: {","    text: undefined,","    color: undefined,","    "+(e?"radius":"width")+": undefined",e?"  ,x: undefined":"",e?"  ,y: undefined":"","  },"];e||n.push("  source: undefined,","  target: undefined,");var i=Object.keys(t);i.length&&n.push("  data: {");for(var r=0;r<i.length;++r){var o=t[i[r]];n.push('  "'+o.title+'": '+(void 0!==o.default?JSON.stringify(o.default):void 0)+(r===i.length-1?"":","))}return i.length&&n.push("}"),n.push("};"),new Function(n.join("\n"))}function sv(e){return-1===e.indexOf("\\")?e:e=e.replace(/\\"/g,'"')}function uv(e){if(-1===e.indexOf("<gexf"))throw new Error("not a GEXF file");var t=function(be){for(var Ie=new Int32Array(be.length),De=0,Ve=be.length;De<Ve;++De)Ie[De]=be.charCodeAt(De);return Ie}(e),n=function(be,Ie){for(var De,Ve,Re={tags:[],attributes:[],tokens:[]},Be=Re.tokens,Oe=rd(be,Ie);Oe<be.length;){var Le=be[Oe];if(Le===Km){if(be[Oe=rd(be,++Oe)]===id)for(Be.push(-2);be[++Oe]!==nd;);else{Oe=ov(be,De=Oe);var Ce=iv(Re.tags,be,De,Oe);for(Be.push(-1,Ce),Le=be[Oe];Le!==nd&&Le!==id;)Le=be[Oe=pS(Re,be,Oe)];if(Le===id)for(Be.push(-2);be[++Oe]!==nd;);}Oe+=1}else{for(De=Oe;be[++Oe]!==Km;);for(Ve=Oe-1;rv(be[Ve]);)--Ve;Be.push(-4,De,Ve+1)}Oe=rd(be,Oe)}return Re}(t,e.indexOf("<gexf ")),i={},r={};n.tags.forEach(function(be,Ie){var De=String.fromCharCode.apply(null,be);i[De]=Ie}),n.attributes.forEach(function(be,Ie){var De=String.fromCharCode.apply(null,be);r[De]=Ie});for(var o=i.attributes,a=i.attribute,s=i.node,l=i.edge,u=i.default,d=i["viz:position"],c=i["viz:size"],h=i["viz:color"],p=i.attvalue,g=r.class,m=r.id,b=r.type,v=r.title,y=r.label,E=r.source,S=r.target,w=r.x,M=r.y,O=r.r,F=r.g,L=r.b,N=r.a,B=r.value,X=r.for,J=r.weight,ae={float:1,double:1,integer:2,boolean:3,string:4,"list-string":5},ie=0,U=n.tokens,Y=U.length,he=new Array(16),pe=0,we=0,ke=0,at=!0,st={},Xe={},xt=null,It=null,Ge=null,He=void 0,Pe=null,We=0,Qe=0,nt=0,Me=1,ze=null,qe=void 0,Ke=!1,ht=!0,Wt=null,$t=null,dn=[],sn=[],pn=0,W=null;ie<Y;){var Z=U[ie];if(-1===Z)we=pe,he[ke]=pe=U[ie+1],ke+=1,pe===s?(Pe=(Wt=Wt||av(!0,st))(),ht=!0,W=st):pe===l&&(Pe=($t=$t||av(!1,Xe))(),ht=!1,W=Xe),ie+=2;else if(-2===Z){if(xt&&pe===a){W=at?st:Xe;var z=ae[It];(me=He)&&(1===z?me=+me:2===z?me=0|+me:3===z?me="true"===me:5===z&&(me=me.split(" ").filter(function(be){return be}))),W[xt]={title:Ge||xt,default:me,type:z},It=Ge=xt=null,He=void 0}else if(pe===s&&4===ke)Ke&&(Pe.attributes.color="rgba("+We+", "+Qe+", "+nt+", "+Me+")",nt=Qe=We=0,Ke=!(Me=1)),Pe.id||(Pe.id=++pn),dn.push(Pe);else if(pe===l&&4===ke)Pe.id||(Pe.id=++pn),sn.push(Pe);else if(pe===p&&6===ke&&ze){var K=(ht?st:Xe)[ze];K&&(void 0===qe?qe=K.default:(z=K.type)&&(1===z?qe=+qe:2===z?qe=0|+qe:3===z?qe="true"===qe:5===z?qe=qe.split(" ").filter(function(be){return be}).map(function(be){return sv(be)}):"string"==typeof t&&(qe=sv(qe))),Pe.data[W[ze].title]=qe),qe=ze=null}pe=we,we=he[--ke-2],ie+=1}else if(-3===Z){var ce=U[ie+1],me=e.substring(U[ie+2],U[ie+3]);if(pe===o)ce===g&&(at="edge"!==me&&"edges"!==me);else if(pe===a)ce===m?xt=me:ce===b?It=me:ce===v&&(Ge=me);else if(pe!==s&&pe!==l||4!==ke)if(pe===d&&5===ke){if(ce===w)Pe.attributes.x=parseFloat(me);else if(ce===M){var Se=parseFloat(me);Pe.attributes.y=0===Se?Se:-Se}}else pe===h&&5===ke?(Ke=!0,ce===O?We=parseInt(me):ce===F?Qe=parseInt(me):ce===L?nt=parseInt(me):ce===N&&(Me=parseFloat(me))):pe===c&&5===ke?ce===B&&(ht?Pe.attributes.radius=+me:Pe.attributes.width=+me):pe===p&&6===ke&&(ce===X||ce===m?ze=me:ce===B&&(qe=me));else ce===m?Pe.id=me:ce===y?Pe.attributes.text=me:ce===E?Pe.source=me:ce===S?Pe.target=me:ce===J&&(Pe.attributes.width=+me);ie+=4}else{if(-4!==Z)throw new Error("at index "+ie+": token "+Z);me=e.substring(U[ie+1],U[ie+2]),pe===u&&(He=me),ie+=3}}return{nodes:dn,edges:sn}}function od(e){return"string"==typeof e||isFinite(e)?String(e):String(e.id||e._id)}function Ia(e,t,n){n=n||t,t in e&&(e.attributes||(e.attributes={}),e.attributes[n]=e[t])}function lv(e){for(var t=JSON.parse(e),n=t.nodes||[],i=t.edges||[],r=0;r<n.length;r++){var o=n[r];"string"==typeof o.size&&(o.size=+o.size),"string"==typeof o.x&&(o.x=+o.x),"string"==typeof o.y&&(o.y=+o.y),Ia(o,"x"),Ia(o,"y"),Ia(o,"size","radius"),Ia(o,"color"),Ia(o,"text")}for(r=0;r<i.length;r++){var a=i[r];"string"==typeof a.size&&(a.size=+a.size),Ia(a,"size","width"),Ia(a,"color"),Ia(a,"text")}return t}function dv(e,t){for(var n=0,i=0;i<20;++i){var r=n+e[i]+t[i];n=+(10<=r),e[i]=r%10}}function cv(){this._decimalPowerOfTwo=new Uint8Array(20),this._binaryNumber=new Uint8Array(64),this._decimalNumber=new Uint8Array(20)}var gS=new(cv.prototype.int64ToString=function(e){var t=e.low,n=e.high;if(0===t&&0===n)return"0";(function(s,l,u){for(var d=0;d<32;++d)u[d]=+!!(s&1<<d);for(d=0;d<32;++d)u[d+32]=+!!(l&1<<d)})(t,n,this._binaryNumber),this._decimalNumber.fill(0),this._decimalPowerOfTwo.fill(0);var i=(this._decimalPowerOfTwo[0]=1)===this._binaryNumber[63];i&&function(s){for(var l=0;l<64;++l)s[l]^=1;for(l=0;l<64&&!(s[l]^=1);++l);}(this._binaryNumber);for(var r=0;r<64;++r)this._binaryNumber[r]&&dv(this._decimalNumber,this._decimalPowerOfTwo),dv(this._decimalPowerOfTwo,this._decimalPowerOfTwo);var o=[],a=this._decimalNumber.length-1;for(i&&o.push("-");!this._decimalNumber[a];)--a;for(r=a;0<=r;--r)o.push(String(this._decimalNumber[r]));return o.join("")},cv);function ad(e){return gS.int64ToString(e)}function sd(e){return"object"==typeof e&&"high"in e&&"low"in e}function Du(e,t,n,i){var r,o,a;t&&(Array.isArray(t)?t.forEach(function(s){return Du(e,s,n,i)}):function(e){return"segments"in e}(t)?(r=e,o=n,a=i,t.segments.forEach(function(s){Du(r,s.start,o,a),Du(r,s.end,o,a),Du(r,s.relationship,o,a)})):(function(s){if("object"!=typeof s||null===s)throw new Error("Ogma can only retrieve nodes and relationships from Neo4j. Please make sure that your Cypher query returns nodes and edges, not values.");for(var l,u=0,d=Object.keys(s.properties);u<d.length;u++){var c=d[u],h=s.properties[c];sd(h)&&(s.properties[c]=ad(h))}if(void 0!==s.identity&&(sd(s.identity)&&(s.identity=ad(s.identity)),"start"in(l=s)&&"end"in l)){var p=s.start.identity||s.start,g=s.end.identity||s.end;sd(p)&&(s.start=ad(p)),sd(g)&&(s.end=ad(g))}}(t),function(e){return"start"in e&&"end"in e&&"type"in e}(t)?i.has(t.identity)||(i.add(t.identity),e.edges.push({id:t.identity,source:t.start,target:t.end,data:{neo4jType:t.type,neo4jProperties:t.properties}})):n.has(t.identity)||(n.add(t.identity),e.nodes.push({id:t.identity,attributes:{x:100*Math.random(),y:100*Math.random()},data:{neo4jLabels:t.labels,neo4jProperties:t.properties}}))))}function vS(e){return{gexf:function(t){return Promise.resolve(uv(t))},gexfFromUrl:function(t){return mi(t).then(function(n){return uv(n)})},janus:function(t){return Promise.resolve(function(e){var t=[],n=[];return function i(r,o,a){if(r&&"object"==typeof r){if(Array.isArray(r))return r.forEach(function(h){return i(h,o,a)});if("vertex"===(d=r).type||"vertex"===d._type||d.inE||d.outE||d._inE||d._outE){var s={};r.properties&&Object.keys(r.properties).forEach(function(h){s[h]=r.properties[h][0].value});var l=od(r);for(var u in o.push({id:l,data:{id:r.id+"",categories:[r.label],properties:s}}),r)"properties"!==u&&i(r[u],o,a)}else{var d,c;if("edge"===(c=r).type||"edge"===c._type||c.inV||c.outV||c._outV||c._inV)for(var u in l=od(r),a.push({id:l,source:od(r.inV||r._inV),target:od(r.outV||r._outV),data:{id:l,type:r.label,properties:r.properties||{}}}),r)"properties"!==u&&i(r[u],o,a);else Object.keys(r).forEach(function(h){return i(r[h],o,a)})}}}("string"==typeof e?JSON.parse(e):e,t,n),{nodes:t,edges:n}}(t))},json:function(t){return Promise.resolve(lv(t))},jsonFromUrl:function(t){return mi(t).then(function(n){return lv(n)})},neo4j:function(t){return Promise.resolve((i="string"==typeof(n=t)?JSON.parse(n):n,r={nodes:[],edges:[]},o=new Set,a=new Set,i.records.forEach(function(s){s._fields.forEach(function(l){Du(r,l,o,a)})}),r));var n,i,r,o,a}}}var hv=(Qc.initNamespace=function(e){e.parse=vS()},Qc.prototype.fetch=function(e){return mi(e)},Qc);function Qc(){}var pv=(fv.initNamespace=function(e){var t;e.keyboard=(t=e,{isKeyPressed:function(n){return t.modules.keyboard.isPressed(n)},resetKeys:function(){t.modules.keyboard.resetKeys()}})},fv);function fv(){}var yS={configure:function(e,t){var n=t.graph,i=t.data;if(void 0===e.centralNode)throw new Error('concentric layout: missing parameter "centralNode"');var r,o,a,s,l,u=Nt({},e,{centralNode:(s=n,(l=e.centralNode)instanceof mo?l:s.getNode(l)),nodes:(r=n,o=e.nodes,void 0===a&&(a=r.getNodes()),o?o instanceof ar?o:r.getNodes(o):a)}),c=u.nodes,h=n.getNode(u.centralNode)._index,p=u.centralNode.getPosition(),g=p.x,m=p.y,b=c.getAttribute("layoutable"),v=n.getNodes(c)._indexes,y=Array.from(v.filter(function(F,L){return b[L]}));-1===y.indexOf(h)&&y.push(h);var E=n.getNodeAttribute("radius").getMultiple(v),S=function(F,L,N,B){if(L)return"random"===L?"random":"radius"===L?B.slice():"degree"===L?N.getDegree():F.getProperty(N,L)}(i,u.sortBy,c,E),w=y.reduce(function(F,L,N){return F[L]=N,F},{}),M=y.map(function(F,L){return L}),O=y.map(function(F){return n.topology.getAdjacentElements(!0,new Uint32Array([F])).map(function(L){return w[L]})});return{sourceNodeIndex:y.indexOf(h),centerX:"number"==typeof u.centerX?u.centerX:g,centerY:"number"==typeof u.centerY?u.centerY:m,list:y,indexes:M,size:y.length,totalSize:y.length,attributes:{adjacentNodes:O,size:E},sortAttr:S,clockwise:void 0===u.clockwise||u.clockwise,circleHopRatio:u.circleHopRatio||5,allowOverlap:!!u.allowOverlap}},context:function(){return{dijkstra:function(e,t,n,i,r){var o,a=Math.pow(2,31)-1,s=new Int32Array(i),l=new Int32Array(i),u=new Int8Array(i);s.fill(a),l.fill(-1);for(var d=0;d<i;++d){var c=t[d];void 0!==c&&(s[c]=a,l[c]=-1)}s[r]=0;for(var h=function(){var p=a;o=-1;for(var g=0;g<n;++g){var m=t[g],b=s[m];!u[m]&&b<p&&(p=b,u[o=m]=1)}if(-1<o){var y=p+1;e[o].forEach(function(E){y<s[E]&&(s[E]=y,l[E]=o)})}};-1!==o;)h();return s},determinePropertyType:function(e,t,n){return t.some(function(i){return"number"!==e[i]})?"string":"number"}}},update:function(e,t){for(var n=e.attributes,i=e.indexes,r=e.size,o=e.sourceNodeIndex,a=e.centerX,s=e.centerY,l=e.sortAttr,u=n.adjacentNodes,d=n.size,c=new Array(e.totalSize),h=new Array(e.totalSize),p=t.dijkstra(u,i,e.size,e.totalSize,o),g=0,m={},b=0;b<r;b++){var v=d[i[b]];g<v&&(g=v)}var y=g*e.circleHopRatio,E=0,S=0,w=Math.PI/9;for(b=0;b<r;b++){var M=i[b],O=p[M],F=m[O];F||(m[O]=F=[]),F.push(M)}var L,N,X=(N=i,"random"===(L=l)?function(){return Math.random()-.5}:L?"number"===t.determinePropertyType(L,N,N.length)?function(ae,ie){return L[ae]-L[ie]}:function(ae,ie){return L[ae]<L[ie]?-1:1}:void 0),J="random"===l||l;return Object.keys(m).sort(function(ae,ie){return parseInt(ae)-parseInt(ie)}).forEach(function(ae,ie){var ke,U=m[ae],Y=U.length,he=0,pe=S,we=2*Math.PI/Y;0===ie||e.allowOverlap||2*Math.PI*E<(ke=2*(he+=U.reduce(function(Xe,xt){return Xe+d[xt]},0))*Math.SQRT2)&&(E+=ke/(2*Math.PI)-E),J&&(U.sort(X),e.clockwise||U.reverse());for(var at=0;at<Y;at++){var st=U[at];c[st]=Math.cos(pe)*E+a,h[st]=Math.sin(pe)*E+s,v=d[st],pe+=we*(e.allowOverlap?1:v/he*Y)}E+=y,S+=w}),{x:c,y:h,indexes:e.list}},isRunning:function(){return!1},onSync:function(e){return{indexes:e.indexes,x:e.x,y:e.y}}};function Kc(e){var t=e.sources,n=e.targets,i=e.weights,r=e.source,o=e.target,a=e.undirected,s=void 0!==a&&a,l=e.indexes,u=e.N;if(u=l?l.length:u,!isFinite(u)||0===u)throw new Error("Invalid number of nodes "+u);var d,c=new Float32Array(u),h=new Int32Array(u),p={},g=Number.POSITIVE_INFINITY;if(!i){i=[];for(var m=0;m<u;m++)i[m]=1}if(!l)for(l=new Uint32Array(u),m=0;m<u;m++)l[m]=m+1;for(m=0;m<u;m++)c[m]=g,h[m]=-1,p[l[m]]=m;for(c[p[r]]=0,m=1;m<=u;m++){d=!1;for(var b=0;b<i.length;b++){var v=t[b],y=n[b],E=p[v],S=p[y];if(void 0!==E&&void 0!==S){var w=i[b],M=c[E]+w;c[E]!==g&&M<c[S]&&(c[S]=M,h[S]=v,d=!0),s&&(M=c[S]+w,c[S]!==g&&M<c[E]&&(c[E]=M,h[E]=y,d=!0))}}if(!d)break}if(d)for(m=0;m<i.length;m++)if(S=p[y=n[m]],void 0!==(E=p[v=t[m]])&&void 0!==S&&c[E]+(w=i[m])<c[S])return null;var O=null,F=null;if(void 0!==o){var L=p[o];if(void 0!==L&&c[L]!==g){for(O=[],m=o;-1!==m;m=h[p[m]])O.push(m);O=O.reverse(),F=c[L]}}return{distances:c,path:O,pathLength:F}}function $c(e){var t=e.sources,n=e.targets,i=e.weights,r=e.indexes,o=e.adjacency,a=e.undirected,s=e.ignoreWeights,l=Number.POSITIVE_INFINITY,u=r?r.length:o.length;if(!r){r=new Uint32Array(u);for(var d=0;d<u;d++)r[d]=d+1}var c=new Array(u),h={};for(d=0;d<u;d++){c[d]=new Float32Array(u);for(var p=0;p<u;p++)c[d][p]=d===p?0:l;h[r[d]]=d}var g=u,m=i.length;for(t=t.slice(),n=n.slice(),i=i.slice(),d=0;d<u;d++)t[m+d]=g,n[m+d]=r[d],i[m+d]=0,s&&(i[d]=1);var b=Kc({sources:t,targets:n,weights:i,undirected:a,N:u+1,source:g});if(null===b)throw new Error("Graph has negative weight loops");var v=b.distances;for(d=0;d<i.length;d++){var y=h[t[d]],E=h[n[d]];void 0!==y&&void 0!==E&&(i[d]=i[d]+v[y]-v[E])}for(t=t.slice(0,m),n=n.slice(0,m),i=i.slice(0,m),d=0;d<u;d++){var S=Hl(o,r[d],void 0,r,h,s).distances;for(p=0;p<u;p++)c[d][p]=d===p?0:S[p]}return c}function eh(e){var t=e.X,n=e.Y,i=e.sizes,r=e.indexes,o=e.R,a=e.center,s=e.gap,l=void 0===s?0:s,u=e.epsilon,d=void 0===u?.001:u,c=e.maxLoops,h=void 0===c?5:c,p=e.inPlace,m=r.length,b=a[0],v=a[1],y=m;void 0===p||p||(t=t.slice(),n=n.slice());for(var E=sc,S=uc,w=r.slice().sort(function(Me,ze){return S(t[Me],n[Me],t[ze],n[ze],b,v)}),M=w[m-1],O=t[M],F=n[M],L=!1,N=0;N<y-1;N++){var B=N%m,X=(N+1)%m;-1===N&&(B=m-1,X=0);var J=t[B=w[B]],ae=n[B],ie=t[X=w[X]],U=n[X],Y=i[B]+i[X]+l,he=S(J,ae,ie,U,b,v);if(-1===he&&L&&(he=1),!(o<Y)){if(1===he||Y-yi(J,ae,ie,U)>d){var pe=E(b,v,o,J,ae,Y);if(pe){var we=pe[0];L=b<ie&&we[0]<b,ie=t[X]=we[0],U=n[X]=we[1]}}else L=!1;if(N%m==m-2){var ke=w[m-1],at=w[0];if(n[ke]>v&&n[at]>v&&t[ke]-i[ke]<t[at]+i[ke]){var st=0;for(y=Math.min(m*h,y+m);n[w[ke]]>v&&n[w[0]]>v&&t[w[ke]]<t[w[0]]&&++st<m;)w.unshift(w.pop())}}}}var Xe=O-b,xt=F-v,It=t[M]-b,Ge=n[M]-v,He=Xe==It?0:Math.abs(Math.acos((Xe*It+xt*Ge)/(Math.sqrt(Xe*Xe+xt*xt)*Math.sqrt(It*It+Ge*Ge))));if(0!==He){var Pe=Math.sin(-He),We=Math.cos(-He),Qe=void 0;for(N=0;N<m;N++){var nt=n[Qe=w[N]]-v;t[Qe]=(st=t[Qe]-b)*We-nt*Pe+b,n[Qe]=st*Pe+nt*We+v}}return{X:t,Y:n}}function gv(e,t,n,i,r,o){var a=Object.create(null),s=n[e],l=s,u=0,d=s;for(var c in t){for(var h=t[c],p=0,g=0,m=0,b=h.length;m<b;m++){var v=n[h[m]];g=Math.max(g,v),p+=2*v+i}var y=p/(2*Math.PI)+g,S=o?u+Math.max(o,g+l):u*r;u=Math.max(u,y,d,S),a[c]=u,l=g}return a[0]=0,a[Number.POSITIVE_INFINITY]=u,a}function _v(e,t,n,i,r,o){for(var a=0,s=0;s<i;s++)for(var l=0;l<i;l++){var u=o[s],d=o[l];if(u!==d){var c=e[u][d]*r,h=1/(c*c);if(h){var p=t[u]-t[d],g=n[u]-n[d];a+=h*Math.pow(c-Math.sqrt(p*p+g*g),2)}}}return a}function mv(e,t,n,i,r,o,a){var s=0;if(-1===r)return 0;for(var l=0;l<i;l++)for(var u=0;u<i;u++){var d=a[l],c=a[u];if(d!==c&&(d===r||c===r)){var h=e[d][c]*o,p=1/(h*h);if(p){var g=t[d]-t[c],m=n[d]-n[c];s+=p*Math.pow(h-Math.sqrt(g*g+m*m),2)}}}return s}function th(e,t,n,i,r,o,a,s){a=a||0;for(var l=0,u=0,d=0;d<i;d++)for(var c=0;c<i;c++){var h=s[d],p=s[c];if(h!==p){var g=e[h][p]*o,m=1/(g*g);if(m){var b=t[h]-t[p],v=n[h]-n[p],y=m*Math.pow(g-Math.sqrt(b*b+v*v),2);l+=y,h!==r&&p!==r||(u+=y)}}}return(1-a)*l+a*u}function nh(e,t,n,i,r,o,a,s,l){a=a||0;var u=t,d=n;-1===(r=void 0===r?-1:r)&&(a=0);for(var c=t[r],h=n[r],p=0;p<i;p++){var g=s[p],m=l(e[r][p]),b=a/(m*m);if(0!==m){for(var v=0,y=0,E=0,S=t[g],w=n[g],M=0;M<i;M++){var O=s[M];if(O!==g){var F=e[g][O]*o,L=1/(F*F),N=t[O],B=n[O];if(0!=L){var X=(U=(ae=S-N)*ae+(ie=w-B)*ie)<1e-6?0:1/Math.sqrt(U);y+=(1-a)*L*(N+F*(S-N)*X),E+=(1-a)*L*(B+F*(w-B)*X)}v+=L}}var J=(1-a)*v+b;if(0!=J){var ae,ie,U;U=(U=(ae=S-c)*ae+(ie=w-h)*ie)<1e-6?0:1/Math.sqrt(U);var Y=0===m?0:m*U*b;u[g]=(y+Y*t[g])/J,d[g]=(E+Y*n[g])/J}}}return{x:u,y:d}}function ih(e,t){return e-t}var xS={imports:{minHeap:kc,bellmanFord:Kc,dijkstra:Hl,johnson:$c,distance:yi,circleCircleIntersection:sc,circleSortCompare:uc,weightedStress:_v,distanceStress:mv,constrainedStress:th,stressMinimizationStep:nh,removeRadialOverlap:eh,quadraticInOut:nc,calculateRadii:gv},configure:function(e,t){void 0===e&&(e={centralNode:null});var n=t.graph,i=n.getNode(e.centralNode),r=i.getPosition(),o=isFinite(e.centerX)?e.centerX:r.x,a=isFinite(e.centerY)?e.centerY:r.y,s=i._index,l=e.nodes;l.includes(i)||(l=l.concat(i.toList()));var u=l._indexes,d=l.getAttribute("layoutable");(u=u.filter(function(w,M){return d[M]||w===s})).sort(ih);var c=u.length,h=function(w,M,O){for(var F=w.slice().sort(ih),L=[],N=0,B=M.length;N<B;N++){for(var X=[],J=M[N],ae=!1,ie=0,U=J.length;ie<U;ie++){var Y=J[ie];-1!==ps(F,Y)&&(Y===O&&(ae=!0),X.push(Y))}0!==X.length&&L[ae?"unshift":"push"](X.sort(ih))}return L}(u,n.getConnectedComponents(l,{internalIndexes:!0}),s),p=n.degrees(u),g=new Float32Array(n.getNodeAttribute("x").getMultiple(u)),m=new Float32Array(n.getNodeAttribute("y").getMultiple(u)),b=n.getNodeAttribute("radius").getMultiple(u),v=n.getEdges()._indexes,y=n.getEdgeAttribute("source").getMultiple(v),E=n.getEdgeAttribute("target").getMultiple(v),S=n.getAdjacencyList({internalIndexes:!0,weight:1,indexes:u});return{centerIndex:s,centerIndexPos:0,cx:o,cy:a,D:null,indexes:u,components:h,normIndexes:null,radii:null,rings:null,x:g,y:m,degree:p,size:c,attributes:{size:b,adjacency:S,weights:E.map(function(){return 1}),sources:y,targets:E},sortAttr:null,allowOverlap:!!e.allowOverlap,nodeGap:e.nodeGap,radiusRatio:e.radiusRatio,radiusDelta:e.radiusDelta,repulsion:e.repulsion,randomize:!("randomize"in e)||!!e.randomize,renderSteps:!!e.renderSteps,epsilon:e.epsilon,maxSteps:e.maxIterations,iterationsPerRender:e.iterationsPerRender,step:-1,stress:Number.POSITIVE_INFINITY,prevStress:0,converged:!1,overlapRemoved:!1,done:!1}},context:function(){return{data:null,gridPlacement:function(e,t,n){void 0===n&&(n=8);for(var i=e.length,r=new Float32Array(i),o=new Float32Array(i),a=0,s=0,l=e.length;s<l;s++){var u=t[e[s]];a<u&&(a=u)}var d=a*n,c=Math.ceil(Math.sqrt(i)),h=Math.ceil(i/c),p=-Math.floor((h-1)*d/2),g=-Math.floor((c-1)*d/2);for(s=0;s<c;s++)for(var m=0;m<h;m++)r[s*h+m]=p+m*d,o[s*h+m]=g+s*d;return{x:r,y:o}},connectComponents:function(e,t,n,i,r,o){var a;function s(d,c){var h=new Uint32Array(d.length+1);return h.set(d),h[d.length]=c,h}for(var l=function(d){var c=e[d],h=0,p=0;c.forEach(function(m,b){r.get(m)>h&&(p=b,h=r.get(m))});var g=t[o.get(a=c[p])];g.nodes=s(g.nodes,n),g.weights.push(i),(g=t[o.get(n)]).nodes=s(g.nodes,a),g.weights.push(i)},u=1;u<e.length;u++)l(u)},correctSubgraphsDistances:function(e,t,n,i,r){for(var o=Array.prototype.reduce.call(e[n],function(h,p,g){return g!==n&&p<i&&h<p&&(h=p),h},0),a=i-o-1,s=1;s<t.length;s++)for(var l=t[s],u=0,d=l.length;u<d;u++){var c=r.get(l[u]);e[n][c]-=a,e[c][n]-=a}},initialize:function(e,t){(e.data=t).step=0;var n=new Map,i=new Map;t.normIndexes=t.indexes.reduce(function(h,p,g){return h[g]=g,n.set(p,g),i.set(p,t.degree[g]),p===t.centerIndex&&(e.data.centerIndexPos=g),h},new Uint32Array(t.indexes.length));var r=t.centerIndexPos,o=t.components[0].length;e.connectComponents(t.components,t.attributes.adjacency,t.centerIndex,o,i,n);var a=$c({sources:t.attributes.sources,targets:t.attributes.targets,weights:t.attributes.weights,indexes:t.indexes,adjacency:t.attributes.adjacency,undirected:!0});e.correctSubgraphsDistances(a,t.components,r,o,n);for(var s=(t.D=a)[r],l=Object.create(null),u=0,d=t.normIndexes.length;u<d;u++)if(u!==r){var c=s[u];l[c]=l[c]||[],l[c].push(t.normIndexes[u])}t.rings=l,t.radii=gv(r,t.rings,t.attributes.size,t.nodeGap,t.radiusRatio,t.radiusDelta)},removeOverlaps:function(e,t){var n=e.data.centerIndexPos,i=t.attributes.size,r=t.rings,o=t.x[n],a=t.y[n];for(var s in r){var l=r[s],u=yi(o,a,t.x[l[0]],t.y[l[0]]);eh({X:t.x,Y:t.y,sizes:i,indexes:l,center:[o,a],R:u,gap:t.nodeGap,inPlace:!0})}}}},update:function(e,t){var n,i=(e=e||t.data).indexes,r=e.centerIndex;function o(y){return e.radii[y]||1}e.x=e.x||new Float32Array(e.size),e.y=e.y||new Float32Array(e.size),-1===e.step?t.initialize(t,e):e.step++;var a=e.repulsion;if(0===e.step)e.randomize&&(n=t.gridPlacement(e.indexes,e.attributes.size),e.x=n.x,e.y=n.y);else if(!e.converged)for(var s=e.maxSteps,u=e.step,d=Math.min(u+e.iterationsPerRender,s+1),c=e.D,h=e.x,p=e.y,g=e.size,m=e.centerIndexPos,b=e.normIndexes;u<=d||!e.converged;){var v=nc(Math.min(u,s)/s);e.step=u++,n=nh(c,h,p,g,m,a,v,b,o),e.x=n.x,e.y=n.y,e.prevStress=e.stress,e.stress=th(c,h,p,g,m,a,v,b),e.converged=e.converged||Math.abs(e.stress-e.prevStress)<=e.epsilon}return e.converged&&(e.overlapRemoved||e.allowOverlap?(e.done=!0,e.rings=Object.keys(e.rings).reduce(function(y,E){return y[E]=e.rings[E].map(function(S){return i[S]}),y},{})):(t.removeOverlaps(t,e,r),e.overlapRemoved=!0)),e},isRunning:function(e){var t=e.data;return!t.converged||!t.allowOverlap&&!t.done},onSync:function(e){if(e.renderSteps||e.done)return vv(e)},onEnd:function(e,t){return vv(e)}};function vv(e){for(var t=e.x,n=e.y,i=e.indexes.length,r=t[e.centerIndexPos]-e.cx,o=n[e.centerIndexPos]-e.cy,a=0;a<i;a++)t[a]-=r,n[a]-=o;return{indexes:e.indexes,x:t,y:n}}function yv(){return function(){var e=function(W){var Z,z=(Z=4022871197,function(K){K=K.toString();for(var ce=0;ce<K.length;ce++){var me=.02519603282416938*(Z+=K.charCodeAt(ce));me-=Z=me>>>0,Z=(me*=Z)>>>0,Z+=4294967296*(me-=Z)}return 2.3283064365386963e-10*(Z>>>0)});this.c=1,this.s0=z(" "),this.s1=z(" "),this.s2=z(" "),this.s0-=z(String(W)),this.s0<0&&(this.s0+=1),this.s1-=z(String(W)),this.s1<0&&(this.s1+=1),this.s2-=z(W),this.s2<0&&(this.s2+=1),z=null};function t(W){return new e(W.toString()).next()}e.prototype.next=function(){var W=this;return function(){var Z=2091639*W.s0+2.3283064365386963e-10*W.c;return W.s0=W.s1,W.s1=W.s2,W.s2=Z-(W.c=0|Z)}},e.prototype.nextDouble=function(){var W=this.next();return function(){return W()+11102230246251565e-32*(2097152*W()|0)}},e.prototype.nextInt32=function(){var W=this.next();return function(){return 4294967296*W()|0}};var n=t(42);function i(W){n=t(W)}function r(){return 1e-6*(n()-.5)}for(var o=[0,1],a=[0,2],s=4;s<65535;s<<=2)for(var l=0,u=o.length;l<u;l++)o.push(o[l]|s),a.push((o[l]|s)<<1);function d(W,Z){return(a[255&Z]|o[255&W])+65536*(a[Z>>8&255]|o[W>>8&255])+4294967296*(a[Z>>16&255]|o[W>>16&255])}function c(W,Z){var z=W^Z,K=65535^z,ce=65535^(W|Z),me=W&(65535^Z),Se=z|K>>1,be=z>>1^z,Ie=ce>>1^K&me>>1^ce,De=z&ce>>1^me>>1^me;be=(z=Se)&(K=be)>>2^K&(z^K)>>2,Ie^=z&(ce=Ie)>>2^K&(me=De)>>2,De^=K&ce>>2^(z^K)&me>>2,be=(z=Se=z&z>>2^K&K>>2)&(K=be)>>4^K&(z^K)>>4,Ie^=z&(ce=Ie)>>4^K&(me=De)>>4,De^=K&ce>>4^(z^K)&me>>4,Ie^=(z=Se=z&z>>4^K&K>>4)&(ce=Ie)>>8^(K=be)&(me=De)>>8;var Ve=W^Z,Re=(K=(De^=K&ce>>8^(z^K)&me>>8)^De>>1)|65535^(Ve|(z=Ie^Ie>>1));return((Re=1431655765&((Re=858993459&((Re=252645135&((Re=16711935&(Re|Re<<8))|Re<<4))|Re<<2))|Re<<1))<<1|(Ve=1431655765&((Ve=858993459&((Ve=252645135&((Ve=16711935&(Ve|Ve<<8))|Ve<<4))|Ve<<2))|Ve<<1)))>>>0}var p,g,m=function(W,Z,z){this.left=null,this.right=null,this.code=W,this.left=Z,this.right=z},b=function(W,Z){this.code=W,this.data=Z},v=function(W,Z){this.code=W,this.data=Z};function y(){this.left=null,this.right=null,this.data=null}function E(W){for(var Z=1<<31,z=0;z<31;z+=1){if(Z&W)return z;Z>>>=1}return 32}function S(W,Z,z){var K=W[Z],ce=W[z];if(K===ce)return Z;for(var me,Se=E(K^ce),be=Z,Ie=z-Z;(me=be+(Ie=Ie+1>>1))<z&&Se<E(K^W[me])&&(be=me),1<Ie;);return be}(g=p=p||{})[g.HILBERT=1]="HILBERT",g[g.MORTON=0]="MORTON";var w=function(W,Z){void 0===Z&&(Z={});var z=Z.getX,K=Z.getY,ce=Z.bucketSize;void 0===ce&&(ce=0);var me=Z.sfc;void 0===me&&(me=p.HILBERT);var Se=Z.recursive;void 0===Se&&(Se=!0),this._bucketSize=0,this._root=null;var be,Ie,De,Ve,Re=W.length,Be=new Uint32Array(Re),Oe=1/0,Le=1/0,Ce=-1/0,et=-1/0;this._x=z,this._y=K;var lt=me===p.HILBERT?c:d;this._project=lt;var je=new Uint32Array(Re);for(Ie=0;Ie<Re;Ie++)(De=z(be=W[Ie]))<Oe&&(Oe=De),(Ve=K(be))<Le&&(Le=Ve),Ce<De&&(Ce=De),et<Ve&&(et=Ve),je[Ie]=Ie;this._minX=Oe,this._minY=Le,this._maxX=Ce,this._maxY=et;var Ze=65535/Math.max(Ce-Oe,1),Ue=65535/Math.max(et-Le,1);for(this._hw=Ze,this._hh=Ue,Ie=0;Ie<Re;Ie++)Be[Ie]=lt(Ze*(z(be=W[Ie])-Oe),Ue*(K(be)-Le));(function(W,Z){(function z(K,ce,me,Se){if(!(Se<=me)){for(var be,Ie=ce[me+Se>>1],De=me-1,Ve=Se+1;;){for(;ce[++De]<Ie;);for(;ce[--Ve]>Ie;);if(Ve<=De)break;be=K[De],K[De]=K[Ve],K[Ve]=be,be=ce[De],ce[De]=ce[Ve],ce[Ve]=be}z(K,ce,me,Ve),z(K,ce,Ve+1,Se)}})(W,Z,0,W.length-1)})(je,Be),this._root=0===ce?Se?function tt(Je,ot,St,At,Ot){if(Ot-At==0)return new b(St[At],Je[ot[At]]);var bt=S(St,At,Ot),Mt=tt(Je,ot,St,At,bt),it=tt(Je,ot,St,bt+1,Ot);return new m(bt,Mt,it)}(W,je,Be,0,Re-1):function(tt,Je,ot,St,At){for(var Ot=new y,bt=[Ot],Mt=[0,At];0!==bt.length;){var it=Mt.pop(),pt=Mt.pop(),Et=bt.pop();if(it-pt==0)Et.code=ot[pt],Et.data=tt[Je[pt]];else{var Ct=S(ot,pt,it);pt<=(Et.code=Ct)&&(Et.left=new y,bt.push(Et.left),Mt.push(pt,Ct)),Ct<it&&(Et.right=new y,bt.push(Et.right),Mt.push(Ct+1,it))}}return Ot}(W,je,Be,0,Re-1):Se?function tt(Je,ot,St,At,Ot,bt){if(Ot-At<bt){for(var Mt=new Array(Ot-At+1),it=At,pt=0;it<=Ot;it++,pt++)Mt[pt]=Je[ot[it]];return new v(St[At],Mt)}var Et=S(St,At,Ot),Ct=tt(Je,ot,St,At,Et,bt),jt=tt(Je,ot,St,Et+1,Ot,bt);return new m(Et,Ct,jt)}(W,je,Be,0,Re-1,ce):function(tt,Je,ot,St,At,Ot){for(var bt=new y,Mt=[bt],it=[0,At];0!==Mt.length;){var pt=it.pop(),Et=it.pop(),Ct=Mt.pop();if(pt-Et<Ot){for(var jt=new Array(pt-Et+1),Bt=Et,Cn=0;Bt<=pt;Bt++,Cn++)jt[Cn]=tt[Je[Bt]];Ct.code=ot[Et],Ct.data=jt}else{var nn=S(ot,Et,pt);Et<=(Ct.code=nn)&&(Ct.left=new y,Mt.push(Ct.left),it.push(Et,nn)),nn<pt&&(Ct.right=new y,Mt.push(Ct.right),it.push(nn+1,pt))}}return bt}(W,je,Be,0,Re-1,ce),this._bucketSize=ce},M={root:{configurable:!0}};M.root.get=function(){return this._root},w.prototype.inOrder=function(W,Z){for(var z=this._root,K=[],ce=!1;!ce;)if(z)K.push(z),z=z.left;else if(0!==K.length){if(z=K.pop(),W.call(Z,z))break;z=z.right}else ce=!0;return this},w.prototype.preOrder=function(W,Z){for(var z=[this._root];0!==z.length;){var K=z.pop();W.call(Z,K)||(K.right&&z.push(K.right),K.left&&z.push(K.left))}return this},w.prototype.postOrder=function(W,Z){var z,K=[],ce=this._root;do{for(;ce;)ce.right&&K.push(ce.right),K.push(ce),ce=ce.left;ce=K.pop(),z=K.length-1,ce=ce.right&&K[z]===ce.right?(K[z]=ce).right:(W.call(Z,ce),null)}while(0!==K.length);return this},w.prototype.map=function(W,Z){var z=[];return this.inOrder(function(K){z.push(W.call(Z,K))}),z},w.prototype.height=function(){return function W(Z){return Z?1+Math.max(W(Z.left),W(Z.right)):0}(this._root)},w.prototype.toString=function(W){void 0===W&&(W=function(z){return z.code.toString()});var Z=[];return function z(K,ce,me,Se,be){if(K){Se(ce+(me?"^-- ":"|-- ")+be(K)+"\n");var Ie=ce+(me?"    ":"|   ");K.left&&z(K.left,Ie,!1,Se,be),K.right&&z(K.right,Ie,!0,Se,be)}}(this._root,"",!0,function(z){return Z.push(z)},W),Z.join("")},w.prototype.size=function(){var W=0;return this.preOrder(function(){W++}),W},Object.defineProperties(w.prototype,M);var O=function(W){return W.x},F=function(W){return W.y},L=function(W){return W.r};function N(W,Z,z,K){void 0===Z&&(Z=O),void 0===z&&(z=F),void 0===K&&(K=L);for(var ce,me=function(Ve){for(var Re=Ve.length-1;0<=Re;Re--){var Be=Math.floor(Math.random()*(Re+1));Be=Math.max(Math.min(Be,Re),0);var Oe=Ve[Re];Ve[Re]=Ve[Be],Ve[Be]=Oe}return Ve}(W.slice()),Se=me.length,be=[],Ie=0;Ie<Se;){var De=me[Ie];ce&&J(ce,Z(De),z(De),K(De))?Ie++:(ce=ie(be=B(be,De,Z,z,K),Z,z,K),Ie=0)}return ce}function B(W,Z,z,K,ce){var me=z(Z),Se=K(Z),be=ce(Z),Ie={x:me,y:Se,r:be};if(ae(Ie,W,z,K,ce))return[Z];for(var De=0;De<W.length;++De){var Ve=W[De],Re=z(Ve),Be=K(Ve),Oe=ce(Ve);if(!X(Ie,Re,Be,Oe)&&ae(U(Re,Be,Oe,me,Se,be),W,z,K,ce))return[W[De],Z]}for(var Le=0;Le<W.length-1;Le++)for(var Ce=Le+1;Ce<W.length;Ce++){var et=W[Le],lt=W[Ce],je=z(et),Ze=K(et),Ue=ce(et),tt=z(lt),Je=K(lt),ot=ce(lt);if(!X(U(je,Ze,Ue,tt,Je,ot),me,Se,be)&&!X(U(je,Ze,Ue,me,Se,be),tt,Je,ot)&&!X(U(tt,Je,ot,me,Se,be),je,Ze,Ue)&&ae(Y(je,Ze,Ue,tt,Je,ot,me,Se,be),W,z,K,ce))return[W[Le],W[Ce],Z]}throw new Error}function X(W,Z,z,K){var ce=W.r-K,me=Z-W.x,Se=z-W.y;return 0<=ce&&me*me+Se*Se<ce*ce}function J(W,Z,z,K){var ce=W.r-K+1e-6,me=Z-W.x,Se=z-W.y;return 0<ce&&me*me+Se*Se<ce*ce}function ae(W,Z,z,K,ce){for(var me=0;me<Z.length;++me){var Se=Z[me];if(!J(W,z(Se),K(Se),ce(Se)))return!1}return!0}function ie(W,Z,z,K){return 1===W.length?{x:Z(W[0]),y:z(W[0]),r:K(W[0])}:2===W.length?U(Z(W[0]),z(W[0]),K(W[0]),Z(W[1]),z(W[1]),K(W[1])):Y(Z(W[0]),z(W[0]),K(W[0]),Z(W[1]),z(W[1]),K(W[1]),Z(W[2]),z(W[2]),K(W[2]))}function U(W,Z,z,K,ce,me){var Se=K-W,be=ce-Z,Ie=me-z,De=Math.sqrt(Se*Se+be*be);return{x:(W+K+Se/De*Ie)/2,y:(Z+ce+be/De*Ie)/2,r:(De+z+me)/2}}function Y(W,Z,z,K,ce,me,Se,be,Ie){var De=W-K,Ve=W-Se,Re=Z-ce,Be=Z-be,Oe=me-z,Le=Ie-z,Ce=W*W+Z*Z-z*z,et=Ce-K*K-ce*ce+me*me,lt=Ce-Se*Se-be*be+Ie*Ie,je=Ve*Re-De*Be,Ze=(Re*lt-Be*et)/(2*je)-W,Ue=(Be*Oe-Re*Le)/je,tt=(Ve*et-De*lt)/(2*je)-Z,Je=(De*Le-Ve*Oe)/je,ot=Ue*Ue+Je*Je-1,St=2*(z+Ze*Ue+tt*Je),At=Ze*Ze+tt*tt-z*z,Ot=-(ot?(St+Math.sqrt(St*St-4*ot*At))/(2*ot):At/St);return{x:W+Ze+Ue*Ot,y:Z+tt+Je*Ot,r:Ot}}function he(W,Z,z,K,ce){var me=K.X,Se=K.Y,be=K.R,Ie=K.fx,De=K.fy,Ve=K.masses,Re=ce.friction,Be=ce.theta,Oe=ce.charge,Le=Math.floor(Math.log(Z.length));null===z&&(z=new w(Z,{getX:function(je){return me[je]},getY:function(je){return Se[je]},recursive:!0,bucketSize:Le})).postOrder(function(je){var Ze,Ue,tt,Je,ot,St=0;if(void 0!==je.data)if(je.data.length){var At=N(je.data,function(Tn){return me[Tn]},function(Tn){return Se[Tn]},function(Tn){return be[Tn]});Ze=At.x,Ue=At.y,tt=At.r;for(var Ot=0;Ot<je.data.length;Ot++)St+=Ve[je.data[Ot]]}else Ze=me[ot=je.data],Ue=Se[ot],tt=be[ot],St=Ve[ot];else if(je.left&&je.right){var bt=je.left.cx,Mt=je.left.cy,it=je.right.cx,pt=je.right.cy,Et=je.left.r,Ct=je.right.r,jt=it-bt,Bt=pt-Mt,Cn=Ct-Et,nn=Math.sqrt(jt*jt+Bt*Bt);Ze=(bt+it+jt/nn*Cn)/2,Ue=(Mt+pt+Bt/nn*Cn)/2,tt=(nn+Et+Ct)/2,St=je.left.mass+je.right.mass}else Ze=(Je=je.left||je.right).cx,Ue=Je.cy,tt=Je.r,St=Je.mass;je.cx=Ze,je.cy=Ue,je.r=tt,je.mass=St});for(var Ce=Z.length,et=function(je){var Ze=Z[je],Ue=me[Ze],tt=Se[Ze],Je=be[Ze];z.preOrder(function(ot){var At=0,Ot=0,bt=Ue-ot.cx||r(),Mt=tt-ot.cy||r(),it=bt*bt+Mt*Mt,pt=Je+ot.r;if(ot.data){if(ot.data===Ze)return!1;if(ot.data.length)for(var Et=0;Et<ot.data.length;Et++){var Ct=ot.data[Et];Ct!==Ze&&(it=(bt=Ue-me[Ct]||r())*bt+(Mt=tt-Se[Ct]||r())*Mt,pt=Je+be[Ct],it<1&&(it=Math.sqrt(1*it)),Ie[Ze]+=bt*(At=W*(Oe*Ve[Ct])/it),De[Ze]+=Mt*At)}else it<1&&(it=Math.sqrt(1*it)),it<pt*pt&&(it=Re*pt*pt),Ie[Ze]+=bt*(At=W*(Oe*ot.mass)/it),De[Ze]+=Mt*At}else if((Ot=pt/Be)*Ot<=it)return it<1&&(it=Math.sqrt(1*it)),it<pt*pt&&(it=Re*pt*pt),Ie[Ze]+=bt*(At=W*(Oe*ot.mass)/it),De[Ze]+=Mt*At,!0})},lt=0;lt<Ce;lt++)et(lt);return z}function pe(W,Z,z,K){for(var ce=z.sources,me=z.targets,Se=z.X,be=z.Y,Ie=z.R,De=z.fx,Ve=z.fy,Re=z.degrees,Be=K.edgeStrength,Oe=K.edgeLength,Le=0;Le<Z.length;Le++){var Ce=Z[Le],et=ce[Ce],lt=me[Ce],je=Re[et]+1,Ze=Re[lt]+1,Ue=Se[lt]+De[lt]-Se[et]-De[et]||r(),tt=be[lt]+Ve[lt]-be[et]-Ve[et]||r(),Je=Ue*Ue+tt*tt,ot=Math.sqrt(Je),St=Oe+Ie[et]+Ie[lt];if(!(ot<=St)){var At=St-ot,Ot=W*Be*At*At/Je/Math.min(je,Ze);tt*=Ot;var bt=Ze/(Ze+je);De[et]+=(Ue*=Ot)*bt,Ve[et]+=tt*bt,De[lt]-=Ue*(1-bt),Ve[lt]-=tt*(1-bt)}}}function we(W,Z,z,K){for(var ce=z.pinned,me=z.X,Se=z.Y,be=z.fx,Ie=z.fy,De=K.gravity,Ve=K.cx,Re=K.cy,Be=0,Oe=0,Le=Z.length,Ce=0;Ce<Le;Ce++)Be+=me[Ce],Oe+=Se[Ce];Be=Be/Le-Ve,Oe=Oe/Le-Re;for(var et=0;et<Le;et++){var lt=Z[et];ce[lt]||(me[lt]-=Be,Se[lt]-=Oe)}for(var je=0;je<Le;je++){var Ze=Z[je],Ue=Ve-me[Ze]||r(),tt=Re-Se[Ze]||r(),Je=De*W;be[Ze]+=Ue*Je,Ie[Ze]+=tt*Je}}he.initialize=function(W,Z,z){for(var K=Z.X,ce=Z.Y,me=Z.R,Se=Z.degrees,be=Z.layer,Ie=Z.pinned,De=Z.component,Ve=Z.masses,Re=Z.nodeIds,Be=z.scaling,Oe=z.defaultRadius,Le=W.length,Ce=1/0,et=1/0,lt=-1/0,je=-1/0,Ze=Math.PI*(3-Math.sqrt(5)),Ue=0;Ue<W.length;Ue++){var tt=W[Ue],Je=tt.x,ot=tt.y,St=tt.r,At=tt.mass;if(isNaN(Je)||isNaN(ot)){var Ot=10*Math.sqrt(Ue),bt=Ue*Ze;Je=Ot*Math.cos(bt),ot=Ot*Math.sin(bt)}K[Ue]=Je,ce[Ue]=ot,me[Ue]=St||Oe,Ie[Ue]=tt.pinned?1:0,be[Ue]=tt.layer,De[Ue]=tt.component,Ve[Ue]=void 0===At?(1+Se[Ue])*Be:At,Re[Ue]=Ue,Je<Ce&&(Ce=Je),ot<et&&(et=ot),lt<Je&&(lt=Je),je<ot&&(je=ot)}if(1<W.length&&(lt-Ce==0||je-et==0))for(var Mt=(Ce+lt)/2,it=(et+je)/2,pt=0;pt<Le;pt++)if(!Ie[pt]){var Et=10*Math.sqrt(pt),Ct=pt*Ze,jt=Mt+Et*Math.cos(Ct),Bt=it+Et*Math.sin(Ct);(K[pt]=jt)<Ce&&(Ce=jt),(ce[pt]=Bt)<et&&(et=Bt),lt<jt&&(lt=jt),je<Bt&&(je=Bt)}},pe.initialize=function(W,Z){for(var z=Z.edgeIds,K=Z.sources,ce=Z.targets,me=Z.degrees,Se=0;Se<W.length;Se++){var be=W[Se],Ie=be.source,De=be.target;K[Se]=Ie,ce[Se]=De,me[Ie]++,me[De]++,z[Se]=Se}},we.initialize=function(W,Z,z){var K=Z.X,ce=Z.Y,me=z.cx,Se=z.cy,be=W.length;if(void 0===me||void 0===Se){me=Se=0;for(var Ie=0;Ie<be;Ie++)me+=K[Ie],Se+=ce[Ie];me/=be,Se/=be}z.cx=me,z.cy=Se};var at,st,Xe=function(){this.ids=[],this.xmin=1/0,this.ymin=1/0,this.xmax=-1/0,this.ymax=-1/0,this.x=0,this.y=0,this.w=0,this.h=0,this.cx=0,this.cy=0,this.radius=0,this.mx=0,this.my=0,this.m=0,this.maxr=0};function xt(W,Z){return(W+Z)*(W+Z+1)/2+Z}function Ge(W,Z,z,K){var ce=z.X,me=z.Y,Se=z.R,be=z.components,Oe=K.update,Le=K.onUpdate,Ce=K.placement,et=K.placementOffset;if(K.alignSiblings&&(function(W,Z,z){var ce=W.sources,me=W.targets,Se=W.pinned,be=W.degrees,Ie=W.X,De=W.Y,Ve=W.R;void 0===Z&&(Z=0),void 0===z&&(z=.5);for(var Re={},Be={},Oe=0,Le=W.edgeIds;Oe<Le.length;Oe+=1){var Ce=Le[Oe],et=ce[Ce],lt=me[Ce];et!==lt&&(Re[et]=Re[et]||{},Re[lt]=Re[lt]||{},Re[et][lt]=!0,Re[lt][et]=!0)}Object.keys(Re).forEach(function(je){var Ze,Ue,tt=Number(je),Je=Object.keys(Re[Number(tt)]);if(2===Je.length){var ot=Je[0],St=Je[1],At=(Ze=Number(ot))<(Ue=Number(St))?Ze*Ue+Math.pow(Ue-Ze-1,2)/4:Ze*Ue+Math.pow(Ze-Ue-1,2)/4;At in Be||(Be[At]=[Number(St),Number(ot)]),Se[tt]||Be[At].push(tt)}}),Object.keys(Be).forEach(function(je){var Ze=Be[Number(je)],Ue=Ze[0],tt=Ze[1],Je=Ze.slice(2);if(1!==Je.length){var ot=Ie[Ue],St=De[Ue],At=Ie[tt],Ot=De[tt],bt=be[Ue],Mt=.25+.5*bt/(bt+be[tt]),it=ot+(At-ot)*Mt,pt=St+(Ot-St)*Mt,Et=-(Ot-St),Ct=At-ot,jt=Math.sqrt(Math.pow(ot-At,2)+Math.pow(St-Ot,2));Et=-2*Et/jt,Ct=-2*Ct/jt;var Bt=Math.acos(Et/Math.sqrt(Et*Et+Ct*Ct));0<Z&&(Bt<Z||Bt>Math.PI-Z&&Bt<=Math.PI?(Et=2*Math.cos(Math.PI-Z),Ct=2*Math.sin(Math.PI-Z)):(Bt>2*Math.PI-Z||Bt>=Math.PI&&Bt<Math.PI+Z)&&(Et=2*Math.cos(Z),Ct=2*Math.sin(Z)));var Cn=0,nn=1;Je.sort(function(fi,bn){return Ve[bn]-Ve[fi]});var Tn=0,Rn=0,In=Math.max(Ve[Je[0]],Ve[Je[1]])/2;Je.length%2==1&&(Cn=1,it-=Et*In,pt-=Ct*In);for(var Gn=1+z,rn=0;rn<Je.length;rn++){var fn=(Cn+rn)%2,zn=Je[rn],kn=2<=rn?Ve[zn]:In,Ln=(fn?Tn:Rn)+kn;Ie[zn]=it+Et*nn*Ln,De[zn]=pt+Ct*nn*Ln,fn?Tn+=kn*Gn:Rn+=kn*Gn,nn=-nn}}})}({X:ce,Y:me,R:Se,degrees:z.degrees,pinned:z.pinned,sources:z.sources,targets:z.targets,edgeIds:z.edgeIds},K.siblingsMinAngle,K.siblingsOffset),Oe(W,ce,me)),Ce in at){var Ue=function(Cn,nn,Tn,Rn){for(var In=0,Gn=[],rn=0,fn=Rn;rn<fn.length;rn+=1){for(var zn=fn[rn],kn=new Xe,Ln=0,fi=zn;Ln<fi.length;Ln+=1){var bn=fi[Ln];kn.add(bn,Cn[bn],nn[bn],Tn[bn])}Gn.push(kn.measure()),zn.length>Gn[In].ids.length&&(In=Gn.length-1)}return{boxes:Gn,biggest:In}}(ce,me,Se,be),tt=Ue.boxes,Je=Ue.biggest;if(Ce===at.spiral)!function(Cn,nn,Tn,Rn,In){void 0===nn&&(nn=20);for(var Gn=0,rn=Cn;Gn<rn.length;Gn+=1){var fn=rn[Gn],zn=N(fn.ids,function(Bn){return Tn[Bn]},function(Bn){return Rn[Bn]},function(Bn){return In[Bn]}),Ln=zn.y,fi=zn.r;fn.cx=zn.x,fn.cy=Ln,fn.radius=fi+nn}for(var bn=Cn.slice().sort(function(Bn,uo){return Bn.radius-uo.radius}),br=bn.map(function(Bn){return{x:Bn.cx,y:Bn.cy,r:Bn.radius}}),wi=bn.pop(),ni=3*Math.PI/2,tr=wi.radius,Oi=2*Math.PI,Ni=wi.cx,Lr=wi.cy,Wr=[wi],To=function(){var Bn=bn[bn.length-1],uo=tr+Bn.radius,ds=Ni+Math.cos(ni)*uo,$s=Lr+Math.sin(ni)*uo;Wr.some(function(Vu){var eu=Vu.cx-ds,Oa=Vu.cy-$s;return Math.sqrt(eu*eu+Oa*Oa)<Vu.radius+Bn.radius})?tr+=1:(Bn.x=ds-Bn.w/2,Bn.y=$s-Bn.h/2,Bn.cx=ds,Bn.cy=$s,br[bn.length-1].x=ds,br[bn.length-1].y=$s,Wr.push(bn.pop()),ni+=(2*Bn.radius+1)/uo*1%Oi)};0!==bn.length;)To()}(tt,et,ce,me,Se);else{if(Ce!==at.box)return;!function(W,Z){void 0===Z&&(Z=1),function(z){for(var K=0,ce=0,me=0,Se=z;me<Se.length;me+=1){var be=Se[me];K+=be.w*be.h,ce=Math.max(ce,be.w)}z.sort(function(lt,je){return je.h-lt.h});for(var Ie=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(K/.95)),ce),h:1/0}],De=0,Ve=0,Re=0,Be=z;Re<Be.length;Re+=1)for(var Oe=Be[Re],Le=Ie.length-1;0<=Le;Le--){var Ce=Ie[Le];if(!(Oe.w>Ce.w||Oe.h>Ce.h)){if(Oe.x=Ce.x,Oe.y=Ce.y,Ve=Math.max(Ve,Oe.y+Oe.h),De=Math.max(De,Oe.x+Oe.w),Oe.w===Ce.w&&Oe.h===Ce.h){var et=Ie.pop();Le<Ie.length&&(Ie[Le]=et)}else Oe.h===Ce.h?(Ce.x+=Oe.w,Ce.w-=Oe.w):(Oe.w===Ce.w||Ie.push({x:Ce.x+Oe.w,y:Ce.y,w:Ce.w-Oe.w,h:Oe.h}),Ce.y+=Oe.h,Ce.h-=Oe.h);break}}}(W.map(function(z){return z.w+=z.maxr+Z,z.h+=z.maxr+Z,z}).sort(function(z,K){return z.w*z.h-K.w*K.h}))}(tt,et)}for(var ot=tt[Je].xmin-tt[Je].x,St=tt[Je].ymin-tt[Je].y,At=0,Ot=tt;At<Ot.length;At+=1)for(var bt=Ot[At],pt=bt.xmin-bt.x-ot,Et=bt.ymin-bt.y-St,Ct=0,jt=bt.ids;Ct<jt.length;Ct+=1){var Bt=jt[Ct];ce[Bt]-=pt,me[Bt]-=Et}Oe(W,ce,me),Le()}}function He(W,Z,z,K,ce,me){var Se,be=z.X,Ie=z.Y,De=z.R,Ve=z.degrees,Re=z.nodeIds,Be=z.edgeIds,Oe=z.layers,Le=z.layer,Ce=z.cluster,et=z.masses,lt=z.weights,je=z.sources,Ze=z.targets,Ue=K.cx,tt=K.cy,Je=K.nextTick,ot=K.cancelTick,St=K.update,At=K.onUpdate,Ot=K.batch,Mt=K.steps,it=K.minMovement,pt=Oe.slice(),Et=0;function Ct(){ot(Se),St(W,be,Ie),At(),me()}for(var jt={},Bt=0;Bt<Z.length;Bt++)jt[Number(Z[Bt].id)||Bt]=Bt;for(var Cn=new Map,nn=0;nn<Be.length;nn++){var Tn=Be[nn];Cn.set(xt(je[Tn],Ze[Tn]),Tn)}for(var Rn=0;Rn<Oe.length;Rn++){for(var In=Oe[Rn],Gn=Rn,rn=0;rn<In.length;rn++){var fn=In[rn],zn=Ce[fn];-1!==zn&&(et[zn]+=et[fn])}for(var kn=0;kn<Z.length;kn++){var Ln=Z[kn],fi=Number(Ln.id)||kn,bn=Ln.source,br=Ln.target,wi=lt[jt[fi]];if(Le[bn]===Gn&&Le[br]===Gn){var ni=Ce[bn],tr=Ce[br];if(ni!==tr){var Oi=Cn.get(xt(ni,tr));void 0!==Oi&&(lt[Oi]+=wi)}}}}Re.length=0,Be.length=0;var Ni,Lr,Wr=1,Bn=1-Math.pow(.1,1/Mt/2),uo=(Wr-.1)/Mt,ds=.5;return Se=setTimeout(function $s(){var Vu=ce(Wr+=(0-Wr)*Bn,Re,Be),eu=Wr<=ds||Vu<it;if(0===Et||eu){var Oa=pt.pop();if(Oa){Ni&&(Lr=Ni.reduce(function(cd,hd){return Math.max(cd,Ue-be[hd],tt-Ie[hd])},0)),Re.push.apply(Re,Oa);for(var Ch=0;Ch<Oa.length;Ch++){var Na=Oa[Ch],Uu=Ce[Na];if(-1!==Uu){var My=1<Ve[Na]?2:1,Iy=De[Uu]+De[Na];et[Uu]-=et[Na],be[Na]=be[Uu]+My*Iy*(2*n()-1),Ie[Na]=Ie[Uu]+My*Iy*(2*n()-1)}else Ni&&(be[Na]=Ue+2*Lr*(1-2*n()),Ie[Na]=tt+2*Lr*(1-2*n()))}Ni=Oa;for(var ky=Re.reduce(function(cd,hd){return cd[hd]=!0,cd},{}),Th=Be.length=0;Th<Z.length;Th++){var Mh=Z[Th];ky[Mh.source]&&ky[Mh.target]&&Be.push(jt[Number(Mh.id)])}eu=!1,Wr=0===pt.length?.2:.1+2*uo,ds=.1}}Et%Ot==0&&(St(W,be,Ie),At()),++Et>=Infinity||eu?Ct():Se=Je($s)}),{done:!1,stop:function(){return Ct(),this},get iterations(){return Et}}}function Pe(W,Z,z){for(var K=z.X,ce=z.Y,me=z.fx,Se=z.fy,be=z.pinned,Ie=0,De=W.length,Ve=0;Ve<De;Ve++){var Re=W[Ve],Be=me[Re]*=Z,Oe=Se[Re]*=Z;if(be[Re])me[Re]=Se[Re]=0;else{var Le=Be,Ce=Oe;if(1e4<Le||1e4<Ce){var et=Math.sqrt(Le*Le+Ce*Ce);Ce/=et,Le/=et}K[Re]+=Le,ce[Re]+=Ce,Ie+=.5*(Le*Le+Ce*Ce)}}return Ie}Xe.prototype.add=function(W,Z,z,K){this.ids.push(W),Z-K<this.xmin&&(this.xmin=Z-K),z-K<this.ymin&&(this.ymin=z-K),Z+K>this.xmax&&(this.xmax=Z+K),z+K>this.ymax&&(this.ymax=z+K),K>this.maxr&&(this.maxr=K),this.mx+=K*Z,this.my+=K*z,this.m+=K},Xe.prototype.measure=function(W){return void 0===W&&(W=0),this.w=this.xmax-this.xmin+2*W,this.h=this.ymax-this.ymin+2*W,this.cx=this.mx/this.m,this.cy=this.my/this.m,this.x=this.xmin,this.y=this.ymin,this.radius=Math.sqrt(this.w*this.w+this.h*this.h)/2,this},(st=at=at||{}).none="none",st.box="box",st.spiral="spiral";var We=0,Qe="undefined"==typeof window,nt="undefined"!=typeof performance&&performance.now?performance:Date,Me=Qe?function(W){var Z=nt.now(),z=Math.max(0,16-(Z-We)),K=setTimeout(function(){return W(Z+z)},z);return We=Z+z,K}:window.requestAnimationFrame,ze=Qe?function(W){return clearTimeout(W)}:window.cancelAnimationFrame;function qe(W,Z,z){for(var K=0;K<W.length;K++){var ce=W[K];ce.x=Z[K],ce.y=z[K]}}function Ke(){}function ht(W){for(var Z in void 0===W&&(W={}),this.onUpdate=Ke,this.update=qe,this.nextTick=Me,this.cancelTick=ze,this.onEnd=Ke,this.charge=10,this.maxIterations=1e3,this.minMovement=.1,this.edgeLength=30,this.edgeStrength=2,this.friction=.1,this.elasticity=.9,this.margin=1,this.cx=void 0,this.cy=void 0,this.gravity=.01,this.theta=.34,this.batch=1,this.inertia=.9,this.integrator=0,this.multilevel=!1,this.placement=at.none,this.placementOffset=10,this.alignSiblings=!1,this.siblingsMinAngle=0,this.siblingsOffset=.15,this.steps=300,this.scaling=1,this.defaultRadius=1,W)void 0!==W[Z]&&(this[Z]=W[Z])}function $t(W){var Z=W.nodes.length,z=W.edges.length;i(Z+z),this.X=new Array(Z),this.Y=new Array(Z),this.R=new Array(Z),this.fx=new Float32Array(Z),this.fy=new Float32Array(Z),this.vx=new Float32Array(Z),this.vy=new Float32Array(Z),this.pinned=new Uint8Array(Z),this.masses=new Float32Array(Z),this.weights=new Float32Array(z),this.sources=new Uint16Array(z),this.targets=new Uint16Array(z),this.degrees=new Uint32Array(Z),this.layer=new Uint32Array(Z),this.parent=new Int32Array(Z),this.cluster=new Int32Array(Z),this.component=new Uint16Array(Z),this.components=[],this.layers=[],this.nodeIds=new Array(Z),this.edgeIds=new Array(z),function(W,Z,z){(function(K,ce,me){for(var Se=me.sources,be=me.targets,Ie=me.degrees,De=me.nodeIds,Ve=me.edgeIds,Re={},Be=0;Be<K.length;Be++)Re[Be]=De[Be]=Be;for(var Oe=0;Oe<ce.length;Oe++){var Le=ce[Oe],lt=Re[Le.source],je=Re[Le.target];Ve[Oe]=Oe,Se[Oe]=lt,be[Oe]=je,Ie[lt]++,Ie[je]++}})(W,Z,z),function(K){for(var ce=K.nodeIds,me=K.edgeIds,Se=K.sources,be=K.targets,Ie=K.degrees,De=K.layer,Ve=K.layers,Re=K.component,Be=K.components,Oe=K.cluster,Le=K.parent,Ce=0,et=1,lt=new Uint32Array(ce.length),je=0;je<ce.length;je++)lt[je]=Ie[je];for(var Ze=new Array(ce.length),Ue=0;Ue<me.length;Ue++){var tt=me[Ue],Je=Se[tt],ot=be[tt];Ze[Je]=Ze[Je]||[],Ze[ot]=Ze[ot]||[],Ze[Je].push(ot),Ze[ot].push(Je)}var St=new Uint8Array(ce.length),At=new Uint8Array(ce.length);Le.fill(-1);for(var Ot=0,bt=0;bt<ce.length;bt++)if(0===St[bt]){for(var Mt=[bt];0!==Mt.length;){var it=Mt.pop();0===St[it]&&(Mt.push.apply(Mt,Ze[it]),St[it]=1,Re[it]=Ot)}Ot++}for(var pt=new Array(ce.length),Et=0;Et<ce.length;Et++)De[Et]=0,pt[Et]=Et;for(;0!==pt.length;){for(var Ct=[],jt=[],Bt=0;Bt<pt.length;Bt++)lt[pt[Bt]]<=Ce&&(Ct.push(Bt),jt.push(pt[Bt]));for(var Cn=0;Cn<jt.length;Cn++){var nn=jt[Cn];At[nn]=Ce,De[nn]=et;var Tn=Ze[nn];if(Tn)for(var Rn=0;Rn<Tn.length;Rn++)lt[Tn[Rn]]--}for(var In=0;In<jt.length;In++){var Gn=jt[In],rn=Ze[Gn];if(rn)for(var fn=0;fn<rn.length;fn++){var zn=rn[fn],kn=De[zn];if(void 0===kn||et<kn){Le[Gn]=zn;break}}}Ct.reverse();for(var Ln=0;Ln<Ct.length;Ln++)pt.splice(Ct[Ln],1);if(et+=1,0<pt.length){for(var fi=1/0,bn=0;bn<pt.length;bn++){var br=lt[pt[bn]];br<fi&&(fi=br)}Ce+1<=fi&&(Ce=fi,et=1)}}St.fill(0);for(var wi=0;wi<ce.length;wi++){var ni=ce[wi],tr=De[ni];if(-1===Le[ni]||De[Le[ni]]===tr){var Oi=[ni];for(St.fill(0);0!==Oi.length;){var Ni=Oi.pop();if(!St[Ni]){if(De[Ni]>tr){Le[ni]=Ni;break}var Lr=Ze[Ni];St[Ni]=1,Lr&&Oi.push.apply(Oi,Lr)}}}}for(var Wr=0;Wr<ce.length;Wr++){var To=ce[Wr],Bn=Re[To];Be[Bn]=Be[Bn]||[],Be[Bn].push(To);var uo=De[To]-1;Ve[uo]=Ve[uo]||[],Ve[uo].push(To),Oe[To]=Le[To]}}(z)}(W.nodes,W.edges,this)}function dn(W){this.promise=new Promise(W)}dn.prototype.then=function(W){return this.promise.then(W)},dn.prototype.stop=function(){return this.simulation.stop(),this},dn.prototype.iterations=function(){return this.simulation.iterations};var sn={euler:function(W,Z,z){for(var K=z.X,ce=z.Y,me=z.fx,Se=z.fy,be=z.vx,Ie=z.vy,De=z.masses,Ve=z.pinned,Re=0,Be=0,Oe=W.length,Le=0;Le<Oe;Le++){var Ce=W[Le],et=De[Ce],lt=me[Ce]/et,je=Se[Ce]/et;be[Ce]+=1/8*lt,Ie[Ce]+=1/8*je;var Ze=.2*be[Ce]*(1/8)+.5*lt*(1/8)*(1/8),Ue=.2*Ie[Ce]*(1/8)+.5*je*(1/8)*(1/8);me[Ce]=Se[Ce]=0,Ve[Ce]||(K[Ce]+=Ze,ce[Ce]+=Ue,Re+=Math.abs(Ze)*et,Be+=Math.abs(Ue)*et)}return(Re*Re+Be*Be)/Oe},verlet:Pe,leapfrog:function(W,Z,z){for(var K=z.X,ce=z.Y,me=z.fx,Se=z.fy,be=z.vx,Ie=z.vy,De=z.pinned,Ve=z.masses,Re=W.length,Be=0,Oe=0;Oe<Re;Oe++){var Le=W[Oe],Ce=Ve[Le],je=be[Le]+me[Le]/Ce*1,Ze=Ie[Le]+Se[Le]/Ce*1,Ue=1*je,tt=1*Ze;1e4<Ue&&(Ue=.1),1e4<tt&&(tt=.1),be[Le]=Z*(je+be[Le])/2,Ie[Le]=Z*(Ze+Ie[Le])/2,me[Le]=Se[Le]=0,De[Le]||(K[Le]+=Ue,ce[Le]+=tt),Be+=.5*(Ue*Ue+tt*tt)}return Be}};function pn(W,Z){var z,K;function ce(Be){return void 0===Be&&(Be={nodes:[],edges:[]}),i(xt((z=Be.nodes).length,(K=Be.edges).length)),new $t(Be)}function me(Be){return void 0===Be&&(Be={}),new ht(Be)}void 0===Z&&(Z={});var Se=ce(W),be=me(Z);function Ie(Be,Oe,Le){return Re=null,Oe.length<=1?0:(Re=he(Be,Oe,Re,Se,be),pe(Be,Le,Se,be),0!==be.elasticity&&function(Ce,et,lt,je){var Ze=lt.X,Ue=lt.Y,tt=lt.R,Je=lt.fx,ot=lt.fy,St=je.margin,At=je.elasticity;if(0!==At){if(!et){var Ot=Math.floor(Math.log(Ce.length));(et=new w(Ce,{getX:function(it){return Ze[it]},getY:function(it){return Ue[it]},bucketSize:Ot})).postOrder(function(it){var pt,Et,Ct,jt,Bt;if(it.data)pt=Ze[Bt=it.data],Et=Ue[Bt],Ct=tt[Bt];else if(it.left&&it.right){var Cn=it.left.cx,nn=it.left.cy,Tn=it.right.cx,Rn=it.right.cy,In=it.left.r,Gn=it.right.r,rn=Tn-Cn,fn=Rn-nn,zn=Gn-In,kn=Math.sqrt(rn*rn+fn*fn);pt=(Cn+Tn+rn/kn*zn)/2,Et=(nn+Rn+fn/kn*zn)/2,Ct=(kn+In+Gn)/2}else(jt=it.left||it.right)&&(pt=jt.cx,Et=jt.cy,Ct=jt.r);it.cx=pt,it.cy=Et,it.r=Ct})}for(var bt=function(it){var pt=Ce[it],Et=Ze[pt]+Je[pt],Ct=Ue[pt]+ot[pt],jt=tt[pt];et.preOrder(function(Bt){if(!Bt.data){var Cn=Bt.cx-Et,nn=Bt.cy-Ct,Tn=Bt.r+jt;return Tn*Tn<Cn*Cn+nn*nn}if(Bt.data.length)for(var Rn=0;Rn<Bt.data.length;Rn++){var In=Bt.data[Rn];if(pt<In){var Gn=tt[In],rn=Et-Ze[In],fn=Ct-Ue[In],zn=jt+Gn+St,kn=rn*rn+fn*fn;if(kn<zn*zn){0===rn&&(kn+=(rn=r())*rn),0===fn&&(kn+=(fn=r())*fn);var Ln=(zn-(kn=Math.sqrt(kn)))*At/kn,fi=Gn/zn;Je[pt]+=rn*Ln*fi,ot[pt]+=fn*Ln*fi,Je[In]-=rn*Ln*(1-fi),ot[In]-=fn*Ln*(1-fi)}}}else{var bn=Bt.data;if(pt<bn){var br=tt[bn],wi=Et-Ze[bn],ni=Ct-Ue[bn],tr=jt+br+St,Oi=wi*wi+ni*ni;if(Oi<tr*tr){0===wi&&(Oi+=(wi=r())*wi),0===ni&&(Oi+=(ni=r())*ni);var Ni=(tr-(Oi=Math.sqrt(Oi)))*At/Oi,Lr=br/tr;Je[pt]+=wi*Ni*Lr,ot[pt]+=ni*Ni*Lr,Je[bn]-=wi*Ni*(1-Lr),ot[bn]-=ni*Ni*(1-Lr)}}}})},Mt=0;Mt<Ce.length;Mt++)bt(Mt)}}(Oe,Re,Se,be),we(Be,Oe,Se,be),Ve(Oe,be.inertia,Se))}ce(W),me(Z),pe.initialize(K,Se),he.initialize(z,Se,be),we.initialize(z,Se,be);var De,Ve=sn[be.integrator]||Pe,Re=null;return{setOptions:me,setGraph:ce,start:function(){return De=(be.multilevel?He:function(Be,Oe,Le,Ce,et,lt){function je(){Cn=!0,At(Ze),Et(),lt()}var Ze,Ue=Le.X,tt=Le.Y,Je=Le.nodeIds,ot=Le.edgeIds,St=Ce.nextTick,At=Ce.cancelTick,Ot=Ce.batch,bt=Ce.maxIterations,it=Ce.minMovement,pt=Ce.update,Et=Ce.onUpdate,Ct=0,jt=1,Bt=1-Math.pow(.1,1/Ce.steps),Cn=!1,nn=function(){var Tn=et(jt+=(0-jt)*Bt,Je,ot),Rn=Cn||jt<.1||Tn<=it;Ct%Ot==0&&(pt(Be,Ue,tt),Et()),++Ct<bt&&!Rn?Ze=St(nn):je()};return Ze=setTimeout(nn),{done:!1,stop:function(){return je(),this},get iterations(){return Ct}}})(z,K,Se,be,Ie,function(){De.done||Ge(z,0,Se,be),be.onEnd(),De.done=!0}),this},iterations:function(){return De.iterations},data:function(){return Se},stop:function(){return De&&De.stop(),this},step:function(Be){return void 0===Be&&(Be=1),Ie(Be,Se.nodeIds,Se.edgeIds),this}}}return pn.run=function(W,Z){var z,K=new dn(function(ce){Z.onEnd=ce,z=pn(W,Z).start()});return K.simulation=z,K.stop=function(){return z.stop(),K},K.iterations=function(){return z.iterations},K},pn}().apply(this,arguments)}var bS={imports:{force:yv},configure:function(e,t){var n=t.graph,i=e.nodes._indexes,r=n.getNodeAttribute("x").getMultiple(i),o=n.getNodeAttribute("y").getMultiple(i),a=n.getNodeAttribute("radius").getMultiple(i),s=n.getNodeAttribute("layoutable").getMultiple(i),l=e.nodes.getAdjacentEdges(),u=[],d=[],c={};e.edgeStrength=void 0!==e.edgeStrength?1.5*e.edgeStrength:.75,null==e.gravity&&(e.gravity=.05),null==e.siblingsOffset&&(e.siblingsOffset=0),e.alignSiblings=!!e.alignSiblings;for(var h=e.radiusRatio||1.25,p=0;p<e.nodes._indexes.length;p++)c[e.nodes._indexes[p]]=p,u.push({id:p,x:r[p],y:o[p],r:a[p]*h,pinned:!s[p]});l.forEach(function(b){var v=c[b.getSource()._index],y=c[b.getTarget()._index];v!==y&&void 0!==v&&void 0!==y&&d.push({source:v,target:y})});var m=Wi(Nt({},e));return delete m.nodes,{graph:{nodes:u,edges:d},options:m,indexes:e.nodes._indexes,done:!1,x:r,y:o}},update:function(e,t){if(!t.simulation){t.graph=e.graph,t.options=e.options,t.indexes=e.indexes,e.options.nextTick=function(a){return a()},e.options.update=function(a,s,l){t.x=s,t.y=l},e.options.onEnd=function(){return t.done=!0};var n=yv(e.graph,e.options).start(),i=n.data(),r=i.X,o=i.Y;t.simulation=n,t.x=r,t.y=o}return{graph:t.graph,indexes:t.indexes,x:t.x,y:t.y}},context:function(){return{done:!1,graph:null,x:null,y:null,indexes:null}},isRunning:function(e){return!e.done},onSync:function(e){return{indexes:e.indexes,x:e.x,y:e.y}}};function xv(e,t,n,i){var r;if(i)r=i;else{r=new Uint32Array(e.length);for(var o=0,a=e.length;o<a;o++)r[o]=o}var s=n?function(d,c,h,p,g,m){var b=h-d,v=p-c,y=m-g,E=Math.sqrt(b*b+v*v);return[(d+h+b/E*y)/2,(c+p+v/E*y)/2,(E+g+m)/2]}:function(d,c,h,p){var g=d-h,m=c-p;return[(d+h)/2,(c+p)/2,Math.sqrt(g*g+m*m)/2]},l=n?function(d,c,h,p,g,m,b,v,y){var E=2*(d-h),S=2*(c-p),w=2*(v-b),M=d*d+c*c-b*b-h*h-p*p+v*v,O=2*(d-g),F=2*(c-m),L=2*(y-b),N=d*d+c*c-b*b-g*g-m*m+y*y,B=O*S-E*F,X=(S*N-F*M)/B-d,J=(F*w-S*L)/B,ae=(O*M-E*N)/B-c,ie=(E*L-O*w)/B,U=J*J+ie*ie-1,Y=2*(X*J+ae*ie+b),pe=(-Y-Math.sqrt(Y*Y-4*U*(X*X+ae*ae-b*b)))/(2*U);return[X+J*pe+d,ae+ie*pe+c,pe]}:function(d,c,h,p,g,m){var b=2*(d*(p-m)+h*(m-c)+g*(c-p));if(0==b)return null;var v=((d*d+c*c)*(p-m)+(h*h+p*p)*(m-c)+(g*g+m*m)*(c-p))/b,y=((d*d+c*c)*(g-h)+(h*h+p*p)*(d-g)+(g*g+m*m)*(h-d))/b,E=v-d,S=y-c;return[v,y,Math.sqrt(E*E+S*S)]},u=n?Xf:Yf;return n=n||[],function d(c,h,p,g,m,b,v,y,E){var S,w,M,O,L,N,B,X,J,ae,ie=null;if(0===p||3===h.length)w=g,M=m,O=b,L=E,J=null,1===(ae=(S=h).length)?J=[w[N=S[0]],M[N],O[N]||0]:2===ae?J=y(w[N=S[0]],M[N],w[B=S[1]],M[B],O[N],O[B]):3===ae&&(J=L(w[N=S[0]],M[N],w[B=S[1]],M[B],w[X=S[2]],M[X],O[N],O[B],O[X])),ie=J;else{var U=c[p-1];null!==(ie=d(c,h,p-1,g,m,b,v,y,E))&&v(ie,g[U],m[U],b[U])||(h.push(U),ie=d(c,h,p-1,g,m,b,v,y,E),h.pop())}return ie}(r=function(d){for(var c=d.length-1;0<=c;c--){var h=Math.floor(Math.random()*(c+1));h=Math.max(Math.min(h,c),0);var p=d[c];d[c]=d[h],d[h]=p}return d}(r),[],r.length,e,t,n,u,s,l)}function bv(e){for(var t,n,i,r=e.length,o=[0,1],a=2,s=2;s<r;s++){for(;1<a&&((n=e[o[a-1]])[0]-(t=e[o[a-2]])[0])*((i=e[s])[1]-t[1])-(n[1]-t[1])*(i[0]-t[0])<=0;)--a;o[a++]=s}return o.slice(0,a)}function rh(e){var t=e.length;if(t<3)return null;for(var n=new Array(t),i=new Array(t),r=0;r<t;r++)n[r]=[+e[r][0],+e[r][1],r];for(n.sort(function(h,p){return h[0]-p[0]||h[1]-p[1]}),r=0;r<t;r++)i[r]=[n[r][0],-n[r][1]];var o=bv(n),a=bv(i),u=a[0]===o[0],d=a[a.length-1]===o[o.length-1]?1:0,c=[];for(r=o.length-1;0<=r;--r)c.push(e[n[o[r]][2]]);for(r=+u;r<a.length-d;r++)c.push(e[n[a[r]][2]]);return c}var oh,Ev=(function(e){function t(h){if(!(this instanceof t))return new t(h);this.points=h||[]}function n(h,p,g){return 0<(p[0]-h[0])*(g[1]-h[1])-(p[1]-h[1])*(g[0]-h[0])}function i(h,p){return n(h,p.dest,p.orig)}function r(h,p){return n(h,p.orig,p.dest)}function o(h,p){return i(h.dest,p)}function a(h,p,g,m){if(h[0]===m[0]&&h[1]===m[1]||p[0]===m[0]&&p[1]===m[1]||g[0]===m[0]&&g[1]===m[1])return!1;var v=p[0]*p[0]+p[1]*p[1],y=g[0]*g[0]+g[1]*g[1],E=m[0]*m[0]+m[1]*m[1],S=y-E,w=g[1]-m[1],M=g[1]*E-y*m[1],O=g[0]-m[0],F=g[0]*E-y*m[0],L=g[0]*m[1]-g[1]*m[0];return 1<h[0]*(p[1]*S-v*w+M)-h[1]*(p[0]*S-v*O+F)+(h[0]*h[0]+h[1]*h[1])*(p[0]*w-p[1]*O+L)-p[0]*M+p[1]*F-v*L}function s(h,p,g){this.onext=h,this.rot=p,this.orig=g,this.mark=!1}function l(h,p){var g=new s(null,null,h),m=new s(null,null,null),b=new s(null,null,p),v=new s(null,null,null);return g.onext=g,b.onext=b,(m.onext=v).onext=m,(((g.rot=m).rot=b).rot=v).rot=g}function u(h,p){var g=h.onext.rot,m=p.onext.rot,b=h.onext,v=m.onext,y=g.onext;h.onext=p.onext,p.onext=b,g.onext=v,m.onext=y}function d(h,p){var g=l(h.dest,p.orig);return u(g,h.lnext),u(g.sym,p),g}function c(h){u(h,h.oprev),u(h.sym,h.sym.oprev)}t.prototype={triangulate:function(){var h=this.points;h.sort(function(S,w){return S[0]===w[0]?S[1]-w[1]:S[0]-w[0]});for(var p=h.length-1;1<=p;p--)h[p][0]===h[p-1][0]&&h[p][1]===h[p-1][1]&&h.splice(p,1);if(h.length<2)return{};for(var g=function S(w){var M,O,F,L;if(2===w.length)return{le:M=l(w[0],w[1]),re:M.sym};if(3===w.length)return M=l(w[0],w[1]),O=l(w[1],w[2]),u(M.sym,O),n(w[0],w[1],w[2])?(F=d(O,M),{le:M,re:O.sym}):n(w[0],w[2],w[1])?{le:(F=d(O,M)).sym,re:F}:{le:M,re:O.sym};for(var N=Math.ceil(w.length/2),B=S(w.slice(0,N)),X=S(w.slice(N)),J=B.le,ae=B.re,ie=X.le,U=X.re;;)if(r(ie.orig,ae))ae=ae.lnext;else{if(!i(ae.orig,ie))break;ie=ie.rprev}var Y=d(ie.sym,ae);for(ae.orig===J.orig&&(J=Y.sym),ie.orig===U.orig&&(U=Y);;){var he=Y.sym.onext;if(o(he,Y))for(;a(Y.dest,Y.orig,he.dest,he.onext.dest);)L=he.onext,c(he),he=L;var pe=Y.oprev;if(o(pe,Y))for(;a(Y.dest,Y.orig,pe.dest,pe.oprev.dest);)L=pe.oprev,c(pe),pe=L;if(!o(he,Y)&&!o(pe,Y))break;Y=!o(he,Y)||o(pe,Y)&&a(he.dest,he.orig,pe.orig,pe.dest)?d(pe,Y.sym):d(Y.sym,he.sym)}return{le:J,re:U}}(h).le,m=[],b=0,v=[g];r(g.onext.dest,g);)g=g.onext;for(var y=g;v.push(y.sym),y.mark=!0,(y=y.lnext)!==g;);do{var E=v[b++];if(!E.mark)for(y=E;m.push(y.orig),y.sym.mark||v.push(y.sym),y.mark=!0,(y=y.lnext)!=E;);}while(b<v.length);return m}},s.prototype={get sym(){return this.rot.rot},get dest(){return this.sym.orig},get rotSym(){return this.rot.sym},get oprev(){return this.rot.onext.rot},get dprev(){return this.rotSym.onext.rotSym},get lnext(){return this.rotSym.onext.rot},get lprev(){return this.onext.sym},get rprev(){return this.sym.onext}},t.prototype.ccw=n,t.prototype.rightOf=i,t.prototype.leftOf=r,t.prototype.inCircle=a,e.exports=t}(oh={exports:{}}),oh.exports);function Sv(e,t,n,i,r){if(void 0===t&&(t=1),void 0===n&&(n=0),!i||!r){var o=e.map(function(L){return[L.x,L.y]});i=new Ev(o.slice()).triangulate(),r=rh(o)}for(var a,u,g,m,b=n*n,v=[],y={},E=0;E<i.length;E+=3)ES(r,ah(i[E],i[E+1],i[E+2]))&&b<(O=(g=(u=ah(a=i[E],i[E+1],i[E+2]))[0]-a[0])*g+(m=u[1]-a[1])*m)&&(v.push(E),y[E]=O);if(0===v.length)return[];v.sort(function(L,N){return y[L]-y[N]});var S=v[0],w=y[S],M=[];for(E=0;E<v.length;E++){var O,F=v[E];w<(O=y[F])&&b<O&&(w=O,M.push(S=F),M.length>t&&M.shift())}return M.map(function(L){return function(N,B,X){for(var J=arguments,ae=ah(N,B,X),ie=0,U=0;U<3;U++){var Y=J[U],he=Y[0]-ae[0],pe=Y[1]-ae[1],we=Math.sqrt(he*he+pe*pe);ie<we&&(ie=we)}return[ae[0],ae[1],ie]}(i[L],i[L+1],i[L+2])})}function ES(e,t){for(var n=e.length,i=e[n-1],r=t[0],o=t[1],a=i[0],s=i[1],l=!1,u=0;u<n;u++){var d=e[u],c=d[0],h=d[1];o<h!=o<s&&r<(a-c)*(o-h)/(s-h)+c&&(l=!l),a=c,s=h}return l}function ah(e,t,n){var i=[(e[0]+t[0])/2,(e[1]+t[1])/2],r=[(t[0]+n[0])/2,(t[1]+n[1])/2],o=-1/((t[1]-e[1])/(t[0]-e[0])),a=-1/((n[1]-t[1])/(n[0]-t[0])),s=i[1]-o*i[0],l=(s-(r[1]-a*r[0]))/(a-o);return[l,o*l+s]}function wS(e,t,n){var i=t.duration,r=void 0===i?0:i,o=t.margin,a=void 0===o?5:o,l=t.nodes,u=t.referenceNodes;!u||u instanceof ar||(u=e.getNodes(u));var d=u||l.inverse(),c=d.getPosition().map(function(Ge){return[Ge.x,Ge.y]}),h=n,p=l.getBoundingBox(),g=d.getBoundingBox();g.pad(g.maxScaledSize);var m,b,v,y,E,S,O,F=xv(h.map(function(Ge){return Ge.x}),h.map(function(Ge){return Ge.y}),l.getAttribute("radius")),L=F[0],N=F[1],B=F[2]+g.maxScaledSize+a,X=0,J=0;if(function(Ge,He,Pe,We){for(var Qe=0;Qe<Ge.length;Qe++){var nt=Ge[Qe],ze=nt[1],qe=Math.abs(nt[0]-He),Ke=Math.abs(ze-Pe);if(qe+Ke<=We||!(We<qe||We<Ke)&&qe*qe+Ke*Ke<=We*We)return!0}return!1}(c,L,N,B))if(d.size<=3){if(lc(L,N,F[2],g.minX,g.minY,g.maxX,g.maxY)){var ae=function(Ge,He,Pe){for(var We,Qe=ff(Pe.cx,Pe.cy,Ge,He,Pe.minX,Pe.minY,Pe.maxX,Pe.maxY),nt=1/0,Me={x:Pe.maxX,y:He},ze=0,qe=Qe;ze<qe.length;ze++){var Ke=qe[ze];(We=yi(Ge,He,Ke.x,Ke.y))<nt&&(nt=We,Me=Ke)}return Me}(L,N,g);m=yi(g.cx,g.cy,ae.x,ae.y);var ie={x:(E=g.cx)+(O=(m+B)/m)*(ae.x-E),y:(S=g.cy)+O*(ae.y-S)};X=ie.x-L,J=ie.y-N}}else{var U=new Ev(c.slice()).triangulate(),Y=3<c.length?rh(c):(v=(b=g).bottomLeft(),y=b.topRight(),[[v.x,v.y],[v.x,y.y],[y.x,y.y],[y.x,v.y]]),he=Sv(d.getPosition(),10,B,U,Y);if(ae=function(e,t,n){for(var i,r,o=1/0,a=0,s=t.length;a<s;a++){var l=t[a],u=t[(a+1)%s],d=Jd(e[0],e[1],l[0],l[1],u[0],u[1]);d<o&&(o=d,i=l,r=u)}return v=n,y=_f(e[0],e[1],p=i[0],g=i[1],m=r[0],b=r[1]),E=-(g-b),S=p-m,w=Math.sqrt(E*E+S*S),[y.x-v*(E/=w),y.y-v*(S/=w)];var p,g,m,b,v,y,E,S,w}([L,N],Y,B),0<he.length){for(var pe=Math.pow(L-ae[0],2)+Math.pow(N-ae[1],2),we=0,ke=he;we<ke.length;we++){var at=ke[we];(m=(X=L-at[0])*X+(J=N-at[1])*J)<pe&&(pe=m,ae=at.slice(0,2))}X=ae[0]-L,J=ae[1]-N}else X=ae[0]-p.cx,J=ae[1]-p.cy}var st={layoutName:"incremental",ids:l.getId(),positions:{before:h,current:h}};if(X||J){var Xe=h.map(function(Ge){return Ge.x+=X,Ge.y+=J,Ge});if(t.locate){"boolean"==typeof t.locate&&(t.locate={});var xt=e.modules.locate.layoutDataBoundingBox({x:c.map(function(Ge){return Ge[0]}).concat(Xe.map(function(Ge){return Ge.x})),y:c.map(function(Ge){return Ge[1]}).concat(Xe.map(function(Ge){return Ge.y})),indexes:e.getNodes()._indexes}),It=e.modules.locate.computeConfigForBounds(xt,t.locate);e.modules.camera.setView(It,{duration:r,easing:t.locate.easing,ignoreZoomLimits:!0})}return st.positions.current=Xe,l.setAttributes(Xe,r).then(function(){return st})}return l.setAttributes(h,r).then(function(){return st})}function Av(e,t,n){var i=un(t);return i.duration=0,i.dryRun=!0,i.locate=!1,delete i.incremental,n(i).then(function(r){return wS(e,t,r.positions.current)})}function wv(e,t,n){var r=t.duration,o=t.centralNode,a=t.nodes,s=a.reduce(function(d,c){return d[c._index]=!0,d},{}),l=e.getNodes();if(t.focusOnGroupShape)return n({nodes:a,duration:0}).then(function(){var d=a.concat(o),c=d.getAttribute("layoutable");return d.setAttributes({layoutable:!1}),n({nodes:e.getNodes(),duration:r}).then(function(){return d.setAttributes(c)})});var u=un(t);return delete u.centralNode,u.incremental=!1,u.nodes=l,u.nodeMass=function(d,c){return(c+1)*(s[d._index]?1:2)},n(u)}function Cv(e,t,n){var i=e.nodes,r=e.centralNode;if(!i||0===i.size)throw new Error("Incremental layout: no nodes are selected");if("boolean"!=typeof e.incremental&&"margin"in e.incremental&&!isFinite(e.incremental.margin))throw new Error("Incremental layout: margin has to be a positive number");var o=un(e);return"boolean"!=typeof e.incremental&&(o.margin=e.incremental.margin,o.referenceNodes=e.incremental.referenceNodes),r&&!r.getAttribute("layoutable")?wv(t,o,n):(o.nodes=o.nodes instanceof ar?o.nodes:t.getNodes(o.nodes),Av(t,o,n))}var CS={configure:function(e,t){var n,i,r,o=t.graph,a=t.camera,s=e.nodes,l=s._indexes,u={},d={},c=l.length,h=o.getObjectList(!0),p=o.getObjectList(!1);e.nodes&&delete(e=un(e)).nodes;var g=o.getNodeAttribute("innerStroke.width").getMultiple(l),m=o.getNodeAttribute("outerStroke.width").getMultiple(l),b=o.degrees(l),v=o.getNodeAttribute("x").getMultiple(l),y=o.getNodeAttribute("y").getMultiple(l),E=o.getNodeAttribute("radius").getMultiple(l),S=o.nodeList(l).getAttribute("layoutable"),w="function"==typeof e.nodeMass?e.nodeMass:function(Xe,xt,It){return xt+1};delete e.nodeMass;var M="function"==typeof e.edgeWeight?e.edgeWeight:function(Xe){return 1};delete e.edgeWeight,isFinite(e.scalingRatio)||delete e.scalingRatio;var O=l.reduce(function(Xe,xt,It){return S[It]||(Xe[xt]=!0),Xe},{}),F=0,L=0,N=0,B=a.getZoom();for(r=0;r<l.length;++r){var X=l[r],ie=E[r]+(g[r]+m[r])/B;u[X]={id:X,x:v[r],y:y[r],degree:b[r],size:ie,pinned:!!O[X],mass:w(h.get(X),b[r],r)},N=Math.max(ie,N)}if(1<c)for(r=0;r<c;r++){var U=u[l[r]];F+=U.x,L+=U.y}var Y={x:F/=c,y:L/=c},he=s.getAdjacentEdges();i=(n=he._indexes).length;var pe=he.getSource()._indexes,we=he.getTarget()._indexes;for(r=0;r<i;r++){var ke=n[r],at=pe[r],st=we[r];u[at]&&u[st]&&(d[ke]={source:at,target:st},d[ke].weight=M(p.get(ke)))}return{nodes:u,edges:d,maxSize:N,config:Wi(e),barycentre:Y}},context:function(){return{}},update:function(e,t){var n,i,r,o;t.W?n=t.W:(t.W=n={ppn:10,ppe:3,ppr:9,MAX_SUBDIVISION_RETRIES:3,maxForce:10,iterations:0,converged:!1,settings:{linLogMode:!1,outboundAttractionDistribution:!1,adjustSizes:!1,edgeWeightInfluence:0,scalingRatio:100,strongGravityMode:!0,gravity:1,slowDown:1,barnesHutOptimize:!1,barnesHutTheta:.5,startingIterations:10,iterationsPerRender:10,maxIterations:1e3,avgDistanceThreshold:.01,autoStop:!0,alignNodeSiblings:!0,nodeSiblingsScale:5,nodeSiblingsAngleMin:0}},r=(i=e).config,o=function(d,c){var h,p,g,m,b=d.nodes,v=d.edges,y=d.maxSize,E=Object.keys(d.nodes),S=Object.keys(d.edges),w=E.length*n.ppn,M=S.length*n.ppe,O={},F=Math.pow(10,Math.log(Math.max(y,1))-6),L=F/2,N=Math.random,B=c.randomizeFactor||1;m="locally"===c.randomize?function(pe){return pe+N()*B}:"globally"===c.randomize?function(pe){return N()*B}:function(pe){return pe+N()*F-L};var X=new Float32Array(w),J=new Float32Array(M);for(h=p=0,g=E.length;h<g;h++){var ae=E[h],ie=b[ae],U=ie.x,Y=ie.y;ie.pinned||(U=m(U),Y=m(Y)),O[ae]=p,X[p]=U,X[p+1]=Y,X[p+2]=0,X[p+3]=0,X[p+4]=0,X[p+5]=0,X[p+6]=ie.mass,X[p+7]=1,X[p+8]=ie.size,X[p+9]=ie.pinned||0,p+=n.ppn}for(h=p=0,g=S.length;h<g;h++){var he=v[ae=S[h]];J[p]=O[he.source],J[p+1]=O[he.target],J[p+2]=he.weight||0,p+=n.ppe}return{nodes:X,edges:J}}(i,r),t.NodeMatrix=o.nodes,t.EdgeMatrix=o.edges,n.nodesLength=t.NodeMatrix.length,n.edgesLength=t.EdgeMatrix.length,n.settings=function(d,c){for(var h in d)c[h]=d[h];return c}(e.config,n.settings),t.nodes=e.nodes,t.edges=e.edges,t.barycentre=e.barycentre);var a,s=t.NodeMatrix,l=t.EdgeMatrix;function u(){var d,c,h,p,g,m,b,v,y,E,S,w,M,O,F,L,N;for(h=0;h<n.nodesLength;h+=n.ppn)s[h+4]=s[h+2],s[h+5]=s[h+3],s[h+2]=0,s[h+3]=0;if(n.settings.outboundAttractionDistribution){for(h=y=0;h<n.nodesLength;h+=n.ppn)y+=s[h+6];y/=n.nodesLength}if(n.settings.barnesHutOptimize){var B,X,J,ae,ie=1/0,U=-1/0,Y=1/0,he=-1/0;for(a=[],h=0;h<n.nodesLength;h+=n.ppn)ie=Math.min(ie,s[h+0]),U=Math.max(U,s[h+0]),Y=Math.min(Y,s[h+1]),he=Math.max(he,s[h+1]);var pe=U-ie,we=he-Y;for(we<pe?he=(Y-=(pe-we)/2)+pe:U=(ie-=(we-pe)/2)+we,a[0]=-1,a[1]=(ie+U)/2,a[2]=(Y+he)/2,a[3]=Math.max(U-ie,he-Y),a[4]=-1,a[5]=-1,a[6]=0,a[7]=0,d=1,h=a[8]=0;h<n.nodesLength;h+=n.ppn)for(c=0,J=n.MAX_SUBDIVISION_RETRIES;;){if(!(0<=a[c+5])){if(a[c+0]<0){a[c+0]=h;break}if(a[c+5]=d*n.ppr,b=a[c+3]/2,a[(v=a[c+5])+0]=-1,a[v+1]=a[c+1]-b,a[v+2]=a[c+2]-b,a[v+3]=b,a[v+4]=v+n.ppr,a[v+5]=-1,a[v+6]=0,a[v+7]=0,a[v+8]=0,a[(v+=n.ppr)+0]=-1,a[v+1]=a[c+1]-b,a[v+2]=a[c+2]+b,a[v+3]=b,a[v+4]=v+n.ppr,a[v+5]=-1,a[v+6]=0,a[v+7]=0,a[v+8]=0,a[(v+=n.ppr)+0]=-1,a[v+1]=a[c+1]+b,a[v+2]=a[c+2]-b,a[v+3]=b,a[v+4]=v+n.ppr,a[v+5]=-1,a[v+6]=0,a[v+7]=0,a[v+8]=0,a[(v+=n.ppr)+0]=-1,a[v+1]=a[c+1]+b,a[v+2]=a[c+2]+b,a[v+3]=b,a[v+4]=a[c+4],a[v+5]=-1,a[v+6]=0,a[v+7]=0,a[v+8]=0,d+=4,B=s[a[ae=c+0]+0]<a[c+1]?s[a[ae]+1]<a[c+2]?a[c+5]:a[c+5]+n.ppr:s[a[ae]+1]<a[c+2]?a[c+5]+2*n.ppr:a[c+5]+3*n.ppr,a[c+6]=s[a[ae]+6],a[c+7]=s[a[ae]+0],a[c+8]=s[a[ae]+1],a[B+0]=a[c+0],a[c+0]=-1,B===(X=s[h+0]<a[c+1]?s[h+1]<a[c+2]?a[c+5]:a[c+5]+n.ppr:s[h+1]<a[c+2]?a[c+5]+2*n.ppr:a[c+5]+3*n.ppr)){if(J--){c=B;continue}J=n.MAX_SUBDIVISION_RETRIES;break}a[X+0]=h;break}B=s[h+0]<a[c+1]?s[h+1]<a[c+2]?a[c+5]:a[c+5]+n.ppr:s[h+1]<a[c+2]?a[c+5]+2*n.ppr:a[c+5]+3*n.ppr,a[c+7]=(a[c+7]*a[c+6]+s[h+0]*s[h+6])/(a[c+6]+s[h+6]),a[c+8]=(a[c+8]*a[c+6]+s[h+1]*s[h+6])/(a[c+6]+s[h+6]),a[c+6]+=s[h+6],c=B}}if(n.settings.barnesHutOptimize)for(E=n.settings.scalingRatio,h=0;h<n.nodesLength;h+=n.ppn)for(c=0;;)if(0<=a[c+5]){if(L=Math.sqrt((s[h+0]-a[c+7])*(s[h+0]-a[c+7])+(s[h+1]-a[c+8])*(s[h+1]-a[c+8])),2*a[c+3]/L<n.settings.barnesHutTheta){if(S=s[h+0]-a[c+7],w=s[h+1]-a[c+8],n.settings.adjustSizes?0<L?(s[h+2]+=S*(N=E*s[h+6]*a[c+6]/L/L),s[h+3]+=w*N):L<0&&(s[h+2]+=S*(N=-E*s[h+6]*a[c+6]/L),s[h+3]+=w*N):0<L&&(s[h+2]+=S*(N=E*s[h+6]*a[c+6]/L/L),s[h+3]+=w*N),a[c+4]<0)break;c=a[c+4];continue}c=a[c+5]}else{if(0<=a[c+0]&&a[c+0]!==h&&(S=s[h+0]-s[a[c+0]+0],w=s[h+1]-s[a[c+0]+1],L=Math.sqrt(S*S+w*w),n.settings.adjustSizes?0<L?(s[h+2]+=S*(N=E*s[h+6]*s[a[c+0]+6]/L/L),s[h+3]+=w*N):L<0&&(s[h+2]+=S*(N=-E*s[h+6]*s[a[c+0]+6]/L),s[h+3]+=w*N):0<L&&(s[h+2]+=S*(N=E*s[h+6]*s[a[c+0]+6]/L/L),s[h+3]+=w*N)),a[c+4]<0)break;c=a[c+4]}else for(E=n.settings.scalingRatio,p=0;p<n.nodesLength;p+=n.ppn)for(g=0;g<p;g+=n.ppn)S=s[p+0]-s[g+0],w=s[p+1]-s[g+1],n.settings.adjustSizes?0<(L=Math.sqrt(S*S+w*w)-s[p+8]-s[g+8])?(s[p+2]+=S*(N=E*s[p+6]*s[g+6]/L/L),s[p+3]+=w*N,s[g+2]+=S*N,s[g+3]+=w*N):L<0&&(s[p+2]+=S*(N=100*E*s[p+6]*s[g+6]),s[p+3]+=w*N,s[g+2]-=S*N,s[g+3]-=w*N):0<(L=Math.sqrt(S*S+w*w))&&(s[p+2]+=S*(N=E*s[p+6]*s[g+6]/L/L),s[p+3]+=w*N,s[g+2]-=S*N,s[g+3]-=w*N);for(v=n.settings.gravity/n.settings.scalingRatio,E=n.settings.scalingRatio,h=0;h<n.nodesLength;h+=n.ppn)S=s[h+(N=0)],w=s[h+1],L=Math.sqrt(S*S+w*w),n.settings.strongGravityMode?0<L&&(N=E*s[h+6]*v):0<L&&(N=E*s[h+6]*v/L),s[h+2]-=S*N,s[h+3]-=w*N;for(E=1*(n.settings.outboundAttractionDistribution?y:1),m=0;m<n.edgesLength;m+=n.ppe)p=l[m+0],g=l[m+1],b=l[m+2],F=Math.pow(b,n.settings.edgeWeightInfluence),S=s[p+0]-s[g+0],w=s[p+1]-s[g+1],n.settings.adjustSizes?(L=Math.sqrt(S*S+w*w)-s[p+8]-s[g+8],n.settings.linLogMode?n.settings.outboundAttractionDistribution?0<L&&(N=-E*F*Math.log(1+L)/L/s[p+6]):0<L&&(N=-E*F*Math.log(1+L)/L):n.settings.outboundAttractionDistribution?0<L&&(N=-E*F/s[p+6]):0<L&&(N=-E*F)):(L=Math.sqrt(S*S+w*w),n.settings.linLogMode?n.settings.outboundAttractionDistribution?0<L&&(N=-E*F*Math.log(1+L)/L/s[p+6]):0<L&&(N=-E*F*Math.log(1+L)/L):N=n.settings.outboundAttractionDistribution?(L=1,-E*F/s[p+6]):(L=1,-E*F)),0<L&&(s[p+2]+=S*N,s[p+3]+=w*N,s[g+2]-=S*N,s[g+3]-=w*N);var ke,at,st,Xe,xt=0;if(n.settings.adjustSizes)for(h=0;h<n.nodesLength;h+=n.ppn)s[h+9]||((ke=Math.sqrt(s[h+2]*s[h+2]+s[h+3]*s[h+3]))>n.maxForce&&(s[h+2]=s[h+2]*n.maxForce/ke,s[h+3]=s[h+3]*n.maxForce/ke),at=s[h+6]*Math.sqrt((s[h+4]-s[h+2])*(s[h+4]-s[h+2])+(s[h+5]-s[h+3])*(s[h+5]-s[h+3])),st=Math.sqrt((s[h+4]+s[h+2])*(s[h+4]+s[h+2])+(s[h+5]+s[h+3])*(s[h+5]+s[h+3]))/2,Xe=.1*Math.log(1+st)/(1+Math.sqrt(at)),M=s[h+0],O=s[h+1],s[h+0]=s[h+0]+s[h+2]*(Xe/n.settings.slowDown),s[h+1]=s[h+1]+s[h+3]*(Xe/n.settings.slowDown),S=s[h+0],w=s[h+1],xt+=L=Math.sqrt((S-M)*(S-M)+(w-O)*(w-O)));else for(h=0;h<n.nodesLength;h+=n.ppn)s[h+9]||(at=s[h+6]*Math.sqrt((s[h+4]-s[h+2])*(s[h+4]-s[h+2])+(s[h+5]-s[h+3])*(s[h+5]-s[h+3])),st=Math.sqrt((s[h+4]+s[h+2])*(s[h+4]+s[h+2])+(s[h+5]+s[h+3])*(s[h+5]+s[h+3]))/2,Xe=s[h+7]*Math.log(1+st)/(1+Math.sqrt(at)),s[h+7]=Math.min(1,Math.sqrt(Xe*(s[h+2]*s[h+2]+s[h+3]*s[h+3])/(1+Math.sqrt(at)))),M=s[h+0],O=s[h+1],s[h+0]=s[h+0]+s[h+2]*(Xe/n.settings.slowDown),s[h+1]=s[h+1]+s[h+3]*(Xe/n.settings.slowDown),S=s[h+0],w=s[h+1],xt+=L=Math.sqrt((S-M)*(S-M)+(w-O)*(w-O)));if(n.iterations++,n.settings.autoStop&&(n.converged=n.iterations>n.settings.maxIterations||xt/n.nodesLength<n.settings.avgDistanceThreshold,n.converged&&n.settings.alignNodeSiblings)){var It,Ge,He={},Pe={};for(m=0;m<n.edgesLength;m+=n.ppe)(p=l[m+0])!==(g=l[m+1])&&(He[p]=He[p]||{},He[g]=He[g]||{},He[p][g]=!0,He[g][p]=!0);Object.keys(He).forEach(function(z){var K=~~z;2==(Ge=Object.keys(He[K])).length&&((It=Ge[0]+";"+Ge[1])in Pe||Pe[It=Ge[1]+";"+Ge[0]]||(Pe[It]=[~~Ge[1],~~Ge[0]]),Pe[It].push(K))});var We,Qe,nt,Me,ze,qe,Ke,ht,Wt,$t,dn,sn,pn,W,Z=n.settings.nodeSiblingsAngleMin;Object.keys(Pe).forEach(function(z){if(Qe=Pe[z].shift(),nt=Pe[z].shift(),1!=(We=Pe[z].filter(function(tt){return!s[tt+9]})).length){var me,Se,be,Ie,De,Ve,Re,Be,Oe,Le,Ce,et;if(qe=s[Qe+0],Ke=s[Qe+1],ht=s[nt+0],Wt=s[nt+1],Me=Object.keys(He[Qe]).length,ze=Object.keys(He[nt]).length,dn={x:(me=qe)+(ht-me)*(be=(.75-.25)*(Me/(Me+ze)-0)/1+.25),y:(Se=Ke)+(Wt-Se)*be},sn={xi:-((Re=Wt)-(De=Ke)),yi:(Ve=ht)-(Ie=qe),xiPrime:Re-De,yiPrime:-(Ve-Ie)},Be=ht-qe,Oe=Wt-Ke,$t=Math.sqrt(Be*Be+Oe*Oe),et=pn={x:((Le=sn).xiPrime-Le.xi)/(Ce=$t),y:(Le.yiPrime-Le.yi)/Ce},W=Math.acos(et.x/Math.sqrt(et.x*et.x+et.y*et.y)),2*Z>Math.PI)throw new Error("ForceLink.Worker - Invalid parameter: angleMin must be smaller than 2 PI.");0<Z&&(W<Z||W>Math.PI-Z&&W<=Math.PI?pn={x:2*Math.cos(Math.PI-Z),y:2*Math.sin(Math.PI-Z)}:(W>2*Math.PI-Z||W>=Math.PI&&W<Math.PI+Z)&&(pn={x:2*Math.cos(Z),y:2*Math.sin(Z)}));var lt=0,je=1,Ze=1;We.length%2==1&&(Ze=0,lt=1);for(var Ue=0;Ue<We.length;Ue++)s[We[Ue]+0]=dn.x+je*pn.x*Ze*(lt||2<=Ue?n.settings.nodeSiblingsScale:2*n.settings.nodeSiblingsScale/3),s[We[Ue]+1]=dn.y+je*pn.y*Ze*(lt||2<=Ue?n.settings.nodeSiblingsScale:2*n.settings.nodeSiblingsScale/3),je=-je,Ze+=(Ue+lt)%2}})}}return function(){if(n.settings.autoStop)for(;!n.converged;)u();else for(var d=0===n.iterations?n.settings.startingIterations:n.iterations+n.settings.iterationsPerRender;n.iterations!==d;)u();return{nodes:function(c){for(var h=Object.keys(c),p={},g=0;g<s.length;g+=n.ppn){var m=h[g/n.ppn];p[m]={id:m,x:s[g+0],y:s[g+1],pinned:s[g+9]}}return p}(t.nodes),barycentre:t.barycentre}}()},isRunning:function(e){return!e.W.settings.autoStop},onSync:function(e,t){var n,i,r,o,a,s,l,u,d=e.nodes,c=e.barycentre,h=t.graph,p=Object.keys(d),g=p.length,m=0,b=0,v=new Array(g),y=new Array(g),E=new Array(g),S=new Array(g),w=h.getAttributes(!0,["x","y"]),M=w[0],O=w[1];for(n=0;n<g;n++)r=d[i=p[n]],u=parseInt(i),v[n]=u,S[n]=r.pinned,a=r.pinned?(o=M.get(u),O.get(u)):(o=r.x,r.y),m+=y[n]=o,b+=E[n]=a;for(s=m/g-c.x,l=b/g-c.y,n=0;n<g;n++)S[n]||(y[n]-=s,E[n]-=l);return{indexes:v,x:y,y:E}}},Tv=function(e){return e.reduce(function(t,n){return t[n]=!0,t},{})};function TS(e,t){for(var n=[e],i=Tv(n),r=[e];n.length;)for(var o=0,a=t[n.shift()];o<a.length;o+=1){var s=a[o];i[s]||(i[s]=!0,r.push(s),n.push(s))}return r}function Mv(e){return e.reduce(function(t,n){return t[n.source]=t[n.source]||[],t[n.target]=t[n.target]||[],t[n.source].push(""+n.target),t[n.target].push(""+n.source),t},{})}function MS(e){return function(t,n){var i=Math.abs(t.layer-n.layer),r=[n,t].reduce(function(o,a){return o+(Ru(a)?1:.01)},0);return i?2*i*e:r*e}}function Iv(e){return e.reduce(function(t,n){return t+function(i,r){for(var o=[],a=arguments.length-2;0<a--;)o[a]=arguments[a+2];for(var s=r,l=0,u=o;l<u.length;l+=1){var d=u[l];if(!s[d])return i;s=s[d]}return s}(Ru(n)?.5:0,n,"data","radius")},0)/e.length}function kv(e,t,n){var i=n||Mv(t||[]);return e.filter(function(r){return!(r.id in i)})}function IS(e,t){var n=Tv(t);return e.filter(function(i){return!(i in n)})}function us(e,t){e.forEach(function(n,i){n.forEach(function(r,o,a){t(r,o,a,i)})})}function sh(e){return Object.keys(e).map(function(t){return e[t]})}function uh(e,t){return Object.keys(e).reduce(function(n,i){return n[i]=t(e[i],i,e),n},{})}function Ru(e){return!!e.data}function lh(e,t){return{id:e,data:t,children:[]}}function OS(e,t){t.forEach(function(n){return n._median=[]}),e.forEach(function(n,i){n.children.filter(function(r){return r.layer>n.layer}).forEach(function(r){r._median.push(i)})}),t.forEach(function(n,i){n.children.filter(function(r){return r.layer<=n.layer}).forEach(function(){return n._median.push(i)})}),t.forEach(function(n){return n._median=function(i){if(i.sort(function(o,a){return o-a}),0===i.length)return 0;var r=Math.floor(i.length/2);return i.length%2?i[r]:(i[r-1]+i[r])/2}(n._median)||0}),t.sort(function(n,i){return n._median-i._median}),t.forEach(function(n){return delete n._median})}var dh="left",ch="right",hh=Number.POSITIVE_INFINITY;function ph(e){for(var t=0,n=["up","down"];t<n.length;t+=1)e(n[t])}function fh(e){for(var t=0,n=[dh,ch];t<n.length;t+=1)e(n[t])}function Ov(e,t,n,i){this.feasible=n,this.evaluation=t,this.bounded=i,this._tableau=e}var gh=Ov;function ld(e,t,n,i,r){gh.call(this,e,t,n,i),this.iter=r}Ov.prototype.generateSolutionSet=function(){for(var e={},t=this._tableau,n=t.varIndexByRow,i=t.variablesPerIndex,r=t.matrix,o=t.rhsColumn,a=t.height-1,s=Math.round(1/t.precision),l=1;l<=a;l+=1){var u=i[n[l]];void 0!==u&&!0!==u.isSlack&&(e[u.id]=Math.round(r[l][o]*s)/s)}return e};var PS=ld;function Co(e){this.model=null,this.matrix=null,this.width=0,this.height=0,this.costRowIndex=0,this.rhsColumn=0,this.variablesPerIndex=[],this.unrestrictedVars=null,this.feasible=!0,this.evaluation=0,this.varIndexByRow=null,this.varIndexByCol=null,this.rowByVarIndex=null,this.colByVarIndex=null,this.precision=e||1e-8,this.optionalObjectives=[],this.objectivesByPriority={},this.savedState=null,this.availableIndexes=[],this.lastElementIndex=0,this.variables=null,this.nVars=0,this.bounded=!0,this.unboundedVarIndex=null,this.branchAndCutIterations=0}ld.prototype=Object.create(gh.prototype),ld.constructor=ld;var vn=Co;function _h(e,t){this.priority=e,this.reducedCosts=new Array(t);for(var n=0;n<t;n+=1)this.reducedCosts[n]=0}Co.prototype.solve=function(){return 0<this.model.getNumberOfIntegerVariables()?this.branchAndCut():this.simplex(),this.updateVariableValues(),this.getSolution()},_h.prototype.copy=function(){var e=new _h(this.priority,this.reducedCosts.length);return e.reducedCosts=this.reducedCosts.slice(),e},Co.prototype.setOptionalObjective=function(e,t,n){var i=this.objectivesByPriority[e];void 0===i&&(i=new _h(e,Math.max(this.width,t+1)),this.objectivesByPriority[e]=i,this.optionalObjectives.push(i),this.optionalObjectives.sort(function(r,o){return r.priority-o.priority})),i.reducedCosts[t]=n},Co.prototype.initialize=function(e,t,n,i){this.variables=n,this.unrestrictedVars=i,this.width=e,this.height=t;for(var r=new Array(e),o=0;o<e;o++)r[o]=0;this.matrix=new Array(t);for(var a=0;a<t;a++)this.matrix[a]=r.slice();this.varIndexByRow=new Array(this.height),this.varIndexByCol=new Array(this.width),this.varIndexByRow[0]=-1,this.varIndexByCol[0]=-1,this.nVars=e+t-2,this.rowByVarIndex=new Array(this.nVars),this.colByVarIndex=new Array(this.nVars),this.lastElementIndex=this.nVars},Co.prototype._resetMatrix=function(){var e,t,n=this.model.variables,i=this.model.constraints,r=n.length,o=i.length,a=this.matrix[0],s=!0===this.model.isMinimization?-1:1;for(e=0;e<r;e+=1){var l=n[e],u=l.priority,d=s*l.cost;0===u?a[e+1]=d:this.setOptionalObjective(u,e+1,d),this.rowByVarIndex[t=n[e].index]=-1,this.colByVarIndex[t]=e+1,this.varIndexByCol[e+1]=t}for(var c=1,h=0;h<o;h+=1){var p,g,m=i[h],b=m.index;this.rowByVarIndex[b]=c,this.colByVarIndex[b]=-1,this.varIndexByRow[c]=b;var v=m.terms,y=v.length,E=this.matrix[c++];if(m.isUpperBound){for(p=0;p<y;p+=1)E[this.colByVarIndex[(g=v[p]).variable.index]]=g.coefficient;E[0]=m.rhs}else{for(p=0;p<y;p+=1)E[this.colByVarIndex[(g=v[p]).variable.index]]=-g.coefficient;E[0]=-m.rhs}}},Co.prototype.setModel=function(e){var t=(this.model=e).nVariables+1;return this.initialize(t,e.nConstraints+1,e.variables,e.unrestrictedVariables),this._resetMatrix(),this},Co.prototype.getNewElementIndex=function(){if(0<this.availableIndexes.length)return this.availableIndexes.pop();var e=this.lastElementIndex;return this.lastElementIndex+=1,e},Co.prototype.density=function(){for(var e=0,t=this.matrix,n=0;n<this.height;n++)for(var i=t[n],r=0;r<this.width;r++)0!==i[r]&&(e+=1);return e/(this.height*this.width)},Co.prototype.setEvaluation=function(){var e=Math.round(1/this.precision);this.evaluation=Math.round(this.matrix[this.costRowIndex][this.rhsColumn]*e)/e},Co.prototype.getSolution=function(){var e=!0===this.model.isMinimization?this.evaluation:-this.evaluation;return 0<this.model.getNumberOfIntegerVariables()?new PS(this,e,this.feasible,this.bounded,this.branchAndCutIterations):new gh(this,e,this.feasible,this.bounded)},vn.prototype.simplex=function(){return this.bounded=!0,this.phase1(),!0===this.feasible&&this.phase2(),this},vn.prototype.phase1=function(){for(var e=this.model.checkForCycles,t=[],n=this.matrix,i=this.rhsColumn,r=this.width-1,o=this.height-1,a=0;;){for(var s=0,l=-this.precision,u=1;u<=o;u++)if(!0!==this.unrestrictedVars[this.varIndexByRow[u]]){var d=n[u][i];d<l&&(l=d,s=u)}if(0===s)return this.feasible=!0,a;for(var c=0,h=-1/0,p=n[0],g=n[s],m=1;m<=r;m++){var b=g[m];if(!(-this.precision<b&&b<this.precision)&&(!0===this.unrestrictedVars[this.varIndexByCol[m]]||b<-this.precision)){var v=-p[m]/b;h<v&&(h=v,c=m)}}if(0===c)return this.feasible=!1,a;if(e){t.push([this.varIndexByRow[s],this.varIndexByCol[c]]);var y=this.checkForCycles(t);if(0<y.length)throw console.log("Cycle in phase 1"),console.log("Start :",y[0]),console.log("Length :",y[1]),new Error}this.pivot(s,c),a+=1}},vn.prototype.phase2=function(){for(var e,t,n=this.model.checkForCycles,i=[],r=this.matrix,o=this.rhsColumn,a=this.width-1,s=this.height-1,l=this.precision,u=this.optionalObjectives.length,d=null,c=0;;){var h=r[this.costRowIndex];0<u&&(d=[]);for(var p=0,g=l,m=!1,b=1;b<=a;b++)e=h[b],t=!0===this.unrestrictedVars[this.varIndexByCol[b]],0<u&&-l<e&&e<l?d.push(b):t&&e<0?g<-e&&(g=-e,p=b,m=!0):g<e&&(g=e,p=b,m=!1);if(0<u)for(var v=0;0===p&&0<d.length&&v<u;){var y=[],E=this.optionalObjectives[v].reducedCosts;g=l;for(var S=0;S<d.length;S++)e=E[b=d[S]],t=!0===this.unrestrictedVars[this.varIndexByCol[b]],-l<e&&e<l?y.push(b):t&&e<0?g<-e&&(g=-e,p=b,m=!0):g<e&&(g=e,p=b,m=!1);d=y,v+=1}if(0===p)return this.setEvaluation(),c;for(var w=0,M=1/0,O=1;O<=s;O++){var F=r[O],L=F[o],N=F[p];if(!(-l<N&&N<l)){if(0<N&&L<l&&-l<L){M=0,w=O;break}var B=m?-L/N:L/N;l<B&&B<M&&(M=B,w=O)}}if(M===1/0)return this.evaluation=-1/0,this.bounded=!1,this.unboundedVarIndex=this.varIndexByCol[p],c;if(n){i.push([this.varIndexByRow[w],this.varIndexByCol[p]]);var X=this.checkForCycles(i);if(0<X.length)throw console.log("Cycle in phase 2"),console.log("Start :",X[0]),console.log("Length :",X[1]),new Error}this.pivot(w,p,!0),c+=1}};var mh=[];function vh(e,t,n,i){this.id=e,this.cost=t,this.index=n,this.value=0,this.priority=i}function Nv(e,t,n,i){vh.call(this,e,t,n,i)}function yh(e,t){vh.call(this,e,0,t,0)}function Lv(e,t){this.variable=e,this.coefficient=t}function Fv(e,t,n){return 0===n||"required"===n?null:(t=t||1,n=n||1,!1===e.isMinimization&&(t=-t),e.addVariable(t,"r"+e.relaxationIndex++,!1,!1,n))}function ls(e,t,n,i){this.slack=new yh("s"+n,n),this.index=n,this.model=i,this.rhs=e,this.isUpperBound=t,this.terms=[],this.termsByVarIndex={},this.relaxation=null}function Hs(e,t){this.upperBound=e,this.lowerBound=t,this.model=e.model,this.rhs=e.rhs,this.relaxation=null}vn.prototype.pivot=function(e,t){var n=this.matrix,i=n[e][t],r=this.height-1,o=this.width-1,a=this.varIndexByRow[e],s=this.varIndexByCol[t];this.varIndexByRow[e]=s,this.varIndexByCol[t]=a,this.rowByVarIndex[s]=e,this.rowByVarIndex[a]=-1,this.colByVarIndex[s]=-1,this.colByVarIndex[a]=t;for(var l,u,d,c=n[e],h=0,p=0;p<=o;p++)0!==c[p]&&(c[p]/=i,mh[h]=p,h+=1);c[t]=1/i;for(var g=0;g<=r;g++){var m=n[g];if(g!==e&&0!==(l=m[t])){for(u=0;u<h;u++)0!==(d=c[p=mh[u]])&&(m[p]=m[p]-l*d);m[t]=-l/i}}var b=this.optionalObjectives.length;if(0<b)for(var v=0;v<b;v+=1){var y=this.optionalObjectives[v].reducedCosts;if(0!==(l=y[t])){for(u=0;u<h;u++)0!==(d=c[p=mh[u]])&&(y[p]=y[p]-l*d);y[t]=-l/i}}},vn.prototype.checkForCycles=function(e){for(var t=0;t<e.length-1;t++)for(var n=t+1;n<e.length;n++){var i=e[t],r=e[n];if(i[0]===r[0]&&i[1]===r[1]){if(n-t>e.length-n)break;for(var o=!0,a=1;a<n-t;a++){var s=e[t+a],l=e[n+a];if(s[0]!==l[0]||s[1]!==l[1]){o=!1;break}}if(o)return[t,n-t]}}return[]},yh.prototype.isSlack=Nv.prototype.isInteger=!0,ls.prototype.addTerm=function(e,t){var n=t.index,i=this.termsByVarIndex[n];return void 0===i?(i=new Lv(t,e),this.termsByVarIndex[n]=i,this.terms.push(i),!0===this.isUpperBound&&(e=-e),this.model.updateConstraintCoefficient(this,t,e)):this.setVariableCoefficient(i.coefficient+e,t),this},ls.prototype.removeTerm=function(e){return this},ls.prototype.setRightHandSide=function(e){if(e!==this.rhs){var t=e-this.rhs;!0===this.isUpperBound&&(t=-t),this.rhs=e,this.model.updateRightHandSide(this,t)}return this},ls.prototype.setVariableCoefficient=function(e,t){var n=t.index;if(-1!==n){var i=this.termsByVarIndex[n];if(void 0===i)this.addTerm(e,t);else if(e!==i.coefficient){var r=e-i.coefficient;!0===this.isUpperBound&&(r=-r),i.coefficient=e,this.model.updateConstraintCoefficient(this,t,r)}return this}console.warn("[Constraint.setVariableCoefficient] Trying to change coefficient of inexistant variable.")},ls.prototype.relax=function(e,t){this.relaxation=Fv(this.model,e,t),this._relax(this.relaxation)},ls.prototype._relax=function(e){null!==e&&this.setVariableCoefficient(this.isUpperBound?-1:1,e)},Hs.prototype.isEquality=!0,Hs.prototype.addTerm=function(e,t){return this.upperBound.addTerm(e,t),this.lowerBound.addTerm(e,t),this},Hs.prototype.removeTerm=function(e){return this.upperBound.removeTerm(e),this.lowerBound.removeTerm(e),this},Hs.prototype.setRightHandSide=function(e){this.upperBound.setRightHandSide(e),this.lowerBound.setRightHandSide(e),this.rhs=e},Hs.prototype.relax=function(e,t){this.relaxation=Fv(this.model,e,t),this.upperBound.relaxation=this.relaxation,this.upperBound._relax(this.relaxation),this.lowerBound.relaxation=this.relaxation,this.lowerBound._relax(this.relaxation)};var Xo={Constraint:ls,Variable:vh,IntegerVariable:Nv,SlackVariable:yh,Equality:Hs,Term:Lv},xh=Xo.SlackVariable;function Pv(e,t){this.index=e,this.value=t}vn.prototype.addCutConstraints=function(e){for(var t,n=e.length,i=this.height,r=i+n,o=i;o<r;o+=1)void 0===this.matrix[o]&&(this.matrix[o]=this.matrix[o-1].slice());this.height=r,this.nVars=this.width+this.height-2;for(var a=this.width-1,s=0;s<n;s+=1){var l=e[s],u=i+s,d="min"===l.type?-1:1,c=l.varIndex,h=this.rowByVarIndex[c],p=this.matrix[u];if(-1===h){for(p[this.rhsColumn]=d*l.value,t=1;t<=a;t+=1)p[t]=0;p[this.colByVarIndex[c]]=d}else{var g=this.matrix[h];for(p[this.rhsColumn]=d*(l.value-g[this.rhsColumn]),t=1;t<=a;t+=1)p[t]=-d*g[t]}var b=this.getNewElementIndex();this.varIndexByRow[u]=b,this.rowByVarIndex[b]=u,this.colByVarIndex[b]=-1,this.variablesPerIndex[b]=new xh("s"+b,b),this.nVars+=1}},vn.prototype._addLowerBoundMIRCut=function(e){if(e===this.costRowIndex)return!1;var t=this.matrix;if(!this.variablesPerIndex[this.varIndexByRow[e]].isInteger)return!1;var n=t[e][this.rhsColumn],i=n-Math.floor(n);if(i<this.precision||1-this.precision<i)return!1;var r=this.height;t[r]=t[r-1].slice(),this.height+=1,this.nVars+=1;var o=this.getNewElementIndex();this.varIndexByRow[r]=o,this.rowByVarIndex[o]=r,this.colByVarIndex[o]=-1,this.variablesPerIndex[o]=new xh("s"+o,o),t[r][this.rhsColumn]=Math.floor(n);for(var a=1;a<this.varIndexByCol.length;a+=1)if(this.variablesPerIndex[this.varIndexByCol[a]].isInteger){var s=t[e][a],l=Math.floor(s)+Math.max(0,s-Math.floor(s)-i)/(1-i);t[r][a]=l}else t[r][a]=Math.min(0,t[e][a]/(1-i));for(var u=0;u<this.width;u+=1)t[r][u]-=t[e][u];return!0},vn.prototype._addUpperBoundMIRCut=function(e){if(e===this.costRowIndex)return!1;var t=this.matrix;if(!this.variablesPerIndex[this.varIndexByRow[e]].isInteger)return!1;var n=t[e][this.rhsColumn],i=n-Math.floor(n);if(i<this.precision||1-this.precision<i)return!1;var r=this.height;t[r]=t[r-1].slice(),this.height+=1,this.nVars+=1;var o=this.getNewElementIndex();this.varIndexByRow[r]=o,this.rowByVarIndex[o]=r,this.colByVarIndex[o]=-1,this.variablesPerIndex[o]=new xh("s"+o,o),t[r][this.rhsColumn]=-i;for(var a=1;a<this.varIndexByCol.length;a+=1){var s=this.variablesPerIndex[this.varIndexByCol[a]],l=t[e][a],u=l-Math.floor(l);t[r][a]=s.isInteger?u<=i?-u:-(1-u)*i/u:0<=l?-l:l*i/(1-i)}return!0},vn.prototype.applyMIRCuts=function(){for(var e=this.height,t=0;t<e;t+=1)this._addUpperBoundMIRCut(t);for(t=0;t<e;t+=1)this._addLowerBoundMIRCut(t)},vn.prototype._putInBase=function(e){var t=this.rowByVarIndex[e];if(-1===t){for(var n=this.colByVarIndex[e],i=1;i<this.height;i+=1){var r=this.matrix[i][n];if(r<-this.precision||this.precision<r){t=i;break}}this.pivot(t,n)}return t},vn.prototype._takeOutOfBase=function(e){var t=this.colByVarIndex[e];if(-1===t){for(var n=this.rowByVarIndex[e],i=this.matrix[n],r=1;r<this.height;r+=1){var o=i[r];if(o<-this.precision||this.precision<o){t=r;break}}this.pivot(n,t)}return t},vn.prototype.updateVariableValues=function(){for(var e=this.variables.length,t=Math.round(1/this.precision),n=0;n<e;n+=1){var i=this.variables[n],o=this.rowByVarIndex[i.index];i.value=-1===o?0:Math.round(this.matrix[o][this.rhsColumn]*t)/t}},vn.prototype.updateRightHandSide=function(e,t){var n=this.height-1,i=this.rowByVarIndex[e.index];if(-1===i){for(var r=this.colByVarIndex[e.index],o=0;o<=n;o+=1){var a=this.matrix[o];a[this.rhsColumn]-=t*a[r]}var s=this.optionalObjectives.length;if(0<s)for(var l=0;l<s;l+=1){var u=this.optionalObjectives[l].reducedCosts;u[this.rhsColumn]-=t*u[r]}}else this.matrix[i][this.rhsColumn]-=t},vn.prototype.updateConstraintCoefficient=function(e,t,n){if(e.index===t.index)throw new Error("[Tableau.updateConstraintCoefficient] constraint index should not be equal to variable index !");var i=this._putInBase(e.index),r=this.colByVarIndex[t.index];if(-1===r)for(var o=this.rowByVarIndex[t.index],a=0;a<this.width;a+=1)this.matrix[i][a]+=n*this.matrix[o][a];else this.matrix[i][r]-=n},vn.prototype.updateCost=function(e,t){var n=e.index,i=this.width-1,r=this.colByVarIndex[n];if(-1===r){var o,a=this.matrix[this.rowByVarIndex[n]];if(0===e.priority){var s=this.matrix[0];for(o=0;o<=i;o+=1)s[o]+=t*a[o]}else{var l=this.objectivesByPriority[e.priority].reducedCosts;for(o=0;o<=i;o+=1)l[o]+=t*a[o]}}else this.matrix[0][r]-=t},vn.prototype.addConstraint=function(e){var t=e.isUpperBound?1:-1,n=this.height,i=this.matrix[n];void 0===i&&(i=this.matrix[0].slice(),this.matrix[n]=i);for(var r=this.width-1,o=0;o<=r;o+=1)i[o]=0;i[this.rhsColumn]=t*e.rhs;for(var a=e.terms,s=a.length,l=0;l<s;l+=1){var u=a[l],d=u.coefficient,c=u.variable.index,h=this.rowByVarIndex[c];if(-1===h)i[this.colByVarIndex[c]]+=t*d;else{var p=this.matrix[h];for(o=0;o<=r;o+=1)i[o]-=t*d*p[o]}}var g=e.index;this.varIndexByRow[n]=g,this.rowByVarIndex[g]=n,this.colByVarIndex[g]=-1,this.height+=1},vn.prototype.removeConstraint=function(e){var t=e.index,n=this.height-1,i=this._putInBase(t),r=this.matrix[n];this.matrix[n]=this.matrix[i],this.matrix[i]=r,this.varIndexByRow[i]=this.varIndexByRow[n],this.varIndexByRow[n]=-1,this.rowByVarIndex[t]=-1,this.availableIndexes[this.availableIndexes.length]=t,e.slack.index=-1,--this.height},vn.prototype.addVariable=function(e){var t=this.height-1,n=this.width,i=!0===this.model.isMinimization?-e.cost:e.cost,r=e.priority,o=this.optionalObjectives.length;if(0<o)for(var a=0;a<o;a+=1)this.optionalObjectives[a].reducedCosts[n]=0;0===r?this.matrix[0][n]=i:(this.setOptionalObjective(r,n,i),this.matrix[0][n]=0);for(var s=1;s<=t;s+=1)this.matrix[s][n]=0;var l=e.index;this.varIndexByCol[n]=l,this.rowByVarIndex[l]=-1,this.colByVarIndex[l]=n,this.width+=1},vn.prototype.removeVariable=function(e){var t=e.index,n=this._takeOutOfBase(t),i=this.width-1;if(n!==i){for(var r=this.height-1,o=0;o<=r;o+=1){var a=this.matrix[o];a[n]=a[i]}var s=this.optionalObjectives.length;if(0<s)for(var l=0;l<s;l+=1){var u=this.optionalObjectives[l].reducedCosts;u[n]=u[i]}var d=this.varIndexByCol[i];this.varIndexByCol[n]=d,this.colByVarIndex[d]=n}this.varIndexByCol[i]=-1,this.colByVarIndex[t]=-1,this.availableIndexes[this.availableIndexes.length]=t,e.index=-1,--this.width},vn.prototype.log=function(e,t){console.log("****",e,"****"),console.log("Nb Variables",this.width-1),console.log("Nb Constraints",this.height-1),console.log("Basic Indexes",this.varIndexByRow),console.log("Non Basic Indexes",this.varIndexByCol),console.log("Rows",this.rowByVarIndex),console.log("Cols",this.colByVarIndex);var n,i,r,o,a,s,l,u,d,c,h="",p=[" "];for(i=1;i<this.width;i+=1)l=" ",u="\t",5<(s=void 0===(o=this.variablesPerIndex[a=this.varIndexByCol[i]])?"c"+a:o.id).length?l+=" ":u+="\t",p[i]=l,h+=u+s;console.log(h);var g=this.matrix[this.costRowIndex],m="\t";for(n=1;n<this.width;n+=1)m+="\t",m+=p[n],m+=g[n].toFixed(5);for(m+="\t"+p[0]+g[0].toFixed(5),console.log(m+"\tZ"),r=1;r<this.height;r+=1){for(d=this.matrix[r],c="\t",i=1;i<this.width;i+=1)c+="\t"+p[i]+d[i].toFixed(5);c+="\t"+p[0]+d[0].toFixed(5),s=void 0===(o=this.variablesPerIndex[a=this.varIndexByRow[r]])?"c"+a:o.id,console.log(c+"\t"+s)}console.log("");var b=this.optionalObjectives.length;if(0<b){console.log("    Optional objectives:");for(var v=0;v<b;v+=1){var y=this.optionalObjectives[v].reducedCosts,E="";for(n=1;n<this.width;n+=1)E+=y[n]<0?"":" ",E+=p[n],E+=y[n].toFixed(5);E+=(y[0]<0?"":" ")+p[0]+y[0].toFixed(5),console.log(E+" z"+v)}}return console.log("Feasible?",this.feasible),console.log("evaluation",this.evaluation),this},vn.prototype.copy=function(){var e=new vn(this.precision);e.width=this.width,e.height=this.height,e.nVars=this.nVars,e.model=this.model,e.variables=this.variables,e.variablesPerIndex=this.variablesPerIndex,e.unrestrictedVars=this.unrestrictedVars,e.lastElementIndex=this.lastElementIndex,e.varIndexByRow=this.varIndexByRow.slice(),e.varIndexByCol=this.varIndexByCol.slice(),e.rowByVarIndex=this.rowByVarIndex.slice(),e.colByVarIndex=this.colByVarIndex.slice(),e.availableIndexes=this.availableIndexes.slice();for(var t=[],n=0;n<this.optionalObjectives.length;n++)t[n]=this.optionalObjectives[n].copy();e.optionalObjectives=t;for(var i=this.matrix,r=new Array(this.height),o=0;o<this.height;o++)r[o]=i[o].slice();return e.matrix=r,e},vn.prototype.save=function(){this.savedState=this.copy()},vn.prototype.restore=function(){if(null!==this.savedState){var e,t,n=this.savedState,i=n.matrix;for(this.nVars=n.nVars,this.model=n.model,this.variables=n.variables,this.variablesPerIndex=n.variablesPerIndex,this.unrestrictedVars=n.unrestrictedVars,this.lastElementIndex=n.lastElementIndex,this.width=n.width,this.height=n.height,e=0;e<this.height;e+=1){var r=i[e],o=this.matrix[e];for(t=0;t<this.width;t+=1)o[t]=r[t]}var a=n.varIndexByRow;for(t=0;t<this.height;t+=1)this.varIndexByRow[t]=a[t];for(;this.varIndexByRow.length>this.height;)this.varIndexByRow.pop();var s=n.varIndexByCol;for(e=0;e<this.width;e+=1)this.varIndexByCol[e]=s[e];for(;this.varIndexByCol.length>this.width;)this.varIndexByCol.pop();for(var l=n.rowByVarIndex,u=n.colByVarIndex,d=0;d<this.nVars;d+=1)this.rowByVarIndex[d]=l[d],this.colByVarIndex[d]=u[d];if(0<n.optionalObjectives.length&&0<this.optionalObjectives.length){this.optionalObjectives=[],this.optionalObjectivePerPriority={};for(var c=0;c<n.optionalObjectives.length;c++){var h=n.optionalObjectives[c].copy();this.optionalObjectives[c]=h,this.optionalObjectivePerPriority[h.priority]=h}}}},vn.prototype.getMostFractionalVar=function(){for(var e=0,t=null,n=null,i=this.model.integerVariables,r=i.length,o=0;o<r;o++){var a=i[o].index,s=this.rowByVarIndex[a];if(-1!==s){var l=this.matrix[s][this.rhsColumn],u=Math.abs(l-Math.round(l));e<u&&(e=u,t=a,n=l)}}return new Pv(t,n)},vn.prototype.getFractionalVarWithLowestCost=function(){for(var e=1/0,t=null,n=null,i=this.model.integerVariables,r=i.length,o=0;o<r;o++){var a=i[o],s=a.index,l=this.rowByVarIndex[s];if(-1!==l){var u=this.matrix[l][this.rhsColumn];if(Math.abs(u-Math.round(u))>this.precision){var d=a.cost;d<e&&(e=d,t=s,n=u)}}}return new Pv(t,n)},vn.prototype.countIntegerValues=function(){for(var e=0,t=1;t<this.height;t+=1)if(this.variablesPerIndex[this.varIndexByRow[t]].isInteger){var n=this.matrix[t][this.rhsColumn];(n-=Math.floor(n))<this.precision&&-n<this.precision&&(e+=1)}return e},vn.prototype.isIntegral=function(){for(var e=this.model.integerVariables,t=e.length,n=0;n<t;n++){var i=this.rowByVarIndex[e[n].index];if(-1!==i){var r=this.matrix[i][this.rhsColumn];if(Math.abs(r-Math.round(r))>this.precision)return!1}}return!0},vn.prototype.computeFractionalVolume=function(e){for(var t=-1,n=1;n<this.height;n+=1)if(this.variablesPerIndex[this.varIndexByRow[n]].isInteger){var i=this.matrix[n][this.rhsColumn];if(i=Math.abs(i),Math.min(i-Math.floor(i),Math.floor(i+1))<this.precision){if(!e)return 0}else-1===t?t=i:t*=i}return-1===t?0:t};var DS=vn;function Dv(e,t,n){this.type=e,this.varIndex=t,this.value=n}function bh(e,t){this.relaxedEvaluation=e,this.cuts=t}function RS(e,t){return t.relaxedEvaluation-e.relaxedEvaluation}vn.prototype.applyCuts=function(e){if(this.restore(),this.addCutConstraints(e),this.simplex(),this.model.useMIRCuts)for(var t=!0;t;){var n=this.computeFractionalVolume(!0);this.applyMIRCuts(),this.simplex(),.9*n<=this.computeFractionalVolume(!0)&&(t=!1)}},vn.prototype.branchAndCut=function(){for(var e=[],t=0,n=1/0,i=null,r=[],o=0;o<this.optionalObjectives.length;o+=1)r.push(1/0);var a=new bh(-1/0,[]);for(e.push(a);0<e.length;)if(!((a=e.pop()).relaxedEvaluation>n)){var s=a.cuts;if(this.applyCuts(s),t++,!1!==this.feasible){var l=this.evaluation;if(!(n<l)){if(l===n){for(var u=!0,d=0;d<this.optionalObjectives.length&&!(this.optionalObjectives[d].reducedCosts[0]>r[d]);d+=1)if(this.optionalObjectives[d].reducedCosts[0]<r[d]){u=!1;break}if(u)continue}if(!0===this.isIntegral()){if(1===t)return void(this.branchAndCutIterations=t);i=a,n=l;for(var c=0;c<this.optionalObjectives.length;c+=1)r[c]=this.optionalObjectives[c].reducedCosts[0]}else{1===t&&this.save();for(var h=this.getMostFractionalVar(),p=h.index,g=[],m=[],b=s.length,v=0;v<b;v+=1){var y=s[v];y.varIndex===p?"min"===y.type?m.push(y):g.push(y):(g.push(y),m.push(y))}var E=Math.ceil(h.value),S=Math.floor(h.value),w=new Dv("min",p,E);g.push(w);var M=new Dv("max",p,S);m.push(M),e.push(new bh(l,g)),e.push(new bh(l,m)),e.sort(RS)}}}}null!==i&&this.applyCuts(i.cuts),this.branchAndCutIterations=t};var zS={},dd=Xo.Constraint,Rv=Xo.Equality,BS=Xo.Variable,VS=Xo.IntegerVariable;function ti(e,t){this.tableau=new vn(e),this.name=t,this.variables=[],this.integerVariables=[],this.unrestrictedVariables={},this.constraints=[],this.nConstraints=0,this.nVariables=0,this.isMinimization=!0,this.tableauInitialized=!1,this.relaxationIndex=1,this.useMIRCuts=!0,this.checkForCycles=!1}var Eh=ti;ti.prototype.minimize=function(){return this.isMinimization=!0,this},ti.prototype.maximize=function(){return this.isMinimization=!1,this},ti.prototype._getNewElementIndex=function(){if(0<this.availableIndexes.length)return this.availableIndexes.pop();var e=this.lastElementIndex;return this.lastElementIndex+=1,e},ti.prototype._addConstraint=function(e){var t=e.slack;this.tableau.variablesPerIndex[t.index]=t,this.constraints.push(e),this.nConstraints+=1,!0===this.tableauInitialized&&this.tableau.addConstraint(e)},ti.prototype.smallerThan=function(e){var t=new dd(e,!0,this.tableau.getNewElementIndex(),this);return this._addConstraint(t),t},ti.prototype.greaterThan=function(e){var t=new dd(e,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(t),t},ti.prototype.equal=function(e){var t=new dd(e,!0,this.tableau.getNewElementIndex(),this);this._addConstraint(t);var n=new dd(e,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(n),new Rv(t,n)},ti.prototype.addVariable=function(e,t,n,i,r){if("string"==typeof r)switch(r){case"required":r=0;break;case"strong":r=1;break;case"medium":r=2;break;case"weak":r=3;break;default:r=0}var o,a=this.tableau.getNewElementIndex();return null==t&&(t="v"+a),null==e&&(e=0),null==r&&(r=0),n?(o=new VS(t,e,a,r),this.integerVariables.push(o)):o=new BS(t,e,a,r),this.variables.push(o),this.tableau.variablesPerIndex[a]=o,i&&(this.unrestrictedVariables[a]=!0),this.nVariables+=1,!0===this.tableauInitialized&&this.tableau.addVariable(o),o},ti.prototype._removeConstraint=function(e){var t=this.constraints.indexOf(e);-1!==t?(this.constraints.splice(t,1),--this.nConstraints,!0===this.tableauInitialized&&this.tableau.removeConstraint(e),e.relaxation&&this.removeVariable(e.relaxation)):console.warn("[Model.removeConstraint] Constraint not present in model")},ti.prototype.removeConstraint=function(e){return e.isEquality?(this._removeConstraint(e.upperBound),this._removeConstraint(e.lowerBound)):this._removeConstraint(e),this},ti.prototype.removeVariable=function(e){var t=this.variables.indexOf(e);if(-1!==t)return this.variables.splice(t,1),!0===this.tableauInitialized&&this.tableau.removeVariable(e),this;console.warn("[Model.removeVariable] Variable not present in model")},ti.prototype.updateRightHandSide=function(e,t){return!0===this.tableauInitialized&&this.tableau.updateRightHandSide(e,t),this},ti.prototype.updateConstraintCoefficient=function(e,t,n){return!0===this.tableauInitialized&&this.tableau.updateConstraintCoefficient(e,t,n),this},ti.prototype.setCost=function(e,t){var n=e-t.cost;return!1===this.isMinimization&&(n=-n),t.cost=e,this.tableau.updateCost(t,n),this},ti.prototype.loadJson=function(e){this.isMinimization="max"!==e.opType;for(var t=e.variables,n=e.constraints,i={},r={},o=Object.keys(n),a=o.length,s=0;s<a;s+=1){var l,u,d=o[s],c=n[d],h=c.equal,p=c.weight,g=c.priority,m=void 0!==p||void 0!==g;if(void 0===h){var b=c.min;void 0!==b&&(l=this.greaterThan(b),i[d]=l,m&&l.relax(p,g));var v=c.max;void 0!==v&&(u=this.smallerThan(v),r[d]=u,m&&u.relax(p,g))}else{l=this.greaterThan(h),i[d]=l,u=this.smallerThan(h),r[d]=u;var y=new Rv(l,u);m&&y.relax(p,g)}}for(var E=Object.keys(t),S=E.length,w=e.ints||{},M=e.binaries||{},O=e.unrestricted||{},F=e.optimize,L=0;L<S;L+=1){var N=E[L],B=t[N],J=!!M[N],U=this.addVariable(B[F]||0,N,!!w[N]||J,!!O[N]);J&&this.smallerThan(1).addTerm(1,U);var Y=Object.keys(B);for(s=0;s<Y.length;s+=1){var he=Y[s];if(he!==F){var pe=B[he],we=i[he];void 0!==we&&we.addTerm(pe,U);var ke=r[he];void 0!==ke&&ke.addTerm(pe,U)}}}return this},ti.prototype.getNumberOfIntegerVariables=function(){return this.integerVariables.length},ti.prototype.solve=function(){return!1===this.tableauInitialized&&(this.tableau.setModel(this),this.tableauInitialized=!0),this.tableau.solve()},ti.prototype.isFeasible=function(){return this.tableau.feasible},ti.prototype.save=function(){return this.tableau.save()},ti.prototype.restore=function(){return this.tableau.restore()},ti.prototype.activateMIRCuts=function(e){this.useMIRCuts=e},ti.prototype.debug=function(e){this.checkForCycles=e},ti.prototype.log=function(e){return this.tableau.log(e)};var zv={CleanObjectiveAttributes:function(e){var t,n,i;if("string"==typeof e.optimize){if(e.constraints[e.optimize]){for(n in t=Math.random(),e.variables)e.variables[n][e.optimize]&&(e.variables[n][t]=e.variables[n][e.optimize]);return e.constraints[t]=e.constraints[e.optimize],delete e.constraints[e.optimize],e}return e}for(i in e.optimize)if(e.constraints[i])if("equal"===e.constraints[i])delete e.optimize[i];else{for(n in t=Math.random(),e.variables)e.variables[n][i]&&(e.variables[n][t]=e.variables[n][i]);e.constraints[t]=e.constraints[i],delete e.constraints[i]}return e}};function US(e){return e.length?function(t){var n={is_blank:/^\W{0,}$/,is_objective:/(max|min)(imize){0,}\:/i,is_int:/^(?!\/\*)\W{0,}int/i,is_constraint:/(\>|\<){0,}\=/i,is_unrestricted:/^\S{0,}unrestricted/i,parse_lhs:/(\-|\+){0,1}\s{0,1}\d{0,}\.{0,}\d{0,}\s{0,}[A-Za-z]\S{0,}/gi,parse_rhs:/(\-|\+){0,1}\d{1,}\.{0,}\d{0,}\W{0,}\;{0,1}$/i,parse_dir:/(\>|\<){0,}\=/gi,parse_int:/[^\s|^\,]+/gi,get_num:/(\-|\+){0,1}(\W|^)\d+\.{0,1}\d{0,}/g,get_word:/[A-Za-z].*/},i={opType:"",optimize:"_obj",constraints:{},variables:{}},r={">=":"min","<=":"max","=":"equal"},o="",a=null,s="",l="",u="",d=0;"string"==typeof t&&(t=t.split("\n"));for(var c=0;c<t.length;c++)if(u="__"+c,a=null,n.is_objective.test(o=t[c]))i.opType=o.match(/(max|min)/gi)[0],(a=o.match(n.parse_lhs).map(function(p){return p.replace(/\s+/,"")}).slice(1)).forEach(function(p){s=null===(s=p.match(n.get_num))?"-"===p.substr(0,1)?-1:1:s[0],s=parseFloat(s),l=p.match(n.get_word)[0].replace(/\;$/,""),i.variables[l]=i.variables[l]||{},i.variables[l]._obj=s});else if(n.is_int.test(o))a=o.match(n.parse_int).slice(1),i.ints=i.ints||{},a.forEach(function(p){p=p.replace(";",""),i.ints[p]=1});else if(n.is_constraint.test(o)){var h=o.indexOf(":");(a=(-1===h?o:o.slice(h+1)).match(n.parse_lhs).map(function(p){return p.replace(/\s+/,"")})).forEach(function(p){s=null===(s=p.match(n.get_num))?"-"===p.substr(0,1)?-1:1:s[0],s=parseFloat(s),l=p.match(n.get_word)[0],i.variables[l]=i.variables[l]||{},i.variables[l][u]=s}),d=parseFloat(o.match(n.parse_rhs)[0]),o=r[o.match(n.parse_dir)[0]],i.constraints[u]=i.constraints[u]||{},i.constraints[u][o]=d}else n.is_unrestricted.test(o)&&(a=o.match(n.parse_int).slice(1),i.unrestricted=i.unrestricted||{},a.forEach(function(p){p=p.replace(";",""),i.unrestricted[p]=1}));return i}(e):function(t){if(!t)throw new Error("Solver requires a model to operate on");var n="",i={max:"<=",min:">=",equal:"="},r=new RegExp("[^A-Za-z0-9]+","gi");for(var o in n+=t.opType+":",t.variables)t.variables[o][o]=t.variables[o][o]?t.variables[o][o]:1,t.variables[o][t.optimize]&&(n+=" "+t.variables[o][t.optimize]+" "+o.replace(r,"_"));for(o in n+=";\n",t.constraints)for(var a in t.constraints[o]){for(var s in t.variables)t.variables[s][o]&&(n+=" "+t.variables[s][o]+" "+s.replace(r,"_"));n+=" "+i[a]+" "+t.constraints[o][a],n+=";\n"}if(t.ints)for(o in n+="\n\n",t.ints)n+="int "+o.replace(r,"_")+";\n";if(t.unrestricted)for(o in n+="\n\n",t.unrestricted)n+="unrestricted "+o.replace(r,"_")+";\n";return n}(e)}function Bv(){this.Model=Eh,this.branchAndCut=zS,this.Constraint=jS,this.Variable=ZS,this.Numeral=GS,this.Term=qS,this.Tableau=DS,this.lastSolvedModel=null,this.Solve=function(e,t,n,i){if(i)for(var r in zv)e=zv[r](e);if(!e)throw new Error("Solver requires a model to operate on");!(e instanceof Eh)&&(e=new Eh(t).loadJson(e));var o=e.solve();if(this.lastSolvedModel=e,o.solutionSet=o.generateSolutionSet(),n)return o;var a={};return a.feasible=o.feasible,a.result=o.evaluation,a.bounded=o.bounded,Object.keys(o.solutionSet).map(function(s){a[s]=o.solutionSet[s]}),a},this.ReformatLP=US,this.MultiObjective=function(e){return function(t,n){var i,r,o,a,s,l=n.optimize,u=JSON.parse(JSON.stringify(n.optimize)),d=Object.keys(n.optimize),c=0,h={},p="",g={},m=[];for(delete n.optimize,r=0;r<d.length;r++)u[d[r]]=0;for(r=0;r<d.length;r++){for(s in n.optimize=d[r],n.opType=l[d[r]],i=t.Solve(n,void 0,void 0,!0),d)if(!n.variables[d[s]])for(a in i[d[s]]=i[d[s]]?i[d[s]]:0,n.variables)n.variables[a][d[s]]&&i[a]&&(i[d[s]]+=i[a]*n.variables[a][d[s]]);for(p="base",o=0;o<d.length;o++)p+=i[d[o]]?"-"+(1e3*i[d[o]]|0)/1e3:"-0";if(!h[p]){for(h[p]=1,c++,o=0;o<d.length;o++)i[d[o]]&&(u[d[o]]+=i[d[o]]);delete i.feasible,delete i.result,m.push(i)}}for(r=0;r<d.length;r++)n.constraints[d[r]]={equal:u[d[r]]/c};for(r in n.optimize="cheater-"+Math.random(),n.opType="max",n.variables)n.variables[r].cheater=1;for(r in m)for(a in m[r])g[a]=g[a]||{min:1e99,max:-1e99};for(r in g)for(a in m)m[a][r]?(m[a][r]>g[r].max&&(g[r].max=m[a][r]),m[a][r]<g[r].min&&(g[r].min=m[a][r])):(m[a][r]=0,g[r].min=0);return{midpoint:i=t.Solve(n,void 0,void 0,!0),vertices:m,ranges:g}}(this,e)}}var jS=Xo.Constraint,ZS=Xo.Variable,GS=Xo.Numeral,qS=Xo.Term;"object"==typeof window&&(window.solver=new Bv);var HS=new Bv;function WS(e){var t={},n={},i={};e.nodes.forEach(function(o){n[o.id]=1,t[o.id]={opt:o.children.length},o.children.forEach(function(a){var s=o.id+"->"+a.id;i[s]={min:1},t[o.id][s]=-1})}),e.nodes.forEach(function(o){o.children.forEach(function(a){var s=o.id+"->"+a.id;t[a.id].opt--,t[a.id][s]=1})});var r=HS.Solve({optimize:"opt",opType:"max",constraints:i,variables:t,ints:n});return e.nodes.forEach(function(o){o.layer=r[o.id]||0}),e}function Vv(e){return e.nodes.forEach(function(t){t.layer=null!=t.data.layer?t.data.layer:t.layer}),e}function YS(e){var t=Object.assign({},{normalization:!0},e),n=WS;return function(i){if(i.nodes.some(function(c){return"layer"in c.data&&c.data.layer<0}))throw new Error("Some nodes have negative layering information");if(!t.normalization&&i.nodes.every(function(c){return"layer"in c.data&&-1<c.data.layer})){var r=[];i.nodes.forEach(function(c){return r[c.data.layer]=1});for(var o=r.findIndex(function(c){return null!=c}),a=0,s=r.slice(o);a<s.length;a+=1)if(null==s[a])throw new Error("The overall layering contains gaps (two non-consecutive layers)")}i.nodes.some(function(c){return"layer"in c.data&&0===c.data.layer})||Vv(n(i));var l,u,d=function(c){if(c.nodes.every(function(p){return p.layer})){var h=1/0;c.nodes.forEach(function(p){h=Math.min(h,p.layer)}),c.nodes.forEach(function(p){p.layer-=h})}return c}(function(c){if(c.nodes.some(function(p){return p.data.sink})){var h=-1/0;c.nodes.forEach(function(p){h=Math.max(h,p.layer)}),c.nodes.forEach(function(p){p.data.sink&&(p.layer=h+1)})}return c}(function(c){var h={};c.nodes.forEach(function(w){h[w.id]=(h[w.id]||[]).concat(w.children),w.children.forEach(function(M){h[M.id]=(h[M.id]||[]).concat([w])})});var p=[];c.nodes.forEach(function(w){0===w.layer&&p.push(w)});var g={},m={};for(c.nodes.forEach(function(w){null!=w.layer&&(m[w.id]=w.layer)});p.length;)for(var b=p.shift().id,v=0,y=h[b];v<y.length;v+=1){var E=y[v];if(!g[E.id]){if(null==m[E.id]){var S=m[b]+1;m[E.id]=S,E.layer=S}g[E.id]=!0,p.push(E)}}return c}(Vv(i))));return function(c,h){if(h.normalization){var p=[];c.nodes.forEach(function(m){return p[m.layer]=0});var g=Array.from(p).reduce(function(m,b,v){if(0===v)return m.push(0),m;var y=m[v-1];return m.push(null!=b?y:y-1),m},[]);c.nodes.forEach(function(m){m.layer+=g[m.layer]})}}(d,t),(u=(l=d).nodes.reduce(function(c,h){return h.data.fixed&&(null==c||c.layer>h.layer)?h:c},null))&&l.nodes.forEach(function(c){c.ref=u.id}),l}}var Jo=function(){this.root=null};function XS(e){return e.nodes.filter(function(t){return!t.layer})}Jo.prototype.fit=function(e){this.root={x:0,y:0,w:e.length?e[0].w:0,h:e.length?e[0].h:0};for(var i=0,r=e;i<r.length;i+=1){var o=r[i],a=this.findNode(this.root,o.w,o.h);o.fit=a?this.splitNode(a,o.w,o.h):this.growNode(o.w,o.h)}},Jo.prototype.findNode=function(e,t,n){return e.used?this.findNode(e.right,t,n)||this.findNode(e.down,t,n):t<=e.w&&n<=e.h?e:void 0},Jo.prototype.splitNode=function(e,t,n){return e.used=!0,e.down={x:e.x,y:e.y+n,w:e.w,h:e.h-n},e.right={x:e.x+t,y:e.y,w:e.w-t,h:n},e},Jo.prototype.growNode=function(e,t){var n=e<=this.root.w,i=t<=this.root.h;return i&&this.root.h>=this.root.w+e?this.growRight(e,t):n&&this.root.w>=this.root.h+t?this.growDown(e,t):i?this.growRight(e,t):n?this.growDown(e,t):void 0},Jo.prototype.getNewRoot=function(e,t,n,i){return void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=this.root),void 0===i&&(i=this.root),{used:!0,x:0,y:0,w:this.root.w+e,h:this.root.h+t,right:n,down:i}},Jo.prototype.growRight=function(e,t){return this.root=this.getNewRoot(e,0,{x:this.root.w,y:0,w:e,h:this.root.h}),this.grow(e,t)},Jo.prototype.growDown=function(e,t){return this.root=this.getNewRoot(0,t,void 0,{x:0,y:this.root.h,w:this.root.w,h:t}),this.grow(e,t)},Jo.prototype.grow=function(e,t){var n=this.findNode(this.root,e,t);if(n)return this.splitNode(n,e,t)};var Uv={down:function(){},up:function(e,t,n){e.y=-e.y+n},left:function(e,t,n){var i=e.x;e.x=-e.y+n,e.y=i-t},right:function(e,t,n){var i=e.x;e.x=e.y-n,e.y=-i+t}};function jv(e,t,n){for(var i,r,o,a,s=-1/0,l=-1/0,u=[],d=n.nodesSeparation||0,c=(i=t,o=(r=e.reduce(function(He,Pe){return Pe.nodes.reduce(function(We,Qe){var Me=i[Qe.id]||{},ze=Me.x,qe=Me.y;return null!=ze&&null!==qe&&(We.x=Math.min(ze,We.x),We.y=Math.min(qe,We.y)),We},He)},{x:1/0,y:1/0})).x,a=r.y,{x:isFinite(o)?o:0,y:isFinite(a)?a:0}),h=e.reduce(function(He,Pe){return Pe.nodes.filter(function(We){return We.data&&We.data.fixed}).reduce(function(We,Qe){var nt=t[Qe.id];return We[Qe.id]={x:nt.x,y:nt.y},We},He)},{}),p=function(){var He=m[g],Pe={},We=He.nodes,Qe=1==We.length,nt=2*Iv(We)|5,Me=null!=n.layerSeparation?n.layerSeparation:50,ze=We.reduce(function(Z,z){return Math.min(Z,z.x)},1/0);s=We.reduce(function(Z,z){return Math.max(Z,z.x)},-1/0)-ze;for(var qe=0,Ke=We;qe<Ke.length;qe+=1){var ht=Ke[qe],Wt=ht.x,$t=ht.y,dn=ht.id;t[dn]&&(Qe?t[dn].x=t[dn].y=0:(t[dn].x=Wt-ze,t[dn].y=$t,Pe[$t]=Pe[$t]||[],Pe[$t].push(t[dn])))}var sn=Math.max(nt,Me),pn=Object.keys(Pe),W=pn.reduce(function(Z,z){return Math.max(Z,Pe[z].length-1)},1)*(3+Math.max(1,d));l=(pn.length||1)*sn,s=Math.max(s,1),He.isFake||pn.sort(function(Z,z){return Z-z}).forEach(function(Z,z){Pe[Z].forEach(function(K){K.y=z*sn,K.x=K.x/s*W})}),u.push({w:Math.ceil(W),h:Math.ceil(l),dag:He}),l=s=-1/0},g=0,m=e;g<m.length;g+=1)p();u.sort(function(He,Pe){return Math.max(Pe.w,Pe.h)-Math.max(He.w,He.h)}),(new Jo).fit(u);for(var v,S=u.reduce(function(He,Pe){return Math.max(He,Pe.h)},1),w=u.reduce(function(He,Pe){var We=Pe.fit;return Math.max(We&&We.x||0,He)},1),M=0,O=u;M<O.length;M+=1){for(var F=O[M],N=F.dag,B=F.w,X=F.h,J=F.fit||{x:0,y:0},ae=J.y/S*50+J.y,ie=J.x/w*100+J.x,U=0,Y=N.nodes;U<Y.length;U+=1){var he=Y[U].id;t[he]&&(t[he].x+=ie,t[he].y+=ae,(v=n.direction)&&v in Uv&&Uv[v](t[he],(B+ie)/2,(X+ae)/2),t[he].x+=c.x,t[he].y+=c.y)}var pe=N.nodes[0]&&N.nodes[0].ref,we=0,ke=0;if(pe&&(we=t[pe].x-h[pe].x,ke=t[pe].y-h[pe].y),we||ke)for(var at=0,st=N.nodes;at<st.length;at+=1){var Xe=st[at].id;t[Xe]&&(t[Xe].x-=we,t[Xe].y-=ke)}}for(var xt=0,It=Object.keys(h);xt<It.length;xt+=1){var Ge=It[xt];t[Ge].x=h[Ge].x,t[Ge].y=h[Ge].y}return e}var Zv={rect:jv,hierarchy:function(e,t,n,i){var r=e;if(1<e.length){for(var o={id:"__root__",parentIds:[],virtual:!0},a=0,s=e.map(XS);a<s.length;a+=1)for(var l=0,u=s[a];l<u.length;l+=1)u[l].data.parentIds.push(o.id);r=i([e.reduce(function(d,c){return d.concat(c.nodes.map(function(h){return h.data}))},[o])],n)}return jv(r,t,n)}};function $S(e){if(!e||!e.length)throw Error("Cannot stratify empty data");for(var t=0,n=e;t<n.length;t+=1){var i=n[t];if(null==i)throw Error('Node data is "null"');if(null==i.id)throw Error('Node id contains a "null" value')}for(var r=e.map(function(g){return lh(g.id,g)}),o=r.reduce(function(g,m){if(g[m.id])throw Error("The connected component contains id duplicates: "+m.id);return g[m.id]=m,g},{}),a=lh(),s=0,l=r;s<l.length;s+=1){for(var u=l[s],d=0,c=u.data.parentIds;d<c.length;d+=1){var h=c[d],p=o[h];if(!p)throw Error("The node "+u.id+" has a missing parent id "+h);p.children.push(u)}u.data.parentIds.length||a.children.push(u)}return{nodes:function(g){for(var m={},b=[].concat(g.children),v=[];b.length;){var y=b.pop();m[y.id]||(v.push(y),m[y.id]=1,b.push.apply(b,y.children))}return v}(a)}}function tA(e,t){var n=t.decross,i=t.separation,r=t.coord;(0,t.layering)(e);var o,a,s=e.nodes.reduce(function(l,u){return l[u.layer]=l[u.layer]||[],l[u.layer].push(u),u.children=u.children.map(function(d){if(d.layer===u.layer+1)return d;for(var c=d,h=d.layer-1;h>u.layer;h--){var p=lh(u.id+"->"+d.id+"@"+h);p.children=[c],l[h]=l[h]||[],l[h].push(p),c=p}return c}),l},[]);return a=1===(o=s).length?nA:iA,o.forEach(function(l,u){for(var d=0,c=l;d<c.length;d+=1)c[d].y=a(u,o.length)}),function(l,u){var d=u.coord,c=u.decross,h=u.separation;if(l.every(function(p){return 1===p.length}))return l.forEach(function(p){return p[0].x=.5});c(l),d(l,h)}(s,{decross:n,coord:r,separation:i}),e.nodes.forEach(function(l){l.data&&(l.children=l.children.filter(function(u){return u.data}))}),e}function nA(){return.5}function iA(e,t){return 1*e/(t-1)}function Sh(e){return{id:""+e.id,layer:e.layer,sink:e.sink,radius:e.r,fixed:!1===e.layoutable,parentIds:[],ref:null}}function qv(e,t){void 0===t&&(t={});for(var n=[],i=0,r=e;i<r.length;i+=1){var o=$S(r[i]);n.push(o),tA(o,{decross:function(a){return a.slice(0,a.length-1).forEach(function(s,l){return OS(s,a[l+1])}),a},separation:MS(Iv(o.nodes)),coord:t.evenDistribution?function(e,t){var n=-hh;return e.forEach(function(i){var r=i.filter(Ru);if(1===r.length)r[0].x=.5;else{r.reduce(function(a,s){return s.x=void 0===a?0:a.x+t(a,s),s},void 0);var o=r[r.length-1].x;n=Math.max(n,o),r.forEach(function(a){return a.x/=o})}}),n=Math.max(n,1),us(e,function(i){return i.x*=n}),e}:function(e,t){var n,i,r,o,a,s,l=(n={},us(e,function(F){n[F.id]||(n[F.id]={successors:[],ancestors:[]});for(var L=0,N=F.children;L<N.length;L+=1){var B=N[L];n[B.id]||(n[B.id]={successors:[],ancestors:[]}),B.layer>F.layer&&(n[F.id].successors.push(B),n[B.id].ancestors.push(F)),B.layer<F.layer&&(n[F.id].ancestors.push(B),n[B.id].successors.push(F))}}),{getSuccessors:function(F){return n[F.id].successors},getAncestors:function(F){return n[F.id].ancestors}}),u=l.getSuccessors,d=l.getAncestors,c=(i={},us(e,function(F,L){i[F.id]=L}),i),h=(o=u,a=function(F){return c[F.id]},s=(r=e).length,r.reduce(function(F,L,N){var X=F.conflicts;if(!N||s-2<N)return{prevLayer:F.prevLayer,conflicts:X};var J=0,ae=L.length,ie=L[ae-1];return L.forEach(function(U,Y){var he=function(ke){if(Ru(ke))return o(ke).find(Ru)}(U),pe=he?a(he):ae-1;if(he||U===ie)for(var we=function(){var ke=L[J];o(ke).forEach(function(at){var st=a(at);(st<0||pe<st)&&(X[ke.id]=X[ke.id]||{},X[ke.id][at.id]=!0)}),J++};J<=Y;)we()}),{prevLayer:L,conflicts:X}},{prevLayer:r[0],conflicts:{}}).conflicts),p={};ph(function(F){var L="up"===F?e:[].concat(e).reverse();fh(function(N){N===ch&&(L=L.map(function(we){return[].concat(we).reverse()}));var B,X,J,ae,ie,U,Y=t,he=(X=h,J="up"===F?d:u,ae={},ie={},U={},us(B=L,function(we,ke){ae[we.id]=we.id,ie[we.id]=we.id,U[we.id]=ke}),B.forEach(function(we){var ke=-1;we.forEach(function(at){var st,Xe,xt=J(at).sort(function(We,Qe){return U[We.id]-U[Qe.id]});if(xt.length)for(var It=(xt.length-1)/2,Ge=0,He=[Math.floor(It),Math.ceil(It)];Ge<He.length;Ge+=1){var Pe=xt[He[Ge]];ie[at.id]===at.id&&(Xe=Pe,!(X[(st=at).id]&&X[st.id][Xe.id]||X[Xe.id]&&X[Xe.id][st.id])&&ke<U[Pe.id]&&(ie[Pe.id]=at.id,ae[at.id]=ae[Pe.id],ie[at.id]=ae[at.id],ke=U[Pe.id]))}})}),{roots:ae,aligns:ie}),pe=function(we,ke,at,st){var Xe={},xt={},It={},Ge={},He={},Pe={},We={};us(we,function(Me,ze,qe){Xe[Me.id]=Me,xt[Me.id]=hh,It[Me.id]=ze,He[Me.id]=qe[ze-1]||Me,Pe[Me.id]=Me,We[Me.id]=0});var Qe=Math.max(1e4,1+Object.keys(We).length/2);function nt(Me){if(null==Ge[Me.id]){Ge[Me.id]=0;for(var ze=Me,qe=!1;!qe;){if(null!=He[ze.id]){var Ke=Pe[ke[He[ze.id].id]];if(We[Ke.id]>Qe)return;nt(Ke),We[Ke.id]++,Xe[Me.id]===Me&&(Xe[Me.id]=Xe[Ke.id]),Xe[Me.id]!==Xe[Ke.id]?xt[Xe[Ke.id].id]=Math.min(xt[Xe[Ke.id].id],Ge[Me.id]-Ge[Ke.id]-st(Me,He[Me.id])):Ge[Me.id]=Math.max(Ge[Me.id],Ge[Ke.id]+st(Me,He[Me.id]))}qe=(ze=Pe[at[ze.id]])===Me}}}return we.forEach(function(Me){Me.filter(function(ze){return ke[ze.id]===ze.id}).forEach(nt)}),us(we,function(Me){Ge[Me.id]=Ge[ke[Me.id]];var ze=xt[Xe[ke[Me.id]].id];Me.id===ke[Me.id]&&isFinite(ze)&&(Ge[Me.id]+=ze)}),Ge}(L,he.roots,he.aligns,Y);N===ch&&(pe=uh(pe,function(we){return-we})),p[F+N]=pe})});var g,m,b,v,y,E,S,w=(g=p,m=Object.keys(g).reduce(function(F,L){var N=F.alignment,B=F.value,X=sh(g[L]),J=Math.max.apply(Math,X)-Math.min.apply(Math,X);return B<=J?{alignment:N,value:B}:{alignment:L,value:J}},{alignment:null,value:hh}).alignment,g[m]);b=p,y=sh(v=w),E=Math.min.apply(Math,y),S=Math.max.apply(Math,y),ph(function(F){fh(function(L){var N=F+L,B=b[N];if(B!==v){var X=sh(B),J=L===dh?E-Math.min.apply(Math,X):S-Math.max.apply(Math,X);J&&(b[N]=uh(B,function(ae){return ae+J}))}})});var M,O=uh((M=p).upleft,function(F,L){var N=[];return ph(function(B){fh(function(X){N.push(M[B+X][L])})}),N.sort(function(B,X){return B-X}),(N[1]+N[2])/2});return us(e,function(F){F.x=O[F.id]}),e},layering:YS(t)})}return n}function Hv(e,t){if(!e||!e.nodes)return e;var i,a,l=t||{},u=function(e,t){void 0===t&&(t={});for(var n=(e.edges||[]).filter(function(d){return d.source!==d.target}),i={},r=0,o=e.nodes;r<o.length;r+=1){var a=o[r];i[a.id]=a}var s=function(e,t,n){var i=t.reduce(function(o,a){return o[a.source]=o[a.source]||[],o[a.source].push(a),o},{}),r=e.reduce(function o(a,s){var l=a.visited,u=a.stack,d=a.result;if(l[s.id])return a;l[s.id]=u[s.id]=1;for(var c=0,h=i[s.id]||[];c<h.length;c+=1){var p=h[c];u[p.target]?d.push(p):o(a,n[p.target])}return delete u[s.id],a},{visited:{},stack:{},result:[]}).result.reduce(function(o,a){var s=a.source,l=a.target;return o[s]=o[s]||{},o[s][l]=1,o},{});return t.map(function(o){var a=o.source,s=o.target;return r[a]&&r[a][s]?{source:s,target:a}:o})}(e.nodes,n,i),l=function(d,c,h){void 0===h&&(h={});for(var p=Mv(c),g=Object.keys(p),m=[];g.length;){var b=TS(g[0],p);m.push(b),g=IS(g,b)}return h.skipSingletons?m:m.concat(kv(d,c,p).map(function(v){return[v.id+""]}))}(e.nodes,s,{skipSingletons:"singleton"===t.packing}),u=s.reduce(function(d,c){return d[c.source]||(d[c.source]=Sh(i[c.source])),d[c.target]||(d[c.target]=Sh(i[c.target])),d[c.target].parentIds.push(""+c.source),d},{});return{shapes:l.map(function(d){return d.map(function(c){return u[c]||Sh({id:c})})}),nLookup:i}}(e,l),c=u.nLookup,h=qv(u.shapes,l);if("singleton"===l.packing){var p=kv(e.nodes,e.edges),g=function(e,t){void 0===t&&(t={});var n=e.slice().sort(function(d,c){return c.r-d.r}),i=Math.sqrt(n.length),r=Math.floor(i),o=Math.ceil(i);r*o<n.length&&(r<o?r++:o++);var a=1.2*n.reduce(function(d,c){return Math.max(d,2*c.r)},0),s=Math.max(t.nodesGridSeparation||50,1),l=a*o+s*(o-1),u=a*r+s*Math.max(r-1,0);return n.forEach(function(d,c){var h=c%o,p=Math.floor(c/o);d.x=l*h/o,d.y=u*p/r}),{w:l,h:u}}(p,l);h.push((i=g,Object.assign({},{nodes:p.map(function(m){return Object.assign({},m,{data:m})}),isFake:!0},i)))}return void 0===(a=l)&&(a={}),(Zv[a.packing]||Zv.rect)(h,c,a,qv),e}var Wv={direction:"TB",nodeDistance:50,levelDistance:50,arrangeComponents:"fit",gridDistance:50,layer:"layer"},Yv={imports:{sequential:Hv},configure:function(e,t){void 0===e&&(e={});var n=t.graph,i=t.data;function r(E,S,w){return void 0===w&&(w=E.getNodes()),S?S instanceof ar?S:E.getNodes(S):w}var o=Nt({},Wv,e,{nodeList:null});o.nodeList=r(n,e.nodes),o.direction=e.direction||o.rankdir||Wv.direction,o.layerSeparation=o.levelDistance,o.nodesSeparation=o.nodeDistance,o.packing=o.arrangeComponents;var a=Nt({},o),s=n.getEdges(),l=n.getNodes(o.nodeList);if(-1===["TB","BT","LR","RL"].indexOf(o.direction))throw new Error('direction should be one of the "TB", "BT", "LR", "RL"');if(-1===["fit","grid","singleLine"].indexOf(o.packing))throw new Error('arrangeComponents should be one of the "fit", "grid", "singleLine"');o.nodesGridSeparation=e.gridDistance;var u=l.getId(),d=l.getAttribute("layoutable").reduce(function(E,S,w){return E[u[w]]=S,E},{}),c=l.getAttributes(["x","y"]).reduce(function(E,S,w){return E[u[w]]=S,E},{}),h=l.getAttribute("radius");if("string"!=typeof a.layer)throw new Error("'layer' should be the valid data field name");for(var p=r(n,o.roots,n.nodeList()),g=i.getProperty(o.nodeList,a.layer),m=0,b=p.map(function(E){var S=-1;return o.nodeList.forEach(function(w,M){w===E&&(S=M)}),S});m<b.length;m++)g[b[m]]=0;var v=r(n,o.sinks,n.nodeList()).toArray().reduce(function(E,S){return E[S.getId()]=!0,E},{}),y=u.map(function(E){return v[E]});return{nodes:u,edges:s.map(function(E){return{id:E.getId(),source:E.getSource().getId(),target:E.getTarget().getId()}}),options:Wi(o),layoutable:d,radiuses:h,layers:g,sinks:y,coords:c}},context:function(){},update:function(e){var t=e.nodes,i=e.options,r=e.layoutable,o=e.radiuses,a=e.layers,s=e.sinks,l=e.coords,u=e.edges.filter(function(d){return d.source in r&&d.target in r});return{positions:Hv({nodes:t.map(function(d,c){return{id:d,r:o[c],layer:a[c],sink:s[c],layoutable:r[d],x:l[d].x,y:l[d].y}}),edges:u},{packing:{fit:"rect",singleLine:"hierarchy",grid:"singleton"}[i.arrangeComponents],direction:{TB:"down",BT:"up",RL:"left",LR:"right"}[i.direction],layerSeparation:i.layerSeparation,nodesSeparation:i.nodesSeparation,nodesGridSeparation:i.nodesGridSeparation,evenDistribution:i.evenDistribution}).nodes}},isRunning:function(){return!1},onSync:function(e,t){var n=e.positions,i=t.graph;return{indexes:n.map(function(r){return i.getNode(r.id)._index}),x:n.map(function(r){return r.x}),y:n.map(function(r){return r.y})}}},aA={configure:function(e,t){var n=t.graph,i=t.camera;function r(B){return void 0===B||"number"==typeof B&&isFinite(B)&&0<B}var o=e.sortBy,a=Nt({},e,{nodes:null});e.nodes||(a.nodes=n.getNodes()),e.nodes&&(a.nodes=e.nodes instanceof ar?e.nodes:n.getNodes(e.nodes));var s,l,u,d,c,h=a.nodes,p=Array.from(h._indexes),m=function(B,X,J){if(!r(B))throw new TypeError('"rows" should be a positive integer');if(!r(X))throw new TypeError('"cols" should be a positive integer');if(B)return{rows:B,cols:Math.ceil(J/B)};if(X)return{cols:X,rows:Math.ceil(J/X)};var ae=Math.ceil(Math.sqrt(J));return{cols:ae,rows:Math.ceil(J/ae)}}(a.rows,a.cols,p.length),b=m.rows,v=m.cols,y=(l=n,u=h,d=p,c=e.sortFallbackValue,"string"!=typeof(s=o)?d.map(function(B,X){return X}):"radius"===s?l.getAttribute(!0,"radius").getMultiple(d):"random"===s?d.map(function(){return Math.random()}):u.getData(s).map(function(B){return B||c})),E=h.getAttribute("layoutable"),S=p.reduce(function(B,X,J){return E[J]&&B.push({id:X,attr:y[J]}),B},[]),w=h.getBoundingBox(),M=.65*Math.max(w.maxScaledSize,w.maxFixedSize/i.getZoom()),O=w.minX+M,F=w.maxX-M,L=w.minY+M,N=w.maxY-M;return w.width<M*v*2&&(O=w.cx-M*v+M,F=w.cx+M*v-M),w.height<M*b*2&&(L=w.cy-M*b+M,N=w.cy+M*b-M),{sort:!!o,nodes:S,reverse:!!a.reverse,cols:v,rows:b,minX:O,maxX:F,minY:L,maxY:N}},update:function(e){var n=e.nodes,i=e.maxX,r=e.minX,o=e.maxY,a=e.minY,s=e.reverse,l=e.rows,u=e.cols;e.sort&&n.sort(function(b,v){var y=b.attr,E=v.attr;return y<E?-1:E<y?1:0}),s&&n.reverse();var d=(i-r)/(u-1),c=(o-a)/(l-1),h=r,p=a;isFinite(d)||(d=0),isFinite(c)||(c=0);var g=0,m=0;return n.forEach(function(b){b.x=h+g*d,b.y=p+m*c,(g+=1)===u&&(m+=1,g=0)}),n},onSync:function(e){return{indexes:e.map(function(t){return t.id}),x:e.map(function(t){return t.x}),y:e.map(function(t){return t.y})}}},Xv=(Jv.initNamespace=function(e){e.layouts=function(e){return Nt({},((l=e).modules.layouts.register("concentric",yS),{concentric:function(u){return l.modules.layouts.start("concentric",u)}}),((s=e).modules.layouts.register("radial",xS),{radial:function(u){if(void 0===u.centralNode)throw new Error('concentric layout: missing parameter "centralNode"');u.nodes=s.modules.graph.getNodes(u.nodes);var d=u.nodes.size;if(u.radiusRatio=isFinite(u.radiusRatio)?u.radiusRatio:Math.SQRT2,u.radiusDelta=isFinite(u.radiusDelta)?u.radiusDelta:0,u.nodeGap=isFinite(u.nodeGap)?u.nodeGap:10,u.repulsion=d*(isFinite(u.repulsion)?u.repulsion:1),u.maxIterations=isFinite(u.maxIterations)?Math.floor(u.maxIterations):100,u.maxIterations<1)throw new RangeError("maxIterations must be a positive integer");if(u.iterationsPerRender=isFinite(u.iterationsPerRender)?Math.floor(u.iterationsPerRender):20,u.iterationsPerRender<1)throw new RangeError("iterationsPerRender must be a positive integer");if(u.epsilon=isFinite(u.epsilon)?u.epsilon:.001,u.epsilon<=0)throw new RangeError("epsilon has to be a positive number");return s.modules.layouts.start("radial",u)}}),((a=e).modules.layouts.register("force",bS),{force:function(u){if(void 0===u&&(u={}),u.nodes){if(Array.isArray(u.nodes))u.nodes=a.getNodes(u.nodes);else if(!(u.nodes instanceof ar))throw new Error("'nodes' must be a NodeList or an Array<NodeId>")}else u.nodes=a.modules.graph.getNodes();if(u.incremental)return Cv(u,a,a.layouts.force);if(void 0!==u.edgeStrength&&(!isFinite(u.edgeStrength)||u.edgeStrength<=0||1<u.edgeStrength))throw new Error("force layout: edgeStrength must be between 0 and 1");if(void 0!==u.steps&&(!isFinite(u.steps)||u.steps<=0))throw new Error("force layout: 'steps' must be a positive integer");if(void 0!==u.edgeLength&&(!isFinite(u.edgeLength)||u.edgeLength<=0))throw new Error("force layout: 'edgeLength' must be positive");if(void 0!==u.gravity&&(!isFinite(u.gravity)||u.gravity<0||1<=u.gravity))throw new Error("force layout: 'gravity' must be between 0 and 1");if(void 0!==u.charge&&!isFinite(u.charge))throw new Error("force layout: 'charge' must be a number");if(void 0!==u.radiusRatio&&(!isFinite(u.radiusRatio)||u.radiusRatio<0))throw new Error("force layout: 'radiusRatio' must be a positive number");if(void 0!==u.theta&&(!isFinite(u.theta)||u.theta<0||1<u.theta))throw new Error("force layout: 'theta' must be between 0 and 1");if(!(void 0===u.cx&&void 0===u.cy||"number"==typeof u.cx&&"number"==typeof u.cy))throw new Error("force layout: both 'cx' and 'cy' must be numbers");if(void 0!==u.siblingsOffset&&!isFinite(u.siblingsOffset))throw new Error("force layout: 'siblingsOffset' must be a number");return a.modules.layouts.start("force",u)}}),((o=e).modules.layouts.register("forceLink",CS),{forceLink:function(u){if(void 0===u&&(u={}),u.nodes){if(Array.isArray(u.nodes))u.nodes=o.getNodes(u.nodes);else if(!(u.nodes instanceof ar))throw new Error("'nodes' must be a NodeList or an Array<NodeId>")}else u.nodes=o.modules.graph.getNodes();return u.incremental?Cv(u,o,o.layouts.forceLink):o.modules.layouts.start("forceLink",u)}}),((r=e).modules.layouts.register("hierarchical",Yv),{hierarchical:function(u){return void 0===u&&(u={}),u.useWebWorker=!1,r.modules.layouts.start("hierarchical",u)}}),((i=e).modules.layouts.register("sequential",Yv),{sequential:function(u){void 0===u&&(u={}),u.useWebWorker=!1;var d=Nt({},u,{evenDistribution:!0});return i.modules.layouts.start("sequential",d)}}),((n=e).modules.layouts.register("grid",aA),{grid:function(u){return void 0===u&&(u={}),n.modules.layouts.start("grid",u)}}),(t=e,{incremental:function(u){eo("Incremental ForceLink layout is now deprecated.\n    Please use the incremental option in force and forceLink layouts.");var d=u.nodes,c=u.centralNode;if(d instanceof ar&&0===d.size||Array.isArray(d)&&0===d.length)throw new Error("Incremental ForceLink layout: no nodes are selected");if("margin"in u&&!isFinite(u.margin))throw new Error("Incremental ForceLink layout: margin has to be a positive number");if(c&&!c.getAttribute("layoutable"))return wv(t,u,t.layouts.forceLink);var h=Nt({},u,{nodes:u.nodes instanceof ar?u.nodes:t.getNodes(u.nodes)});return Av(t,h,t.layouts.forceLink)}}),{stop:function(){return e.modules.layouts.stop()}});var t,n,i,r,o,a,s,l}(e)},Jv);function Jv(){}var Qv=(Kv.initNamespace=function(e){var t;e.mouse=(t=e,{move:function(n){return t.modules.virtualMouse.move(n)},down:function(n){return t.modules.virtualMouse.down(n)},up:function(n){return t.modules.virtualMouse.up(n)},click:function(n){return t.modules.virtualMouse.click(n)},rightClick:function(n){return t.modules.virtualMouse.rightClick(n)},doubleClick:function(n){return t.modules.virtualMouse.doubleClick(n)},drag:function(n,i){return t.modules.virtualMouse.drag(n,i)},wheel:function(n){return t.modules.virtualMouse.wheel(n)}})},Kv);function Kv(){}var $v=(ey.initNamespace=function(e){var t;e.pathfinding=(t=e,{astar:function(n,i,r){return void 0===r&&(r={}),t.modules.pathfinding.astar(n,i,r)},dijkstra:function(n,i,r){return void 0===r&&(r={}),t.modules.pathfinding.dijkstra(n,i,r)},dijkstraBig:function(n,i,r){return void 0===r&&(r={}),t.modules.pathfinding.dijkstraBig(n,i,r)}})},ey);function ey(){}var ty=(ny.initNamespace=function(e){var t;e.rules=(t=e,{map:function(n){return t.modules.rules.createMapping(n)},slices:function(n){return t.modules.rules.createSlices(n)},template:function(n){return t.modules.rules.createTemplate(n)}})},ny);function ny(){}var sA=(Ws.prototype.clearSelection=function(){return this.modules.selection.clear()},Ws.prototype.getSelectedNodes=function(){return this.modules.selection.getSelectedNodes()},Ws.prototype.getNonSelectedNodes=function(){return this.modules.selection.getNonSelectedNodes()},Ws.prototype.getSelectedEdges=function(){return this.modules.selection.getSelectedEdges()},Ws.prototype.getNonSelectedEdges=function(){return this.modules.selection.getNonSelectedEdges()},Ws);function Ws(){}var uA=(Ah.prototype.setOptions=function(e){return this.modules.settings.update(e)},Ah.prototype.getOptions=function(){return this.modules.settings.get()},Ah);function Ah(){}var iy=(ry.initNamespace=function(e){var t;e.styles=(t=e,{setNodesVisibility:function(n){return t.modules.graphics.setNodesVisibility(n)},setEdgesVisibility:function(n){return t.modules.graphics.setEdgesVisibility(n)},setNodeTextsVisibility:function(n){return t.modules.graphics.setNodeTextsVisibility(n)},setEdgeTextsVisibility:function(n){return t.modules.graphics.setEdgeTextsVisibility(n)},addRule:function(n){return t.modules.styleRules.addRule(n)},getRuleList:function(){return t.modules.styleRules.getRuleList()},addNodeRule:function(n,i){var r,o;return o=1===arguments.length?void(r=n):(r=i,n),t.styles.addRule({nodeAttributes:r,nodeSelector:o})},addEdgeRule:function(n,i){var r,o;return o=1===arguments.length?void(r=n):(r=i,n),t.styles.addRule({edgeAttributes:r,edgeSelector:o})},getNodeRules:function(){return t.styles.getRuleList().filter(function(n){return void 0===n.getDefinition().edgeAttributes})},getEdgeRules:function(){return t.styles.getRuleList().filter(function(n){return void 0===n.getDefinition().nodeAttributes})},createClass:function(n){return t.modules.classes.createClass(n)},getClass:function(n){return t.modules.classes.getClassByName(n)},getClassList:function(){return t.modules.classes.getClassList()},setHoveredNodeAttributes:function(n,i){t.modules.hover.updateNodeAttributes(n,i)},setHoveredEdgeAttributes:function(n,i){t.modules.hover.updateEdgeAttributes(n,i)},setSelectedNodeAttributes:function(n,i){return t.modules.selection.setNodeAttributes(n,i)},setSelectedEdgeAttributes:function(n,i){return t.modules.selection.setEdgeAttributes(n,i)}})},ry);function ry(){}var oy=(ay.initNamespace=function(e){var t;e.schema=(t=e,{watchNodeObjectProperty:function(n){return t.modules.watcher.watchNodeObjectProperty(n)},watchEdgeObjectProperty:function(n){return t.modules.watcher.watchEdgeObjectProperty(n)},watchNodeNonObjectProperty:function(n){return t.modules.watcher.watchNodeNonObjectProperty(n)},watchEdgeNonObjectProperty:function(n){return t.modules.watcher.watchEdgeNonObjectProperty(n)}})},ay);function ay(){}var sy=(uy.initNamespace=function(e){e.tools=function(e){return{lasso:{enable:function(d){return u.modules.lasso.enable(d),this},disable:function(){return u.modules.lasso.disable(),this},enabled:function(){return u.modules.lasso.enabled()}},connectNodes:{enable:function(d){return l.modules.connectNodes.enable(d),this},disable:function(){return l.modules.connectNodes.disable(),this},enabled:function(){return l.modules.connectNodes.enabled()}},legend:{enable:function(d){return s.modules.legend.enable(d)},disable:function(){return s.modules.legend.disable()},enabled:function(){return s.modules.legend.enabled()},getOptions:function(){return s.modules.legend.getOptions()}},rectangleSelect:{enable:function(d){a.modules.rectangleSelect.enable(d)},disable:function(){a.modules.rectangleSelect.disable()},enabled:function(){return a.modules.rectangleSelect.enabled()}},resize:{enable:function(d){return o.modules.resizing.enable(d),this},disable:function(){return o.modules.resizing.disable(),this},enabled:function(){return o.modules.resizing.enabled()}},rewire:{enable:function(d){return r.modules.rewiring.enable(d),this},disable:function(){return r.modules.rewiring.disable(),this},enabled:function(){return r.modules.rewiring.enabled()}},snapping:{enable:function(d){return i.modules.snapping.enable(d),this},disable:function(){return i.modules.snapping.disable(),this},enabled:function(){return i.modules.snapping.enabled()}},tooltip:{onNodeHover:function(d,c){n.modules.tooltip.setHandler("hover.node",d,c)},onNodeClick:function(d,c){n.modules.tooltip.setHandler("click.left.node",d,c)},onNodeRightClick:function(d,c){n.modules.tooltip.setHandler("click.right.node",d,c)},onNodeDoubleClick:function(d,c){n.modules.tooltip.setHandler("doubleClick.left.node",d,c)},onEdgeHover:function(d,c){n.modules.tooltip.setHandler("hover.edge",d,c)},onEdgeClick:function(d,c){n.modules.tooltip.setHandler("click.left.edge",d,c)},onEdgeRightClick:function(d,c){n.modules.tooltip.setHandler("click.right.edge",d,c)},onEdgeDoubleClick:function(d,c){n.modules.tooltip.setHandler("doubleClick.left.edge",d,c)},onBackgroundClick:function(d,c){n.modules.tooltip.setHandler("click.left.background",d,c)},onBackgroundRightClick:function(d,c){n.modules.tooltip.setHandler("click.right.background",d,c)},onBackgroundDoubleClick:function(d,c){n.modules.tooltip.setHandler("doubleClick.left.background",d,c)},refresh:function(){return n.modules.tooltip.refresh()},isShown:function(){return n.modules.tooltip.isShown()},hide:function(){n.modules.tooltip.hide()},show:function(d,c){return n.modules.tooltip.show(d,c)}},brand:(t=n=i=r=o=a=s=l=u=e,{set:function(d,c){return t.modules.brand.set(d,c)},remove:function(){t.modules.brand.remove()}})};var t,n,i,r,o,a,s,l,u}(e)},uy);function uy(){}function ly(e){return!0}function dy(e){return""}function wh(e,t,n){return{}}var cy,hy=(wt(Ys,cy=Au),Ys.prototype._computeNodeGroupId=function(e){return this._nodeSelector(e)?this._nodeGroupIdFunction(e):void 0},Ys.prototype._computeEdgeGroupId=function(e){return this._edgeSelector(e)?this._edgeGroupIdFunction(e):void 0},Ys.prototype._addMetaNodes=function(e,t){for(var n=t.getId(),i=e.getNodes(),r=new Map,o=0;o<i.size;++o){var a=i.get(o);if(void 0!==(c=this._computeNodeGroupId(a))){var s=r.get(c);s||r.set(c,s={id:c,nodes:[]}),s.nodes.push(a)}}var l=ws(r),u=l.map(function(g){return e.getNodes(g.nodes)}),d=[];for(o=0;o<l.length;++o){var c=l[o].id,h=u[o],p=this._nodeGenerator(h,c,t);void 0===p.id&&(p.id=py(c,n)),p.position=gc(h.getPosition()),d.push(p)}return e.addNodes(d.map(function(g){return{id:g.id,attributes:g.position}}),{virtual:!0}).then(function(){var g=e.getNodes(d.map(function(E){return E.id}));g.replaceOriginalAttributes(d.map(function(E){return E.attributes}),["x","y"]);for(var m=g.getData(),b=0;b<m.length;b++){var v=m[b],y=d[b];m[b]=void 0===v?y.data:Nt({},v,y.data)}return g.setData(null,m),g.setVisible(!0),e.modules.grouping.setSubElements(g,u),u.forEach(function(E,S){e.modules.grouping.setMetaElement(E,g.get(S))}),g})},Ys.prototype._addMetaEdges=function(e,t){for(var n=t.getId(),i=e.getEdges(),r=new Map,o=e.modules.graphics.getAttributesManager().getUsedEdgeAttributes(),a=0;a<i.size;++a){var s=i.get(a);if(void 0!==(E=this._computeEdgeGroupId(s))){var l=this._edgeSource(s),u=this._edgeTarget(s),d=this._groupEdges?dA(E,l.getId(),u.getId(),this._separateEdgesByDirection):String(s.getId());(y=r.get(d))||r.set(d,y={id:d,source:l,target:u,edges:[]}),y.edges.push(s)}}var p,g,m=ws(r),b=m.map(function(M){return e.getEdges(M.edges)}),v=[];for(a=0;a<m.length;++a){var y,E=(y=m[a]).id,S=b[a],w=this._groupEdges?this._edgeGenerator(S,E,t):(p=o,g=void 0,{data:(g=S.get(0)).getData(),attributes:g.getAttributes(p)});if(null!=w.id&&null!=e.getEdge(w.id))throw Error("The id "+w.id+" returned by the edgeGenerator function is not a unique id.");void 0===w.id&&(w.id=py(E,n)),w.source=y.source.getId(),w.target=y.target.getId(),v.push(w)}return e.addEdges(v.map(function(M){return{id:M.id,source:M.source,target:M.target}}),{virtual:!0}).then(function(){var M=e.getEdges(v.map(function(B){return B.id}));M.replaceOriginalAttributes(v.map(function(B){return B.attributes}));for(var O=M.getData(),F=0;F<O.length;F++){var L=v[F],N=O[F];O[F]=void 0===N?L.data:Nt({},N,L.data)}return M.setData(null,O),M.setVisible(!0),e.modules.grouping.setSubElements(M,b),b.forEach(function(B,X){e.modules.grouping.setMetaElement(B,M.get(X))}),M})},Ys);function Ys(e){var t=cy.call(this,e)||this;return t._nodeSelector=e.nodeSelector,t._nodeGroupIdFunction=e.nodeGroupIdFunction,t._nodeGenerator=e.nodeGenerator,t._edgeSelector=e.edgeSelector,t._edgeGroupIdFunction=e.edgeGroupIdFunction,t._edgeGenerator=e.edgeGenerator,t._edgeSource=e.edgeSource,t._edgeTarget=e.edgeTarget,t._separateEdgesByDirection=e.separateEdgesByDirection,t._groupSelfLoopEdges=e.groupSelfLoopEdges,t._groupEdges=e.groupEdges,t}function dA(e,t,n,i){var r=t,o=n;return!i&&r.toString()>o.toString()&&(r=n,o=t),e+"["+r+"-"+o+"]"}function py(e,t){return"gen_grp_"+t+"_"+e}var fy,cA=(wt(Xs,fy=hy),Xs.prototype.getName=function(){return"node-grouping"},Xs.prototype.run=function(e){var t,n,i,r,o,a=this,s=e.ogma,l=e.duration,u=e.wrapper;return this._addMetaNodes(s,u).then(function(d){return(t=d).setVisible(!1),a._addMetaEdges(s,u)}).then(function(d){(n=d).setVisible(!1),i=t.getSubNodes().reduce(function(h,p){return h.concat(p)},s.createNodeList()),r=n.getSubEdges().reduce(function(h,p){return h.concat(p)},s.createEdgeList());var c=s.getNodes(i.getMetaNode()).getPosition();return o=i.getPosition().map(function(h,p){var g=c[p];return{x:h.x-g.x,y:h.y-g.y}}),i.setAttributes(c,l)}).then(function(){return i.setVisible(!1),r.setVisible(!1),t.setVisible(!0),n.filter(function(d){return a._groupSelfLoopEdges||d.getSource()!==d.getTarget()}).setVisible(!0),{metaNodes:t,metaEdges:n,subNodes:i,subEdges:r,offsets:o}})},Xs.prototype.undo=function(e){var t=this,n=e.ogma,i=e.duration,r=e.context,o=r.metaNodes,a=r.metaEdges,s=r.subNodes,l=r.subEdges,u=r.offsets,d=n.getNodes(s.getMetaNode()).getPosition(),c=d.map(function(h,p){return{x:(g=h).x+(m=u[p]).x,y:g.y+m.y};var g,m});return s.setVisible(!0),l.setVisible(!0),n.modules.grouping.setMetaElement(s,null),n.modules.grouping.setMetaElement(l,null),o.setVisible(!1),a.setVisible(!1),s.setAttributes(d).then(function(){if(t._restorePositions)return s.setAttributes(c,i)})},Xs.prototype.cleanup=function(e){var t=e.ogma,n=e.context,r=n.metaEdges,o=n.metaNodes.filter(function(s){return!s.isVisible()}),a=r.filter(function(s){return!s.isVisible()});return Promise.all([t.removeEdges(a,{virtual:!0}),t.removeNodes(o,{virtual:!0})]).then(function(){return Promise.resolve()})},Xs);function Xs(e){var t=e.selector,i=e.groupIdFunction,o=e.nodeGenerator,s=e.edgeGenerator,u=e.separateEdgesByDirection,c=e.groupSelfLoopEdges,h=void 0!==c&&c,p=e.groupEdges,m=e.restorePositions,b=void 0===m||m,v=fy.call(this,{nodeSelector:void 0===t?ly:t,nodeGroupIdFunction:void 0===i?dy:i,nodeGenerator:void 0===o?wh:o,edgeSelector:function(y){return!(!y.getSource().getMetaNode()&&!y.getTarget().getMetaNode())},edgeGroupIdFunction:function(){return""},edgeGenerator:void 0===s?wh:s,edgeSource:function(y){return gy(y.getSource())},edgeTarget:function(y){return gy(y.getTarget())},separateEdgesByDirection:void 0!==u&&u,groupEdges:void 0===p||p})||this;return v._groupSelfLoopEdges=h,v._restorePositions=b,v}function gy(e){return e.getMetaNode()||e}var _y,hA=(wt(Js,_y=hy),Js.prototype.getName=function(){return"edge-grouping"},Js.prototype.run=function(e){var t,n,i=e.ogma;return this._addMetaEdges(i,e.wrapper).then(function(o){return(n=(t=o).getSubEdges().reduce(function(a,s){return a.concat(s)},i.createEdgeList())).setVisible(!1),{metaEdges:t,subEdges:n}})},Js.prototype.undo=function(e){var t=e.context,n=t.metaEdges;return t.subEdges.setVisible(!0),n.setVisible(!1),Promise.resolve()},Js.prototype.cleanup=function(e){return e.ogma.removeEdges(e.context.metaEdges.filter(function(i){return!i.isVisible()}),{virtual:!0})},Js);function Js(e){var t=e.selector,i=e.groupIdFunction,o=e.generator,s=e.separateEdgesByDirection;return _y.call(this,{nodeSelector:null,nodeGroupIdFunction:null,nodeGenerator:null,edgeSelector:void 0===t?ly:t,edgeGroupIdFunction:void 0===i?dy:i,edgeGenerator:void 0===o?wh:o,edgeSource:function(u){return u.getSource()},edgeTarget:function(u){return u.getTarget()},separateEdgesByDirection:void 0!==s&&s,groupEdges:!0})||this}var my,pA=(wt(Qs,my=Au),Qs.prototype.getName=function(){return wo.NeighborGeneration},Qs.prototype.run=function(e){for(var t,n=this,i=e.ogma,r=e.duration,o=e.wrapper.getId(),a=i.getNodes(),s=new Map,l=0;l<a.size;++l){var u=a.get(l),d=(t=this._generateIds(u),Array.isArray(t)?t:t?[t]:null);if(d)for(var c=0;c<d.length;++c){var h=d[c];(y=s.get(h))||s.set(h,y=[]),y.push(u)}}var p,g,m=new Array(s.size),b=il(s),v=ws(s).map(function(w){return i.getNodes(w)});for(l=0;l<m.length;++l){var y=v[l],E=this._nodeGenerator(h=b[l],y);E.id="_gen_"+o+"_"+h;var S=gc(y.getPosition());E.attributes=E.attributes||{},E.attributes.x=S.x,E.attributes.y=S.y,m[l]=E}return i.addNodes(m.map(function(w){return{id:w.id,attributes:w.attributes}}),{virtual:!0}).then(function(w){(p=w).replaceOriginalAttributes(m.map(function(J){return J.attributes}),["x","y"]),p.setData(null,m.map(function(J){return J.data}));for(var M=[],O=0;O<w.size;++O)for(var F=w.get(O),L=v[O],N=0;N<L.size;++N){var B=L.get(N),X=n._edgeGenerator(B,F);X.source||X.target||(X.source=B.getId(),X.target=F.getId()),M.push(X)}return i.addEdges(M,{virtual:!0})}).then(function(w){return g=w,p.setVisible(!0),g.setVisible(!0),p.addClass(ai),g.addClass(ai),Promise.all([p.removeClass(ai,r),g.removeClass(ai,r)])}).then(function(){return{virtualNodes:p,virtualEdges:g}})},Qs.prototype.undo=function(e){var t=e.context,n=e.duration,i=t.virtualNodes,r=t.virtualEdges;return Promise.all([i.addClass(ai,n),r.addClass(ai,n)]).then(function(){i.setVisible(!1),r.setVisible(!1)})},Qs.prototype.cleanup=function(e){var t=e.ogma,n=e.context,i=n.virtualEdges,r=n.virtualNodes.filter(function(a){return!a.isVisible()}),o=i.filter(function(a){return!a.isVisible()});return t.removeNodes(r,{virtual:!0}),t.removeEdges(o,{virtual:!0}),Promise.resolve()},Qs);function Qs(e){var t=my.call(this)||this,n=e.selector,i=void 0===n?function(){return!0}:n,r=e.neighborIdFunction,o=void 0===r?function(){return null}:r,a=e.nodeGenerator,s=void 0===a?function(){return{}}:a,l=e.edgeGenerator,u=void 0===l?function(){return{source:null,target:null}}:l;return t._generateIds=function(d){return i(d)&&o(d)},t._nodeGenerator=s,t._edgeGenerator=u,t}var vy,fA=(wt(zu,vy=Au),zu.prototype.run=function(e){for(var t=e.ogma,n=e.duration,i=t.getNodes().filter(this._selector),r=[],o=new Map,a=0;a<i.size;++a)for(var s=i.get(a),l=s.getAdjacentEdges(),u=this._dataFunction(s),d=0;d<l.size;++d){var c=l.get(d),h=c.getSource(),p=c.getTarget();if(h!==p&&void 0!==u){var g=h===s?p:h,m=o.get(g);m||o.set(g,m=[]),m.push(u)}r.push(c)}var b=t.getEdges(r),v=t.getNodes(il(o)),y=ws(o),E=v.getData(),S=new Array(v.size);for(a=0;a<S.length;++a){var w=y[a],M=E[a];for(d=0;d<w.length;++d)M=ir(M,w[d]);S[a]=M}return Promise.all([i.addClass(ai,n),b.addClass(ai,n)]).then(function(){return i.setVisible(!1),b.setVisible(!1),v.setData(S),{hiddenNodes:i,hiddenEdges:b,nodesWithDataChange:v,oldDataList:E}})},zu.prototype.getName=function(){return wo.NeighborMerging},zu.prototype.undo=function(e){var t=e.duration,n=e.context,i=n.hiddenNodes,r=n.hiddenEdges,o=n.nodesWithDataChange,a=n.oldDataList;return i.setVisible(!0),r.setVisible(!0),i.addClass(ai),r.addClass(ai),Promise.all([i.removeClass(ai,t),r.removeClass(ai,t)]).then(function(){o.setData(a)})},zu);function zu(e){var t=e.selector,n=void 0===t?function(){return!1}:t,i=e.dataFunction,r=void 0===i?function(){}:i,o=vy.call(this)||this;return o._selector=n,o._dataFunction=r,o}function gA(e,t){return e.size===t.size&&0<e.filter(function(n){return t.includes(n)}).size}var yy,_A=(wt(Ks,yy=Au),Ks.prototype.getName=function(){return wo.NodeCollapsing},Ks.prototype.run=function(e){for(var t=this,n=e.ogma,i=e.duration,r=n.getNodes().filter(this._selector),o=r.getAdjacentEdges(),a=[],s=r.map(function(M){return M.getAdjacentNodes().filter(function(O){return!t._selector(O)})}),l=0;l<r.size;l++)for(var u=l;u<r.size;u++){var d=r.get(l),c=r.get(u);if(0<n.modules.graph.getEdgesBetweenTwoNodes(d,c).size&&(s[l].size||s[u].size)&&!gA(s[l],s[u]))throw Error("addNodeCollapsing: invalid connected nodes ["+d.getId()+"] and ["+c.getId()+"] to be collapsed. The addNodeCollapsing function supports only disconnected nodes.")}for(l=0;l<r.size;++l){var h=r.get(l),p=s[l];for(u=0;u<p.size-1;++u){var g=p.get(u),m=n.modules.graph.getEdgesBetweenTwoNodes(h,g);if(g!==h)for(var b=u+1;b<p.size;++b){var v=p.get(b),y=n.modules.graph.getEdgesBetweenTwoNodes(h,v),E=this._edgeGenerator(h,g,v,m,y);if(E)for(var S=f(E),w=0;w<S.length;++w)a.push(mA(n,S[w],w,h,g,v,m,y))}}}return n.addEdges(a,{virtual:!0}).then(function(M){return M.addClass(ai)}).then(function(M){return Promise.all([M.removeClass(ai,i),r.addClass(ai,i),o.addClass(ai,i)])}).then(function(M){var O=M[0];return r.setVisible(!1),o.setVisible(!1),{virtualEdges:O,hiddenNodes:r,hiddenEdges:o}})},Ks.prototype.undo=function(e){var t=e.duration,n=e.context,i=n.virtualEdges,r=n.hiddenNodes,o=n.hiddenEdges;return r.setVisible(!0),o.setVisible(!0),Promise.all([r.addClass(ai),o.addClass(ai)]).then(function(){return Promise.all([r.removeClass(ai,t),o.removeClass(ai,t),i.addClass(ai,t)])}).then(function(){i.setVisible(!1)})},Ks.prototype.cleanup=function(e){return e.ogma.removeEdges(e.context.virtualEdges.filter(function(i){return!i.isVisible()}),{virtual:!0})},Ks);function Ks(e){var t=e.selector,n=void 0===t?function(){return!1}:t,i=e.edgeGenerator,r=void 0===i?function(){return{}}:i,o=yy.call(this)||this;return o._selector=n,o._edgeGenerator=r,o}function mA(e,t,n,i,r,o,a,s){var l=null,u=null;if(void 0!==t.source&&(l=e.getNode(t.source))!==r&&l!==o)throw new Error(["addNodeCollapsing: edge generator produced RawEdge with invalid source ["+t.source+"]","expected to be ["+r.getId()+"] or ["+o.getId()+"]"].join("; "));if(void 0!==t.target&&(u=e.getNode(t.target))!==r&&u!==o)throw new Error(["addNodeCollapsing: edge generator produced RawEdge with invalid target ["+t.target+"]","expected to be ["+r.getId()+"] or ["+o.getId()+"]"].join("; "));if(l&&u&&l===u)throw new Error("addNodeCollapsing: edge generator produced RawEdge with same source and target ["+l.getId()+"]");if(l&&!u)u=l===r?o:r;else if(u&&!l)l=u===r?o:r;else if(!l&&!u){for(var d=!0,c=0;c<a.size;++c)a.get(c).getSource()===r&&(d=!1);for(c=0;c<s.size;++c)s.get(c).getTarget()===o&&(d=!1);u=d?(l=o,r):(l=r,o)}return Nt({},t,{id:"_gen_"+i.getId()+"_"+l.getId()+"_"+u.getId()+"_"+n,source:l.getId(),target:u.getId()})}var xy,vA=(wt(Bu,xy=Au),Bu.prototype.getName=function(){return wo.VirtualProperties},Bu.prototype.run=function(e){var t=e.ogma,n={nodes:null,oldNodesData:null,edges:null,oldEdgesData:null};return this._nodeDataFunction&&(n.nodes=t.getNodes().filter(this._nodeSelector),n.oldNodesData=by(n.nodes,this._nodeDataFunction)),this._edgeDataFunction&&(n.edges=t.getEdges().filter(this._edgeSelector),n.oldEdgesData=by(n.edges,this._edgeDataFunction)),Promise.resolve(n)},Bu.prototype.undo=function(e){var t=e.context,n=t.nodes,r=t.edges,o=t.oldEdgesData;return n&&n.setData(t.oldNodesData),r&&r.setData(o),Promise.resolve()},Bu);function Bu(e){var t=e.nodeSelector,n=void 0===t?function(){return!0}:t,i=e.edgeSelector,r=void 0===i?function(){return!0}:i,o=e.nodeDataFunction,a=void 0===o?null:o,s=e.edgeDataFunction,l=void 0===s?null:s,u=xy.call(this)||this;return u._nodeSelector=n,u._edgeSelector=r,u._nodeDataFunction=a,u._edgeDataFunction=l,u}function by(e,t){for(var n=[],i=0;i<e.size;++i){var r=e.get(i),o=r.getData(),a=ir(o,t(r));n.push(o),r.setData(a)}return n}var Ey=(ka.initNamespace=function(e){e.transformations=function(e){return Nt({},{getList:function(){return a.modules.transformations.getList()},clear:function(){return a.modules.transformations.clear()},afterNextUpdate:function(){return a.modules.transformations.whenApplied()}},{addNodeGrouping:function(s){return void 0===s&&(s={}),o.modules.transformations.add(new cA(s),{duration:s.duration,enabled:s.enabled})},addEdgeGrouping:function(s){return void 0===s&&(s={}),o.modules.transformations.add(new hA(s),{duration:s.duration,enabled:s.enabled})}},{addNodeFilter:function(s){return r.modules.filters.addNodeFilter(s)},addEdgeFilter:function(s){return r.modules.filters.addEdgeFilter(s)}},{addNeighborGeneration:function(s){return i.modules.transformations.add(new pA(s),{duration:s.duration,enabled:s.enabled})},addNeighborMerging:function(s){return i.modules.transformations.add(new fA(s),{duration:s.duration,enabled:s.enabled})}},{addNodeCollapsing:function(s){return void 0===s&&(s={}),n.modules.transformations.add(new _A(s),{duration:s.duration,enabled:s.enabled})}},(t=n=i=r=o=a=e,{addVirtualProperties:function(s){return t.modules.transformations.add(new vA(s),{duration:s.duration,enabled:s.enabled})}}));var t,n,i,r,o,a}(e)},ka.prototype.addNodeFilter=function(e){return this.modules.filters.addNodeFilter(e)},ka.prototype.addEdgeFilter=function(e){return this.modules.filters.addEdgeFilter(e)},ka.prototype.getNodeFilters=function(){return this.modules.transformations.getList().filter(function(e){return e.getName()===wo.NodeFilter})},ka.prototype.getEdgeFilters=function(){return this.modules.transformations.getList().filter(function(e){return e.getName()===wo.EdgeFilter})},ka.prototype.clearNodeFilters=function(){return Promise.all(this.getNodeFilters().map(function(e){return e.destroy()})).then(function(){return Promise.resolve()})},ka.prototype.clearEdgeFilters=function(){return Promise.all(this.getEdgeFilters().map(function(e){return e.destroy()})).then(function(){return Promise.resolve()})},ka);function ka(){}var Sy=(Ay.initNamespace=function(e){var t,n,i,r,o,a;e.view=(n=(t=e.modules).camera,i=t.captor,r=t.dom,o=t.graphics,a=t.locate,{setZoom:function(s,l){return n.setZoom(s,l)},zoomIn:function(s,l){return n.zoomIn(s,l)},zoomOut:function(s,l){return n.zoomOut(s,l)},getZoom:function(){return n.getZoom()},setCenter:function(s,l){return n.setCenter(s,l)},move:function(s,l){return n.move(s,l)},getCenter:function(){return n.getCenter()},setAngle:function(s,l){return n.setAngle(s,l)},rotate:function(s,l){return n.rotate(s,l)},getAngle:function(){return n.getAngle()},set:function(s,l){return n.setView(s,l)},get:function(){return n.getView()},graphToScreenCoordinates:function(s){return n.graphToScreenCoordinates(s)},screenToGraphCoordinates:function(s){return n.screenToGraphCoordinates(s)},getImageData:function(){return o.getImageData()},getElementAt:function(s){return i.getElementAt(s)},beforeNextFrame:function(){return r.beforeNextFrame()},afterNextFrame:function(){return r.afterNextFrame()},setFullScreen:function(s){return r.setFullScreen(s)},isFullScreen:function(){return r.isFullScreen()},forceResize:function(){return r.forceResize()},getSize:function(){return r.getDimensions()},setSize:function(s){if(!s||isNaN(s.width)||isNaN(s.height))throw new Error("Size must follow the format { width: number, height: number }");if(s.width<0)throw new Error("width must be positive");if(s.height<0)throw new Error("height must be positive");return r.setDimensions(s),Promise.resolve()},locateGraph:function(s){return a.locateGraph(s)},locateRawGraph:function(s,l){return a.locateRawGraph(s,l)},getGraphBoundingBox:function(){return a.getGraphBoundingBox()}})},Ay);function Ay(){}function wy(e){return--e*e*e+1}function Cy(e,t,n){var i=e-n[0],r=t-n[1];return i*i+r*r}var xA=Object.freeze({__proto__:null,circleCircleIntersection:sc,circleSortCompare:uc,circleContainsPoint:Yf,circleContainsCircle:Xf,circleIntersectsBox:lc,circleLineIntersection:Jf,isPointInLine:pf,twoSegmentsIntersect:function(e,t,n,i,r){if(void 0===r&&(r=!1),r&&(fl(e,n)||fl(e,i)||fl(t,n)||fl(t,i)))return!1;var o=(e.y-n.y)*(i.x-n.x)-(e.x-n.x)*(i.y-n.y),a=(t.x-e.x)*(i.y-n.y)-(t.y-e.y)*(i.x-n.x);if(0==a)return!1;var s=o/a,l=(o=(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y))/a;return!(s<=0||1<=s||l<=0||1<=l)},lineAngle:Ms,angle:function(e,t,n){var i=Ms(e.x,e.y,t.x,t.y)-Ms(n.x,n.y,t.x,t.y);return i<0?i+2*Math.PI:i},lineIntersection:function(e,t,n,i,r,o,a,s){var l=(s-o)*(n-e)-(a-r)*(i-t);if(0==l)return null;var u=t-o;return{x:e+(u=((a-r)*u-(s-o)*(e-r))/l)*(n-e),y:t+u*(i-t)}},segmentIntersection:mu,segmentRectangleIntersection:ff,lineLine:Is,lineAABB:Xd,distancePointSegment:gf,distToSegmentSquared:Jd,getClosestPointOnSegment:_f,getClosestPointOnLine:function(e,t,n,i,r,o){var a=r-n,s=o-i,l=((e-n)*a+(t-i)*s)/(a*a+s*s);return{x:n+a*l,y:i+s*l}},defaultAABB:af,rotate:Gd,move:function(e,t,n,i){return void 0===n&&(n=0),void 0===i&&(i={x:0,y:0}),i.x=e.x+n*Math.sin(t),i.y=e.y+n*Math.cos(t),i},distance:yi,squaredDistance:ul,radiansToDegrees:sf,degreesToRadians:function(e){return e*Math.PI/180},extendBounds:function(e,t){return e.minX-=t,e.minY-=t,e.maxX+=t,e.maxY+=t,e.width+=2*t,e.height+=2*t,e},isPointInPolygon:bu,polygonsIntersect:fc,computeCentroid:gc,getPointOnQuadraticCurve:Qd,isPointOnQuadraticCurve:xf,getPointOnBezierCurve:vu,isPointOnBezierCurve:bf,getQuadraticCurveBoundingBox:Kd,getBezierCurveBoundingBox:gl,quadBezierAABB:vf,cubicBezierAABB:yf,getSelfLoopControlPoints:Ya,getQuadraticCurveControlPoint:pa,getAABB:Wl,getOBBPoints:zs,moveAABB:Lc,padBounds:function(e,t){return e.minX-=t,e.minY-=t,e.maxX+=t,e.maxY+=t,e.width+=2*t,e.height+=2*t,e},overlapsAABB:function(e,t){return Go(e[0],e[1],e[2],e[3],t[0],t[1],t[2],t[3])},intersects:T_,overlaps:Go}),bA=Object.freeze({__proto__:null,minHeap:kc,bellmanFord:Kc,dijkstra:Hl,johnson:$c,largestEmptyCircle:Sv,minDisk:xv,removeRadialOverlap:eh,convexhull:rh,circlePack:function(e){var t=e.X,n=e.Y,i=e.R,r=e.center,o=e.maxSteps,a=void 0===o?1e3:o,s=e.padding,l=void 0===s?5:s,u=e.epsilon,d=void 0===u?1e-5:u,c=e.damping,h=void 0===c?2:c,p=e.pinned,g=e.indexes,m=e.onUpdate,b=e.pushSmallerOut,v=void 0===b||b,y=g?g.length:t.length,E=g;if(isFinite(p)||(p=-1),void 0===E){E=new Uint32Array(y);for(var S=0;S<y;S++)E[S]=S}else E=g;if(-1!==p)r=[t[p],n[p]];else if(!r){var w=0,M=0;for(S=0;S<y;S++)w+=t[E[S]],M+=n[E[S]];r=[w/y,M/y]}var O=function(ae,ie){for(var U=1/0,Y=-1/0,he=0;he<ae.length;he++){var pe=ae[he],we=ie?ie[pe]:pe;U=Math.min(we,U),Y=Math.max(we,Y)}return{min:U,max:Y}}(E,i),F=O.min,L=O.max;function N(ae,ie){for(var U=0,Y=0;Y<y-1;Y++)for(var he=Y+1;he<y;he++)if(Y!==he){var pe=E[Y],we=E[he],st=i[pe],It=i[we],Ge=t[we]-t[pe],He=n[we]-n[pe],Pe=Ge*Ge+He*He;if(Pe<(Ke=st+It+l)*Ke-ae){var We=(Ke-Math.sqrt(Pe))*ie,Qe=1/Pe,nt=(ht=Ge*Qe*We)*ht+(Wt=He*Qe*We)*Wt;we!==p&&(U+=nt*(sn=st/F),t[we]+=ht*sn,n[we]+=Wt*sn),pe!==p&&(U+=nt*(sn=It/F),t[pe]-=ht*sn,n[pe]-=Wt*sn)}}var Me=ae*h*(1-ie),ze=r[0],qe=r[1];for(Y=0;Y<y;Y++)if((pe=E[Y])!==p){var Ke,ht,Wt,sn=(Ke=i[pe])/L,pn=v?Me*sn:Me;U+=nt=(ht=(t[pe]-ze)*pn)*ht+(Wt=(n[pe]-qe)*pn)*Wt,t[pe]-=ht,n[pe]-=Wt}return U}E.sort(function(ae,ie){return i[ie]*Cy(t[ie],n[ie],r)-i[ae]*Cy(t[ae],n[ae],r)});var B=0,X=0,J=wy(1/y);for(S=0;S<a&&(B=N(J,wy((S+1)/a)),m&&setTimeout(function(){return m(t,n)}),!(Math.abs(B-X)<d));S++)X=B;return{X:t,Y:n}},Quadtree:k_,weightedStress:_v,distanceStress:mv,constrainedStress:th,stressMinimizationStep:nh,stressMinimizationStepGeneral:function(e,t,n,i,r,o,a,s){a=a||0;var l,u=t,d=n;-1===(r=void 0===r?-1:r)&&(a=0);for(var c=0;c<i;c++){for(var h=s[c],p=0,g=0,m=0,b=t[h],v=n[h],y=0;y<i;y++){var E=s[y],S=void 0;if(E!==h){var w=0,M=e[h][E]*o,O=1/(M*M);h!==r&&E!==r||(w=O);var F=(1-a)*O+a*w;if(p+=F,0!=O){var L=t[E],N=n[E],B=b-L,X=v-N,J=B*B+X*X;1e-6<J&&(S=1/Math.sqrt(J)),g+=F*(L+M*(b-L)*S),m+=F*(N+M*(v-N)*S)}}}0!==(l=p)&&(u[h]=g/l,d[h]=m/l)}return{x:u,y:d}},detectCyclesUndirected:function(e,t,n,i){void 0===i&&(i=!1);for(var r,o,a,s,l=new Int32Array(e.length),u={},d=0;d<e.length;d++)l[d]=-1,u[e[d]]=d;for(d=0;d<t.length;d++){var c=u[t[d]],h=u[n[d]];if(i&&c===h)return!0;var p=wu(l,c),g=wu(l,h);if(p===g)return!0;o=g,a=wu(r=l,p),s=wu(r,o),r[a]=s}return!1},detectCyclesDirected:Jg,detectCyclesUndirectedDFS:function(e,t,n){for(var i=e.length,r=new Uint8Array(i),o=new Int32Array(i),a={},s=0;s<i;s++)o[a[e[s]]=s]=-1;var l=wc(e,t,n,a,!0);for(s=0;s<t.length;s++){var u=a[t[s]],d=a[n[s]];l[u]=l[u]||[],l[u].push(d)}for(s=0;s<i;s++)if(!r[s]&&Qg(s,r,-1,o,l,[],e))return!0;return!1},CyclesFinder:Kg}),EA=1,Ty=function(){function e(t){void 0===t&&(t={});var n=this;if(this.node=function(i){return new mo(i,n)},this.edge=function(i){return new na(i,n)},this.nodeList=function(i){return new ar(i||new Uint32Array(0),n)},this.edgeList=function(i){return new vs(i||new Uint32Array(0),n)},this._onReady=[],null==this||this.constructor!==e)return new e(t);this._init(t)}return e.prototype._init=function(t){var n=this;this._initParameters=t,this._debug=!!t.debug,this._token=EA++,this.modules=new pE(this,t),iy.initNamespace(this),vm.initNamespace(this),Pm.initNamespace(this),pv.initNamespace(this),Wm.initNamespace(this),Xv.initNamespace(this),hv.initNamespace(this),Ey.initNamespace(this),sy.initNamespace(this),Sy.initNamespace(this),Qv.initNamespace(this),Em.initNamespace(this),oy.initNamespace(this),ty.initNamespace(this),Xm.initNamespace(this),$v.initNamespace(this),xm.initNamespace(this),this._onReady.forEach(function(i){return i(n)}),this.safelyBindToInstance()},e.prototype.safelyBindToInstance=function(){for(var t=0,n=Object.keys(e.prototype);t<n.length;t++){var i=n[t];"function"==typeof e.prototype[i]&&(this[i]=this[i].bind(this))}},e.prototype.onReady=function(t){this._onReady.push(t)},e.prototype._destroy=function(){if(!this._token)throw new Error('"destroy" called twice on the same instance of Ogma');this._onReady=[],this.modules.destroy(),this.modules=null},e.prototype.destroy=function(){this._destroy()},e.prototype.reset=function(){var t=this._initParameters;this._destroy(),this._init(t)},e.prototype.isDebug=function(){return this._debug},e.libraries=Jn,e.build={version:"2.9.3",commit:"673d5e4",date:"Wed Jan 08 2020 19:06:20 GMT+0100 (Central European Standard Time)"},e.geometry=xA,e.algorithms=bA,e.utils=d0,e}();return Object.assign.apply(Object,[Ty.prototype].concat([vm,fE,gE,xm,_E,Em,Pm,Wm,Xm,$E,eS,hv,pv,Xv,$v,sA,uA,iy,sy,Ey,Sy,Qv,oy,ty].map(function(e){return e.prototype}))),Ty}()}}]);