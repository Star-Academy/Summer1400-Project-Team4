(self.webpackChunketl=self.webpackChunketl||[]).push([[534],{4299:Yr=>{Yr.exports=function(sn,St,st,mn){var dr=new Blob(void 0!==mn?[mn,sn]:[sn],{type:st||"application/octet-stream"});if(void 0!==window.navigator.msSaveBlob)window.navigator.msSaveBlob(dr,St);else{var xr=window.URL&&window.URL.createObjectURL?window.URL.createObjectURL(dr):window.webkitURL.createObjectURL(dr),Zi=document.createElement("a");Zi.style.display="none",Zi.href=xr,Zi.setAttribute("download",St),void 0===Zi.download&&Zi.setAttribute("target","_blank"),document.body.appendChild(Zi),Zi.click(),setTimeout(function(){document.body.removeChild(Zi),window.URL.revokeObjectURL(xr)},200)}}},70:()=>{!function(){"use strict";var sn,St,st,mn,er,dr,xr,Zi,cr,To,hr,Mo,Di,si="leader-line",lo={top:1,right:2,bottom:3,left:4},Io={straight:1,arc:2,fluid:3,magnet:4,grid:5},Yn="behind",br={disc:{elmId:"leader-line-disc",noRotate:!0,bBox:{left:-5,top:-5,width:10,height:10,right:5,bottom:5},widthR:2.5,heightR:2.5,bCircle:5,sideLen:5,backLen:5,overhead:0,outlineBase:1,outlineMax:4},square:{elmId:"leader-line-square",noRotate:!0,bBox:{left:-5,top:-5,width:10,height:10,right:5,bottom:5},widthR:2.5,heightR:2.5,bCircle:5,sideLen:5,backLen:5,overhead:0,outlineBase:1,outlineMax:4},arrow1:{elmId:"leader-line-arrow1",bBox:{left:-8,top:-8,width:16,height:16,right:8,bottom:8},widthR:4,heightR:4,bCircle:8,sideLen:8,backLen:8,overhead:8,outlineBase:2,outlineMax:1.5},arrow2:{elmId:"leader-line-arrow2",bBox:{left:-7,top:-8,width:11,height:16,right:4,bottom:8},widthR:2.75,heightR:4,bCircle:8,sideLen:8,backLen:7,overhead:4,outlineBase:1,outlineMax:1.75},arrow3:{elmId:"leader-line-arrow3",bBox:{left:-4,top:-5,width:12,height:10,right:8,bottom:5},widthR:3,heightR:2.5,bCircle:8,sideLen:5,backLen:4,overhead:8,outlineBase:1,outlineMax:2.5},hand:{elmId:"leader-line-hand",bBox:{left:-3,top:-12,width:40,height:24,right:37,bottom:12},widthR:10,heightR:6,bCircle:37,sideLen:12,backLen:3,overhead:37},crosshair:{elmId:"leader-line-crosshair",noRotate:!0,bBox:{left:-96,top:-96,width:192,height:192,right:96,bottom:96},widthR:48,heightR:48,bCircle:96,sideLen:96,backLen:96,overhead:0}},Ko={behind:Yn,disc:"disc",square:"square",arrow1:"arrow1",arrow2:"arrow2",arrow3:"arrow3",hand:"hand",crosshair:"crosshair"},xi={disc:"disc",square:"square",arrow1:"arrow1",arrow2:"arrow2",arrow3:"arrow3",hand:"hand",crosshair:"crosshair"},Xr=[1,2,3,4],pr="auto",ui={x:"left",y:"top",width:"width",height:"height"},Jr=.5522847,Qr=.25*Math.PI,Ra=/^\s*(\-?[\d\.]+)\s*(\%)?\s*$/,ft="http://www.w3.org/2000/svg",rn="-ms-scroll-limit"in document.documentElement.style&&"-ms-ime-align"in document.documentElement.style&&!window.navigator.msPointerEnabled,Ht=!rn&&!!document.uniqueID,xn="MozAppearance"in document.documentElement.style,Zt=!(rn||xn||!window.chrome||!window.CSS),bn=!(rn||Ht||xn||Zt||window.chrome||!("WebkitAppearance"in document.documentElement.style)),bi=Ht||rn?.2:.1,Xn={path:3,lineColor:"coral",lineSize:4,plugSE:[Yn,"arrow1"],plugSizeSE:[1,1],lineOutlineEnabled:!1,lineOutlineColor:"indianred",lineOutlineSize:.25,plugOutlineEnabledSE:[!1,!1],plugOutlineSizeSE:[1,1]},qi=(hr={}.toString,Di=(Mo={}.hasOwnProperty.toString).call(Object),function(_){var w,T;return _&&"[object Object]"===hr.call(_)&&(!(w=Object.getPrototypeOf(_))||(T=w.hasOwnProperty("constructor")&&w.constructor)&&"function"==typeof T&&Mo.call(T)===Di)}),on=Number.isFinite||function(_){return"number"==typeof _&&window.isFinite(_)},Jt=function(){var _,w={ease:[.25,.1,.25,1],linear:[0,0,1,1],"ease-in":[.42,0,1,1],"ease-out":[0,0,.58,1],"ease-in-out":[.42,0,.58,1]},T=1e3/60/2,k=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function($){setTimeout($,T)},R=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame||function($){clearTimeout($)},V=Number.isFinite||function($){return"number"==typeof $&&window.isFinite($)},le=[],te=0;function re(){var $=Date.now(),me=!1;_&&(R.call(window,_),_=null),le.forEach(function(G){var J,K,se;if(G.framesStart){if((J=$-G.framesStart)>=G.duration&&G.count&&G.loopsLeft<=1)return se=G.frames[G.lastFrame=G.reverse?0:G.frames.length-1],G.frameCallback(se.value,!0,se.timeRatio,se.outputRatio),void(G.framesStart=null);if(J>G.duration){if(K=Math.floor(J/G.duration),G.count){if(K>=G.loopsLeft)return se=G.frames[G.lastFrame=G.reverse?0:G.frames.length-1],G.frameCallback(se.value,!0,se.timeRatio,se.outputRatio),void(G.framesStart=null);G.loopsLeft-=K}G.framesStart+=G.duration*K,J=$-G.framesStart}G.reverse&&(J=G.duration-J),se=G.frames[G.lastFrame=Math.round(J/T)],!1!==G.frameCallback(se.value,!1,se.timeRatio,se.outputRatio)?me=!0:G.framesStart=null}}),me&&(_=k.call(window,re))}function j($,me){$.framesStart=Date.now(),null!=me&&($.framesStart-=$.duration*($.reverse?1-me:me)),$.loopsLeft=$.count,$.lastFrame=null,re()}return{add:function($,me,G,J,K,se,fe){var be,ke,Ae,pe,ne,ue,oe,ot,dt,et,q,ye,x,D=++te;function E(M,I){return{value:$(I),timeRatio:M,outputRatio:I}}if("string"==typeof K&&(K=w[K]),$=$||function(){},G<T)ke=[E(0,0),E(1,1)];else{if(Ae=T/G,ke=[E(0,0)],0===K[0]&&0===K[1]&&1===K[2]&&1===K[3])for(ne=Ae;ne<=1;ne+=Ae)ke.push(E(ne,ne));else for(ue=pe=(ne=Ae)/10;ue<=1;ue+=pe)et=(dt=(ot=ue)*ot)*ot,x=3*(q=1-ot)*dt,ne<=(oe={x:(ye=q*q*3*ot)*K[0]+x*K[2]+et,y:ye*K[1]+x*K[3]+et}).x&&(ke.push(E(oe.x,oe.y)),ne+=Ae);ke.push(E(1,1))}return le.push(be={animId:D,frameCallback:me,duration:G,count:J,frames:ke,reverse:!!se}),!1!==fe&&j(be,fe),D},remove:function($){var me;le.some(function(G,J){return G.animId===$&&(me=J,!(G.framesStart=null))})&&le.splice(me,1)},start:function($,me,G){le.some(function(J){return J.animId===$&&(J.reverse=!!me,j(J,G),!0)})},stop:function($,me){var G;return le.some(function(J){return J.animId===$&&(me?null!=J.lastFrame&&(G=J.frames[J.lastFrame].timeRatio):(G=(Date.now()-J.framesStart)/J.duration,J.reverse&&(G=1-G),G<0?G=0:1<G&&(G=1)),!(J.framesStart=null))}),G},validTiming:function($){return"string"==typeof $?w[$]:Array.isArray($)&&[0,1,2,3].every(function(me){return V($[me])&&0<=$[me]&&$[me]<=1})?[$[0],$[1],$[2],$[3]]:null}}}(),za=function(_){var w={};function T(k){if(w[k])return w[k].exports;var R=w[k]={i:k,l:!1,exports:{}};return _[k].call(R.exports,R,R.exports,T),R.l=!0,R.exports}return T.m=_,T.c=w,T.d=function(k,R,V){T.o(k,R)||Object.defineProperty(k,R,{configurable:!1,enumerable:!0,get:V})},T.r=function(k){Object.defineProperty(k,"__esModule",{value:!0})},T.n=function(k){var R=k&&k.__esModule?function(){return k.default}:function(){return k};return T.d(R,"a",R),R},T.o=function(k,R){return Object.prototype.hasOwnProperty.call(k,R)},T.p="",T(T.s=0)}([function(_,w,T){T.r(w);var R=[],V=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(G){return setTimeout(G,1e3/60)},le=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame||function(G){return clearTimeout(G)},te=void 0,re=Date.now();function j(){var G=void 0,J=void 0;te&&(le.call(window,te),te=null),R.forEach(function(K){K.event&&(K.listener(K.event),K.event=null,G=!0)}),G?(re=Date.now(),J=!0):Date.now()-re<500&&(J=!0),J&&(te=V.call(window,j))}function $(G){var J=-1;return R.some(function(K,se){return K.listener===G&&(J=se,!0)}),J}w.default={add:function(G){var J=void 0;return-1===$(G)?(R.push(J={listener:G}),function(K){J.event=K,te||j()}):null},remove:function(G){var J;-1<(J=$(G))&&(R.splice(J,1),!R.length&&te&&(le.call(window,te),te=null))}}}]).default,ko={line_altColor:{iniValue:!1},line_color:{},line_colorTra:{iniValue:!1},line_strokeWidth:{},plug_enabled:{iniValue:!1},plug_enabledSE:{hasSE:!0,iniValue:!1},plug_plugSE:{hasSE:!0,iniValue:Yn},plug_colorSE:{hasSE:!0},plug_colorTraSE:{hasSE:!0,iniValue:!1},plug_markerWidthSE:{hasSE:!0},plug_markerHeightSE:{hasSE:!0},lineOutline_enabled:{iniValue:!1},lineOutline_color:{},lineOutline_colorTra:{iniValue:!1},lineOutline_strokeWidth:{},lineOutline_inStrokeWidth:{},plugOutline_enabledSE:{hasSE:!0,iniValue:!1},plugOutline_plugSE:{hasSE:!0,iniValue:Yn},plugOutline_colorSE:{hasSE:!0},plugOutline_colorTraSE:{hasSE:!0,iniValue:!1},plugOutline_strokeWidthSE:{hasSE:!0},plugOutline_inStrokeWidthSE:{hasSE:!0},position_socketXYSE:{hasSE:!0,hasProps:!0},position_plugOverheadSE:{hasSE:!0},position_path:{},position_lineStrokeWidth:{},position_socketGravitySE:{hasSE:!0},path_pathData:{},path_edge:{hasProps:!0},viewBox_bBox:{hasProps:!0},viewBox_plugBCircleSE:{hasSE:!0},lineMask_enabled:{iniValue:!1},lineMask_outlineMode:{iniValue:!1},lineMask_x:{},lineMask_y:{},lineOutlineMask_x:{},lineOutlineMask_y:{},maskBGRect_x:{},maskBGRect_y:{},capsMaskAnchor_enabledSE:{hasSE:!0,iniValue:!1},capsMaskAnchor_pathDataSE:{hasSE:!0},capsMaskAnchor_strokeWidthSE:{hasSE:!0},capsMaskMarker_enabled:{iniValue:!1},capsMaskMarker_enabledSE:{hasSE:!0,iniValue:!1},capsMaskMarker_plugSE:{hasSE:!0,iniValue:Yn},capsMaskMarker_markerWidthSE:{hasSE:!0},capsMaskMarker_markerHeightSE:{hasSE:!0},caps_enabled:{iniValue:!1},attach_plugSideLenSE:{hasSE:!0},attach_plugBackLenSE:{hasSE:!0}},fs={show_on:{},show_effect:{},show_animOptions:{},show_animId:{},show_inAnim:{}},gs="fade",Oo=[],li={},Ba=0,Zn={},Va=0;function Dr(_,w){var T,k;return typeof _!=typeof w||(T=qi(_)?"obj":Array.isArray(_)?"array":"")!=(qi(w)?"obj":Array.isArray(w)?"array":"")||("obj"===T?Dr(k=Object.keys(_).sort(),Object.keys(w).sort())||k.some(function(R){return Dr(_[R],w[R])}):"array"===T?_.length!==w.length||_.some(function(R,V){return Dr(R,w[V])}):_!==w)}function Ei(_){return _&&(qi(_)?Object.keys(_).reduce(function(w,T){return w[T]=Ei(_[T]),w},{}):Array.isArray(_)?_.map(Ei):_)}function nr(_){var w,T,k,R=1,V=_=(_+"").trim();function le(te){var re=1,j=Ra.exec(te);return j&&(re=parseFloat(j[1]),j[2]?re=0<=re&&re<=100?re/100:1:(re<0||1<re)&&(re=1)),re}return(w=/^(rgba|hsla|hwb|gray|device\-cmyk)\s*\(([\s\S]+)\)$/i.exec(_))?(T=w[1].toLowerCase(),k=w[2].trim().split(/\s*,\s*/),"rgba"===T&&4===k.length?(R=le(k[3]),V="rgb("+k.slice(0,3).join(", ")+")"):"hsla"===T&&4===k.length?(R=le(k[3]),V="hsl("+k.slice(0,3).join(", ")+")"):"hwb"===T&&4===k.length?(R=le(k[3]),V="hwb("+k.slice(0,3).join(", ")+")"):"gray"===T&&2===k.length?(R=le(k[1]),V="gray("+k[0]+")"):"device-cmyk"===T&&5<=k.length&&(R=le(k[4]),V="device-cmyk("+k.slice(0,4).join(", ")+")")):(w=/^\#(?:([\da-f]{6})([\da-f]{2})|([\da-f]{3})([\da-f]))$/i.exec(_))?w[1]?(R=parseInt(w[2],16)/255,V="#"+w[1]):(R=parseInt(w[4]+w[4],16)/255,V="#"+w[3]):"transparent"===_.toLocaleLowerCase()&&(R=0),[R,V]}function Hi(_){return!(!_||_.nodeType!==Node.ELEMENT_NODE||"function"!=typeof _.getBoundingClientRect)}function Rr(_,w){var T,k,R,V,le={};if(!(R=_.ownerDocument))return console.error("Cannot get document that contains the element."),null;if(_.compareDocumentPosition(R)&Node.DOCUMENT_POSITION_DISCONNECTED)return console.error("A disconnected element was passed."),null;for(k in T=_.getBoundingClientRect())le[k]=T[k];if(!w){if(!(V=R.defaultView))return console.error("Cannot get window that contains the element."),null;le.left+=V.pageXOffset,le.right+=V.pageXOffset,le.top+=V.pageYOffset,le.bottom+=V.pageYOffset}return le}function ho(_,w){var T,k,R=[],V=_;for(w=w||window;;){if(!(T=V.ownerDocument))return console.error("Cannot get document that contains the element."),null;if(!(k=T.defaultView))return console.error("Cannot get window that contains the element."),null;if(k===w)break;if(!(V=k.frameElement))return console.error("`baseWindow` was not found."),null;R.unshift(V)}return R}function No(_,w){var T,k,R=0,V=0;return(k=ho(_,w=w||window))?k.length?(k.forEach(function(le,te){var re,j,$=Rr(le,0<te);R+=$.left,V+=$.top,j=(re=le).ownerDocument.defaultView.getComputedStyle(re,""),$={left:re.clientLeft+parseFloat(j.paddingLeft),top:re.clientTop+parseFloat(j.paddingTop)},R+=$.left,V+=$.top}),(T=Rr(_,!0)).left+=R,T.right+=R,T.top+=V,T.bottom+=V,T):Rr(_):null}function Jn(_,w){var T=_.x-w.x,k=_.y-w.y;return Math.sqrt(T*T+k*k)}function Lo(_,w,T){var k=w.x-_.x,R=w.y-_.y;return{x:_.x+k*T,y:_.y+R*T,angle:Math.atan2(R,k)/(Math.PI/180)}}function Wi(_,w,T){var k=Math.atan2(_.y-w.y,w.x-_.x);return{x:w.x+Math.cos(k)*T,y:w.y+Math.sin(k)*T*-1}}function zi(_,w,T,k,R){var V=R*R,le=V*R,te=1-R,re=te*te,j=re*te,$=j*_.x+3*re*R*w.x+3*te*V*T.x+le*k.x,me=j*_.y+3*re*R*w.y+3*te*V*T.y+le*k.y,G=_.x+2*R*(w.x-_.x)+V*(T.x-2*w.x+_.x),J=_.y+2*R*(w.y-_.y)+V*(T.y-2*w.y+_.y),K=w.x+2*R*(T.x-w.x)+V*(k.x-2*T.x+w.x),se=w.y+2*R*(T.y-w.y)+V*(k.y-2*T.y+w.y),fe=te*_.x+R*w.x,be=te*_.y+R*w.y,ke=te*T.x+R*k.x,Ae=te*T.y+R*k.y,pe=90-180*Math.atan2(G-K,J-se)/Math.PI;return{x:$,y:me,fromP2:{x:G,y:J},toP1:{x:K,y:se},fromP1:{x:fe,y:be},toP2:{x:ke,y:Ae},angle:pe+=180<pe?-180:180}}function po(_,w,T,k,R){function V(J,K,se,fe,be){return J*(J*(-3*K+9*se-9*fe+3*be)+6*K-12*se+6*fe)-3*K+3*se}var le,te,re,j,me=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],G=0;return le=(R=null==R||1<R?1:R<0?0:R)/2,[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816].forEach(function(J,K){re=V(te=le*J+le,_.x,w.x,T.x,k.x),j=V(te,_.y,w.y,T.y,k.y),G+=me[K]*Math.sqrt(re*re+j*j)}),le*G}function Bi(_,w,T,k,R){for(var V,le=.5,te=1-le;V=po(_,w,T,k,te),!(Math.abs(V-R)<=.01);)te+=(V<R?1:-1)*(le/=2);return te}function gi(_,w){var T;return _.forEach(function(k){var R=w?k.map(function(V){var le={x:V.x,y:V.y};return w(le),le}):k;T||(T=[{type:"M",values:[R[0].x,R[0].y]}]),T.push(R.length?2===R.length?{type:"L",values:[R[1].x,R[1].y]}:{type:"C",values:[R[1].x,R[1].y,R[2].x,R[2].y,R[3].x,R[3].y]}:{type:"Z",values:[]})}),T}function $o(_){var w=[],T=0;return _.forEach(function(k){var R=(2===k.length?Jn:po).apply(null,k);w.push(R),T+=R}),{segsLen:w,lenAll:T}}function Nn(_,w){return null==_||null==w||_.length!==w.length||_.some(function(T,k){var R=w[k];return T.type!==R.type||T.values.some(function(V,le){return V!==R.values[le]})})}function Gn(_,w,T){_.events[w]?_.events[w].indexOf(T)<0&&_.events[w].push(T):_.events[w]=[T]}function qn(_,w,T){var k;_.events[w]&&-1<(k=_.events[w].indexOf(T))&&_.events[w].splice(k,1)}function ir(_){xr&&clearTimeout(xr),Oo.push(_),xr=setTimeout(function(){Oo.forEach(function(w){w()}),Oo=[]},0)}function cn(_,w){_.reflowTargets.indexOf(w)<0&&_.reflowTargets.push(w)}function Fo(_){_.reflowTargets.forEach(function(w){var T;T=w,setTimeout(function(){var k=T.parentNode,R=T.nextSibling;k.insertBefore(k.removeChild(T),R)},0)}),_.reflowTargets=[]}function Er(_,w,T,k,R,V,le){var te,re,j;"auto-start-reverse"===T?("boolean"!=typeof Zi&&(w.setAttribute("orient","auto-start-reverse"),Zi=w.orientType.baseVal===SVGMarkerElement.SVG_MARKER_ORIENT_UNKNOWN),Zi?w.setAttribute("orient",T):((te=R.createSVGTransform()).setRotate(180,0,0),V.transform.baseVal.appendItem(te),w.setAttribute("orient","auto"),j=!0)):(w.setAttribute("orient",T),!1===Zi&&V.transform.baseVal.clear()),re=w.viewBox.baseVal,j?(re.x=-k.right,re.y=-k.bottom):(re.x=k.left,re.y=k.top),re.width=k.width,re.height=k.height,Ht&&cn(_,le)}function ea(_,w){return{prop:_?"markerEnd":"markerStart",orient:w?w.noRotate?"0":_?"auto":"auto-start-reverse":null}}function Qn(_,w){Object.keys(w).forEach(function(T){var k=w[T];_[T]=null!=k.iniValue?k.hasSE?[k.iniValue,k.iniValue]:k.iniValue:k.hasSE?k.hasProps?[{},{}]:[]:k.hasProps?{}:null})}function He(_,w,T,k,R){return k!==w[T]&&(w[T]=k,R&&R.forEach(function(V){V(_,k,T)}),!0)}function hn(_){function w(le,te){return le+parseFloat(te)}var T=_.document,k=_.getComputedStyle(T.documentElement,""),R=_.getComputedStyle(T.body,""),V={x:0,y:0};return"static"!==R.position?(V.x-=[k.marginLeft,k.borderLeftWidth,k.paddingLeft,R.marginLeft,R.borderLeftWidth].reduce(w,0),V.y-=[k.marginTop,k.borderTopWidth,k.paddingTop,R.marginTop,R.borderTopWidth].reduce(w,0)):"static"!==k.position&&(V.x-=[k.marginLeft,k.borderLeftWidth].reduce(w,0),V.y-=[k.marginTop,k.borderTopWidth].reduce(w,0)),V}function ta(_){var w,T=_.document;T.getElementById("leader-line-defs")||(w=(new _.DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg" version="1.1" id="leader-line-defs"><style><![CDATA[.leader-line{position:absolute;overflow:visible!important;pointer-events:none!important;font-size:16px}#leader-line-defs{width:0;height:0;position:absolute;left:0;top:0}.leader-line-line-path{fill:none}.leader-line-mask-bg-rect{fill:#fff}.leader-line-caps-mask-anchor,.leader-line-caps-mask-marker-shape{fill:#000}.leader-line-caps-mask-anchor{stroke:#000}.leader-line-caps-mask-line,.leader-line-plugs-face{stroke:transparent}.leader-line-line-mask-shape{stroke:#fff}.leader-line-line-outline-mask-shape{stroke:#000}.leader-line-plug-mask-shape{fill:#fff;stroke:#000}.leader-line-plug-outline-mask-shape{fill:#000;stroke:#fff}.leader-line-areaAnchor{position:absolute;overflow:visible!important}]]></style><defs><circle id="leader-line-disc" cx="0" cy="0" r="5"/><rect id="leader-line-square" x="-5" y="-5" width="10" height="10"/><polygon id="leader-line-arrow1" points="-8,-8 8,0 -8,8 -5,0"/><polygon id="leader-line-arrow2" points="-4,-8 4,0 -4,8 -7,5 -2,0 -7,-5"/><polygon id="leader-line-arrow3" points="-4,-5 8,0 -4,5"/><g id="leader-line-hand"><path style="fill: #fcfcfc" d="M9.19 11.14h4.75c1.38 0 2.49-1.11 2.49-2.49 0-.51-.15-.98-.41-1.37h1.3c1.38 0 2.49-1.11 2.49-2.49s-1.11-2.53-2.49-2.53h1.02c1.38 0 2.49-1.11 2.49-2.49s-1.11-2.49-2.49-2.49h14.96c1.37 0 2.49-1.11 2.49-2.49s-1.11-2.49-2.49-2.49H16.58C16-9.86 14.28-11.14 9.7-11.14c-4.79 0-6.55 3.42-7.87 4.73H-2.14v13.23h3.68C3.29 9.97 5.47 11.14 9.19 11.14L9.19 11.14Z"/><path style="fill: black" d="M13.95 12c1.85 0 3.35-1.5 3.35-3.35 0-.17-.02-.34-.04-.51h.07c1.85 0 3.35-1.5 3.35-3.35 0-.79-.27-1.51-.72-2.08 1.03-.57 1.74-1.67 1.74-2.93 0-.59-.16-1.15-.43-1.63h12.04c1.85 0 3.35-1.5 3.35-3.35 0-1.85-1.5-3.35-3.35-3.35H17.2C16.26-10.93 13.91-12 9.7-12 5.36-12 3.22-9.4 1.94-7.84c0 0-.29.33-.5.57-.63 0-3.58 0-3.58 0C-2.61-7.27-3-6.88-3-6.41v13.23c0 .47.39.86.86.86 0 0 2.48 0 3.2 0C2.9 10.73 5.29 12 9.19 12L13.95 12ZM9.19 10.28c-3.46 0-5.33-1.05-6.9-3.87-.15-.27-.44-.44-.75-.44 0 0-1.81 0-2.82 0V-5.55c1.06 0 3.11 0 3.11 0 .25 0 .44-.06.61-.25l.83-.95c1.23-1.49 2.91-3.53 6.43-3.53 3.45 0 4.9.74 5.57 1.72h-4.3c-.48 0-.86.38-.86.86s.39.86.86.86h22.34c.9 0 1.63.73 1.63 1.63 0 .9-.73 1.63-1.63 1.63H15.83c-.48 0-.86.38-.86.86 0 .47.39.86.86.86h2.52c.9 0 1.63.73 1.63 1.63s-.73 1.63-1.63 1.63h-3.12c-.48 0-.86.38-.86.86 0 .47.39.86.86.86h2.11c.88 0 1.63.76 1.63 1.67 0 .9-.73 1.63-1.63 1.63h-3.2c-.48 0-.86.39-.86.86 0 .47.39.86.86.86h1.36c.05.16.09.34.09.51 0 .9-.73 1.63-1.63 1.63C13.95 10.28 9.19 10.28 9.19 10.28Z"/></g><g id="leader-line-crosshair"><path d="M0-78.97c-43.54 0-78.97 35.43-78.97 78.97 0 43.54 35.43 78.97 78.97 78.97s78.97-35.43 78.97-78.97C78.97-43.54 43.55-78.97 0-78.97ZM76.51-1.21h-9.91v-9.11h-2.43v9.11h-11.45c-.64-28.12-23.38-50.86-51.5-51.5V-64.17h9.11V-66.6h-9.11v-9.91C42.46-75.86 75.86-42.45 76.51-1.21ZM-1.21-30.76h-9.11v2.43h9.11V-4.2c-1.44.42-2.57 1.54-2.98 2.98H-28.33v-9.11h-2.43v9.11H-50.29C-49.65-28-27.99-49.65-1.21-50.29V-30.76ZM-30.76 1.21v9.11h2.43v-9.11H-4.2c.42 1.44 1.54 2.57 2.98 2.98v24.13h-9.11v2.43h9.11v19.53C-27.99 49.65-49.65 28-50.29 1.21H-30.76ZM1.22 30.75h9.11v-2.43h-9.11V4.2c1.44-.42 2.56-1.54 2.98-2.98h24.13v9.11h2.43v-9.11h19.53C49.65 28 28 49.65 1.22 50.29V30.75ZM30.76-1.21v-9.11h-2.43v9.11H4.2c-.42-1.44-1.54-2.56-2.98-2.98V-28.33h9.11v-2.43h-9.11V-50.29C28-49.65 49.65-28 50.29-1.21H30.76ZM-1.21-76.51v9.91h-9.11v2.43h9.11v11.45c-28.12.64-50.86 23.38-51.5 51.5H-64.17v-9.11H-66.6v9.11h-9.91C-75.86-42.45-42.45-75.86-1.21-76.51ZM-76.51 1.21h9.91v9.11h2.43v-9.11h11.45c.64 28.12 23.38 50.86 51.5 51.5v11.45h-9.11v2.43h9.11v9.91C-42.45 75.86-75.86 42.45-76.51 1.21ZM1.22 76.51v-9.91h9.11v-2.43h-9.11v-11.45c28.12-.64 50.86-23.38 51.5-51.5h11.45v9.11h2.43v-9.11h9.91C75.86 42.45 42.45 75.86 1.22 76.51Z"/><path d="M0 83.58-7.1 96 7.1 96Z"/><path d="M0-83.58 7.1-96-7.1-96"/><path d="M83.58 0 96 7.1 96-7.1Z"/><path d="M-83.58 0-96-7.1-96 7.1Z"/></g></defs></svg>',"image/svg+xml"),T.body.appendChild(w.documentElement),function(_){_.SVGPathElement.prototype.getPathData&&_.SVGPathElement.prototype.setPathData||function(){var w={Z:"Z",M:"M",L:"L",C:"C",Q:"Q",A:"A",H:"H",V:"V",S:"S",T:"T",z:"Z",m:"m",l:"l",c:"c",q:"q",a:"a",h:"h",v:"v",s:"s",t:"t"},T=function(G){this._string=G,this._currentIndex=0,this._endIndex=this._string.length,this._prevCommand=null,this._skipOptionalSpaces()},k=-1!==_.navigator.userAgent.indexOf("MSIE ");T.prototype={parseSegment:function(){var G=this._string[this._currentIndex],J=w[G]?w[G]:null;if(null===J){if(null===this._prevCommand||null===(J=("+"===G||"-"===G||"."===G||"0"<=G&&G<="9")&&"Z"!==this._prevCommand?"M"===this._prevCommand?"L":"m"===this._prevCommand?"l":this._prevCommand:null))return null}else this._currentIndex+=1;var K=null,se=(this._prevCommand=J).toUpperCase();return"H"===se||"V"===se?K=[this._parseNumber()]:"M"===se||"L"===se||"T"===se?K=[this._parseNumber(),this._parseNumber()]:"S"===se||"Q"===se?K=[this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber()]:"C"===se?K=[this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber()]:"A"===se?K=[this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseArcFlag(),this._parseArcFlag(),this._parseNumber(),this._parseNumber()]:"Z"===se&&(this._skipOptionalSpaces(),K=[]),null===K||0<=K.indexOf(null)?null:{type:J,values:K}},hasMoreData:function(){return this._currentIndex<this._endIndex},peekSegmentType:function(){var G=this._string[this._currentIndex];return w[G]?w[G]:null},initialCommandIsMoveTo:function(){if(!this.hasMoreData())return!0;var G=this.peekSegmentType();return"M"===G||"m"===G},_isCurrentSpace:function(){var G=this._string[this._currentIndex];return G<=" "&&(" "===G||"\n"===G||"\t"===G||"\r"===G||"\f"===G)},_skipOptionalSpaces:function(){for(;this._currentIndex<this._endIndex&&this._isCurrentSpace();)this._currentIndex+=1;return this._currentIndex<this._endIndex},_skipOptionalSpacesOrDelimiter:function(){return!(this._currentIndex<this._endIndex&&!this._isCurrentSpace()&&","!==this._string[this._currentIndex])&&(this._skipOptionalSpaces()&&this._currentIndex<this._endIndex&&","===this._string[this._currentIndex]&&(this._currentIndex+=1,this._skipOptionalSpaces()),this._currentIndex<this._endIndex)},_parseNumber:function(){var G=0,J=0,K=1,se=0,fe=1,be=1,ke=this._currentIndex;if(this._skipOptionalSpaces(),this._currentIndex<this._endIndex&&"+"===this._string[this._currentIndex]?this._currentIndex+=1:this._currentIndex<this._endIndex&&"-"===this._string[this._currentIndex]&&(this._currentIndex+=1,fe=-1),this._currentIndex===this._endIndex||(this._string[this._currentIndex]<"0"||"9"<this._string[this._currentIndex])&&"."!==this._string[this._currentIndex])return null;for(var Ae=this._currentIndex;this._currentIndex<this._endIndex&&"0"<=this._string[this._currentIndex]&&this._string[this._currentIndex]<="9";)this._currentIndex+=1;if(this._currentIndex!==Ae)for(var pe=this._currentIndex-1,ne=1;Ae<=pe;)J+=ne*(this._string[pe]-"0"),pe-=1,ne*=10;if(this._currentIndex<this._endIndex&&"."===this._string[this._currentIndex]){if(this._currentIndex+=1,this._currentIndex>=this._endIndex||this._string[this._currentIndex]<"0"||"9"<this._string[this._currentIndex])return null;for(;this._currentIndex<this._endIndex&&"0"<=this._string[this._currentIndex]&&this._string[this._currentIndex]<="9";)K*=10,se+=(this._string.charAt(this._currentIndex)-"0")/K,this._currentIndex+=1}if(this._currentIndex!==ke&&this._currentIndex+1<this._endIndex&&("e"===this._string[this._currentIndex]||"E"===this._string[this._currentIndex])&&"x"!==this._string[this._currentIndex+1]&&"m"!==this._string[this._currentIndex+1]){if(this._currentIndex+=1,"+"===this._string[this._currentIndex]?this._currentIndex+=1:"-"===this._string[this._currentIndex]&&(this._currentIndex+=1,be=-1),this._currentIndex>=this._endIndex||this._string[this._currentIndex]<"0"||"9"<this._string[this._currentIndex])return null;for(;this._currentIndex<this._endIndex&&"0"<=this._string[this._currentIndex]&&this._string[this._currentIndex]<="9";)G*=10,G+=this._string[this._currentIndex]-"0",this._currentIndex+=1}var ue=J+se;return ue*=fe,G&&(ue*=Math.pow(10,be*G)),ke===this._currentIndex?null:(this._skipOptionalSpacesOrDelimiter(),ue)},_parseArcFlag:function(){if(this._currentIndex>=this._endIndex)return null;var G=null,J=this._string[this._currentIndex];if(this._currentIndex+=1,"0"===J)G=0;else{if("1"!==J)return null;G=1}return this._skipOptionalSpacesOrDelimiter(),G}};var R=function(G){if(!G||0===G.length)return[];var J=new T(G),K=[];if(J.initialCommandIsMoveTo())for(;J.hasMoreData();){var se=J.parseSegment();if(null===se)break;K.push(se)}return K},V=_.SVGPathElement.prototype.setAttribute,le=_.SVGPathElement.prototype.removeAttribute,te=_.Symbol?_.Symbol():"__cachedPathData",re=_.Symbol?_.Symbol():"__cachedNormalizedPathData",j=function(G,J,K,se,fe,be,ke,Ae,pe,ne){var oe,ot,dt,et,q=function(It,en,gn){return{x:It*Math.cos(gn)-en*Math.sin(gn),y:It*Math.sin(gn)+en*Math.cos(gn)}},ye=Math.PI*ke/180,x=[];if(ne)oe=ne[0],ot=ne[1],dt=ne[2],et=ne[3];else{var D=q(G,J,-ye);G=D.x,J=D.y;var E=q(K,se,-ye),M=(G-(K=E.x))/2,I=(J-(se=E.y))/2,ee=M*M/(fe*fe)+I*I/(be*be);1<ee&&(fe*=ee=Math.sqrt(ee),be*=ee);var qe=fe*fe,Ie=be*be,un=(Ae===pe?-1:1)*Math.sqrt(Math.abs((qe*Ie-qe*I*I-Ie*M*M)/(qe*I*I+Ie*M*M)));dt=un*fe*I/be+(G+K)/2,et=un*-be*M/fe+(J+se)/2,oe=Math.asin(parseFloat(((J-et)/be).toFixed(9))),ot=Math.asin(parseFloat(((se-et)/be).toFixed(9))),G<dt&&(oe=Math.PI-oe),K<dt&&(ot=Math.PI-ot),oe<0&&(oe=2*Math.PI+oe),ot<0&&(ot=2*Math.PI+ot),pe&&ot<oe&&(oe-=2*Math.PI),!pe&&oe<ot&&(ot-=2*Math.PI)}var En=ot-oe;if(Math.abs(En)>120*Math.PI/180){var Si=ot,Ro=K,Dt=se;ot=pe&&oe<ot?oe+120*Math.PI/180*1:oe+120*Math.PI/180*-1,K=dt+fe*Math.cos(ot),se=et+be*Math.sin(ot),x=j(K,se,Ro,Dt,fe,be,ke,0,pe,[ot,Si,dt,et])}En=ot-oe;var gt=Math.cos(oe),ct=Math.sin(oe),Ut=Math.cos(ot),pt=Math.sin(ot),Wt=Math.tan(En/4),Ln=4/3*fe*Wt,zt=4/3*be*Wt,Yi=[G,J],Vi=[G+Ln*ct,J-zt*gt],Oi=[K+Ln*pt,se-zt*Ut],Sn=[K,se];if(Vi[0]=2*Yi[0]-Vi[0],Vi[1]=2*Yi[1]-Vi[1],ne)return[Vi,Oi,Sn].concat(x);x=[Vi,Oi,Sn].concat(x).join().split(",");var _e=[],Nt=[];return x.forEach(function(It,en){Nt.push(en%2?q(x[en-1],x[en],ye).y:q(x[en],x[en+1],ye).x),6===Nt.length&&(_e.push(Nt),Nt=[])}),_e},$=function(G){return G.map(function(J){return{type:J.type,values:Array.prototype.slice.call(J.values)}})},me=function(G){var J=[],K=null,se=null,fe=null,be=null,ke=null,Ae=null,pe=null;return G.forEach(function(ne){if("M"===ne.type){var ue=ne.values[0],oe=ne.values[1];J.push({type:"M",values:[ue,oe]}),be=Ae=ue,ke=pe=oe}else if("C"===ne.type){var ot=ne.values[0],dt=ne.values[1],et=ne.values[2],q=ne.values[3];J.push({type:"C",values:[ot,dt,et,q,ue=ne.values[4],oe=ne.values[5]]}),se=et,fe=q,be=ue,ke=oe}else if("L"===ne.type)J.push({type:"L",values:[ue=ne.values[0],oe=ne.values[1]]}),be=ue,ke=oe;else if("H"===ne.type)J.push({type:"L",values:[ue=ne.values[0],ke]}),be=ue;else if("V"===ne.type)J.push({type:"L",values:[be,oe=ne.values[0]]}),ke=oe;else if("S"===ne.type)"C"===K||"S"===K?(ye=be+(be-se),x=ke+(ke-fe)):(ye=be,x=ke),J.push({type:"C",values:[ye,x,et=ne.values[0],q=ne.values[1],ue=ne.values[2],oe=ne.values[3]]}),se=et,fe=q,be=ue,ke=oe;else if("T"===ne.type){"Q"===K||"T"===K?(ot=be+(be-se),dt=ke+(ke-fe)):(ot=be,dt=ke);var ye=be+2*(ot-be)/3,x=ke+2*(dt-ke)/3,D=(ue=ne.values[0])+2*(ot-ue)/3,E=(oe=ne.values[1])+2*(dt-oe)/3;J.push({type:"C",values:[ye,x,D,E,ue,oe]}),se=ot,fe=dt,be=ue,ke=oe}else if("Q"===ne.type)J.push({type:"C",values:[ye=be+2*((ot=ne.values[0])-be)/3,x=ke+2*((dt=ne.values[1])-ke)/3,D=(ue=ne.values[2])+2*(ot-ue)/3,E=(oe=ne.values[3])+2*(dt-oe)/3,ue,oe]}),se=ot,fe=dt,be=ue,ke=oe;else if("A"===ne.type){var M=ne.values[0],I=ne.values[1],ee=ne.values[2],qe=ne.values[3],Ie=ne.values[4];ue=ne.values[5],oe=ne.values[6],0===M||0===I?(J.push({type:"C",values:[be,ke,ue,oe,ue,oe]}),be=ue,ke=oe):(be!==ue||ke!==oe)&&j(be,ke,ue,oe,M,I,ee,qe,Ie).forEach(function(Ct){J.push({type:"C",values:Ct}),be=ue,ke=oe})}else"Z"===ne.type&&(J.push(ne),be=Ae,ke=pe);K=ne.type}),J};_.SVGPathElement.prototype.setAttribute=function(G,J){"d"===G&&(this[te]=null,this[re]=null),V.call(this,G,J)},_.SVGPathElement.prototype.removeAttribute=function(G,J){"d"===G&&(this[te]=null,this[re]=null),le.call(this,G)},_.SVGPathElement.prototype.getPathData=function(G){if(G&&G.normalize){if(this[re])return $(this[re]);this[te]?Ae=$(this[te]):(Ae=R(this.getAttribute("d")||""),this[te]=$(Ae));var J=me((K=[],ke=be=fe=se=null,Ae.forEach(function(pe){var ne=pe.type;if("M"===ne){var ue=pe.values[0],oe=pe.values[1];K.push({type:"M",values:[ue,oe]}),se=be=ue,fe=ke=oe}else if("m"===ne)K.push({type:"M",values:[ue=se+pe.values[0],oe=fe+pe.values[1]]}),se=be=ue,fe=ke=oe;else if("L"===ne)K.push({type:"L",values:[ue=pe.values[0],oe=pe.values[1]]}),se=ue,fe=oe;else if("l"===ne)K.push({type:"L",values:[ue=se+pe.values[0],oe=fe+pe.values[1]]}),se=ue,fe=oe;else if("C"===ne){var ot=pe.values[0],dt=pe.values[1],et=pe.values[2],q=pe.values[3];K.push({type:"C",values:[ot,dt,et,q,ue=pe.values[4],oe=pe.values[5]]}),se=ue,fe=oe}else"c"===ne?(K.push({type:"C",values:[ot=se+pe.values[0],dt=fe+pe.values[1],et=se+pe.values[2],q=fe+pe.values[3],ue=se+pe.values[4],oe=fe+pe.values[5]]}),se=ue,fe=oe):"Q"===ne?(K.push({type:"Q",values:[ot=pe.values[0],dt=pe.values[1],ue=pe.values[2],oe=pe.values[3]]}),se=ue,fe=oe):"q"===ne?(K.push({type:"Q",values:[ot=se+pe.values[0],dt=fe+pe.values[1],ue=se+pe.values[2],oe=fe+pe.values[3]]}),se=ue,fe=oe):"A"===ne?(K.push({type:"A",values:[pe.values[0],pe.values[1],pe.values[2],pe.values[3],pe.values[4],ue=pe.values[5],oe=pe.values[6]]}),se=ue,fe=oe):"a"===ne?(K.push({type:"A",values:[pe.values[0],pe.values[1],pe.values[2],pe.values[3],pe.values[4],ue=se+pe.values[5],oe=fe+pe.values[6]]}),se=ue,fe=oe):"H"===ne?(K.push({type:"H",values:[ue=pe.values[0]]}),se=ue):"h"===ne?(K.push({type:"H",values:[ue=se+pe.values[0]]}),se=ue):"V"===ne?(K.push({type:"V",values:[oe=pe.values[0]]}),fe=oe):"v"===ne?(K.push({type:"V",values:[oe=fe+pe.values[0]]}),fe=oe):"S"===ne?(K.push({type:"S",values:[et=pe.values[0],q=pe.values[1],ue=pe.values[2],oe=pe.values[3]]}),se=ue,fe=oe):"s"===ne?(K.push({type:"S",values:[et=se+pe.values[0],q=fe+pe.values[1],ue=se+pe.values[2],oe=fe+pe.values[3]]}),se=ue,fe=oe):"T"===ne?(K.push({type:"T",values:[ue=pe.values[0],oe=pe.values[1]]}),se=ue,fe=oe):"t"===ne?(K.push({type:"T",values:[ue=se+pe.values[0],oe=fe+pe.values[1]]}),se=ue,fe=oe):"Z"!==ne&&"z"!==ne||(K.push({type:"Z",values:[]}),se=be,fe=ke)}),K));return this[re]=$(J),J}if(this[te])return $(this[te]);var K,se,fe,be,ke,Ae=R(this.getAttribute("d")||"");return this[te]=$(Ae),Ae},_.SVGPathElement.prototype.setPathData=function(G){if(0===G.length)k?this.setAttribute("d",""):this.removeAttribute("d");else{for(var J="",K=0,se=G.length;K<se;K+=1){var fe=G[K];0<K&&(J+=" "),J+=fe.type,fe.values&&0<fe.values.length&&(J+=" "+fe.values.join(" "))}this.setAttribute("d",J)}},_.SVGRectElement.prototype.getPathData=function(G){var J=this.x.baseVal.value,K=this.y.baseVal.value,se=this.width.baseVal.value,fe=this.height.baseVal.value,be=this.hasAttribute("rx")?this.rx.baseVal.value:this.ry.baseVal.value,ke=this.hasAttribute("ry")?this.ry.baseVal.value:this.rx.baseVal.value;se/2<be&&(be=se/2),fe/2<ke&&(ke=fe/2);var Ae=[{type:"M",values:[J+be,K]},{type:"H",values:[J+se-be]},{type:"A",values:[be,ke,0,0,1,J+se,K+ke]},{type:"V",values:[K+fe-ke]},{type:"A",values:[be,ke,0,0,1,J+se-be,K+fe]},{type:"H",values:[J+be]},{type:"A",values:[be,ke,0,0,1,J,K+fe-ke]},{type:"V",values:[K+ke]},{type:"A",values:[be,ke,0,0,1,J+be,K]},{type:"Z",values:[]}];return Ae=Ae.filter(function(pe){return"A"!==pe.type||0!==pe.values[0]&&0!==pe.values[1]}),G&&!0===G.normalize&&(Ae=me(Ae)),Ae},_.SVGCircleElement.prototype.getPathData=function(G){var J=this.cx.baseVal.value,K=this.cy.baseVal.value,se=this.r.baseVal.value,fe=[{type:"M",values:[J+se,K]},{type:"A",values:[se,se,0,0,1,J,K+se]},{type:"A",values:[se,se,0,0,1,J-se,K]},{type:"A",values:[se,se,0,0,1,J,K-se]},{type:"A",values:[se,se,0,0,1,J+se,K]},{type:"Z",values:[]}];return G&&!0===G.normalize&&(fe=me(fe)),fe},_.SVGEllipseElement.prototype.getPathData=function(G){var J=this.cx.baseVal.value,K=this.cy.baseVal.value,se=this.rx.baseVal.value,fe=this.ry.baseVal.value,be=[{type:"M",values:[J+se,K]},{type:"A",values:[se,fe,0,0,1,J,K+fe]},{type:"A",values:[se,fe,0,0,1,J-se,K]},{type:"A",values:[se,fe,0,0,1,J,K-fe]},{type:"A",values:[se,fe,0,0,1,J+se,K]},{type:"Z",values:[]}];return G&&!0===G.normalize&&(be=me(be)),be},_.SVGLineElement.prototype.getPathData=function(){return[{type:"M",values:[this.x1.baseVal.value,this.y1.baseVal.value]},{type:"L",values:[this.x2.baseVal.value,this.y2.baseVal.value]}]},_.SVGPolylineElement.prototype.getPathData=function(){for(var G=[],J=0;J<this.points.numberOfItems;J+=1){var K=this.points.getItem(J);G.push({type:0===J?"M":"L",values:[K.x,K.y]})}return G},_.SVGPolygonElement.prototype.getPathData=function(){for(var G=[],J=0;J<this.points.numberOfItems;J+=1){var K=this.points.getItem(J);G.push({type:0===J?"M":"L",values:[K.x,K.y]})}return G.push({type:"Z",values:[]}),G}}()}(_))}function Kr(_,w){w!==_.isShown&&(!!w!=!!_.isShown&&(_.svg.style.visibility=w?"":"hidden"),_.isShown=w,_.events&&_.events.svgShow&&_.events.svgShow.forEach(function(T){T(_,w)}))}function _i(_,w){var T,k,R,V,le,te,re,j,$,me,G,J,K,se,fe,be,ke,Ae,pe,ne,ue,oe,ot,dt,et,q,ye,x,D,E,M,I,ee,qe,Ie,Ct,un,En,Si,Ro,Dt,gt,ct,Ut,pt,Wt,Ln,zt,Yi,Vi,Oi,Sn={};w.line&&(Sn.line=(k=(T=_).options,le=!1,le=He(T,R=T.curStats,"line_color",k.lineColor,(V=T.events).cur_line_color)||le,le=He(T,R,"line_colorTra",nr(R.line_color)[0]<1)||le,le=He(T,R,"line_strokeWidth",k.lineSize,V.cur_line_strokeWidth)||le)),(w.plug||Sn.line)&&(Sn.plug=(re=(te=_).options,j=te.curStats,$=te.events,me=!1,[0,1].forEach(function(_e){var Nt,It,en,gn,Ar,ms,Mi,fo,mi=re.plugSE[_e];me=He(te,j.plug_enabledSE,_e,mi!==Yn)||me,me=He(te,j.plug_plugSE,_e,mi)||me,me=He(te,j.plug_colorSE,_e,fo=re.plugColorSE[_e]||j.line_color,$.cur_plug_colorSE)||me,me=He(te,j.plug_colorTraSE,_e,nr(fo)[0]<1)||me,mi!==Yn&&(gn=It=(Nt=br[xi[mi]]).widthR*re.plugSizeSE[_e],Ar=en=Nt.heightR*re.plugSizeSE[_e],bn&&(gn*=j.line_strokeWidth,Ar*=j.line_strokeWidth),me=He(te,j.plug_markerWidthSE,_e,gn)||me,me=He(te,j.plug_markerHeightSE,_e,Ar)||me,j.capsMaskMarker_markerWidthSE[_e]=It,j.capsMaskMarker_markerHeightSE[_e]=en),j.plugOutline_plugSE[_e]=j.capsMaskMarker_plugSE[_e]=mi,j.plug_enabledSE[_e]?(j.position_plugOverheadSE[_e]=Nt.overhead*(fo=j.line_strokeWidth/Xn.lineSize*re.plugSizeSE[_e]),j.viewBox_plugBCircleSE[_e]=Nt.bCircle*fo,ms=Nt.sideLen*fo,Mi=Nt.backLen*fo):(j.position_plugOverheadSE[_e]=-j.line_strokeWidth/2,j.viewBox_plugBCircleSE[_e]=ms=Mi=0),He(te,j.attach_plugSideLenSE,_e,ms,$.cur_attach_plugSideLenSE),He(te,j.attach_plugBackLenSE,_e,Mi,$.cur_attach_plugBackLenSE),j.capsMaskAnchor_enabledSE[_e]=!j.plug_enabledSE[_e]}),me=He(te,j,"plug_enabled",j.plug_enabledSE[0]||j.plug_enabledSE[1])||me)),(w.lineOutline||Sn.line)&&(Sn.lineOutline=(K=(G=_).options,fe=!1,fe=He(G,se=G.curStats,"lineOutline_enabled",K.lineOutlineEnabled)||fe,fe=He(G,se,"lineOutline_color",K.lineOutlineColor)||fe,fe=He(G,se,"lineOutline_colorTra",nr(se.lineOutline_color)[0]<1)||fe,fe=He(G,se,"lineOutline_strokeWidth",se.line_strokeWidth-2*(J=se.line_strokeWidth*K.lineOutlineSize))||fe,fe=He(G,se,"lineOutline_inStrokeWidth",se.lineOutline_colorTra?se.lineOutline_strokeWidth+2*bi:se.line_strokeWidth-J)||fe)),(w.plugOutline||Sn.line||Sn.plug||Sn.lineOutline)&&(Sn.plugOutline=(ke=(be=_).options,Ae=be.curStats,pe=!1,[0,1].forEach(function(_e){var Nt,It=Ae.plugOutline_plugSE[_e],en=It!==Yn?br[xi[It]]:null;pe=He(be,Ae.plugOutline_enabledSE,_e,ke.plugOutlineEnabledSE[_e]&&Ae.plug_enabled&&Ae.plug_enabledSE[_e]&&!!en&&!!en.outlineBase)||pe,pe=He(be,Ae.plugOutline_colorSE,_e,Nt=ke.plugOutlineColorSE[_e]||Ae.lineOutline_color)||pe,pe=He(be,Ae.plugOutline_colorTraSE,_e,nr(Nt)[0]<1)||pe,en&&en.outlineBase&&((Nt=ke.plugOutlineSizeSE[_e])>en.outlineMax&&(Nt=en.outlineMax),pe=He(be,Ae.plugOutline_strokeWidthSE,_e,Nt*=2*en.outlineBase)||pe,pe=He(be,Ae.plugOutline_inStrokeWidthSE,_e,Ae.plugOutline_colorTraSE[_e]?Nt-bi/(Ae.line_strokeWidth/Xn.lineSize)/ke.plugSizeSE[_e]*2:Nt/2)||pe)}),pe)),(w.faces||Sn.line||Sn.plug||Sn.lineOutline||Sn.plugOutline)&&(Sn.faces=(oe=(ne=_).curStats,ot=ne.aplStats,dt=ne.events,et=!1,!oe.line_altColor&&He(ne,ot,"line_color",ue=oe.line_color,dt.apl_line_color)&&(ne.lineFace.style.stroke=ue,et=!0),He(ne,ot,"line_strokeWidth",ue=oe.line_strokeWidth,dt.apl_line_strokeWidth)&&(ne.lineShape.style.strokeWidth=ue+"px",et=!0,(xn||Ht)&&(cn(ne,ne.lineShape),Ht&&(cn(ne,ne.lineFace),cn(ne,ne.lineMaskCaps)))),He(ne,ot,"lineOutline_enabled",ue=oe.lineOutline_enabled,dt.apl_lineOutline_enabled)&&(ne.lineOutlineFace.style.display=ue?"inline":"none",et=!0),oe.lineOutline_enabled&&(He(ne,ot,"lineOutline_color",ue=oe.lineOutline_color,dt.apl_lineOutline_color)&&(ne.lineOutlineFace.style.stroke=ue,et=!0),He(ne,ot,"lineOutline_strokeWidth",ue=oe.lineOutline_strokeWidth,dt.apl_lineOutline_strokeWidth)&&(ne.lineOutlineMaskShape.style.strokeWidth=ue+"px",et=!0,Ht&&(cn(ne,ne.lineOutlineMaskCaps),cn(ne,ne.lineOutlineFace))),He(ne,ot,"lineOutline_inStrokeWidth",ue=oe.lineOutline_inStrokeWidth,dt.apl_lineOutline_inStrokeWidth)&&(ne.lineMaskShape.style.strokeWidth=ue+"px",et=!0,Ht&&(cn(ne,ne.lineOutlineMaskCaps),cn(ne,ne.lineOutlineFace)))),He(ne,ot,"plug_enabled",ue=oe.plug_enabled,dt.apl_plug_enabled)&&(ne.plugsFace.style.display=ue?"inline":"none",et=!0),oe.plug_enabled&&[0,1].forEach(function(_e){var Nt=oe.plug_plugSE[_e],It=Nt!==Yn?br[xi[Nt]]:null,en=ea(_e,It);He(ne,ot.plug_enabledSE,_e,ue=oe.plug_enabledSE[_e],dt.apl_plug_enabledSE)&&(ne.plugsFace.style[en.prop]=ue?"url(#"+ne.plugMarkerIdSE[_e]+")":"none",et=!0),oe.plug_enabledSE[_e]&&(He(ne,ot.plug_plugSE,_e,Nt,dt.apl_plug_plugSE)&&(ne.plugFaceSE[_e].href.baseVal="#"+It.elmId,Er(ne,ne.plugMarkerSE[_e],en.orient,It.bBox,ne.svg,ne.plugMarkerShapeSE[_e],ne.plugsFace),et=!0,xn&&cn(ne,ne.plugsFace)),He(ne,ot.plug_colorSE,_e,ue=oe.plug_colorSE[_e],dt.apl_plug_colorSE)&&(ne.plugFaceSE[_e].style.fill=ue,et=!0,(Zt||bn||Ht)&&!oe.line_colorTra&&cn(ne,Ht?ne.lineMaskCaps:ne.capsMaskLine)),["markerWidth","markerHeight"].forEach(function(gn){var Ar="plug_"+gn+"SE";He(ne,ot[Ar],_e,ue=oe[Ar][_e],dt["apl_"+Ar])&&(ne.plugMarkerSE[_e][gn].baseVal.value=ue,et=!0)}),He(ne,ot.plugOutline_enabledSE,_e,ue=oe.plugOutline_enabledSE[_e],dt.apl_plugOutline_enabledSE)&&(ue?(ne.plugFaceSE[_e].style.mask="url(#"+ne.plugMaskIdSE[_e]+")",ne.plugOutlineFaceSE[_e].style.display="inline"):(ne.plugFaceSE[_e].style.mask="none",ne.plugOutlineFaceSE[_e].style.display="none"),et=!0),oe.plugOutline_enabledSE[_e]&&(He(ne,ot.plugOutline_plugSE,_e,Nt,dt.apl_plugOutline_plugSE)&&(ne.plugOutlineFaceSE[_e].href.baseVal=ne.plugMaskShapeSE[_e].href.baseVal=ne.plugOutlineMaskShapeSE[_e].href.baseVal="#"+It.elmId,[ne.plugMaskSE[_e],ne.plugOutlineMaskSE[_e]].forEach(function(gn){gn.x.baseVal.value=It.bBox.left,gn.y.baseVal.value=It.bBox.top,gn.width.baseVal.value=It.bBox.width,gn.height.baseVal.value=It.bBox.height}),et=!0),He(ne,ot.plugOutline_colorSE,_e,ue=oe.plugOutline_colorSE[_e],dt.apl_plugOutline_colorSE)&&(ne.plugOutlineFaceSE[_e].style.fill=ue,et=!0,Ht&&(cn(ne,ne.lineMaskCaps),cn(ne,ne.lineOutlineMaskCaps))),He(ne,ot.plugOutline_strokeWidthSE,_e,ue=oe.plugOutline_strokeWidthSE[_e],dt.apl_plugOutline_strokeWidthSE)&&(ne.plugOutlineMaskShapeSE[_e].style.strokeWidth=ue+"px",et=!0),He(ne,ot.plugOutline_inStrokeWidthSE,_e,ue=oe.plugOutline_inStrokeWidthSE[_e],dt.apl_plugOutline_inStrokeWidthSE)&&(ne.plugMaskShapeSE[_e].style.strokeWidth=ue+"px",et=!0)))}),et)),(w.position||Sn.line||Sn.plug)&&(Sn.position=function(_){var w,T,k,R,V,le,te,re,j,$,me,J,K,se,fe,be,ke,Ae,pe=_.options,ne=_.curStats,ue=_.aplStats,oe=ne.position_socketXYSE,ot=!1;function dt(q,ye){var x=1===ye?{x:q.left+q.width/2,y:q.top}:2===ye?{x:q.right,y:q.top+q.height/2}:3===ye?{x:q.left+q.width/2,y:q.bottom}:{x:q.left,y:q.top+q.height/2};return x.socketId=ye,x}function et(q){return{x:q.x,y:q.y}}if(ne.position_path=pe.path,ne.position_lineStrokeWidth=ne.line_strokeWidth,ne.position_socketGravitySE=w=Ei(pe.socketGravitySE),T=[0,1].map(function(q){var ye,x,D,E=pe.anchorSE[q],M=_.optionIsAttach.anchorSE[q],I=!1!==M?Zn[E._id]:null,ee=!1!==M&&I.conf.getStrokeWidth?I.conf.getStrokeWidth(I,_):0,qe=!1!==M&&I.conf.getBBoxNest?I.conf.getBBoxNest(I,_,ee):No(E,_.baseWindow);return ne.capsMaskAnchor_pathDataSE[q]=!1!==M&&I.conf.getPathData?I.conf.getPathData(I,_,ee):(x=null!=(ye=qe).right?ye.right:ye.left+ye.width,[{type:"M",values:[ye.left,ye.top]},{type:"L",values:[x,ye.top]},{type:"L",values:[x,D=null!=ye.bottom?ye.bottom:ye.top+ye.height]},{type:"L",values:[ye.left,D]},{type:"Z",values:[]}]),ne.capsMaskAnchor_strokeWidthSE[q]=ee,qe}),te=-1,pe.socketSE[0]&&pe.socketSE[1]?(oe[0]=dt(T[0],pe.socketSE[0]),oe[1]=dt(T[1],pe.socketSE[1])):(pe.socketSE[0]||pe.socketSE[1]?(pe.socketSE[0]?(V=0,le=1):(V=1,le=0),oe[V]=dt(T[V],pe.socketSE[V]),(R=Xr.map(function(q){return dt(T[le],q)})).forEach(function(q){var ye=Jn(q,oe[V]);(ye<te||-1===te)&&(oe[le]=q,te=ye)})):(R=Xr.map(function(q){return dt(T[1],q)}),Xr.map(function(q){return dt(T[0],q)}).forEach(function(q){R.forEach(function(ye){var x=Jn(q,ye);(x<te||-1===te)&&(oe[0]=q,oe[1]=ye,te=x)})})),[0,1].forEach(function(q){var ye,x;pe.socketSE[q]||(T[q].width||T[q].height?T[q].width||4!==oe[q].socketId&&2!==oe[q].socketId?T[q].height||1!==oe[q].socketId&&3!==oe[q].socketId||(oe[q].socketId=0<=oe[q?0:1].y-T[q].top?3:1):oe[q].socketId=0<=oe[q?0:1].x-T[q].left?2:4:(ye=oe[q?0:1].x-T[q].left,x=oe[q?0:1].y-T[q].top,oe[q].socketId=Math.abs(ye)>=Math.abs(x)?0<=ye?2:4:0<=x?3:1))})),ne.position_path!==ue.position_path||ne.position_lineStrokeWidth!==ue.position_lineStrokeWidth||[0,1].some(function(q){return ne.position_plugOverheadSE[q]!==ue.position_plugOverheadSE[q]||(E=oe[q]).x!==(M=ue.position_socketXYSE[q]).x||E.y!==M.y||E.socketId!==M.socketId||(x=ue.position_socketGravitySE[q],(D=null==(ye=w[q])?"auto":Array.isArray(ye)?"array":"number")!=(null==x?"auto":Array.isArray(x)?"array":"number")||("array"===D?ye[0]!==x[0]||ye[1]!==x[1]:ye!==x));var ye,x,D,E,M})){switch(_.pathList.baseVal=k=[],_.pathList.animVal=null,ne.position_path){case 1:k.push([et(oe[0]),et(oe[1])]);break;case 2:J=Qr*("number"==typeof w[0]&&0<w[0]||"number"==typeof w[1]&&0<w[1]?-1:1),se=-(K=Math.atan2(oe[1].y-oe[0].y,oe[1].x-oe[0].x))+J,fe=Math.PI-K-J,be=Jn(oe[0],oe[1])/Math.sqrt(2)*Jr,ke={x:oe[0].x+Math.cos(se)*be,y:oe[0].y+Math.sin(se)*be*-1},Ae={x:oe[1].x+Math.cos(fe)*be,y:oe[1].y+Math.sin(fe)*be*-1},k.push([et(oe[0]),ke,Ae,et(oe[1])]);break;case 3:case 4:j=[w[0],4===ne.position_path?0:w[1]],$=[],me=[],oe.forEach(function(q,ye){var x,D,E,M,I,ee=j[ye];Array.isArray(ee)?x={x:ee[0],y:ee[1]}:"number"==typeof ee?x=1===q.socketId?{x:0,y:-ee}:2===q.socketId?{x:ee,y:0}:3===q.socketId?{x:0,y:ee}:{x:-ee,y:0}:(D=oe[ye?0:1],M=0<(E=ne.position_plugOverheadSE[ye])?120+(8<E?3.75*(E-8):0):80+(ne.position_lineStrokeWidth>4?5*(ne.position_lineStrokeWidth-4):0),1===q.socketId?((I=(q.y-D.y)/2)<M&&(I=M),x={x:0,y:-I}):2===q.socketId?((I=(D.x-q.x)/2)<M&&(I=M),x={x:I,y:0}):3===q.socketId?((I=(D.y-q.y)/2)<M&&(I=M),x={x:0,y:I}):((I=(q.x-D.x)/2)<M&&(I=M),x={x:-I,y:0})),$[ye]=q.x+x.x,me[ye]=q.y+x.y}),k.push([et(oe[0]),{x:$[0],y:me[0]},{x:$[1],y:me[1]},et(oe[1])]);break;case 5:!function(){var q,M=[[],[]],I=[];function ee(Dt){return 1===Dt?3:2===Dt?4:3===Dt?1:2}function qe(Dt){return 2===Dt||4===Dt?"x":"y"}function Ie(Dt,gt,ct){var Ut={x:Dt.x,y:Dt.y};if(ct){if(ct===ee(Dt.dirId))throw new Error("Invalid dirId: "+ct);Ut.dirId=ct}else Ut.dirId=Dt.dirId;return 1===Ut.dirId?Ut.y-=gt:2===Ut.dirId?Ut.x+=gt:3===Ut.dirId?Ut.y+=gt:Ut.x-=gt,Ut}function Ct(Dt,gt){return 1===gt.dirId?Dt.y<=gt.y:2===gt.dirId?Dt.x>=gt.x:3===gt.dirId?Dt.y>=gt.y:Dt.x<=gt.x}function fn(Dt,gt){return 1===gt.dirId||3===gt.dirId?Dt.x===gt.x:Dt.y===gt.y}function un(Dt){return Dt[0]?{contain:0,notContain:1}:{contain:1,notContain:0}}function En(Dt,gt,ct){return Math.abs(gt[ct]-Dt[ct])}function Si(Dt,gt,ct){return"x"===ct?Dt.x<gt.x?2:4:Dt.y<gt.y?3:1}function Ro(){var Dt,gt,ct,Ut,pt=[Ct(I[1],I[0]),Ct(I[0],I[1])],Wt=[qe(I[0].dirId),qe(I[1].dirId)];if(Wt[0]===Wt[1]){if(pt[0]&&pt[1])return fn(I[1],I[0])||(I[0][Wt[0]]===I[1][Wt[1]]?(M[0].push(I[0]),M[1].push(I[1])):(Dt=I[0][Wt[0]]+(I[1][Wt[1]]-I[0][Wt[0]])/2,M[0].push(Ie(I[0],Math.abs(Dt-I[0][Wt[0]]))),M[1].push(Ie(I[1],Math.abs(Dt-I[1][Wt[1]]))))),!1;pt[0]!==pt[1]?(gt=un(pt),(ct=En(I[gt.notContain],I[gt.contain],Wt[gt.notContain]))<30&&(I[gt.notContain]=Ie(I[gt.notContain],30-ct)),M[gt.notContain].push(I[gt.notContain]),I[gt.notContain]=Ie(I[gt.notContain],30,fn(I[gt.contain],I[gt.notContain])?"x"===Wt[gt.notContain]?3:2:Si(I[gt.notContain],I[gt.contain],"x"===Wt[gt.notContain]?"y":"x"))):(ct=En(I[0],I[1],"x"===Wt[0]?"y":"x"),M.forEach(function(Ln,zt){var Yi=0===zt?1:0;Ln.push(I[zt]),I[zt]=Ie(I[zt],30,60<=ct?Si(I[zt],I[Yi],"x"===Wt[zt]?"y":"x"):"x"===Wt[zt]?3:2)}))}else{if(pt[0]&&pt[1])return fn(I[1],I[0])?M[1].push(I[1]):fn(I[0],I[1])?M[0].push(I[0]):M[0].push("x"===Wt[0]?{x:I[1].x,y:I[0].y}:{x:I[0].x,y:I[1].y}),!1;pt[0]!==pt[1]?(gt=un(pt),M[gt.notContain].push(I[gt.notContain]),I[gt.notContain]=Ie(I[gt.notContain],30,En(I[gt.notContain],I[gt.contain],Wt[gt.contain])>=30?Si(I[gt.notContain],I[gt.contain],Wt[gt.contain]):I[gt.contain].dirId)):(Ut=[{x:I[0].x,y:I[0].y},{x:I[1].x,y:I[1].y}],M.forEach(function(Ln,zt){var Yi=0===zt?1:0,Vi=En(Ut[zt],Ut[Yi],Wt[zt]);Vi<30&&(I[zt]=Ie(I[zt],30-Vi)),Ln.push(I[zt]),I[zt]=Ie(I[zt],30,Si(I[zt],I[Yi],Wt[Yi]))}))}return!0}for(oe.forEach(function(Dt,gt){var ct,Ut=et(Dt),pt=w[gt];ct=Array.isArray(pt)?pt[0]<0?[4,-pt[0]]:0<pt[0]?[2,pt[0]]:pt[1]<0?[1,-pt[1]]:0<pt[1]?[3,pt[1]]:[Dt.socketId,0]:"number"!=typeof pt?[Dt.socketId,30]:0<=pt?[Dt.socketId,pt]:[ee(Dt.socketId),-pt],Ut.dirId=ct[0],pt=ct[1],M[gt].push(Ut),I[gt]=Ie(Ut,pt)});Ro(););M[1].reverse(),M[0].concat(M[1]).forEach(function(Dt,gt){var ct={x:Dt.x,y:Dt.y};0<gt&&k.push([q,ct]),q=ct})}()}re=[],ne.position_plugOverheadSE.forEach(function(q,ye){var x,D,E,M,I,ee,qe,Ie,Ct,fn,un,En=!ye;0<q?2===(x=k[D=En?0:k.length-1]).length?(re[D]=re[D]||Jn.apply(null,x),re[D]>10&&(re[D]-q<10&&(q=re[D]-10),E=Lo(x[0],x[1],(En?q:re[D]-q)/re[D]),k[D]=En?[E,x[1]]:[x[0],E],re[D]-=q)):(re[D]=re[D]||po.apply(null,x),re[D]>10&&(re[D]-q<10&&(q=re[D]-10),E=zi(x[0],x[1],x[2],x[3],Bi(x[0],x[1],x[2],x[3],En?q:re[D]-q)),En?(M=x[0],I=E.toP1):(M=x[3],I=E.fromP2),ee=Math.atan2(M.y-E.y,E.x-M.x),qe=Jn(E,I),E.x=M.x+Math.cos(ee)*q,E.y=M.y+Math.sin(ee)*q*-1,I.x=E.x+Math.cos(ee)*qe,I.y=E.y+Math.sin(ee)*qe*-1,k[D]=En?[E,E.toP1,E.toP2,x[3]]:[x[0],E.fromP1,E.fromP2,E],re[D]=null)):q<0&&(x=k[D=En?0:k.length-1],q<(un=-T[ye]["x"==(Ct=4===(Ie=oe[ye].socketId)||2===Ie?"x":"y")?"width":"height"])&&(q=un),fn=q*(4===Ie||1===Ie?-1:1),2===x.length?x[En?0:x.length-1][Ct]+=fn:(En?[0,1]:[x.length-2,x.length-1]).forEach(function(Si){x[Si][Ct]+=fn}),re[D]=null)}),ue.position_socketXYSE=Ei(oe),ue.position_plugOverheadSE=Ei(ne.position_plugOverheadSE),ue.position_path=ne.position_path,ue.position_lineStrokeWidth=ne.position_lineStrokeWidth,ue.position_socketGravitySE=Ei(w),ot=!0,_.events.apl_position&&_.events.apl_position.forEach(function(q){q(_,k)})}return ot}(_)),(w.path||Sn.position)&&(Sn.path=(x=(q=_).curStats,D=q.aplStats,M=x.path_edge,I=!1,(E=q.pathList.animVal||q.pathList.baseVal)&&(M.x1=M.x2=E[0][0].x,M.y1=M.y2=E[0][0].y,x.path_pathData=ye=gi(E,function(_e){_e.x<M.x1&&(M.x1=_e.x),_e.y<M.y1&&(M.y1=_e.y),_e.x>M.x2&&(M.x2=_e.x),_e.y>M.y2&&(M.y2=_e.y)}),Nn(ye,D.path_pathData)&&(q.linePath.setPathData(ye),D.path_pathData=ye,I=!0,Ht?(cn(q,q.plugsFace),cn(q,q.lineMaskCaps)):xn&&cn(q,q.linePath),q.events.apl_path&&q.events.apl_path.forEach(function(_e){_e(q,ye)}))),I)),Sn.viewBox=(un=(Ct=(ee=_).curStats).path_edge,En=Ct.viewBox_bBox,Si=ee.aplStats.viewBox_bBox,Ro=ee.svg.viewBox.baseVal,Dt=ee.svg.style,gt=!1,qe=Math.max(Ct.line_strokeWidth/2,Ct.viewBox_plugBCircleSE[0]||0,Ct.viewBox_plugBCircleSE[1]||0),Ie={x1:un.x1-qe,y1:un.y1-qe,x2:un.x2+qe,y2:un.y2+qe},ee.events.new_edge4viewBox&&ee.events.new_edge4viewBox.forEach(function(_e){_e(ee,Ie)}),En.x=Ct.lineMask_x=Ct.lineOutlineMask_x=Ct.maskBGRect_x=Ie.x1,En.y=Ct.lineMask_y=Ct.lineOutlineMask_y=Ct.maskBGRect_y=Ie.y1,En.width=Ie.x2-Ie.x1,En.height=Ie.y2-Ie.y1,["x","y","width","height"].forEach(function(_e){var Nt;(Nt=En[_e])!==Si[_e]&&(Ro[_e]=Si[_e]=Nt,Dt[ui[_e]]=Nt+("x"===_e||"y"===_e?ee.bodyOffset[_e]:0)+"px",gt=!0)}),gt),Sn.mask=(pt=(ct=_).curStats,Wt=ct.aplStats,Ln=!1,pt.plug_enabled?[0,1].forEach(function(_e){pt.capsMaskMarker_enabledSE[_e]=pt.plug_enabledSE[_e]&&pt.plug_colorTraSE[_e]||pt.plugOutline_enabledSE[_e]&&pt.plugOutline_colorTraSE[_e]}):pt.capsMaskMarker_enabledSE[0]=pt.capsMaskMarker_enabledSE[1]=!1,pt.capsMaskMarker_enabled=pt.capsMaskMarker_enabledSE[0]||pt.capsMaskMarker_enabledSE[1],pt.lineMask_outlineMode=pt.lineOutline_enabled,pt.caps_enabled=pt.capsMaskMarker_enabled||pt.capsMaskAnchor_enabledSE[0]||pt.capsMaskAnchor_enabledSE[1],pt.lineMask_enabled=pt.caps_enabled||pt.lineMask_outlineMode,(pt.lineMask_enabled&&!pt.lineMask_outlineMode||pt.lineOutline_enabled)&&["x","y"].forEach(function(_e){var Nt="maskBGRect_"+_e;He(ct,Wt,Nt,Ut=pt[Nt])&&(ct.maskBGRect[_e].baseVal.value=Ut,Ln=!0)}),He(ct,Wt,"lineMask_enabled",Ut=pt.lineMask_enabled)&&(ct.lineFace.style.mask=Ut?"url(#"+ct.lineMaskId+")":"none",Ln=!0,bn&&cn(ct,ct.lineMask)),pt.lineMask_enabled&&(He(ct,Wt,"lineMask_outlineMode",Ut=pt.lineMask_outlineMode)&&(Ut?(ct.lineMaskBG.style.display="none",ct.lineMaskShape.style.display="inline"):(ct.lineMaskBG.style.display="inline",ct.lineMaskShape.style.display="none"),Ln=!0),["x","y"].forEach(function(_e){var Nt="lineMask_"+_e;He(ct,Wt,Nt,Ut=pt[Nt])&&(ct.lineMask[_e].baseVal.value=Ut,Ln=!0)}),He(ct,Wt,"caps_enabled",Ut=pt.caps_enabled)&&(ct.lineMaskCaps.style.display=ct.lineOutlineMaskCaps.style.display=Ut?"inline":"none",Ln=!0,bn&&cn(ct,ct.capsMaskLine)),pt.caps_enabled&&([0,1].forEach(function(_e){var Nt;He(ct,Wt.capsMaskAnchor_enabledSE,_e,Ut=pt.capsMaskAnchor_enabledSE[_e])&&(ct.capsMaskAnchorSE[_e].style.display=Ut?"inline":"none",Ln=!0,bn&&cn(ct,ct.lineMask)),pt.capsMaskAnchor_enabledSE[_e]&&(Nn(Nt=pt.capsMaskAnchor_pathDataSE[_e],Wt.capsMaskAnchor_pathDataSE[_e])&&(ct.capsMaskAnchorSE[_e].setPathData(Nt),Wt.capsMaskAnchor_pathDataSE[_e]=Nt,Ln=!0),He(ct,Wt.capsMaskAnchor_strokeWidthSE,_e,Ut=pt.capsMaskAnchor_strokeWidthSE[_e])&&(ct.capsMaskAnchorSE[_e].style.strokeWidth=Ut+"px",Ln=!0))}),He(ct,Wt,"capsMaskMarker_enabled",Ut=pt.capsMaskMarker_enabled)&&(ct.capsMaskLine.style.display=Ut?"inline":"none",Ln=!0),pt.capsMaskMarker_enabled&&[0,1].forEach(function(_e){var Nt=pt.capsMaskMarker_plugSE[_e],It=Nt!==Yn?br[xi[Nt]]:null,en=ea(_e,It);He(ct,Wt.capsMaskMarker_enabledSE,_e,Ut=pt.capsMaskMarker_enabledSE[_e])&&(ct.capsMaskLine.style[en.prop]=Ut?"url(#"+ct.lineMaskMarkerIdSE[_e]+")":"none",Ln=!0),pt.capsMaskMarker_enabledSE[_e]&&(He(ct,Wt.capsMaskMarker_plugSE,_e,Nt)&&(ct.capsMaskMarkerShapeSE[_e].href.baseVal="#"+It.elmId,Er(ct,ct.capsMaskMarkerSE[_e],en.orient,It.bBox,ct.svg,ct.capsMaskMarkerShapeSE[_e],ct.capsMaskLine),Ln=!0,xn&&(cn(ct,ct.capsMaskLine),cn(ct,ct.lineFace))),["markerWidth","markerHeight"].forEach(function(gn){var Ar="capsMaskMarker_"+gn+"SE";He(ct,Wt[Ar],_e,Ut=pt[Ar][_e])&&(ct.capsMaskMarkerSE[_e][gn].baseVal.value=Ut,Ln=!0)}))}))),pt.lineOutline_enabled&&["x","y"].forEach(function(_e){var Nt="lineOutlineMask_"+_e;He(ct,Wt,Nt,Ut=pt[Nt])&&(ct.lineOutlineMask[_e].baseVal.value=Ut,Ln=!0)}),Ln),w.effect&&(Vi=(zt=_).curStats,Oi=zt.aplStats,Object.keys(sn).forEach(function(_e){var Nt=sn[_e],It=_e+"_enabled",en=_e+"_options",gn=Vi[en];He(zt,Oi,It,Yi=Vi[It])?(Yi&&(Oi[en]=Ei(gn)),Nt[Yi?"init":"remove"](zt)):Yi&&Dr(gn,Oi[en])&&(Nt.remove(zt),Oi[It]=!0,Oi[en]=Ei(gn),Nt.init(zt))})),(Zt||bn)&&Sn.line&&!Sn.path&&cn(_,_.lineShape),Zt&&Sn.plug&&!Sn.line&&cn(_,_.plugsFace),Fo(_)}function Po(_,w){return{duration:on(_.duration)&&0<_.duration?_.duration:w.duration,timing:Jt.validTiming(_.timing)?_.timing:Ei(w.timing)}}function $r(_,w,T,k){var R,V=_.curStats,le=_.aplStats,te={};function re(){["show_on","show_effect","show_animOptions"].forEach(function(j){le[j]=V[j]})}V.show_on=w,T&&St[T]&&(V.show_effect=T,V.show_animOptions=Po(qi(k)?k:{},St[T].defaultAnimOptions)),te.show_on=V.show_on!==le.show_on,te.show_effect=V.show_effect!==le.show_effect,te.show_animOptions=Dr(V.show_animOptions,le.show_animOptions),te.show_effect||te.show_animOptions?V.show_inAnim?(R=te.show_effect?St[le.show_effect].stop(_,!0,!0):St[le.show_effect].stop(_),re(),St[le.show_effect].init(_,R)):te.show_on&&(le.show_effect&&te.show_effect&&St[le.show_effect].stop(_,!0,!0),re(),St[le.show_effect].init(_)):te.show_on&&(re(),St[le.show_effect].start(_))}function na(_,w,T){var k={props:_,optionName:T};return!(!(_.attachments.indexOf(w)<0)||w.conf.bind&&!w.conf.bind(w,k)||(_.attachments.push(w),w.boundTargets.push(k),0))}function Do(_,w,T){var k=_.attachments.indexOf(w);-1<k&&_.attachments.splice(k,1),w.boundTargets.some(function(R,V){return R.props===_&&(w.conf.unbind&&w.conf.unbind(w,R),k=V,!0)})&&(w.boundTargets.splice(k,1),T||ir(function(){w.boundTargets.length||dr(w)}))}function Sr(_,w){var T,k,R=_.options,V={};function le(j,$,me,G,J){var K={};return me?null!=G?(K.container=j[me],K.key=G):(K.container=j,K.key=me):(K.container=j,K.key=$),K.default=J,K.acceptsAuto=null==K.default,K}function te(j,$,me,G,J,K,se){var fe,be,ke,Ae=le(j,me,J,K,se);return null!=$[me]&&(be=($[me]+"").toLowerCase())&&(Ae.acceptsAuto&&be===pr||(ke=G[be]))&&ke!==Ae.container[Ae.key]&&(Ae.container[Ae.key]=ke,fe=!0),null!=Ae.container[Ae.key]||Ae.acceptsAuto||(Ae.container[Ae.key]=Ae.default,fe=!0),fe}function re(j,$,me,G,J,K,se,fe,be){var ke,Ae,pe,ne,ue=le(j,me,J,K,se);if(!G){if(null==ue.default)throw new Error("Invalid `type`: "+me);G=typeof ue.default}return null!=$[me]&&(ue.acceptsAuto&&($[me]+"").toLowerCase()===pr||(pe=Ae=$[me],("number"===(ne=G)?on(pe):typeof pe===ne)&&(Ae=be&&"string"===G&&Ae?Ae.trim():Ae,1)&&(!fe||fe(Ae))))&&Ae!==ue.container[ue.key]&&(ue.container[ue.key]=Ae,ke=!0),null!=ue.container[ue.key]||ue.acceptsAuto||(ue.container[ue.key]=ue.default,ke=!0),ke}if(w=w||{},["start","end"].forEach(function(j,$){var me=w[j],G=!1;if(me&&(Hi(me)||(G=er(me,"anchor")))&&me!==R.anchorSE[$]){if(!1!==_.optionIsAttach.anchorSE[$]&&Do(_,Zn[R.anchorSE[$]._id]),G&&!na(_,Zn[me._id],j))throw new Error("Can't bind attachment");R.anchorSE[$]=me,_.optionIsAttach.anchorSE[$]=G,k=V.position=!0}}),!R.anchorSE[0]||!R.anchorSE[1]||R.anchorSE[0]===R.anchorSE[1])throw new Error("`start` and `end` are required.");k&&(T=function(j,$){var me,G,J;if(!(me=ho(j))||!(G=ho($)))throw new Error("Cannot get frames.");return me.length&&G.length&&(me.reverse(),G.reverse(),me.some(function(K){return G.some(function(se){return se===K&&(J=se.contentWindow,!0)})})),J||window}(!1!==_.optionIsAttach.anchorSE[0]?Zn[R.anchorSE[0]._id].element:R.anchorSE[0],!1!==_.optionIsAttach.anchorSE[1]?Zn[R.anchorSE[1]._id].element:R.anchorSE[1]))!==_.baseWindow&&(function(j,$){var me,G,J,K,se,fe,be,ke,Ae,pe,ne=j.aplStats,ue=$.document,oe=si+"-"+j._id;function ot(q){var ye=G.appendChild(ue.createElementNS(ft,"mask"));return ye.id=q,ye.maskUnits.baseVal=SVGUnitTypes.SVG_UNIT_TYPE_USERSPACEONUSE,[ye.x,ye.y,ye.width,ye.height].forEach(function(x){x.baseVal.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX,0)}),ye}function dt(q){var ye=G.appendChild(ue.createElementNS(ft,"marker"));return ye.id=q,ye.markerUnits.baseVal=SVGMarkerElement.SVG_MARKERUNITS_STROKEWIDTH,ye.viewBox.baseVal||ye.setAttribute("viewBox","0 0 0 0"),ye}function et(q){return[q.width,q.height].forEach(function(ye){ye.baseVal.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PERCENTAGE,100)}),q}j.pathList={},Qn(ne,ko),Object.keys(sn).forEach(function(q){var ye=q+"_enabled";ne[ye]&&(sn[q].remove(j),ne[ye]=!1)}),j.baseWindow&&j.svg&&j.baseWindow.document.body.removeChild(j.svg),ta(j.baseWindow=$),j.bodyOffset=hn($),j.svg=me=ue.createElementNS(ft,"svg"),me.className.baseVal=si,me.viewBox.baseVal||me.setAttribute("viewBox","0 0 0 0"),j.defs=G=me.appendChild(ue.createElementNS(ft,"defs")),j.linePath=K=G.appendChild(ue.createElementNS(ft,"path")),K.id=se=oe+"-line-path",K.className.baseVal=si+"-line-path",bn&&(K.style.fill="none"),j.lineShape=K=G.appendChild(ue.createElementNS(ft,"use")),K.id=fe=oe+"-line-shape",K.href.baseVal="#"+se,(J=G.appendChild(ue.createElementNS(ft,"g"))).id=be=oe+"-caps",j.capsMaskAnchorSE=[0,1].map(function(){var q=J.appendChild(ue.createElementNS(ft,"path"));return q.className.baseVal=si+"-caps-mask-anchor",q}),j.lineMaskMarkerIdSE=[oe+"-caps-mask-marker-0",oe+"-caps-mask-marker-1"],j.capsMaskMarkerSE=[0,1].map(function(q){return dt(j.lineMaskMarkerIdSE[q])}),j.capsMaskMarkerShapeSE=[0,1].map(function(q){var ye=j.capsMaskMarkerSE[q].appendChild(ue.createElementNS(ft,"use"));return ye.className.baseVal=si+"-caps-mask-marker-shape",ye}),j.capsMaskLine=K=J.appendChild(ue.createElementNS(ft,"use")),K.className.baseVal=si+"-caps-mask-line",K.href.baseVal="#"+fe,j.maskBGRect=K=et(G.appendChild(ue.createElementNS(ft,"rect"))),K.id=ke=oe+"-mask-bg-rect",K.className.baseVal=si+"-mask-bg-rect",bn&&(K.style.fill="white"),j.lineMask=et(ot(j.lineMaskId=oe+"-line-mask")),j.lineMaskBG=K=j.lineMask.appendChild(ue.createElementNS(ft,"use")),K.href.baseVal="#"+ke,j.lineMaskShape=K=j.lineMask.appendChild(ue.createElementNS(ft,"use")),K.className.baseVal=si+"-line-mask-shape",K.href.baseVal="#"+se,K.style.display="none",j.lineMaskCaps=K=j.lineMask.appendChild(ue.createElementNS(ft,"use")),K.href.baseVal="#"+be,j.lineOutlineMask=et(ot(Ae=oe+"-line-outline-mask")),(K=j.lineOutlineMask.appendChild(ue.createElementNS(ft,"use"))).href.baseVal="#"+ke,j.lineOutlineMaskShape=K=j.lineOutlineMask.appendChild(ue.createElementNS(ft,"use")),K.className.baseVal=si+"-line-outline-mask-shape",K.href.baseVal="#"+se,j.lineOutlineMaskCaps=K=j.lineOutlineMask.appendChild(ue.createElementNS(ft,"use")),K.href.baseVal="#"+be,j.face=me.appendChild(ue.createElementNS(ft,"g")),j.lineFace=K=j.face.appendChild(ue.createElementNS(ft,"use")),K.href.baseVal="#"+fe,j.lineOutlineFace=K=j.face.appendChild(ue.createElementNS(ft,"use")),K.href.baseVal="#"+fe,K.style.mask="url(#"+Ae+")",K.style.display="none",j.plugMaskIdSE=[oe+"-plug-mask-0",oe+"-plug-mask-1"],j.plugMaskSE=[0,1].map(function(q){return ot(j.plugMaskIdSE[q])}),j.plugMaskShapeSE=[0,1].map(function(q){var ye=j.plugMaskSE[q].appendChild(ue.createElementNS(ft,"use"));return ye.className.baseVal=si+"-plug-mask-shape",ye}),pe=[],j.plugOutlineMaskSE=[0,1].map(function(q){return ot(pe[q]=oe+"-plug-outline-mask-"+q)}),j.plugOutlineMaskShapeSE=[0,1].map(function(q){var ye=j.plugOutlineMaskSE[q].appendChild(ue.createElementNS(ft,"use"));return ye.className.baseVal=si+"-plug-outline-mask-shape",ye}),j.plugMarkerIdSE=[oe+"-plug-marker-0",oe+"-plug-marker-1"],j.plugMarkerSE=[0,1].map(function(q){var ye=dt(j.plugMarkerIdSE[q]);return bn&&(ye.markerUnits.baseVal=SVGMarkerElement.SVG_MARKERUNITS_USERSPACEONUSE),ye}),j.plugMarkerShapeSE=[0,1].map(function(q){return j.plugMarkerSE[q].appendChild(ue.createElementNS(ft,"g"))}),j.plugFaceSE=[0,1].map(function(q){return j.plugMarkerShapeSE[q].appendChild(ue.createElementNS(ft,"use"))}),j.plugOutlineFaceSE=[0,1].map(function(q){var ye=j.plugMarkerShapeSE[q].appendChild(ue.createElementNS(ft,"use"));return ye.style.mask="url(#"+pe[q]+")",ye.style.display="none",ye}),j.plugsFace=K=j.face.appendChild(ue.createElementNS(ft,"use")),K.className.baseVal=si+"-plugs-face",K.href.baseVal="#"+fe,K.style.display="none",j.curStats.show_inAnim?(j.isShown=1,St[ne.show_effect].stop(j,!0)):j.isShown||(me.style.visibility="hidden"),ue.body.appendChild(me),[0,1,2].forEach(function(q){var ye,x=j.options.labelSEM[q];x&&er(x,"label")&&(ye=Zn[x._id]).conf.initSvg&&ye.conf.initSvg(ye,j)})}(_,T),V.line=V.plug=V.lineOutline=V.plugOutline=V.faces=V.effect=!0),V.position=te(R,w,"path",Io,null,null,Xn.path)||V.position,V.position=te(R,w,"startSocket",lo,"socketSE",0)||V.position,V.position=te(R,w,"endSocket",lo,"socketSE",1)||V.position,[w.startSocketGravity,w.endSocketGravity].forEach(function(j,$){var me,G,J=!1;null!=j&&(Array.isArray(j)?on(j[0])&&on(j[1])&&(J=[j[0],j[1]],Array.isArray(R.socketGravitySE[$])&&(me=J).length===(G=R.socketGravitySE[$]).length&&me.every(function(K,se){return K===G[se]})&&(J=!1)):((j+"").toLowerCase()===pr?J=null:on(j)&&0<=j&&(J=j),J===R.socketGravitySE[$]&&(J=!1)),!1!==J&&(R.socketGravitySE[$]=J,V.position=!0))}),V.line=re(R,w,"color",null,"lineColor",null,Xn.lineColor,null,!0)||V.line,V.line=re(R,w,"size",null,"lineSize",null,Xn.lineSize,function(j){return 0<j})||V.line,["startPlug","endPlug"].forEach(function(j,$){V.plug=te(R,w,j,Ko,"plugSE",$,Xn.plugSE[$])||V.plug,V.plug=re(R,w,j+"Color","string","plugColorSE",$,null,null,!0)||V.plug,V.plug=re(R,w,j+"Size",null,"plugSizeSE",$,Xn.plugSizeSE[$],function(me){return 0<me})||V.plug}),V.lineOutline=re(R,w,"outline",null,"lineOutlineEnabled",null,Xn.lineOutlineEnabled)||V.lineOutline,V.lineOutline=re(R,w,"outlineColor",null,"lineOutlineColor",null,Xn.lineOutlineColor,null,!0)||V.lineOutline,V.lineOutline=re(R,w,"outlineSize",null,"lineOutlineSize",null,Xn.lineOutlineSize,function(j){return 0<j&&j<=.48})||V.lineOutline,["startPlugOutline","endPlugOutline"].forEach(function(j,$){V.plugOutline=re(R,w,j,null,"plugOutlineEnabledSE",$,Xn.plugOutlineEnabledSE[$])||V.plugOutline,V.plugOutline=re(R,w,j+"Color","string","plugOutlineColorSE",$,null,null,!0)||V.plugOutline,V.plugOutline=re(R,w,j+"Size",null,"plugOutlineSizeSE",$,Xn.plugOutlineSizeSE[$],function(me){return 1<=me})||V.plugOutline}),["startLabel","endLabel","middleLabel"].forEach(function(j,$){var me,G,J,K=w[j],se=R.labelSEM[$]&&!_.optionIsAttach.labelSEM[$]?Zn[R.labelSEM[$]._id].text:R.labelSEM[$],fe=!1;if((me="string"==typeof K)&&(K=K.trim()),(me||K&&(fe=er(K,"label")))&&K!==se){if(R.labelSEM[$]&&(Do(_,Zn[R.labelSEM[$]._id]),R.labelSEM[$]=""),K){if(fe?(G=Zn[(J=K)._id]).boundTargets.slice().forEach(function(be){G.conf.removeOption(G,be)}):J=new mn(st.captionLabel,[K]),!na(_,Zn[J._id],j))throw new Error("Can't bind attachment");R.labelSEM[$]=J}_.optionIsAttach.labelSEM[$]=fe}}),Object.keys(sn).forEach(function(j){var $,me,G=sn[j],J=j+"_enabled",K=j+"_options";function se(be){var ke={};return G.optionsConf.forEach(function(Ae){var pe=Ae[0],ne=Ae[3];null==Ae[4]||ke[ne]||(ke[ne]=[]),("function"==typeof pe?pe:"id"===pe?te:re).apply(null,[ke,be].concat(Ae.slice(1)))}),ke}function fe(be){var ke,Ae=j+"_animOptions";return be.hasOwnProperty("animation")?qi(be.animation)?ke=_.curStats[Ae]=Po(be.animation,G.defaultAnimOptions):_.curStats[Ae]=(ke=!!be.animation)?Po({},G.defaultAnimOptions):null:_.curStats[Ae]=(ke=!!G.defaultEnabled)?Po({},G.defaultAnimOptions):null,ke}w.hasOwnProperty(j)&&(qi($=w[j])?(_.curStats[J]=!0,me=_.curStats[K]=se($),G.anim&&(_.curStats[K].animation=fe($))):(me=_.curStats[J]=!!$)&&(_.curStats[K]=se({}),G.anim&&(_.curStats[K].animation=fe({}))),Dr(me,R[j])&&(R[j]=me,V.effect=!0))}),_i(_,V)}function Ti(_,w,T){var k={options:{anchorSE:[],socketSE:[],socketGravitySE:[],plugSE:[],plugColorSE:[],plugSizeSE:[],plugOutlineEnabledSE:[],plugOutlineColorSE:[],plugOutlineSizeSE:[],labelSEM:["","",""]},optionIsAttach:{anchorSE:[!1,!1],labelSEM:[!1,!1,!1]},curStats:{},aplStats:{},attachments:[],events:{},reflowTargets:[]};Qn(k.curStats,ko),Qn(k.aplStats,ko),Object.keys(sn).forEach(function(R){var V=sn[R].stats;Qn(k.curStats,V),Qn(k.aplStats,V),k.options[R]=!1}),Qn(k.curStats,fs),Qn(k.aplStats,fs),k.curStats.show_effect=gs,k.curStats.show_animOptions=Ei(St[gs].defaultAnimOptions),Object.defineProperty(this,"_id",{value:++Ba}),k._id=this._id,li[this._id]=k,1===arguments.length&&(T=_,_=null),T=T||{},(_||w)&&(T=Ei(T),_&&(T.start=_),w&&(T.end=w)),k.isShown=k.aplStats.show_on=!T.hide,this.setOptions(T)}sn={dash:{stats:{dash_len:{},dash_gap:{},dash_maxOffset:{}},anim:!0,defaultAnimOptions:{duration:1e3,timing:"linear"},optionsConf:[["type","len","number",null,null,null,function(_){return 0<_}],["type","gap","number",null,null,null,function(_){return 0<_}]],init:function(_){Gn(_,"apl_line_strokeWidth",sn.dash.update),_.lineFace.style.strokeDashoffset=0,sn.dash.update(_)},remove:function(_){var w=_.curStats;qn(_,"apl_line_strokeWidth",sn.dash.update),w.dash_animId&&(Jt.remove(w.dash_animId),w.dash_animId=null),_.lineFace.style.strokeDasharray="none",_.lineFace.style.strokeDashoffset=0,Qn(_.aplStats,sn.dash.stats)},update:function(_){var w,T=_.curStats,k=_.aplStats,R=k.dash_options,V=!1;T.dash_len=R.len||2*k.line_strokeWidth,T.dash_gap=R.gap||k.line_strokeWidth,T.dash_maxOffset=T.dash_len+T.dash_gap,V=He(_,k,"dash_len",T.dash_len)||V,(V=He(_,k,"dash_gap",T.dash_gap)||V)&&(_.lineFace.style.strokeDasharray=k.dash_len+","+k.dash_gap),T.dash_animOptions?(V=He(_,k,"dash_maxOffset",T.dash_maxOffset),k.dash_animOptions&&(V||Dr(T.dash_animOptions,k.dash_animOptions))&&(T.dash_animId&&(w=Jt.stop(T.dash_animId),Jt.remove(T.dash_animId)),k.dash_animOptions=null),k.dash_animOptions||(T.dash_animId=Jt.add(function(le){return(1-le)*k.dash_maxOffset+"px"},function(le){_.lineFace.style.strokeDashoffset=le},T.dash_animOptions.duration,0,T.dash_animOptions.timing,!1,w),k.dash_animOptions=Ei(T.dash_animOptions))):k.dash_animOptions&&(T.dash_animId&&(Jt.remove(T.dash_animId),T.dash_animId=null),_.lineFace.style.strokeDashoffset=0,k.dash_animOptions=null)}},gradient:{stats:{gradient_colorSE:{hasSE:!0},gradient_pointSE:{hasSE:!0,hasProps:!0}},optionsConf:[["type","startColor","string","colorSE",0,null,null,!0],["type","endColor","string","colorSE",1,null,null,!0]],init:function(_){var w,T=_.baseWindow.document,R=si+"-"+_._id+"-gradient";_.efc_gradient_gradient=w=_.defs.appendChild(T.createElementNS(ft,"linearGradient")),w.id=R,w.gradientUnits.baseVal=SVGUnitTypes.SVG_UNIT_TYPE_USERSPACEONUSE,[w.x1,w.y1,w.x2,w.y2].forEach(function(V){V.baseVal.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX,0)}),_.efc_gradient_stopSE=[0,1].map(function(V){var le=_.efc_gradient_gradient.appendChild(T.createElementNS(ft,"stop"));try{le.offset.baseVal=V}catch(te){if(te.code!==DOMException.NO_MODIFICATION_ALLOWED_ERR)throw te;le.setAttribute("offset",V)}return le}),Gn(_,"cur_plug_colorSE",sn.gradient.update),Gn(_,"apl_path",sn.gradient.update),_.curStats.line_altColor=!0,_.lineFace.style.stroke="url(#"+R+")",sn.gradient.update(_)},remove:function(_){_.efc_gradient_gradient&&(_.defs.removeChild(_.efc_gradient_gradient),_.efc_gradient_gradient=_.efc_gradient_stopSE=null),qn(_,"cur_plug_colorSE",sn.gradient.update),qn(_,"apl_path",sn.gradient.update),_.curStats.line_altColor=!1,_.lineFace.style.stroke=_.curStats.line_color,Qn(_.aplStats,sn.gradient.stats)},update:function(_){var w,T,k=_.curStats,R=_.aplStats,V=R.gradient_options,le=_.pathList.animVal||_.pathList.baseVal;[0,1].forEach(function(te){k.gradient_colorSE[te]=V.colorSE[te]||k.plug_colorSE[te]}),k.gradient_pointSE[0]={x:(T=le[0][0]).x,y:T.y},T=(w=le[le.length-1])[w.length-1],k.gradient_pointSE[1]={x:T.x,y:T.y},[0,1].forEach(function(te){var re;He(_,R.gradient_colorSE,te,re=k.gradient_colorSE[te])&&(bn?(re=nr(re),_.efc_gradient_stopSE[te].style.stopColor=re[1],_.efc_gradient_stopSE[te].style.stopOpacity=re[0]):_.efc_gradient_stopSE[te].style.stopColor=re),["x","y"].forEach(function(j){(re=k.gradient_pointSE[te][j])!==R.gradient_pointSE[te][j]&&(_.efc_gradient_gradient[j+(te+1)].baseVal.value=R.gradient_pointSE[te][j]=re)})})}},dropShadow:{stats:{dropShadow_dx:{},dropShadow_dy:{},dropShadow_blur:{},dropShadow_color:{},dropShadow_opacity:{},dropShadow_x:{},dropShadow_y:{}},optionsConf:[["type","dx",null,null,null,2],["type","dy",null,null,null,4],["type","blur",null,null,null,3,function(_){return 0<=_}],["type","color",null,null,null,"#000",null,!0],["type","opacity",null,null,null,.8,function(_){return 0<=_&&_<=1}]],init:function(_){var w,T,k,R,V,te=_.defs,re=si+"-"+_._id+"-dropShadow",j=(w=_.baseWindow.document,T=re,V={},"boolean"!=typeof To&&(To=!!window.SVGFEDropShadowElement&&!bn),V.elmsAppend=[V.elmFilter=k=w.createElementNS(ft,"filter")],k.filterUnits.baseVal=SVGUnitTypes.SVG_UNIT_TYPE_USERSPACEONUSE,k.x.baseVal.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX,0),k.y.baseVal.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX,0),k.width.baseVal.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PERCENTAGE,100),k.height.baseVal.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PERCENTAGE,100),k.id=T,To?(V.elmOffset=V.elmBlur=R=k.appendChild(w.createElementNS(ft,"feDropShadow")),V.styleFlood=R.style):(V.elmBlur=k.appendChild(w.createElementNS(ft,"feGaussianBlur")),V.elmOffset=R=k.appendChild(w.createElementNS(ft,"feOffset")),R.result.baseVal="offsetblur",R=k.appendChild(w.createElementNS(ft,"feFlood")),V.styleFlood=R.style,(R=k.appendChild(w.createElementNS(ft,"feComposite"))).in2.baseVal="offsetblur",R.operator.baseVal=SVGFECompositeElement.SVG_FECOMPOSITE_OPERATOR_IN,(R=k.appendChild(w.createElementNS(ft,"feMerge"))).appendChild(w.createElementNS(ft,"feMergeNode")),R.appendChild(w.createElementNS(ft,"feMergeNode")).in1.baseVal="SourceGraphic"),V);["elmFilter","elmOffset","elmBlur","styleFlood","elmsAppend"].forEach(function($){_["efc_dropShadow_"+$]=j[$]}),j.elmsAppend.forEach(function($){te.appendChild($)}),_.face.setAttribute("filter","url(#"+re+")"),Gn(_,"new_edge4viewBox",sn.dropShadow.adjustEdge),sn.dropShadow.update(_)},remove:function(_){var w=_.defs;_.efc_dropShadow_elmsAppend&&(_.efc_dropShadow_elmsAppend.forEach(function(T){w.removeChild(T)}),_.efc_dropShadow_elmFilter=_.efc_dropShadow_elmOffset=_.efc_dropShadow_elmBlur=_.efc_dropShadow_styleFlood=_.efc_dropShadow_elmsAppend=null),qn(_,"new_edge4viewBox",sn.dropShadow.adjustEdge),_i(_,{}),_.face.removeAttribute("filter"),Qn(_.aplStats,sn.dropShadow.stats)},update:function(_){var w,T,k=_.curStats,R=_.aplStats,V=R.dropShadow_options;k.dropShadow_dx=w=V.dx,He(_,R,"dropShadow_dx",w)&&(_.efc_dropShadow_elmOffset.dx.baseVal=w,T=!0),k.dropShadow_dy=w=V.dy,He(_,R,"dropShadow_dy",w)&&(_.efc_dropShadow_elmOffset.dy.baseVal=w,T=!0),k.dropShadow_blur=w=V.blur,He(_,R,"dropShadow_blur",w)&&(_.efc_dropShadow_elmBlur.setStdDeviation(w,w),T=!0),T&&_i(_,{}),k.dropShadow_color=w=V.color,He(_,R,"dropShadow_color",w)&&(_.efc_dropShadow_styleFlood.floodColor=w),k.dropShadow_opacity=w=V.opacity,He(_,R,"dropShadow_opacity",w)&&(_.efc_dropShadow_styleFlood.floodOpacity=w)},adjustEdge:function(_,w){var T,k,R=_.curStats,V=_.aplStats;null!=R.dropShadow_dx&&((k={x1:w.x1-(T=3*R.dropShadow_blur)+R.dropShadow_dx,y1:w.y1-T+R.dropShadow_dy,x2:w.x2+T+R.dropShadow_dx,y2:w.y2+T+R.dropShadow_dy}).x1<w.x1&&(w.x1=k.x1),k.y1<w.y1&&(w.y1=k.y1),k.x2>w.x2&&(w.x2=k.x2),k.y2>w.y2&&(w.y2=k.y2),["x","y"].forEach(function(le){var te,re="dropShadow_"+le;R[re]=te=w[le+"1"],He(_,V,re,te)&&(_.efc_dropShadow_elmFilter[le].baseVal.value=te)}))}}},Object.keys(sn).forEach(function(_){var w=sn[_],T=w.stats;T[_+"_enabled"]={iniValue:!1},T[_+"_options"]={hasProps:!0},w.anim&&(T[_+"_animOptions"]={},T[_+"_animId"]={})}),St={none:{defaultAnimOptions:{},init:function(_,w){var T=_.curStats;T.show_animId&&(Jt.remove(T.show_animId),T.show_animId=null),St.none.start(_,w)},start:function(_,w){St.none.stop(_,!0)},stop:function(_,w,T){return T=null!=T?T:_.aplStats.show_on,_.curStats.show_inAnim=!1,w&&Kr(_,T),T?1:0}},fade:{defaultAnimOptions:{duration:300,timing:"linear"},init:function(_,w){var T=_.curStats,k=_.aplStats;T.show_animId&&Jt.remove(T.show_animId),T.show_animId=Jt.add(function(R){return R},function(R,V){V?St.fade.stop(_,!0):(_.svg.style.opacity=R+"",Ht&&(cn(_,_.svg),Fo(_)))},k.show_animOptions.duration,1,k.show_animOptions.timing,null,!1),St.fade.start(_,w)},start:function(_,w){var T,k=_.curStats;k.show_inAnim&&(T=Jt.stop(k.show_animId)),Kr(_,1),k.show_inAnim=!0,Jt.start(k.show_animId,!_.aplStats.show_on,null!=w?w:T)},stop:function(_,w,T){var k,R=_.curStats;return T=null!=T?T:_.aplStats.show_on,k=R.show_inAnim?Jt.stop(R.show_animId):T?1:0,R.show_inAnim=!1,w&&(_.svg.style.opacity=T?"":"0",Kr(_,T)),k}},draw:{defaultAnimOptions:{duration:500,timing:[.58,0,.42,1]},init:function(_,w){var T=_.curStats,k=_.aplStats,R=_.pathList.baseVal,V=$o(R),le=V.segsLen,te=V.lenAll;T.show_animId&&Jt.remove(T.show_animId),T.show_animId=Jt.add(function(re){var j,$,me,G,J=-1;if(0===re)$=[[R[0][0],R[0][0]]];else if(1===re)$=R;else{for(j=te*re,$=[];j>=le[++J];)$.push(R[J]),j-=le[J];j&&(2===(me=R[J]).length?$.push([me[0],Lo(me[0],me[1],j/le[J])]):(G=zi(me[0],me[1],me[2],me[3],Bi(me[0],me[1],me[2],me[3],j)),$.push([me[0],G.fromP1,G.fromP2,G])))}return $},function(re,j){j?St.draw.stop(_,!0):(_.pathList.animVal=re,_i(_,{path:!0}))},k.show_animOptions.duration,1,k.show_animOptions.timing,null,!1),St.draw.start(_,w)},start:function(_,w){var T,k=_.curStats;k.show_inAnim&&(T=Jt.stop(k.show_animId)),Kr(_,1),k.show_inAnim=!0,Gn(_,"apl_position",St.draw.update),Jt.start(k.show_animId,!_.aplStats.show_on,null!=w?w:T)},stop:function(_,w,T){var k,R=_.curStats;return T=null!=T?T:_.aplStats.show_on,k=R.show_inAnim?Jt.stop(R.show_animId):T?1:0,R.show_inAnim=!1,w&&(_.pathList.animVal=T?null:[[_.pathList.baseVal[0][0],_.pathList.baseVal[0][0]]],_i(_,{path:!0}),Kr(_,T)),k},update:function(_){qn(_,"apl_position",St.draw.update),_.curStats.show_inAnim?St.draw.init(_,St.draw.stop(_)):_.aplStats.show_animOptions={}}}},function(){function _(w){return function(T){var k={};k[w]=T,this.setOptions(k)}}[["start","anchorSE",0],["end","anchorSE",1],["color","lineColor"],["size","lineSize"],["startSocketGravity","socketGravitySE",0],["endSocketGravity","socketGravitySE",1],["startPlugColor","plugColorSE",0],["endPlugColor","plugColorSE",1],["startPlugSize","plugSizeSE",0],["endPlugSize","plugSizeSE",1],["outline","lineOutlineEnabled"],["outlineColor","lineOutlineColor"],["outlineSize","lineOutlineSize"],["startPlugOutline","plugOutlineEnabledSE",0],["endPlugOutline","plugOutlineEnabledSE",1],["startPlugOutlineColor","plugOutlineColorSE",0],["endPlugOutlineColor","plugOutlineColorSE",1],["startPlugOutlineSize","plugOutlineSizeSE",0],["endPlugOutlineSize","plugOutlineSizeSE",1]].forEach(function(w){var T=w[0],k=w[1],R=w[2];Object.defineProperty(Ti.prototype,T,{get:function(){var V=null!=R?li[this._id].options[k][R]:k?li[this._id].options[k]:li[this._id].options[T];return null==V?pr:Ei(V)},set:_(T),enumerable:!0})}),[["path",Io],["startSocket",lo,"socketSE",0],["endSocket",lo,"socketSE",1],["startPlug",Ko,"plugSE",0],["endPlug",Ko,"plugSE",1]].forEach(function(w){var T=w[0],k=w[1],R=w[2],V=w[3];Object.defineProperty(Ti.prototype,T,{get:function(){var le,te=null!=V?li[this._id].options[R][V]:R?li[this._id].options[R]:li[this._id].options[T];return te?Object.keys(k).some(function(re){return k[re]===te&&(le=re,!0)})?le:new Error("It's broken"):pr},set:_(T),enumerable:!0})}),Object.keys(sn).forEach(function(w){var T=sn[w];Object.defineProperty(Ti.prototype,w,{get:function(){var k,R,V=li[this._id].options[w];return qi(V)?(k=V,R=T.optionsConf.reduce(function(le,te){var re,$=te[1],me=te[2],G=te[3],J=te[4],K=null!=J?k[G][J]:G?k[G]:k[$];return le[$]="id"===te[0]?K?Object.keys(me).some(function(se){return me[se]===K&&(re=se,!0)})?re:new Error("It's broken"):pr:null==K?pr:Ei(K),le},{}),T.anim&&(R.animation=Ei(k.animation)),R):V},set:_(w),enumerable:!0})}),["startLabel","endLabel","middleLabel"].forEach(function(w,T){Object.defineProperty(Ti.prototype,w,{get:function(){var k=li[this._id],R=k.options;return R.labelSEM[T]&&!k.optionIsAttach.labelSEM[T]?Zn[R.labelSEM[T]._id].text:R.labelSEM[T]||""},set:_(w),enumerable:!0})})}(),Ti.prototype.setOptions=function(_){return Sr(li[this._id],_),this},Ti.prototype.position=function(){return _i(li[this._id],{position:!0}),this},Ti.prototype.remove=function(){var _=li[this._id],w=_.curStats;Object.keys(sn).forEach(function(T){var k=T+"_animId";w[k]&&Jt.remove(w[k])}),w.show_animId&&Jt.remove(w.show_animId),_.attachments.slice().forEach(function(T){Do(_,T)}),_.baseWindow&&_.svg&&_.baseWindow.document.body.removeChild(_.svg),delete li[this._id]},Ti.prototype.show=function(_,w){return $r(li[this._id],!0,_,w),this},Ti.prototype.hide=function(_,w){return $r(li[this._id],!1,_,w),this},dr=function(_){_&&Zn[_._id]&&(_.boundTargets.slice().forEach(function(w){Do(w.props,_,!0)}),_.conf.remove&&_.conf.remove(_),delete Zn[_._id])},mn=function(){function _(w,T){var k,R={conf:w,curStats:{},aplStats:{},boundTargets:[]},V={};w.argOptions.every(function(le){return!(!T.length||("string"==typeof le.type?typeof T[0]!==le.type:"function"!=typeof le.type||!le.type(T[0]))||(V[le.optionName]=T.shift(),0))}),k=T.length&&qi(T[0])?Ei(T[0]):{},Object.keys(V).forEach(function(le){k[le]=V[le]}),w.stats&&(Qn(R.curStats,w.stats),Qn(R.aplStats,w.stats)),Object.defineProperty(this,"_id",{value:++Va}),Object.defineProperty(this,"isRemoved",{get:function(){return!Zn[this._id]}}),R._id=this._id,w.init&&!w.init(R,k)||(Zn[this._id]=R)}return _.prototype.remove=function(){var w=this,T=Zn[w._id];T&&(T.boundTargets.slice().forEach(function(k){T.conf.removeOption(T,k)}),ir(function(){var k=Zn[w._id];k&&(console.error("LeaderLineAttachment was not removed by removeOption"),dr(k))}))},_}(),window.LeaderLineAttachment=mn,er=function(_,w){return _ instanceof mn&&(!(_.isRemoved||w&&Zn[_._id].conf.type!==w)||null)},st={pointAnchor:{type:"anchor",argOptions:[{optionName:"element",type:Hi}],init:function(_,w){return _.element=st.pointAnchor.checkElement(w.element),_.x=st.pointAnchor.parsePercent(w.x,!0)||[.5,!0],_.y=st.pointAnchor.parsePercent(w.y,!0)||[.5,!0],!0},removeOption:function(_,w){var T=w.props,k={},R=_.element,V=T.options.anchorSE["start"===w.optionName?1:0];R===V&&(R=V===document.body?new mn(st.pointAnchor,[R]):document.body),k[w.optionName]=R,Sr(T,k)},getBBoxNest:function(_,w){var T=No(_.element,w.baseWindow),k=T.width,R=T.height;return T.width=T.height=0,T.left=T.right=T.left+_.x[0]*(_.x[1]?k:1),T.top=T.bottom=T.top+_.y[0]*(_.y[1]?R:1),T},parsePercent:function(_,w){var T,k,R=!1;return on(_)?k=_:"string"==typeof _&&(T=Ra.exec(_))&&T[2]&&(R=0!=(k=parseFloat(T[1])/100)),null!=k&&(w||0<=k)?[k,R]:null},checkElement:function(_){if(null==_)_=document.body;else if(!Hi(_))throw new Error("`element` must be Element");return _}},areaAnchor:{type:"anchor",argOptions:[{optionName:"element",type:Hi},{optionName:"shape",type:"string"}],stats:{color:{},strokeWidth:{},elementWidth:{},elementHeight:{},elementLeft:{},elementTop:{},pathListRel:{},bBoxRel:{},pathData:{},viewBoxBBox:{hasProps:!0},dashLen:{},dashGap:{}},init:function(_,w){var T,k,R,V=[];return _.element=st.pointAnchor.checkElement(w.element),"string"==typeof w.color&&(_.color=w.color.trim()),"string"==typeof w.fillColor&&(_.fill=w.fillColor.trim()),on(w.size)&&0<=w.size&&(_.size=w.size),w.dash&&(_.dash=!0,on(w.dash.len)&&0<w.dash.len&&(_.dashLen=w.dash.len),on(w.dash.gap)&&0<w.dash.gap&&(_.dashGap=w.dash.gap)),"circle"===w.shape?_.shape=w.shape:"polygon"===w.shape&&Array.isArray(w.points)&&3<=w.points.length&&w.points.every(function(le){var te={};return!(!(te.x=st.pointAnchor.parsePercent(le[0],!0))||!(te.y=st.pointAnchor.parsePercent(le[1],!0))||(V.push(te),(te.x[1]||te.y[1])&&(_.hasRatio=!0),0))})?(_.shape=w.shape,_.points=V):(_.shape="rect",_.radius=on(w.radius)&&0<=w.radius?w.radius:0),"rect"!==_.shape&&"circle"!==_.shape||(_.x=st.pointAnchor.parsePercent(w.x,!0)||[-.05,!0],_.y=st.pointAnchor.parsePercent(w.y,!0)||[-.05,!0],_.width=st.pointAnchor.parsePercent(w.width)||[1.1,!0],_.height=st.pointAnchor.parsePercent(w.height)||[1.1,!0],(_.x[1]||_.y[1]||_.width[1]||_.height[1])&&(_.hasRatio=!0)),_.svg=k=(T=_.element.ownerDocument).createElementNS(ft,"svg"),k.className.baseVal=si+"-areaAnchor",k.viewBox.baseVal||k.setAttribute("viewBox","0 0 0 0"),_.path=k.appendChild(T.createElementNS(ft,"path")),_.path.style.fill=_.fill||"none",_.isShown=!1,k.style.visibility="hidden",T.body.appendChild(k),ta(R=T.defaultView),_.bodyOffset=hn(R),_.updateColor=function(){var le,re=_.aplStats,j=_.boundTargets.length?_.boundTargets[0].props.curStats:null;_.curStats.color=le=_.color||(j?j.line_color:Xn.lineColor),He(_,re,"color",le)&&(_.path.style.stroke=le)},_.updateShow=function(){Kr(_,_.boundTargets.some(function(le){return!0===le.props.isShown}))},!0},bind:function(_,w){var T=w.props;return _.color||Gn(T,"cur_line_color",_.updateColor),Gn(T,"svgShow",_.updateShow),ir(function(){_.updateColor(),_.updateShow()}),!0},unbind:function(_,w){var T=w.props;_.color||qn(T,"cur_line_color",_.updateColor),qn(T,"svgShow",_.updateShow),1<_.boundTargets.length&&ir(function(){_.updateColor(),_.updateShow(),st.areaAnchor.update(_)&&_.boundTargets.forEach(function(k){_i(k.props,{position:!0})})})},removeOption:function(_,w){st.pointAnchor.removeOption(_,w)},remove:function(_){_.boundTargets.length&&(console.error("LeaderLineAttachment was not unbound by remove"),_.boundTargets.forEach(function(w){st.areaAnchor.unbind(_,w)})),_.svg.parentNode.removeChild(_.svg)},getStrokeWidth:function(_,w){return st.areaAnchor.update(_)&&1<_.boundTargets.length&&ir(function(){_.boundTargets.forEach(function(T){T.props!==w&&_i(T.props,{position:!0})})}),_.curStats.strokeWidth},getPathData:function(_,w){var T=No(_.element,w.baseWindow);return gi(_.curStats.pathListRel,function(k){k.x+=T.left,k.y+=T.top})},getBBoxNest:function(_,w){var T=No(_.element,w.baseWindow),k=_.curStats.bBoxRel;return{left:k.left+T.left,top:k.top+T.top,right:k.right+T.left,bottom:k.bottom+T.top,width:k.width,height:k.height}},update:function(_){var w,T,k,R,V,le,te,re,j,$,me,G,J,K,se,fe,be,ke,Ae,pe,ne,ue,oe,ot,dt,et,q,ye,x,D,E,M,I=_.curStats,ee=_.aplStats,qe=_.boundTargets.length?_.boundTargets[0].props.curStats:null,Ie={};if(Ie.strokeWidth=He(_,I,"strokeWidth",null!=_.size?_.size:qe?qe.line_strokeWidth:Xn.lineSize),w=Rr(_.element),Ie.elementWidth=He(_,I,"elementWidth",w.width),Ie.elementHeight=He(_,I,"elementHeight",w.height),Ie.elementLeft=He(_,I,"elementLeft",w.left),Ie.elementTop=He(_,I,"elementTop",w.top),Ie.strokeWidth||_.hasRatio&&(Ie.elementWidth||Ie.elementHeight)){switch(_.shape){case"rect":(pe={left:_.x[0]*(_.x[1]?w.width:1),top:_.y[0]*(_.y[1]?w.height:1),width:_.width[0]*(_.width[1]?w.width:1),height:_.height[0]*(_.height[1]?w.height:1)}).right=pe.left+pe.width,pe.bottom=pe.top+pe.height,ot=I.strokeWidth/2,ue=(oe=Math.min(pe.width,pe.height))?oe/2*Math.SQRT2+ot:0,(ne=_.radius?_.radius<=ue?_.radius:ue:0)?(et=ne-(dt=(ne-ot)/Math.SQRT2),I.pathListRel=[[(q=[{x:pe.left-et,y:pe.top+dt},{x:pe.left+dt,y:pe.top-et},{x:pe.right-dt,y:pe.top-et},{x:pe.right+et,y:pe.top+dt},{x:pe.right+et,y:pe.bottom-dt},{x:pe.right-dt,y:pe.bottom+et},{x:pe.left+dt,y:pe.bottom+et},{x:pe.left-et,y:pe.bottom-dt}])[0],{x:q[0].x,y:q[0].y-(ye=ne*Jr)},{x:q[1].x-ye,y:q[1].y},q[1]]],q[1].x!==q[2].x&&I.pathListRel.push([q[1],q[2]]),I.pathListRel.push([q[2],{x:q[2].x+ye,y:q[2].y},{x:q[3].x,y:q[3].y-ye},q[3]]),q[3].y!==q[4].y&&I.pathListRel.push([q[3],q[4]]),I.pathListRel.push([q[4],{x:q[4].x,y:q[4].y+ye},{x:q[5].x+ye,y:q[5].y},q[5]]),q[5].x!==q[6].x&&I.pathListRel.push([q[5],q[6]]),I.pathListRel.push([q[6],{x:q[6].x-ye,y:q[6].y},{x:q[7].x,y:q[7].y+ye},q[7]]),q[7].y!==q[0].y&&I.pathListRel.push([q[7],q[0]]),I.pathListRel.push([]),q=[{x:pe.left-(et=ne-dt+I.strokeWidth/2),y:pe.top-et},{x:pe.right+et,y:pe.bottom+et}]):(I.pathListRel=[[(q=[{x:pe.left-(et=I.strokeWidth/2),y:pe.top-et},{x:pe.right+et,y:pe.bottom+et}])[0],{x:q[1].x,y:q[0].y}],[{x:q[1].x,y:q[0].y},q[1]],[q[1],{x:q[0].x,y:q[1].y}],[]],q=[{x:pe.left-I.strokeWidth,y:pe.top-I.strokeWidth},{x:pe.right+I.strokeWidth,y:pe.bottom+I.strokeWidth}]),I.bBoxRel={left:q[0].x,top:q[0].y,right:q[1].x,bottom:q[1].y,width:q[1].x-q[0].x,height:q[1].y-q[0].y};break;case"circle":(te={left:_.x[0]*(_.x[1]?w.width:1),top:_.y[0]*(_.y[1]?w.height:1),width:_.width[0]*(_.width[1]?w.width:1),height:_.height[0]*(_.height[1]?w.height:1)}).width||te.height||(te.width=te.height=10),te.width||(te.width=te.height),te.height||(te.height=te.width),te.right=te.left+te.width,te.bottom=te.top+te.height,re=te.left+te.width/2,j=te.top+te.height/2,K=I.strokeWidth/2,fe=te.height/2,$=(se=te.width/2)*Math.SQRT2+K,me=fe*Math.SQRT2+K,I.pathListRel=[[(Ae=[{x:re-$,y:j},{x:re,y:j-me},{x:re+$,y:j},{x:re,y:j+me}])[0],{x:Ae[0].x,y:Ae[0].y-(J=me*Jr)},{x:Ae[1].x-(G=$*Jr),y:Ae[1].y},Ae[1]],[Ae[1],{x:Ae[1].x+G,y:Ae[1].y},{x:Ae[2].x,y:Ae[2].y-J},Ae[2]],[Ae[2],{x:Ae[2].x,y:Ae[2].y+J},{x:Ae[3].x+G,y:Ae[3].y},Ae[3]],[Ae[3],{x:Ae[3].x-G,y:Ae[3].y},{x:Ae[0].x,y:Ae[0].y+J},Ae[0]],[]],I.bBoxRel={left:(Ae=[{x:te.left-(be=$-se+I.strokeWidth/2),y:te.top-(ke=me-fe+I.strokeWidth/2)},{x:te.right+be,y:te.bottom+ke}])[0].x,top:Ae[0].y,right:Ae[1].x,bottom:Ae[1].y,width:Ae[1].x-Ae[0].x,height:Ae[1].y-Ae[0].y};break;case"polygon":_.points.forEach(function(Ct){var fn=Ct.x[0]*(Ct.x[1]?w.width:1),un=Ct.y[0]*(Ct.y[1]?w.height:1);k?(fn<k.left&&(k.left=fn),fn>k.right&&(k.right=fn),un<k.top&&(k.top=un),un>k.bottom&&(k.bottom=un)):k={left:fn,right:fn,top:un,bottom:un},R?I.pathListRel.push([R,{x:fn,y:un}]):I.pathListRel=[],R={x:fn,y:un}}),I.pathListRel.push([]),I.bBoxRel={left:(le=[{x:k.left-(V=I.strokeWidth/2),y:k.top-V},{x:k.right+V,y:k.bottom+V}])[0].x,top:le[0].y,right:le[1].x,bottom:le[1].y,width:le[1].x-le[0].x,height:le[1].y-le[0].y}}Ie.pathListRel=Ie.bBoxRel=!0}return(Ie.pathListRel||Ie.elementLeft||Ie.elementTop)&&(I.pathData=gi(I.pathListRel,function(Ct){Ct.x+=w.left,Ct.y+=w.top})),He(_,ee,"strokeWidth",T=I.strokeWidth)&&(_.path.style.strokeWidth=T+"px"),Nn(T=I.pathData,ee.pathData)&&(_.path.setPathData(T),ee.pathData=T,Ie.pathData=!0),_.dash&&(!Ie.pathData&&(!Ie.strokeWidth||_.dashLen&&_.dashGap)||(I.dashLen=_.dashLen||2*I.strokeWidth,I.dashGap=_.dashGap||I.strokeWidth),Ie.dash=He(_,ee,"dashLen",I.dashLen)||Ie.dash,Ie.dash=He(_,ee,"dashGap",I.dashGap)||Ie.dash,Ie.dash&&(_.path.style.strokeDasharray=ee.dashLen+","+ee.dashGap)),D=ee.viewBoxBBox,E=_.svg.viewBox.baseVal,M=_.svg.style,(x=I.viewBoxBBox).x=I.bBoxRel.left+w.left,x.y=I.bBoxRel.top+w.top,x.width=I.bBoxRel.width,x.height=I.bBoxRel.height,["x","y","width","height"].forEach(function(Ct){(T=x[Ct])!==D[Ct]&&(E[Ct]=D[Ct]=T,M[ui[Ct]]=T+("x"===Ct||"y"===Ct?_.bodyOffset[Ct]:0)+"px")}),Ie.strokeWidth||Ie.pathListRel||Ie.bBoxRel}},mouseHoverAnchor:{type:"anchor",argOptions:[{optionName:"element",type:Hi},{optionName:"showEffectName",type:"string"}],style:{backgroundImage:"url('data:image/svg+xml;charset=utf-8;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0Ij48cG9seWdvbiBwb2ludHM9IjI0LDAgMCw4IDgsMTEgMCwxOSA1LDI0IDEzLDE2IDE2LDI0IiBmaWxsPSJjb3JhbCIvPjwvc3ZnPg==')",backgroundSize:"",backgroundRepeat:"no-repeat",backgroundColor:"#f8f881",cursor:"default"},hoverStyle:{backgroundImage:"none",backgroundColor:"#fadf8f"},padding:{top:1,right:15,bottom:1,left:2},minHeight:15,backgroundPosition:{right:2,top:2},backgroundSize:{width:12,height:12},dirKeys:[["top","Top"],["right","Right"],["bottom","Bottom"],["left","Left"]],init:function(_,w){var T,k,R,V,le,te,re,j,$,me,G,J=st.mouseHoverAnchor,K={};if(_.element=st.pointAnchor.checkElement(w.element),!((me=(j=_.element).ownerDocument)&&($=me.defaultView)&&$.HTMLElement&&j instanceof $.HTMLElement))throw new Error("`element` must be HTML element");return J.style.backgroundSize=J.backgroundSize.width+"px "+J.backgroundSize.height+"px",["style","hoverStyle"].forEach(function(se){var fe=J[se];_[se]=Object.keys(fe).reduce(function(be,ke){return be[ke]=fe[ke],be},{})}),"inline"===(T=_.element.ownerDocument.defaultView.getComputedStyle(_.element,"")).display?_.style.display="inline-block":"none"===T.display&&(_.style.display="block"),st.mouseHoverAnchor.dirKeys.forEach(function(se){var fe=se[0],be="padding"+se[1];parseFloat(T[be])<J.padding[fe]&&(_.style[be]=J.padding[fe]+"px")}),_.style.display&&(V=_.element.style.display,_.element.style.display=_.style.display),st.mouseHoverAnchor.dirKeys.forEach(function(se){var fe="padding"+se[1];_.style[fe]&&(K[fe]=_.element.style[fe],_.element.style[fe]=_.style[fe])}),(R=_.element.getBoundingClientRect()).height<J.minHeight&&(Ht?(G=J.minHeight,"content-box"===T.boxSizing?G-=parseFloat(T.borderTopWidth)+parseFloat(T.borderBottomWidth)+parseFloat(T.paddingTop)+parseFloat(T.paddingBottom):"padding-box"===T.boxSizing&&(G-=parseFloat(T.borderTopWidth)+parseFloat(T.borderBottomWidth)),_.style.height=G+"px"):_.style.height=parseFloat(T.height)+(J.minHeight-R.height)+"px"),_.style.backgroundPosition=bn?R.width-J.backgroundSize.width-J.backgroundPosition.right+"px "+J.backgroundPosition.top+"px":"right "+J.backgroundPosition.right+"px top "+J.backgroundPosition.top+"px",_.style.display&&(_.element.style.display=V),st.mouseHoverAnchor.dirKeys.forEach(function(se){var fe="padding"+se[1];_.style[fe]&&(_.element.style[fe]=K[fe])}),["style","hoverStyle"].forEach(function(se){var fe=_[se],be=w[se];qi(be)&&Object.keys(be).forEach(function(ke){"string"==typeof be[ke]||on(be[ke])?fe[ke]=be[ke]:null==be[ke]&&delete fe[ke]})}),"function"==typeof w.onSwitch&&(re=w.onSwitch),w.showEffectName&&St[w.showEffectName]&&(_.showEffectName=le=w.showEffectName),te=w.animOptions,_.elmStyle=k=_.element.style,_.mouseenter=function(se){_.hoverStyleSave=J.getStyles(k,Object.keys(_.hoverStyle)),J.setStyles(k,_.hoverStyle),_.boundTargets.forEach(function(fe){$r(fe.props,!0,le,te)}),re&&re(se)},_.mouseleave=function(se){J.setStyles(k,_.hoverStyleSave),_.boundTargets.forEach(function(fe){$r(fe.props,!1,le,te)}),re&&re(se)},!0},bind:function(_,w){var T,k,R,V,le;return w.props.svg?st.mouseHoverAnchor.llShow(w.props,!1,_.showEffectName):ir(function(){st.mouseHoverAnchor.llShow(w.props,!1,_.showEffectName)}),_.enabled||(_.styleSave=st.mouseHoverAnchor.getStyles(_.elmStyle,Object.keys(_.style)),st.mouseHoverAnchor.setStyles(_.elmStyle,_.style),_.removeEventListener=(k=_.mouseenter,R=_.mouseleave,"onmouseenter"in(T=_.element)&&"onmouseleave"in T?(T.addEventListener("mouseenter",k,!1),T.addEventListener("mouseleave",R,!1),function(){T.removeEventListener("mouseenter",k,!1),T.removeEventListener("mouseleave",R,!1)}):(console.warn("mouseenter and mouseleave events polyfill is enabled."),T.addEventListener("mouseover",V=function(te){te.relatedTarget&&(te.relatedTarget===this||this.compareDocumentPosition(te.relatedTarget)&Node.DOCUMENT_POSITION_CONTAINED_BY)||k.apply(this,arguments)}),T.addEventListener("mouseout",le=function(te){te.relatedTarget&&(te.relatedTarget===this||this.compareDocumentPosition(te.relatedTarget)&Node.DOCUMENT_POSITION_CONTAINED_BY)||R.apply(this,arguments)}),function(){T.removeEventListener("mouseover",V,!1),T.removeEventListener("mouseout",le,!1)})),_.enabled=!0),!0},unbind:function(_,w){_.enabled&&_.boundTargets.length<=1&&(_.removeEventListener(),st.mouseHoverAnchor.setStyles(_.elmStyle,_.styleSave),_.enabled=!1),st.mouseHoverAnchor.llShow(w.props,!0,_.showEffectName)},removeOption:function(_,w){st.pointAnchor.removeOption(_,w)},remove:function(_){_.boundTargets.length&&(console.error("LeaderLineAttachment was not unbound by remove"),_.boundTargets.forEach(function(w){st.mouseHoverAnchor.unbind(_,w)}))},getBBoxNest:function(_,w){return No(_.element,w.baseWindow)},llShow:function(_,w,T){St[T||_.curStats.show_effect].stop(_,!0,w),_.aplStats.show_on=w},getStyles:function(_,w){return w.reduce(function(T,k){return T[k]=_[k],T},{})},setStyles:function(_,w){Object.keys(w).forEach(function(T){_[T]=w[T]})}},captionLabel:{type:"label",argOptions:[{optionName:"text",type:"string"}],stats:{color:{},x:{},y:{}},textStyleProps:["fontFamily","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","kerning","letterSpacing","wordSpacing","textDecoration"],init:function(_,w){return"string"==typeof w.text&&(_.text=w.text.trim()),!!_.text&&("string"==typeof w.color&&(_.color=w.color.trim()),_.outlineColor="string"==typeof w.outlineColor?w.outlineColor.trim():"#fff",Array.isArray(w.offset)&&on(w.offset[0])&&on(w.offset[1])&&(_.offset={x:w.offset[0],y:w.offset[1]}),on(w.lineOffset)&&(_.lineOffset=w.lineOffset),st.captionLabel.textStyleProps.forEach(function(T){null!=w[T]&&(_[T]=w[T])}),_.updateColor=function(T){st.captionLabel.updateColor(_,T)},_.updateSocketXY=function(T){var k,R,V,le,te=_.curStats,re=_.aplStats,j=T.curStats,$=j.position_socketXYSE[_.socketIndex];null!=$.x&&(_.offset?(te.x=$.x+_.offset.x,te.y=$.y+_.offset.y):(k=_.height/2,R=Math.max(j.attach_plugSideLenSE[_.socketIndex]||0,j.line_strokeWidth/2),V=j.position_socketXYSE[_.socketIndex?0:1],4===$.socketId||2===$.socketId?(te.x=4===$.socketId?$.x-k-_.width:$.x+k,te.y=V.y<$.y?$.y+R+k:$.y-R-k-_.height):(te.x=V.x<$.x?$.x+R+k:$.x-R-k-_.width,te.y=1===$.socketId?$.y-k-_.height:$.y+k)),He(_,re,"x",le=te.x)&&(_.elmPosition.x.baseVal.getItem(0).value=le),He(_,re,"y",le=te.y)&&(_.elmPosition.y.baseVal.getItem(0).value=le+_.height))},_.updatePath=function(T){var k,R,V=_.curStats,le=_.aplStats,te=T.pathList.animVal||T.pathList.baseVal;te&&(k=st.captionLabel.getMidPoint(te,_.lineOffset),V.x=k.x-_.width/2,V.y=k.y-_.height/2,He(_,le,"x",R=V.x)&&(_.elmPosition.x.baseVal.getItem(0).value=R),He(_,le,"y",R=V.y)&&(_.elmPosition.y.baseVal.getItem(0).value=R+_.height))},_.updateShow=function(T){st.captionLabel.updateShow(_,T)},bn&&(_.adjustEdge=function(T,k){var R=_.curStats;null!=R.x&&st.captionLabel.adjustEdge(k,{x:R.x,y:R.y,width:_.width,height:_.height},_.strokeWidth/2)}),!0)},updateColor:function(_,w){var T,R=_.aplStats;_.curStats.color=T=_.color||w.curStats.line_color,He(_,R,"color",T)&&(_.styleFill.fill=T)},updateShow:function(_,w){var T=!0===w.isShown;T!==_.isShown&&(_.styleShow.visibility=T?"":"hidden",_.isShown=T)},adjustEdge:function(_,w,T){var k={x1:w.x-T,y1:w.y-T,x2:w.x+w.width+T,y2:w.y+w.height+T};k.x1<_.x1&&(_.x1=k.x1),k.y1<_.y1&&(_.y1=k.y1),k.x2>_.x2&&(_.x2=k.x2),k.y2>_.y2&&(_.y2=k.y2)},newText:function(_,w,T,k,R){var V,le,te,re,j,$;return(V=w.createElementNS(ft,"text")).textContent=_,[V.x,V.y].forEach(function(me){var G=T.createSVGLength();G.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX,0),me.baseVal.initialize(G)}),"boolean"!=typeof cr&&(cr="paintOrder"in V.style),R&&!cr?(te=w.createElementNS(ft,"defs"),V.id=k,te.appendChild(V),(j=(le=w.createElementNS(ft,"g")).appendChild(w.createElementNS(ft,"use"))).href.baseVal="#"+k,(re=le.appendChild(w.createElementNS(ft,"use"))).href.baseVal="#"+k,($=j.style).strokeLinejoin="round",{elmPosition:V,styleText:V.style,styleFill:re.style,styleStroke:$,styleShow:le.style,elmsAppend:[te,le]}):($=V.style,R&&($.strokeLinejoin="round",$.paintOrder="stroke"),{elmPosition:V,styleText:$,styleFill:$,styleStroke:R?$:null,styleShow:$,elmsAppend:[V]})},getMidPoint:function(_,w){var T,k,R,V=$o(_),le=V.segsLen,te=V.lenAll,re=-1;if((T=te/2+(w||0))<=0)return 2===(k=_[0]).length?Lo(k[0],k[1],0):zi(k[0],k[1],k[2],k[3],0);if(te<=T)return 2===(k=_[_.length-1]).length?Lo(k[0],k[1],1):zi(k[0],k[1],k[2],k[3],1);for(R=[];T>le[++re];)R.push(_[re]),T-=le[re];return 2===(k=_[re]).length?Lo(k[0],k[1],T/le[re]):zi(k[0],k[1],k[2],k[3],Bi(k[0],k[1],k[2],k[3],T))},initSvg:function(_,w){var T,k,R=st.captionLabel.newText(_.text,w.baseWindow.document,w.svg,si+"-captionLabel-"+_._id,_.outlineColor);["elmPosition","styleFill","styleShow","elmsAppend"].forEach(function(V){_[V]=R[V]}),_.isShown=!1,_.styleShow.visibility="hidden",st.captionLabel.textStyleProps.forEach(function(V){null!=_[V]&&(R.styleText[V]=_[V])}),R.elmsAppend.forEach(function(V){w.svg.appendChild(V)}),T=R.elmPosition.getBBox(),_.width=T.width,_.height=T.height,_.outlineColor&&(k=10<(k=T.height/9)?10:k<2?2:k,R.styleStroke.strokeWidth=k+"px",R.styleStroke.stroke=_.outlineColor),_.strokeWidth=k||0,Qn(_.aplStats,st.captionLabel.stats),_.updateColor(w),_.refSocketXY?_.updateSocketXY(w):_.updatePath(w),bn&&_i(w,{}),_.updateShow(w)},bind:function(_,w){var T=w.props;return _.color||Gn(T,"cur_line_color",_.updateColor),(_.refSocketXY="startLabel"===w.optionName||"endLabel"===w.optionName)?(_.socketIndex="startLabel"===w.optionName?0:1,Gn(T,"apl_position",_.updateSocketXY),_.offset||(Gn(T,"cur_attach_plugSideLenSE",_.updateSocketXY),Gn(T,"cur_line_strokeWidth",_.updateSocketXY))):Gn(T,"apl_path",_.updatePath),Gn(T,"svgShow",_.updateShow),bn&&Gn(T,"new_edge4viewBox",_.adjustEdge),st.captionLabel.initSvg(_,T),!0},unbind:function(_,w){var T=w.props;_.elmsAppend&&(_.elmsAppend.forEach(function(k){T.svg.removeChild(k)}),_.elmPosition=_.styleFill=_.styleShow=_.elmsAppend=null),Qn(_.curStats,st.captionLabel.stats),Qn(_.aplStats,st.captionLabel.stats),_.color||qn(T,"cur_line_color",_.updateColor),_.refSocketXY?(qn(T,"apl_position",_.updateSocketXY),_.offset||(qn(T,"cur_attach_plugSideLenSE",_.updateSocketXY),qn(T,"cur_line_strokeWidth",_.updateSocketXY))):qn(T,"apl_path",_.updatePath),qn(T,"svgShow",_.updateShow),bn&&(qn(T,"new_edge4viewBox",_.adjustEdge),_i(T,{}))},removeOption:function(_,w){var T=w.props,k={};k[w.optionName]="",Sr(T,k)},remove:function(_){_.boundTargets.length&&(console.error("LeaderLineAttachment was not unbound by remove"),_.boundTargets.forEach(function(w){st.captionLabel.unbind(_,w)}))}},pathLabel:{type:"label",argOptions:[{optionName:"text",type:"string"}],stats:{color:{},startOffset:{},pathData:{}},init:function(_,w){return"string"==typeof w.text&&(_.text=w.text.trim()),!!_.text&&("string"==typeof w.color&&(_.color=w.color.trim()),_.outlineColor="string"==typeof w.outlineColor?w.outlineColor.trim():"#fff",on(w.lineOffset)&&(_.lineOffset=w.lineOffset),st.captionLabel.textStyleProps.forEach(function(T){null!=w[T]&&(_[T]=w[T])}),_.updateColor=function(T){st.captionLabel.updateColor(_,T)},_.updatePath=function(T){var k,V=_.aplStats,te=T.pathList.animVal||T.pathList.baseVal;te&&(_.curStats.pathData=k=st.pathLabel.getOffsetPathData(te,T.curStats.line_strokeWidth/2+_.strokeWidth/2+_.height/4,1.25*_.height),Nn(k,V.pathData)&&(_.elmPath.setPathData(k),V.pathData=k,_.bBox=_.elmPosition.getBBox(),_.updateStartOffset(T)))},_.updateStartOffset=function(T){var k,R,V,le,te=_.curStats,re=_.aplStats,j=T.curStats;te.pathData&&(2!==_.semIndex||_.lineOffset)&&(k=te.pathData.reduce(function($,me){var G,J=me.values;switch(me.type){case"M":le={x:J[0],y:J[1]};break;case"L":G={x:J[0],y:J[1]},le&&($+=Jn(le,G)),le=G;break;case"C":G={x:J[4],y:J[5]},le&&($+=po(le,{x:J[0],y:J[1]},{x:J[2],y:J[3]},G)),le=G}return $},0),V=0===_.semIndex?0:1===_.semIndex?k:k/2,2!==_.semIndex&&(R=Math.max(j.attach_plugBackLenSE[_.semIndex]||0,j.line_strokeWidth/2)+_.strokeWidth/2+_.height/4,V=(V+=0===_.semIndex?R:-R)<0?0:k<V?k:V),_.lineOffset&&(V=(V+=_.lineOffset)<0?0:k<V?k:V),te.startOffset=V,He(_,re,"startOffset",V)&&(_.elmOffset.startOffset.baseVal.value=V))},_.updateShow=function(T){st.captionLabel.updateShow(_,T)},bn&&(_.adjustEdge=function(T,k){_.bBox&&st.captionLabel.adjustEdge(k,_.bBox,_.strokeWidth/2)}),!0)},getOffsetPathData:function(_,w,T){var k,R,le=[];function te(re,j){return Math.abs(re.x-j.x)<3&&Math.abs(re.y-j.y)<3}return _.forEach(function(re){var j,$,me,G,J,K,se,fe,be,ke,Ae,pe,ne,ue,oe,ot,dt,et,q,ye,x;2===re.length?(et=re[0],q=re[1],ye=w,x=Math.atan2(et.y-q.y,q.x-et.x)+.5*Math.PI,j=[{x:et.x+Math.cos(x)*ye,y:et.y+Math.sin(x)*ye*-1},{x:q.x+Math.cos(x)*ye,y:q.y+Math.sin(x)*ye*-1}],k?(me=k.points,0<=(G=Math.atan2(me[1].y-me[0].y,me[0].x-me[1].x)-Math.atan2(re[0].y-re[1].y,re[1].x-re[0].x))&&G<=Math.PI?$={type:"line",points:j,inside:!0}:(K=Wi(me[0],me[1],w),J=Wi(j[1],j[0],w),pe=(be=K).x-(fe=me[0]).x,dt=((ue=(Ae=j[1]).x-(ke=J).x)*(fe.y-ke.y)-(oe=Ae.y-ke.y)*(fe.x-ke.x))/(-ue*(ne=be.y-fe.y)+pe*oe),(se=0<=(ot=(-ne*(fe.x-ke.x)+pe*(fe.y-ke.y))/(-ue*ne+pe*oe))&&ot<=1&&0<=dt&&dt<=1?{x:fe.x+dt*pe,y:fe.y+dt*ne}:null)?$={type:"line",points:[me[1]=se,j[1]]}:(me[1]=te(J,K)?J:K,$={type:"line",points:[J,j[1]]}),k.len=Jn(me[0],me[1]))):$={type:"line",points:j},$.len=Jn($.points[0],$.points[1]),le.push(k=$)):(le.push({type:"cubic",points:function(D,E,M,I,ee,qe){for(var Ie,Ct,fn=po(D,E,M,I)/16,un=1/(16<ee?fn*(ee/16):fn),En=[],Si=0;Ct=(90-(Ie=zi(D,E,M,I,Si)).angle)*(Math.PI/180),En.push({x:Ie.x+Math.cos(Ct)*ee,y:Ie.y+Math.sin(Ct)*ee*-1}),!(1<=Si);)1<(Si+=un)&&(Si=1);return En}(re[0],re[1],re[2],re[3],w)}),k=null)}),k=null,le.forEach(function(re){var j;"line"===re.type?(re.inside&&(k.len>w?((j=k.points)[1]=Wi(j[0],j[1],-w),k.len=Jn(j[0],j[1])):(k.points=null,k.len=0),re.len>w+T?((j=re.points)[0]=Wi(j[1],j[0],-(w+T)),re.len=Jn(j[0],j[1])):(re.points=null,re.len=0)),k=re):k=null}),le.reduce(function(re,j){var $=j.points;return $&&(R&&te($[0],R)||re.push({type:"M",values:[$[0].x,$[0].y]}),"line"===j.type?re.push({type:"L",values:[$[1].x,$[1].y]}):($.shift(),$.forEach(function(me){re.push({type:"L",values:[me.x,me.y]})})),R=$[$.length-1]),re},[])},newText:function(_,w,T,k){var R,V,le,te,re,j,$,me,G,J;return(te=(le=w.createElementNS(ft,"defs")).appendChild(w.createElementNS(ft,"path"))).id=R=T+"-path",(j=(re=w.createElementNS(ft,"text")).appendChild(w.createElementNS(ft,"textPath"))).href.baseVal="#"+R,j.startOffset.baseVal.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX,0),j.textContent=_,"boolean"!=typeof cr&&(cr="paintOrder"in re.style),k&&!cr?(re.id=V=T+"-text",le.appendChild(re),(G=($=w.createElementNS(ft,"g")).appendChild(w.createElementNS(ft,"use"))).href.baseVal="#"+V,(me=$.appendChild(w.createElementNS(ft,"use"))).href.baseVal="#"+V,(J=G.style).strokeLinejoin="round",{elmPosition:re,elmPath:te,elmOffset:j,styleText:re.style,styleFill:me.style,styleStroke:J,styleShow:$.style,elmsAppend:[le,$]}):(J=re.style,k&&(J.strokeLinejoin="round",J.paintOrder="stroke"),{elmPosition:re,elmPath:te,elmOffset:j,styleText:J,styleFill:J,styleStroke:k?J:null,styleShow:J,elmsAppend:[le,re]})},initSvg:function(_,w){var T,k,R=st.pathLabel.newText(_.text,w.baseWindow.document,si+"-pathLabel-"+_._id,_.outlineColor);["elmPosition","elmPath","elmOffset","styleFill","styleShow","elmsAppend"].forEach(function(V){_[V]=R[V]}),_.isShown=!1,_.styleShow.visibility="hidden",st.captionLabel.textStyleProps.forEach(function(V){null!=_[V]&&(R.styleText[V]=_[V])}),R.elmsAppend.forEach(function(V){w.svg.appendChild(V)}),R.elmPath.setPathData([{type:"M",values:[0,100]},{type:"h",values:[100]}]),T=R.elmPosition.getBBox(),R.styleText.textAnchor=["start","end","middle"][_.semIndex],2!==_.semIndex||_.lineOffset||R.elmOffset.startOffset.baseVal.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PERCENTAGE,50),_.height=T.height,_.outlineColor&&(k=10<(k=T.height/9)?10:k<2?2:k,R.styleStroke.strokeWidth=k+"px",R.styleStroke.stroke=_.outlineColor),_.strokeWidth=k||0,Qn(_.aplStats,st.pathLabel.stats),_.updateColor(w),_.updatePath(w),_.updateStartOffset(w),bn&&_i(w,{}),_.updateShow(w)},bind:function(_,w){var T=w.props;return _.color||Gn(T,"cur_line_color",_.updateColor),Gn(T,"cur_line_strokeWidth",_.updatePath),Gn(T,"apl_path",_.updatePath),_.semIndex="startLabel"===w.optionName?0:"endLabel"===w.optionName?1:2,(2!==_.semIndex||_.lineOffset)&&Gn(T,"cur_attach_plugBackLenSE",_.updateStartOffset),Gn(T,"svgShow",_.updateShow),bn&&Gn(T,"new_edge4viewBox",_.adjustEdge),st.pathLabel.initSvg(_,T),!0},unbind:function(_,w){var T=w.props;_.elmsAppend&&(_.elmsAppend.forEach(function(k){T.svg.removeChild(k)}),_.elmPosition=_.elmPath=_.elmOffset=_.styleFill=_.styleShow=_.elmsAppend=null),Qn(_.curStats,st.pathLabel.stats),Qn(_.aplStats,st.pathLabel.stats),_.color||qn(T,"cur_line_color",_.updateColor),qn(T,"cur_line_strokeWidth",_.updatePath),qn(T,"apl_path",_.updatePath),(2!==_.semIndex||_.lineOffset)&&qn(T,"cur_attach_plugBackLenSE",_.updateStartOffset),qn(T,"svgShow",_.updateShow),bn&&(qn(T,"new_edge4viewBox",_.adjustEdge),_i(T,{}))},removeOption:function(_,w){var T=w.props,k={};k[w.optionName]="",Sr(T,k)},remove:function(_){_.boundTargets.length&&(console.error("LeaderLineAttachment was not unbound by remove"),_.boundTargets.forEach(function(w){st.pathLabel.unbind(_,w)}))}}},Object.keys(st).forEach(function(_){Ti[_]=function(){return new mn(st[_],Array.prototype.slice.call(arguments))}}),Ti.positionByWindowResize=!0,window.addEventListener("resize",za.add(function(){Ti.positionByWindowResize&&Object.keys(li).forEach(function(_){_i(li[_],{position:!0})})}),!1)}()},534:(Yr,sn,St)=>{"use strict";St.r(sn),St.d(sn,{PipelineModule:()=>ye});var st=St(8583),mn=St(8239),er=St(2298),dr=St(6215),xr=St(8049);function cr(x,D){return x.some(E=>E.name===D)}function To(x,D){return x.find(E=>E.name===D)}var hr=(()=>{return(x=hr||(hr={})).inner="inner join",x.left="left outer join",x.right="right outer join",x.full="full outer join",hr;var x})();const Mo={[hr.inner]:{title:"\u0627\u0644\u062d\u0627\u0642 \u062f\u0627\u062e\u0644\u06cc"},[hr.left]:{title:"\u0627\u0644\u062d\u0627\u0642 \u0627\u0632 \u0686\u067e"},[hr.right]:{title:"\u0627\u0644\u062d\u0627\u0642 \u0627\u0632 \u0631\u0627\u0633\u062a"},[hr.full]:{title:"\u0627\u0644\u062d\u0627\u0642 \u06a9\u0627\u0645\u0644"}};var Di=(()=>{return(x=Di||(Di={})).count="count",x.sum="sum",x.average="average",x.min="min",x.max="max",Di;var x})();const si={[Di.count]:{title:"\u0634\u0645\u0627\u0631\u0634"},[Di.sum]:{title:"\u0645\u062c\u0645\u0648\u0639"},[Di.average]:{title:"\u0645\u06cc\u0627\u0646\u06af\u06cc\u0646"},[Di.min]:{title:"\u06a9\u0645\u06cc\u0646\u0647"},[Di.max]:{title:"\u0628\u06cc\u0634\u06cc\u0646\u0647"}};var ht=(()=>{return(x=ht||(ht={})).datasetInput="dataset_input",x.datasetOutput="dataset_output",x.filter="filter",x.sort="sort",x.join="join",x.aggregate="aggregate",ht;var x})();const fi={[ht.datasetInput]:{type:ht.datasetInput,title:"\u062f\u06cc\u062a\u0627\u0633\u062a \u0648\u0631\u0648\u062f\u06cc",altTitle:"",numInputs:0,hasOutput:!0,iconName:"file_download",iconMirrored:!1},[ht.datasetOutput]:{type:ht.datasetOutput,title:"\u062f\u06cc\u062a\u0627\u0633\u062a \u062e\u0631\u0648\u062c\u06cc",altTitle:"",numInputs:1,hasOutput:!1,iconName:"publish",iconMirrored:!1},[ht.sort]:{type:ht.sort,title:"\u0645\u0631\u062a\u0628\u200c\u0633\u0627\u0632\u06cc",altTitle:"Sort",numInputs:1,hasOutput:!0,iconName:"sort_by_alpha",iconMirrored:!1},[ht.filter]:{type:ht.filter,title:"\u0641\u06cc\u0644\u062a\u0631",altTitle:"Filter",numInputs:1,hasOutput:!0,iconName:"filter_alt",iconMirrored:!1},[ht.join]:{type:ht.join,title:"\u0627\u0644\u062d\u0627\u0642",altTitle:"Join",numInputs:1,hasOutput:!0,iconName:"merge_type",iconMirrored:!1},[ht.aggregate]:{type:ht.aggregate,title:"\u062a\u062c\u0645\u06cc\u0639",altTitle:"Aggregate",numInputs:1,hasOutput:!0,iconName:"stacked_bar_chart",iconMirrored:!0}};class Ci{constructor(D,E,M,I,ee){this.id=D,this.name=E,this.type=M,this.position=I,this.inputs=ee,this.validations=new er.t(1),this.inputFields=[],this.outputFields=new dr.X([]),this.typeInfo=fi[M];for(const qe in ee)this.inputFields.push(new dr.X([]))}updateFields(D,E){var M=this;return(0,mn.Z)(function*(){yield M.updateInputFields(D,E),yield M.updateOutputFields(D,E)})()}updateInputFields(D,E){var M=this;return(0,mn.Z)(function*(){for(const I in M.inputs){if(null===M.inputs[I])continue;const ee=D.getNode(M.inputs[I]);void 0!==ee&&M.inputFields[I].next(ee.node.outputFields.value)}})()}validate(D,E){var M=this;return(0,mn.Z)(function*(){let I=Object.assign(Object.assign({},yield M.validateInputs(D)),yield M.validateConfig(D,E));return M.validations.next(I),I})()}validateInputs(D){var E=this;return(0,mn.Z)(function*(){return E.inputs.some(M=>null===M||void 0===D.getNode(M))?{inputs:"\u0648\u0631\u0648\u062f\u06cc \u0627\u06cc\u0646 \u06af\u0631\u0647 \u0628\u0647 \u06af\u0631\u0647 \u062f\u06cc\u06af\u0631\u06cc \u0645\u062a\u0635\u0644 \u0646\u0634\u062f\u0647 \u0627\u0633\u062a"}:{}})()}export(){return{id:this.id,name:this.name,type:this.type,position:this.position,inputs:this.inputs,instruction:this.exportConfig()}}exportConfig(){}}const Mt={[ht.datasetInput]:class extends Ci{constructor(D,E,M,I,ee){super(D,E,ht.datasetInput,M,I),this.id=D,this.name=E,this.position=M,this.inputs=I,this.config=ee||{}}updateOutputFields(D,E){var M=this;return(0,mn.Z)(function*(){if(void 0!==M.config.datasetId){const I=yield E.getFields(M.config.datasetId).pipe((0,xr.P)()).toPromise();M.outputFields.next(I.fields)}})()}validateConfig(D,E){var M=this;return(0,mn.Z)(function*(){let I={};return void 0===M.config.datasetId&&(I.datasetId="\u062f\u06cc\u062a\u0627\u0633\u062a \u0648\u0631\u0648\u062f\u06cc \u0627\u0646\u062a\u062e\u0627\u0628 \u0646\u0634\u062f\u0647 \u0627\u0633\u062a"),I})()}exportConfig(){return{datasetId:this.config.datasetId}}static importConfig(D){return{datasetId:D.datasetId}}},[ht.datasetOutput]:class extends Ci{constructor(D,E,M,I,ee){super(D,E,ht.datasetOutput,M,I),this.id=D,this.name=E,this.position=M,this.inputs=I,this.config=ee||{overwrite:!1}}updateOutputFields(D,E){return(0,mn.Z)(function*(){})()}validateConfig(D,E){var M=this;return(0,mn.Z)(function*(){let I={};return void 0===M.config.datasetId&&(I.datasetId="\u062f\u06cc\u062a\u0627\u0633\u062a \u062e\u0631\u0648\u062c\u06cc \u0627\u0646\u062a\u062e\u0627\u0628 \u0646\u0634\u062f\u0647 \u0627\u0633\u062a"),I})()}exportConfig(){return{datasetId:this.config.datasetId,overwrite:this.config.overwrite}}static importConfig(D){return{datasetId:D.datasetId,overwrite:D.overwrite}}},[ht.sort]:class extends Ci{constructor(D,E,M,I,ee){super(D,E,ht.sort,M,I),this.id=D,this.name=E,this.position=M,this.inputs=I,this.config=ee||{orders:[]}}updateOutputFields(D,E){var M=this;return(0,mn.Z)(function*(){M.outputFields.next(M.inputFields[0].value)})()}validateConfig(D,E){var M=this;return(0,mn.Z)(function*(){let I={};for(const ee in M.config.orders)cr(M.inputFields[0].value,M.config.orders[ee].fieldName)||(I[`orders[${ee}].fieldName`]="\u0627\u06cc\u0646 \u0641\u06cc\u0644\u062f \u0648\u062c\u0648\u062f \u0646\u062f\u0627\u0631\u062f");return I})()}exportConfig(){return{orders:this.config.orders}}static importConfig(D){return{orders:D.orders}}},[ht.filter]:class extends Ci{constructor(D,E,M,I,ee){super(D,E,ht.filter,M,I),this.id=D,this.name=E,this.position=M,this.inputs=I,this.config=ee||{Command:"="}}updateOutputFields(D,E){var M=this;return(0,mn.Z)(function*(){M.outputFields.next(M.inputFields[0].value)})()}validateConfig(D,E){return(0,mn.Z)(function*(){return{}})()}exportConfig(){return this.config}static importConfig(D){return D}},[ht.join]:class extends Ci{constructor(D,E,M,I,ee){super(D,E,ht.join,M,I),this.id=D,this.name=E,this.position=M,this.inputs=I,this.config=ee||{type:hr.inner,joinWith:void 0,leftTableKey:"",rightTableKey:""},this.inputFields.push(new dr.X([]))}updateOutputFields(D,E){var M=this;return(0,mn.Z)(function*(){let I=M.inputFields[0].value;if(void 0!==M.config.joinWith){const ee=yield E.getFields(M.config.joinWith).pipe((0,xr.P)()).toPromise();I=I.concat(ee.fields)}M.outputFields.next(I)})()}validateConfig(D,E){var M=this;return(0,mn.Z)(function*(){let I={};return void 0===M.config.joinWith&&(I.joinWith="\u062f\u06cc\u062a\u0627\u0633\u062a \u0628\u0631\u0627\u06cc \u0627\u0644\u062d\u0627\u0642 \u0627\u0646\u062a\u062e\u0627\u0628 \u0646\u0634\u062f\u0647 \u0627\u0633\u062a"),cr(M.inputFields[0].value,M.config.leftTableKey)&&(I.leftTableKey="\u0627\u06cc\u0646 \u0641\u06cc\u0644\u062f \u0648\u062c\u0648\u062f \u0646\u062f\u0627\u0631\u062f"),cr(M.inputFields[1].value,M.config.rightTableKey)&&(I.rightTableKey="\u0627\u06cc\u0646 \u0641\u06cc\u0644\u062f \u0648\u062c\u0648\u062f \u0646\u062f\u0627\u0631\u062f"),I})()}exportConfig(){return{type:this.config.type,joinWith:this.config.joinWith,leftTableKey:this.config.leftTableKey,rightTableKey:this.config.rightTableKey}}static importConfig(D){return{type:D.type,joinWith:D.joinWith,leftTableKey:D.leftTableKey,rightTableKey:D.rightTableKey}}},[ht.aggregate]:class extends Ci{constructor(D,E,M,I,ee){super(D,E,ht.aggregate,M,I),this.id=D,this.name=E,this.position=M,this.inputs=I,this.config=ee||{groupBy:[],operations:[]}}updateOutputFields(D,E){var M=this;return(0,mn.Z)(function*(){const I=M.config.groupBy.reduce((Ie,Ct)=>{const fn=To(M.inputFields[0].value,Ct);return void 0!==fn&&Ie.push(fn),Ie},[]),ee=M.config.operations.reduce((Ie,Ct)=>{const fn=To(M.inputFields[0].value,Ct.fieldName);return void 0!==fn&&Ie.push({name:Ct.outputFieldName,type:fn.type}),Ie},[]),qe=I.concat(ee);M.outputFields.next(qe)})()}validateConfig(D,E){var M=this;return(0,mn.Z)(function*(){let I={};for(const ee in M.config.groupBy)cr(M.inputFields[0].value,M.config.groupBy[ee])||(I[`groupBy[${ee}]`]="\u0627\u06cc\u0646 \u0641\u06cc\u0644\u062f \u0648\u062c\u0648\u062f \u0646\u062f\u0627\u0631\u062f");for(const ee in M.config.operations){const qe=To(M.inputFields[0].value,M.config.operations[ee].fieldName);void 0===qe?I[`operations[${ee}].fieldName`]="\u0627\u06cc\u0646 \u0641\u06cc\u0644\u062f \u0648\u062c\u0648\u062f \u0646\u062f\u0627\u0631\u062f":"number"!==qe.type&&M.config.operations[ee].type!==Di.count&&(I[`operations[${ee}].type`]="\u0627\u06cc\u0646 \u0639\u0645\u0644 \u062a\u0646\u0647\u0627 \u0631\u0648\u06cc \u0641\u06cc\u0644\u062f \u0639\u062f\u062f\u06cc \u0642\u0627\u0628\u0644 \u0627\u0633\u062a\u0641\u0627\u062f\u0647 \u0627\u0633\u062a")}return I})()}exportConfig(){return this.config}static importConfig(D){return{groupBy:D.groupBy,operations:D.operations}}}};function Io(x){const D=Mt[x.type],E=D.importConfig(x.instruction);return new D(x.id,x.name,x.position,x.inputs,E)}var Yn=St(3461),co=St(9765),hs=St(1439);function br(x){return Object.keys(x).length>0}function Ko(x){return Object.keys(x).map(D=>({key:D,value:x[D]}))}class xi{constructor(D,E){this.id=D,this.name=E,this.nodes=[],this.nodeAdded=new co.xQ,this.nodeEdited=new co.xQ,this.nodeRemoved=new co.xQ,this.loaded=new er.t(1),this.validations=new er.t(1)}getNode(D){const E=this.nodes.findIndex(M=>M.id===D);if(!(E<0))return{index:E,node:this.nodes[E]}}addNode(D){if(void 0!==this.getNode(D.id))throw new Error("A node with the same id already exists in the pipeline");this.nodes.push(D),this.nodeAdded.next(D)}createNode(D,E,M={x:0,y:0},I){if(void 0!==I){if(I.length!==fi[E].numInputs)throw new Error("Invalid number of inputs")}else I=new Array(fi[E].numInputs).fill(null);const ee=new Mt[E](this.nextId,D,M,I);return this.addNode(ee),ee.id}get nextId(){return Math.max(0,...this.nodes.map(D=>D.id+1))}editNode(D){var E;const M=null===(E=this.getNode(D.id))||void 0===E?void 0:E.index;if(void 0===M)throw new Error("A node with the given id does not exist in the pipeline");this.nodes[M]=D,this.nodeEdited.next(D)}markNodeAsEdited(D){var E;const M=null===(E=this.getNode(D))||void 0===E?void 0:E.node;if(void 0===M)throw new Error("A node with the given id does not exist in the pipeline");this.nodeEdited.next(M)}removeNode(D){const E=this.nodes.findIndex(I=>I.id===D);if(E<0)throw new Error("A node with the given id does not exist in the pipeline");this.nodes.forEach(I=>{let ee=!1;for(let qe=0;qe<I.inputs.length;qe++)I.inputs[qe]===D&&(I.inputs[qe]=null,ee=!0);ee&&this.nodeEdited.next(I)});const M=this.nodes.splice(E,1)[0];this.nodeRemoved.next(M)}validate(D){var E=this;return(0,hs.P)((0,mn.Z)(function*(){let M=E.reorder();if(Object.keys(M).length>0)return E.validations.next(M),M;1!==E.nodes.filter(ee=>ee.type===ht.datasetInput).length&&(M.inputs="\u062a\u0646\u0647\u0627 \u06cc\u06a9 \u06af\u0631\u0647 \u062f\u06cc\u062a\u0627\u0633\u062a \u0648\u0631\u0648\u062f\u06cc \u0628\u0627\u06cc\u062f \u0648\u062c\u0648\u062f \u062f\u0627\u0634\u062a\u0647 \u0628\u0627\u0634\u062f"),E.nodes.filter(ee=>ee.type===ht.datasetOutput).length>1&&(M.outputs="\u062d\u062f\u0627\u06a9\u062b\u0631 \u06cc\u06a9 \u06af\u0631\u0647 \u062f\u06cc\u062a\u0627\u0633\u062a \u062e\u0631\u0648\u062c\u06cc \u0628\u0627\u06cc\u062f \u0648\u062c\u0648\u062f \u062f\u0627\u0634\u062a\u0647 \u0628\u0627\u0634\u062f");for(const ee of E.nodes)yield ee.updateOutputFields(E,D);let I=!1;for(const ee of E.nodes){const qe=yield ee.validate(E,D);I||(I=br(qe))}return I&&(M.nodes="\u06cc\u06a9\u06cc \u0627\u0632 \u06af\u0631\u0647\u200c\u0647\u0627 \u0646\u0627\u0645\u0639\u062a\u0628\u0631 \u0627\u0633\u062a"),M}))}reorder(){const D=[];for(let E=0;E<this.nodes.length;E++){let M=!1,I=E;for(;I<this.nodes.length;I++)if(this.nodes[I].inputs.every(qe=>null===qe||D.includes(qe))){M=!0;break}if(!M)return{circular:"\u06af\u0631\u0627\u0641 \u0634\u0627\u0645\u0644 \u062f\u0648\u0631 \u0627\u0633\u062a"};D.push(this.nodes[I].id),(0,Yn.bA)(this.nodes,I,E)}return{}}}const Xr=(()=>{const x=new xi(void 0,"\u0633\u0646\u0627\u0631\u06cc\u0648 \u062c\u062f\u06cc\u062f"),D=x.createNode("\u062f\u06cc\u062a\u0627\u0633\u062a \u0648\u0631\u0648\u062f\u06cc",ht.datasetInput,{x:3,y:5});return x.createNode("\u062f\u06cc\u062a\u0627\u0633\u062a \u062e\u0631\u0648\u062c\u06cc",ht.datasetOutput,{x:11,y:5},[D]),x})();function pr(x){const D=x.nodes.filter(ee=>ee.type===ht.datasetInput);if(D.length>1)throw new Error("\u062d\u062f\u0627\u06a9\u062b\u0631 \u06cc\u06a9 \u06af\u0631\u0647 \u062f\u06cc\u062a\u0627\u0633\u062a \u0648\u0631\u0648\u062f\u06cc \u067e\u0634\u062a\u06cc\u0628\u0627\u062a\u06cc \u0645\u06cc\u200c\u0634\u0648\u062f");const E=x.nodes.filter(ee=>ee.type===ht.datasetOutput);if(D.length>1)throw new Error("\u062d\u062f\u0627\u06a9\u062b\u0631 \u06cc\u06a9 \u06af\u0631\u0647 \u062f\u06cc\u062a\u0627\u0633\u062a \u062e\u0631\u0648\u062c\u06cc \u067e\u0634\u062a\u06cc\u0628\u0627\u062a\u06cc \u0645\u06cc\u200c\u0634\u0648\u062f");const M=D[0],I=E[0];return{pipelineId:x.id,pipelineName:x.name,inputDatasetId:(null==M?void 0:M.config.datasetId)||0,inputDataset:M?JSON.stringify(M.export()):null,outputDatasetId:(null==I?void 0:I.config.datasetId)||0,outputDataset:I?JSON.stringify(I.export()):null,overwrite:(null==I?void 0:I.config.overwrite)||!1,processes:x.nodes.filter(ee=>ee.type!==ht.datasetInput&&ee.type!==ht.datasetOutput).map(ee=>ee.export())}}function ui(x){const D=new xi(x.pipelineId,x.pipelineName);if(null!==x.inputDataset){const E=JSON.parse(x.inputDataset);D.addNode(Io(E))}for(const E of x.processes)D.addNode(Io(E));if(null!==x.outputDataset){const E=JSON.parse(x.outputDataset);D.addNode(Io(E))}return D}var f=St(7716),Fr=St(3423),Pa=St(2675);let ps=(()=>{class x{constructor(E,M){this.router=E,this.pipelineService=M}ngOnInit(){this.pipelineService.create(pr(Xr)).subscribe(E=>{this.router.navigate(["pipeline",E])})}}return x.\u0275fac=function(E){return new(E||x)(f.Y36(Fr.F0),f.Y36(Pa.n))},x.\u0275cmp=f.Xpm({type:x,selectors:[["app-initial-creator"]],decls:0,vars:0,template:function(E,M){},styles:[""]}),x})();var Pr=St(4299),Da=St.n(Pr),fr=St(7556),Gi=St(810);let Jr=(()=>{class x{constructor(E){this.datasetService=E,this.datasets=new er.t(1),this.datasetDetails={}}update(){this.datasetService.getAll().subscribe(E=>{this.datasets.next(E)})}getFields(E){return void 0===this.datasetDetails[E]&&this.updateFields(E),this.datasetDetails[E]}updateFields(E){void 0===this.datasetDetails[E]&&(this.datasetDetails[E]=new er.t(1)),this.datasetService.get(E).subscribe(M=>{this.datasetDetails[E].next(M)})}}return x.\u0275fac=function(E){return new(E||x)(f.LFG(Gi.d))},x.\u0275prov=f.Yz7({token:x,factory:x.\u0275fac}),x})();var Qr=St(6458),Ra=St(2522),ft=St(1095),rn=St(6627),Ht=St(8295),xn=St(9983),Zt=St(3679),bn=St(5384),bi=St(3017),Xn=St(3738);let qi=(()=>{class x{constructor(E){this.hostRef=E,this.onInit=new f.vpe,this.afterViewInit=new f.vpe,this.onDestroy=new f.vpe}ngOnInit(){this.onInit.emit(this.hostRef.nativeElement)}ngAfterViewInit(){this.afterViewInit.emit(this.hostRef.nativeElement)}ngOnDestroy(){this.onDestroy.emit(this.hostRef.nativeElement)}}return x.\u0275fac=function(E){return new(E||x)(f.Y36(f.SBq))},x.\u0275dir=f.lG2({type:x,selectors:[["","spy-element",""]],outputs:{onInit:"onInit",afterViewInit:"afterViewInit",onDestroy:"onDestroy"}}),x})();var on=St(2458);St(70);let tr=(()=>{class x{constructor(E){this.document=E}onContainer(E){return(M,I,ee)=>{let qe;qe=void 0===ee?new LeaderLine(M,I):new LeaderLine(M,I,ee);const Ie=this.document.querySelector("body > .leader-line:last-of-type");if(!Ie)return console.error("element of line was not found:",qe),qe;E.appendChild(Ie);const Ct=qe.remove;return qe.remove=()=>{this.document.body.appendChild(Ie),Ct.bind(qe)()},qe}}}return x.\u0275fac=function(E){return new(E||x)(f.LFG(st.K0))},x.\u0275prov=f.Yz7({token:x,factory:x.\u0275fac}),x})();const za=["connectionEnd"],ko=["connectionEndPreview"],fs=["*"];let gs=(()=>{class x{constructor(E,M){this.lineService=E,this.document=M,this.connectionRestVisibility=!0}tryToInitializeLine(){var E,M;if(void 0===this.line&&void 0!==this.lineContainer&&void 0!==this.connectionBegin&&void 0!==this.connectionEndRef){const I=this.lineService.onContainer(this.lineContainer);this.line=I(this.connectionBegin,null===(E=this.connectionEndRef)||void 0===E?void 0:E.nativeElement,{color:"var(--arrow-color)",startSocket:"left",endSocket:"right",path:"fluid",hide:!this.connectionRestVisibility,startSocketGravity:100,endSocketGravity:100}),this.subscription=null===(M=this.reposition)||void 0===M?void 0:M.subscribe(()=>{var ee;null===(ee=this.line)||void 0===ee||ee.position()}),this.line.position()}}updateLineVisibility(){void 0!==this.line&&(this.connectionRestVisibility?this.line.show():this.line.hide("none"))}ngOnInit(){}ngAfterViewInit(){this.tryToInitializeLine(),this.updateLineVisibility()}ngOnChanges(E){this.tryToInitializeLine(),"visibilityOnRest"in E&&this.updateLineVisibility()}ngOnDestroy(){var E,M;null===(E=this.subscription)||void 0===E||E.unsubscribe(),null===(M=this.line)||void 0===M||M.remove()}previewDragStarted(E){this.line.end=this.document.getElementsByClassName("cdk-drag-preview")[0],this.line.show()}previewDragMoved(E){var M;null===(M=this.line)||void 0===M||M.position()}previewDragEnded(){var E;this.line.end=null===(E=this.connectionEndRef)||void 0===E?void 0:E.nativeElement,this.updateLineVisibility()}}return x.\u0275fac=function(E){return new(E||x)(f.Y36(tr),f.Y36(st.K0))},x.\u0275cmp=f.Xpm({type:x,selectors:[["app-anchor"]],viewQuery:function(E,M){if(1&E&&(f.Gf(za,5),f.Gf(ko,5)),2&E){let I;f.iGM(I=f.CRH())&&(M.connectionEndRef=I.first),f.iGM(I=f.CRH())&&(M.connectionEndPreviewRef=I.first)}},inputs:{lineContainer:"lineContainer",connectionBegin:"connectionBegin",connectionRestVisibility:"connectionRestVisibility",reposition:"reposition",dragData:"dragData"},features:[f.TTD],ngContentSelectors:fs,decls:3,vars:1,consts:[["cdkDrag","",3,"cdkDragData","cdkDragMoved","cdkDragStarted","cdkDragEnded"],["connectionEnd",""]],template:function(E,M){1&E&&(f.F$t(),f.TgZ(0,"div",0,1),f.NdJ("cdkDragMoved",function(ee){return M.previewDragMoved(ee)})("cdkDragStarted",function(ee){return M.previewDragStarted(ee)})("cdkDragEnded",function(){return M.previewDragEnded()}),f.Hsn(2),f.qZA()),2&E&&f.Q6J("cdkDragData",M.dragData)},directives:[Yn.Zt],styles:["[_nghost-%COMP%] > *[_ngcontent-%COMP%]{position:absolute}"]}),x})();const Oo=["lineContainer"],li=["cardContainer"];function Ba(x,D){if(1&x){const E=f.EpF();f.TgZ(0,"div",24),f.TgZ(1,"button",25),f.TgZ(2,"mat-icon"),f._uU(3,"more_vert"),f.qZA(),f.qZA(),f.TgZ(4,"mat-menu",null,26),f.TgZ(6,"button",27),f.NdJ("click",function(){f.CHM(E);const I=f.oxw().$implicit;return f.oxw().removeNode(I.node.id)}),f.TgZ(7,"mat-icon"),f._uU(8,"delete"),f.qZA(),f.TgZ(9,"span"),f._uU(10,"\u062d\u0630\u0641"),f.qZA(),f.qZA(),f.qZA(),f.qZA()}if(2&x){const E=f.MAs(5);f.xp6(1),f.Q6J("matMenuTriggerFor",E)}}function Zn(x,D){if(1&x){const E=f.EpF();f.TgZ(0,"app-anchor",30),f.NdJ("shouldReposition",function(){return f.CHM(E),f.oxw(3).shouldReposition=!0}),f._UZ(1,"div",31),f.qZA()}if(2&x){const E=f.oxw().$implicit,M=f.oxw(2),I=f.MAs(9);f.Q6J("lineContainer",I)("connectionBegin",E.outputPlaceholderElement)("reposition",M.reposition)("dragData",E)}}const Va=function(x,D){return{type:"input",card:x,index:D}};function Dr(x,D){if(1&x){const E=f.EpF();f.TgZ(0,"div",28),f.NdJ("cdkDropListDropped",function(I){return f.CHM(E),f.oxw(2).buttonDrop(I)}),f.YNc(1,Zn,2,4,"app-anchor",29),f.qZA()}if(2&x){const E=D.$implicit,M=D.index,I=f.oxw().$implicit,ee=f.oxw();f.Q6J("cdkDropListData",f.WLB(3,Va,I,M))("cdkDropListEnterPredicate",ee.inputDropEnterPredicate),f.xp6(1),f.Q6J("ngIf",null!==E)}}const Ei=function(x){return{card:x,type:"output"}};function nr(x,D){if(1&x){const E=f.EpF();f.TgZ(0,"div",32),f.NdJ("cdkDropListDropped",function(I){return f.CHM(E),f.oxw(2).buttonDrop(I)}),f.TgZ(1,"app-anchor",33),f._UZ(2,"div",31),f.qZA(),f.qZA()}if(2&x){const E=f.oxw().$implicit,M=f.MAs(14),I=f.oxw(),ee=f.MAs(9);f.Q6J("cdkDropListData",f.VKq(6,Ei,E)),f.xp6(1),f.Q6J("lineContainer",ee)("connectionBegin",M)("connectionRestVisibility",!1)("reposition",I.reposition)("dragData",E)}}const Hi=function(){return{}};function Rr(x,D){if(1&x){const E=f.EpF();f.TgZ(0,"mat-card",17),f.NdJ("click",function(){const ee=f.CHM(E).$implicit;return f.oxw().updateSelectedCard(ee)})("cdkDragStarted",function(I){return f.CHM(E),f.oxw().cardDragStarted(I)})("cdkDragEnded",function(I){return f.CHM(E),f.oxw().cardDragEnded(I)})("cdkDragMoved",function(){return f.CHM(E),f.oxw().shouldReposition=!0})("transitionend",function(){return f.CHM(E),f.oxw().shouldReposition=!0}),f.ALo(1,"async"),f.TgZ(2,"mat-card-header"),f.TgZ(3,"mat-card-title"),f._uU(4),f.qZA(),f.TgZ(5,"mat-card-subtitle"),f.TgZ(6,"mat-icon"),f._uU(7),f.qZA(),f.TgZ(8,"span"),f._uU(9),f.qZA(),f.qZA(),f.qZA(),f.YNc(10,Ba,11,1,"div",18),f.TgZ(11,"div",19),f.YNc(12,Dr,2,6,"div",20),f.qZA(),f.TgZ(13,"div",21,22),f.NdJ("onInit",function(){const ee=f.CHM(E).$implicit,qe=f.MAs(14);return ee.outputPlaceholderElement=qe}),f.YNc(15,nr,3,8,"div",23),f.qZA(),f.qZA()}if(2&x){const E=D.$implicit,M=f.oxw();f.ekj("selected",(null==M.selectedCard||null==M.selectedCard.node?null:M.selectedCard.node.id)===E.node.id)("errored",M.hasError(f.lcZ(1,14,null==E.node?null:E.node.validations)||f.DdM(16,Hi))),f.Q6J("cdkDragData",E)("cdkDragFreeDragPosition",E.position),f.xp6(4),f.Oqu(E.title),f.xp6(2),f.ekj("mat-icon-rtl-mirror",E.typeInfo.iconMirrored),f.xp6(1),f.hij(" ",E.typeInfo.iconName," "),f.xp6(2),f.Oqu(E.subtitle),f.xp6(1),f.Q6J("ngIf",E.typeInfo.type!==M.PipelineNodeType.datasetInput&&E.typeInfo.type!==M.PipelineNodeType.datasetOutput),f.xp6(2),f.Q6J("ngForOf",E.inputs),f.xp6(3),f.Q6J("ngIf",E.hasOutput)}}function ho(x,D){1&x&&f._UZ(0,"div",41)}function No(x,D){1&x&&f._UZ(0,"div",42)}const Jn=function(){return[]};function Lo(x,D){if(1&x&&(f.TgZ(0,"div"),f.TgZ(1,"mat-card",37),f.TgZ(2,"mat-card-header"),f.TgZ(3,"mat-card-title"),f._uU(4),f.qZA(),f.TgZ(5,"mat-card-subtitle"),f.TgZ(6,"mat-icon"),f._uU(7),f.qZA(),f.TgZ(8,"span"),f._uU(9),f.qZA(),f.qZA(),f.qZA(),f.TgZ(10,"div",19),f.YNc(11,ho,1,0,"div",38),f.qZA(),f.TgZ(12,"div",39),f.YNc(13,No,1,0,"div",40),f.qZA(),f.qZA(),f.qZA()),2&x){const E=f.oxw().$implicit;f.xp6(4),f.hij(" ",E.title," "),f.xp6(2),f.ekj("mat-icon-rtl-mirror",E.iconMirrored),f.xp6(1),f.hij(" ",E.iconName," "),f.xp6(2),f.Oqu(E.title),f.xp6(2),f.Q6J("ngForOf",f.DdM(7,Jn).constructor(E.numInputs)),f.xp6(2),f.Q6J("ngIf",E.hasOutput)}}function Wi(x,D){if(1&x){const E=f.EpF();f.TgZ(0,"div",34),f.TgZ(1,"mat-card",35),f.NdJ("cdkDragEnded",function(I){return f.CHM(E),f.oxw().addNode(I)}),f.TgZ(2,"mat-icon"),f._uU(3),f.qZA(),f.TgZ(4,"span"),f._uU(5),f.qZA(),f.YNc(6,Lo,14,8,"div",36),f.qZA(),f.qZA()}if(2&x){const E=D.$implicit;f.xp6(1),f.Q6J("cdkDragData",E),f.xp6(1),f.ekj("mat-icon-rtl-mirror",E.iconMirrored),f.xp6(1),f.hij(" ",E.iconName," "),f.xp6(2),f.Oqu(E.title)}}const zi=function(){return{type:"remove"}},Bi=4*parseFloat(getComputedStyle(document.documentElement).fontSize);class gi{constructor(D){this.node=D,this.inputs=Array(D.inputs.length).fill(null),this.hasOutput=this.typeInfo.hasOutput,this.updatePosition()}get title(){return this.node.name}get subtitle(){return fi[this.node.type].title}get typeInfo(){return fi[this.node.type]}updatePosition(){this.position={x:-this.node.position.x*Bi,y:this.node.position.y*Bi}}}let $o=(()=>{class x{constructor(){this.selectedNodeEvent=new f.vpe,this.baseOffset={x:0,y:0},this.dragOffset={x:0,y:0},this.cards=[],this.reposition=new co.xQ,this.shouldReposition=!1,this.subscriptions=[],this.Card=gi,this.addNodeTypes=Object.values(fi).filter(E=>E.type!==ht.datasetInput&&E.type!==ht.datasetOutput&&E.type!==ht.sort),this.PipelineNodeType=ht,this.hasError=br}ngOnInit(){}ngOnChanges(E){void 0!==E.pipeline&&E.pipeline.previousValue!==E.pipeline.currentValue&&(E.pipeline.previousValue&&(this.subscriptions.forEach(M=>M.unsubscribe()),this.subscriptions.splice(0),this.shouldReposition=!1,this.updateSelectedCard(void 0),this.cards.splice(0),this.baseOffset={x:0,y:0},this.dragOffset={x:0,y:0}),this.initPipeline())}ngAfterViewInit(){window.addEventListener("load",()=>{this.reposition.next()})}ngAfterViewChecked(){this.reposition.next(),this.shouldReposition=!1}updateSelectedCard(E){this.selectedCard=E,this.selectedNodeEvent.emit(null==E?void 0:E.node)}initPipeline(){this.pipeline.nodes.forEach(E=>{this.cards.push(new gi(E))}),this.pipeline.nodes.forEach(E=>{this.updateCardInputs(E)}),this.subscriptions.push(this.pipeline.nodeAdded.subscribe(E=>{this.cards.push(new gi(E)),this.updateCardInputs(E)})),this.subscriptions.push(this.pipeline.nodeEdited.subscribe(E=>{this.updateCardInputs(E)})),this.subscriptions.push(this.pipeline.nodeRemoved.subscribe(E=>{const M=this.cards.findIndex(I=>I.node.id===E.id);this.cards.splice(M,1)})),this.subscriptions.push(this.pipeline.loaded.subscribe(()=>{this.autoView()}))}autoView(){if(this.pipeline.nodes.length>0){const E=this.pipeline.nodes.reduce((M,I)=>({x:Math.min(M.x,I.position.x),y:Math.min(M.y,I.position.y)}),{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY});this.baseOffset={x:(E.x-2)*Bi,y:-(E.y-2)*Bi}}}updateCardInputs(E){const M=this.findCard(E.id);for(let I=0;I<M.inputs.length;I++)M.inputs[I]=null===E.inputs[I]?null:this.findCard(E.inputs[I])}findCard(E){return this.cards.find(M=>M.node.id===E)}inputDropEnterPredicate(E,M){return E.data!==M.data.card}buttonDrop(E){if(E.previousContainer===E.container)return;const M=E.previousContainer.data,I=E.container.data;"output"===I.type||"remove"===I.type?"input"===M.type&&(M.card.node.inputs[M.index]=null,this.pipeline.markNodeAsEdited(M.card.node.id)):"input"===I.type&&("input"===M.type?(I.card.node.inputs[I.index]=M.card.node.inputs[M.index],M.card.node.inputs[M.index]=null,this.pipeline.markNodeAsEdited(M.card.node.id),this.pipeline.markNodeAsEdited(I.card.node.id)):"output"===M.type&&(I.card.node.inputs[I.index]=M.card.node.id,this.pipeline.markNodeAsEdited(I.card.node.id)))}updateDragOffset(E){this.dragOffset=E.distance}updateOffset(E){this.baseOffset={x:this.baseOffset.x+E.distance.x,y:this.baseOffset.y+E.distance.y},this.dragOffset={x:0,y:0},E.source.reset()}cardDragStarted(E){E.source.element.nativeElement.classList.remove("snap-animation")}cardDragEnded(E){E.source.element.nativeElement.classList.add("snap-animation"),E.source.data.node.position={x:Math.round(-E.source.getFreeDragPosition().x/Bi),y:Math.round(E.source.getFreeDragPosition().y/Bi)},E.source.data.updatePosition()}addNode(E){const M=this.cardContainer.nativeElement.getBoundingClientRect();if(E.dropPoint.x<M.left||E.dropPoint.x>M.right||E.dropPoint.y<M.top||E.dropPoint.y>M.bottom)return;const I_y=E.dropPoint.y-M.top-Bi-this.baseOffset.y,ee={x:Math.round((M.right-E.dropPoint.x-2.5*Bi+this.baseOffset.x)/Bi),y:Math.round(I_y/Bi)};this.pipeline.createNode(E.source.data.title,E.source.data.type,ee)}removeNode(E){var M,I;this.pipeline.removeNode(E),(null===(I=null===(M=this.selectedCard)||void 0===M?void 0:M.node)||void 0===I?void 0:I.id)===E&&this.updateSelectedCard(void 0)}}return x.\u0275fac=function(E){return new(E||x)},x.\u0275cmp=f.Xpm({type:x,selectors:[["app-diagram"]],viewQuery:function(E,M){if(1&E&&(f.Gf(Oo,5),f.Gf(li,5)),2&E){let I;f.iGM(I=f.CRH())&&(M.lineContainer=I.first),f.iGM(I=f.CRH())&&(M.cardContainer=I.first)}},inputs:{pipeline:"pipeline"},outputs:{selectedNodeEvent:"selectedNode"},features:[f.TTD],decls:24,vars:10,consts:[["hasBackdrop","false"],[1,"diagram-container"],["cdkDropListGroup","","cdkDrag","",1,"card-container",3,"cdkDragEnded","cdkDragMoved"],["cardContainer",""],["cdkDropList","",1,"remove-connection-container",3,"cdkDropListData","cdkDropListDropped"],[1,"offset-container"],["class","diagram-card","cdkDrag","",3,"selected","errored","cdkDragData","cdkDragFreeDragPosition","click","cdkDragStarted","cdkDragEnded","cdkDragMoved","transitionend",4,"ngFor","ngForOf"],[1,"line-container"],["lineContainer",""],[1,"add-node-button-container"],["mat-raised-button","","color","primary",3,"click"],["position","end","mode","side"],["addSidePane",""],[1,"add-node-pane"],["mat-icon-button","",3,"click"],[1,"add-node-list"],["cdkDropList","",4,"ngFor","ngForOf"],["cdkDrag","",1,"diagram-card",3,"cdkDragData","cdkDragFreeDragPosition","click","cdkDragStarted","cdkDragEnded","cdkDragMoved","transitionend"],["class","more-menu-container",4,"ngIf"],[1,"drop-placeholder","input-drop-placeholder"],["class","empty-button-placeholder","cdkDropList","",3,"cdkDropListData","cdkDropListEnterPredicate","cdkDropListDropped",4,"ngFor","ngForOf"],["spy-element","",1,"drop-placeholder","output-drop-placeholder",3,"onInit"],["connectionBegin",""],["class","full-button-placeholder","cdkDropList","",3,"cdkDropListData","cdkDropListDropped",4,"ngIf"],[1,"more-menu-container"],["mat-icon-button","",3,"matMenuTriggerFor"],["moreMenu","matMenu"],["mat-menu-item","","disableRipple","","matRipple","","matRippleColor","rgba(255, 0, 0, 0.2)",1,"remove-menu-item",3,"click"],["cdkDropList","",1,"empty-button-placeholder",3,"cdkDropListData","cdkDropListEnterPredicate","cdkDropListDropped"],[3,"lineContainer","connectionBegin","reposition","dragData","shouldReposition",4,"ngIf"],[3,"lineContainer","connectionBegin","reposition","dragData","shouldReposition"],[1,"drag-button"],["cdkDropList","",1,"full-button-placeholder",3,"cdkDropListData","cdkDropListDropped"],[3,"lineContainer","connectionBegin","connectionRestVisibility","reposition","dragData"],["cdkDropList",""],["cdkDrag","",1,"add-node-card",3,"cdkDragData","cdkDragEnded"],[4,"cdkDragPreview"],[1,"diagram-card","preview-diagram-card"],["class","empty-button-placeholder",4,"ngFor","ngForOf"],[1,"drop-placeholder","output-drop-placeholder"],["class","full-button-placeholder",4,"ngIf"],[1,"empty-button-placeholder"],[1,"full-button-placeholder"]],template:function(E,M){if(1&E){const I=f.EpF();f.TgZ(0,"mat-sidenav-container",0),f.TgZ(1,"mat-sidenav-content"),f.TgZ(2,"div",1),f.TgZ(3,"div",2,3),f.NdJ("cdkDragEnded",function(qe){return M.updateOffset(qe)})("cdkDragMoved",function(qe){return M.shouldReposition=!0,M.updateDragOffset(qe)}),f.TgZ(5,"div",4),f.NdJ("cdkDropListDropped",function(qe){return M.buttonDrop(qe)}),f.qZA(),f.TgZ(6,"div",5),f.YNc(7,Rr,16,17,"mat-card",6),f.qZA(),f.qZA(),f._UZ(8,"div",7,8),f.TgZ(10,"div",9),f.TgZ(11,"button",10),f.NdJ("click",function(){return f.CHM(I),f.MAs(15).open()}),f.TgZ(12,"mat-icon"),f._uU(13,"add"),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.TgZ(14,"mat-sidenav",11,12),f.TgZ(16,"div",13),f.TgZ(17,"h3"),f._uU(18," \u067e\u0631\u062f\u0627\u0632\u0634 \u062c\u062f\u06cc\u062f "),f.TgZ(19,"button",14),f.NdJ("click",function(){return f.CHM(I),f.MAs(15).close()}),f.TgZ(20,"mat-icon"),f._uU(21,"chevron_left"),f.qZA(),f.qZA(),f.qZA(),f.TgZ(22,"div",15),f.YNc(23,Wi,7,5,"div",16),f.qZA(),f.qZA(),f.qZA(),f.qZA()}if(2&E){const I=f.MAs(15);f.xp6(2),f.Udp("background-position","right "+(-M.baseOffset.x-M.dragOffset.x)+"px top "+(M.baseOffset.y+M.dragOffset.y)+"px"),f.xp6(3),f.Q6J("cdkDropListData",f.DdM(9,zi)),f.xp6(1),f.Udp("transform","translate("+M.baseOffset.x+"px, "+M.baseOffset.y+"px)"),f.xp6(1),f.Q6J("ngForOf",M.cards),f.xp6(3),f.ekj("invisible",I.opened),f.xp6(13),f.Q6J("ngForOf",M.addNodeTypes)}},directives:[bi.TM,bi.Rh,Yn.Fd,Yn.Zt,Yn.Wj,st.sg,ft.lW,rn.Hw,bi.JX,Xn.a8,Xn.dk,Xn.n5,Xn.$j,st.O5,qi,bn.p6,bn.VK,bn.OP,on.wG,gs,Yn.pV],pipes:[st.Ov],styles:[":root{--arrow-color: #673ab7}.mat-sidenav-container[_ngcontent-%COMP%]{width:100%;height:100%}.diagram-container[_ngcontent-%COMP%]{width:100%;height:100%;overflow:hidden;background-size:4rem 4rem;background-image:linear-gradient(to right,#eee .1rem,transparent .1rem),linear-gradient(to bottom,#eee .1rem,transparent .1rem)}.card-container[_ngcontent-%COMP%]{width:100%;height:100%}.card-container.cdk-drag-dragging[_ngcontent-%COMP%]{cursor:grab}.card-container[_ngcontent-%COMP%]   .diagram-card[_ngcontent-%COMP%]{position:absolute}.offset-container[_ngcontent-%COMP%]{width:0;height:0;overflow:visible}.diagram-card[_ngcontent-%COMP%]{width:20rem;height:8rem;display:flex;flex-direction:row;justify-content:center;-webkit-user-select:none;user-select:none;cursor:pointer;transition:box-shadow .28s cubic-bezier(.4,0,.2,1);box-shadow:0 3px 1px -2px #0003,0 2px 2px #00000024,0 1px 5px #0000001f}.diagram-card.snap-animation[_ngcontent-%COMP%]{transition:transform .2s ease-in-out,box-shadow .28s cubic-bezier(.4,0,.2,1)}.diagram-card.selected[_ngcontent-%COMP%]{box-shadow:0 2px 4px -1px #673ab799,0 4px 5px #673ab76b,0 1px 10px #673ab75c}.diagram-card.cdk-drag-dragging[_ngcontent-%COMP%]{box-shadow:0 3px 5px -1px #673ab799,0 6px 10px #673ab76b,0 1px 18px #673ab75c;cursor:move}.diagram-card.errored[_ngcontent-%COMP%]{box-shadow:0 3px 1px -2px #f44336cc,0 2px 2px #f443368f,0 1px 5px #f443367a}.diagram-card.errored.selected[_ngcontent-%COMP%]{box-shadow:0 2px 4px -1px #f4433699,0 4px 5px #f443366b,0 1px 10px #f443365c}.diagram-card.errored.cdk-drag-dragging[_ngcontent-%COMP%]{box-shadow:0 3px 5px -1px #f4433699,0 6px 10px #f443366b,0 1px 18px #f443365c}.diagram-card[_ngcontent-%COMP%]   .mat-card-title[_ngcontent-%COMP%], .diagram-card[_ngcontent-%COMP%]   .mat-card-subtitle[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center;grid-gap:var(--density-smaller);gap:var(--density-smaller)}.more-menu-container[_ngcontent-%COMP%]{position:absolute;top:0;left:0;margin:var(--density-small)}.remove-menu-item[_ngcontent-%COMP%]{color:#f44336}.remove-menu-item[_ngcontent-%COMP%] > .mat-icon[_ngcontent-%COMP%]{color:#f44336}.drop-placeholder[_ngcontent-%COMP%]{position:absolute;width:0;height:8rem;display:flex;flex-direction:column;justify-content:space-evenly;align-items:center}.input-drop-placeholder[_ngcontent-%COMP%]{top:0;right:0}.output-drop-placeholder[_ngcontent-%COMP%]{top:0;left:0}.empty-button-placeholder[_ngcontent-%COMP%]{width:2rem;height:2rem;border-radius:100%;background-color:#d1c4e9}.empty-button-placeholder[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{position:absolute}.full-button-placeholder[_ngcontent-%COMP%]{width:2rem;height:2rem;border-radius:100%;background-color:#673ab7}.full-button-placeholder[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{position:absolute}.drag-button[_ngcontent-%COMP%]{width:2rem;height:2rem;border-radius:100%;background-color:#673ab7}.line-container[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:0;height:0}.remove-connection-container[_ngcontent-%COMP%]{position:absolute;top:0;right:0;width:100%;height:100%}.remove-connection-container[_ngcontent-%COMP%]   .drag-button[_ngcontent-%COMP%]{display:none}.add-node-button-container[_ngcontent-%COMP%]{position:absolute;top:0;left:0;margin:var(--density-large);transition:opacity .2s ease-in;opacity:1}.add-node-button-container.invisible[_ngcontent-%COMP%]{visibility:hidden;opacity:0}.mat-sidenav[_ngcontent-%COMP%]{width:20rem}.add-node-pane[_ngcontent-%COMP%]{min-height:100%;padding:var(--density-large);background-color:#fafafa}.add-node-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:var(--density-large);gap:var(--density-large)}.add-node-card[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;grid-gap:var(--density-small);gap:var(--density-small);-webkit-user-select:none;user-select:none;cursor:move}.preview-diagram-card[_ngcontent-%COMP%]{position:absolute;transform:translate(50%,-50%)}"]}),x})();var Nn=St(7441);function Gn(x,D){if(1&x){const E=f.EpF();f.TgZ(0,"div"),f.TgZ(1,"h3"),f._uU(2,"\u0627\u0637\u0644\u0627\u0639\u0627\u062a \u062f\u06cc\u062a\u0627\u0633\u062a"),f.qZA(),f.TgZ(3,"mat-form-field",1),f.TgZ(4,"mat-label"),f._uU(5,"\u062f\u06cc\u062a\u0627\u0633\u062a"),f.qZA(),f.TgZ(6,"mat-select",2),f.NdJ("ngModelChange",function(I){return f.CHM(E),f.oxw().node.config.datasetId=I}),f._UZ(7,"mat-option"),f.TgZ(8,"mat-option",3),f._uU(9," \u0627\u0637\u0644\u0627\u0639\u0627\u062a \u06a9\u0627\u0631\u0628\u0631\u06cc "),f.qZA(),f.TgZ(10,"mat-option",3),f._uU(11," \u0627\u0637\u0644\u0627\u0639\u0627\u062a \u0628\u0627\u0646\u06a9\u06cc "),f.qZA(),f.TgZ(12,"mat-option",3),f._uU(13," \u0627\u0637\u0644\u0627\u0639\u0627\u062a \u0622\u0628\u0627\u0627\u062c\u062f\u0627\u062f\u06cc "),f.qZA(),f.qZA(),f.TgZ(14,"mat-error"),f._uU(15,"\u0644\u0637\u0641\u0627\u064b \u06cc\u06a9 \u062f\u06cc\u062a\u0627\u0633\u062a \u0627\u0646\u062a\u062e\u0627\u0628 \u06a9\u0646\u06cc\u062f"),f.qZA(),f.qZA(),f.qZA()}if(2&x){const E=f.oxw();f.xp6(6),f.Q6J("ngModel",E.node.config.datasetId),f.xp6(2),f.Q6J("value",1),f.xp6(2),f.Q6J("value",2),f.xp6(2),f.Q6J("value",3)}}let qn=(()=>{class x{constructor(){}ngOnInit(){}}return x.\u0275fac=function(E){return new(E||x)},x.\u0275cmp=f.Xpm({type:x,selectors:[["app-input-config"]],inputs:{node:"node"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"wide-field"],["required","",3,"ngModel","ngModelChange"],[3,"value"]],template:function(E,M){1&E&&f.YNc(0,Gn,16,4,"div",0),2&E&&f.Q6J("ngIf",void 0!==M.node)},directives:[st.O5,Ht.KE,Ht.hX,Nn.gD,Zt.Q7,Zt.JJ,Zt.On,on.ey,Ht.TO],styles:[""]}),x})();var ir=St(7539);function cn(x,D){if(1&x){const E=f.EpF();f.TgZ(0,"div"),f.TgZ(1,"h3"),f._uU(2,"\u0627\u0637\u0644\u0627\u0639\u0627\u062a \u062f\u06cc\u062a\u0627\u0633\u062a"),f.qZA(),f.TgZ(3,"mat-form-field",1),f.TgZ(4,"mat-label"),f._uU(5,"\u062f\u06cc\u062a\u0627\u0633\u062a"),f.qZA(),f.TgZ(6,"mat-select",2),f.NdJ("ngModelChange",function(I){return f.CHM(E),f.oxw().node.config.datasetId=I}),f._UZ(7,"mat-option"),f.TgZ(8,"mat-option",3),f._uU(9," \u0627\u0637\u0644\u0627\u0639\u0627\u062a \u06a9\u0627\u0631\u0628\u0631\u06cc "),f.qZA(),f.TgZ(10,"mat-option",3),f._uU(11," \u0627\u0637\u0644\u0627\u0639\u0627\u062a \u0628\u0627\u0646\u06a9\u06cc "),f.qZA(),f.TgZ(12,"mat-option",3),f._uU(13," \u0627\u0637\u0644\u0627\u0639\u0627\u062a \u0622\u0628\u0627\u0627\u062c\u062f\u0627\u062f\u06cc "),f.qZA(),f.qZA(),f.TgZ(14,"mat-error"),f._uU(15,"\u0644\u0637\u0641\u0627\u064b \u06cc\u06a9 \u062f\u06cc\u062a\u0627\u0633\u062a \u0627\u0646\u062a\u062e\u0627\u0628 \u06a9\u0646\u06cc\u062f"),f.qZA(),f.qZA(),f.TgZ(16,"mat-checkbox",4),f.NdJ("ngModelChange",function(I){return f.CHM(E),f.oxw().node.config.overwrite=I}),f._uU(17," \u0631\u0648\u0646\u0648\u06cc\u0633\u06cc "),f.qZA(),f.qZA()}if(2&x){const E=f.oxw();f.xp6(6),f.Q6J("ngModel",E.node.config.datasetId),f.xp6(2),f.Q6J("value",1),f.xp6(2),f.Q6J("value",2),f.xp6(2),f.Q6J("value",3),f.xp6(4),f.Q6J("ngModel",E.node.config.overwrite)}}let Fo=(()=>{class x{constructor(){}ngOnInit(){}}return x.\u0275fac=function(E){return new(E||x)},x.\u0275cmp=f.Xpm({type:x,selectors:[["app-output-config"]],inputs:{node:"node"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"wide-field"],["required","",3,"ngModel","ngModelChange"],[3,"value"],[3,"ngModel","ngModelChange"]],template:function(E,M){1&E&&f.YNc(0,cn,18,5,"div",0),2&E&&f.Q6J("ngIf",void 0!==M.node)},directives:[st.O5,Ht.KE,Ht.hX,Nn.gD,Zt.Q7,Zt.JJ,Zt.On,on.ey,Ht.TO,ir.oG],styles:[""]}),x})();var Er=St(2238),ea=St(7646),Qn=St(1769),He=St(171);function hn(x,D){if(1&x){const E=f.EpF();f.TgZ(0,"button",4),f.NdJ("click",function(){return f.CHM(E),f.oxw().handleAddNode("AND")}),f._uU(1," \u0627\u0641\u0632\u0648\u062f\u0646 AND "),f.qZA()}}function ta(x,D){if(1&x){const E=f.EpF();f.TgZ(0,"button",26),f.NdJ("click",function(){return f.CHM(E),f.oxw().handleAddNode("OR")}),f._uU(1," \u0627\u0641\u0632\u0648\u062f\u0646 OR "),f.qZA()}}function _s(x,D){if(1&x){const E=f.EpF();f.TgZ(0,"mat-accordion"),f.TgZ(1,"mat-expansion-panel",33),f.TgZ(2,"mat-expansion-panel-header"),f.TgZ(3,"mat-panel-title"),f._uU(4," \u0648\u06cc\u0631\u0627\u06cc\u0634 \u06af\u0631\u0647\u200c\u06cc \u0634\u0631\u0637\u06cc "),f.qZA(),f.qZA(),f.TgZ(5,"mat-form-field",14),f.TgZ(6,"mat-label"),f._uU(7,"\u0646\u0627\u0645 \u0645\u062a\u063a\u06cc\u0631"),f.qZA(),f.TgZ(8,"input",34),f.NdJ("ngModelChange",function(I){return f.CHM(E),f.oxw(2).currentData._field=I}),f.qZA(),f.qZA(),f.TgZ(9,"mat-form-field",14),f.TgZ(10,"mat-label"),f._uU(11,"\u0639\u0645\u0644\u06af\u0631"),f.qZA(),f.TgZ(12,"mat-select",35),f.NdJ("ngModelChange",function(I){return f.CHM(E),f.oxw(2).currentData.Command=I}),f.TgZ(13,"mat-option",17),f._uU(14,">"),f.qZA(),f.TgZ(15,"mat-option",18),f._uU(16,"<"),f.qZA(),f.TgZ(17,"mat-option",19),f._uU(18,"="),f.qZA(),f.qZA(),f.qZA(),f.TgZ(19,"mat-form-field",14),f.TgZ(20,"mat-label"),f._uU(21,"\u0639\u0645\u0644\u0648\u0646\u062f"),f.qZA(),f.TgZ(22,"input",34),f.NdJ("ngModelChange",function(I){return f.CHM(E),f.oxw(2).currentData._value=I}),f.qZA(),f.qZA(),f.qZA(),f.qZA()}if(2&x){const E=f.oxw(2);f.xp6(1),f.Q6J("expanded",!0),f.xp6(7),f.Q6J("ngModel",E.currentData._field),f.xp6(4),f.Q6J("ngModel",E.currentData.Command),f.xp6(10),f.Q6J("ngModel",E.currentData._value)}}function Kr(x,D){if(1&x){const E=f.EpF();f.TgZ(0,"mat-sidenav",27,28),f.TgZ(2,"div",10),f.TgZ(3,"mat-form-field",29),f.TgZ(4,"input",30,31),f.NdJ("ngModelChange",function(I){return f.CHM(E),f.oxw().currentData.name=I}),f.qZA(),f.qZA(),f.YNc(6,_s,23,4,"mat-accordion",32),f.qZA(),f.qZA()}if(2&x){const E=f.oxw();f.xp6(4),f.Q6J("ngModel",E.currentData.name),f.xp6(2),f.Q6J("ngIf","child"===E.currentData.type)}}let _i=(()=>{class x{constructor(E,M,I){this.formBuilder=E,this.dialogRef=M,this.data=I,this.nodeSize=0,this.onSaveGraph=new f.vpe,this.panelOpenState=!1,this.errorGraph=!1}ngOnInit(){this.form=this.formBuilder.group({Command:[null,Zt.kI.required],_field:[null,[Zt.kI.required]],_value:[null,Zt.kI.required]}),this.ogma=new ea({container:"graph-container",options:{interactions:{zoom:{onDoubleClick:!0}}}}),this.ogma.styles.addNodeRule({text:{maxLineLength:140,size:12,color:"black",minVisibleSize:2,content:E=>E.getData("name")}}),this.ogma.styles.addEdgeRule({shape:"arrow",width:7}),this.nodeSize=this.ogma.getNodes().size,this.ogma.events.onKeyPress(46,()=>{const E=this.ogma.getSelectedNodes(),M=this.ogma.getSelectedEdges();this.nodeSize-=E.size,this.ogma.removeNodes(E.getId()),this.ogma.removeEdges(M.getId()),this.currentData=null}),this.ogma.events.onClick(E=>{const M=E.button,I=E.target;I?"left"===M?(this.ogma.clearSelection(),I.setSelected(!0),I.isNode&&(this.currentData=this.ogma.getNode(I.getId()).getData())):"right"===M&&I.setSelected(!0):(this.ogma.clearSelection(),this.currentData=null)}),this.ogma.view.locateGraph(),this.ogma.events.onDragStart(()=>{this.ogma.keyboard.isKeyPressed("ctrl")&&this.ogma.tools.connectNodes.enable({strokeColor:"red",condition:(E,M)=>{const I=this.ogma.getEdges();for(let ee=0;ee<I.size;ee++){const qe=I.get(ee).getData();if(qe.source==E.getId()&&qe.target==M.getId())return!1}return"child"!=E.getData().type&&E.getId()!=M.getId()},createNodes:!1,createEdge:E=>(E.attributes=Object.assign(Object.assign({},E.attributes),{color:"orange"}),E),onComplete:(E,M,I)=>{M&&I?I.setData({source:E.getId(),target:M.getId()}):this.ogma.tools.connectNodes.disable()}})}),this.ogma.events.onDragEnd(()=>{this.ogma.algorithms.detectCycle()&&this.ogma.removeEdge(this.ogma.getEdges().get(this.ogma.getEdges().size-1).getId())})}handleAddNode(E){switch(E){case"AND":this.ogma.addNode({id:++this.nodeSize,data:{type:"parent",name:"AND",Command:"AND"},attributes:{x:-200*Math.random(),y:200*Math.random(),color:"green",radius:25}});break;case"OR":this.ogma.addNode({id:++this.nodeSize,data:{type:"parent",name:"OR",Command:"OR"},attributes:{x:200*Math.random(),y:100*-Math.random(),color:"magenta",radius:25}});break;case"condition":this.ogma.addNode({id:++this.nodeSize,data:Object.assign({type:"child",name:"condition"},this.form.value),attributes:{x:100*-Math.random(),y:200*-Math.random(),color:"orange",radius:25}}),this.ogma.getNodes().forEach(M=>{})}}handleSavingGraph(){const E=this.ogma.getNodes().filter(M=>0===M.getDegree("in"));if(1!==E.size)alert("\u062e\u0637\u0627 \u062f\u0631 \u0630\u062e\u06cc\u0631\u0647 \u0633\u0627\u0632\u06cc : \u06af\u0631\u0627\u0641 \u0641\u0642\u0637 \u06cc\u06a9 \u0631\u06cc\u0634\u0647 \u0628\u0627\u06cc\u062f \u062f\u0627\u0634\u062a\u0647 \u0628\u0627\u0634\u062f");else{const M=this.applyingDFS(E.get(0));if(this.errorGraph)alert("\u062e\u0637\u0627 \u062f\u0631 \u0630\u062e\u06cc\u0631\u0647 \u0633\u0627\u0632\u06cc : \u06af\u0631\u0647 \u0647\u0627\u06cc \u063a\u06cc\u0631 \u0634\u0631\u0637\u06cc \u062d\u062f\u0627\u0642\u0644 2 \u0641\u0631\u0632\u0646\u062f \u0628\u0627\u06cc\u062f \u062f\u0627\u0634\u062a\u0647 \u0628\u0627\u0634\u0646\u062f"),this.errorGraph=!1;else{const I=JSON.stringify(M,void 0,1);console.log(I),alert("\u0641\u06cc\u0644\u062a\u0631 \u0628\u0627 \u0645\u0648\u0641\u0642\u06cc\u062a \u0630\u062e\u06cc\u0631\u0647 \u0634\u062f"),this.onSaveGraph.emit(),this.dialogRef.close(M)}}}applyingDFS(E){let M={Command:E.getData("Command")};if("child"==E.getData("type"))M=Object.assign(Object.assign({},M),{_field:E.getData("_field"),_value:E.getData("_value")});else{const I=E.getAdjacentNodes({direction:"out"});let ee=[];if(I.forEach((qe,Ie)=>{let Ct=this.applyingDFS(qe);Ct?ee.push(Ct):this.errorGraph=!0}),ee.length<2||this.errorGraph)return void(this.errorGraph=!0);M=Object.assign(Object.assign({},M),{_statement:ee})}return M}}return x.\u0275fac=function(E){return new(E||x)(f.Y36(Zt.qu),f.Y36(Er.so),f.Y36(Er.WI))},x.\u0275cmp=f.Xpm({type:x,selectors:[["app-filtering-tree"]],decls:55,vars:8,consts:[["hasBackdrop","false"],["mat-dialog-content","",2,"width","100%"],["id","graph-container"],[1,"add-node-button-container"],["color","primary","mat-raised-button","",3,"click"],["mat-dialog-actions",""],["color","accent","mat-raised-button","",2,"margin-top","58rem","margin-right","2rem",3,"click"],["color","accent","mat-dialog-close","","mat-raised-button","",2,"margin-top","58rem","margin-right","2rem"],["mode","over","position","end",3,"opened"],["addSidePane",""],[1,"add-side-pane"],["mat-icon-button","",3,"click"],[3,"opened","closed"],[3,"formGroup"],[1,"wide-field"],["formControlName","_field","matInput","","name","_field","required","","type","text",1,"propery-input"],["formControlName","Command"],["value",">"],["value","<"],["value","="],["formControlName","_value","matInput","","name","_value","required","","type","text",1,"propery-input"],["color","primary","mat-raised-button","",3,"disabled","click"],[1,"add-buttons"],["color","primary","mat-raised-button","",3,"click",4,"ngIf"],["color","primary","mat-raised-button","","style","width: 10.3rem",3,"click",4,"ngIf"],["mode","side","opened","",4,"ngIf"],["color","primary","mat-raised-button","",2,"width","10.3rem",3,"click"],["mode","side","opened",""],["editSidePane",""],[1,"node-name-input"],["matInput","","placeholder","\u0646\u0627\u0645 \u06af\u0631\u0647","type","text","readonly","",2,"font-size","70%",3,"ngModel","ngModelChange"],["nodeNameInput","matInput"],[4,"ngIf"],[3,"expanded"],["matInput","","type","text",1,"propery-input",3,"ngModel","ngModelChange"],[3,"ngModel","ngModelChange"]],template:function(E,M){if(1&E){const I=f.EpF();f.TgZ(0,"mat-sidenav-container",0),f.TgZ(1,"mat-sidenav-content"),f.TgZ(2,"mat-sidenav-container",0),f.TgZ(3,"mat-sidenav-content"),f.TgZ(4,"div",1),f.TgZ(5,"div",2),f.TgZ(6,"div",3),f.TgZ(7,"button",4),f.NdJ("click",function(){return f.CHM(I),f.MAs(16).open()}),f.TgZ(8,"mat-icon"),f._uU(9,"add"),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.TgZ(10,"div",5),f.TgZ(11,"button",6),f.NdJ("click",function(){return M.handleSavingGraph()}),f._uU(12," \u0630\u062e\u06cc\u0631\u0647 "),f.qZA(),f.TgZ(13,"button",7),f._uU(14," \u0627\u0646\u0635\u0631\u0627\u0641 "),f.qZA(),f.qZA(),f.qZA(),f.TgZ(15,"mat-sidenav",8,9),f.TgZ(17,"div",10),f.TgZ(18,"h4"),f._uU(19," \u0627\u06cc\u062c\u0627\u062f \u06af\u0631\u0647 \u06cc \u062c\u062f\u06cc\u062f "),f.TgZ(20,"button",11),f.NdJ("click",function(){return f.CHM(I),f.MAs(16).close()}),f.TgZ(21,"mat-icon"),f._uU(22,"chevron_left"),f.qZA(),f.qZA(),f.qZA(),f._UZ(23,"mat-divider"),f.TgZ(24,"mat-accordion"),f.TgZ(25,"mat-expansion-panel",12),f.NdJ("opened",function(){return M.panelOpenState=!0})("closed",function(){return M.panelOpenState=!1}),f.TgZ(26,"mat-expansion-panel-header"),f.TgZ(27,"mat-panel-title"),f._uU(28," \u0637\u0631\u0627\u062d\u06cc \u06af\u0631\u0647 \u0634\u0631\u0637\u06cc "),f.qZA(),f.qZA(),f.TgZ(29,"form",13),f.TgZ(30,"mat-form-field",14),f.TgZ(31,"mat-label"),f._uU(32,"\u0646\u0627\u0645 \u0645\u062a\u063a\u06cc\u0631"),f.qZA(),f._UZ(33,"input",15),f.qZA(),f.TgZ(34,"mat-form-field",14),f.TgZ(35,"mat-label"),f._uU(36,"\u0639\u0645\u0644\u06af\u0631"),f.qZA(),f.TgZ(37,"mat-select",16),f.TgZ(38,"mat-option",17),f._uU(39," > "),f.qZA(),f.TgZ(40,"mat-option",18),f._uU(41," < "),f.qZA(),f.TgZ(42,"mat-option",19),f._uU(43,"="),f.qZA(),f.qZA(),f.qZA(),f.TgZ(44,"mat-form-field",14),f.TgZ(45,"mat-label"),f._uU(46," \u0639\u0645\u0644\u0648\u0646\u062f"),f.qZA(),f._UZ(47,"input",20),f.qZA(),f.TgZ(48,"button",21),f.NdJ("click",function(){return M.handleAddNode("condition")}),f._uU(49," \u0627\u0641\u0632\u0648\u062f\u0646 \u0634\u0631\u0637 "),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.TgZ(50,"div",22),f.YNc(51,hn,2,0,"button",23),f.YNc(52,ta,2,0,"button",24),f.qZA(),f._UZ(53,"mat-divider"),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.YNc(54,Kr,7,2,"mat-sidenav",25),f.qZA()}if(2&E){const I=f.MAs(16);f.xp6(6),f.ekj("invisible",I.opened),f.xp6(9),f.Q6J("opened",!1),f.xp6(14),f.Q6J("formGroup",M.form),f.xp6(19),f.Q6J("disabled",!M.form.valid),f.xp6(3),f.Q6J("ngIf",!M.panelOpenState),f.xp6(1),f.Q6J("ngIf",!M.panelOpenState),f.xp6(2),f.Q6J("ngIf",!!M.currentData)}},directives:[bi.TM,bi.Rh,Er.xY,ft.lW,rn.Hw,Er.H8,Er.ZT,bi.JX,Qn.d,He.pp,He.ib,He.yz,He.yK,Zt._Y,Zt.JL,Zt.sg,Ht.KE,Ht.hX,Zt.Fj,xn.Nt,Zt.JJ,Zt.u,Zt.Q7,Nn.gD,on.ey,st.O5,Zt.On],styles:[".mat-drawer[_ngcontent-%COMP%]{width:100px}.mat-drawer-container[_ngcontent-%COMP%]{height:100%}#graph-container[_ngcontent-%COMP%]{overflow:hidden;display:block;position:absolute;height:64.2rem;width:100%}.add-node-button-container[_ngcontent-%COMP%]{position:absolute;top:0;left:0;margin:var(--density-large);transition:opacity .2s ease-in;opacity:1}.add-node-button-container.invisible[_ngcontent-%COMP%]{visibility:hidden;opacity:0}.mat-sidenav[_ngcontent-%COMP%]{width:31rem}.add-side-pane[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:var(--density-large);gap:var(--density-large);padding:var(--density-large)}.add-buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row;grid-gap:var(--density-large);gap:var(--density-large)}.node-name-input[_ngcontent-%COMP%]{font-size:20px}.node-name-input[_ngcontent-%COMP%]   .mat-form-field-underline[_ngcontent-%COMP%]{background-color:transparent}.wide-field[_ngcontent-%COMP%]{width:100%}.propery-input[_ngcontent-%COMP%]{direction:ltr;text-align:left}"]}),x})();function Po(x,D){if(1&x){const E=f.EpF();f.TgZ(0,"div"),f.TgZ(1,"button",1),f.NdJ("click",function(){return f.CHM(E),f.oxw().designClicked()}),f.TgZ(2,"mat-icon",2),f._uU(3,"launch"),f.qZA(),f._uU(4," \u0637\u0631\u0627\u062d\u06cc \u0641\u06cc\u0644\u062a\u0631 "),f.qZA(),f.qZA()}}let $r=(()=>{class x{constructor(E){this.dialog=E}ngOnInit(){}designClicked(){var E;this.dialog.open(_i,{panelClass:"filterDialog",disableClose:!1,closeOnNavigation:!0,data:null===(E=this.node)||void 0===E?void 0:E.config}).afterClosed().subscribe(I=>{console.log(I),this.node.config=I})}}return x.\u0275fac=function(E){return new(E||x)(f.Y36(Er.uw))},x.\u0275cmp=f.Xpm({type:x,selectors:[["app-filter-config"]],inputs:{node:"node"},decls:1,vars:1,consts:[[4,"ngIf"],["mat-raised-button","","color","accent",3,"click"],[1,"mat-icon-rtl-mirror"]],template:function(E,M){1&E&&f.YNc(0,Po,5,0,"div",0),2&E&&f.Q6J("ngIf",void 0!==M.node)},directives:[st.O5,ft.lW,rn.Hw],styles:[""]}),x})();var na=St(946);const Do=["orderPanel"];function Sr(x,D){if(1&x){const E=f.EpF();f.TgZ(0,"mat-expansion-panel",5,6),f.TgZ(2,"mat-expansion-panel-header"),f.TgZ(3,"mat-panel-title"),f.TgZ(4,"mat-icon",7),f._uU(5," drag_handle "),f.qZA(),f.TgZ(6,"span"),f.TgZ(7,"bdo",8),f._uU(8),f.qZA(),f.qZA(),f.TgZ(9,"mat-icon",9),f._uU(10),f.qZA(),f.qZA(),f.qZA(),f.TgZ(11,"mat-form-field",10),f.TgZ(12,"mat-label"),f._uU(13,"\u0646\u0627\u0645 \u0645\u062a\u063a\u06cc\u0631"),f.qZA(),f.TgZ(14,"input",11),f.NdJ("ngModelChange",function(I){return f.CHM(E).$implicit.fieldName=I}),f.qZA(),f.qZA(),f.TgZ(15,"div",12),f.TgZ(16,"mat-checkbox",13),f.NdJ("ngModelChange",function(I){return f.CHM(E).$implicit.descending=I}),f._uU(17," \u0646\u0632\u0648\u0644\u06cc "),f.qZA(),f.TgZ(18,"button",14),f.NdJ("click",function(){const ee=f.CHM(E).index;return f.oxw(2).removeOrder(ee)}),f.TgZ(19,"mat-icon"),f._uU(20,"delete"),f.qZA(),f._uU(21," \u062d\u0630\u0641 "),f.qZA(),f.qZA(),f.qZA()}if(2&x){const E=D.$implicit;f.xp6(8),f.Oqu(E.fieldName),f.xp6(2),f.hij(" ",E.descending?"south":"north"," "),f.xp6(4),f.Q6J("ngModel",E.fieldName),f.xp6(2),f.Q6J("ngModel",E.descending)}}function Ti(x,D){if(1&x){const E=f.EpF();f.TgZ(0,"div"),f.TgZ(1,"div",1),f.TgZ(2,"h3"),f._uU(3,"\u0645\u0631\u062a\u0628\u200c\u0633\u0627\u0632\u06cc \u0628\u0631\u0627\u0633\u0627\u0633"),f.qZA(),f.TgZ(4,"button",2),f.NdJ("click",function(){return f.CHM(E),f.oxw().addOrder()}),f.TgZ(5,"mat-icon"),f._uU(6,"add"),f.qZA(),f.qZA(),f.qZA(),f.TgZ(7,"mat-accordion",3),f.NdJ("cdkDropListDropped",function(I){return f.CHM(E),f.oxw().dropOrder(I)}),f.YNc(8,Sr,22,4,"mat-expansion-panel",4),f.qZA(),f.qZA()}if(2&x){const E=f.oxw();f.xp6(8),f.Q6J("ngForOf",E.node.config.orders)}}let _=(()=>{class x{constructor(E){this.cdref=E,this.expandNewOrder=!1}ngOnInit(){}ngAfterViewChecked(){var E;this.expandNewOrder&&(this.expandNewOrder=!1,null===(E=this.firstOrderPanel)||void 0===E||E.open(),this.cdref.detectChanges())}addOrder(){var E;null===(E=this.node)||void 0===E||E.config.orders.unshift({fieldName:"",descending:!1}),this.expandNewOrder=!0}removeOrder(E){var M;null===(M=this.node)||void 0===M||M.config.orders.splice(E,1)}dropOrder(E){(0,Yn.bA)(this.node.config.orders,E.previousIndex,E.currentIndex)}}return x.\u0275fac=function(E){return new(E||x)(f.Y36(f.sBO))},x.\u0275cmp=f.Xpm({type:x,selectors:[["app-sort-config"]],viewQuery:function(E,M){if(1&E&&f.Gf(Do,5),2&E){let I;f.iGM(I=f.CRH())&&(M.firstOrderPanel=I.first)}},inputs:{node:"node"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"config-title-add"],["mat-icon-button","","color","primary",3,"click"],["cdkDropList","",3,"cdkDropListDropped"],["cdkDrag","",4,"ngFor","ngForOf"],["cdkDrag",""],["orderPanel",""],["cdkDragHandle","",1,"drag-handle"],["dir","ltr"],[1,"sort-icon"],[1,"wide-field"],["matInput","","type","text","required","",1,"propery-input",3,"ngModel","ngModelChange"],[1,"inline-row"],[3,"ngModel","ngModelChange"],["mat-raised-button","","color","warn",3,"click"]],template:function(E,M){1&E&&f.YNc(0,Ti,9,1,"div",0),2&E&&f.Q6J("ngIf",void 0!==M.node)},directives:[st.O5,ft.lW,rn.Hw,He.pp,Yn.Wj,st.sg,He.ib,Yn.Zt,He.yz,He.yK,Yn.Bh,na.Lv,Ht.KE,Ht.hX,xn.Nt,Zt.Fj,Zt.Q7,Zt.JJ,Zt.On,ir.oG],styles:["mat-panel-title[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;-webkit-user-select:none;user-select:none}.drag-handle[_ngcontent-%COMP%]{color:#0000008a;margin-left:var(--density-small);cursor:move}.sort-icon[_ngcontent-%COMP%]{transform:scale(.7)}.inline-row[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:space-between}"]}),x})();function w(x,D){if(1&x&&(f.TgZ(0,"mat-option",5),f._uU(1),f.qZA()),2&x){const E=D.$implicit,M=f.oxw(2);f.Q6J("value",E),f.xp6(1),f.hij(" ",M.joinTypeInfo[E].title," ")}}function T(x,D){if(1&x){const E=f.EpF();f.TgZ(0,"div"),f.TgZ(1,"h3"),f._uU(2,"\u0627\u0637\u0644\u0627\u0639\u0627\u062a \u0627\u0644\u062d\u0627\u0642"),f.qZA(),f.TgZ(3,"mat-form-field",1),f.TgZ(4,"mat-label"),f._uU(5,"\u0646\u0648\u0639"),f.qZA(),f.TgZ(6,"mat-select",2),f.NdJ("ngModelChange",function(I){return f.CHM(E),f.oxw().node.config.type=I}),f.YNc(7,w,2,2,"mat-option",3),f.qZA(),f.qZA(),f.TgZ(8,"mat-form-field",1),f.TgZ(9,"mat-label"),f._uU(10,"\u062f\u06cc\u062a\u0627\u0633\u062a \u0631\u0627\u0633\u062a"),f.qZA(),f.TgZ(11,"mat-select",4),f.NdJ("ngModelChange",function(I){return f.CHM(E),f.oxw().node.config.joinWith=I}),f._UZ(12,"mat-option"),f.TgZ(13,"mat-option",5),f._uU(14," \u0627\u0637\u0644\u0627\u0639\u0627\u062a \u06a9\u0627\u0631\u0628\u0631\u06cc "),f.qZA(),f.TgZ(15,"mat-option",5),f._uU(16," \u0627\u0637\u0644\u0627\u0639\u0627\u062a \u0628\u0627\u0646\u06a9\u06cc "),f.qZA(),f.TgZ(17,"mat-option",5),f._uU(18," \u0627\u0637\u0644\u0627\u0639\u0627\u062a \u0622\u0628\u0627\u0627\u062c\u062f\u0627\u062f\u06cc "),f.qZA(),f.qZA(),f.TgZ(19,"mat-error"),f._uU(20,"\u0644\u0637\u0641\u0627\u064b \u06cc\u06a9 \u062f\u06cc\u062a\u0627\u0633\u062a \u0627\u0646\u062a\u062e\u0627\u0628 \u06a9\u0646\u06cc\u062f"),f.qZA(),f.qZA(),f.TgZ(21,"mat-form-field",1),f.TgZ(22,"mat-label"),f._uU(23,"\u06a9\u0644\u06cc\u062f \u0686\u067e"),f.qZA(),f.TgZ(24,"input",6),f.NdJ("ngModelChange",function(I){return f.CHM(E),f.oxw().node.config.leftTableKey=I}),f.qZA(),f.qZA(),f.TgZ(25,"mat-form-field",1),f.TgZ(26,"mat-label"),f._uU(27,"\u06a9\u0644\u06cc\u062f \u0631\u0627\u0633\u062a"),f.qZA(),f.TgZ(28,"input",6),f.NdJ("ngModelChange",function(I){return f.CHM(E),f.oxw().node.config.rightTableKey=I}),f.qZA(),f.qZA(),f.qZA()}if(2&x){const E=f.oxw();f.xp6(6),f.Q6J("ngModel",E.node.config.type),f.xp6(1),f.Q6J("ngForOf",E.joinType),f.xp6(4),f.Q6J("ngModel",E.node.config.joinWith),f.xp6(2),f.Q6J("value",1),f.xp6(2),f.Q6J("value",2),f.xp6(2),f.Q6J("value",3),f.xp6(7),f.Q6J("ngModel",E.node.config.leftTableKey),f.xp6(4),f.Q6J("ngModel",E.node.config.rightTableKey)}}let k=(()=>{class x{constructor(){this.joinTypeInfo=Mo,this.joinType=Object.values(hr)}ngOnInit(){}}return x.\u0275fac=function(E){return new(E||x)},x.\u0275cmp=f.Xpm({type:x,selectors:[["app-join-config"]],inputs:{node:"node"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"wide-field"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["required","",3,"ngModel","ngModelChange"],[3,"value"],["matInput","","type","text","required","",1,"propery-input",3,"ngModel","ngModelChange"]],template:function(E,M){1&E&&f.YNc(0,T,29,8,"div",0),2&E&&f.Q6J("ngIf",void 0!==M.node)},directives:[st.O5,Ht.KE,Ht.hX,Nn.gD,Zt.JJ,Zt.On,st.sg,Zt.Q7,on.ey,Ht.TO,xn.Nt,Zt.Fj],styles:[""]}),x})();const R=["groupByPanel"],V=["operationPanel"];function le(x,D){if(1&x){const E=f.EpF();f.TgZ(0,"mat-expansion-panel",null,4),f.TgZ(2,"mat-expansion-panel-header"),f.TgZ(3,"mat-panel-title"),f.TgZ(4,"span"),f.TgZ(5,"bdo",5),f._uU(6),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.TgZ(7,"mat-form-field",6),f.TgZ(8,"mat-label"),f._uU(9,"\u0646\u0627\u0645 \u0645\u062a\u063a\u06cc\u0631"),f.qZA(),f.TgZ(10,"input",7),f.NdJ("ngModelChange",function(I){const qe=f.CHM(E).index;return f.oxw(3).node.config.groupBy[qe]=I}),f.qZA(),f.qZA(),f.TgZ(11,"div",8),f._UZ(12,"div"),f.TgZ(13,"button",9),f.NdJ("click",function(){const ee=f.CHM(E).index;return f.oxw(3).removeGroupBy(ee)}),f.TgZ(14,"mat-icon"),f._uU(15,"delete"),f.qZA(),f._uU(16," \u062d\u0630\u0641 "),f.qZA(),f.qZA(),f.qZA()}if(2&x){const E=D.$implicit,M=D.index,I=f.oxw(3);f.xp6(6),f.Oqu(E),f.xp6(4),f.Q6J("ngModel",I.node.config.groupBy[M])}}function te(x,D){if(1&x&&(f.TgZ(0,"mat-accordion"),f.YNc(1,le,17,2,"mat-expansion-panel",3),f.qZA()),2&x){const E=f.oxw(2);f.xp6(1),f.Q6J("ngForOf",E.node.config.groupBy)("ngForTrackBy",E.trackByIndex)}}function re(x,D){if(1&x&&(f.TgZ(0,"mat-option",14),f._uU(1),f.qZA()),2&x){const E=D.$implicit,M=f.oxw(4);f.Q6J("value",E),f.xp6(1),f.hij(" ",M.aggregateOperationTypeInfo[E].title," ")}}function j(x,D){if(1&x){const E=f.EpF();f.TgZ(0,"mat-expansion-panel",null,11),f.TgZ(2,"mat-expansion-panel-header"),f.TgZ(3,"mat-panel-title"),f.TgZ(4,"span"),f.TgZ(5,"span"),f._uU(6),f.TgZ(7,"bdo",5),f._uU(8),f.qZA(),f._uU(9," \u0628\u0647 \u0639\u0646\u0648\u0627\u0646 "),f.TgZ(10,"bdo",5),f._uU(11),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.TgZ(12,"mat-form-field",6),f.TgZ(13,"mat-label"),f._uU(14,"\u0646\u0627\u0645 \u0645\u062a\u063a\u06cc\u0631"),f.qZA(),f.TgZ(15,"input",7),f.NdJ("ngModelChange",function(I){return f.CHM(E).$implicit.fieldName=I}),f.qZA(),f.qZA(),f.TgZ(16,"mat-form-field",6),f.TgZ(17,"mat-label"),f._uU(18,"\u0646\u0648\u0639 \u0639\u0645\u0644\u06cc\u062a"),f.qZA(),f.TgZ(19,"mat-select",12),f.NdJ("ngModelChange",function(I){return f.CHM(E).$implicit.type=I}),f.YNc(20,re,2,2,"mat-option",13),f.qZA(),f.qZA(),f.TgZ(21,"mat-form-field",6),f.TgZ(22,"mat-label"),f._uU(23,"\u0646\u0627\u0645 \u0645\u062a\u063a\u06cc\u0631 \u062e\u0631\u0648\u062c\u06cc"),f.qZA(),f.TgZ(24,"input",7),f.NdJ("ngModelChange",function(I){return f.CHM(E).$implicit.outputFieldName=I}),f.qZA(),f.qZA(),f.TgZ(25,"div",8),f._UZ(26,"div"),f.TgZ(27,"button",9),f.NdJ("click",function(){const ee=f.CHM(E).index;return f.oxw(3).removeOperation(ee)}),f.TgZ(28,"mat-icon"),f._uU(29,"delete"),f.qZA(),f._uU(30," \u062d\u0630\u0641 "),f.qZA(),f.qZA(),f.qZA()}if(2&x){const E=D.$implicit,M=f.oxw(3);f.xp6(6),f.hij(" ",M.aggregateOperationTypeInfo[E.type].title," "),f.xp6(2),f.Oqu(E.fieldName),f.xp6(3),f.Oqu(E.outputFieldName),f.xp6(4),f.Q6J("ngModel",E.fieldName),f.xp6(4),f.Q6J("ngModel",E.type),f.xp6(1),f.Q6J("ngForOf",M.aggregateOperationType),f.xp6(4),f.Q6J("ngModel",E.outputFieldName)}}function $(x,D){if(1&x&&(f.TgZ(0,"mat-accordion"),f.YNc(1,j,31,7,"mat-expansion-panel",10),f.qZA()),2&x){const E=f.oxw(2);f.xp6(1),f.Q6J("ngForOf",E.node.config.operations)}}function me(x,D){if(1&x){const E=f.EpF();f.TgZ(0,"div"),f.TgZ(1,"div",1),f.TgZ(2,"h3"),f._uU(3,"\u06af\u0631\u0648\u0647\u200c\u0628\u0646\u062f\u06cc \u0628\u0631 \u0627\u0633\u0627\u0633"),f.qZA(),f.TgZ(4,"button",2),f.NdJ("click",function(){return f.CHM(E),f.oxw().addGroupBy()}),f.TgZ(5,"mat-icon"),f._uU(6,"add"),f.qZA(),f.qZA(),f.qZA(),f.YNc(7,te,2,2,"mat-accordion",0),f._UZ(8,"br"),f.TgZ(9,"div",1),f.TgZ(10,"h3"),f._uU(11,"\u0639\u0645\u0644\u06cc\u0627\u062a"),f.qZA(),f.TgZ(12,"button",2),f.NdJ("click",function(){return f.CHM(E),f.oxw().addOperation()}),f.TgZ(13,"mat-icon"),f._uU(14,"add"),f.qZA(),f.qZA(),f.qZA(),f.YNc(15,$,2,1,"mat-accordion",0),f.qZA()}if(2&x){const E=f.oxw();f.xp6(7),f.Q6J("ngIf",void 0!==E.node.config.groupBy),f.xp6(8),f.Q6J("ngIf",void 0!==E.node.config.operations)}}let G=(()=>{class x{constructor(E){this.cdref=E,this.expandNewGroupBy=!1,this.expandNewOperation=!1,this.aggregateOperationTypeInfo=si,this.aggregateOperationType=Object.values(Di)}ngOnInit(){}ngAfterViewChecked(){var E,M;let I=!1;this.expandNewGroupBy&&(this.expandNewGroupBy=!1,null===(E=this.firstGroupByPanel)||void 0===E||E.open(),I=!0),this.expandNewOperation&&(this.expandNewOperation=!1,null===(M=this.firstOperationPanel)||void 0===M||M.open(),I=!0),I&&this.cdref.detectChanges()}trackByIndex(E,M){return E}addGroupBy(){var E,M;null===(M=null===(E=this.node)||void 0===E?void 0:E.config.groupBy)||void 0===M||M.unshift(""),this.expandNewGroupBy=!0}removeGroupBy(E){var M,I;null===(I=null===(M=this.node)||void 0===M?void 0:M.config.groupBy)||void 0===I||I.splice(E,1)}addOperation(){var E,M;null===(M=null===(E=this.node)||void 0===E?void 0:E.config.operations)||void 0===M||M.unshift({fieldName:"",type:Di.count,outputFieldName:""}),this.expandNewOperation=!0}removeOperation(E){var M,I;null===(I=null===(M=this.node)||void 0===M?void 0:M.config.operations)||void 0===I||I.splice(E,1)}}return x.\u0275fac=function(E){return new(E||x)(f.Y36(f.sBO))},x.\u0275cmp=f.Xpm({type:x,selectors:[["app-aggregate-config"]],viewQuery:function(E,M){if(1&E&&(f.Gf(R,5),f.Gf(V,5)),2&E){let I;f.iGM(I=f.CRH())&&(M.firstGroupByPanel=I.first),f.iGM(I=f.CRH())&&(M.firstOperationPanel=I.first)}},inputs:{node:"node"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"config-title-add"],["mat-icon-button","","color","primary",3,"click"],[4,"ngFor","ngForOf","ngForTrackBy"],["groupByPanel",""],["dir","ltr"],[1,"wide-field"],["matInput","","type","text","required","",1,"propery-input",3,"ngModel","ngModelChange"],[1,"delete-row"],["mat-raised-button","","color","warn",3,"click"],[4,"ngFor","ngForOf"],["operationPanel",""],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(E,M){1&E&&f.YNc(0,me,16,2,"div",0),2&E&&f.Q6J("ngIf",void 0!==M.node)},directives:[st.O5,ft.lW,rn.Hw,He.pp,st.sg,He.ib,He.yz,He.yK,na.Lv,Ht.KE,Ht.hX,xn.Nt,Zt.Fj,Zt.Q7,Zt.JJ,Zt.On,Nn.gD,on.ey],styles:["mat-panel-title[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;-webkit-user-select:none;user-select:none}.drag-handle[_ngcontent-%COMP%]{color:#0000008a;margin-left:var(--density-small);cursor:move}.delete-row[_ngcontent-%COMP%]{display:flex;flex-direction:row-reverse}"]}),x})();const J=["diagram"];function K(x,D){if(1&x){const E=f.EpF();f.TgZ(0,"mat-toolbar",2),f.TgZ(1,"a",3),f.TgZ(2,"mat-icon"),f._uU(3,"call_split"),f.qZA(),f.TgZ(4,"span",4),f._uU(5," \u0633\u0646\u0627\u0631\u06cc\u0648\u0686\u06cc"),f.qZA(),f.qZA(),f.TgZ(6,"span",5),f.TgZ(7,"button",6),f.NdJ("click",function(){return f.CHM(E),f.oxw().runPipeline()}),f.TgZ(8,"mat-icon",7),f._uU(9," play_arrow "),f.qZA(),f.qZA(),f.TgZ(10,"mat-form-field",8),f.TgZ(11,"mat-label"),f._uU(12,"\u0646\u0627\u0645 \u0633\u0646\u0627\u0631\u06cc\u0648"),f.qZA(),f.TgZ(13,"input",9,10),f.NdJ("ngModelChange",function(I){return f.CHM(E),f.oxw().pipeline.name=I}),f.qZA(),f.TgZ(15,"button",11),f.TgZ(16,"mat-icon"),f._uU(17,"edit"),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.TgZ(18,"nav"),f.TgZ(19,"button",12),f.NdJ("click",function(){return f.CHM(E),f.oxw().savePipeline()}),f.TgZ(20,"mat-icon"),f._uU(21,"save"),f.qZA(),f.qZA(),f.TgZ(22,"button",13),f.NdJ("click",function(){return f.CHM(E),f.oxw().downloadPipeline()}),f.TgZ(23,"mat-icon"),f._uU(24,"file_download"),f.qZA(),f.qZA(),f.TgZ(25,"button",14),f.NdJ("click",function(){return f.CHM(E),f.MAs(29).click()}),f.TgZ(26,"mat-icon"),f._uU(27,"file_upload"),f.qZA(),f.qZA(),f.TgZ(28,"input",15,16),f.NdJ("change",function(I){return f.CHM(E),f.oxw().importPipeline(I)}),f.qZA(),f.TgZ(30,"button",17),f.TgZ(31,"mat-icon"),f._uU(32,"person"),f.qZA(),f.qZA(),f.TgZ(33,"mat-menu",null,18),f.TgZ(35,"button",19),f.TgZ(36,"mat-icon"),f._uU(37,"dashboard"),f.qZA(),f._uU(38," \u062f\u0627\u0634\u0628\u0648\u0631\u062f "),f.qZA(),f.TgZ(39,"button",20),f.TgZ(40,"mat-icon"),f._uU(41,"manage_accounts"),f.qZA(),f._uU(42," \u0645\u062f\u06cc\u0631\u06cc\u062a \u062d\u0633\u0627\u0628 "),f.qZA(),f.TgZ(43,"button",21),f.TgZ(44,"mat-icon"),f._uU(45,"exit_to_app"),f.qZA(),f._uU(46," \u062e\u0631\u0648\u062c "),f.qZA(),f.qZA(),f.qZA(),f.qZA()}if(2&x){const E=f.MAs(14),M=f.MAs(34),I=f.oxw();f.xp6(13),f.Q6J("ngModel",I.pipeline.name),f.xp6(2),f.Udp("visibility",E.focused?"":"hidden"),f.xp6(15),f.Q6J("matMenuTriggerFor",M)}}function se(x,D){1&x&&(f.TgZ(0,"h2",27),f.TgZ(1,"mat-icon"),f._uU(2,"info"),f.qZA(),f._uU(3," \u067e\u0631\u062f\u0627\u0632\u0634\u06cc \u0627\u0646\u062a\u062e\u0627\u0628 \u0646\u0634\u062f\u0647 "),f.qZA())}function fe(x,D){if(1&x&&f._UZ(0,"app-input-config",34),2&x){const E=f.oxw(3);f.Q6J("node",E.selectedNode)}}function be(x,D){if(1&x&&f._UZ(0,"app-output-config",34),2&x){const E=f.oxw(3);f.Q6J("node",E.selectedNode)}}function ke(x,D){if(1&x&&f._UZ(0,"app-filter-config",34),2&x){const E=f.oxw(3);f.Q6J("node",E.selectedNode)}}function Ae(x,D){if(1&x&&f._UZ(0,"app-sort-config",34),2&x){const E=f.oxw(3);f.Q6J("node",E.selectedNode)}}function pe(x,D){if(1&x&&f._UZ(0,"app-join-config",34),2&x){const E=f.oxw(3);f.Q6J("node",E.selectedNode)}}function ne(x,D){if(1&x&&f._UZ(0,"app-aggregate-config",34),2&x){const E=f.oxw(3);f.Q6J("node",E.selectedNode)}}function ue(x,D){if(1&x){const E=f.EpF();f.TgZ(0,"div",28),f.TgZ(1,"mat-form-field",29),f.TgZ(2,"input",9,30),f.NdJ("ngModelChange",function(I){return f.CHM(E),f.oxw(2).selectedNode.name=I}),f.qZA(),f.TgZ(4,"button",11),f.TgZ(5,"mat-icon"),f._uU(6,"edit"),f.qZA(),f.qZA(),f.TgZ(7,"mat-hint",31),f.TgZ(8,"mat-icon"),f._uU(9),f.qZA(),f.TgZ(10,"span"),f._uU(11),f.qZA(),f.qZA(),f.qZA(),f.TgZ(12,"div",32),f.YNc(13,fe,1,1,"app-input-config",33),f.YNc(14,be,1,1,"app-output-config",33),f.YNc(15,ke,1,1,"app-filter-config",33),f.YNc(16,Ae,1,1,"app-sort-config",33),f.YNc(17,pe,1,1,"app-join-config",33),f.YNc(18,ne,1,1,"app-aggregate-config",33),f.qZA(),f.qZA()}if(2&x){const E=f.MAs(3),M=f.oxw(2);f.xp6(2),f.Q6J("ngModel",M.selectedNode.name),f.xp6(2),f.Udp("visibility",E.focused?"":"hidden"),f.xp6(4),f.ekj("mat-icon-rtl-mirror",M.pipelineNodeInfo[M.selectedNode.type].iconMirrored),f.xp6(1),f.hij(" ",M.pipelineNodeInfo[M.selectedNode.type].iconName," "),f.xp6(2),f.Oqu(M.pipelineNodeInfo[M.selectedNode.type].title),f.xp6(1),f.Q6J("ngSwitch",M.selectedNode.type),f.xp6(1),f.Q6J("ngSwitchCase",M.PipelineNodeType.datasetInput),f.xp6(1),f.Q6J("ngSwitchCase",M.PipelineNodeType.datasetOutput),f.xp6(1),f.Q6J("ngSwitchCase",M.PipelineNodeType.filter),f.xp6(1),f.Q6J("ngSwitchCase",M.PipelineNodeType.sort),f.xp6(1),f.Q6J("ngSwitchCase",M.PipelineNodeType.join),f.xp6(1),f.Q6J("ngSwitchCase",M.PipelineNodeType.aggregate)}}function oe(x,D){if(1&x){const E=f.EpF();f.TgZ(0,"mat-sidenav-container"),f.TgZ(1,"mat-sidenav",22),f.YNc(2,se,4,0,"h2",23),f.YNc(3,ue,19,14,"div",24),f.qZA(),f.TgZ(4,"mat-sidenav-content"),f.TgZ(5,"app-diagram",25,26),f.NdJ("selectedNode",function(I){return f.CHM(E),f.oxw().selectedNode=I}),f.qZA(),f.qZA(),f.qZA()}if(2&x){const E=f.oxw();f.xp6(2),f.Q6J("ngIf",void 0===E.selectedNode),f.xp6(1),f.Q6J("ngIf",void 0!==E.selectedNode),f.xp6(2),f.Q6J("pipeline",E.pipeline)}}let ot=(()=>{class x{constructor(E,M,I,ee,qe,Ie){this.route=E,this.router=M,this.pipelineService=I,this.auth=ee,this.datasetStore=qe,this.snackBar=Ie,this.pipelineNodeInfo=fi,this.PipelineNodeType=ht}ngOnInit(){this.route.paramMap.subscribe(E=>{const M=parseInt(E.get("id"));this.pipelineService.get(M).subscribe({next:I=>{this.pipeline=ui(I)},error:()=>{this.snackBar.open("\u0627\u0634\u06a9\u0627\u0644 \u062f\u0631 \u062f\u0631\u06cc\u0627\u0641\u062a \u0633\u0646\u0627\u0631\u06cc\u0648","",{duration:3e3,verticalPosition:"bottom",horizontalPosition:"center",panelClass:"red-snackbar"})}})})}ngAfterContentInit(){}ngAfterViewInit(){}runPipeline(){var E;null===(E=this.pipeline)||void 0===E||E.validate(this.datasetStore).subscribe(M=>{if(br(M)){const ee=Ko(M)[0].value;return void this.snackBar.open(ee,"",{duration:3e3,verticalPosition:"bottom",horizontalPosition:"center",panelClass:"red-snackbar"})}const I=this.basicValidateAndExportPipeline();!I||this.pipelineService.update(I).subscribe({next:()=>{this.pipelineService.execute(this.pipeline.id).subscribe({next:()=>{this.snackBar.open("\u0633\u0646\u0627\u0631\u06cc\u0648 \u0628\u0627 \u0645\u0648\u0641\u0642\u06cc\u062a \u062f\u0631 \u062d\u0627\u0644 \u0627\u062c\u0631\u0627 \u0627\u0633\u062a\u061f","",{duration:3e3,verticalPosition:"bottom",horizontalPosition:"center",panelClass:"green-snackbar"})},error:ee=>{console.error(ee),this.snackBar.open("\u0627\u0634\u06a9\u0627\u0644 \u062f\u0631 \u0627\u062c\u0631\u0627\u06cc \u0633\u0646\u0627\u0631\u06cc\u0648","",{duration:3e3,verticalPosition:"bottom",horizontalPosition:"center",panelClass:"red-snackbar"})}})},error:()=>{this.snackBar.open("\u0627\u0634\u06a9\u0627\u0644 \u062f\u0631 \u0630\u062e\u06cc\u0631\u0647 \u0633\u0646\u0627\u0631\u06cc\u0648","",{duration:3e3,verticalPosition:"bottom",horizontalPosition:"center",panelClass:"red-snackbar"})}})})}basicValidateAndExportPipeline(){let M,E=this.pipeline.reorder();if(!br(E)){try{M=pr(this.pipeline)}catch(I){return console.error(I),void this.snackBar.open(I.message,"",{duration:3e3,verticalPosition:"bottom",horizontalPosition:"center",panelClass:"red-snackbar"})}return M}{console.error(E);const I=Ko(E)[0].value;this.snackBar.open(I,"",{duration:3e3,verticalPosition:"bottom",horizontalPosition:"center",panelClass:"red-snackbar"})}}savePipeline(){const E=this.basicValidateAndExportPipeline();!E||this.pipelineService.update(E).subscribe({next:()=>{this.snackBar.open("\u0633\u0646\u0627\u0631\u06cc\u0648 \u0628\u0627 \u0645\u0648\u0641\u0642\u06cc\u062a \u0630\u062e\u06cc\u0631\u0647 \u0634\u062f","",{duration:3e3,verticalPosition:"bottom",horizontalPosition:"center",panelClass:"green-snackbar"})},error:()=>{this.snackBar.open("\u0627\u0634\u06a9\u0627\u0644 \u062f\u0631 \u0630\u062e\u06cc\u0631\u0647 \u0633\u0646\u0627\u0631\u06cc\u0648","",{duration:3e3,verticalPosition:"bottom",horizontalPosition:"center",panelClass:"red-snackbar"})}})}downloadPipeline(){const E=this.basicValidateAndExportPipeline();if(!E)return;E.pipelineId=void 0;const M=JSON.stringify(E,null,4);console.log(M),Da()(M,"pipeline.json")}importPipeline(E){var M=this;return(0,mn.Z)(function*(){var I;const qe=yield E.target.files.item(0).text(),Ie=ui(JSON.parse(qe));Ie.id=null===(I=M.pipeline)||void 0===I?void 0:I.id,M.pipeline=Ie,E.target.value=""})()}logOut(){this.auth.authToken=null,this.router.navigate(["/"])}}return x.\u0275fac=function(E){return new(E||x)(f.Y36(Fr.gz),f.Y36(Fr.F0),f.Y36(Pa.n),f.Y36(fr.e),f.Y36(Jr),f.Y36(Qr.ux))},x.\u0275cmp=f.Xpm({type:x,selectors:[["app-pipeline"]],viewQuery:function(E,M){if(1&E&&f.Gf(J,5),2&E){let I;f.iGM(I=f.CRH())&&(M.diagram=I.first)}},decls:2,vars:2,consts:[["color","primary",4,"ngIf"],[4,"ngIf"],["color","primary"],["routerLink","/","mat-flat-button","","disableRipple","","color","primary"],[1,"logo-name"],[1,"pipeline-info"],["title","\u0627\u062c\u0631\u0627","mat-icon-button","","mat-raised-button","","mat-tip","",3,"click"],["color","primary",1,"mat-icon-rtl-mirror"],["floatLabel","never"],["matInput","","type","text",3,"ngModel","ngModelChange"],["pipelineNameInput","matInput"],["matSuffix","","mat-icon-button","","disabled","",2,"color","inherit"],["title","\u0630\u062e\u06cc\u0631\u0647","mat-icon-button","",3,"click"],["title","\u062f\u0627\u0646\u0644\u0648\u062f \u0633\u0646\u0627\u0631\u06cc\u0648","mat-icon-button","",3,"click"],["title","\u0622\u067e\u0644\u0648\u062f \u0633\u0646\u0627\u0631\u06cc\u0648","mat-icon-button","",3,"click"],["type","file","hidden","",3,"change"],["pipelineImport",""],["mat-button","",3,"matMenuTriggerFor"],["accountMenu","matMenu"],["mat-menu-item","","routerLink","/"],["mat-menu-item","","routerLink","/user/edit_profile"],["mat-menu-item","","click","logOut()"],["mode","side","opened","","disableClose",""],["class","no-selected-node",4,"ngIf"],["class","config-pane",4,"ngIf"],[3,"pipeline","selectedNode"],["diagram",""],[1,"no-selected-node"],[1,"config-pane"],[1,"node-name-input"],["nodeNameInput","matInput"],[1,"node-type-info"],[3,"ngSwitch"],[3,"node",4,"ngSwitchCase"],[3,"node"]],template:function(E,M){1&E&&(f.YNc(0,K,47,4,"mat-toolbar",0),f.YNc(1,oe,7,3,"mat-sidenav-container",1)),2&E&&(f.Q6J("ngIf",void 0!==M.pipeline),f.xp6(1),f.Q6J("ngIf",void 0!==M.pipeline))},directives:[st.O5,Ra.Ye,Fr.yS,ft.zs,rn.Hw,ft.lW,Ht.KE,Ht.hX,xn.Nt,Zt.Fj,Zt.JJ,Zt.On,Ht.R9,bn.p6,bn.VK,bn.OP,Fr.rH,bi.TM,bi.JX,bi.Rh,$o,Ht.bx,st.RF,st.n9,qn,Fo,$r,_,k,G],styles:["[_nghost-%COMP%]{display:grid;grid-template-rows:auto 1fr;height:100%}.mat-toolbar[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;z-index:2}.logo-name[_ngcontent-%COMP%]{font-size:20px}.pipeline-info[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:baseline;grid-gap:var(--density-large);gap:var(--density-large);font-size:16px}.pipeline-info[_ngcontent-%COMP%]     .mat-form-field-underline{background-color:transparent}nav[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;grid-gap:var(--density-large);gap:var(--density-large)}.mat-sidenav[_ngcontent-%COMP%]{width:30rem}.no-selected-node[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center;grid-gap:var(--density-normal);gap:var(--density-normal);padding:var(--density-larger);color:#0000008a}.config-pane[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100%;padding:var(--density-large);padding-top:0;grid-gap:var(--density-larger);gap:var(--density-larger)}.config-pane[_ngcontent-%COMP%]     .wide-field{width:100%}.config-pane[_ngcontent-%COMP%]     .propery-input{direction:ltr;text-align:left}.config-pane[_ngcontent-%COMP%]     .config-title-add{display:flex;flex-direction:row;align-items:baseline;justify-content:space-between}.node-name-input[_ngcontent-%COMP%]{font-size:20px}.node-name-input[_ngcontent-%COMP%]     .mat-form-field-underline{background-color:transparent}.node-type-info[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;grid-gap:var(--density-small);gap:var(--density-small)}"]}),x})();var dt=St(4473),et=St(5826);const q=[{path:":id",canActivate:[et.a],component:ot},{path:"",canActivate:[et.a],component:ps},{path:"**",redirectTo:"/"}];let ye=(()=>{class x{}return x.\u0275fac=function(E){return new(E||x)},x.\u0275mod=f.oAB({type:x}),x.\u0275inj=f.cJS({providers:[tr,fr.e,Jr,et.a],imports:[[st.ez,Fr.Bz.forChild(q),dt.q,Zt.u5,Zt.UX]]}),x})()},7646:function(Yr,sn,St){(Yr=St.nmd(Yr)).exports=function(){"use strict";function st(e){return"function"==typeof e||"[object Function]"===er.call(e)}function mn(e){var i,t=(i=Number(e),isNaN(i)?0:0!==i&&isFinite(i)?(0<i?1:-1)*Math.floor(Math.abs(i)):i);return Math.min(Math.max(t,0),dr)}var er,dr;Array.prototype.fill||Object.defineProperty(Array.prototype,"fill",{value:function(e){if(null==this)throw new TypeError("this is null or not defined");for(var t=Object(this),n=t.length>>>0,i=arguments[1]>>0,r=i<0?Math.max(n+i,0):Math.min(i,n),o=arguments[2],a=void 0===o?n:o>>0,s=a<0?Math.max(n+a,0):Math.min(a,n);r<s;)t[r]=e,r++;return t}}),Array.prototype.copyWithin||(Array.prototype.copyWithin=function(e,t){if(null==this)throw new TypeError("this is null or not defined");var n=Object(this),i=n.length>>>0,r=e>>0,o=r<0?Math.max(i+r,0):Math.min(r,i),a=t>>0,s=a<0?Math.max(i+a,0):Math.min(a,i),l=arguments[2],u=void 0===l?i:l>>0,d=u<0?Math.max(i+u,0):Math.min(u,i),c=Math.min(d-s,i-o),h=1;for(s<o&&o<s+c&&(h=-1,s+=c-1,o+=c-1);0<c;)s in n?n[o]=n[s]:delete n[o],s+=h,o+=h,c--;return n}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(e){if(null==this)throw new TypeError;var t=Object(this),n=t.length>>>0;if(0==n)return-1;var i=n-1;1<arguments.length&&((i=Number(arguments[1]))!=i?i=0:0!=i&&i!=1/0&&i!=-1/0&&(i=(0<i?1:-1)*Math.floor(Math.abs(i))));for(var r=0<=i?Math.min(i,n-1):n-Math.abs(i);0<=r;r--)if(r in t&&t[r]===e)return r;return-1}),Array.from||(Array.from=(er=Object.prototype.toString,dr=Math.pow(2,53)-1,function(e,t,n){var i=Object(e);if(null==e)throw new TypeError("Array.from requires an array-like object - not null or undefined");var r,o=1<arguments.length?t:void 0;if(void 0!==o){if(!st(o))throw new TypeError("Array.from: when provided, the second argument must be a function");2<arguments.length&&(r=n)}for(var a,s=mn(i.length),l=st(this)?Object(new this(s)):new Array(s),u=0;u<s;)a=i[u],l[u]=o?void 0===r?o(a,u):o.call(r,a,u):a,u+=1;return l.length=s,l})),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),i=n.length>>>0;if(0==i)return!1;for(var r,o,a=0|t,s=Math.max(0<=a?a:i-Math.abs(a),0);s<i;){if((r=n[s])===(o=e)||"number"==typeof r&&"number"==typeof o&&isNaN(r)&&isNaN(o))return!0;s++}return!1}}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var i=arguments[1],r=0;r<n;){var o=t[r];if(e.call(i,o,r,t))return o;r++}},configurable:!0,writable:!0});var xr=[Uint32Array,Uint16Array,Uint8Array,Int32Array,Int16Array,Int8Array,Float32Array,Float64Array],Zi=["join","slice","reverse","forEach","map","includes","copyWithin","reduce","indexOf","sort","filter","every","some","fill"];ArrayBuffer.isView||(ArrayBuffer.isView=function(e){for(var t=0;t<xr.length;++t)if(e instanceof xr[t])return!0;return!1});for(var cr,To=function(e){return function(t,n){return new e(Array.prototype.slice.call(this,t,n))}},hr=function(e){for(var t=0,n=Zi;t<n.length;t++){var i=n[t];if(!e.prototype[i]){var r="slice"===i?To(e):Array.prototype[i];e.prototype[i]=r}}e.from||(e.from=function(o,a,s){var l=e.__proto__;if("function"!=typeof this)throw new TypeError("# is not a constructor");if(this.__proto__!==l)throw new TypeError("this is not a typed array.");if("function"!=typeof(a=a||function(h){return h}))throw new TypeError("specified argument is not a function");if(!(o=Object(o)).length)return new this(0);for(var u=[],d=0;d<o.length;d++)u.push(o[d]);var c=new this((u=u.map(a,s)).length);for(d=0;d<c.length;d++)c[d]=u[d];return c})},Mo=0,Di=xr;Mo<Di.length;Mo++)hr(Di[Mo]);function si(){}function ht(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],Fa(e,this)}function fi(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,ht._immediateFn(function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var i;try{i=n(e._value)}catch(r){return void Ri(t.promise,r)}Ci(t.promise,i)}else(1===e._state?Ci:Ri)(t.promise,e._value)})):e._deferreds.push(t)}function Ci(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof ht)return e._state=3,e._value=t,void lo(e);if("function"==typeof n)return void Fa((i=n,r=t,function(){i.apply(r,arguments)}),e)}e._state=1,e._value=t,lo(e)}catch(o){Ri(e,o)}var i,r}function Ri(e,t){e._state=2,e._value=t,lo(e)}function lo(e){2===e._state&&0===e._deferreds.length&&ht._immediateFn(function(){e._handled||ht._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)fi(e,e._deferreds[t]);e._deferreds=null}function cs(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function Fa(e,t){var n=!1;try{e(function(i){n||(n=!0,Ci(t,i))},function(i){n||(n=!0,Ri(t,i))})}catch(i){if(n)return;n=!0,Ri(t,i)}}"undefined"==typeof CanvasRenderingContext2D||CanvasRenderingContext2D.prototype.setLineDash||(CanvasRenderingContext2D.prototype.setLineDash=function(e){}),Math.log2||(Math.log2=function(e){return Math.log(e)*Math.LOG2E}),Math.sign||(Math.sign=function(e){return(0<e?1:0)-(e<0?1:0)||+e}),Number.isNaN||(Number.isNaN=function(e){return"number"==typeof e&&isNaN(e)}),Number.MAX_SAFE_INTEGER||Object.defineProperty(Number,"MAX_SAFE_INTEGER",{enumerable:!1,configurable:!1,writable:!1,value:Math.pow(2,53)-1}),cr=setTimeout,ht.prototype.catch=function(e){return this.then(null,e)},ht.prototype.then=function(e,t){var n=new this.constructor(si);return fi(this,new cs(e,t,n)),n},ht.all=function(e){var t=Array.prototype.slice.call(e);return new ht(function(n,i){if(0===t.length)return n([]);var r=t.length;function o(s,l){try{if(l&&("object"==typeof l||"function"==typeof l)){var u=l.then;if("function"==typeof u)return void u.call(l,function(d){o(s,d)},i)}t[s]=l,0==--r&&n(t)}catch(d){i(d)}}for(var a=0;a<t.length;a++)o(a,t[a])})},ht.resolve=function(e){return e&&"object"==typeof e&&e.constructor===ht?e:new ht(function(t){t(e)})},ht.reject=function(e){return new ht(function(t,n){n(e)})},ht.race=function(e){return new ht(function(t,n){for(var i=0,r=e.length;i<r;i++)e[i].then(t,n)})},ht._immediateFn="object"==typeof global&&"function"==typeof global.setImmediate&&function(e){global.setImmediate(e)}||function(e){cr(e,0)},ht._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},ht._setImmediateFn=function(e){ht._immediateFn=e},ht._setUnhandledRejectionFn=function(e){ht._unhandledRejectionFn=e},"object"!=typeof global||global.Promise||(global.exports=ht),"object"!=typeof window||"Promise"in window||(window.Promise=ht),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var n=this.toString();("number"!=typeof t||!isFinite(t)||Math.floor(t)!==t||t>n.length)&&(t=n.length);var i=n.lastIndexOf(e,t-=e.length);return-1!==i&&i===t}),String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(t||0,e.length)===e}),String.prototype.includes||(String.prototype.includes=function(e,t){return"number"!=typeof t&&(t=0),!(t+e.length>this.length)&&-1!==this.indexOf(e,t)}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e){var t=arguments;if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),i=1;i<arguments.length;i++){var r=t[i];if(null!=r)for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])}return n},writable:!0,configurable:!0});var Qo=function(e,t){return(Qo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var r in i)i.hasOwnProperty(r)&&(n[r]=i[r])})(e,t)};function bt(e,t){function n(){this.constructor=e}Qo(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var Mt=function(){return(Mt=Object.assign||function(e){for(var t,n=arguments,i=1,r=arguments.length;i<r;i++)for(var o in t=n[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function Io(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}var Yn={},co={},hs={},br=function(e){return null};if("object"==typeof global&&(co=global),"object"==typeof window&&(hs=window),"function"==typeof Yr.require){var Ko=Yr.require.bind(Yr);br=function(e){try{return Ko(e)}catch(t){return null}}}else"function"==typeof co.require&&(br=function(e){var t=Yr.require;try{return t(e)}catch(n){return null}});function xi(e,t){var n=(void 0===t?{}:t).throwOnError,i=null;if(!i&&e&&(i=Yn[e]),!i&&e&&(i=br(e)),!i&&e&&(i=hs[e]),!i&&e&&(i=co[e]),i||!n)return i;var r=['unable to find module "'+e+'"; make sure one of these statements is true:',"- Ogma.libraries['"+e+"'] is set to the right library","- require('"+e+"') returns the right library","- window['"+e+"'] is set to the right library"].join("\n");throw new Error(r)}function Xr(e,t){for(var n=1,i=e.length;n<i;n++){for(var r=e[n],o=n;0<o&&t.get(e[o-1])>t.get(r);)e[o]=e[o-1],--o;e[o]=r}return e}function pr(e,t){for(var n=1,i=e.length;n<i;n++){for(var r=e[n],o=n;0<o&&t.get(e[o-1])<t.get(r);)e[o]=e[o-1],--o;e[o]=r}return e}function ui(e){return Array.isArray(e)||ArrayBuffer.isView(e)}function f(e){return Array.isArray(e)?e:[e]}function Fr(e){for(var t=[],n=0;n<e.length;++n){var i=e[n];if(Array.isArray(i))for(var r=0;r<i.length;++r)t.push(i[r]);else t.push(i)}return t}function Pa(e,t){var n=e.indexOf(t);return-1!==n&&(e.splice(n,1),!0)}function ps(e,t){for(var n,i,r=0,o=e.length-1;r<=o;)if((i=e[n=(r+o)/2|0])<t)r=1+n;else{if(!(t<i))return n;o=n-1}return-1}function Pr(e){if(!e)return[];if("string"==typeof e)return e.split(".");if(Array.isArray(e)){for(var t=0;t<e.length;++t)if("string"!=typeof e[t])throw new TypeError(e[t]+" is not a string");return e.slice()}throw new TypeError('invalid property path "'+e+'": expected string or array of strings')}function Da(e,t,n){var i,r,o;if(0===t)return function(){e.apply(n,arguments)};function a(){i=!1,r&&(o.apply(n,r),r=null)}return o=function(){var s;return i?r=arguments:(s=e.apply(n,arguments),setTimeout(a,t),i=!0),s}}function fr(){return 120===new Uint8Array(new Uint32Array([305419896]).buffer)[0]}function Gi(e){return e.reduce(function(t,n){return t.then(n)},Promise.resolve())}function Jr(e,t,n,i,r,o,a,s){return e+r+256*(t+o)+65536*(n+a)+16777216*(i+s)}function Qr(e){return!(null===e||"object"!=typeof e||ui(e)||e instanceof RegExp||"undefined"!=typeof HTMLElement&&e instanceof HTMLElement)}function Ra(e){for(var t=Object.keys(e),n=new Array(t.length),i=0;i<t.length;++i)n[i]=e[t[i]];return n}function ft(e,t,n){if(Array.isArray(e))return e.forEach(t,n);if(!Qr(e))throw new Error("forEach: invalid argument "+JSON.stringify(e));var i=Object.keys(e);if(void 0!==n)for(var r=0;r<i.length;++r){var o=i[r];t.call(n,e[o],o)}else for(r=0;r<i.length;++r)t(e[o=i[r]],o)}function rn(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=rn(e[n]);return t}if(!Jt(e))return e;var i={},r=Object.keys(e);for(n=0;n<r.length;++n){var o=r[n];i[o]=rn(e[o])}return i}function Ht(e,t,n){for(var i="string"==typeof t?t.split("."):t,r=0;r<i.length-1;++r){var o=i[r],a=e[o];a||(e[o]=a={}),e=a}e[i[i.length-1]]=n}function xn(e,t){var n=Pr(t);if(!n.length)return e;if(e){for(var i=0;i<n.length-1;++i){var r=e[n[i]];if(!r)return;e=r}return e[n[n.length-1]]}}function Zt(e,t,n){void 0===n&&(n="."),t=t||function(h){return!Qr(h)};for(var i={},r=Object.keys(e),o=0;o<r.length;++o){var a=r[o],s=e[a];if(t(s))i[a]=s;else for(var l=Zt(s,t),u=Object.keys(l),d=0;d<u.length;d++){var c=u[d];i[""+a+n+c]=l[c]}}return i}function bn(e){for(var t={},n=Object.keys(e),i=0;i<n.length;++i){var r=n[i];Ht(t,r,e[r])}return t}function bi(e,t,n){void 0===n&&(n=[]);for(var i=Object.keys(e),r=0;r<i.length;++r){var o=i[r],a=e[o],s=t?t+o:o;Jt(a)?bi(a,s+".",n):n.push(s)}return n}function Xn(e,t){if(void 0===t&&(t=[]),Jt(e))for(var n=0,i=Object.keys(e);n<i.length;n++)Xn(e[i[n]],t);else t.push(e);return t}function qi(e){for(var t in e)"function"==typeof e[t]&&delete e[t];return e}function on(e,t){if(void 0===e)return rn(t);if(!Qr(e))return e;for(var n={},i=0,r=Object.keys(t);i<r.length;i++){var o=r[i],a=t[o],s=e[o];n[o]=Qr(a)?on(s,a):void 0===s?rn(a):s}return n}function Jt(e){return e&&(e.constructor===Object||!e.constructor)}function tr(e,t){if(!Jt(t)||!Jt(e))return t;for(var n=Object.assign({},e),i=Object.keys(t),r=0;r<i.length;++r){var o=i[r];n[o]=tr(n[o],t[o])}return n}function za(e,t){return null==t?e:t.reduce(function(n,i){return n[i]=e[i],n},{})}var ko,fs=(ko=0,"undefined"!=typeof requestAnimationFrame?requestAnimationFrame:function(e){var t=Date.now(),n=Math.min(16,Math.max(0,16-(t-ko))),i=ko=t+n;return setTimeout(function(){return e(i)},n)}),gs="undefined"!=typeof cancelAnimationFrame?cancelAnimationFrame:function(e){return clearTimeout(e)};function Oo(e,t){return fs(function(n){e.call(t,n)})}function li(e){e&&gs(e)}var Ba,Zn,Va,Dr,Ei="object"==typeof global&&null!==global&&void 0!==global.it,nr="undefined"!=typeof document,Hi="undefined"!=typeof window,Rr=Hi&&!window.__OGMA_HEADLESS,ho=Rr&&nr,No=(Jn.prototype.open=function(e,t){this.method=e,this.url=t,Jn.onSend&&Jn.onSend(this)},Jn.prototype.respond=function(e,t,n){this.readyState=4,this.status=e,this.headers=t,this.responseText=n,this.response=n,this.onreadystatechange()},Jn.prototype.send=function(){this.readyState=4},Jn.onCreate=null,Jn.onSend=null,Jn);function Jn(){this.method=null,this.url=null,this.status=0,this.readyState=0,this.headers={},this.responseText=null,this.response=null,Jn.onCreate&&Jn.onCreate(this)}var Lo=(Wi.prototype.readAsDataURL=function(e){this._blob=e,Wi.onRead&&Wi.onRead(this)},Wi.prototype.load=function(e){this.result="function"==typeof e?e(this._blob):e,this.onload&&this.onload()},Wi.onCreate=null,Wi.onRead=null,Wi);function Wi(){this.onload=null,Wi.onCreate&&Wi.onCreate(this)}function zi(){return Zn||{createElementNS:function(){return null},createElement:function(){return null},implementation:{createDocument:function(){throw new Error('unable to create XML document; if you use Node JS install the "xmldom" package')}}}}function po(e,t){var n=e.style[t];if((!n||"auto"===n)&&zi().defaultView){var i=document.defaultView.getComputedStyle(e,null);n=i?i[t]:null}return"auto"===n?null:n}Ba=xi("xmldom"),Zn=nr?document:Ba?(new Ba.DOMImplementation).createDocument():null,Va="undefined"!=typeof XMLHttpRequest?XMLHttpRequest:No,Dr="undefined"!=typeof FileReader?FileReader:Lo;var Bi=(Object.defineProperty(gi.prototype,"offsetWidth",{get:function(){return parseFloat(this.style.width)},enumerable:!0,configurable:!0}),Object.defineProperty(gi.prototype,"offsetHeight",{get:function(){return parseFloat(this.style.height)},enumerable:!0,configurable:!0}),Object.defineProperty(gi.prototype,"firstChild",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(gi.prototype,"parentNode",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(gi.prototype,"classList",{get:function(){return{length:0,value:"",add:function(){},remove:function(){},contains:function(e){return!1},item:null}},enumerable:!0,configurable:!0}),Object.defineProperty(gi.prototype,"innerHTML",{get:function(){return""},set:function(e){},enumerable:!0,configurable:!0}),gi.prototype.appendChild=function(){},gi.prototype.removeChild=function(){},gi.prototype.addEventListener=function(){},gi.prototype.removeEventListener=function(){},gi.prototype.insertBefore=function(){},gi.prototype.contains=function(e){return!1},gi);function gi(){this.onmousewheel=function(){},this.__dummy=!0,this.style={},this.clientWidth=0,this.clientHeight=0,this.childNodes=[],this.style={width:"0px",height:"0px",top:null,left:null,position:"",backgroundColor:null}}function $o(){return new Bi}function Nn(){return Hi&&window.devicePixelRatio||1}function Gn(e){var t,n,i,r=";base64,";if(-1===e.indexOf(r))return n=(t=e.split(","))[0].split(":")[1],ir(i=decodeURIComponent(t[1]),n);n=(t=e.split(r))[0].split(":")[1];for(var o=(i=window.atob(t[1])).length,a=new Uint8Array(o),s=0;s<o;++s)a[s]=i.charCodeAt(s);return ir([a],n)}var qn=function(e,t){this.data=e,this.type=t};function ir(e,t){return"undefined"!=typeof Blob?new Blob(e,{type:t}):new qn(e,t)}function cn(e,t,n){if(!Rr)return e;var i=null,r=null,o=null;if(window.Blob?(i="blob"===n?e:"dataURL"===n?Gn(e):ir([e],"text/xml"),r=window.URL.createObjectURL(i)):o="data:text/xml;charset=UTF-8,"+encodeURIComponent('<?xml version="1.0" encoding="UTF-8"?>')+encodeURIComponent(e),navigator.msSaveBlob)navigator.msSaveBlob(i,t);else if(navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(i,t);else{var a=document.createElement("a");a.setAttribute("href",window.Blob?r:o),a.setAttribute("download",t),document.body.appendChild(a),a.click(),document.body.removeChild(a)}return r&&setTimeout(function(){window.URL.revokeObjectURL(r)},0),e}function Fo(e,t,n,i){if(void 0===i&&(i=Nn()),e.style.width=t+"px",e.style.height=n+"px","IMG"===e.tagName||"CANVAS"===e.tagName){var r=e;r.width=t*i,r.height=n*i}}function Er(e,t){ft(t,function(n,i){void 0!==n&&e.setAttribute(i,n)})}var ea="http://www.w3.org/2000/svg",Qn="http://www.w3.org/2000/xmlns/",He="http://www.w3.org/1999/xlink";function hn(e,t){var n=Zn.createElementNS(ea,e);return n.style||(n.style={}),t&&Er(n,t),n}function ta(e){return Zn.createTextNode(e)}function _s(e){return"undefined"==typeof Image?Promise.resolve(null):new Promise(function(t){var n=new Image;n.src=e,n.onload=function(){return t(n)},n.onerror=function(){return t(null)}})}function Kr(e){if(0===e.indexOf("http://")||0===e.indexOf("https://"))return e;var t=window.location.origin,n=window.location.pathname,i=n.lastIndexOf("/");return-1===i?t+"/"+e:t+n.substr(0,i)+"/"+e}function _i(e){return new Promise(function(t,n){var i=new Va;i.open("GET",Kr(e),!0),i.onreadystatechange=function(){if(4===i.readyState){var r=i.status;200===r?t(i.responseText):n(0!==r?new Error('cannot retrieve file at url "'+e+'"; the server responded with status code '+r+"."):new Error('cannot send XMLHttpRequest to url "'+e+"\"; if you're using the local file protocol this is most likely the cause."))}},i.onerror=function(){n(new Error('cannot retrieve file at url "'+e+'"; the XMLHttpRequest failed.'))},i.send()})}function Po(e){return"undefined"!=typeof HTMLElement&&e instanceof HTMLElement}function $r(e,t){e.style.cursor=t,e.style.cursor!==t&&(e.style.cursor="-webkit-"+t)}function na(e){return new Promise(function(t,n){var i=new Va;i.responseType="blob",i.open("GET",Kr(e),!0),i.onreadystatechange=function(){4===i.readyState&&(200===i.status?t(i.response):n(i.status))},i.onerror=function(r){return n(r)},i.send()})}function Do(e){return na(e).then(function(t){return new Promise(function(n,i){var r=new Dr;r.onerror=i,r.onload=function(){return n(r.result)},r.readAsDataURL(t)})})}function Sr(e,t){void 0===t&&(t=!0);var n=t?"&#13;":"\n";return(""+e).replace(/&/g,"&amp;").replace(/'/g,"&apos;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r\n/g,n).replace(/[\r\n]/g,n)}var Ti={0:"left",1:"middle",2:"right"};function _(e){if(e.baseURI)return e.baseURI;var t=e.getElementsByTagName("base");return 0<t.length?t[0].href:e.URL||e.location.href}function w(e,t,n,i){return new Promise(function(r){var o=t,a=Date.now(),s=(n-t)*Math.min(1,1/(i/16));!function l(){Date.now()-a<i?(o=Math.min(1,Math.max(0,o+s)),e.style.opacity=o.toString(),Oo(l)):r()}()})}var T="undefined"!=typeof performance&&performance.now?function(){return 0|performance.now()}:function(){return Date.now()},k=T();function R(){return T()-k}function V(){var e=new Date,t=e.getDate(),n=e.getMonth()+1;return e.getFullYear()+"-"+(n<10?"0"+n:n)+"-"+(t<10?"0"+t:t)}function le(){var e=new Date;return"["+te((e.getUTCHours()-(e.getTimezoneOffset()/60|0))%24)+":"+te(e.getUTCMinutes())+":"+te(e.getUTCSeconds())+":"+te(e.getUTCMilliseconds(),3)+"]"}function te(e,t){void 0===t&&(t=2);for(var n=Math.pow(10,t-1),i=String(e);1<n;)e<n&&(i="0"+i),n/=10;return i}var re,j,$=Hi&&!window.PointerEvent&&!!window.MSPointerEvent,me=Hi&&!(!window.PointerEvent&&!$),G=$?"MSPointerDown":"pointerdown",J=$?"MSPointerMove":"pointermove",K=$?"MSPointerUp":"pointerup",se=$?"MSPointerCancel":"pointercancel",fe={},be=0;function ke(e){return"mouse"===e.pointerType||e.MSPOINTER_TYPE_MOUSE&&e.pointerType===e.MSPOINTER_TYPE_MOUSE}function Ae(e){return"mouse"!==e.pointerType&&e.MSPOINTER_TYPE_MOUSE&&e.pointerType!==e.MSPOINTER_TYPE_MOUSE}function pe(e){fe[e.pointerId]=e}function ne(e){fe[e.pointerId]&&(fe[e.pointerId]=e)}function ue(e){delete fe[e.pointerId]}function oe(e,t){for(var n in e.touches=[],fe)e.touches.push(fe[n]);e.changedTouches=[e],t(e)}function ye(e,t,n,i){return n===re.START?e(t,G,i,!1):n===re.MOVE?e(t,J,i,!1):n===re.END?(e(t,K,i,!1),e(t,se,i,!1)):void 0}(j=re=re||{}).START="touchstart",j.MOVE="touchmove",j.END="touchend",j.CANCEL="touchcancel";var x,D,E=(M.prototype.onMounted=function(e,t){},M.prototype.destroy=function(e){},M);function M(){}(D=x=x||{}).MOVE="move",D.DOWN="down",D.UP="up",D.CLICK="click",D.DOUBLE_CLICK="doubleClick",D.HOVER="hover",D.UNHOVER="unhover",D.WHEEL="wheel",D.DRAG_START="dragStart",D.DRAG_PROGRESS="dragProgress",D.DRAG_END="dragEnd",D.GESTURE_START="gestureStart",D.GESTURE_PROGRESS="gestureProgress",D.GESTURE_END="gestureEnd",D.RESIZE="resize",D.ADD_NODES="addNodes",D.ADD_EDGES="addEdges",D.REMOVE_NODES="removeNodes",D.REMOVE_EDGES="removeEdges",D.BEFORE_REMOVE_NODES="beforeRemoveNodes",D.BEFORE_REMOVE_EDGES="beforeRemoveEdges",D.CLEAR_GRAPH="clear",D.EXCLUDED_STATE_CHANGE="excludedStateChange",D.UPDATE_ATTRIBUTES="updateAttributes",D.RENDERER_STATE_CHANGE="rendererStateChange",D.UPDATE_NODE_DATA="updateNodeData",D.UPDATE_EDGE_DATA="updateEdgeData",D.SET_DATA="setData",D.START_ZOOM="startZoom",D.VIEW_CHANGED="viewChanged",D.MOVE_END="moveEnd",D.CAMERA_MOVE="cameraMove",D.CAMERA_ROTATE="cameraRotate",D.CAMERA_PAN="cameraPan",D.CAMERA_ZOOM="cameraZoom",D.NODES_DRAG_START="startMoveNodesByDragging",D.NODES_DRAG_PROGRESS="progressMoveNodesByDragging",D.NODES_DRAG_END="endMoveNodesByDragging",D.ANIMATE="animate",D.NEW_FRAME="newFrame",D.BEFORE_NEW_FRAME="beforeNewFrame",D.AFTER_NEW_FRAME="afterNewFrame",D.SET_CONTAINER="setContainer",D.RELOAD_FONTS="reloadFonts",D.MOUSE_LEAVE="mouseLeave",D.MOUSE_DOWN="mouseDown",D.MOUSE_UP="mouseUp",D.MOUSE_MOVE="mouseMove",D.MOUSE_WHEEL="mouseWheel",D.MOUSE_CLICK="mouseClick",D.MOUSE_DOUBLE_CLICK="mouseDoubleClick",D.DOCUMENT_MOUSE_MOVE="documentMouseMove",D.DOCUMENT_MOUSE_UP="documentMouseUp",D.VIRTUAL_DOWN="virtualDown",D.VIRTUAL_UP="virtualUp",D.VIRTUAL_MOVE="virtualMove",D.VIRTUAL_CLICK="virtualClick",D.VIRTUAL_DOUBLE_CLICK="virtualDoubleClick",D.VIRTUAL_WHEEL="virtualWheel",D.TOUCH_DOWN="touchDown",D.TOUCH_UP="touchUp",D.TOUCH_TAP="touchTap",D.TOUCH_DOUBLE_TAP="touchDoubleTap",D.TOUCH_MOVE="touchMove",D.TOUCH_START_GESTURE="touchStartGesture",D.TOUCH_PROGRESS_GESTURE="touchProgressGesture",D.TOUCH_END_GESTURE="touchEndGesture",D.DOCUMENT_TOUCH_MOVE="documentTouchMove",D.DOCUMENT_TOUCH_UP="documentTouchUp",D.GEO_LOADED="geoLoaded",D.GEO_ENABLED="geoEnabled",D.GEO_DISABLED="geoDisabled",D.GEO_READY="geoReady",D.TOOLTIP_HIDE="hideTooltip",D.TOOLTIP_SHOW="showTooltip",D.CONNECT_NODES="connectNodes",D.LAYOUT_START="layoutStart",D.LAYOUT_END="layoutEnd",D.LAYOUT_COMPUTED="layoutComputed";var I,ee=["graphics","legend","brand"],qe=(bt(Ie,I=E),Ie.prototype.onMounted=function(e,t){t.container&&e.setContainer(t.container)},Ie.prototype.addWindowEventListener=function(e,t,n){this._isRealBrowser&&this.addElementEventListener(window,e,t,n)},Ie.prototype.addDocumentEventListener=function(e,t,n){return this._isDocumentReady&&this.addElementEventListener(document.documentElement,e,t,n),t},Ie.prototype.removeDocumentEventListener=function(e,t){this._isDocumentReady&&document.documentElement.removeEventListener(e,t)},Ie.prototype.addMediaListener=function(e,t){if(this._isDocumentReady&&"function"==typeof window.matchMedia){var n=window.matchMedia(e);n.addListener(t),this._onDetachDom.push(function(){return n.removeListener(t)})}},Ie.prototype.addElementEventListener=function(e,t,n,i){return this._isDestroyed||(e.addEventListener(t,n,i),this._onDetachDom.push(function(){return e.removeEventListener(t,n,i)})),n},Ie.prototype.detachFromDom=function(){this._onDetachDom.forEach(function(e){return e()}),this._onDetachDom=null,this._emptyContainer()},Ie.prototype.setTimeout=function(e,t){var n=this;void 0===t&&(t=0);var i=setTimeout(function(){n._timeouts.splice(n._timeouts.indexOf(i),1),e()},t);return this._timeouts.push(i),i},Ie.prototype.clearTimeout=function(e){return e&&(clearTimeout(e),this._timeouts.splice(this._timeouts.indexOf(e),1)),null},Ie.prototype.clearAllTimeouts=function(){this._timeouts.forEach(clearTimeout),this._timeouts=[]},Ie.prototype.stopFrames=function(){this._isDestroyed=!0,this._nextFrame&&(li(this._nextFrame),this._nextFrame=null)},Ie.prototype.isDestroyed=function(){return this._isDestroyed},Ie.prototype.getDimensions=function(){return{width:this._width,height:this._height}},Ie.prototype.setDimensions=function(e){this._resize(e)},Ie.prototype.setLayer=function(e,t,n){var i=(void 0===n?{}:n).automaticResize,r=void 0!==i&&i;t&&(t._ogmaLayer=e,r&&(t.style.position="absolute",t.style.top="0px",t.style.left="0px",Fo(t,this._width,this._height,Nn()))),this._layers[e]={element:t,automaticResize:r},this._updateContainerContent()},Ie.prototype.setContainer=function(e){if("string"==typeof e){var t=e;if(!(e=document.getElementById(t)))throw new Error('unable to find DOM element with id "'+t+'"')}if(e!==this._container){var n=this._container;this._isFullScreen=!1,this._container=e,this._resize(),this._updateContainerContent(),this._events.fire(x.SET_CONTAINER,{element:e,prevElement:n})}},Ie.prototype.getContainer=function(){return this._container},Ie.prototype.appendElement=function(e){null!==this._container&&this._container.appendChild(e)},Ie.prototype.focus=function(){this._focus=!0},Ie.prototype.blur=function(){this._focus=!1},Ie.prototype.hasFocus=function(){return this._focus},Ie.prototype.forceResize=function(){this._resize()},Ie.prototype._beforeOrAfterNextFrame=function(e){var t=e?this._afterNextFramePromises:this._beforeNextFramePromises,n=new Promise(function(i){t.push(function(){return i(),n})});return this._refresh(),n},Ie.prototype.beforeNextFrame=function(){return this._beforeOrAfterNextFrame(!1)},Ie.prototype.afterNextFrame=function(){return this._beforeOrAfterNextFrame(!0)},Ie.prototype.refresh=function(e){e&&(this._refreshUntil=Math.max(this._refreshUntil,e)),this._refresh()},Ie.prototype._emptyContainer=function(){if(this._container){for(var e=[],t=0;t<this._container.childNodes.length;++t){var n=this._container.childNodes[t];n._ogmaLayer&&e.push(n)}for(t=0;t<e.length;++t)this._container.removeChild(e[t])}},Ie.prototype._fillContainer=function(){var e=this;if(this._container){var t=po(this._container,"position");"absolute"!==t&&"relative"!==t&&"fixed"!==t&&(this._container.style.position="relative");var n=this._container.firstChild;ee.forEach(function(i){var r=e._layers[i];r&&r.element&&e._container.insertBefore(r.element,n)})}},Ie.prototype._updateContainerContent=function(){this._emptyContainer(),this._fillContainer()},Ie.prototype._resize=function(e){if(this._container||e){var t,n,i=this._width,r=this._height;if(this._container){var o=this._settings.get("minimumWidth"),a=this._settings.get("minimumHeight"),l=this._container.clientHeight||1;t=Math.max(o,e?e.width:this._container.clientWidth||1),n=Math.max(a,e?e.height:l)}else t=e.width,n=e.height;t===i&&n===r||(this._width=t,this._height=n,ft(this._layers,function(u){u.automaticResize&&Fo(u.element,t,n)}),this._events.fire(x.RESIZE,{prevWidth:i,prevHeight:r,width:t,height:n,difWidth:t-i,difHeight:n-r}))}},Ie.prototype._refresh=function(){var e=this;this._inFrame?this._mustRefresh=!0:this._nextFrame||this._isDestroyed||(this._nextFrame=Oo(function(){return e._playFrame()}))},Ie.prototype._playFrame=function(){var e=this,t=R(),n=t-this._currentTime,i=Fr([this._beforeNextFramePromises,function(){return e._events.fire(x.BEFORE_NEW_FRAME,{elapsed:n})},function(){return e._events.fire(x.NEW_FRAME,{elapsed:n})},function(){return e._events.fire(x.AFTER_NEW_FRAME,{elapsed:n})},this._afterNextFramePromises,function(){e._inFrame=!1,(e._mustRefresh||t<e._refreshUntil+17)&&(e._mustRefresh=!1,e._refresh())}]);this._inFrame=!0,this._nextFrame=null,this._mustRefresh=!1,this._currentTime=t,this._beforeNextFramePromises=[],this._afterNextFramePromises=[],i.reduce(function(r,o){return r.then(function(){if(!e._isDestroyed)return o()})},Promise.resolve())},Ie.prototype.isPlayingFrame=function(){return this._inFrame||!!this._nextFrame},Ie.prototype.setFullScreen=function(e){var t;this._container&&(e&&!this._isFullScreen?(t=this._container).requestFullScreen?t.requestFullScreen():t.webkitRequestFullScreen?t.webkitRequestFullScreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.msRequestFullscreen&&t.msRequestFullscreen():e||!this._isFullScreen||"undefined"!=typeof document&&(document.cancelFullScreen?document.cancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen())),this._isFullScreen=e},Ie.prototype.isFullScreen=function(){return this._isFullScreen},Ie.prototype.debounceBeforeFrame=function(e){function t(){var o=r;i=!1,r=[],e(),o.forEach(function(a){return a()})}var n=this,i=!1,r=[];return function(){return new Promise(function(o){r.push(o),i||(i=!0,n.beforeNextFrame().then(t))})}},Ie.prototype.destroy=function(){(function(){if(be--,nr&&0===be){var e=document.documentElement;e.removeEventListener(G,pe,!0),e.removeEventListener(J,ne,!0),e.removeEventListener(K,ue,!0),e.removeEventListener(se,ue,!0)}})(),this.detachFromDom(),this.clearAllTimeouts(),this.stopFrames()},Ie);function Ie(e,t){var n=e.events,i=e.settings,r=void 0===t?{}:t,o=r.width,a=void 0===o?300:o,s=r.height,l=void 0===s?300:s,u=I.call(this)||this;return u._layers={},u._focus=!1,u._container=null,u._isFullScreen=!1,u._beforeNextFramePromises=[],u._afterNextFramePromises=[],u._refreshUntil=0,u._currentTime=R(),u._timeouts=[],u._isDestroyed=!1,u._onDetachDom=[],u._isRealBrowser=Rr,u._isDocumentReady=ho,u._inFrame=!1,u._mustRefresh=!1,u._nextFrame=null,u._onWindowResize=function(){return u._resize()},u._onWindowFocus=function(){return u.refresh()},u._events=n,u._settings=i,u._width=a,u._height=l,u._settings.register("minimumWidth",300,function(){return u._resize()},!1),u._settings.register("minimumHeight",300,function(){return u._resize()},!1),u._events.register([x.BEFORE_NEW_FRAME,x.NEW_FRAME,x.AFTER_NEW_FRAME,x.SET_CONTAINER,x.RESIZE]),u._onDetachDom=[],function(){if(nr&&0===be&&me){var d=document.documentElement;d.addEventListener(G,pe,!0),d.addEventListener(J,ne,!0),d.addEventListener(K,ue,!0),d.addEventListener(se,ue,!0)}be++}(),u.addWindowEventListener("resize",u._onWindowResize),u.addWindowEventListener("focus",u._onWindowFocus),u}var Ct,fn=(bt(un,Ct=E),un.prototype.setProperty=function(e,t,n,i){var r=(void 0===i?{}:i).dispatch;this._setDataProperty(e.isNode,e._indexes,t,n,void 0!==r&&r),this._events.fire(x.SET_DATA,{elements:e})},un.prototype.getProperty=function(e,t){return this._getDataProperty(e.isNode,e._indexes,t)},un.prototype._setDataProperty=function(e,t,n,i,r){r&&"function"==typeof i&&(r=!1),n=En(n);for(var o="function"==typeof i,a=e?this._nodeList:this._edgeList,s=e?this._nodeDataList:this._edgeDataList,l=function(A,C){for(var O=0;O<A.length;++O){var N=A[O],P=N.property;if(null===C&&null===P)return N;if(C&&P&&P.length===C.length){for(var F=!0,L=0;L<P.length;++L)if(P[L]!==C[L]){F=!1;break}if(F)return N}}var B={property:C&&C.slice(),indexes:[],previousValues:[],newValues:[],nodes:null,edges:null};return A.push(B),B}(e?this._nodeChanges:this._edgeChanges,n),u=0;u<t.length;++u){var d=t[u],c=s.get(d),h=a.get(d),p=r?i[u]:i,g=void 0,m=void 0;if(null===n)g=c,m=o?p(h):p,s.set(d,m);else{null==c&&s.set(d,c={});for(var b=n.length,v=0;v<b;v++){var y=n[v],S=c[y];v<b-1?(null==S&&(c[y]=S={}),c=S):(g=S,m=o?p(h):p,c[y]=m)}}l.indexes.push(d),l.previousValues.push(g),l.newValues.push(m)}this._scheduleEvents()},un.prototype._getDataProperty=function(e,t,n,i){n=En(n),i=i||new Array(t.length);for(var r=e?this._nodeDataList:this._edgeDataList,o=0;o<t.length;++o){var s=r.get(t[o]),l=void 0;if(null!==n&&n.length)if(null==s)l=void 0;else for(var u=n.length,d=0;d<u&&s;++d)l=s=s[n[d]];else l=s;i[o]=l}return i},un.prototype._scheduleEvents=function(){this._shouldTriggerEvents=!0,this._dom.refresh()},un.prototype._triggerEvents=function(){var e=this._prepareEvtPayload(!0),t=this._prepareEvtPayload(!1);this._events.fire(x.UPDATE_NODE_DATA,e),this._events.fire(x.UPDATE_EDGE_DATA,t)},un.prototype._prepareEvtPayload=function(e){var t=e?this._graph.nodeList:this._graph.edgeList,n=e?"_nodeChanges":"_edgeChanges",i=[],r=this[n];this[n]=[];for(var o=[],a=0;a<r.length;++a){var s=r[a],l=s.indexes,u=s.property,d=s.newValues,c=s.previousValues;i=i.concat(l),o.push(e?{property:u,newValues:d,previousValues:c,nodes:t(l)}:{property:u,newValues:d,previousValues:c,edges:t(l)})}return e?{nodes:t(i).dedupe(),isNode:e,changes:o}:{edges:t(i).dedupe(),isNode:e,changes:o}},un);function un(e){var t,n=Ct.call(this)||this;return n._nodeChanges=[],n._edgeChanges=[],n._shouldTriggerEvents=!1,n._dom=e.dom,n._graph=e.graph,n._events=e.events,n._nodeDataList=n._graph.createAttribute(!0,{name:"data",storage:"any"}),n._edgeDataList=n._graph.createAttribute(!1,{name:"data",storage:"any"}),n._nodeList=n._graph.getNodeAttribute("object"),n._edgeList=n._graph.getEdgeAttribute("object"),n._events.register([x.SET_DATA,x.UPDATE_NODE_DATA,x.UPDATE_EDGE_DATA]),n._events.on(((t={})[x.ADD_NODES+" "+x.ADD_EDGES]=function(i){for(var a=i.objects,s=i.nodes||i.edges,u=s.size,d=s._indexes,c=n[s.isNode?"_nodeDataList":"_edgeDataList"],h=0;h<u;++h)c.set(d[h],a[h].data)},t[x.BEFORE_NEW_FRAME]=function(){n._shouldTriggerEvents&&(n._shouldTriggerEvents=!1,n._triggerEvents())},t)),n}function En(e){return"string"==typeof e?e.split("."):ui(e)?e:null==e?null:void 0}var Si={1:ct(1),2:ct(2),4:ct(4),8:Dt(),16:Dt(),32:Dt(),int8:Dt(),int16:Dt(),int32:Dt(),float:Dt(),any:Dt()},Ro={1:Ut(1),2:Ut(2),4:Ut(4),8:gt(),16:gt(),32:gt(),int8:gt(),int16:gt(),int32:gt(),float:gt(),any:gt()};function Dt(){return new Function("array","index","return array[index];")}function gt(){return new Function("array","index","value","array[index] = value;")}function ct(e){var t=8/e;return new Function("array","index","return (array[index / "+t+" | 0] >> ((index % "+t+") * "+e+")) & "+((1<<e)-1)+";")}function Ut(e){return new Function("array","index","value","\n    var offset = (index % "+8/e+") * "+e+";\n    var finalIndex = index / "+8/e+" | 0;\n    var orMask = value << offset;\n    var andMask = 255 - (("+(Math.pow(2,e)-1)+" - value) << offset);\n\n    array[finalIndex] = (array[finalIndex] & andMask) | orMask;")}var pt={get:function(e){return this._getArrayElt(this._buffer,e)},set:function(e,t){this._setArrayElt(this._buffer,e,t)}},Wt={get:function(e){return this._byIndex[this._getArrayElt(this._buffer,e)]},set:function(e,t){var n=this._byName[t];void 0===n&&(n=this._nextIndex++,this._byIndex.push(t),this._getElementBitSize()>this._elementSize&&this.increaseElementSize(),this._byName[t]=n),this._setArrayElt(this._buffer,e,n)}},Ln=(zt.prototype.getValues=function(){return Object.keys(this._byName)},zt.prototype.getName=function(){return this._name},zt.prototype.get=function(e){return this._get(e)},zt.prototype.set=function(e,t){this._set(e,t)},zt.prototype._get=function(e){return this._defaultValue},zt.prototype._set=function(e,t){t!==this._defaultValue&&(this._initialize(),this._set(e,t))},zt.prototype.setFallback=function(e){this._fallback=e,this.get=this._getWithFallback},zt.prototype._getWithFallback=function(e){var t=this._get(e);return void 0===t?this._fallback.get(e):t},zt.prototype._initialize=function(){this._initialized=!0,this._buffer=Vi(this._nbElements,this._elementSize),this._get=this._methods.get,this._set=this._methods.set,"resource"!==this._storage&&this._defaultValue!==this._BASE_VALUE&&this._reset(0)},zt.prototype.increaseNbElements=function(e){var t=Yi(e+1);if(!(t<=this._nbElements)){if(this._initialized)if("any"===this._elementSize)for(var n=this._nbElements;n<t;++n)this._buffer.push(this._defaultValue);else{var i=Vi(t,this._elementSize);i.set(this._buffer),this._buffer=i,"resource"!==this._storage&&this._defaultValue!==this._BASE_VALUE&&this._reset(this._nbElements)}this._nbElements=t}},zt.prototype.increaseElementSize=function(){var e=this._elementSize;if("number"!=typeof e||32===e)throw new Error("FlexArray: cannot increase element size");var t=2*e,n=Si[t],i=Ro[t];if(this._initialized){var r=this._nbElements,o=this._getArrayElt,a=this._buffer,s=Vi(r,t);if(8<=e)s.set(a);else for(var l=0;l<r;++l)i(s,l,o(a,l));this._buffer=s}this._elementSize=t,this._getArrayElt=n,this._setArrayElt=i},zt.prototype.buffer=function(){if(!this._buffer)throw new Error("FlexArray: buffer not instantiated");return this._buffer},zt.prototype.elementBitSize=function(){return this._elementSize},zt.prototype.capacity=function(){return this._nbElements},zt.prototype.byteSize=function(){return this._nbElements*this._elementSize/8},zt.prototype.isInitialized=function(){return this._initialized||this._fallback&&this._fallback.isInitialized()},zt.prototype.getMultiple=function(e,t){var n=e.length;void 0===t&&(t=new Array(n));for(var i=0,r=n;i<r;++i)t[i]=this.get(e[i]);return t},zt.prototype.fill=function(e,t){for(var n=0,i=e.length;n<i;++n)this.set(e[n],t)},zt.prototype.setMultiple=function(e,t,n){if(n||!Array.isArray(t)&&!ArrayBuffer.isView(t))for(i=0,r=e.length;i<r;++i)this.set(e[i],t);else for(var i=0,r=e.length;i<r;++i)this.set(e[i],t[i])},zt.prototype.reset=function(){return this._initialized&&this._reset(0),this},zt.prototype._reset=function(e){var t="resource"===this._storage?0:this._defaultValue;if("number"!=typeof this._elementSize||8<=this._elementSize)this._buffer.fill(t,e);else{for(var n=8/this._elementSize,i=0,r=0;r<n;++r)i<<=this._elementSize,i+=t;if(void 0===e)this._buffer.fill(i);else{var o=e+(8-e%8);for(r=e;r<o;++r)this._setArrayElt(this._buffer,r,t);this._buffer.fill(i,o/8)}}},zt.prototype._getElementBitSize=function(){return Math.pow(2,Math.ceil(Math.log2(Math.log2(this._nextIndex))))},zt);function zt(e){this._initialized=!1;var t,n,i=e.name,r=e.storage,a=(n=r,void 0===(t=e.default)&&"any"!==n&&"resource"!==n?0:t),s=Math.max(8,Yi((e.size||0)+1)),l="resource"===r?1:r;this._name=i,this._storage=r,this._getArrayElt=Si[l],this._setArrayElt=Ro[l],this._elementSize=l,this._nbElements=s,this._fallback=null,this._byName=void 0,this._byIndex=void 0,this._nextIndex=void 0,this._defaultValue=a,this._BASE_VALUE="any"===r?void 0:0,this._methods=pt,this._initialized=!1,this._buffer=null,"resource"===r&&(this._methods=Wt,this._byName={},this._byIndex=[],this._nextIndex=1,this._byName[a]=0,this._byIndex.push(a))}function Yi(e){for(var t=2;t<e;)t*=2;return t}function Vi(e,t){return"any"===t?new Array(e):"float"===t?new Float32Array(e):"int8"===t?new Int8Array(e):"int16"===t?new Int16Array(e):"int32"===t?new Int32Array(e):32===t?new Uint32Array(e):16===t?new Uint16Array(e):new Uint8Array(Math.ceil(e/8*t))}function Oi(e){return Math.pow(2,Math.ceil(Math.log2(e)))}function Sn(e){for(var t=0,n=0;n<e.length;++n)t+=e[n];return t}function _e(e,t,n){return Math.max(t,Math.min(n,e))}function Nt(e,t,n){return e+(t-e)*n}function It(e,t,n){return e*(1-n)+t*n}function en(e){if(!e.length)return-1/0;for(var t=e[0],n=1,i=e.length;n<i;++n){var r=e[n];t<r&&(t=r)}return t}function gn(e){if(!e.length)return 1/0;for(var t=e[0],n=1,i=e.length;n<i;++n){var r=e[n];r<t&&(t=r)}return t}function Ar(e,t){return Math.log(e)/Math.log(t)}var ms=(Mi.prototype.isBusy=function(){return this._busy},Mi.prototype.markBusy=function(){return this._busy=!0,this},Mi.prototype.sliceAndReset=function(){this._busy=!1;var e=this.slice(0,this._size);return this.reset(),e},Mi.prototype.reset=function(){return this._size=0,this},Mi.prototype.reserve=function(e){return e>this._capacity&&this._setCapacity(Oi(e)),this},Mi.prototype._setCapacity=function(e){var t=new Uint32Array(e);t.set(this._buffer),this._buffer=t,this._capacity=e},Mi.prototype.push=function(e){return this._size===this._capacity&&this._setCapacity(2*this._capacity),this._buffer[this._size++]=e,this},Mi.prototype.pushUnchecked=function(e){return this._buffer[this._size++]=e,this},Mi.prototype.slice=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this._size),this._buffer.slice(e,t)},Mi.prototype.getBuffer=function(){return this._buffer},Mi.prototype.getLength=function(){return this._size},Mi.prototype.getCapacity=function(){return this._capacity},Mi.prototype.setLength=function(e){return this._size=e,this},Mi.prototype.isEmpty=function(){return 0===this._size},Mi);function Mi(){this._buffer=new Uint32Array(4),this._capacity=4,this._size=0,this._busy=!1}var fo=(mi.prototype.addElements=function(e){for(var t=[],n=0,i=e.length;n<i;++n){var r=e[n],o=this._idToIndex[r];void 0===o&&(o=this._getNextIndex(),this._idToIndex[r]=o,this._indexToId[o]=r),t.push(o)}for(var a=0,s=this._flexArrays;a<s.length;a++)s[a].increaseNbElements(this._nextIndex);for(var l=0,u=this._indexLists;l<u.length;l++)u[l].reserve(this._nextIndex);return new Uint32Array(t)},mi.prototype.removeElements=function(e){for(var t=0,n=e.length;t<n;++t){var i=e[t],r=this._indexToId[i];void 0!==r&&(delete this._idToIndex[r],this._removeIndex(i))}},mi.prototype.clear=function(){this._idToIndex=Object.create(null),this._indexToId=[void 0],this._nextIndex=1,this._freeIndexes=[];for(var e=0,t=this._flexArrays;e<t.length;e++)t[e].reset();for(var n=0,i=this._indexLists;n<i.length;n++)i[n].reset()},mi.prototype.has=function(e){return void 0!==this._indexToId[e]},mi.prototype.getIndex=function(e,t){void 0===t&&(t=!1);var n=this._idToIndex[e];if(void 0===n&&t)throw new Error(this._name+' id "'+e+'" not found');return n},mi.prototype.createFlexArray=function(e){var t=e.name;if(t&&this._flexArraysByName[t])throw new Error(this._name+' flexArray "'+t+'" already exists');var i,n=e.default;return void 0===n&&"any"!==e.storage&&"resource"!==e.storage&&(n=0),i=new Ln({storage:e.storage,size:this._nextIndex,name:t,default:n}),this._flexArrays.push(i),this._defaultValues.push(e.default),t&&(this._flexArraysByName[t]=i),i},mi.prototype.getFlexArray=function(e){return this._flexArraysByName[e]||null},mi.prototype.getAllFlexArrays=function(){return this._flexArraysByName},mi.prototype.createIndexList=function(){var e=new ms;return e.reserve(this._nextIndex),this._indexLists.push(e),e},mi.prototype.getId=function(e){return this._indexToId[e]},mi.prototype.getMaxIndex=function(){return this._nextIndex-1},mi.prototype._removeIndex=function(e){this._indexesToBeFreed.push(e)},mi.prototype._getNextIndex=function(){var e=this._freeIndexes.pop();return void 0===e&&(e=this._nextIndex++),e},mi.prototype.freeIndexes=function(){for(var e=0,t=this._indexesToBeFreed;e<t.length;e++){var n=t[e];this._indexToId[n]=void 0,this._freeIndexes.push(n)}for(var i=0;i<this._flexArrays.length;++i)for(var r=this._flexArrays[i],o=this._defaultValues[i],a=0,s=this._indexesToBeFreed;a<s.length;a++)r.set(n=s[a],o);this._indexesToBeFreed=[]},mi);function mi(e){var t=this;this._nextIndex=1,this._freeIndexes=[],this._indexesToBeFreed=[],this._idToIndex=Object.create(null),this._indexToId=[void 0],this._flexArrays=[],this._defaultValues=[],this._flexArraysByName={},this._indexLists=[],this._name=e?"node":"edge",this._nextIndex=1,this._freeIndexes=[],this._indexesToBeFreed=[],this._idToIndex=Object.create(null),this._indexToId=[void 0],this._idFlexArray=new Ln({storage:"int32"}),this._idFlexArray.get=function(n){return t._indexToId[n]},this._idFlexArray.getMultiple=function(n){for(var i=new Array(n.length),r=0;r<n.length;++r)i[r]=t._indexToId[n[r]];return i},this._flexArraysByName.id=this._idFlexArray}var rr,pd,fd=(go.prototype.addEntry=function(e){return void 0===e&&(e=this._nextIndex++),e>=this._capacity&&this._reserve(e+1),this._sizes[e]=0,e},go.prototype.get=function(e){var t=this._sizes[e],n=this._MAX_LIST_SIZE*e;if(t<=this._MAX_LIST_SIZE){for(var i=0,r=this._constList.length=t;i<r;++i)this._constList[i]=this._buffer[n+i];return this._constList}if(t===this._BIG_LIST)return this._bigLists[this._buffer[n]]},go.prototype.size=function(e){var t=this._sizes[e];return t<=this._MAX_LIST_SIZE?t:this._bigLists[this._buffer[e*this._MAX_LIST_SIZE]].length},go.prototype.sizes=function(e){for(var t=this._sizes,n=this._bigLists,i=this._buffer,r=this._MAX_LIST_SIZE,o=e.length,a=new Array(o),s=0;s<o;s++){var l=e[s],u=t[l];a[s]=u<=r?u:n[i[l*r]].length}return a},go.prototype.addTo=function(e,t){var n=this._sizes[e],i=e*this._MAX_LIST_SIZE;if(n<this._MAX_LIST_SIZE)this._buffer[i+n]=t,this._sizes[e]=n+1;else if(n===this._BIG_LIST)this._bigLists[this._buffer[i]].push(t);else{for(var o=new Array(this._MAX_LIST_SIZE),a=0;a<this._MAX_LIST_SIZE;++a)o[a]=this._buffer[i+a];o.push(t),this._bigLists.push(o),this._sizes[e]=this._BIG_LIST,this._buffer[i]=this._bigLists.length-1}return this},go.prototype.removeFrom=function(e,t){return this.removeFromAndGetSize(e,t),this},go.prototype.removeFromAndGetSize=function(e,t){var n=this._MAX_LIST_SIZE*e,i=this._sizes[e];if(i<=this._MAX_LIST_SIZE){for(var r=n,o=n+i;r<o;++r)if(this._buffer[r]===t)return--i,this._buffer[r]=this._buffer[o-1],this._sizes[e]=i}else if(i===this._BIG_LIST){var s=this._bigLists[this._buffer[n]];if(-1!==(r=s.indexOf(t)))return s.splice(r,1),s.length}throw new Error('topology: Table: "removeFrom" failed, should not happen')},go.prototype.reserve=function(e){return this._capacity<e&&this._reserve(e),this},go.prototype._reserve=function(e){this._capacity=Math.pow(2,Math.ceil(Math.log2(e))),this._buffer=Ih(this._buffer,this._capacity*this._MAX_LIST_SIZE),this._sizes=Ih(this._sizes,this._capacity)},go);function go(){this._BIG_LIST=255,this._MAX_LIST_SIZE=8,this._capacity=8,this._buffer=new Uint32Array(this._capacity*this._MAX_LIST_SIZE),this._sizes=new Uint8Array(this._capacity),this._bigLists=[],this._nextIndex=0,this._constList=new Array(this._MAX_LIST_SIZE)}function Ih(e,t){var n=new e.constructor(t);return n.set(e),n}(pd=rr=rr||{}).BOTH="both",pd.IN="in",pd.OUT="out";var Oy=(ni.prototype.getAdjacentDirections=function(e){return this._neighborTable.get(e)},ni.prototype.getEdgeIndexesInDirection=function(e){return this._parallelTable.get(e)},ni.prototype.allocateNodes=function(e){this._neighborTable.reserve(e.length);for(var t=0;t<e.length;++t)this._neighborTable.addEntry(e[t])},ni.prototype.allocateEdges=function(e,t,n){this._parallelTable.reserve(Math.floor(e.length/2));for(var i=0;i<e.length;i++){var r=e[i],a=n[i];this._sourceList.set(r,t[i]),this._targetList.set(r,a),this.addToAdjacencyList(r)}},ni.prototype.getExtremity=function(e,t){var n=e?this._sourceList:this._targetList;if(t.isList){for(var i=this._graph.acquireIndexList(!0),r=0;r<t._indexes.length;r++)i.push(n.get(t._indexes[r]));return this._graph.nodeList(i.sliceAndReset())}return this._graph.getObjectList(!0).get(n.get(t._index))},ni.prototype.setExtremities=function(e,t,n){for(var i=0;i<e.length;++i)this.removeFromAdjacencyList(e[i]);for(null!==t&&this._sourceList.setMultiple(e,t),null!==n&&this._targetList.setMultiple(e,n),i=0;i<e.length;++i)this.addToAdjacencyList(e[i])},ni.prototype.addToAdjacencyList=function(e){var t=this._sourceList.get(e),n=this._targetList.get(e),i=tu(t,n),r=this._parallelEdgesIndex[i];void 0===r&&(r=this._parallelTable.addEntry(),this._parallelEdgesIndex[i]=r,this._neighborTable.addTo(t,r),t!==n&&this._neighborTable.addTo(n,r)),this._parallelTable.addTo(r,e)},ni.prototype.removeFromAdjacencyList=function(e){var t=this._sourceList.get(e),n=this._targetList.get(e),i=tu(t,n),r=this._parallelEdgesIndex[i];0===this._parallelTable.removeFromAndGetSize(r,e)&&(this._neighborTable.removeFrom(t,r),t!==n&&this._neighborTable.removeFrom(n,r),this._parallelEdgesIndex[i]=void 0)},ni.prototype.getParallelEdges=function(e,t){void 0===t&&(t={});for(var n=t.filter||"visible",i=this._graph.acquireIndexList(!1),r=this._graph.getFilter(!1,n),o=0;o<e._indexes.length;o++){var a=e._indexes[o],s=tu(this._sourceList.get(a),this._targetList.get(a)),u=this._parallelTable.get(+this._parallelEdgesIndex[s]);if(u)for(var d=0,c=u;d<c.length;d++){var h=c[d];r(h)&&i.push(h)}}return this._graph.edgeList(i.sliceAndReset())},ni.prototype.fastGetNodesAdjacentElements=function(e){for(var t=this._graph.acquireIndexList(!0),n=this._graph.acquireIndexList(!1),i=this._sourceList,r=this._targetList,o=0;o<e.length;o++)for(var a=e[o],s=0,l=this._neighborTable.get(a);s<l.length;s++){var d=this._parallelTable.get(l[s]),c=d[0],h=i.get(c),p=r.get(c);t.push(h+p-a);for(var g=0,m=d;g<m.length;g++)n.push(m[g])}return{nodes:this._graph.nodeList(t.sliceAndReset()),edges:this._graph.edgeList(n.sliceAndReset())}},ni.prototype.fastGetEdgesAdjacentElements=function(e){for(var t=this._graph.acquireIndexList(!0),n=this._graph.acquireIndexList(!1),i=this._sourceList,r=this._targetList,o=0;o<e.length;o++){var a=e[o],s=i.get(a),l=r.get(a),u=tu(s,l),c=this._parallelTable.get(+this._parallelEdgesIndex[u]);if(c)for(var h=0,p=c;h<p.length;h++)n.push(p[h]);t.push(s),t.push(l)}return{nodes:this._graph.nodeList(t.sliceAndReset()),edges:this._graph.edgeList(n.sliceAndReset())}},ni.prototype.getDeduper=function(e){return(e?this.nodeDeduper:this.edgeDeduper).reset()},ni.prototype.collectAdjacentEdges=function(e,t,n,i,r){void 0===i&&(i=!1),void 0===r&&(r=!1);var a=t===rr.IN,s=!(t===rr.OUT||a||r),l=this._graph.acquireIndexList(!1),u=this._graph.getFilter(!1,n),d=i?this.getDeduper(!1):this._fakeDeduper,c=this._fakeInvertedDeduper,h=this._sourceList,p=this._targetList;if(r){c=this.getDeduper(!0);for(var g=0;g<e.length;g++)c.set(e[g],1)}for(g=0;g<e.length;g++)for(var m=e[g],b=0,v=this._neighborTable.get(m);b<v.length;b++){var S=this._parallelTable.get(v[b]);if(s)for(var A=0,C=S;A<C.length;A++)u(P=C[A])&&0===d.get(P)&&(l.push(P),d.set(P,1));else for(var O=0,N=S;O<N.length;O++){var P=N[O],F=h.get(P),L=p.get(P),B=F+L-m;a!=(L===m)&&F!==L||!u(P)||0!==d.get(P)||1!==c.get(B)||(l.push(P),d.set(P,1))}}return l.sliceAndReset()},ni.prototype.collectAdjacentNodes=function(e,t,n,i,r,o){void 0===i&&(i=!1);var a=t!==rr.IN,s=t!==rr.OUT,l=this._graph.acquireIndexList(!0),u=this._graph.getFilter(!1,n),d=i?this.getDeduper(!0):this._fakeDeduper,c=this._sourceList,h=this._targetList;if(r)for(var p=0;p<r.length;p++){var g=r[p];l.push(g),d.set(g,1)}if(o)for(p=0;p<o.length;p++)d.set(g=o[p],1);for(p=0;p<e.length;p++)for(var m=e[p],b=0,v=this._neighborTable.get(m);b<v.length;b++)for(var S=0,A=this._parallelTable.get(v[b]);S<A.length;S++){var C=A[S];if(u(C)){var O=c.get(C),N=h.get(C);if(g=O+N-m,(s&&m===N||a&&m===O)&&0===d.get(g)){l.push(g),d.set(g,1);break}}}return l.sliceAndReset()},ni.prototype.getAdjacentElements=function(e,t,n){void 0===n&&(n={});var i=n.direction||rr.BOTH,r=n.filter||"visible",o=n.policy||"union",a=!!n.bothExtremities,s=n.includeSources;return!0===s?o="include-sources":!1===s&&(o="exclude-sources"),e?this.collectAdjacentNodes(t,i,r,!0,"include-sources"===o?t:null,"exclude-sources"===o?t:null):this.collectAdjacentEdges(t,i,r,!0,a)},ni.prototype.getEdgesBetweenTwoNodes=function(e,t){var n=tu(e,t),r=this._parallelTable.get(+this._parallelEdgesIndex[n]);return new Uint32Array(r||0)},ni.prototype.getConnectedComponents=function(e,t){for(var n=void 0===t?{}:t,i=n.filter,r=void 0===i?"visible":i,o=n.returnIds,a=void 0!==o&&o,s=n.internalIndexes,l=void 0!==s&&s,u=this._graph,d=[],c={},h=u.acquireIndexList(!0),p=u.getFilter(!0,r),g=0;g<e.length;g++)p(v=e[g])&&h.push(v);var m=h.sliceAndReset(),b={filter:r};for(g=0;g<m.length;g++){var v;if(!c[v=m[g]]){for(var y=[v],S=[];0!==y.length;){var A=y.pop();c[A]||(y.push.apply(y,this.getAdjacentElements(!0,new Uint32Array([A]),b)),c[A]=!0,S.push(A))}0<S.length&&d.push(S)}}if(a){var C=u.getNodeAttribute("id");for(g=0;g<d.length;g++)d[g]=C.getMultiple(d[g])}else if(!l)for(g=0;g<d.length;g++)d[g]=u.nodeList(new Uint32Array(d[g]));return d},ni.prototype.getAdjacencyList=function(e){for(var t=e.directed,n=e.ids,i=e.weight,r=e.nodes,o=t?rr.OUT:rr.BOTH,a=new Array(r.length),s=this._graph,l=0;l<r.length;++l)a[l]=this.collectAdjacentEdges(new Uint32Array([r[l]]),o,"all");var u=s.getEdgeAttribute("source"),d=s.getEdgeAttribute("target"),c=s.getEdgeAttribute("width"),h=s.getNodeAttribute("id"),p=[],g="number"==typeof i,m=!("function"==typeof i||g||!i);for(l=0;l<a.length;l++){for(var b=a[l],v=r[l],y=b.length,S=n?new Array(y):new Uint32Array(y),A=new Array(y),C=0;C<y;C++){var O=b[C],N=u.get(O),P=d.get(O),F=t||v===N?P:N;n&&(F=h.get(F)),S[C]=F,i&&(g&&(A[C]=i),"function"==typeof i&&(A[C]=i(s.getNode(N),s.getNode(P))),m&&(A[C]=c.get(O)||1))}var L=Mt({nodes:S,id:n?h.get(v):v},i&&{weights:A});p.push(L)}return p},ni.prototype.degrees=function(e,t){if(t!==rr.IN&&t!==rr.OUT)return this._neighborTable.sizes(e);for(var n=new Array(e.length),i=t===rr.IN,r=0,o=e.length;r<o;r++)n[r]=this._degree(e[r],i);return n},ni.prototype._degree=function(e,t){for(var n=this._neighborTable.get(e),i=this._sourceList,r=this._targetList,o=0,a=0;a<n.length;++a)for(var s=this._parallelTable.get(n[a]),l=0;l<s.length;++l){var u=s[l],d=i.get(u),c=r.get(u);if(t&&c===e||!t&&d===e){o+=1;break}}return o},ni.prototype.getDegree=function(e,t){for(var n=this._getDegreeOptions(t),i=n.direction,r=n.filter,o=new Array(e.length),a=new Uint32Array(1),s=0;s<e.length;++s)a[0]=e[s],o[s]=this.collectAdjacentNodes(a,i,r).length;return o},ni.prototype._getDegreeOptions=function(e){var t={direction:rr.BOTH,filter:"visible"};return"string"==typeof e?t.direction=e:e&&("string"==typeof e.direction&&(t.direction=e.direction),"string"==typeof e.filter&&(t.filter=e.filter)),t},ni);function ni(e){this._parallelEdgesIndex=[],this._fakeDeduper={get:function(){return 0},set:function(){},reset:function(){return this}},this._fakeInvertedDeduper={get:function(){return 1},set:function(){},reset:function(){return this}},this._sourceList=null,this._targetList=null,this._graph=e,this._neighborTable=new fd,this._parallelTable=new fd,this._parallelEdgesIndex=[],this.nodeDeduper=e.createNodeAttribute({storage:1}),this.edgeDeduper=e.createEdgeAttribute({storage:1}),this._sourceList=e.getEdgeAttribute("source"),this._targetList=e.getEdgeAttribute("target")}function tu(e,t){var n=e<t?e:t;return 67108864*n+(e+t-n)}function eo(e){Ei||console.warn(le()+" "+e)}function kh(e){"object"==typeof e&&null!==e||(e={});var t="function"==typeof e.data?e.data:function(n){return n};return{attributes:Array.isArray(e.attributes)?e.attributes:void 0,data:t}}function ju(e){1<e&&eo("getData: more than one argument were specified, you probably want to use a single array argument instead of multiple arguments")}function Zu(e,t){for(var n=function(o){var a=t;Object.keys(a).forEach(function(s){var l=a[s];o.prototype[s]=function(u,d){return eo('Deprecated method "'+s+'"; please use "'+l+'" instead.'),this[l](u,d)}})},i=0,r=e;i<r.length;i++)n(r[i])}function Oh(e){var t=e.getFlexArray("removed"),n=e.getFlexArray("excluded"),i=e.getFlexArray("virtual");return{all:function(r){return 0===t.get(r)},visible:function(r){return 0===n.get(r)},raw:function(r){return 0===i.get(r)&&0===t.get(r)},_all:function(r){return!0}}}function Nh(e,t,n){return{all:Gu(n.all,e,t),visible:Gu(n.visible,e,t),raw:Gu(n.raw,e,t),_all:Gu(n._all,e,t)}}function Gu(e,t,n){var i=null;return{getList:function(){if(!i){var r=t(),o=n();o.reset();for(var a=1;a<=r;++a)e(a)&&o.push(a);i=o.sliceAndReset()}return i},invalidList:function(){i=null}}}function Ny(e){if(void 0===e)return Math.round(Math.random()*Number.MAX_SAFE_INTEGER);if("string"!=typeof e&&("number"!=typeof e||!isFinite(e)))throw new Error(e+" is not a valid id, expected string or number");return e}function Lh(e,t,n){for(var i=e.getObjectList(t.isNode),r=0;r<t._indexes.length;++r)n(i.get(t._indexes[r]),r)}function Fh(e,t,n){for(var i=new Array(t.size),r=e.getObjectList(t.isNode),o=0;o<t._indexes.length;++o){var s=r.get(t._indexes[o]);i[o]=n(s,o)}return i}function Ph(e,t,n){n=n||function(){return!0};for(var i=t.isNode,r=e.acquireIndexList(i),o=e.getObjectList(i),a=e.getListFactory(i),s=0;s<t._indexes.length;++s){var l=t._indexes[s],u=o.get(l);u&&n(u,s)&&r.push(l)}return a(r.sliceAndReset())}function Dh(e,t,n,i){var r=e.getListFactory(t.isNode);if(!n)return{valid:t,invalid:r()};for(var o=e.acquireIndexList(t.isNode),a=e.acquireIndexList(t.isNode),s=e.getObjectList(t.isNode),l=0;l<t._indexes.length;l++){var u=t._indexes[l],d=s.get(u);void 0!==d&&(n(d,i)?o:a).pushUnchecked(u)}return{valid:r(o.sliceAndReset()),invalid:r(a.sliceAndReset())}}function Rh(e,t,n,i){for(var r=e.getObjectList(t.isNode),o=i,a=0;a<t._indexes.length;++a)o=n(o,r.get(t._indexes[a]),a);return o}function zh(e,t){for(var n=t.isNode,i=e.topology.getDeduper(n),r=e.acquireIndexList(n),o=e.getListFactory(n),a=0;a<t._indexes.length;a++){var s=t._indexes[a];0===i.get(s)&&(i.set(s,1),r.push(s))}return o(r.sliceAndReset())}function Bh(e,t){for(var n=t.isNode,i=e.storage.fetch(n),r=i.getFlexArray("excluded"),o=i.getMaxIndex(),a=e.topology.getDeduper(n),s=e.acquireIndexList(n),l=e.getListFactory(n),u=0;u<t._indexes.length;u++)a.set(t._indexes[u],1);for(var d=1;d<=o;++d)0===a.get(d)&&0===r.get(d)&&s.push(d);return l(s.sliceAndReset())}function Vh(e,t,n){var i=e.getListFactory(t.isNode),r=new Uint32Array(t._indexes.length+n._indexes.length);return r.set(t._indexes),r.set(n._indexes,t._indexes.length),i(r)}function Uh(e,t){return e.getObjectList(t.isNode).getMultiple(t._indexes)}function qu(e,t){var n=e.getStorage(t.isNode);if(t.isList){for(var i=new Array(t.size),r=0;r<t._indexes.length;++r)i[r]=n.getId(t._indexes[r]);return i}return n.getId(t._index)}function jh(e,t){return e.topology.getExtremity(!0,t)}function Zh(e,t){return e.topology.getExtremity(!1,t)}function Gh(e,t,n){return e.getObjectList(t.isNode).get(t._indexes[n])}function qh(e,t,n){var i=e.getListFactory(t.isNode),r=e.getObjectList(t.isNode),o=t._indexes.slice();return o.sort(function(a,s){var l=r.get(a),u=r.get(s);return n(l,u)}),i(o)}var Hh=new Uint32Array(1),ia=(Object.defineProperty(qt.prototype,"_indexes",{get:function(){return Hh[0]=this._index,Hh},enumerable:!0,configurable:!0}),qt.prototype.setAttributes=function(e,t,n){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,e,t,n)},qt.prototype.setAttribute=function(e,t,n){return this._ogma.modules.individualAttributes.setSingleAttribute(this,e,t,n)},qt.prototype.getAttributes=function(e){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,e)[0]},qt.prototype.getAttribute=function(e){return this._ogma.modules.individualAttributes.getSingleAttribute(this,e)[0]},qt.prototype.resetAttributes=function(e,t){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,e,t)},qt.prototype.replaceOriginalAttributes=function(e,t){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,e,t)},qt.prototype.getPreviousAttributes=function(e){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,e)[0]},qt.prototype.isInView=function(e){return this._ogma.modules.locate.isElementInView(this,e)},qt.prototype.getParallelEdges=function(e){return this._ogma.modules.graph.getParallelEdges(this,e)},qt.prototype.fastGetAdjacentElements=function(){return this._ogma.modules.graph.fastGetEdgesAdjacentElements(this)},qt.prototype.isVisible=function(){return!this.isExcluded()},qt.prototype.isExcluded=function(){return this._ogma.modules.graph.isExcluded(this)[0]},qt.prototype.setExcluded=function(e){return this._ogma.modules.graph.setExcluded(this,e)},qt.prototype.setVisible=function(e){return this.setExcluded(!e)},qt.prototype.toList=function(){return this._ogma.modules.graph.edgeList(new Uint32Array([this._index]))},qt.prototype.getId=function(){return qu(this._ogma.modules.graph,this)},qt.prototype.getSource=function(){return jh(this._ogma.modules.graph,this)},qt.prototype.getTarget=function(){return Zh(this._ogma.modules.graph,this)},qt.prototype.getExtremities=function(){return this._ogma.modules.graph.nodeList(new Uint32Array([this.getSource()._index,this.getTarget()._index]))},qt.prototype.setSource=function(e){this._ogma.modules.graph.setSource(this,e)},qt.prototype.setTarget=function(e){this._ogma.modules.graph.setTarget(this,e)},qt.prototype.slice=function(){return this.toList()},qt.prototype.toJSON=function(e){void 0===e&&(e={});var t=kh(e),n=t.attributes,i=t.data;return{id:this.getId(),source:this.getSource().getId(),target:this.getTarget().getId(),attributes:this.getAttributes(n),data:i(rn(this.getData()))}},qt.prototype.get=function(e){return 0===e?this:void 0},qt.prototype.setSelected=function(e){this._ogma.modules.selection.setActive(this,e)},qt.prototype.isSelected=function(){return this._ogma.modules.selection.areActive(this)},qt.prototype.locate=function(e){return this._ogma.modules.locate.locateElements(this,e)},qt.prototype.getBoundingBox=function(e){return this._ogma.modules.locate.getBoundingBox(this,e)},qt.prototype.setData=function(e,t){return arguments.length<2&&(t=e,e=null),this._ogma.modules.data.setProperty(this,e,t),this},qt.prototype.getData=function(e){return ju(arguments.length),this._ogma.modules.data.getProperty(this,e)[0]},qt.prototype.addClass=function(e,t){return this._ogma.modules.classes.addClassesToElements([e],this,t)},qt.prototype.addClasses=function(e,t){return this._ogma.modules.classes.addClassesToElements(e,this,t)},qt.prototype.removeClass=function(e,t){return this._ogma.modules.classes.removeClassesFromElements([e],this,t)},qt.prototype.removeClasses=function(e,t){return this._ogma.modules.classes.removeClassesFromElements(e,this,t)},qt.prototype.hasClass=function(e){return this._ogma.modules.classes.hasSingleElementClass(e,this)},qt.prototype.getClassList=function(){return this._ogma.modules.classes.getElementsClassList(this)[0]},qt.prototype.getAnimationInformation=function(){return this._ogma.modules.graphics.getAnimationInformation(this)[0]},qt.prototype.isVirtual=function(){return this._ogma.modules.transformations.isElementVirtual(this)},qt.prototype.getTransformation=function(){return this._ogma.modules.transformations.getElementTransformation(this)},qt.prototype.getMetaEdge=function(){return this._ogma.modules.grouping.getMetaElement(this)[0]},qt.prototype.getSubEdges=function(){return this._ogma.modules.grouping.getSubElements(this)[0]},qt.prototype.pulse=function(e){this._ogma.modules.pulses.pulse(this,e)},qt);function qt(e,t){this.size=1,this.isNode=!1,this.isList=!1,this._index=e,this._ogma=t}Zu([ia],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute"});var vs=(Object.defineProperty(Rt.prototype,"size",{get:function(){return this._indexes.length},enumerable:!0,configurable:!0}),Rt.prototype.setAttributes=function(e,t){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,e,t)},Rt.prototype.setAttribute=function(e,t,n){return this._ogma.modules.individualAttributes.setSingleAttribute(this,e,t,n)},Rt.prototype.getAttributes=function(e){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,e)},Rt.prototype.getAttribute=function(e){return this._ogma.modules.individualAttributes.getSingleAttribute(this,e)},Rt.prototype.resetAttributes=function(e,t){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,e,t)},Rt.prototype.replaceOriginalAttributes=function(e,t){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,e,t)},Rt.prototype.getPreviousAttributes=function(e){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,e)},Rt.prototype.getPreviousAttribute=function(e){return this._ogma.modules.individualAttributes.getSinglePreviousAttribute(this,e)},Rt.prototype.getParallelEdges=function(e){return this._ogma.modules.graph.getParallelEdges(this,e)},Rt.prototype.fastGetAdjacentElements=function(){return this._ogma.modules.graph.fastGetEdgesAdjacentElements(this)},Rt.prototype.isVisible=function(){return this.isExcluded().map(function(e){return!e})},Rt.prototype.isExcluded=function(){return this._ogma.modules.graph.isExcluded(this)},Rt.prototype.setExcluded=function(e){return this._ogma.modules.graph.setExcluded(this,e)},Rt.prototype.setVisible=function(e){return this.setExcluded(!e)},Rt.prototype.toList=function(){return this},Rt.prototype.toArray=function(){return Uh(this._ogma.modules.graph,this)},Rt.prototype.clone=function(){return this._ogma.modules.graph.edgeList(this._indexes.slice())},Rt.prototype.getId=function(){return qu(this._ogma.modules.graph,this)},Rt.prototype.getSource=function(){return jh(this._ogma.modules.graph,this)},Rt.prototype.getTarget=function(){return Zh(this._ogma.modules.graph,this)},Rt.prototype.getExtremities=function(){return this.getSource().concat(this.getTarget())},Rt.prototype.get=function(e){return Gh(this._ogma.modules.graph,this,e)},Rt.prototype.forEach=function(e){Lh(this._ogma.modules.graph,this,e)},Rt.prototype.map=function(e){return Fh(this._ogma.modules.graph,this,e)},Rt.prototype.filter=function(e){return Ph(this._ogma.modules.graph,this,e)},Rt.prototype.reduce=function(e,t){return Rh(this._ogma.modules.graph,this,e,t)},Rt.prototype.concat=function(e){return Vh(this._ogma.modules.graph,this,e)},Rt.prototype.dedupe=function(){return zh(this._ogma.modules.graph,this)},Rt.prototype.slice=function(e,t){return this._ogma.modules.graph.edgeList(this._indexes.slice(e,t))},Rt.prototype.indexOf=function(e){return e instanceof ia?this._indexes.indexOf(e._index):-1},Rt.prototype.includes=function(e){return-1!==this.indexOf(e)},Rt.prototype.sort=function(e){return qh(this._ogma.modules.graph,this,e)},Rt.prototype.inverse=function(){return Bh(this._ogma.modules.graph,this)},Rt.prototype.toJSON=function(e){return void 0===e&&(e={}),this.map(function(t){return t.toJSON(e)})},Rt.prototype.setSelected=function(e){this._ogma.modules.selection.setActive(this,e)},Rt.prototype.isSelected=function(){return this._ogma.modules.selection.areActive(this)},Rt.prototype.locate=function(e){return this._ogma.modules.locate.locateElements(this,e)},Rt.prototype.getBoundingBox=function(e){return this._ogma.modules.locate.getBoundingBox(this,e)},Rt.prototype.setData=function(e,t){if(arguments.length<2&&(t=e,e=null),"function"!=typeof t&&!ui(t))throw new Error("invalid argument "+t+"; expected array or function");return this._ogma.modules.data.setProperty(this,e,t,{dispatch:!0}),this},Rt.prototype.fillData=function(e,t){return arguments.length<2&&(t=e,e=null),this._ogma.modules.data.setProperty(this,e,t,{dispatch:!1}),this},Rt.prototype.getData=function(e){return ju(arguments.length),this._ogma.modules.data.getProperty(this,e)},Rt.prototype.addClass=function(e,t){return this._ogma.modules.classes.addClassesToElements([e],this,t)},Rt.prototype.addClasses=function(e,t){return this._ogma.modules.classes.addClassesToElements(e,this,t)},Rt.prototype.removeClass=function(e,t){return this._ogma.modules.classes.removeClassesFromElements([e],this,t)},Rt.prototype.removeClasses=function(e,t){return this._ogma.modules.classes.removeClassesFromElements(e,this,t)},Rt.prototype.hasClass=function(e){var t=this;return this.map(function(n){return t._ogma.modules.classes.hasSingleElementClass(e,n)})},Rt.prototype.getClassList=function(){return this._ogma.modules.classes.getElementsClassList(this)},Rt.prototype.getAnimationInformation=function(){return this._ogma.modules.graphics.getAnimationInformation(this)},Rt.prototype.getMetaEdge=function(){return this._ogma.modules.grouping.getMetaElement(this)},Rt.prototype.getSubEdges=function(){return this._ogma.modules.grouping.getSubElements(this)},Rt.prototype.pulse=function(e){this._ogma.modules.pulses.pulse(this,e)},Rt);function Rt(e,t){this.isList=!0,this.isNode=!1,this._indexes=e,this._ogma=t}Zu([vs],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute"});var ra="geo.latitude",oa="geo.longitude",nu=85.0511287798,ys={latitudePath:"latitude",longitudePath:"longitude",maxZoomLevel:22,minZoomLevel:0,wrapCoordinates:!0,tileUrlTemplate:"https://maps.wikimedia.org/osm-intl/{z}/{x}/{y}{r}.png",tileUrlSubdomains:"abc",attribution:null,attributionOptions:void 0,backgroundColor:"silver",opacity:1,duration:0,detectRetina:!1,disableNodeDragging:!0,tileBuffer:1,sizeRatio:1,tiles:{url:"https://maps.wikimedia.org/osm-intl/{z}/{x}/{y}{r}.png",subdomains:"abc",tms:!1,wms:!1},crs:null},Ly={maxBoundsViscosity:1,worldCopyJump:!0,zoomControl:!1,attributionControl:!1};function Wh(){return Hi||"undefined"!=typeof global&&!global.process}function gd(e){return Math.log2(e)+1}function Yh(e){return null!=e&&!isNaN(e)}function Xh(e,t){return Qh(e,t,"longitude")}function Jh(e,t){return Qh(e,t,"latitude")}function Qh(e,t,n){if(isNaN(t))throw new TypeError("node "+e+": "+t+" is not a valid "+n)}var Fy=zi().createElement("div");function Hu(e,t,n,i){var r,a,l,u,c;a=t,l=i,u=(r=e).getAttribute(!0,n),r.getAttribute(true,l).setMultiple(c=a._indexes,u.getMultiple(c))}var Kh=new Uint32Array(1),_o=(Object.defineProperty(jt.prototype,"_indexes",{get:function(){return Kh[0]=this._index,Kh},enumerable:!0,configurable:!0}),jt.prototype.setAttributes=function(e,t){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,e,t)},jt.prototype.setAttribute=function(e,t,n){return this._ogma.modules.individualAttributes.setSingleAttribute(this,e,t,n)},jt.prototype.resetAttributes=function(e,t){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,e,t)},jt.prototype.getAttributes=function(e){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,e)[0]},jt.prototype.getAttribute=function(e){return this._ogma.modules.individualAttributes.getSingleAttribute(this,e)[0]},jt.prototype.getPosition=function(){return this.getAttributes(["x","y"])},jt.prototype.getPositionOnScreen=function(){return this._ogma.modules.camera.graphToScreenCoordinates(this.getPosition())},jt.prototype.isInScreen=function(){var e=this.getPositionOnScreen(),t=this._ogma.modules.camera;return 0<=e.x&&e.x<=t.width&&0<=e.y&&e.y<=t.height},jt.prototype.replaceOriginalAttributes=function(e,t){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,e,t)},jt.prototype.getPreviousAttributes=function(e){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,e)[0]},jt.prototype.isInView=function(e){return this._ogma.modules.locate.isElementInView(this,e)},jt.prototype.getAdjacentNodes=function(e){return this._ogma.modules.graph.getAdjacentNodes(this,e)},jt.prototype.getAdjacentEdges=function(e){return this._ogma.modules.graph.getAdjacentEdges(this,e)},jt.prototype.getDegree=function(e){return this._ogma.modules.graph.getDegree(this,e)[0]},jt.prototype.fastGetAdjacentElements=function(){return this._ogma.modules.graph.fastGetNodesAdjacentElements(this)},jt.prototype.getConnectedComponent=function(e){return this._ogma.modules.graph.getConnectedComponentByNode(this,e)[0]},jt.prototype.isVisible=function(){return!this.isExcluded()},jt.prototype.isExcluded=function(){return this._ogma.modules.graph.isExcluded(this)[0]},jt.prototype.setExcluded=function(e){return this._ogma.modules.graph.setExcluded(this,e)},jt.prototype.setVisible=function(e){return this.setExcluded(!e)},jt.prototype.toList=function(){return this._ogma.nodeList(new Uint32Array([+this._index]))},jt.prototype.getId=function(){return qu(this._ogma.modules.graph,this)},jt.prototype.slice=function(){return this.toList()},jt.prototype.toJSON=function(e){void 0===e&&(e={});var t=kh(e),n=t.attributes,i=t.data;return{id:this.getId(),attributes:this.getAttributes(n),data:i(rn(this.getData()))}},jt.prototype.get=function(e){return 0===e?this:void 0},jt.prototype.setSelected=function(e){this._ogma.modules.selection.setActive(this,e)},jt.prototype.isSelected=function(){return this._ogma.modules.selection.areActive(this)},jt.prototype.locate=function(e){return this._ogma.modules.locate.locateElements(this,e)},jt.prototype.getBoundingBox=function(){return this._ogma.modules.locate.getBoundingBox(this)},jt.prototype.setData=function(e,t){return arguments.length<2&&(t=e,e=null),this._ogma.modules.data.setProperty(this,e,t),this},jt.prototype.getData=function(e){return ju(arguments.length),this._ogma.modules.data.getProperty(this,e)[0]},jt.prototype.addClass=function(e,t){return this._ogma.modules.classes.addClassesToElements([e],this,t)},jt.prototype.addClasses=function(e,t){return this._ogma.modules.classes.addClassesToElements(e,this,t)},jt.prototype.removeClass=function(e,t){return this._ogma.modules.classes.removeClassesFromElements([e],this,t)},jt.prototype.removeClasses=function(e,t){return this._ogma.modules.classes.removeClassesFromElements(e,this,t)},jt.prototype.hasClass=function(e){return this._ogma.modules.classes.hasSingleElementClass(e,this)},jt.prototype.getClassList=function(){return this._ogma.modules.classes.getElementsClassList(this)[0]},jt.prototype.getGeoCoordinates=function(){var e=this._ogma.modules.graph,t=e.getNodeAttribute(ra).get(this._index),n=e.getNodeAttribute(oa).get(this._index);return{latitude:Yh(t)?t:void 0,longitude:Yh(n)?n:void 0}},jt.prototype.setGeoCoordinates=function(e){var t=this;return this.toList().setGeoCoordinates([e]).then(function(){return t})},jt.prototype.getAnimationInformation=function(){return this._ogma.modules.graphics.getAnimationInformation(this)[0]},jt.prototype.isVirtual=function(){return this._ogma.modules.transformations.isElementVirtual(this)},jt.prototype.getTransformation=function(){return this._ogma.modules.transformations.getElementTransformation(this)},jt.prototype.getMetaNode=function(){return this._ogma.modules.grouping.getMetaElement(this)[0]},jt.prototype.getSubNodes=function(){return this._ogma.modules.grouping.getSubElements(this)[0]},jt.prototype.pulse=function(e){this._ogma.modules.pulses.pulse(this,e)},jt);function jt(e,t){this.size=1,this.isNode=!0,this.isList=!1,this._index=e,this._ogma=t}Zu([_o],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute",setPosition:"setAttributes"});var or=(Object.defineProperty(kt.prototype,"size",{get:function(){return this._indexes.length},enumerable:!0,configurable:!0}),kt.prototype.setAttributes=function(e,t){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,e,t)},kt.prototype.setAttribute=function(e,t,n){return this._ogma.modules.individualAttributes.setSingleAttribute(this,e,t,n)},kt.prototype.getAttributes=function(e){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,e)},kt.prototype.getAttribute=function(e){return this._ogma.modules.individualAttributes.getSingleAttribute(this,e)},kt.prototype.resetAttributes=function(e,t){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,e,t)},kt.prototype.getPosition=function(){return this.getAttributes(["x","y"])},kt.prototype.getPositionOnScreen=function(){var e=this;return this.getPosition().map(function(t){return e._ogma.modules.camera.graphToScreenCoordinates(t)})},kt.prototype.replaceOriginalAttributes=function(e,t){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,e,t)},kt.prototype.getPreviousAttributes=function(e){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,e)},kt.prototype.getPreviousAttribute=function(e){return this._ogma.modules.individualAttributes.getSinglePreviousAttribute(this,e)},kt.prototype.getAdjacentNodes=function(e){return this._ogma.modules.graph.getAdjacentNodes(this,e)},kt.prototype.getAdjacentEdges=function(e){return this._ogma.modules.graph.getAdjacentEdges(this,e)},kt.prototype.getDegree=function(e){return this._ogma.modules.graph.getDegree(this,e)},kt.prototype.getConnectedComponents=function(e){return this._ogma.modules.graph.getConnectedComponents(this,e)},kt.prototype.fastGetAdjacentElements=function(){return this._ogma.modules.graph.fastGetNodesAdjacentElements(this)},kt.prototype.isVisible=function(){return this.isExcluded().map(function(e){return!e})},kt.prototype.isExcluded=function(){return this._ogma.modules.graph.isExcluded(this)},kt.prototype.setExcluded=function(e){return this._ogma.modules.graph.setExcluded(this,e)},kt.prototype.setVisible=function(e){return this.setExcluded(!e)},kt.prototype.toList=function(){return this},kt.prototype.toArray=function(){return Uh(this._ogma.modules.graph,this)},kt.prototype.clone=function(){return this._ogma.modules.graph.nodeList(this._indexes.slice())},kt.prototype.getId=function(){return qu(this._ogma.modules.graph,this)},kt.prototype.get=function(e){return Gh(this._ogma.modules.graph,this,e)},kt.prototype.forEach=function(e){Lh(this._ogma.modules.graph,this,e)},kt.prototype.map=function(e){return Fh(this._ogma.modules.graph,this,e)},kt.prototype.filter=function(e){return Ph(this._ogma.modules.graph,this,e)},kt.prototype.reduce=function(e,t){return Rh(this._ogma.modules.graph,this,e,t)},kt.prototype.concat=function(e){return Vh(this._ogma.modules.graph,this,e)},kt.prototype.dedupe=function(){return zh(this._ogma.modules.graph,this)},kt.prototype.slice=function(e,t){return this._ogma.modules.graph.nodeList(this._indexes.slice(e,t))},kt.prototype.indexOf=function(e){return e instanceof _o?this._indexes.indexOf(e._index):-1},kt.prototype.includes=function(e){return-1!==this.indexOf(e)},kt.prototype.inverse=function(){return Bh(this._ogma.modules.graph,this)},kt.prototype.sort=function(e){return qh(this._ogma.modules.graph,this,e)},kt.prototype.toJSON=function(e){return void 0===e&&(e={}),this.map(function(t){return t.toJSON(e)})},kt.prototype.setSelected=function(e){this._ogma.modules.selection.setActive(this,e)},kt.prototype.isSelected=function(){return this._ogma.modules.selection.areActive(this)},kt.prototype.locate=function(e){return this._ogma.modules.locate.locateElements(this,e)},kt.prototype.getBoundingBox=function(){return this._ogma.modules.locate.getBoundingBox(this)},kt.prototype.setData=function(e,t){if(arguments.length<2&&(t=e,e=null),"function"!=typeof t&&!ui(t))throw new Error("invalid argument "+t+"; expected array or function");return this._ogma.modules.data.setProperty(this,e,t,{dispatch:!0}),this},kt.prototype.fillData=function(e,t){return arguments.length<2&&(t=e,e=null),this._ogma.modules.data.setProperty(this,e,t,{dispatch:!1}),this},kt.prototype.getData=function(e){return ju(arguments.length),this._ogma.modules.data.getProperty(this,e)},kt.prototype.addClass=function(e,t){return this._ogma.modules.classes.addClassesToElements([e],this,t)},kt.prototype.addClasses=function(e,t){return this._ogma.modules.classes.addClassesToElements(e,this,t)},kt.prototype.removeClass=function(e,t){return this._ogma.modules.classes.removeClassesFromElements([e],this,t)},kt.prototype.removeClasses=function(e,t){return this._ogma.modules.classes.removeClassesFromElements(e,this,t)},kt.prototype.hasClass=function(e){var t=this;return this.map(function(n){return t._ogma.modules.classes.hasSingleElementClass(e,n)})},kt.prototype.getClassList=function(){return this._ogma.modules.classes.getElementsClassList(this)},kt.prototype.getGeoCoordinates=function(){for(var e=this._ogma.modules.graph,t=new Array(this._indexes.length),n=e.getNodeAttribute(ra).getMultiple(this._indexes),i=e.getNodeAttribute(oa).getMultiple(this._indexes),r=0,o=this._indexes.length;r<o;r++)t[r]={latitude:n[r],longitude:i[r]};return t},kt.prototype.setGeoCoordinates=function(e){var t=this,n=this._ogma.modules.geo,i=this._ogma.modules.graph,r=this.getId(),o=this._indexes,a=new Array(o.length),s=new Array(o.length);if(null===e&&(e=new Array(o.length).fill(null)),e.length!==o.length)throw new RangeError("You must provide coordinates for each node in the NodeList");for(var l=0,u=o.length;l<u;l++){var d=e[l]||{latitude:null,longitude:null},c=d.latitude,h=d.longitude,p=r[l];null==c&&null==h?c=h=void 0:(Jh(p,c),Xh(p,h)),a[l]=c,s[l]=h}return this.setData(n.latitudePath,a),this.setData(n.longitudePath,s),i.getNodeAttribute(ra).setMultiple(o,a),i.getNodeAttribute(oa).setMultiple(o,s),this._ogma.modules.transformations.refresh().then(function(){return t})},kt.prototype.getAnimationInformation=function(){return this._ogma.modules.graphics.getAnimationInformation(this)},kt.prototype.getMetaNode=function(){return this._ogma.modules.grouping.getMetaElement(this)},kt.prototype.getSubNodes=function(){return this._ogma.modules.grouping.getSubElements(this)},kt.prototype.pulse=function(e){this._ogma.modules.pulses.pulse(this,e)},kt);function kt(e,t){this.isList=!0,this.isNode=!0,this._indexes=e,this._ogma=t}function Wu(e,t,n,i){return void 0===n&&(n={}),void 0===i&&(i={}),iu(e,t,[n],i).get(0)}function xs(e,t,n,i){if(void 0===i&&(i={}),i.batchSize){for(var r=[],o=0;o<n.length;o+=i.batchSize)r.push(n.slice(o,o+i.batchSize));return r.reduce(function(a,s){var l=null;return a.then(function(u){return l=u,e.getDom().afterNextFrame()}).then(function(){return iu(e,t,s,i)}).then(function(u){return l.concat(u)})},Promise.resolve(t?e.nodeList():e.edgeList()))}return Promise.resolve(iu(e,t,n,i))}function iu(e,t,n,i){for(var r=e.storage.fetch(t),o=[],a=[],s=[],l=[],u=new Set,d=i.virtual,c=void 0!==d&&d,h=0,p=n;h<p.length;h++){var g=p[h];if("object"!=typeof g||null===g||Array.isArray(g))throw new Error(g+" is not a valid "+(t?"node":"edge"));var m=Ny(g.id);if(!r.getIndex(m,!1)&&!u.has(m)&&(a.push(m),o.push(g),u.add(m),!t)){var b=g,v=e.getExtremityIndex(m,b.source,"source"),y=e.getExtremityIndex(m,b.target,"target");s.push(v),l.push(y)}}var S=r.addElements(a);t?e.topology.allocateNodes(S):e.topology.allocateEdges(S,s,l);for(var A=r.getFlexArray("object"),C=r.getFlexArray("excluded"),O=r.getFlexArray("removed"),N=r.getFlexArray("virtual"),P=t?e.node:e.edge,F=t?e.nodeList:e.edgeList,L=e.getCacheLists(t),B=F(S),Y=0;Y<S.length;Y++){var X=S[Y];A.set(X,P(X))}return C.setMultiple(S,0),O.setMultiple(S,0),N.setMultiple(S,c?1:0),L.visible.invalidList(),L.all.invalidList(),L._all.invalidList(),c||L.raw.invalidList(),0!==B.size&&(t?e.fireEvent(x.ADD_NODES,{virtual:c,objects:o,nodes:B}):e.fireEvent(x.ADD_EDGES,{virtual:c,objects:o,edges:B})),B}Zu([or],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute",setPosition:"setAttributes"});var $h,Py=(bt(Ot,$h=E),Ot.prototype.onMounted=function(e,t){if(t.graph){var n=t.graph,i=n.nodes,r=n.edges;i&&this.addNodes(i),r&&this.addEdges(r)}},Ot.prototype.createIndexList=function(e){return this.storage.fetch(e).createIndexList()},Ot.prototype.setIndexFreeStep=function(e){this._indexFreeStep=e},Ot.prototype.getDom=function(){return this._dom},Ot.prototype.acquireIndexList=function(e){var t=e?this._nodeIndexLists:this._edgeIndexLists,n=t.find(function(i){return!i.isBusy()});return n||(n=this.createIndexList(e),t.push(n)),n.markBusy(),n},Ot.prototype.getObjectList=function(e){return e?this._nodes:this._edges},Ot.prototype.getListFactory=function(e){return e?this.nodeList:this.edgeList},Ot.prototype.getStorage=function(e){return e?this.storage.nodes:this.storage.edges},Ot.prototype.getFilter=function(e,t){var n=e?this._nodeFilters:this._edgeFilters;return n[t]||n.visible},Ot.prototype.fireEvent=function(e,t){this._events.fire(e,t)},Ot.prototype.getCacheLists=function(e){return e?this._nodeCacheLists:this._edgeCacheLists},Ot.prototype._resolvePromises=function(){var e=this._promisesToResolve;this._promisesToResolve=[],e.forEach(function(t){return t()})},Ot.prototype._initialize=function(){var e=this;this._nodeCacheLists=Nh(function(){return e.getNodeMaxIndex()},function(){return e.acquireIndexList(!0)},this._nodeFilters),this._edgeCacheLists=Nh(function(){return e.getEdgeMaxIndex()},function(){return e.acquireIndexList(!1)},this._edgeFilters),this.topology=new Oy(this),this._resolvePromises()},Ot.prototype.getNodeMaxIndex=function(){return this.storage.nodes.getMaxIndex()},Ot.prototype.getEdgeMaxIndex=function(){return this.storage.edges.getMaxIndex()},Ot.prototype.isExcluded=function(e){return this.storage.fetch(e.isNode).getFlexArray("excluded").getMultiple(e._indexes)},Ot.prototype.setExcluded=function(e,t){for(var n=t?1:0,i=e.isNode,r=this.storage.fetch(i),o=r.getFlexArray("excluded"),a=r.getFlexArray("removed"),s=this.acquireIndexList(i),l=this.getListFactory(i),u=0;u<e._indexes.length;u++){var d=e._indexes[u],c=o.get(d),h=a.get(d);n!==c&&0===h&&s.push(d)}var p=s.sliceAndReset();if(p.length){this.getCacheLists(e.isNode).visible.invalidList();var g=l(p);o.setMultiple(p,n),this._events.fire(x.EXCLUDED_STATE_CHANGE,{elements:g,value:t})}},Ot.prototype.addNode=function(e,t){return Wu(this,!0,e,t)},Ot.prototype.addEdge=function(e,t){return Wu(this,!1,e,t)},Ot.prototype.addNodes=function(e,t){return xs(this,!0,e,t)},Ot.prototype.addEdges=function(e,t){return xs(this,!1,e,t)},Ot.prototype.getExtremityIndex=function(e,t,n){if(t instanceof _o)return t._index;var i=this.storage.nodes.getIndex(t);if(!i)throw new Error("addEdge(s): invalid "+n+' for edge "'+e+'"; node "'+t+'" does not exist');return i},Ot.prototype.getNodes=function(e){return this.getElements(!0,e)},Ot.prototype.getEdges=function(e){return this.getElements(!1,e)},Ot.prototype.getElements=function(e,t){var n=e?this.nodeList:this.edgeList,i=e?or:vs,r=e?_o:ia;if(t&&"string"!=typeof t){var o=this.acquireIndexList(e),a=this.storage.fetch(e);if(t instanceof r)o.push(t._index);else if(ui(t))for(var s=0,l=t;s<l.length;s++){var u=l[s];u instanceof r?o.push(u._index):(p=a.getIndex(u))&&o.push(p)}else if(t instanceof i)for(var d=this.getFilter(e,"all"),c=t,h=0;h<c._indexes.length;h++){var p;d(p=c._indexes[h])&&o.push(p)}return n(o.sliceAndReset())}var g=t||"visible",m=this.getCacheLists(e)[g];if(!m)throw new Error('getNodes/getEdges: unexpected argument "'+g+'"');return n(m.getList())},Ot.prototype.getNode=function(e){return this._getElement(!0,e)},Ot.prototype.getEdge=function(e){return this._getElement(!1,e)},Ot.prototype._getElement=function(e,t){if(t instanceof(e?_o:ia))return t;var n=this.getStorage(e),i=this.getObjectList(e),r=n.getIndex(t);return r?i.get(r):void 0},Ot.prototype.clear=function(){this._events.fire(x.CLEAR_GRAPH),this.storage.nodes.clear(),this.storage.edges.clear(),this._initialize()},Ot.prototype.createAttribute=function(e,t){return this.storage.fetch(e).createFlexArray(t)},Ot.prototype.createNodeAttribute=function(e){return this.createAttribute(!0,e)},Ot.prototype.createEdgeAttribute=function(e){return this.createAttribute(!1,e)},Ot.prototype.getAttribute=function(e,t){return this.storage.fetch(e).getFlexArray(t)},Ot.prototype.getAttributes=function(e,t){var n=this;return t.map(function(i){return n.getAttribute(e,i)})},Ot.prototype.getNodeAttribute=function(e){return this.storage.nodes.getFlexArray(e)},Ot.prototype.getNodeAttributes=function(e){return this.getAttributes(!0,e)},Ot.prototype.getEdgeAttribute=function(e){return this.storage.edges.getFlexArray(e)},Ot.prototype.getEdgeAttributes=function(e){return this.getAttributes(!1,e)},Ot.prototype.getAllNodeAttributes=function(){return this.storage.nodes.getAllFlexArrays()},Ot.prototype.getAllEdgeAttributes=function(){return this.storage.edges.getAllFlexArrays()},Ot.prototype.setSource=function(e,t){var n=this.getNode(t);this.topology.setExtremities(e._indexes,n._indexes,null)},Ot.prototype.setTarget=function(e,t){var n=this.getNode(t);this.topology.setExtremities(e._indexes,null,n._indexes)},Ot.prototype.getParallelEdges=function(e,t){return void 0===t&&(t={}),this.topology.getParallelEdges(e,t)},Ot.prototype.getEdgesBetweenTwoNodes=function(e,t){return this.edgeList(this.topology.getEdgesBetweenTwoNodes(e._index,t._index))},Ot.prototype.getAdjacentDirections=function(e){return this.topology.getAdjacentDirections(e)},Ot.prototype.getEdgeIndexesInDirection=function(e){return this.topology.getEdgeIndexesInDirection(e)},Ot.prototype.fastGetNodesAdjacentElements=function(e){return this.topology.fastGetNodesAdjacentElements(e._indexes)},Ot.prototype.fastGetEdgesAdjacentElements=function(e){return this.topology.fastGetEdgesAdjacentElements(e._indexes)},Ot.prototype.getAdjacentNodes=function(e,t){return this.nodeList(this.topology.getAdjacentElements(!0,e._indexes,t))},Ot.prototype.getAdjacentEdges=function(e,t){return this.edgeList(this.topology.getAdjacentElements(!1,e._indexes,t))},Ot.prototype.getDegree=function(e,t){return this.topology.getDegree(e._indexes,t)},Ot.prototype.degrees=function(e,t){return this.topology.degrees(e,t)},Ot.prototype.getAdjacencyList=function(e){var t=void 0===e?{}:e,n=t.directed,r=t.internalIndexes,a=t.weight;return this.topology.getAdjacencyList({directed:void 0!==n&&n,weight:void 0===a?1:a,ids:!(void 0!==r&&r),nodes:t.indexes||this.getNodes(t.nodes)._indexes})},Ot.prototype.getConnectedComponents=function(e,t){return this.topology.getConnectedComponents(e._indexes,t)},Ot.prototype.getConnectedComponentByNode=function(e,t){return this.topology.getConnectedComponents(e._indexes,t)},Ot);function Ot(e,t){var n=e.dom,i=e.events,r=$h.call(this)||this;return r.storage={nodes:new fo(!0),edges:new fo(!1),fetch:function(o){return o?this.nodes:this.edges}},r._promisesToResolve=[],r._indexFreeStep=0,r._nodeIndexLists=[],r._edgeIndexLists=[],r._events=i,r._dom=n,r._events.register([x.ADD_NODES,x.ADD_EDGES,x.EXCLUDED_STATE_CHANGE],[x.CLEAR_GRAPH,x.BEFORE_REMOVE_NODES,x.REMOVE_NODES,x.BEFORE_REMOVE_EDGES,x.REMOVE_EDGES]),[{name:"excluded",storage:1,default:1},{name:"removed",storage:1,default:1},{name:"virtual",storage:1,default:0}].forEach(function(o){r.createNodeAttribute(o),r.createEdgeAttribute(o)}),r.node=t.node,r.edge=t.edge,r.nodeList=t.nodeList,r.edgeList=t.edgeList,r._nodes=r.createAttribute(!0,{name:"object",storage:"any"}),r._edges=r.createAttribute(!1,{name:"object",storage:"any"}),r.createAttribute(!1,{name:"source",storage:32}),r.createAttribute(!1,{name:"target",storage:32}),r._nodeFilters=Oh(r.storage.nodes),r._edgeFilters=Oh(r.storage.edges),r._initialize(),r._events.on({newFrame:function(){1===r._indexFreeStep?r._indexFreeStep=2:2===r._indexFreeStep&&(r.storage.nodes.freeIndexes(),r.storage.edges.freeIndexes(),r._indexFreeStep=0)}}),r}var _d=["AliceBlue","#F0F8FF","AntiqueWhite","#FAEBD7","Aqua","#00FFFF","Aquamarine","#7FFFD4","Azure","#F0FFFF","Beige","#F5F5DC","Bisque","#FFE4C4","Black","#000000","BlanchedAlmond","#FFEBCD","Blue","#0000FF","BlueViolet","#8A2BE2","Brown","#A52A2A","BurlyWood","#DEB887","CadetBlue","#5F9EA0","Chartreuse","#7FFF00","Chocolate","#D2691E","Coral","#FF7F50","CornflowerBlue","#6495ED","Cornsilk","#FFF8DC","Crimson","#DC143C","Cyan","#00FFFF","DarkBlue","#00008B","DarkCyan","#008B8B","DarkGoldenRod","#B8860B","DarkGray","#A9A9A9","DarkGrey","#A9A9A9","DarkGreen","#006400","DarkKhaki","#BDB76B","DarkMagenta","#8B008B","DarkOliveGreen","#556B2F","DarkOrange","#FF8C00","DarkOrchid","#9932CC","DarkRed","#8B0000","DarkSalmon","#E9967A","DarkSeaGreen","#8FBC8F","DarkSlateBlue","#483D8B","DarkSlateGray","#2F4F4F","DarkSlateGrey","#2F4F4F","DarkTurquoise","#00CED1","DarkViolet","#9400D3","DeepPink","#FF1493","DeepSkyBlue","#00BFFF","DimGray","#696969","DimGrey","#696969","DodgerBlue","#1E90FF","FireBrick","#B22222","FloralWhite","#FFFAF0","ForestGreen","#228B22","Fuchsia","#FF00FF","Gainsboro","#DCDCDC","GhostWhite","#F8F8FF","Gold","#FFD700","GoldenRod","#DAA520","Gray","#808080","Grey","#808080","Green","#008000","GreenYellow","#ADFF2F","HoneyDew","#F0FFF0","HotPink","#FF69B4","IndianRed","#CD5C5C","Indigo","#4B0082","Ivory","#FFFFF0","Khaki","#F0E68C","Lavender","#E6E6FA","LavenderBlush","#FFF0F5","LawnGreen","#7CFC00","LemonChiffon","#FFFACD","LightBlue","#ADD8E6","LightCoral","#F08080","LightCyan","#E0FFFF","LightGoldenRodYellow","#FAFAD2","LightGray","#D3D3D3","LightGrey","#D3D3D3","LightGreen","#90EE90","LightPink","#FFB6C1","LightSalmon","#FFA07A","LightSeaGreen","#20B2AA","LightSkyBlue","#87CEFA","LightSlateGray","#778899","LightSlateGrey","#778899","LightSteelBlue","#B0C4DE","LightYellow","#FFFFE0","Lime","#00FF00","LimeGreen","#32CD32","Linen","#FAF0E6","Magenta","#FF00FF","Maroon","#800000","MediumAquaMarine","#66CDAA","MediumBlue","#0000CD","MediumOrchid","#BA55D3","MediumPurple","#9370DB","MediumSeaGreen","#3CB371","MediumSlateBlue","#7B68EE","MediumSpringGreen","#00FA9A","MediumTurquoise","#48D1CC","MediumVioletRed","#C71585","MidnightBlue","#191970","MintCream","#F5FFFA","MistyRose","#FFE4E1","Moccasin","#FFE4B5","NavajoWhite","#FFDEAD","Navy","#000080","OldLace","#FDF5E6","Olive","#808000","OliveDrab","#6B8E23","Orange","#FFA500","OrangeRed","#FF4500","Orchid","#DA70D6","PaleGoldenRod","#EEE8AA","PaleGreen","#98FB98","PaleTurquoise","#AFEEEE","PaleVioletRed","#DB7093","PapayaWhip","#FFEFD5","PeachPuff","#FFDAB9","Peru","#CD853F","Pink","#FFC0CB","Plum","#DDA0DD","PowderBlue","#B0E0E6","Purple","#800080","RebeccaPurple","#663399","Red","#FF0000","RosyBrown","#BC8F8F","RoyalBlue","#4169E1","SaddleBrown","#8B4513","Salmon","#FA8072","SandyBrown","#F4A460","SeaGreen","#2E8B57","SeaShell","#FFF5EE","Sienna","#A0522D","Silver","#C0C0C0","SkyBlue","#87CEEB","SlateBlue","#6A5ACD","SlateGray","#708090","SlateGrey","#708090","Snow","#FFFAFA","SpringGreen","#00FF7F","SteelBlue","#4682B4","Tan","#D2B48C","Teal","#008080","Thistle","#D8BFD8","Tomato","#FF6347","Turquoise","#40E0D0","Violet","#EE82EE","Wheat","#F5DEB3","White","#FFFFFF","WhiteSmoke","#F5F5F5","Yellow","#FFFF00","YellowGreen","#9ACD32"],Dy=/^rgba?\((\d+),?\s*(\d+),?\s*(\d+),?\s*((\d+)?\.?\d+)*\)$/;function md(e,t){void 0===t&&(t=[0,0,0,0]);var n=Dy.exec(e);return n?(t[0]=parseInt(n[1])/255,t[1]=parseInt(n[2])/255,t[2]=parseInt(n[3])/255,t[3]=void 0===n[4]?1:parseFloat(n[4]),t):null}function Yu(e){return e<16?"0"+e.toString(16):e.toString(16)}function ep(e){var r=e[3];return"rgba("+(256*e[0]|0)+","+(256*e[1]|0)+","+(256*e[2]|0)+","+(void 0===r?1:r)+")"}function vd(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(n,i,r,o){return i+i+r+r+o+o});var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?[parseInt(t[1],16)/255,parseInt(t[2],16)/255,parseInt(t[3],16)/255,1]:null}var ru=[0,0,0,0],ou=(Xu.prototype.parseColor=function(e){var t=this._colorByName[e];if(void 0===t){var n=e+"";t="#"===n.charAt(0)?vd(n):md(n),this._colorByName[e]=t}return t},Xu.prototype.toHexa=function(e){var t=this.parseColor(e),i=t[1],r=t[2];return"#"+Yu(255*t[0])+Yu(255*i)+Yu(255*r)},Xu.prototype.rgbaToRgb=function(e){var t=1,n=e;return n&&md(e,ru)&&(n="rgb("+255*ru[0]+","+255*ru[1]+","+255*ru[2]+")",t=parseFloat(ru[3].toString())),{color:n,opacity:t}},Xu);function Xu(){this._colorByName={},this._colorByName.null=[0,0,0,0],this._colorByName.transparent=[0,0,0,0];for(var e=0;e<_d.length;e+=2){var t=_d[e].toLowerCase();this._colorByName[t]=vd(_d[e+1])}}var bs,Ry=((bs={})[2]="image",bs[4]="piechart",bs[3]="text",bs[5]="icon",bs[6]="badge",bs),zy=(Xi.prototype.reset=function(){this._init_()},Xi.prototype._init_=function(){this._mustUpdate=!0,this._nextPatternId=1,this._patterns=[null],this._patternsByHash={},this._pixelRatio=1,this._nullPattern={id:-1,type:1,attributes:{}}},Xi.prototype._increaseNextId=function(){var e=this._nextPatternId++;for(e%256==255&&(e=this._nextPatternId++);this._patterns.length<=e;)this._patterns.push(void 0);return e},Xi.prototype._createPattern=function(e){var t=e.type,n=e.attributes,i={id:this._increaseNextId(),type:t,attributes:this._cloneAttributes(t,n)};return this._patterns[i.id]=i,this._mustUpdate=!0,i},Xi.prototype._cloneAttributes=function(e,t){return 2===e?{image:t.image,scaled:t.scaled,duplicated:t.duplicated}:3===e||5===e||6===e?{font:t.font,size:t.size,style:t.style,text:t.text,align:t.align||"center",offset:t.offset||0}:4===e?{colors:t.colors,colorArray:t.colors.split(";").map(function(n){return n.trim()})}:void 0},Xi.prototype.getPatternList=function(){return this._patterns.filter(function(e){return e})},Xi.prototype.update=function(){this._mustUpdate&&(this._version+=1,this._mustUpdate=!1)},Xi.prototype.setPixelRatio=function(e){e!==this._pixelRatio&&(this._pixelRatio=e,this._mustUpdate=!0)},Xi.prototype.getPixelRatio=function(){return this._pixelRatio},Xi.prototype.notifyUpdate=function(){this._mustUpdate=!0},Xi.prototype.getIdFromDefinition=function(e){var t=e.type,n=e.attributes,r=0;return t&&1!==t&&7!==t&&(2!==t||n.image)&&(!(3===t||5===t||6===t)||n.text&&n.font)&&(r=this._addPattern(e),3===t&&"normal"===n.style&&(n.style="bold",this._addPattern(e))),r},Xi.prototype._addPattern=function(e){var t=this._getPatternHash(e),n=this._patternsByHash[t];return n||(65500<this._nextPatternId?eo("maximum number of pattern exceeded"):(n=this._createPattern(e).id,this._patternsByHash[t]=n)),n},Xi.prototype._getPatternHash=function(e){var t=e.type,n=e.attributes,i=[Ry[t]];return 2===t?i.push(n.scaled?"scaled":"non-scaled",n.duplicated?"duplicated":"non-duplicated",n.image.src||n.image.toDataURL()):3===t?i.push(n.text,n.font,n.style,n.size,n.align||"center",n.offset||0):5===t||6===t?i.push(n.text,n.font,n.style,n.size):i.push(n.colors),i.join("+")},Xi.prototype.getDefinitionFromId=function(e){return e?this._patterns[e]:this._nullPattern},Xi.prototype.getVersion=function(){return this._version},Xi);function Xi(){this._pixelRatio=1,this._nextPatternId=1,this._version=0,this._init_()}var tp=Math.round(Math.log2(512)),bd=Math.round(Math.log2(128)),By=tp+bd,Ed=Math.round(Math.sqrt(16)),Sd=128*Ed,wr=256;function np(e){return e.map(function(t){var r=t.r;return{x:t.x,y:t.y,r:void 0===r?0:r}})}var Vy=(la.prototype.register=function(e,t){var n=t.getDistanceFromStrokeVertically,i=t.getDistanceFromStrokeHorizontally,r=t.points,o=t.hole,a=t.isSimple;if(!this._byName[e]){for(var s=a?1:8,l=a?7:15;this._byId[s];)s+=1;if(l<s)throw new Error("max number of shape exceeded");var u={id:s,name:e,getDistanceFromStrokeVertically:n,getDistanceFromStrokeHorizontally:i,points:np(r.slice()),hole:o?np(o.slice()):null,isSimple:!!a};return this._mustUpdate=!0,this._byId[s]=u,this._byName[e]=u}},la.prototype.getIdFromName=function(e){return this._byName[e].id},la.prototype.getNameFromId=function(e){var t=this._byId[e];return t?t.name:null},la.prototype.getDefinitionFromName=function(e){return this._byName[e]||null},la.prototype.update=function(){this._mustUpdate&&(this._version+=1,this._mustUpdate=!1)},la.prototype.getVersion=function(){return this._version},la.prototype.getShapeList=function(){return this._byId.filter(function(e){return e})},la);function la(){this._version=0,this._mustUpdate=!0,this._byName={},this._byId=new Array(16)}var Uy=(ii.prototype.update=function(){this._mustUpdate&&(this._version+=1,this._mustUpdate=!1,this._isFullyAllocated&&this._nbCellsFreed===this._nbCellsAllocated&&(this._isFullyFreed=!0))},ii.prototype.allocate=function(e){var t=-1;return!this._isFullyAllocated&&this._nbCellsAllocated+e<=this._capacity?(t=this._nbCellsAllocated,this._nbCellsAllocated+=e,this._mustUpdate=!0):this._isFullyAllocated=!0,t},ii.prototype.free=function(e,t){for(var n=0;n<t;n++){var i=(e+n)*this._elementSize;if(0===this._dataView.getUint16(i))throw new Error('"free": invalid address provided');this._dataView.setUint16(i,0)}this._mustUpdate=!0,this._nbCellsFreed+=t},ii.prototype.triggerUpdate=function(){this._mustUpdate=!0},ii.prototype.isEmpty=function(){return this._nbCellsFreed===this._nbCellsAllocated},ii.prototype.isFullyFreed=function(){return this._isFullyFreed},ii.prototype.getId=function(){return this._id},ii.prototype.getDepth=function(){return this._depth},ii.prototype.getElementType=function(){return this._elementType},ii.prototype.getDataView=function(){return this._dataView},ii.prototype.getByteArray=function(){return this._byteArray},ii.prototype.getElementSize=function(){return this._elementSize},ii.prototype.isAnimated=function(){return this._animated},ii.prototype.getCapacity=function(){return this._capacity},ii.prototype.getSize=function(){return this._nbCellsAllocated},ii.prototype.getNbSideElementsPerMainElement=function(){return this._nbSideElementsPerMainElement},ii.prototype.hasSideData=function(){return 0<this._nbSideElementsPerMainElement},ii.prototype.getSideDataView=function(){return this._sideDataView},ii.prototype.getSideByteArray=function(){return this._sideByteArray},ii.prototype.getTotalSideElementsSize=function(){return this._totalSideElementsSize},ii.prototype.getVersion=function(){return this._version},ii.prototype.getStencilUsage=function(){return this._stencilUsage},ii);function ii(e){var t=e.elementSize,n=e.sideElementSize,i=e.nbSideElementsPerMainElement,r=e.id,o=e.depth,a=e.elementType,s=e.animated,l=e.stencilUsage;this._version=0,this._nbCellsAllocated=0,this._nbCellsFreed=0,this._isFullyAllocated=!1,this._isFullyFreed=!1,this._mustUpdate=!0,this._capacity=512,this._id=r,this._depth=o,this._elementType=a,this._animated=s,this._stencilUsage=l,this._elementSize=t,this._sideElementSize=n,this._nbSideElementsPerMainElement=i,this._totalSideElementsSize=i*n,this._byteCapacity=this._capacity*this._elementSize,this._byteArray=new Uint8Array(this._byteCapacity),this._dataView=new DataView(this._byteArray.buffer),this._sideByteCapacity=this._capacity*this._totalSideElementsSize,this._sideByteArray=new Uint8Array(this._sideByteCapacity),this._sideDataView=new DataView(this._sideByteArray.buffer)}var jy=(ar.prototype.reset=function(){this._init_()},ar.prototype._init_=function(){this._buffersByDepth=new Array(100),this._buffersById=[],this._buffersByAscendingDepth=[],this._buffersByDescendingDepth=[],this._mustUpdate=!0},ar.prototype._fillBlockInfo=function(e,t,n,i){return this._blockInfo.buffer=e,this._blockInfo.offset=t,this._blockInfo.size=n,this._blockInfo.address=i,this._blockInfo},ar.prototype._createBuffer=function(e,t,n,i,r){var s=new Uy({elementSize:t?120:52,sideElementSize:4,nbSideElementsPerMainElement:i,id:this._buffersById.length,depth:n,elementType:e,animated:t,stencilUsage:r});return this._buffersById.push(s),s},ar.prototype.getBlockInfo=function(e){return this._getBlockInfo(e)},ar.prototype._getBlockInfo=function(e){return this._fillBlockInfo(this._buffersById[e>>By],(e>>bd)%512,e%128,e)},ar.prototype.allocateBlock=function(e,t,n,i,r,o,a){var s=function(X,ae){for(var ie=0;ie<X;)ie+=8;return ie}(o);this._mustUpdate=!0;var l=null,u=-1;if(e){var d=this._getBlockInfo(e),c=d.buffer,h=d.offset,p=d.size,g=d.size===r,m=c.getDepth()===i,b=c.getElementType()===t,v=c.isAnimated()===n,y=c.getNbSideElementsPerMainElement()===s,S=c.getStencilUsage()===a;g&&m&&b&&v&&y&&S?(c.triggerUpdate(),l=c,u=h):c.free(h,p)}if(-1===u){var A=+n,C=s/8,O=this._buffersByDepth[i]||Array(2),N=(this._buffersByDepth[i]=O)[A]||[],P=(O[A]=N)[t]||Array(16),F=(N[t]=P)[C]||Array(4),L=(P[C]=F)[a]||[],B=(F[a]=L)[L.length-1];B&&(u=(l=B).allocate(r)),-1===u&&(u=(l=this._createBuffer(t,n,i,s,a)).allocate(r),L.push(l))}var Y=((l.getId()<<tp)+u<<bd)+r;return this._fillBlockInfo(l,u,r,Y)},ar.prototype.freeBlock=function(e){if(e){this._mustUpdate=!0;var t=this._getBlockInfo(e);t.buffer.free(t.offset,t.size)}return 0},ar.prototype._sortBuffersByDepth=function(){for(var e=[],t=0;t<this._buffersByDepth.length;t++){var n=this._buffersByDepth[t];if(n)for(var i=0;i<n.length;i++){var r=n[i];if(r)for(var o=0;o<r.length;o++){var a=r[o];if(a)for(var s=0;s<a.length;s++){var l=a[s];if(l)for(var u=0;u<l.length;u++){var d=l[u];if(d)for(var c=0;c<d.length;c++){var h=d[c];h.update(),h.isFullyFreed()?(this._buffersById[h.getId()]=void 0,d.splice(c,1),--c):e.push(h)}}}}}}this._buffersByAscendingDepth=e,this._buffersByDescendingDepth=e.slice().reverse()},ar.prototype.update=function(){this._mustUpdate&&(this._sortBuffersByDepth(),this._version+=1,this._mustUpdate=!1)},ar.prototype.getBuffers=function(){return this._buffersById},ar.prototype.getBuffersByAscendingDepth=function(){return this._buffersByAscendingDepth},ar.prototype.getBuffersByDescendingDepth=function(){return this._buffersByDescendingDepth},ar.prototype.getVersion=function(){return this._version},ar);function ar(){this._version=0,this._version=0,this._blockInfo={buffer:null,offset:0,size:0,address:0},this._init_()}var ip=(Object.defineProperty(da.prototype,"__dummy",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(da.prototype,"parentNode",{get:function(){return null},enumerable:!0,configurable:!0}),da.prototype.getContext=function(e){return"2d"===e?this.__context:null},da.prototype.toDataURL=function(e){return void 0===e&&(e="png"),"data:image/"+e+";base64,"},da.prototype.addEventListener=function(){},da.prototype.removeEventListener=function(){},da.prototype.getBoundingClientRect=function(){return{left:0,top:0,bottom:0,right:0,width:this.width,height:this.height}},da);function da(){this.style={},this.width=300,this.height=150,this.__context=new rp,this.style={},this.width=300,this.height=150}var rp=(Object.defineProperty(Tn.prototype,"font",{set:function(e){var t=e.match(/\d+/);t&&(this._fontSize=parseFloat(t[0]))},enumerable:!0,configurable:!0}),Object.defineProperty(Tn.prototype,"fillStyle",{set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(Tn.prototype,"textBaseline",{set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(Tn.prototype,"textAlign",{set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(Tn.prototype,"strokeStyle",{set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(Tn.prototype,"lineWidth",{set:function(e){},enumerable:!0,configurable:!0}),Tn.prototype.fill=function(){},Tn.prototype.stroke=function(){},Tn.prototype.clearRect=function(){},Tn.prototype.fillRect=function(){},Tn.prototype.strokeRect=function(){},Tn.prototype.beginPath=function(){},Tn.prototype.closePath=function(){},Tn.prototype.moveTo=function(){},Tn.prototype.lineTo=function(){},Tn.prototype.rect=function(){},Tn.prototype.arc=function(){},Tn.prototype.save=function(){},Tn.prototype.restore=function(){},Tn.prototype.clip=function(){},Tn.prototype.translate=function(){},Tn.prototype.rotate=function(){},Tn.prototype.fillText=function(){},Tn.prototype.setLineDash=function(){},Tn.prototype.quadraticCurveTo=function(){},Tn.prototype.bezierCurveTo=function(){},Tn.prototype.drawImage=function(){},Tn.prototype.measureText=function(e){return{width:e.length*Math.ceil(.625*this._fontSize)}},Tn.prototype.getImageData=function(){return{width:0,height:0,data:new Uint8ClampedArray(0)}},Tn);function Tn(){this._fontSize=10}var nl=xi("canvas")||xi("canvas-prebuilt");function di(){var e=null;return nr?e=document.createElement("canvas"):nl?(e=nl.createCanvas?nl.createCanvas(300,150):new nl(300,150)).style={}:e=new ip,e}function Za(e,t,n,i){void 0===n&&(n=e.width),void 0===i&&(i=e.height),t.clearRect(0,0,n,i)}function ca(e,t,n,i){void 0===i&&(i=""),e.font=i+" "+n+"px "+t}function op(){return null!==Ad(di(),{})}function Ad(e,t){var n=e.getContext("webgl",t);return(n=n||e.getContext("experimental-webgl",t))||null}function sp(e){return e.pieceId=0,e.shape="",e.x1=0,e.y1=0,e.x2=0,e.y2=0,e.rectWidthOrSourceRadiusScaled=0,e.rectWidthOrSourceRadiusFixed=0,e.rectHeightOrTargetRadiusScaled=0,e.rectHeightOrTargetRadiusFixed=0,e.thicknessOrFontSizeScaled=0,e.thicknessOrFontSizeFixed=0,e.strokeWidthScaled=0,e.strokeWidthFixed=0,e.offsetScaled=0,e.offsetFixed=0,e.pattern.type=0,e.opacity=1,e.fillColor=null,e.strokeColor=null,e.patternColor=null,e.globalMinVisibleSize=0,e.strokeMinVisibleSize=0,e.patternMinVisibleSize=0,e.offsetAngle=0,e.patternScale=0,e.symbolicSize=0,e.curvature=0,e.dashLength=0,e.gapLength=0,e.hasHead=!1,e.hasTail=!1,e.isBodyTriangle=!1,e.isSelfLoop=!1,e.isText=!1,e.adjustTextAngle=!1,e.unusedFlag1=!1,e.unusedFlag2=!1,e.unusedFlag3=!1,e}function up(e,t,n,i){e.width=t*i,e.height=n*i,e.style.width=t+"px",e.style.height=n+"px"}var Cd=(zn.createInitData=function(){return null},zn.getName=function(){return null},zn.isAvailable=function(){return!0},zn.prototype.getDomElement=function(){return null},zn.prototype._initCanvas=function(e){e.style.touchAction="none"},zn.prototype.export=function(e){return Promise.resolve()},zn.prototype.extractElement=function(e,t){return this._memoryManager.extractGenericElement(e,t,this._scales)},zn.prototype._compareDimensions=function(e,t,n){return(e!==this._width||t!==this._height||n!==this._pixelRatio)&&(this._width=e,this._height=t,this._pixelRatio=n,!0)},zn.prototype._compareView=function(e,t,n,i){return(e!==this._viewX||t!==this._viewY||n!==this._viewZoom||i!==this._viewAngle)&&(this._viewX=e,this._viewY=t,this._viewZoom=n,this._viewAngle=i,this._viewAngleCos=Math.cos(i),this._viewAngleSin=Math.sin(i),!0)},zn.prototype._compareCurrentTime=function(e){return e!==this._currentTime&&(this._currentTime=e,!0)},zn.prototype._compareBackgroundColor=function(e,t){return(e!==this._backgroundColor||t!==this._renderBackground)&&(this._renderBackground=t,this._backgroundColor=e,this._backgroundRgba=this._colorManager.parseColor(this._backgroundColor),!0)},zn.prototype._compareShapes=function(){return this._shapesVersion!==this._shapeManager.getVersion()&&(this._shapesVersion=this._shapeManager.getVersion(),!0)},zn.prototype._comparePatterns=function(){return this._patternsVersion!==this._patternManager.getVersion()&&(this._patternsVersion=this._patternManager.getVersion(),!0)},zn.prototype._compareBoundaries=function(){return this._boundariesVersion!==this._boundariesManager.getVersion()&&(this._boundariesVersion=this._boundariesManager.getVersion(),!0)},zn.prototype._compareTexts=function(){return this._textsVersion!==this._textManager.getVersion()&&(this._textsVersion=this._textManager.getVersion(),!0)},zn.prototype._compareIsDisplayableBuffer=function(e){return this._isBufferDisplayable!==e&&(this._isBufferDisplayable=e,!0)},zn.prototype._compareHideImages=function(e){return this._hideImages!==e&&(this._hideImages=e,!0)},zn.prototype.renderFrame=function(e){var t=e.x,n=e.y,i=e.zoom,r=e.angle,o=e.width,a=e.height,s=e.pixelRatio,l=e.backgroundColor,u=e.currentTime,d=e.isBufferDisplayable,c=e.hideImages,h=e.renderBackground,p=this._compareShapes(),g=this._comparePatterns(),m=this._compareBoundaries(),b=this._compareTexts(),v=this._compareDimensions(o,a,s),y=this._compareView(t,n,i,r),S=this._compareCurrentTime(u),A=this._compareBackgroundColor(l,h),C=this._compareIsDisplayableBuffer(d),O=this._compareHideImages(c);if(m){var N=this._boundariesManager,P=this._scales;P.bytesToActualCoord=1,P.bytesToActualScaledSize=N.maxScaledSize/65535,P.bytesToActualMinVisibleSize=N.maxMinVisibleSize/15,P.bytesToActualSymbolicSize=N.maxSymbolicSize/255,P.bytesToActualDashLength=N.maxDashLength/3,P.bytesToActualGapLength=N.maxGapLength/3,P.bytesToActualPatternScale=N.maxPatternScale/255}this._firstFrame&&this._beforeFirstFrame(),this._render({shapesChanged:p,patternsChanged:g,boundariesChanged:m,textsChanged:b,dimensionsChanged:v,viewChanged:y,currentTimeChanged:S,backgroundColorChanged:A,isBufferDisplayableChanged:C,isHideImagesChanged:O}),this._firstFrame&&(this._afterFirstFrame(),this._firstFrame=!1)},zn.prototype._render=function(e){},zn.prototype._beforeFirstFrame=function(){},zn.prototype._afterFirstFrame=function(){},zn.prototype.destroy=function(){},zn.prototype.ensureAnimationsReady=function(){},zn.prototype.getImageData=function(){return null},zn.prototype.setViewportClipping=function(e){},zn);function zn(e){var t=e.bufferList,n=e.patternManager,i=e.boundariesManager,r=e.colorManager,o=e.shapeManager,a=e.textManager,s=e.easingManager,l=e.memoryManager;this._firstFrame=!0,this._width=0,this._height=0,this._pixelRatio=0,this._viewX=0,this._viewY=0,this._viewZoom=0,this._viewAngle=0,this._viewAngleCos=0,this._viewAngleSin=0,this._currentTime=0,this._scales={bytesToActualCoord:0,bytesToActualScaledSize:0,bytesToActualMinVisibleSize:0,bytesToActualSymbolicSize:0,bytesToActualDashLength:0,bytesToActualGapLength:0,bytesToActualPatternScale:0},this._shapesVersion=0,this._patternsVersion=0,this._boundariesVersion=0,this._textsVersion=0,this._backgroundColor=null,this._backgroundRgba=[1,1,1,0],this._renderBackground=!1,this._isBufferDisplayable=null,this._hideImages=!1,this._genericObject={valid:!1,id:void 0,end:{pieceId:0,shape:"circle",x1:0,y1:0,x2:0,y2:0,rectWidthOrSourceRadiusScaled:0,rectWidthOrSourceRadiusFixed:0,rectHeightOrTargetRadiusScaled:0,rectHeightOrTargetRadiusFixed:0,thicknessOrFontSizeScaled:0,thicknessOrFontSizeFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,offsetScaled:0,offsetFixed:0,pattern:{id:void 0,type:0,attributes:{}},opacity:1,fillColor:null,strokeColor:null,patternColor:null,globalMinVisibleSize:0,strokeMinVisibleSize:0,patternMinVisibleSize:0,offsetAngle:0,patternScale:0,symbolicSize:-1,curvature:0,dashLength:0,gapLength:0,hasHead:!1,hasTail:!1,isBodyTriangle:!1,isSelfLoop:!1,isText:!1,adjustTextAngle:!1,unusedFlag1:!1,unusedFlag2:!1,unusedFlag3:!1},start:{pieceId:0,shape:"circle",x1:0,y1:0,x2:0,y2:0,rectWidthOrSourceRadiusScaled:0,rectWidthOrSourceRadiusFixed:0,rectHeightOrTargetRadiusScaled:0,rectHeightOrTargetRadiusFixed:0,thicknessOrFontSizeScaled:0,thicknessOrFontSizeFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,offsetScaled:0,offsetFixed:0,pattern:{id:void 0,type:0,attributes:{}},opacity:1,fillColor:null,strokeColor:null,patternColor:null,globalMinVisibleSize:0,strokeMinVisibleSize:0,patternMinVisibleSize:0,offsetAngle:0,patternScale:0,symbolicSize:-1,curvature:0,dashLength:0,gapLength:0,hasHead:!1,hasTail:!1,isBodyTriangle:!1,isSelfLoop:!1,isText:!1,adjustTextAngle:!1,unusedFlag1:!1,unusedFlag2:!1,unusedFlag3:!1},animation:{duration:0,beginTime:-1,easing:"linear"}},this._littleEndian=fr(),this._bufferList=t,this._shapeManager=o,this._patternManager=n,this._boundariesManager=i,this._textManager=a,this._colorManager=r,this._easingManager=s,this._memoryManager=l}var ha,Ss,Td="#define D3D9_FIX 0\n#define ANIMATED 0\nprecision highp float;\nprecision mediump int;\nattribute /*ushort*/ vec4 a_final_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature;\nattribute /*ushort*/ vec4 a_final_patternId_fillRGBA_strokeRGBA_patternRGBA;\nattribute /*float*/ vec4 a_final_x1_y1_x2_y2;\nattribute /*ushort*/ vec4 a_final_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed;\nattribute /*ushort*/ vec4 a_final_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed;\nattribute /*ushort*/ vec2 a_final_offsetScaled_offsetFixed;\nattribute /*ushort*/ vec4 a_prev_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature;\nattribute /*ushort*/ vec4 a_prev_patternId_fillRGBA_strokeRGBA_patternRGBA;\nattribute /*float*/ vec4 a_prev_x1_y1_x2_y2;\nattribute /*ushort*/ vec4 a_prev_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed;\nattribute /*ushort*/ vec4 a_prev_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed;\nattribute /*ushort*/ vec2 a_prev_offsetScaled_offsetFixed;\nattribute /*float*/ vec2 a_animationBeginTime_animationDuration; \nattribute /*ushort*/ vec4 a_animationEasing; \nattribute /*ushort*/ vec2 a_text_charId_charOffsetXY; \nattribute vec3 a_vertexInfo;\nuniform float u_viewWidth;\nuniform float u_viewHeight;\nuniform float u_viewX;\nuniform float u_viewY;\nuniform float u_viewAngle;\nuniform float u_viewZoom;\nuniform float u_currentTime;\nuniform float u_pixelRatio;\nuniform sampler2D u_patternInfoTexture;\nvarying vec4 a;\nvarying vec4 b;\nvarying vec4 c;\nvarying vec2 d;\nvarying vec2 e;\n#if D3D9_FIX\nvarying vec4 f;\nvarying vec3 g;\nvarying vec4 h;\nvarying vec4 i;\n#else\nvarying float j;\nvarying vec2 k;\nvarying vec2 l;\nvarying vec2 m;\nvarying float n;\nvarying float o;\nvarying vec2 p;\nvarying vec2 q;\nvarying float r;\nvarying float s;\n#endif\nconst float EPSILON = 0.000001;\nconst float INFINITY = 10000000.0;\nconst float PI = 3.14159265359;\nconst float P2_12 = 4096.0;\nconst float P2_8 = 256.0;\nconst float P2_7 = 128.0;\nconst float P2_6 = 64.0;\nconst float P2_5 = 32.0;\nconst float P2_4 = 16.0;\nconst float P2_3 = 8.0;\nconst float P2_2 = 4.0;\nconst float P2_1 = 2.0;\nuniform float BYTES_TO_COORD;\nuniform float BYTES_TO_SCALED_SIZE;\nuniform float BYTES_TO_MIN_VISIBLE_SIZE;\nuniform float BYTES_TO_SYMBOLIC_SIZE;\nuniform float BYTES_TO_CURVATURE;\nuniform float BYTES_TO_DASH_LENGTH;\nuniform float BYTES_TO_GAP_LENGTH;\nuniform float BYTES_TO_PATTERN_SCALE;\nuniform float PATTERN_POSITION_GRANULARITY;\nuniform float PATTERN_INFO_TEXTURE_SIZE;\nuniform float PATTERN_NEAREST_TEXTURE_SIZE;\nuniform float PATTERN_LINEAR_TEXTURE_SIZE;\nuniform float PATTERN_LINEAR_SDF_TEXTURE_SIZE;\nuniform float PATTERN_MIPMAP_TEXTURE_SIZE;\nconst float BYTES_TO_OFFSET_ANGLE = 0.0;\nconst float BYTES_TO_COLOR = 0.0;\nconst float SDF_FONT_SIZE = 0.0;\nconst float CURVATURE_RATIO = 0.0;\nconst float PATTERN_MARGIN = 0.0;\nconst float TEXT_WIDTH_MULTIPLIER = 0.0;\nconst float TEXT_HEIGHT_MULTIPLIER = 0.0;\nconst float SELF_LOOP_CURVATURE_MULTIPLIER = 0.0;\nconst float EDGE_ARROW_SIZE_RATIO = 0.0;\nconst float NB_PIECES_PER_CURVE = 0.0;\nconst float PIECE_NODE_COMPONENT = 0.0;\nconst float PIECE_EDGE_BODY = 0.0;\nconst float PIECE_EDGE_HEAD = 0.0;\nconst float PIECE_EDGE_TAIL = 0.0;\nconst float PIECE_EDGE_TEXT = 0.0;\nconst float MAX_TEXT_SIZE = 0.0;\nconst float BYTES_TO_TEXT_OFFSET = 0.0;\nconst float FILTER_NEAREST = 0.0;\nconst float FILTER_LINEAR = 0.0;\nconst float FILTER_LINEAR_SDF = 0.0;\nconst float FILTER_MIPMAP = 0.0;\nconst float SHAPE_TEXTURE_SIZE = 0.0;\nconst float SIMPLE_SHAPE_SAMPLING_SIZE = 0.0;\nconst float COMPLEX_SHAPE_SAMPLING_SIZE = 0.0;\nconst float SHAPE_SAMPLING_BUFFER_RATIO = 0.0;\nconst float MAX_NB_SHAPES = 0.0;\nconst float FIRST_COMPLEX_SHAPE_ID = 0.0;\nconst float SELF_LOOP_TO_CIRCLE_APPROX = 0.0;\nconst float NB_SHAPES_BY_SIDE = SHAPE_TEXTURE_SIZE / COMPLEX_SHAPE_SAMPLING_SIZE;\nconst float SHAPE_FILL_PERCENT = 1.0 - SHAPE_SAMPLING_BUFFER_RATIO;\nconst float T_STEP_PER_CURVE_PIECE = 1.0 / NB_PIECES_PER_CURVE;\nconst float HEAD_TAIL_PX_ADJUST = 1.5;\nstruct ne {\nfloat nf;\nfloat ng;\nfloat nh;\nfloat ni;\nfloat nj;\nfloat nk;\nfloat nl;\nfloat nm;\n};\nstruct nn {\nfloat no;\nfloat np;\nfloat nq;\nfloat nr;\nfloat ns;\nfloat nt;\nfloat nu;\n};\nstruct nv {\nfloat nf;\nfloat ng;\nfloat nh;\nfloat ni;\nfloat nj;\nfloat nk;\nfloat nl;\nfloat nm;\nfloat no;\nfloat np;\nfloat nq;\nfloat nr;\nfloat ns;\nfloat nt;\nfloat nu;\nfloat bu;\nfloat nw;\nfloat nx;\nfloat ny;\nfloat nz;\nfloat oa;\nfloat ob;\nvec4 az;\nvec4 ba;\nvec4 bl;\nfloat oc;\nfloat od;\nfloat oe;\nfloat of;\nfloat og;\nfloat oh;\nfloat oi;\nfloat oj;\nfloat ok;\nfloat ol;\nfloat om;\nfloat on;\nfloat oo;\nfloat op;\nfloat oq;\nfloat or;\nfloat os;\n};\nstruct ot {\nfloat ou;\nvec2 ov;\nvec4 az;\nvec4 ba;\nfloat bu;\nfloat ow;\nfloat ox;\nfloat nh;\nfloat oy;\nvec2 oz;\nfloat pa;\nvec2 bb;\nvec2 pb;\nvec2 pc;\nfloat pd;\nfloat pe;\nvec4 bl;\nvec2 pf;\nfloat pg;\nfloat ph;\nvec2 pi;\nvec2 pj;\nvec2 pk;\n};\nfloat pl(float lh, float pm, float pn) {\nfloat po = mod(lh, pow(2.0, pn));\nreturn floor(po / pow(2.0, pm));\n}\nne pp(float lh) {\nne pq;\npq.nf = pl(lh, 0.0, 4.0);\npq.ng = pl(lh, 4.0, 8.0);\npq.nh = pl(lh, 8.0, 10.0);\npq.ni = pl(lh, 10.0, 12.0);\npq.nj = pl(lh, 12.0, 13.0);\npq.nk = pl(lh, 13.0, 14.0);\npq.nl = pl(lh, 14.0, 15.0);\npq.nm = pl(lh, 15.0, 16.0);\nreturn pq;\n}\nnn pr(float lh) {\nnn pq;\npq.no = pl(lh, 0.0, 8.0);\npq.np = pl(lh, 8.0, 11.0);\npq.nq = pl(lh, 11.0, 12.0);\npq.nr = pl(lh, 12.0, 13.0);\npq.ns = pl(lh, 13.0, 14.0);\npq.nt = pl(lh, 14.0, 15.0);\npq.nu = pl(lh, 15.0, 16.0);\nreturn pq;\n}\nvec4 ps(in float lh) {\nreturn vec4(\npl(lh, 0.0, 4.0),\npl(lh, 4.0, 8.0),\npl(lh, 8.0, 12.0),\npl(lh, 12.0, 16.0)\n);\n}\nvec2 pt(in float lh) {\nreturn vec2(mod(lh, 256.0), floor(lh / 256.0));\n}\nvec2 pu(in float lh) {\nfloat pv = floor(lh / P2_6);\nfloat pw = lh - (pv * P2_6);\nreturn vec2(pv, pw);\n}\nvec2 px(in float lh) {\nfloat py = floor(lh / P2_7);\nfloat pz = lh - (py * P2_7);\nreturn vec2(py, pz);\n}\nvec2 qa(in vec2 qb, in float qc) {\nfloat qd = cos(qc);\nfloat qe = sin(qc);\nreturn vec2(qd * qb.x + qe * qb.y, -qe * qb.x + qd * qb.y);\n}\nvec4 qf(in vec4 qg) {\nreturn floor(qg / 256.0) - 128.0;\n}\nvec4 qh(in vec4 qg) {\nreturn mod(qg, 256.0) - 128.0;\n}\nfloat qi(float lh) {\nreturn lh - 128.0;\n}\nvec2 qi(vec2 lh) {\nreturn lh - 128.0;\n}\nvec2 qj(vec2 qk) {\nreturn vec2(-qk.y, qk.x);\n}\nvec2 ql(vec2 qm, vec2 fn, vec2 qn, float t) {\nfloat qo = 1.0 - t;\nreturn (qo * qo * qm) + (2.0 * qo * t * fn) + (t * t * qn);\n}\nvec2 qp(vec2 qm, vec2 qq, vec2 qr, vec2 qn, float t) {\nfloat qo = 1.0 - t;\nfloat qs = qo * qo;\nfloat qt = qs * qo;\nfloat qu = t * t;\nfloat qv = qu * t;\nreturn (qt * qm) + (3.0 * qs * t * qq) + (3.0 * qo * qu * qr) + (qv * qn);\n}\nvec2 qw(vec2 qm, vec2 fn, vec2 qn, float t) {\nfloat qo = (1.0 - t);\nvec2 qb = (qo * fn + t * qn) - (qo * qm + t * fn);\nreturn normalize(qb);\n}\nvec2 qx(vec2 qm, vec2 fn, vec2 qn, float t) {\nreturn qj(qw(qm, fn, qn, t));\n}\nvec2 qy(vec2 qm, vec2 qq, vec2 qr, vec2 qn, float t) {\nfloat qo = 1.0 - t;\nfloat qs = qo * qo;\nfloat qu = t * t;\nvec2 qb = qs * (qq - qm) + 2.0 * qo * t * (qr - qq) + qu * (qn - qr);\nreturn normalize(qb);\n}\nvec2 qz(vec2 qm, vec2 qq, vec2 qr, vec2 qn, float t) {\nreturn qj(qy(qm, qq, qr, qn, t));\n}\nfloat rk(float oa, float rl, float t) {\nfloat y = abs(oa) / CURVATURE_RATIO + EPSILON;\nfloat of = y * y;\nfloat qo = t - 0.5;\nfloat qs = qo * qo;\nfloat rm = 1.0 / (16.0 * of);\nfloat rn = sqrt(qs + rm);\nfloat ro = (0.5 / y) * sqrt(of + 0.25);\nfloat rp = (abs(2.0 * y)) * ((qo * rn) + (0.5 * ro) + (rm * log(abs((qo + rn) / (-0.5 + ro)))));\nreturn rp * rl;\n}\nfloat rq(vec2 qm, vec2 rr, vec2 rs, vec2 qn, float rt) {\nvec2 pf = (qm + rr + rs) / 3.0;\nvec2 ru = pf - rr;\nvec2 rv = rr - rs;\nfloat rw = dot(ru, ru);\nfloat rx = dot(rv, rv) / 4.0;\nfloat sf = sqrt(rw - rx) * SELF_LOOP_TO_CIRCLE_APPROX * 1.55;\nreturn 2.0 * PI * sf * rt;\n}\nfloat sg(float lh) {\nreturn lh - 32.0;\n}\nfloat sh(float lh) {\nreturn lh - 512.0;\n}\nfloat si(float lh) {\nreturn lh - 32768.0;\n}\nvoid sj() {\ngl_Position = vec4(-10.0, -10.0, 1.0, 1.0);\n}\nvec4 sk(vec2 sl) {\nreturn vec4(((vec2(sl.x, u_viewHeight - sl.y) / vec2(u_viewWidth, u_viewHeight)) * 2.0 - 1.0), 0.5, 1.0);\n}\nfloat sp(float ap, float aq) {\nreturn step(ap - EPSILON, aq) * step(aq, ap + EPSILON);\n}\nbool ao(float ap, float aq) {\nreturn abs(ap - aq) < EPSILON;\n}\nbool sq(float lh) {\nreturn lh > 0.5;\n}\nvec2 sr(vec2 ss) {\nreturn qa((ss - vec2(u_viewX, u_viewY)) * u_viewZoom, u_viewAngle) + vec2(u_viewWidth, u_viewHeight) / 2.0;\n}\nfloat st(float ph) {\nreturn ph * EDGE_ARROW_SIZE_RATIO;\n}\nfloat su(float sv, float sw) {\nreturn sv * BYTES_TO_SCALED_SIZE * u_viewZoom + sw;\n}\nfloat tc(float ow, float ta, float tb) {\nfloat td = tb - ta;\nfloat a = 1.0 / td;\nfloat b = -ta / td;\nreturn ow * a + b;\n}\nstruct te {\nvec2 tf;\nvec2 tg;\n};\nte th(vec2 ti, float sf, float oa) {\nte lj;\nfloat tj = (sf + sf / SELF_LOOP_CURVATURE_MULTIPLIER * oa) * SELF_LOOP_CURVATURE_MULTIPLIER;\nfloat tk = -u_viewAngle + PI;\nfloat tl = -u_viewAngle + PI / 2.0;\nlj.tf = ti + vec2(cos(tk), sin(tk)) * tj;\nlj.tg = ti + vec2(cos(tl), sin(tl)) * tj;\nreturn lj;\n}\nfloat tq(vec2 tr, vec2 rr, vec2 rs, vec2 ts, float tt) {\nvec2 tu = tr;\nfloat t = 0.0;\nfloat tv = 0.0;\nfloat tw = rq(tr, rr, rs, ts, 1.0);\nreturn tt / tw;\n}\nnv tx(\nvec4 ty,\nvec4 tz,\nvec4 ua,\nvec4 ub,\nvec4 uc,\nvec2 ud,\nvec2 ue\n) {\nnv a;\nne av = pp(ty.x);\nnn uf = pr(ty.y);\nvec4 ug = ps(ty.z);\nvec2 uh = pt(ty.w);\nvec2 ui = pu(ue.y);\na.nf = av.nf;\na.ng = av.ng;\na.nh = av.nh;\na.ni = av.ni;\na.nj = av.nj;\na.nk = av.nk;\na.nl = av.nl;\na.nm = av.nm;\na.no = uf.no;\na.np = uf.np;\na.nq = uf.nq;\na.nr = uf.nr;\na.ns = uf.ns;\na.nt = uf.nt;\na.nu = uf.nu;\na.bu = ug.x;\na.nw = ug.y;\na.nx = ug.z;\na.ny = ug.w;\na.nz = uh.x;\na.oa = uh.y;\na.ob = tz.x;\na.az = ps(tz.y);\na.ba = ps(tz.z);\na.bl = ps(tz.w);\na.oc = ua.x;\na.od = ua.y;\na.oe = ua.z;\na.of = ua.w;\na.og = ub.x;\na.oh = ub.y;\na.oi = ub.z;\na.oj = ub.w;\na.ok = uc.x;\na.ol = uc.y;\na.om = uc.z;\na.on = uc.w;\na.oo = ud.x;\na.op = ud.y;\na.oq = ue.x;\na.or = sh(ui.x);\na.os = sg(ui.y);\nreturn a;\n}\nbool uu(const in nv a, out ot lj) {\nfloat nf = a.nf;\nfloat ng = a.ng;\nfloat nh = a.nh * BYTES_TO_DASH_LENGTH;\nfloat ni = a.ni * BYTES_TO_GAP_LENGTH;\nfloat nj = a.nj;\nfloat nk = a.nk;\nfloat nl = a.nl;\nfloat nm = a.nm;\nfloat no = a.no * BYTES_TO_PATTERN_SCALE;\nfloat np = a.np * BYTES_TO_OFFSET_ANGLE;\nfloat nq = a.nq;\nfloat nr = a.nr;\nfloat ns = a.ns;\nfloat nt = a.nt;\nfloat nu = a.nu;\nfloat bu = a.bu * BYTES_TO_COLOR;\nfloat nw = a.nw * BYTES_TO_MIN_VISIBLE_SIZE - EPSILON;\nfloat nx = a.nx * BYTES_TO_MIN_VISIBLE_SIZE - EPSILON;\nfloat ny = a.ny * BYTES_TO_MIN_VISIBLE_SIZE - EPSILON;\nfloat nz = a.nz * BYTES_TO_SYMBOLIC_SIZE * u_viewZoom + step(a.nz, EPSILON) * INFINITY;\nfloat oa = qi(a.oa);\nfloat ob = a.ob;\nvec4 az = a.az * BYTES_TO_COLOR;\nvec4 ba = a.ba * BYTES_TO_COLOR;\nvec4 bl = a.bl * BYTES_TO_COLOR;\nvec2 uv = vec2(a.oc, a.od) * BYTES_TO_COORD;\nvec2 uw = vec2(a.oe, a.of) * BYTES_TO_COORD;\nvec2 tr = sr(uv);\nvec2 ts = sr(uw);\nfloat ux = su(a.og, a.oh);\nfloat uy = su(a.oi, a.oj);\nfloat uz = su(a.ok, a.ol);\nfloat ou = su(a.om, a.on);\nfloat va = su(a.oo, a.op);\nvec2 vb = a_vertexInfo.xy;\nvec2 vc = vec2(0.0, 0.0);\nfloat vd = ux;\nfloat ve = uy;\nfloat vf = uy * no;\nif (nq > EPSILON) {\nif (a.oq < EPSILON) {\nreturn false;\n}\nvf = uz;\nob = a.oq;\nux = vf * TEXT_WIDTH_MULTIPLIER * u_pixelRatio;\nuy = vf * TEXT_HEIGHT_MULTIPLIER * u_pixelRatio;\n}\nbool vz = abs(oa) > EPSILON && sp(ng, PIECE_EDGE_BODY) < EPSILON;\nbool wa = vz && a_vertexInfo.z > EPSILON;\nif (nf < EPSILON || ng < EPSILON || nz < nw || wa) {\nreturn false;\n}\nou *= step(nx, nz);\nfloat wo = 0.0;\nfloat wp = 1.0;\nfloat wl = 0.0;\nfloat wn = 1.0;\nfloat wq = 0.0;\nfloat xa = 1.0;\nfloat xc = 1.0;\nfloat xn = 0.0;\nfloat xo = 0.0;\nvec2 pf;\nvec2 pi;\nvec2 pj;\nvec2 pk;\nfloat ph;\nfloat pg;\nfloat yh = 0.0;\nfloat yi = 1.0;\nif (sp(ng, PIECE_NODE_COMPONENT) > EPSILON) {\npf = ceil((tr + ts) / 2.0);\npi = normalize(vec2(uw.x - uv.x + 0.001, uv.y - uw.y));\npj = qj(pi);\npk = pj;\nph = ux;\npg = uy;\n} else {\nxc = 0.0;\nfloat yy = distance(tr, ts);\nvec2 yz = normalize(ts - tr);\nvec2 za = (tr + ts) / 2.0;\nvec2 zb = qj(yz);\nvec2 zc = za + (zb * yy * -oa / CURVATURE_RATIO);\nif (sp(ng, PIECE_EDGE_TEXT) > 0.0) {\nfloat zd;\nfloat ze = ou;\nou = 0.0;\nif (nm > EPSILON) {\nte fn = th(tr, ze / 2.0, oa);\npf = qp(tr, fn.tf, fn.tg, ts, 0.5);\npi = qy(tr, fn.tf, fn.tg, ts, 0.5);\npj = qj(pi);\npk = pj;\nzd = rq(tr, fn.tf, fn.tg, ts, 0.5);\n} else if (abs(oa) > EPSILON) {\npf = ql(tr, zc, ts, 0.5);\npi = qw(tr, zc, ts, 0.5);\npj = qj(pi);\npk = pj;\nzd = rk(oa, yy, 1.0);\n} else {\npf = za;\npi = yz;\npj = zb;\npk = zb;\nzd = yy;\n}\nph = ux;\npg = uy;\nif (nr > EPSILON && nm < EPSILON && vd > zd - ze) {\npi = vec2(1.0, 0.0);\npj = vec2(0.0, 1.0);\npk = vec2(0.0, 1.0);\n} else {\nfloat qc = -atan(pi.y, pi.x);\nyh = qc;\nnp -= qc;\nif ((qc > PI / 2.0 || qc < -PI / 2.0)) {\nnp += (1.0 - nm) * PI;\nyi = -1.0;\npi *= -1.0;\npj *= -1.0;\npk *= -1.0;\n}\n}\n} else {\nfloat xg = uz;\nfloat zm = ux;\nfloat zn = uy;\nfloat zo = nj + nk;\nfloat zp = st(xg);\nfloat zq = nj * zp;\nfloat zr = nk * zp;\nfloat zs = sp(ng, PIECE_EDGE_HEAD);\nfloat zt = sp(ng, PIECE_EDGE_TAIL);\nfloat zu = INFINITY * nm + yy - zm - zn;\nfloat zv = min(zu / zo, zp);\nfloat aae =\nnk * (zp + max(zm + zv - zr, 0.0))\n+ (1.0 - nk) * nl * zm;\nfloat aaf =\nnj * (zp + max(zn + zv - zq, 0.0))\n+ (1.0 - nj) * nl * zn;\nif (zs > EPSILON || zt > EPSILON) {\nvec2 aai = zs * ts + zt * tr;\nfloat va = zs * aaf + zt * aae + (HEAD_TAIL_PX_ADJUST - 0.5);\nfloat aaj = zs * zq + zt * zr;\nvec2 aak;\nif (nm > EPSILON) {\nte fn = th(tr, zm, oa);\nfloat zd = rq(tr, fn.tf, fn.tg, ts, 1.0);\nfloat tt = zs * (zd - aaf) + zt * aae;\nfloat t = tq(tr, fn.tf, fn.tg, ts, tt);\naak = qp(tr, fn.tf, fn.tg, ts, t);\n} else {\nfloat zd = rk(oa, yy, 1.0);\nfloat t = (zs * (zd - aaf) + zt * aae) / zd;\naak = ql(tr, zc, ts, t);\n}\npi = normalize(aai - aak);\npj = qj(pi);\npk = pj;\npf = aai - pi * (va - aaj / 2.0);\nph = aaj;\npg = aaj;\nnh = 0.0;\nni = 0.0;\n} else {\nfloat aao;\nfloat aap;\nfloat aaq;\nif (abs(oa) < EPSILON) {\npf = za;\npi = yz;\npj = zb;\npk = pj;\nph = yy;\naao = yy;\naap = 0.0;\naaq = yy;\n} else {\nfloat aas = a_vertexInfo.z;\nfloat aat = aas * T_STEP_PER_CURVE_PIECE;\nfloat qu = aat + T_STEP_PER_CURVE_PIECE;\nif (nm < EPSILON) {\nvec2 aau = ql(tr, zc, ts, aat);\nvec2 aav = ql(tr, zc, ts, qu);\npf = (aau + aav) / 2.0;\npi = normalize(aav - aau);\npj = qx(tr, zc, ts, aat);\npk = qx(tr, zc, ts, qu);\nph = distance(aau, aav);\naao = rk(oa, yy, 1.0);\naap = rk(oa, yy, aat);\naaq = rk(oa, yy, qu);\n} else {\nte fn = th(tr, zm, oa);\nvec2 rr = fn.tf;\nvec2 rs = fn.tg;\nvec2 aau = qp(tr, rr, rs, ts, aat);\nvec2 aav = qp(tr, rr, rs, ts, qu);\npf = (aau + aav) / 2.0;\npi = normalize(aav - aau);\npj = qz(tr, rr, rs, ts, aat);\npk = qz(tr, rr, rs, ts, qu);\nph = distance(aau, aav);\naao = rq(tr, rr, rs, ts, 1.0);\naap = rq(tr, rr, rs, ts, aat);\naaq = rq(tr, rr, rs, ts, qu);\n}\n}\npg = uz;\nwl = (aae - 1.0) / aao;\nwn = 1.0 - (aaf - HEAD_TAIL_PX_ADJUST) / aao;\nwo = aap / aao;\nwp = aaq / aao;\nwq = aao;\nif (nl > 0.0 && zu > 5.0) {\nfloat abb = (aao * pg) / (aao - aae);\nfloat tw = aao;\nfloat oc = aae;\nfloat oe = aao - aaf;\nfloat a = -abb / tw;\nfloat b = abb;\nfloat od = a * oc + b;\nfloat of = a * oe + b;\nfloat abc = od / (oc - oe);\nfloat abd = -abc * oe;\npg = abd;\nxo = abc * tw + abd + 1.0;\n}\n}\n}\n}\nvec2 bb = vec2(0.0, 0.0);\nvec2 pb = vec2(EPSILON, EPSILON);\nvec2 pc = vec2(-EPSILON, -EPSILON);\nfloat pd = -1.0;\nfloat pe = 0.0;\nbool abe = false;\nif (ob > EPSILON && nz > ny) {\nfloat abf = floor(ob / PATTERN_INFO_TEXTURE_SIZE);\nfloat abg = ob - (abf * PATTERN_INFO_TEXTURE_SIZE);\nvec4 abh = texture2D(u_patternInfoTexture, vec2(abg, abf) / 255.0) * 255.0;\nvec2 abi = px(abh.z);\nvec2 abj = px(abh.w);\npd = abi.x * 2.0 + abj.x;\nfloat abk = 0.0;\nif (ao(pd, FILTER_NEAREST)) {\nabk = PATTERN_NEAREST_TEXTURE_SIZE;\n} else if (ao(pd, FILTER_LINEAR)) {\nabk = PATTERN_LINEAR_TEXTURE_SIZE;\n} else if (ao(pd, FILTER_LINEAR_SDF)) {\nabk = PATTERN_LINEAR_SDF_TEXTURE_SIZE;\nabe = true;\n} else if (ao(pd, FILTER_MIPMAP)) {\nabk = PATTERN_MIPMAP_TEXTURE_SIZE;\n}\nfloat abl = 1.0 / abk;\nvec2 abm = (vec2(abi.y, abj.y) * PATTERN_POSITION_GRANULARITY) * abl / 2.0;\nvec2 abn = (abh.xy * PATTERN_POSITION_GRANULARITY * abl) + abm;\nabn += PATTERN_MARGIN * abl;\nabm -= PATTERN_MARGIN * abl * 2.0;\nvec2 abo = vec2(ph / 2.0, pg / 2.0) * abl;\nvec2 abp = vec2(ou, ou) * abl;\nfloat abq = 1.0 * u_pixelRatio;\nif (no > EPSILON) {\nif (abe) {\npe = 2.0 / vf;\nabq = SDF_FONT_SIZE / vf;\n} else {\nabq = (abm.y / abo.y) / no;\n}\n}\nvec2 abr = (abo + abp) * abq;\nabm += PATTERN_MARGIN * abl;\nbb = abn + abr * vb;\npb = abn - abm;\npc = abn + abm;\n}\nif (nq > EPSILON) {\nvc.y = a.os * vf / 2.0 - 1.0;\nxa = 0.0;\nxc = 0.0;\nif (abe) {\nvc.x = ceil(a.or * BYTES_TO_TEXT_OFFSET * vf);\n} else {\nvc.x = floor(a.or);\n}\nvc += vec2(1.0, 1.0);\nvc = qa(vc, yh);\nvc *= yi;\n}\nvec2 abu = vec2(cos(np), sin(np)) * va;\nvec2 abv = pf + abu + vc;\nif (nq > EPSILON && sp(ng, PIECE_NODE_COMPONENT) > EPSILON) {\nabv = ceil(abv);\n}\nfloat abw = ou * 2.0;\nfloat abx = ph + xc * (abw + 1.0);\nfloat aby = pg + xa * (abw + 1.0);\nvec2 abz = pi * abx / 2.0;\nvec2 aca = pj * aby / 2.0;\nvec2 acb = pk * aby / 2.0;\nfloat acc = (wp - wo);\nfloat acd = vb.x / 2.0 + 0.5;\nfloat ow = wo + acc * acd;\nfloat pa = xn + (xo - xn) * ow / 2.0;\nfloat ace = step(nf, FIRST_COMPLEX_SHAPE_ID - EPSILON);\nfloat acf = ace * SIMPLE_SHAPE_SAMPLING_SIZE + (1.0 - ace) * COMPLEX_SHAPE_SAMPLING_SIZE;\nfloat acg = acf / COMPLEX_SHAPE_SAMPLING_SIZE;\nfloat ach = acg * SHAPE_SAMPLING_BUFFER_RATIO / 2.0;\nfloat aci = acg * (1.0 - SHAPE_SAMPLING_BUFFER_RATIO);\nvec2 acr = vec2(mod(nf, NB_SHAPES_BY_SIDE), floor(nf / NB_SHAPES_BY_SIDE));\nvec2 acs = acr + vec2(ach) + vec2(wo * aci, 0.0);\nvec2 acv = vec2(acc, 1.0) * aci;\nvec2 ov = (acs + acv * (vb / 2.0 + 0.5)) / NB_SHAPES_BY_SIDE;\nvec2 oz = vec2(abx / acc, aby) / 2.0;\nfloat adc = nh * uz;\nfloat add = ni * uz;\nfloat ox = adc + add;\nfloat oy = (ow * wq) / ox;\nlj.ov = ov;\nlj.oz = oz;\nlj.ou = ou;\nlj.az = az;\nlj.ba = ba;\nlj.bu = bu;\nlj.ow = tc(ow, wl, wn);\nlj.ox = ox;\nlj.nh = adc;\nlj.oy = oy;\nlj.pa = pa;\nlj.bb = bb;\nlj.pb = pb;\nlj.pc = pc;\nlj.pd = pd;\nlj.pe = pe;\nlj.bl = bl;\nlj.pf = abv;\nlj.ph = abx;\nlj.pg = aby;\nlj.pi = pi;\nlj.pj = pj;\nlj.pk = pk;\nreturn true;\n}\nfloat ade(float adf, float adg, vec4 adh) {\nfloat adi = clamp(((u_currentTime - adf) / adg), 0.0, 1.0);\nfloat r = adi;\nfloat adj = r * r;\nfloat adk = adj * r;\nvec4 adl = adi < 0.5 ? qf(adh) : qh(adh);\nfloat adm = adl.x;\nfloat adn = adl.y;\nfloat ado = adl.z;\nfloat adp = adl.w;\nfloat adq = adm + adn * r + ado * adj + adp * adk;\nreturn adq;\n}\nvoid main() {\nnv a_final = tx(\na_final_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature,\na_final_patternId_fillRGBA_strokeRGBA_patternRGBA,\na_final_x1_y1_x2_y2,\na_final_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed,\na_final_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed,\na_final_offsetScaled_offsetFixed,\na_text_charId_charOffsetXY\n);\n#if ANIMATED\nfloat adf = a_animationBeginTime_animationDuration.x;\nfloat adg = a_animationBeginTime_animationDuration.y;\nvec4 adh = a_animationEasing;\nfloat ut = ade(adf, adg, adh);\nnv a_prev = tx(\na_prev_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature,\na_prev_patternId_fillRGBA_strokeRGBA_patternRGBA,\na_prev_x1_y1_x2_y2,\na_prev_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed,\na_prev_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed,\na_prev_offsetScaled_offsetFixed,\na_text_charId_charOffsetXY\n);\nconst float ONE = 1.0;\na_final.nf = mix(a_prev.nf, a_final.nf, ONE);\na_final.nh = mix(a_prev.nh, a_final.nh, ut);\na_final.ni = mix(a_prev.ni, a_final.ni, ut);\na_final.nj = mix(a_prev.nj, a_final.nj, ONE);\na_final.nk = mix(a_prev.nk, a_final.nk, ONE);\na_final.ng = mix(a_prev.ng, a_final.ng, ONE);\na_final.no = mix(a_prev.no, a_final.no, ONE);\na_final.nq = mix(a_prev.nq, a_final.nq, ONE);\na_final.nr = mix(a_prev.nr, a_final.nr, ONE);\na_final.ns = mix(a_prev.ns, a_final.ns, ONE);\na_final.nt = mix(a_prev.nt, a_final.nt, ONE);\na_final.nm = mix(a_prev.nm, a_final.nm, ONE);\na_final.np = mix(a_prev.np, a_final.np, ut);\na_final.bu = mix(a_prev.bu, a_final.bu, ut);\na_final.nw = mix(a_prev.nw, a_final.nw, ut);\na_final.nx = mix(a_prev.nx, a_final.nx, ut);\na_final.ny = mix(a_prev.ny, a_final.ny, ut);\na_final.nz = mix(a_prev.nz, a_final.nz, ut);\na_final.oa = mix(a_prev.oa, a_final.oa, ut);\na_final.ob = mix(a_prev.ob, a_final.ob, ONE);\na_final.az = mix(a_prev.az, a_final.az, ut);\na_final.ba = mix(a_prev.ba, a_final.ba, ut);\na_final.bl = mix(a_prev.bl, a_final.bl, ut);\na_final.oc = mix(a_prev.oc, a_final.oc, ut);\na_final.od = mix(a_prev.od, a_final.od, ut);\na_final.oe = mix(a_prev.oe, a_final.oe, ut);\na_final.of = mix(a_prev.of, a_final.of, ut);\na_final.og = mix(a_prev.og, a_final.og, ut);\na_final.oh = mix(a_prev.oh, a_final.oh, ut);\na_final.oi = mix(a_prev.oi, a_final.oi, ut);\na_final.oj = mix(a_prev.oj, a_final.oj, ut);\na_final.ok = mix(a_prev.ok, a_final.ok, ut);\na_final.ol = mix(a_prev.ol, a_final.ol, ut);\na_final.om = mix(a_prev.om, a_final.om, ut);\na_final.on = mix(a_prev.on, a_final.on, ut);\na_final.oo = mix(a_prev.oo, a_final.oo, ut);\na_final.op = mix(a_prev.op, a_final.op, ut);\na_final.oq = mix(a_prev.oq, a_final.oq, ONE);\na_final.or = mix(a_prev.or, a_final.or, ONE);\na_final.os = mix(a_prev.os, a_final.os, ONE);\n#endif\not lj;\nbool adr = uu(a_final, lj);\nif (!adr) {\nsj();\nreturn;\n}\nvec2 vb = a_vertexInfo.xy;\na = lj.az;\nb = lj.ba;\nc = lj.bl;\nd = lj.ov;\ne = lj.bb;\n#if D3D9_FIX\nf = vec4(lj.pb, lj.pc);\ng = vec3(lj.ou, lj.bu, lj.pa);\nh = vec4(lj.ow, lj.ox, lj.nh, lj.oy);\ni = vec4(lj.oz, lj.pe, lj.pd);\n#else\nj = lj.ou;\nk = lj.pb;\nl = lj.pc;\nm = vec2(lj.bu, lj.pa);\nn = lj.ow;\no = lj.ox;\np = vec2(lj.nh, lj.oy);\nq = lj.oz;\nr = lj.pe;\ns = lj.pd;\n#endif\nfloat ads = step(vb.x, 0.0);\nfloat adt = 1.0 - ads;\nvec2 sl = lj.pf\n+ (lj.pi * (lj.ph / 2.0) * vb.x)\n+ ((ads * lj.pj + adt * lj.pk) * (lj.pg / 2.0) * vb.y);\ngl_Position = sk(sl);\n}\n",Md="#define D3D9_FIX 0\nprecision highp float;\nprecision mediump int;\nuniform vec3 u_backgroundColor;\nuniform sampler2D u_patternNearestTexture;\nuniform sampler2D u_patternLinearTexture;\nuniform sampler2D u_patternLinearSdfTexture;\nuniform sampler2D u_patternMipmapTexture;\nuniform sampler2D u_shapeTexture;\nvarying vec4 a;\nvarying vec4 b;\nvarying vec4 c;\nvarying vec2 d;\nvarying vec2 e;\n#if D3D9_FIX\nvarying vec4 f;\nvarying vec3 g;\nvarying vec4 h;\nvarying vec4 i;\n#else\nvarying float j;\nvarying vec2 k;\nvarying vec2 l;\nvarying vec2 m;\nvarying float n;\nvarying float o;\nvarying vec2 p;\nvarying vec2 q;\nvarying float r;\nvarying float s;\n#endif\nconst float FILTER_NEAREST = 0.0;\nconst float FILTER_LINEAR = 0.0;\nconst float FILTER_LINEAR_SDF = 0.0;\nconst float FILTER_MIPMAP = 0.0;\nconst float EPSILON = 0.000000001;\nconst float SDF_BUFFER = (256.0 - 64.0) / 256.0; \nvec4 ad(in vec4 ae, in vec4 af) {\nfloat ag = af.a;\nfloat ah = ae.a + EPSILON;\nfloat ai = min(ag + ah, 1.0);\nfloat r = ag / ai;\nreturn vec4(mix(ae.rgb, af.rgb, r), ai);\n}\nfloat aj(in float ak, in float al) {\nfloat am = (ak * 256.0 + al) * 256.0;\nfloat an = am / 32768.0;\nreturn an * 2.0 - 1.0;\n}\nbool ao(float ap, float aq) {\nreturn abs(ap - aq) < EPSILON;\n}\nvoid main() {\n#if D3D9_FIX\nfloat j = g.x;\nfloat ar = g.y;\nfloat as = g.z;\nvec2 k = f.xy;\nvec2 l = f.zw;\nfloat n = h.x;\nfloat o = h.y;\nfloat at = h.z;\nfloat au = h.w;\nvec2 q = i.xy;\nfloat r = i.z;\nfloat s = i.w;\n#else\nfloat ar = m.x;\nfloat as = m.y;\nfloat at = p.x;\nfloat au = p.y;\n#endif\nvec4 av = texture2D(u_shapeTexture, d);\nfloat aw = aj(av.b, av.a) * q.x;\nfloat ax = aj(av.r, av.g) * q.y;\nax += as;\nfloat ay = min(aw, ax);\nvec4 az = a;\nvec4 ba = b;\nif (s > -EPSILON) {\nvec2 bb = e;\nfloat bj =\nstep(k.x, bb.x) *\nstep(bb.x, l.x) *\nstep(k.y, bb.y) *\nstep(bb.y, l.y);\nfloat bk = bj;\nvec4 bl;\nif (ao(s, FILTER_NEAREST)) {\nbl = texture2D(u_patternNearestTexture, bb);\n} else if (ao(s, FILTER_LINEAR)) {\nbl = texture2D(u_patternLinearTexture, bb);\n} else if (ao(s, FILTER_LINEAR_SDF)) {\nbl = texture2D(u_patternLinearSdfTexture, bb);\nbl.a = smoothstep(SDF_BUFFER - r, SDF_BUFFER + r, bl.a);\n} else if (ao(s, FILTER_MIPMAP)) {\nbl = texture2D(u_patternMipmapTexture, bb);\n}\nbl.rgb += c.rgb;\nbl.a *= bk;\naz = ad(az, bl);\n}\nfloat bm = clamp(ay, 0.0, 1.0);\nfloat bn = clamp(ay - j, 0.0, 1.0);\nfloat bo = bm - bn;\nbo = 1.0 - clamp(ay - j, 0.0, 1.0);\naz.a *= bn;\nba.a *= bo;\nvec4 bp = ad(az, ba);\nfloat bq = bm;\nbp.rgb = mix(u_backgroundColor, bp.rgb, ar);\nif (o > EPSILON) {\nfloat ch = fract(au) * o;\nfloat ci = clamp(min(ch, at - ch), 0.0, 1.0);\nbq *= ci;\n}\nif (n < 0.0 || n > 1.0 || bq < EPSILON) {\ndiscard;\n}\nbp.a *= bq;\nbp.rgb *= bp.a;\ngl_FragColor = bp;\n}\n";(Ss=ha=ha||{})[Ss.INIT=0]="INIT",Ss[Ss.COMPILING=1]="COMPILING",Ss[Ss.DONE=2]="DONE";var lp=(Ga.prototype.setConstant=function(e,t){this._constants[e]=t},Ga.prototype.setMacro=function(e,t){this._macros[e]=t},Ga.prototype.getState=function(){return this._state},Ga.prototype.getProgram=function(){return this._program},Ga.prototype.compile=function(){var e=this._gl,t=dp(this._vertexSource,this._macros,this._constants),n=dp(this._fragmentSource,this._macros,this._constants);this._program&&(e.deleteProgram(this._program),e.deleteShader(this._vertexShader),e.deleteShader(this._fragmentShader)),this._program=e.createProgram(),this._vertexShader=e.createShader(e.VERTEX_SHADER),this._fragmentShader=e.createShader(e.FRAGMENT_SHADER),e.shaderSource(this._vertexShader,t),e.compileShader(this._vertexShader),e.attachShader(this._program,this._vertexShader),e.shaderSource(this._fragmentShader,n),e.compileShader(this._fragmentShader),e.attachShader(this._program,this._fragmentShader),e.linkProgram(this._program),this._state=ha.COMPILING},Ga.prototype.getError=function(){var e=this._gl;return e.getShaderParameter(this._vertexShader,e.COMPILE_STATUS)?e.getShaderParameter(this._fragmentShader,e.COMPILE_STATUS)?e.getProgramParameter(this._program,e.LINK_STATUS)?(this._state=ha.DONE,null):{step:"link",message:e.getProgramInfoLog(this._program)}:{step:"fragment",message:e.getShaderInfoLog(this._fragmentShader)}:{step:"vertex",message:e.getShaderInfoLog(this._vertexShader)}},Ga);function Ga(e,t){var n=t.vertex,i=t.fragment,r=t.constants,o=t.macros;this._program=null,this._vertexShader=null,this._fragmentShader=null,this._state=ha.INIT,this._gl=e,this._vertexSource=n,this._fragmentSource=i,this._constants=rn(r||{}),this._macros=rn(o||{})}function dp(e,t,n){for(var i=Object.keys(t),r=Object.keys(n),o=0;o<i.length;++o){var a=i[o];e=e.replace("#define "+a+" 0","#define "+a+" "+t[a])}for(o=0;o<r.length;++o){var l=r[o],u=n[l];e=e.replace("const float "+l+" = 0.0;","const float "+l+" = "+u+(u%1==0?".0":"")+";")}return e}var su,Id,Zy=((su={})[0]={min:"NEAREST",mag:"NEAREST",mipmap:!1},su[1]={min:"LINEAR",mag:"LINEAR",mipmap:!1},su[2]={min:"LINEAR",mag:"LINEAR",mipmap:!1},su[3]={min:"LINEAR_MIPMAP_LINEAR",mag:"LINEAR",mipmap:!0},su),Gy=((Id={})[0]="ALPHA",Id[1]="RGBA",Id);function As(e){return 16*Math.ceil((e+2)/16)}function qy(e,t,n,i,r){for(var o=0,a=e.length;o<a;++o){var s=e[o],l=s.x,u=s.y,d=l+i,c=u+r,h=d<n&&c<n;if(h)for(var p=l;p<d;++p)if(1===t[p+u*n]){h=!1;break}if(h)for(p=u;p<c;++p)if(1===t[l+p*n]){h=!1;break}if(h){for(p=l;p<d;++p)for(var g=u;g<c;++g)t[p+g*n]=1;return e.splice(o,1),e.push({x:l,y:c},{x:d,y:u}),s}}return null}function cp(e,t,n,i,r,o,a){var s=4*e,l=t>>1<<7,u=t%2<<7;a[s]=n/16,a[1+s]=i/16,a[2+s]=l+r/16,a[3+s]=u+o/16}function Hy(e,t,n,i,r,o,a){i|=0,r|=0,o|=0,a|=0,t|=0;for(var s=0;s<o;++s)for(var l=0;l<a;++l){var u=4*(i+s+(r+l)*t),d=4*(s+l*o);e[u]=n[d],e[1+u]=n[1+d],e[2+u]=n[2+d],e[3+u]=n[3+d]}}function Wy(e,t){for(var n=0,i=4,r=0;r<e.length;++r){var o=e[r],s=o.height,l=As(o.width),u=As(s);n+=l*u,i=Math.max(i,Math.max(l,u))}var d=Oi(Math.max(i,Math.sqrt(n)));return Math.min(d,t)}function hp(e,t){return Math.floor((t-e)/2)}function pp(e,t,n,i,r,o,a){var s=Zy[o],l=s.min,u=s.mag,d=s.mipmap,c=e[Gy[a]];if(0===a){for(var h=new Uint8Array(r*r),p=0;p<h.length;++p)h[p]=i[4*p+3];i=h}e.activeTexture(e.TEXTURE0+n),e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,c,r,r,0,c,e.UNSIGNED_BYTE,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e[u]),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e[l]),d&&e.generateMipmap(e.TEXTURE_2D)}function fp(e,t,n,i,r){for(var o=new Uint8Array(n*n*4),a=Math.ceil(n/16),s=new Uint8Array(a*a),l=[{x:0,y:0}],u=0;u<t.length;++u){var d=t[u],c=d.id,h=As(d.width)/16,p=As(d.height)/16,g=qy(l,s,a,h,p);if(g){var m=d.width,b=d.height,v=d.pixels,y=16*h,S=16*p,A=16*g.x+hp(m,y),C=16*g.y+hp(b,S);Hy(o,n,v,A,C,m,b),cp(c,e,A,C,y,S,r)}else{if(n<i)return fp(e,t,2*n,i,r);eo("exceeded max WebGL texture size of "+i+"; some texts/icons/images won't be displayed"),cp(c,e,0,0,0,0,r)}}return{texture:o,size:n}}function Yy(e,t,n,i){for(var r=e.getDistanceFromStrokeVertically,o=e.getDistanceFromStrokeHorizontally,a=t*(1-n)/2,s=(t-1)/2,l=0;l<t;++l)for(var u=0;u<t;++u){var d=4*(u*t+l),c=(l-s)/a,h=(u-s)/a,p=_e(r(c,h),-1,1),g=_e(o(c,h),-1,1);Xy(i,d,gp(p),gp(g))}}function gp(e){return(e+1)/2*32768}function Xy(e,t,n,i){e[t]=n>>8,e[t+1]=n%256,e[t+2]=i>>8,e[t+3]=i%256}function _p(e,t){for(var n=-Math.PI/2,i=2*Math.PI/e.length,r=0,o=e;r<o.length;r++){var a=n+i;t(o[r],n,a),n=a}}function mp(e,t,n,i,r){_p(t,function(o,a,s){e.beginPath(),e.moveTo(n,i),e.arc(n,i,r,a,s),e.fillStyle=o,e.fill()})}var Jy=(qa.prototype.refresh=function(e){for(var t=0,n=e.getShapeList();t<n.length;t++){var i=n[t];if(!this._shapesWritten.includes(i.id)){var r=i.isSimple?32:128,o=i.isSimple?this._simpleShapePixels:this._complexShapePixels;Yy(i,r,1/16,o),this._loadShapeInGpu(i.id,r,o),this._shapesWritten.push(i.id)}}},qa.prototype._loadShapeInGpu=function(e,t,n){var i=this._gl,r=Sd,o=e%Ed*128,a=128*Math.floor(e/Ed);if(this._texture)i.bindTexture(i.TEXTURE_2D,this._texture);else{var s=new Uint8Array(r*r*4);this._texture=i.createTexture(),i.activeTexture(i.TEXTURE0+this._glTextureUnit),i.bindTexture(i.TEXTURE_2D,this._texture),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,r,r,0,i.RGBA,i.UNSIGNED_BYTE,s)}i.texSubImage2D(i.TEXTURE_2D,0,o,a,t,t,i.RGBA,i.UNSIGNED_BYTE,n)},qa.prototype.getTextureSize=function(){return Sd},qa.prototype.getSamplingSize=function(){return 128},qa.prototype.getBufferRatio=function(){return 1/16},qa.prototype.getTextureUnit=function(){return this._glTextureUnit},qa);function qa(e,t){this._gl=e,this._glTextureUnit=t,this._simpleShapePixels=new Uint8Array(4096),this._complexShapePixels=new Uint8Array(65536),this._texture=null,this._shapesWritten=[]}var uu=1e20,Qy=(Od.prototype.getFontToImageSizeRatio=function(){return 1+2*this._buffer/this._fontSize},Od.prototype.draw=function(e,t,n){ca(this._ctx,t,this._fontSize,n);var r=this._ctx.measureText(e).width+2*this._buffer,o=16*Math.ceil((r+2)/16)-2,a=this._height,s=o*a,l=Math.max(o,a);this._canvas.width<o&&(this._canvas.width=o,ca(this._ctx,t,this._fontSize,n),this._ctx.textAlign="center",this._ctx.textBaseline="middle",this._ctx.fillStyle="black"),s>this._gridSize&&(this._gridOuter=new Float64Array(s),this._gridInner=new Float64Array(s),this._gridSize=s),l>this._maxDimension&&(this._f=new Float64Array(l),this._d=new Float64Array(l),this._z=new Float64Array(l+1),this._v=new Int16Array(l),this._maxDimension=l),this._ctx.clearRect(0,0,o,a),this._ctx.fillText(e,o/2,a/2);for(var u=this._ctx.getImageData(0,0,o,a),d=new Uint8ClampedArray(s),c=0;c<s;c++){var h=u.data[4*c+3]/255;this._gridOuter[c]=1==h?0:0==h?uu:Math.pow(Math.max(0,.5-h),2),this._gridInner[c]=1==h?uu:0==h?0:Math.pow(Math.max(0,h-.5),2)}for(vp(this._gridOuter,o,a,this._f,this._d,this._v,this._z),vp(this._gridInner,o,a,this._f,this._d,this._v,this._z),c=0;c<s;c++)d[c]=Math.max(0,Math.min(255,Math.round(255-255*((this._gridOuter[c]-this._gridInner[c])/this._radius+this._cutoff))));return{height:a,width:o,distance:d}},Od);function Od(e){var t=void 0===e?{}:e,n=t.fontSize,i=void 0===n?24:n,r=t.buffer,o=void 0===r?6:r,a=t.radius,s=void 0===a?8:a,l=t.cutoff,u=void 0===l?.25:l;this._maxDimension=1,this._gridSize=1,this._gridOuter=null,this._gridInner=null,this._f=null,this._d=null,this._z=null,this._v=null,this._fontSize=i,this._buffer=o,this._radius=s,this._cutoff=u,this._height=Math.ceil(this._fontSize+2*this._buffer*1.5),this._canvas=di(),this._canvas.height=this._height,this._canvas.width=1,this._ctx=this._canvas.getContext("2d"),this._ctx.textBaseline="middle",this._ctx.textAlign="center",this._ctx.fillStyle="black"}function vp(e,t,n,i,r,o,a){for(var s=0;s<t;s++){for(var l=0;l<n;l++)i[l]=e[l*t+s];for(yp(i,r,o,a,n),l=0;l<n;l++)e[l*t+s]=r[l]}for(l=0;l<n;l++){for(s=0;s<t;s++)i[s]=e[l*t+s];for(yp(i,r,o,a,t),s=0;s<t;s++)e[l*t+s]=Math.sqrt(r[s])}}function yp(e,t,n,i,r){i[n[0]=0]=-uu,i[1]=+uu;for(var o=1,a=0;o<r;o++){for(var s=(e[o]+o*o-(e[n[a]]+n[a]*n[a]))/(2*o-2*n[a]);s<=i[a];)a--,s=(e[o]+o*o-(e[n[a]]+n[a]*n[a]))/(2*o-2*n[a]);n[++a]=o,i[a]=s,i[a+1]=+uu}for(o=0,a=0;o<r;o++){for(;i[a+1]<o;)a++;t[o]=(o-n[a])*(o-n[a])+e[n[a]]}}var e0=(Bn.prototype.refresh=function(e){this._pixelRatio=e.getPixelRatio();for(var t=this._gl,n=this._getPatternsByFilter(e.getPatternList()),i=0;i<n.length;++i){var r=i,o=n[i],a=fp(r,o,Wy(o,this._maxTextureSize),this._maxTextureSize,this._patternIdToInfoTexture),s=a.texture,l=a.size,u=this._glTextures[r]||(this._glTextures[r]=t.createTexture());pp(t,u,this._glUnit+1+r,s,l,r,0===r?0:1),this._textureSizes[r]=l}var c=this._glTextureInfo||(this._glTextureInfo=t.createTexture());pp(t,c,this._glUnit,this._patternIdToInfoTexture,256,0,1)},Bn.prototype.bindMetDataTexture=function(){var e=this._gl;e.activeTexture(e.TEXTURE0+this._glUnit),e.bindTexture(e.TEXTURE_2D,this._glTextureInfo)},Bn.prototype.getGranularity=function(){return 16},Bn.prototype.getInfoTextureUnit=function(){return this._glUnit},Bn.prototype.getNearestTextureUnit=function(){return this._glUnit+1+0},Bn.prototype.getLinearTextureUnit=function(){return this._glUnit+1+1},Bn.prototype.getLinearSdfTextureUnit=function(){return this._glUnit+1+2},Bn.prototype.getMipmapTextureUnit=function(){return this._glUnit+1+3},Bn.prototype.getInfoTextureSize=function(){return 256},Bn.prototype.getNearestTextureSize=function(){return this._textureSizes[0]},Bn.prototype.getLinearTextureSize=function(){return this._textureSizes[1]},Bn.prototype.getLinearSdfTextureSize=function(){return this._textureSizes[2]},Bn.prototype.getMipmapTextureSize=function(){return this._textureSizes[3]},Bn.prototype._getPatternsByFilter=function(e){for(var t=new Array(4),n=0;n<4;++n)t[n]=[];for(n=0;n<e.length;++n){var i=this._getPatternPixels(e[n]);t[i.filter].push(i)}return t},Bn.prototype._getPatternPixels=function(e){var t=e.id,n=e.type,i=e.attributes,r=null;switch(n){case 2:r=i.duplicated?this._getDuplicatedImagePixels(i.image):i.scaled?this._getScaledImagePixels(i.image):this._getNonScaledImagePixels(i.image);break;case 3:var o=i.text,a=i.font,s=i.style,l=i.size,u=i.offset;r="sdf"===i.size?this._getSdfTextPixels(o,a,s):this._getRegularTextPixels(o,a,s,l,u);break;case 5:r=this._getIconPixels(i.text,i.font,i.style);break;case 6:r=this._getBadgeIconPixels(i.text,i.font,i.style);break;case 4:r=this._getPieChartPixels(i.colorArray);break;default:throw new Error('pattern type "'+n+'" does not exist')}return r.id=t,r},Bn.prototype._getScaledImagePixels=function(e){var t=e.width,n=e.height;if(wr<t||wr<n){var i=wr/Math.max(e.width,e.height);t*=i,n*=i}return t&&n&&(t=As(t),n=As(n)),this._getImagePixels(e,t-=2,n-=2)},Bn.prototype._getNonScaledImagePixels=function(e){return this._getImagePixels(e,e.width,e.height)},Bn.prototype._getDuplicatedImagePixels=function(e){if(0===e.width||0===e.height)return this._getImagePixels(e,0,0);this._canvasForDuplicatedImage||(this._canvasForDuplicatedImage=di(),this._canvasForDuplicatedImage.width=wr,this._canvasForDuplicatedImage.height=wr);for(var t=this._canvasForDuplicatedImage,n=t.getContext("2d"),i=e.width,r=e.height,o=(wr-i)/2,a=(wr-r)/2;0<o;)o-=i;for(;0<a;)a-=r;for(var s=o;s<wr;s+=i)for(var l=a;l<wr;l+=r)n.drawImage(e,s,l);return this._getImagePixels(t,wr,wr)},Bn.prototype._getImagePixels=function(e,t,n){var i;if(0===t||0===n)i=new Uint8Array(0);else{(this._imageCanvas.width<t||this._imageCanvas.height<n)&&(this._imageCanvas.width=t,this._imageCanvas.height=n);var r=this._imageCanvasContext;Za(this._imageCanvas,r,t,n);try{r.drawImage(e,0,0,t,n)}catch(o){}i=r.getImageData(0,0,t,n).data}return{width:t,height:n,pixels:i,filter:3}},Bn.prototype._getPieChartPixels=function(e){var t=126,n=this._imageCanvasContext;return Za(this._imageCanvas,n,t,t),n.save(),n.rect(0,0,t,t),n.clip(),mp(n,e,63,63,t),n.restore(),{width:t,height:t,pixels:n.getImageData(0,0,t,t).data,filter:1}},Bn.prototype._getTextPixels=function(e,t,n,i,r,o){var a=this._imageCanvasContext,s=r*this._pixelRatio;ca(a,n,s,i);var l=a.measureText(t).width;0===l&&(l=s);var u=0,d=0;3===e||(u=2*Math.ceil(1.5*s/2),d=2*Math.ceil(1.2*l/2));var c=Math.ceil(l+d),h=Math.ceil(s+u),p=this._imageCanvas.height<h||this._imageCanvas.width<c;return this._imageCanvas.height<h&&(this._imageCanvas.height=h),this._imageCanvas.width<c&&(this._imageCanvas.width=c),p&&ca(a,n,s,i),a.clearRect(0,0,c,h),a.fillStyle="black",a.textBaseline="middle",a.textAlign="left",a.fillText(t,o+d/2,h/2),{width:c,height:h,pixels:a.getImageData(0,0,c,h).data,filter:e}},Bn.prototype._getRegularTextPixels=function(e,t,n,i,r){return this._getTextPixels(0,e,t,n,i,r)},Bn.prototype._getIconPixels=function(e,t,n){return this._getTextPixels(3,e,t,n,126,0)},Bn.prototype._getBadgeIconPixels=function(e,t,n){return this._getSdfTextPixels(e,t,n)},Bn.prototype._getSdfTextPixels=function(e,t,n){for(var i=this._sdfGenerator.draw(e,t,n),r=i.width,o=i.height,a=i.distance,s=new Uint8Array(r*o*4),l=0;l<a.length;++l)s[4*l+3]=a[l];return{width:r,height:o,pixels:s,filter:2}},Bn);function Bn(e,t){this._patternIdToInfoTexture=new Uint8Array(262144),this._glTextureInfo=null,this._glTextures=[],this._textureSizes=[],this._pixelRatio=1,this._gl=e,this._glUnit=t,this._imageCanvas=di(),this._imageCanvas.width=wr,this._imageCanvas.height=wr,this._imageCanvasContext=this._imageCanvas.getContext("2d"),this._canvasForDuplicatedImage=null,this._sdfGenerator=new Qy({fontSize:24}),this._maxTextureSize=Math.min(4096,e.getParameter(e.MAX_TEXTURE_SIZE))}function xp(){var e=zi(),t=e.styleSheets;if(!t||!e.location)return Promise.resolve([]);for(var n=_(e),i=[],r=[],o=0;o<t.length;o++){var a=t[o];null===a.href?i.push({href:n,content:a.ownerNode.textContent}):r.push(a.href)}var s=/@font-face\s*\{[^}]+\}/g;return Promise.all(r.map(function(l){return _i(l).then(function(u){return{href:l,content:u}}).catch(function(){return null})})).then(function(l){return l.concat(i)}).then(function(l){for(var u=[],d=0;d<l.length;d++){var c=l[d];if(null!==c){var h=c.href,p=c.content.match(s);if(p){var g=n0(p,h);u.push.apply(u,g)}}}return u})}function bp(e,t){return Promise.all(e.map(function(n){var r=n.originalRule;return Promise.all(n.formats.map(function(o){var a=o.format,s=o.url;return t?Do(s).then(function(l){return{format:a,src:l}}).catch(function(){return null}):{format:a,src:s}})).then(function(o){for(var a=[],s=0;s<o.length;s++){var l=o[s];null!==l&&a.push("url('"+l.src+"') format('"+l.format+"')")}if(0===a.length)return r;var u="src: "+a.join(",")+";";return r.replace(/src\s*:[^;]+;/g,u)})}))}var t0={"embedded-opentype":!0,svg:!0};function n0(e,t){for(var n=/url\(['"]?([^'")]+)['"]?\)\s+format\(['"]?([^'")]+)['"]?\)/g,i=/font-family\s*:\s*['"]?([^;'"]+)['"]?;/,r=[],o=0;o<e.length;o++){for(var a=e[o],s=a.match(i)[1],l=[],u=void 0;u=n.exec(a);){var d=u[1],c=u[2];t0[c.toLowerCase()]||l.push({format:c,url:Ep(d,t)})}r.push({name:s,formats:l,originalRule:a})}return r}function Ep(e,t){if(/^http(s)?:/.test(e))return e;if("/"===e[0]){var n=t.match(/((\w+:\/\/)([^/]+))/);return n?n[1]+e:e}var i=e.split("/"),r=t.split("/");for("/"!==t[t.length-1]&&r.pop();".."===i[0];)i.shift(),r.pop();return r.concat(i).join("/").replace(/[\w](\/{2,})/g,function(o){return o[0]+"/"})}function il(e){if(e.keys)return Array.from(e.keys());var t=[];return e.forEach(function(n,i){return t.push(i)}),t}function ws(e){if(e.values)return Array.from(e.values());var t=[];return e.forEach(function(n){return t.push(n)}),t}var Sp=(zo.prototype.reserve=function(e){if(this._capacity<e){e=Math.pow(2,Math.ceil(Math.log2(e+1)));var t=new Uint32Array(e);t.set(this._array),this._capacity=e,this._array=t}},zo.prototype.has=function(e){var t=lu(this._array,e,0,this.length);return t<this.length&&this._array[t]===e},zo.prototype.add=function(e){var t=lu(this._array,e,0,this.length),n=t<this.length&&this._array[t]===e;return n||(this.length===this._capacity&&this.reserve(this.length+1),this._array.copyWithin(t+1,t,this.length),this._array[t]=e,this.length+=1),!n},zo.prototype.remove=function(e){var t=lu(this._array,e,0,this.length),n=t<this.length&&this._array[t]===e;return n&&(this._array.copyWithin(t,t+1,this.length),--this.length),n},zo.prototype.removeByPosition=function(e){return!(e>=this.length||(this._array.copyWithin(e,e+1,this.length),--this.length,0))},zo.prototype.get=function(e){return this._array[e]},zo.prototype.clear=function(){this.length=0},zo.prototype.slice=function(){return this._array.slice(0,this.length)},zo);function zo(){this._array=new Uint32Array(8),this._capacity=8,this.length=0,this._array=new Uint32Array(8),this._capacity=8,this.length=0}function lu(e,t,n,i){if(n===i)return n;var r=n+((i-n)/2|0),o=t-e[r];return 0==o?r:o<0?lu(e,t,n,r):lu(e,t,r+1,i)}var i0="undefined"==typeof HTMLElement?function(e){return!1}:function(e){return e instanceof HTMLElement};function rl(e,t,n){if(void 0===t&&(t=[]),void 0===n&&(n=[]),!i0(e)){if(function(e){return"object"!=typeof e||null===e||ui(e)||(t=e)instanceof RegExp||t instanceof Date;var t}(e))t.push({path:n.slice(),value:e});else for(var i=Object.keys(e),r=0;r<i.length;++r){var o=i[r],a=n.slice();a.push(o),rl(e[o],t,a)}return t}}var Ap=(Object.defineProperty(Ha.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Ha.prototype.set=function(e,t){var n=this._getIndex(e);-1!==n?this._values[n]=t:(Nd(this._cachedPath,e)&&(this._cachedIndex=this._keys.length),this._keys.push(e),this._values.push(t),this._size+=1)},Ha.prototype.get=function(e){var t=this._getIndex(e);if(-1!==t)return this._values[t]},Ha.prototype.has=function(e){return-1!==this._getIndex(e)},Ha.prototype.keys=function(){return this._keys.slice()},Ha.prototype._getIndex=function(e){if(Nd(e,this._cachedPath))return this._cachedIndex;this._cachedPath=e.slice();for(var t=this._keys,n=0;n<t.length;++n)if(Nd(t[n],e))return this._cachedIndex=n;return this._cachedIndex=-1},Ha);function Ha(){this._keys=[],this._values=[],this._size=0,this._cachedPath=[],this._cachedIndex=-1}function Nd(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}var o0=Set.prototype.keys?function(e){return Array.from(e.keys())}:function(e){var t=[];return e.forEach(function(n){return t.push(n)}),t},du=Set.prototype.values?function(e){return Array.from(e.values())}:function(e){var t=[];return e.forEach(function(n,i){return t.push(i)}),t},wp=xi("webworker-threads"),Ld=wp?wp.Worker:null;function Cp(e){return Ld?function t(n){if(ArrayBuffer.isView(n))return Array.from(n);if(Array.isArray(n)){for(var i=0;i<n.length;++i)n[i]=t(n[i]);return n}if(Jt(n)){for(var o=0,a=Object.keys(n);o<a.length;o++){var s=a[o];n[s]=t(n[s])}return n}return n}(e):e}function Tp(e){return Ld?new Ld(new Function(e)):"undefined"==typeof URL||-1!==navigator.appVersion.indexOf("MSIE 10")?new Mp(e):function(t){try{var n=new Blob([t],{type:"application/javascript"}),i=URL.createObjectURL(n);return new Worker(i)}catch(r){return new Mp(t)}}(e)}var Mp=(ol.prototype.terminate=function(){this._terminated=!1,this._otherSide._terminated=!0},ol.prototype.addEventListener=function(e,t){this._listeners.push(t)},ol.prototype.postMessage=function(e){setTimeout(kp,0,this._otherSide,{data:e})},ol);function ol(e){this._main=!0,this._listeners=[],this._terminated=!1,this._f=new Function("self",e),this._otherSide=new a0(this),this._f(this._otherSide)}var Ip,a0=(Fd.prototype.addEventListener=function(e,t){this._listeners.push(t)},Fd.prototype.postMessage=function(e){setTimeout(kp,0,this._otherSide,{data:e})},Fd);function Fd(e){this._listeners=[],this._main=!1,this._terminated=!1,this._otherSide=e}function kp(e,t){if(!e._terminated)for(var n=0;n<e._listeners.length;++n)e._listeners[n](t)}var Op=xi("xmldom");Ip="undefined"!=typeof XMLSerializer?XMLSerializer:Op?Op.XMLSerializer:null;var s0=(mo.prototype.setAttribute=function(e,t){this._attributes[e]=t},mo.prototype.appendChild=function(e){this._children.push(e)},Object.defineProperty(mo.prototype,"tagName",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(mo.prototype,"children",{get:function(){return this._children},enumerable:!0,configurable:!0}),Object.defineProperty(mo.prototype,"childNodes",{get:function(){return this._children},enumerable:!0,configurable:!0}),Object.defineProperty(mo.prototype,"firstChild",{get:function(){return this._children[0]||null},enumerable:!0,configurable:!0}),mo.prototype.serialize=function(){var e=this._name,t=this._attributes,n=this._children,i=Object.keys(t).filter(function(o){return void 0!==t[o]}).map(function(o){return" "+o+'="'+t[o]+'"'}).join(""),r=n.map(function(o){return o.serialize()}).join("");return r.length?"<"+e+i+">"+r+"</"+e+">":"<"+e+i+"/>"},mo.prototype.cloneNode=function(e){for(var t=new mo(this._name),n=0,i=Object.keys(this._attributes);n<i.length;n++){var r=i[n];t.setAttribute(r,this._attributes[r])}if(e)for(var o=0;o<this._children.length;o++)t.appendChild(this._children[o].cloneNode(e));return t},mo);function mo(e){this._attributes={},this._children=[],this._name=e}var u0=(al.prototype.serialize=function(){return this._text},al.prototype.cloneNode=function(){return new al(this._text)},al);function al(e){this._text=e}var l0=(cu.prototype.appendChild=function(e){this._children.push(e)},cu.prototype.serialize=function(){return this._meta.concat(this._children.map(function(e){return e.serialize()})).join("")},cu.prototype.createElement=function(e){return new s0(e)},cu.prototype.createTextNode=function(e){return new u0(e)},cu);function cu(){this._children=[],this._meta=[],this._children=[],this._meta=[]}function Np(){return new l0}function Pd(e){return(new Ip).serializeToString(e)}function Lp(){return zi().implementation.createDocument("","",null)}var Fp=(to.prototype.add=function(e){var t=this._keyToIndex[e];-1===t&&(t=this._size++,this._heap[t]=e),this._keyToIndex[e]=this._bubble(t)},to.prototype.removeMin=function(){if(0===this._size)return NaN;var e=this._heap[0];return this._heap[0]=this._heap[--this._size],this._bubble(0),e},to.prototype.isEmpty=function(){return 0===this._size},to.prototype.has=function(e){return-1!==this._keyToIndex[e]},to.prototype._bubble=function(e){var t=this._indexToValue(e),n=this._getParentIndex(e),i=this._indexToValue(n),r=e;if(0!==e&&t<i)r=this._swap(e,n);else{var o=this._getLeftChildIndex(e),a=this._getRightChildIndex(e),s=this._indexToValue(o),l=this._indexToValue(a),u=Math.min(t,s,l);u===t||(r=this._swap(e,u===s?o:a))}return r===e?e:this._bubble(r)},to.prototype._indexToValue=function(e){return e>=this._size?1/0:this._keyToValue[this._heap[e]]},to.prototype._getParentIndex=function(e){return(e-1)/2|0},to.prototype._getLeftChildIndex=function(e){return 2*e+1},to.prototype._getRightChildIndex=function(e){return 2*e+2},to.prototype._swap=function(e,t){var n=this._heap[e],i=this._heap[t];return this._heap[e]=i,this._heap[t]=n,this._keyToIndex[n]=t,this._keyToIndex[i]=e,t},to);function to(e){this._heap=[],this._size=0,this._keyToValue=e,this._keyToIndex=new Int32Array(e.length),this._keyToIndex.fill(-1)}var hu=(Bo.prototype._get=function(e){return e.isNode?this._nodes:this._edges},Bo.prototype.addOrRemoveElements=function(e,t){return t?this.addElements(e):this.removeElements(e)},Bo.prototype.addElements=function(e){for(var t=this._get(e),n=t.elementList,i=t.flexArray,r=t.indexList,o=r.getLength(),a=0;a<e._indexes.length;a++){var s=e._indexes[a];1!==i.get(s)&&(i.set(s,1),r.pushUnchecked(s))}return n(r.slice(o))},Bo.prototype.removeElements=function(e){for(var t=this._get(e),n=t.elementList,i=t.flexArray,r=t.indexList,o=r.getLength(),a=r.getBuffer(),s=0,l=0;l<e._indexes.length;l++){var u=e._indexes[l];0!==i.get(u)&&(i.set(u,0),s+=1)}if(s===o)return n(r.sliceAndReset());if(0===s)return n();var d=this._graph.acquireIndexList(e.isNode),c=0;for(l=0;l<o;++l)0===i.get(u=a[l])?(c+=1,d.pushUnchecked(u)):a[l-c]=u;return r.setLength(o-s),n(d.sliceAndReset())},Bo.prototype.hasElement=function(e){return!!this._get(e).flexArray.get(e._index)},Bo.prototype.clear=function(){this._nodes.indexList.isEmpty()||(this._nodes.indexList.reset(),this._nodes.flexArray.reset()),this._edges.indexList.isEmpty()||(this._edges.indexList.reset(),this._edges.flexArray.reset())},Bo.prototype.isEmpty=function(){return this._nodes.indexList.isEmpty()&&this._edges.indexList.isEmpty()},Bo.prototype.getElements=function(){return{nodes:this._nodes.elementList(this._nodes.indexList.slice()),edges:this._edges.elementList(this._edges.indexList.slice())}},Bo);function Bo(e,t){this._graph=e,this._nodes={elementList:e.nodeList,flexArray:e.createNodeAttribute({storage:1,name:t}),indexList:e.createIndexList(!0)},this._edges={elementList:e.edgeList,flexArray:e.createEdgeAttribute({storage:1,name:t}),indexList:e.createIndexList(!1)}}var Cr=(gr.prototype.reset=function(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.minScaledSize=1/0,this.maxScaledSize=-1/0,this.minFixedSize=1/0,this.maxFixedSize=-1/0,this.width=0,this.height=0,this.cx=0,this.cy=0,this},gr.prototype.addPoint=function(e,t,n,i){return this.minX=Math.min(this.minX,e),this.minY=Math.min(this.minY,t),this.maxX=Math.max(this.maxX,e),this.maxY=Math.max(this.maxY,t),void 0!==n&&void 0!==i&&("scaled"===i?(this.minScaledSize=Math.min(this.minScaledSize,n),this.maxScaledSize=Math.max(this.maxScaledSize,n)):(this.minFixedSize=Math.min(this.minFixedSize,n),this.maxFixedSize=Math.max(this.maxFixedSize,n))),this.cx=this.minX+(this.maxX-this.minX)/2,this.cy=this.minY+(this.maxY-this.minY)/2,this.width=this.maxX-this.minX,this.height=this.maxY-this.minY,this},gr.prototype.computeForZoom=function(e){var t=Math.max(this.maxScaledSize,this.maxFixedSize/e);return gr.from({minX:this.minX-t/2,minY:this.minY-t/2,maxX:this.maxX+t/2,maxY:this.maxY+t/2,width:this.width+t,height:this.height+t})},gr.from=function(e){var t=void 0===e?{}:e,n=t.minX,i=t.minY,r=t.maxX,o=t.maxY,a=t.width,s=t.height,l=new gr;return l.minX=n,l.minY=i,l.maxX=r,l.maxY=o,l.width=a||(r-n)/2,l.height=s||(o-i)/2,l.cx=(n+r)/2,l.cy=(i+o)/2,l},gr.fromValues=function(e,t,n){for(var i=1/0,r=1/0,o=-1/0,a=-1/0,s=-1/0,l=0;l<e.length;l++){var u=e[l],d=t[l],c=n[l];u-c<i&&(i=u-c),d-c<r&&(r=d-c),o<u+c&&(o=u+c),a<d+c&&(a=d+c),s<c&&(s=c)}var h=gr.from({minX:i,minY:r,maxX:o,maxY:a});return h.maxScaledSize=s,h},gr.prototype.pad=function(e){return this.minX-=e,this.minY-=e,this.maxX+=e,this.maxY+=e,this.width+=2*e,this.height+=2*e,this},gr.prototype.isValid=function(){return isFinite(this.width)&&isFinite(this.height)},gr.prototype.extend=function(e){return this.addPoint(e.minX,e.minY),this.addPoint(e.maxX,e.maxY),this},gr.prototype.bottomLeft=function(){return{x:this.minX,y:this.minY}},gr.prototype.topRight=function(){return{x:this.maxX,y:this.maxY}},gr);function gr(e){void 0===e&&(e={});var t=e.xValues,n=void 0===t?[]:t,i=e.yValues,r=void 0===i?[]:i,o=e.scaledSizeValues,a=void 0===o?[]:o,s=e.fixedSizeValues,l=void 0===s?[]:s;this.minX=gn(n),this.minY=gn(r),this.maxX=en(n),this.maxY=en(r),this.minScaledSize=gn(a),this.maxScaledSize=en(a),this.minFixedSize=gn(l),this.maxFixedSize=en(l),this.cx=this.minX+(this.maxX-this.minX)/2,this.cy=this.minY+(this.maxY-this.minY)/2,this.width=this.maxX-this.minX,this.height=this.maxY-this.minY}var Rd=(Wa.prototype.on=function(e,t){if("string"!=typeof e)throw new TypeError("Event name must be string");if("function"!=typeof t)throw new TypeError("Event handler must be function");var n=this._events=this._events||{};return(n[e]=n[e]||[]).push(t),this},Wa.prototype.off=function(e,t){if("string"!=typeof e)throw new TypeError("Event name must be string");var n=this._events=this._events||{},i=n[e];if(ui(i))if("function"!=typeof t)n[e]=null;else{var r=i.indexOf(t);-1!==r&&i.splice(r,1),0===i.length&&(n[e]=null)}return this},Wa.prototype.fire=function(e){for(var t=arguments,n=[],i=1;i<arguments.length;i++)n[i-1]=t[i];if("string"!=typeof e)throw new TypeError("Event name must be string");var r=(this._events=this._events||{})[e];if(ui(r))for(var o=n,a=0;a<r.length;a++){var s=r[a];s&&s.apply(this,o)}return this},Wa.prototype.once=function(e,t){var n=this,i=function(){for(var r=arguments,o=[],a=0;a<arguments.length;a++)o[a]=r[a];t.apply(n,o),n.off(e,i)};return i.handler=t,this.on(e,i)},Wa.prototype.hasListener=function(e,t){if(!e||!t)return!1;var n=(this._events=this._events||{})[e];if(ui(n))for(var i=0,r=n.length;i<r;i++){var o=n[i];if(o===t||o.handler===t)return!0}return!1},Wa.prototype.getListeners=function(e){return(this._events=this._events||{})[e]},Wa);function Wa(){}var d0=Object.freeze({__proto__:null,BoundingBox:Cr,FlexArray:Ln,EventTarget:Rd,ColorManager:ou,Table:fd,setKeys:o0,setValues:du,requestAnimFrame:Oo,cancelAnimFrame:li,DummyCanvas:ip,DummyCanvasRenderingContext2D:rp,createCanvas:di,clearCanvas:Za,setCtxFont:ca,isWebGLSupported:op,getWebglContext:Ad,getDocumentFontRules:xp,getEmbeddedFontRules:bp,resolvePath:Ep,IndexList:ms,mapKeys:il,mapValues:ws,isInteger:function(e){return"number"==typeof e&&e%1==0},toPropertyPath:Pr,throttle:Da,debounce:function(e,t,n){var i,r,o,a,s;function l(){var d=Date.now()-a;d<t&&0<=d?i=setTimeout(l,t-d):(i=null,n||(s=e.apply(o,r),o=r=null))}function u(){o=this,r=arguments,a=Date.now();var d=n&&!i;return i=i||setTimeout(l,t),d&&(s=e.apply(o,r),o=r=null),s}return 0!==t&&void 0!==t||(t=100),u.clear=function(){i&&(clearTimeout(i),i=null)},u.flush=function(){i&&(s=e.apply(o,r),o=r=null,clearTimeout(i),i=null)},u},processQueue:function(e,t){return new Promise(function(n,i){return function r(o,a,s,l,u){s(o[a],a,o,l,u).then(function(d){a===o.length-1?l(d):r(o,a+1,s,l,u)}).catch(u)}(e,0,t,n,i)})},isLittleEndian:fr,promiseQueue:Gi,hash8:Jr,isRawObject:Qr,getValues:Ra,forEach:ft,deepCopy:rn,updateObject:function e(t,n){ft(n,function(i,r){"object"==typeof r&&null!==r?("object"==typeof t[i]&&null!==t[i]||(t[i]={}),e(t[i],r)):t[i]=r})},extendList:function(e,t){t.forEach(function(n){-1===e.indexOf(n)&&e.push(n)})},setProperty:Ht,getProperty:xn,flatten:Zt,unflatten:bn,getFlattenedKeys:bi,getLeafValues:Xn,ensureTransferable:qi,getOptions:on,isObject:Jt,mergeValues:tr,pick:za,objToValueList:rl,PathMap:Ap,smartRequire:xi,getDocument:zi,getStyle:po,DummyDomElement:Bi,createDummyDomElement:$o,getPixelRatio:Nn,dataUrlToBlob:Gn,createBlob:ir,isBlob:function(e){return"undefined"!=typeof Blob&&e instanceof Blob||e instanceof qn},promptDownload:cn,resizeElement:Fo,setAttributes:Er,SVG_NS:ea,XML_NS:Qn,XLINK:He,createSvgElement:hn,createTextNode:ta,getImage:_s,fetch:_i,isHTMLElement:Po,applyCursorStyle:$r,fetchBinary:na,fetchBinaryAsBase64:Do,escapeDOMAttribute:Sr,BUTTON_MAPPING:Ti,baseURI:_,fadeElement:w,getCurrentTime:R,getDate:V,getTime:le,formatWorkerMessage:Cp,createWorker:Tp,insertSortAsc:Xr,insertSortDesc:pr,isArray:ui,toArray:f,flattenArray:Fr,concatenateArrays:function(){for(var e=arguments,t=[],n=0;n<arguments.length;n++)t[n]=e[n];if(0===t.length)return[];for(var i=t[0].constructor,r=0,o=0,a=t;o<a.length;o++)r+=(c=a[o]).length;for(var s=new i(r),l=0,u=0,d=t;u<d.length;u++){for(var c=d[u],h=0;h<c.length;h++)s[l+h]=c[h];l+=c.length}return s},removeFromArray:Pa,binaryIndexOf:ps,parseColorRgba:md,toHexa:Yu,componentsToRGBA:ep,parseColorHex:vd,createDummyXmlDocument:Np,serializeXMLDocument:Pd,createXmlDocument:Lp,PrioritySet:Fp,nextPowerOfTwo:Oi,computeSum:Sn,clamp:_e,mix:Nt,lerp:It,computeMax:en,computeMin:gn,getBaseLog:Ar,ElementSet:hu,displayPixelsOnScreen:function(e,t,n,i){void 0===i&&(i=0),void 0===t&&(t=n=Math.sqrt(e.length/4)),void 0===n&&(n=t);var r=document.createElement("canvas"),o=r.getContext("2d"),a=o.createImageData(t,n);r.style.imageRendering="pixelated",r.style.border="1px solid black",r.style.margin="2px",r.style.position="absolute",r.style.top=r.style.left="0px",r.width=t,r.height=n,a.data.set(e),o.putImageData(a,0,0);var s=document.getElementById("graph-container");s&&(s.style.position="static"),setTimeout(function(){return document.body.appendChild(r)},i)}}),c0={byte:1,ubyte:1,short:2,ushort:2,float:4},h0={byte:"BYTE",ubyte:"UNSIGNED_BYTE",short:"SHORT",ushort:"UNSIGNED_SHORT",float:"FLOAT"},Pp=(vo.prototype._finishInit=function(){var e=this,t=this._gl,n=this._ext,i=this._programWrapper.getError();if(i)throw new Error('WebGL compilation at step "'+i.step+":\n"+i.message+'"');var r=this._programWrapper.getProgram();this._program=r,t.useProgram(r),this._metaData.attributes.forEach(function(d){d.location=t.getAttribLocation(e._program,d.name),d.byteSize=d.size*c0[d.type],d.glType=h0[d.type]}),this._specialAttributes=this._createSpecialAttributesFunctions();for(var o=[],a=[],s=0,l=this._metaData.attributes;s<l.length;s++){var u=l[s];-1!==u.location&&(u.name.startsWith("a_text")?a.push(u):o.push(u))}this._baseAttributes=zd(o,t,n),this._textAttributes=zd(a,t,n),this._setupUniforms=function(d,c,h){for(var p={},g=[],m=0;m<d.length;++m){var b=d[m],v=b.id,S=b.type,A=c.getUniformLocation(h,b.name),C=p0[S](v);p[v]=A,g.push(C)}var O=new Function("gl","l","u",g.join("\n"));return function(N){return O(c,p,N)}}(this._metaData.uniforms,t,r)},vo.prototype._createSpecialAttributesFunctions=function(){return zd([{location:this._gl.getAttribLocation(this._program,this._metaData.vertexInfoAttribute),size:3,glType:"BYTE",byteSize:3,type:"byte",name:"special"}],this._gl,this._ext)},vo.prototype.startPass=function(e){this._program||this._finishInit(),this._gl.useProgram(this._program),this._resetStencil(),this._setupUniforms(e),this._specialAttributes.enable(),this._specialAttributes.setup(this._specialGlBuffers.vertexInfo,null,0)},vo.prototype._setupAttributes=function(e,t){var n=t.glBuffer,i=t.dataBuffer,r=t.divisor;e.enabled&&!n?e.disable():!e.enabled&&n&&e.enable(),n&&e.setup(n,i,r)},vo.prototype.setupBaseAttributes=function(e){this._setupAttributes(this._baseAttributes,e)},vo.prototype.setupTextAttributes=function(e){this._setupAttributes(this._textAttributes,e)},vo.prototype._resetStencil=function(){var e=this._gl;this._stencilUsage=1,e.disable(e.STENCIL_TEST)},vo.prototype.setupStencil=function(e){if(e!==this._stencilUsage){var t=this._gl;1!==e?(t.enable(t.STENCIL_TEST),2===e?(t.stencilOp(t.KEEP,t.KEEP,t.REPLACE),t.stencilFunc(t.ALWAYS,1,1)):3===e&&(t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.stencilFunc(t.EQUAL,0,1))):t.disable(t.STENCIL_TEST),this._stencilUsage=e}},vo.prototype.endPass=function(){this._specialAttributes.disable(),this._baseAttributes.disable(),this._textAttributes.disable()},vo);function vo(e){var t=e.gl,n=e.ext,i=e.specialGlBuffers,r=e.metaData,o=e.programWrapper;this._setupUniforms=null,this._specialAttributes=null,this._baseAttributes=null,this._textAttributes=null,this._stencilUsage=1,this._gl=t,this._ext=n,this._specialGlBuffers=i,this._metaData=rn(r),this._programWrapper=o}var p0={int:function(e){return"gl.uniform1i(l."+e+", u."+e+");"},sampler2D:function(e){return"gl.uniform1i(l."+e+", u."+e+");"},float:function(e){return"gl.uniform1f(l."+e+", u."+e+");"},vec2:function(e){return"gl.uniform2f(l."+e+", u."+e+"[0], u."+e+"[1]);"},vec3:function(e){return"gl.uniform3f(l."+e+", u."+e+"[0], u."+e+"[1], u."+e+"[2]);"},vec4:function(e){return"gl.uniform4f(l."+e+", u."+e+"[0], u."+e+"[1], u."+e+"[2], u."+e+"[3]);"}};function zd(e,t,n){var i,r,o,a,s,l,u,d,c,h,p,g,m,b=(i=t,r=e.map(function(y){return"gl.enableVertexAttribArray("+y.location+");"}).join("\n"),o=new Function("gl",r),function(){return o(i)}),v=(a=t,s=e.map(function(y){return"gl.disableVertexAttribArray("+y.location+");"}).join("\n"),l=new Function("gl",s),function(){return l(a)});return{enable:function(){b(),this.enabled=!0},disable:function(){v(),this.enabled=!1},setup:(d=t,c=n,h=(u=e).reduce(function(y,S){return y+S.byteSize},0),p=0,g=["gl.bindBuffer(gl.ARRAY_BUFFER, glBuffer);","if (dataBuffer) gl.bufferData(gl.ARRAY_BUFFER, dataBuffer, gl.STATIC_DRAW);"].concat(u.map(function(y){var N="gl.vertexAttribPointer(\n        "+y.location+", "+y.size+", gl."+y.glType+",\n        false, "+h+", "+p+"\n      );";return p+=y.byteSize,N}),u.map(function(y){return"ext.vertexAttribDivisorANGLE("+y.location+", divisor);"})).join("\n"),m=new Function("gl","ext","glBuffer","dataBuffer","divisor",g),function(y,S,A){return m(d,c,y,S,A)}),enabled:!1}}var f0=(pa.prototype.setDataBuffer=function(e){this._dataBuffer!==e&&(this._program=e.isAnimated()?this._animationProgram:this._staticProgram,this._dataBuffer=e,this._dataBufferChanged=!0,e.hasSideData()&&!this._sideGlBuffer?this._sideGlBuffer=this._gl.createBuffer():!e.hasSideData()&&this._sideGlBuffer&&(this._gl.deleteBuffer(this._sideGlBuffer),this._sideGlBuffer=null))},pa.prototype.markAsUnused=function(){return this._used=!1,this},pa.prototype.getProgram=function(){return this._program},pa.prototype.markAsUsed=function(){return this._used=!0,this},pa.prototype.isUsed=function(){return this._used},pa.prototype.draw=function(){var e=this._gl,t=this._dataBuffer.getElementType(),n=2===t,i=n?this._dataBuffer.getNbSideElementsPerMainElement():1,r=3===t?41:1,o=this._dataBuffer.getSize(),a=this._dataBuffer.getStencilUsage(),s=this._dataBuffer.getVersion(),l=this._version!==s||this._dataBufferChanged;this._program.setupBaseAttributes({glBuffer:this._glBuffer,dataBuffer:l?this._dataBuffer.getByteArray():null,divisor:i}),this._program.setupTextAttributes({glBuffer:this._sideGlBuffer,dataBuffer:l&&n?this._dataBuffer.getSideByteArray():null,divisor:1}),this._program.setupStencil(a),l&&(this._version=s,this._dataBufferChanged=!1),this._ext.drawArraysInstancedANGLE(e.TRIANGLES,0,6*r,o*i)},pa.prototype.destroy=function(){this._gl.deleteBuffer(this._glBuffer),this._sideGlBuffer&&this._gl.deleteBuffer(this._sideGlBuffer)},pa);function pa(e){var t=e.gl,n=e.ext,i=e.staticProgram,r=e.animationProgram;this._program=null,this._dataBuffer=null,this._version=0,this._used=!1,this._dataBufferChanged=!1,this._glBuffer=null,this._sideGlBuffer=null,this._gl=t,this._ext=n,this._staticProgram=i,this._animationProgram=r,this._glBuffer=this._gl.createBuffer()}function Bd(e,t){if(t<2)return e;for(var n=e.split("\n"),i=[],r=0;r<n.length;++r){var o=n[r];if(o.length<t)i.push(o);else for(var a=Dp(n[r],t),s=0;s<a.length;++s)i.push(a[s])}return i.join("\n")}function Dp(e,t){for(var n=e.split(" "),i=[],r=0,o=-1,a=[],s=!0,l=0;l<n.length;++l)if(s){if(n[l].length>t){for(var u=g0(n[l],t),d=0;d<u.length;++d)i.push([u[d]]),++o;r=u[u.length-1].length}else i.push([n[l]]),++o,r=n[l].length+1;s=!1}else r+n[l].length<=t?(i[o].push(n[l]),r+=n[l].length+1):(s=!0,--l);for(l=0;l<i.length;++l)a.push(i[l].join(" "));return a}function g0(e,t){for(var n=[],i=0;i<e.length;i+=t-1)n.push(e.substr(i,t-1)+"-");return n[n.length-1]=n[n.length-1].substr(0,n[n.length-1].length-1)+" ",n}function Rp(e,t){if(null===e)return null;for(var n=(e=e.toString()).split("\n"),i=[],r=0,o=0;o<n.length;o++){var a=n[o];if(!t||t<=1||a.length<t)i.push(a),r=Math.max(r,a.length);else for(var s=Dp(n[o],t),l=0;l<s.length;l++)i.push(a=s[l]),r=Math.max(r,a.length)}return{data:i,maxLength:r,lines:i.length}}function zp(){var e=xi("@mapbox/mapbox-gl-rtl-text")||xi("mapbox-gl-rtl-text"),t=e?e.processBidirectionalText:Hi?window.processBidirectionalText:null,n=e?e.applyArabicShaping:Hi?window.applyArabicShaping:null;return{processBidirectionalText:t?function(i){return t(i,[]).join("")}:function(i){return i},applyArabicShaping:n?function(i){return null===i?null:"number"==typeof i?i.toString():n(i)}:function(i){return null===i?null:i.toString()}}}var pu=fr(),fu="\n".charCodeAt(0),_0=(sr.prototype._init_=function(){this._mustClear=!1,this._byFont={},this._widthAtlases={normal:{},bold:{},italic:{}}},sr.prototype.reset=function(){this._init_()},sr.prototype.clear=function(){this._mustClear=!0},sr.prototype._measureChar=function(e,t,n){return ca(this._ctx,t,12,n),this._ctx.measureText(e).width/12},sr.prototype._getAtlas=function(e,t,n){var i="sdf"===n?0:n,r=this._byFont[e]||(this._byFont[e]={}),o=r[t]||(r[t]=new Array(50));return o[i]||(o[i]=new Array(256))},sr.prototype._getMeasurementAtlas=function(e,t){var n=this._widthAtlases[t];return n[e]||(n[e]=new Array(256))},sr.prototype.measureText=function(e,t,n,i){if(void 0===i&&(i=1),!t)return this._textDimensions.width=0,this._textDimensions.height=0,this._textDimensions;for(var r=this._getMeasurementAtlas(t,n),o=0,a=0,s=1,l=0;l<e.length;++l){var u=e.charCodeAt(l);if(u===fu)o<a&&(o=a),a=0,s+=1;else{var d=r[u];void 0===d&&(d=this._measureChar(e[l],t,n),r[u]=d),a+=d}}return o<a&&(o=a),this._textDimensions.width=o*i,this._textDimensions.height=s*i,this._textDimensions},sr.prototype._getCharInfo=function(e,t,n,i,r,o){var a=e[t];if(!a){var s=String.fromCharCode(t),l="sdf"===r?1:3;a={ratio:this._measureChar(s,n,i),patternId:new Array(l)};for(var u=0;u<l;++u)a.patternId[u]=this._patternManager.getIdFromDefinition({id:0,type:3,attributes:{text:s,font:n,style:i,size:r,align:o,offset:u/l}});e[t]=a}return a},sr.prototype.storeTextInDataView=function(e,t,n,i){var r=t;if(i&&7===i.type){var o=i.attributes,a=o.text,s=o.font,l=o.style,u=o.size,d=o.align,c="center"===d,h=this._getAtlas(s,l,u),p=0,g=1,m=0,b=0,v=this._lineWidthList;a=this._processBidirectionalText(a);for(var y=0;y<a.length;++y)(X=a.charCodeAt(y))===fu?(p<m&&(p=m),v[b]=m,b+=1,m=0,g+=1):m+=(N=this._getCharInfo(h,X,s,l,u,d)).ratio;if(p<(v[b]=m)&&(p=m),"sdf"===u){var S=0,A=-(c?v[S]:p)/2,C=(1-g)/2,O=0;for(y=0;y<a.length;++y){var N=h[X=a.charCodeAt(y)];if(X===fu)S+=1,A=-(c?v[S]:p)/2,C+=1,O=0;else{var P=N.ratio,F=N.patternId[0];A+=(P+O)/2,O=P;var L=Vp(20.44*A),B=Bp(2*C);e.setUint16(r,F,pu),e.setUint16(r+2,(L<<6)+B,pu),r+=4}}}else{var Y=0;for(A=Math.ceil(-(c?v[Y]:p)*u/2),C=(1-g)/2,y=0;y<a.length;++y){var X;if(N=h[X=a.charCodeAt(y)],X===fu)Y+=1,A=Math.ceil(-(c?v[Y]:p)*u/2),C+=1;else{var ae=N.ratio*u,ie=Math.floor(A),W=Math.round(3*(A-ie));3===W&&(W=0,ie+=1),ie+=Math.ceil(ae/2),A+=ae,F=N.patternId[W],L=Vp(ie),B=Bp(2*C),e.setUint16(r,F,pu),e.setUint16(r+2,(L<<6)+B,pu),r+=4}}}}this._fillWithZeros(e,r,n)},sr.prototype.extractTextFromDataView=function(e,t,n){for(var i=e,r=pu,o=i.getUint16(t,r),a=this._textPattern,s=this._patternManager.getDefinitionFromId(o).attributes,l=s.font,u=s.style,d=s.size,c=s.align,h=this._getAtlas(l,u,d),p=[],g=0,m=0,b=0,v=null,y=t;y<n;y+=4){var S=i.getUint16(y,r);if(!S)break;var A=i.getUint16(y+2,r)%64-32,C=this._patternManager.getDefinitionFromId(S);if(!C)break;var O=C.attributes.text.charCodeAt(0),N=h[O];null===v?v=A:v<A&&(m<g&&(m=g),g=0,b+=1,p.push(fu),v=A),p.push(O),N&&(g+=N.ratio)}m<g&&(m=g);var P=String.fromCharCode.apply(null,p);return a.attributes.style=u,a.attributes.font=l,a.attributes.size=d,a.attributes.align=c,a.attributes.text=this._processBidirectionalText(P),a.dimensions.width=m,a.dimensions.height=b,a},sr.prototype._fillWithZeros=function(e,t,n){for(var i=t;i<n;i+=4)e.setUint16(i,0)},sr.prototype._clear=function(){this._byFont={},this._widthAtlases={normal:{},bold:{},italic:{}}},sr.prototype.update=function(){this._mustClear&&(this._clear(),this._mustClear=!1)},sr.prototype.getVersion=function(){return 0},sr);function sr(e){this._patternManager=e,this._canvas=di(),this._ctx=this._canvas.getContext("2d"),this._processBidirectionalText=zp().processBidirectionalText,this._textPattern={id:0,type:7,attributes:{text:"",font:"",size:0,style:"normal",align:"center"},dimensions:{width:0,height:0}},this._textDimensions={width:0,height:0},this._lineWidthList=new Array(64),this._init_()}function Bp(e){return _e(e+32,0,63)}function Vp(e){return _e(e+512,0,1023)}var Vd,m0=op(),v0={stencil:!0,antialias:!1,alpha:!0,premultipliedAlpha:!0,failIfMajorPerformanceCaveat:!("undefined"!=typeof window&&window.FORCE_WEBGL)},y0={NO_WEBGL:'Unable to create a WebGL context: `canvas.getContext("webgl")` and `canvas.getContext("experimental-webgl")` returned `null`',NO_ANGLE_INSTANCED_ARRAYS:'WebGL extension "ANGLE_instanced_arrays" unavailable: `gl.getExtension("ANGLE_instanced_arrays")` returned `null`'},x0=(bt(Up,Vd=Error),Up);function Up(){return null!==Vd&&Vd.apply(this,arguments)||this}function jp(e,t){if(!e){var n=new x0(y0[t]);throw n.code=t,n}}var Zp,b0=(bt(ci,Zp=Cd),ci.isAvailable=function(){return m0},ci.createInitData=function(){var e=di(),t=Ad(e,v0),n=t&&"function"==typeof t.getExtension?t.getExtension("ANGLE_instanced_arrays"):null,i={BYTES_TO_OFFSET_ANGLE:2*Math.PI/8,BYTES_TO_COLOR:1/15,SDF_FONT_SIZE:24,CURVATURE_RATIO:5,PATTERN_MARGIN:1,TEXT_WIDTH_MULTIPLIER:1.2,TEXT_HEIGHT_MULTIPLIER:1.5,SELF_LOOP_CURVATURE_MULTIPLIER:5,EDGE_ARROW_SIZE_RATIO:3,NB_PIECES_PER_CURVE:41,PIECE_NODE_COMPONENT:1,PIECE_EDGE_BODY:2,PIECE_EDGE_HEAD:3,PIECE_EDGE_TAIL:4,PIECE_EDGE_TEXT:5,MAX_TEXT_SIZE:25,BYTES_TO_TEXT_OFFSET:1/20.44,FILTER_NEAREST:0,FILTER_LINEAR:1,FILTER_LINEAR_SDF:2,FILTER_MIPMAP:3,SHAPE_TEXTURE_SIZE:Sd,SIMPLE_SHAPE_SAMPLING_SIZE:32,COMPLEX_SHAPE_SAMPLING_SIZE:128,SHAPE_SAMPLING_BUFFER_RATIO:1/16,MAX_NB_SHAPES:15..toString(),FIRST_COMPLEX_SHAPE_ID:8,SELF_LOOP_TO_CIRCLE_APPROX:.9721},r=new lp(t,{vertex:Td,fragment:Md,constants:i,macros:{ANIMATED:0}}),o=new lp(t,{vertex:Td,fragment:Md,constants:i,macros:{ANIMATED:1}});return t&&n&&(r.compile(),t.flush()),{canvas:e,gl:t,ext:n,staticProgramWrapper:r,animationProgramWrapper:o}},ci.getName=function(){return"WebGL"},ci.prototype._afterFirstFrame=function(){this._animationProgramWrapper.getState()===ha.INIT&&this._animationProgramWrapper.compile()},ci.prototype.ensureAnimationsReady=function(){var e=this._animationProgramWrapper.getState();e!==ha.DONE&&(e===ha.INIT&&this._animationProgramWrapper.compile(),this._animationProgramWrapper.getError())},ci.prototype.getDomElement=function(){return this._glCanvas},ci.prototype._initGl=function(){var e=this._gl;e.clearColor(0,0,0,0),e.enable(e.BLEND),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA)},ci.prototype._computeShaderInfo=function(){var t;this._shaderMetadata=(Md,Gp(t={vertexInfoAttribute:"a_vertexInfo",attributes:[],uniforms:[]},Td),Gp(t,"#define D3D9_FIX 0\nprecision highp float;\nprecision mediump int;\nuniform vec3 u_backgroundColor;\nuniform sampler2D u_patternNearestTexture;\nuniform sampler2D u_patternLinearTexture;\nuniform sampler2D u_patternLinearSdfTexture;\nuniform sampler2D u_patternMipmapTexture;\nuniform sampler2D u_shapeTexture;\nvarying vec4 a;\nvarying vec4 b;\nvarying vec4 c;\nvarying vec2 d;\nvarying vec2 e;\n#if D3D9_FIX\nvarying vec4 f;\nvarying vec3 g;\nvarying vec4 h;\nvarying vec4 i;\n#else\nvarying float j;\nvarying vec2 k;\nvarying vec2 l;\nvarying vec2 m;\nvarying float n;\nvarying float o;\nvarying vec2 p;\nvarying vec2 q;\nvarying float r;\nvarying float s;\n#endif\nconst float FILTER_NEAREST = 0.0;\nconst float FILTER_LINEAR = 0.0;\nconst float FILTER_LINEAR_SDF = 0.0;\nconst float FILTER_MIPMAP = 0.0;\nconst float EPSILON = 0.000000001;\nconst float SDF_BUFFER = (256.0 - 64.0) / 256.0; \nvec4 ad(in vec4 ae, in vec4 af) {\nfloat ag = af.a;\nfloat ah = ae.a + EPSILON;\nfloat ai = min(ag + ah, 1.0);\nfloat r = ag / ai;\nreturn vec4(mix(ae.rgb, af.rgb, r), ai);\n}\nfloat aj(in float ak, in float al) {\nfloat am = (ak * 256.0 + al) * 256.0;\nfloat an = am / 32768.0;\nreturn an * 2.0 - 1.0;\n}\nbool ao(float ap, float aq) {\nreturn abs(ap - aq) < EPSILON;\n}\nvoid main() {\n#if D3D9_FIX\nfloat j = g.x;\nfloat ar = g.y;\nfloat as = g.z;\nvec2 k = f.xy;\nvec2 l = f.zw;\nfloat n = h.x;\nfloat o = h.y;\nfloat at = h.z;\nfloat au = h.w;\nvec2 q = i.xy;\nfloat r = i.z;\nfloat s = i.w;\n#else\nfloat ar = m.x;\nfloat as = m.y;\nfloat at = p.x;\nfloat au = p.y;\n#endif\nvec4 av = texture2D(u_shapeTexture, d);\nfloat aw = aj(av.b, av.a) * q.x;\nfloat ax = aj(av.r, av.g) * q.y;\nax += as;\nfloat ay = min(aw, ax);\nvec4 az = a;\nvec4 ba = b;\nif (s > -EPSILON) {\nvec2 bb = e;\nfloat bj =\nstep(k.x, bb.x) *\nstep(bb.x, l.x) *\nstep(k.y, bb.y) *\nstep(bb.y, l.y);\nfloat bk = bj;\nvec4 bl;\nif (ao(s, FILTER_NEAREST)) {\nbl = texture2D(u_patternNearestTexture, bb);\n} else if (ao(s, FILTER_LINEAR)) {\nbl = texture2D(u_patternLinearTexture, bb);\n} else if (ao(s, FILTER_LINEAR_SDF)) {\nbl = texture2D(u_patternLinearSdfTexture, bb);\nbl.a = smoothstep(SDF_BUFFER - r, SDF_BUFFER + r, bl.a);\n} else if (ao(s, FILTER_MIPMAP)) {\nbl = texture2D(u_patternMipmapTexture, bb);\n}\nbl.rgb += c.rgb;\nbl.a *= bk;\naz = ad(az, bl);\n}\nfloat bm = clamp(ay, 0.0, 1.0);\nfloat bn = clamp(ay - j, 0.0, 1.0);\nfloat bo = bm - bn;\nbo = 1.0 - clamp(ay - j, 0.0, 1.0);\naz.a *= bn;\nba.a *= bo;\nvec4 bp = ad(az, ba);\nfloat bq = bm;\nbp.rgb = mix(u_backgroundColor, bp.rgb, ar);\nif (o > EPSILON) {\nfloat ch = fract(au) * o;\nfloat ci = clamp(min(ch, at - ch), 0.0, 1.0);\nbq *= ci;\n}\nif (n < 0.0 || n > 1.0 || bq < EPSILON) {\ndiscard;\n}\nbp.a *= bq;\nbp.rgb *= bp.a;\ngl_FragColor = bp;\n}\n"),t)},ci.prototype._initGlPrograms=function(){this._staticProgram=new Pp({gl:this._gl,ext:this._ext,specialGlBuffers:this._specialGlBuffers,metaData:this._shaderMetadata,programWrapper:this._staticProgramWrapper}),this._animationProgram=new Pp({gl:this._gl,ext:this._ext,specialGlBuffers:this._specialGlBuffers,metaData:this._shaderMetadata,programWrapper:this._animationProgramWrapper})},ci.prototype._initSpecialGlBuffers=function(){for(var e=this._gl,t=e.createBuffer(),n=new Int8Array(738),i=0;i<41;++i)for(var r=[-1,-1,i,1,-1,i,1,1,i,-1,-1,i,-1,1,i,1,1,i],o=i*r.length,a=0;a<r.length;a++)n[a+o]=r[a];e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW),this._specialGlBuffers={vertexInfo:t}},ci.prototype._computeUniforms=function(){return{viewWidth:this._width,viewHeight:this._height,viewX:this._viewX,viewY:this._viewY,viewZoom:this._viewZoom,viewAngle:this._viewAngle,currentTime:this._currentTime,pixelRatio:this._pixelRatio,backgroundColor:this._backgroundRgba,patternInfoTexture:this._patternTexture.getInfoTextureUnit(),patternNearestTexture:this._patternTexture.getNearestTextureUnit(),patternLinearTexture:this._patternTexture.getLinearTextureUnit(),patternLinearSdfTexture:this._patternTexture.getLinearSdfTextureUnit(),patternMipmapTexture:this._patternTexture.getMipmapTextureUnit(),shapeTexture:this._shapeTexture.getTextureUnit(),BYTES_TO_COORD:this._scales.bytesToActualCoord,BYTES_TO_SCALED_SIZE:this._scales.bytesToActualScaledSize,BYTES_TO_MIN_VISIBLE_SIZE:this._scales.bytesToActualMinVisibleSize,BYTES_TO_SYMBOLIC_SIZE:this._scales.bytesToActualSymbolicSize,BYTES_TO_DASH_LENGTH:this._scales.bytesToActualDashLength,BYTES_TO_GAP_LENGTH:this._scales.bytesToActualGapLength,BYTES_TO_PATTERN_SCALE:this._scales.bytesToActualPatternScale,PATTERN_INFO_TEXTURE_SIZE:this._patternTexture.getInfoTextureSize(),PATTERN_NEAREST_TEXTURE_SIZE:this._patternTexture.getNearestTextureSize(),PATTERN_LINEAR_TEXTURE_SIZE:this._patternTexture.getLinearTextureSize(),PATTERN_LINEAR_SDF_TEXTURE_SIZE:this._patternTexture.getLinearSdfTextureSize(),PATTERN_MIPMAP_TEXTURE_SIZE:this._patternTexture.getMipmapTextureSize(),PATTERN_POSITION_GRANULARITY:this._patternTexture.getGranularity(),SHAPE_TEXTURE_SIZE:this._shapeTexture.getTextureSize(),SHAPE_SAMPLING_SIZE:this._shapeTexture.getSamplingSize(),SHAPE_SAMPLING_BUFFER_RATIO:this._shapeTexture.getBufferRatio(),NB_SHAPES_BY_SIDE:this._shapeTexture.getTextureSize()/this._shapeTexture.getSamplingSize(),SHAPE_DIMENSIONS:this._shapeTexture.getSamplingSize()/this._shapeTexture.getTextureSize(),SHAPE_ACTUAL_RATIO:1-this._shapeTexture.getBufferRatio()}},ci.prototype._render=function(e){var n=e.patternsChanged,i=e.dimensionsChanged,r=e.backgroundColorChanged,o=this._gl;if(e.shapesChanged&&(this._shapeTexture.refresh(this._shapeManager),this._patternTexture.bindMetDataTexture()),n&&this._patternTexture.refresh(this._patternManager),i&&(this._mustResize=!0),r){var a=this._renderBackground?this._backgroundRgba:[0,0,0,0],d=a[3];o.clearColor(a[0]*d,a[1]*d,a[2]*d,d)}var c=this._computeUniforms(),h=this._startFrame();this._mustResize&&h.length&&(Fo(this._glCanvas,this._width,this._height,this._pixelRatio),o.viewport(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio),this._mustResize=!1),o.clear(o.COLOR_BUFFER_BIT|o.STENCIL_BUFFER_BIT);for(var p=0;p<h.length;++p)this._displayBuffer(h[p],c);this._endFrame()},ci.prototype._displayBuffer=function(e,t){var n=e.getProgram();n!==this._currentProgram&&(this._currentProgram&&this._currentProgram.endPass(),this._currentProgram=n,this._currentProgram.startPass(t)),e.markAsUsed(),e.draw()},ci.prototype._startFrame=function(){for(var e=this._bufferList.getBuffersByAscendingDepth(),t=[],n=0;n<this._glBuffers.length;++n)(r=this._glBuffers[n])&&r.markAsUnused();for(n=0;n<e.length;++n){var i=e[n];(r=this._getAssociatedGlBuffer(i)).markAsUsed(),!i.isEmpty()&&this._isBufferDisplayable(i)&&t.push(r)}for(n=0;n<this._glBuffers.length;++n){var r;(r=this._glBuffers[n])&&!r.isUsed()&&(r.destroy(),this._glBuffers[n]=void 0)}return t},ci.prototype._endFrame=function(){this._currentProgram&&(this._currentProgram.endPass(),this._currentProgram=null)},ci.prototype._getAssociatedGlBuffer=function(e){var t=e.getId(),n=this._glBuffers[t];if(!n){for(;this._glBuffers.length<=t;)this._glBuffers.push(void 0);n=new f0({gl:this._gl,ext:this._ext,staticProgram:this._staticProgram,animationProgram:this._animationProgram}),this._glBuffers[t]=n}return n.setDataBuffer(e),n},ci.prototype.destroy=function(){var e=this._gl.getExtension("WEBGL_lose_context");e&&e.loseContext()},ci.prototype.getImageData=function(){var e=this._glCanvas.width,t=this._glCanvas.height;return(this._2dcanvas.width<e||this._2dcanvas.height<t)&&(this._2dcanvas.width=e,this._2dcanvas.height=t),this._ctx.drawImage(this._glCanvas,0,0),this._ctx.getImageData(0,0,e,t)},ci.prototype._getImageDataFlippedYAxis=function(){var e=this._gl,t=this._glCanvas.width,n=this._glCanvas.height,i=this._ctx.createImageData(t,n),r=new Uint8Array(i.data.buffer);return e.readPixels(0,0,t,n,e.RGBA,e.UNSIGNED_BYTE,r),i},ci);function ci(e){var t=Zp.call(this,e)||this;t._2dcanvas=di(),t._ctx=t._2dcanvas.getContext("2d"),t._glBuffers=[],t._staticProgram=null,t._animationProgram=null,t._currentProgram=null,t._specialGlBuffers=null,t._shaderMetadata=null,t._mustResize=!1;var n=e.initData||ci.createInitData(),i=n.canvas,r=n.gl,o=n.ext,a=n.staticProgramWrapper,s=n.animationProgramWrapper;return jp(r,"NO_WEBGL"),jp(o,"NO_ANGLE_INSTANCED_ARRAYS"),t._glCanvas=i,t._gl=r,t._ext=o,t._staticProgramWrapper=a,t._animationProgramWrapper=s,t._shapeTexture=new Jy(t._gl,0),t._patternTexture=new e0(t._gl,1),t._initCanvas(t._glCanvas),t._computeShaderInfo(),t._initSpecialGlBuffers(),t._initGlPrograms(),t._initGl(),t}var E0={float:1,vec2:2,vec3:3,vec4:4};function Gp(e,t){for(var n=/(?:attribute\s+\/\*\s*(byte|ubyte|short|ushort|float)\s*\*\/\s*(float|vec2|vec3|vec4)\s+(\w+)\s*;)|(?:#if\s*(\w+))|(?:#endif)/g,i=/uniform\s+(float|vec2|vec3|vec4|sampler2D|int)\s+(\w+)\s*;/g,r=[],o=n.exec(t);o;){var a=o[0];"#endif"===a?r.pop():a.startsWith("#if")?r.push(o[4]):e.attributes.push({name:o[3],size:E0[o[2]],type:o[1],tags:r.slice(),location:null,byteSize:null,glType:null}),o=n.exec(t)}for(o=i.exec(t);o;){if(!e.uniforms.some(function(d){return d.id===o[1]})){var s=o[1],l=o[2],u=l.replace("u_","");e.uniforms.push({id:u,name:l,type:s})}o=i.exec(t)}}var Br=Math.PI,gu=2*Math.PI,Yp=Br*(5/4),Xp=Br*(7/4),Jp=.75*Br,Qp=.25*Br,k0=-Br/2,O0=Br/2,L0={plain:{dash:0,gap:0},dashed:{dash:3,gap:1},dotted:{dash:1,gap:3}},F0={right:0,top:-Math.PI/2,left:Math.PI,bottom:Math.PI/2,center:0},P0={right:Math.PI,top:-Math.PI/2,left:0,bottom:Math.PI/2,center:0};function sl(e,t,n,i,r){var o=1-r;return o*o*o*e+3*r*o*o*t+3*r*r*o*n+r*r*r*i}function Cs(e,t,n,i){var r=1-i;return r*r*e+2*r*i*t+i*i*n}function fa(e,t,n,i,r,o){var a=o||{x:0,y:0},s=(e+n)/2,l=(t+i)/2,u=e-n,d=t-i,c=Math.sqrt(u*u+d*d);if(0===c)return a.x=s,a.y=l,a;var p=-u/c,g=-c*r/5;return a.x=s+d/c*g,a.y=l+p*g,a}function Ya(e,t,n,i,r,o){var a=o||{x1:0,y1:0,x2:0,y2:0},s=5*(i+i/5*n),l=-r+Br,u=Br/2-r;return a.x1=e+Math.cos(l)*s,a.y1=t+Math.sin(l)*s,a.x2=e+Math.cos(u)*s,a.y2=t+Math.sin(u)*s,a}var nf,rf=(bt(Qt,nf=Cd),Qt.prototype._resetCachePoints=function(){this._nextCachePoint=0},Qt.prototype._point=function(e,t){var n=this._cachePoints[this._nextCachePoint++];return n||this._cachePoints.push(n={x:0,y:0}),n.x=e,n.y=t,n},Qt.prototype.setViewportClipping=function(e){this._clipViewport=e},Qt.prototype._formatAngle=function(e){return e<-Math.PI?e+2*Math.PI:e>Math.PI?e-2*Math.PI:e},Qt.prototype._computeAnimationRatio=function(e){var r=(this._currentTime-e.beginTime)/e.duration,o=r*r,a=o*r,s=this._easingManager.getCoefficients(e.easing),l=r<.5?0:4;return _e(s[l]+s[1+l]*r+s[2+l]*o+s[3+l]*a,0,1)},Qt.prototype._mixColor=function(e,t,n,i){if(e===t)return e;var r=this._colorManager.parseColor(e),o=r[0],a=r[1],s=r[2],l=r[3],u=this._colorManager.parseColor(t),c=u[1],h=u[2],p=u[3];return"rgba("+Math.round(255*It(o,u[0],n))+","+Math.round(255*It(a,c,n))+","+Math.round(255*It(s,h,n))+","+It(l,p,i)+")"},Qt.prototype._displayBuffer=function(e){for(var t=e.getSize(),n=e.isAnimated(),i=0;i<t;++i){var r=this.extractElement(e,i);r.valid&&this._displayElement(r,n)}},Qt.prototype._mixAttributes=function(e,t,n){var i=this._computeAnimationRatio(n);return e.dashLength=It(t.dashLength,e.dashLength,i),e.gapLength=It(t.gapLength,e.gapLength,i),e.offsetAngle=It(t.offsetAngle,e.offsetAngle,i),e.opacity=It(t.opacity,e.opacity,i),e.globalMinVisibleSize=It(t.globalMinVisibleSize,e.globalMinVisibleSize,i),e.strokeMinVisibleSize=It(t.strokeMinVisibleSize,e.strokeMinVisibleSize,i),e.patternMinVisibleSize=It(t.patternMinVisibleSize,e.patternMinVisibleSize,i),e.symbolicSize=It(t.symbolicSize,e.symbolicSize,i),e.curvature=It(t.curvature,e.curvature,i),e.fillColor=this._mixColor(t.fillColor,e.fillColor,i,i),e.strokeColor=this._mixColor(t.strokeColor,e.strokeColor,i,i),e.patternColor=this._mixColor(t.patternColor,e.patternColor,i,i),e.x1=It(t.x1,e.x1,i),e.y1=It(t.y1,e.y1,i),e.x2=It(t.x2,e.x2,i),e.y2=It(t.y2,e.y2,i),e.rectWidthOrSourceRadiusScaled=It(t.rectWidthOrSourceRadiusScaled,e.rectWidthOrSourceRadiusScaled,i),e.rectWidthOrSourceRadiusFixed=It(t.rectWidthOrSourceRadiusFixed,e.rectWidthOrSourceRadiusFixed,i),e.rectHeightOrTargetRadiusScaled=It(t.rectHeightOrTargetRadiusScaled,e.rectHeightOrTargetRadiusScaled,i),e.rectHeightOrTargetRadiusFixed=It(t.rectHeightOrTargetRadiusFixed,e.rectHeightOrTargetRadiusFixed,i),e.thicknessOrFontSizeScaled=It(t.thicknessOrFontSizeScaled,e.thicknessOrFontSizeScaled,i),e.thicknessOrFontSizeFixed=It(t.thicknessOrFontSizeFixed,e.thicknessOrFontSizeFixed,i),e.strokeWidthScaled=It(t.strokeWidthScaled,e.strokeWidthScaled,i),e.strokeWidthFixed=It(t.strokeWidthFixed,e.strokeWidthFixed,i),e.offsetScaled=It(t.offsetScaled,e.offsetScaled,i),e.offsetFixed=It(t.offsetFixed,e.offsetFixed,i),e},Qt.prototype._computeRenderInfo=function(e){var t=this._viewZoom,n=this._point(e.x1,e.y1),i=this._point(e.x2,e.y2);return{shape:this._shapeManager.getDefinitionFromName(e.shape),pieceId:e.pieceId,dashLength:e.dashLength,gapLength:e.gapLength,hasHead:e.hasHead,hasTail:e.hasTail,isBodyTriangle:e.isBodyTriangle,isSelfLoop:e.isSelfLoop,patternScale:e.patternScale,offsetAngle:this._formatAngle(e.offsetAngle),isText:e.isText,adjustTextAngle:e.adjustTextAngle,unusedFlag1:e.unusedFlag1,unusedFlag2:e.unusedFlag2,unusedFlag3:e.unusedFlag3,opacity:e.opacity,globalMinVisibleSize:e.globalMinVisibleSize,strokeMinVisibleSize:e.strokeMinVisibleSize,patternMinVisibleSize:e.patternMinVisibleSize,symbolicSize:0===e.symbolicSize?1/0:e.symbolicSize*t,curvature:e.curvature,pattern:e.pattern,fillColor:e.fillColor,strokeColor:e.strokeColor,patternColor:e.patternColor,pos1OnGraph:n,pos2OnGraph:i,pos1:this._graphToScreenCoordinates(n),pos2:this._graphToScreenCoordinates(i),rectWidthOrSourceRadius:e.rectWidthOrSourceRadiusScaled*t+e.rectWidthOrSourceRadiusFixed,rectHeightOrTargetRadius:e.rectHeightOrTargetRadiusScaled*t+e.rectHeightOrTargetRadiusFixed,thicknessOrFontSize:e.thicknessOrFontSizeScaled*t+e.thicknessOrFontSizeFixed,strokeWidth:e.strokeWidthScaled*t+e.strokeWidthFixed,offset:e.offsetScaled*t+e.offsetFixed}},Qt.prototype._applyBackgroundBlending=function(e){1!==e.opacity&&(e.fillColor=this._blendColor(e.fillColor,e.opacity),e.strokeColor=this._blendColor(e.strokeColor,e.opacity),e.textColor=this._blendColor(e.textColor,e.opacity))},Qt.prototype._pointArray=function(e){var t=this._pointCopies[e];if(!t){t=new Array(e),this._pointCopies[e]=t;for(var n=0;n<e;++n)t[n]={x:0,y:0,r:0}}return t},Qt.prototype._scalePoints=function(e,t,n,i){for(var r=e.shape.points.length,o=this._pointArray(r),a=0;a<r;++a){var s=e.shape.points[a],l=o[a];l.x=t.x+s.x*n,l.y=t.y+s.y*i,l.r=s.r*n}var u=e.pos2OnGraph.x-e.pos1OnGraph.x,d=e.pos2OnGraph.y-e.pos1OnGraph.y;if(0!=u||0!=d)for(var c=Math.sqrt(u*u+d*d),h=u/c,p=d/c,g=0,m=o;g<m.length;g++){var b=m[g],v=b.x-t.x,y=b.y-t.y;b.x=t.x+h*v+p*y,b.y=t.y-p*v+h*y}return o},Qt.prototype._drawPoints=function(e){1===e.length?this._drawCircle(e[0],e[0].r):this._drawPolygon(e)},Qt.prototype._computeCenter=function(e){var t=Math.cos(e.offsetAngle),n=Math.sin(e.offsetAngle);return this._point((e.pos1.x+e.pos2.x)/2+t*e.offset,(e.pos1.y+e.pos2.y)/2+n*e.offset)},Qt.prototype._displayNodeComponent=function(e,t,n,i){var r=this,o=this._computeCenter(e);if(7!==e.pattern.type){var a=e.rectWidthOrSourceRadius/2,s=e.rectHeightOrTargetRadius/2,l=this._scalePoints(e,o,a,s);if((t||i)&&this._drawPoints(l),t&&this._fill(e.fillColor),i){if(this._startClip(),4===e.pattern.type){var u=e.pattern.attributes.colorArray;1!==e.opacity&&(u=u.map(function(B){return r._blendColor(B,e.opacity)})),this._displayPieChart(o,a,u)}else if(5===e.pattern.type||6===e.pattern.type){var d=0,c=Math.round(e.rectHeightOrTargetRadius*e.patternScale),h=e.pattern.attributes.text,p=e.patternColor,g=e.pattern.attributes.font,m=e.pattern.attributes.style,b=e.pattern.attributes.align,v=e.rectWidthOrSourceRadius;this._displayText(o,d,h,p,g,c,m,b,v)}else if(2===e.pattern.type){var y=e.pattern.attributes.image;if(y.isDummy||y.width&&y.height){var S=e.pattern.attributes.duplicated,A=S?1:e.patternScale;this._displayImage(o,e.rectWidthOrSourceRadius*A,e.rectHeightOrTargetRadius*A,y,e.pattern.attributes.scaled,S,e.opacity)}}this._endClip()}if(n){var F=e.strokeWidth/2,L=this._scalePoints(e,o,a+F,s+F);this._drawPoints(L),this._stroke(e.strokeColor,e.strokeWidth)}}else i&&this._displayText(o,d=0,h=e.pattern.attributes.text,p=e.patternColor,g=e.pattern.attributes.font,c=e.thicknessOrFontSize,m=e.pattern.attributes.style,b=e.pattern.attributes.align,v=e.rectWidthOrSourceRadius)},Qt.prototype._displayElement=function(e,t){if(e.end.shape&&e.end.pieceId){this._resetCachePoints();var n=t?this._mixAttributes(e.end,e.start,e.animation):e.end,i=this._computeRenderInfo(n);if(!(i.symbolicSize<i.globalMinVisibleSize||0===i.opacity)){this._applyBackgroundBlending(i);var o,s,l,d,c,h,p,g,m,b,A,C,O,N,L=i.strokeColor&&0<i.strokeWidth&&i.symbolicSize>=i.strokeMinVisibleSize,Y=!!i.fillColor;if(1===i.pieceId)this._displayNodeComponent(i,Y,L,1!==i.pattern.type&&i.symbolicSize>=i.patternMinVisibleSize);else{var X=i.pos2.x-i.pos1.x,ae=i.pos2.y-i.pos1.y,ie=Math.sqrt(X*X+ae*ae),U=null,W=null,ce=null;if(i.isSelfLoop){var Ee=this._getSelfLoopControlPoints(i.pos1,i.curvature,5===i.pieceId?i.strokeWidth/2:i.rectWidthOrSourceRadius),rt=Ee.x2,We=Ee.y2;U=this._point(Ee.x1,Ee.y1),W=this._point(rt,We),1,A=((g=i.pos1).x+(m=U).x+(b=W).x)/3-m.x,C=(g.y+m.y+b.y)/3-m.y,O=m.x-b.x,N=m.y-b.y,ce=1.9442*Math.sqrt(A*A+C*C-(O*O+N*N)/4)*3.14159265359*1}else ce=i.curvature?(U=this._getQuadraticCurveControlPoint(i),o=ie,d=.5*.5,c=1/(16*(l=(s=Math.abs(i.curvature)/5+1e-6)*s)),h=Math.sqrt(d+c),p=.5/s*Math.sqrt(.25+l),Math.abs(2*s)*(.5*h+.5*p+c*Math.log(Math.abs((.5+h)/(p-.5))))*o):ie;if(5===i.pieceId){var _t=i.strokeWidth,wt=this._getPointOnLine(i.pos1,U,W,i.pos2,.5),Ue=this._getTangentOnLine(i.pos1,U,W,i.pos2,.5);i.adjustTextAngle&&!i.isSelfLoop&&i.rectWidthOrSourceRadius>=ce-_t&&(Ue.x=1,Ue.y=0,i.offset=0);var Ze=-Math.atan2(Ue.y,Ue.x),Ne=this._formatAngle(i.offsetAngle-Ze);(!i.isSelfLoop&&Ne<0||i.isSelfLoop&&i.offsetAngle<0)&&(Ue.x*=-1,Ue.y*=-1),(Ze>Math.PI/2||Ze<-Math.PI/2)&&(Ze+=Math.PI);var Ge=this._getOrthogonal(Ue),Xe=wt.x+Ge.x*i.offset,$e=wt.y+Ge.y*i.offset;if(i.fillColor){var we=this._pointArray(4),Pe=i.rectWidthOrSourceRadius/2,je=i.rectHeightOrTargetRadius/2,Je=Ue.x*Pe,ut=Ue.y*Pe,Gt=Ge.x*je,Xt=Ge.y*je,an=we[0],nn=we[1],ln=we[2],H=we[3];an.x=Xe+Je+Gt,an.y=$e+ut+Xt,nn.x=Xe+Je-Gt,nn.y=$e+ut-Xt,ln.x=Xe-Je-Gt,ln.y=$e-ut-Xt,H.x=Xe-Je+Gt,H.y=$e-ut+Xt,this._drawPoints(we),this._fill(i.fillColor)}else{var Z=this._point(Xe,$e);this._displayText(Z,Ze,i.pattern.attributes.text,i.patternColor,i.pattern.attributes.font,i.thicknessOrFontSize,i.pattern.attributes.style,i.pattern.attributes.align,i.rectWidthOrSourceRadius)}}else{var Re=3===i.pieceId,Fe=4===i.pieceId,De=Math.cos(i.offsetAngle),Me=Math.sin(i.offsetAngle);i.pos1.x+=De*i.offset,i.pos1.y+=Me*i.offset,i.pos2.x+=De*i.offset,i.pos2.y+=Me*i.offset;var Oe="line"===i.shape.name,Se=i.thicknessOrFontSize,Qe=i.rectWidthOrSourceRadius,at=i.rectHeightOrTargetRadius,Be=+i.hasHead,Ve=+i.hasTail,ze=+i.isBodyTriangle,Ye=3*Se,nt=Be*Ye,yt=Ve*Ye,Tt=Math.min((i.isSelfLoop?1/0:ie-Qe-at)/(Be+Ve),Ye),mt=Ve*(Ye+Math.max(Qe+Tt-yt,0))+(1-Ve)*ze*Qe,At=Be*(Ye+Math.max(at+Tt-nt,0))+(1-Be)*ze*at;if(Re||Fe){var tt=Fe?-1:1,lt=(Re?ce-At:mt)-tt,vt=null,Et=null;if(i.isSelfLoop){var Bt=this._getTFromLengthOnCubicCurve(i.pos1,U,W,i.pos2,lt-i.strokeWidth/2*tt);vt=this._getPointOnCubicCurve(i.pos1,U,W,i.pos2,Bt),Et=this._getTangentOnCubicCurve(i.pos1,U,W,i.pos2,Bt)}else Et=i.curvature?(Bt=this._getTFromLengthOnQuadraticCurve(i.pos1,U,i.pos2,lt-i.strokeWidth/2*tt),vt=this._getPointOnQuadraticCurve(i.pos1,U,i.pos2,Bt),this._getTangentOnQuadraticCurve(i.pos1,U,i.pos2,Bt)):(vt=this._mixPoints(i.pos1,i.pos2,Bt=lt/ce),this._point(X/ie,ae/ie));if(Et.x*=tt,Et.y*=tt,Y){if(i.shape.hole){var Pt=this._makeEdgeExtremityPoints(vt,Et,Ye,i.shape.hole);this._drawPoints(Pt),this._startReverseClip()}we=this._makeEdgeExtremityPoints(vt,Et,Ye,i.shape.points),this._drawPoints(we),this._fill(i.fillColor),i.shape.hole&&this._endReverseClip()}L&&(i.shape.hole&&(Pt=this._makeEdgeExtremityPoints(vt,Et,Ye,i.shape.hole),this._drawPoints(Pt),this._stroke(i.strokeColor,i.strokeWidth)),we=this._makeEdgeExtremityPoints(vt,Et,Ye+i.strokeWidth/2,i.shape.points),this._drawPoints(we),this._stroke(i.strokeColor,i.strokeWidth))}else{if(ce-mt-At<=0)return;if(Oe){var Kt=function(Mn,jn,$t,dn,Dn,In){var On=[];if($t&&On.push(0,$t),Dn&&In){for(var pi=Dn*jn,yn=In*jn,yr=pi+yn,wi=Mn-dn-$t-yr,ti=0;ti<wi;)On.push(pi,yn),ti+=yr;var $i=Mn-dn-$t-ti,Ii=Math.min(pi,$i),ki=Math.max($i-Ii,0);On.push(Ii,ki)}else On.push(Mn-dn-$t,0);return dn&&On.push(0,dn),On}(ce,Se,mt,At,i.dashLength,i.gapLength);L&&(this._drawLine(i.pos1,U,W,i.pos2),this._stroke(i.strokeColor,Se+2*i.strokeWidth,Kt)),Y&&(this._drawLine(i.pos1,U,W,i.pos2),this._stroke(i.fillColor,Se,Kt))}else{var Cn=mt,Pn=ce-At;L&&(we=this._makeTriangleEdgeBody(i.pos1,U,W,i.pos2,Cn,Pn,Se+i.strokeWidth/2,i.strokeWidth/2),this._drawPoints(we),this._stroke(i.strokeColor,i.strokeWidth)),Y&&(we=this._makeTriangleEdgeBody(i.pos1,U,W,i.pos2,Cn,Pn,Se,0),this._drawPoints(we),this._fill(i.fillColor))}}}}}}},Qt.prototype._makeTriangleEdgeBody=function(e,t,n,i,r,o,a,s){return t?n?this._makeSelfLoopTriangleEdge(e,t,n,i,r,o,a,s):this._makeCurveTriangleEdge(e,t,i,r,o,a,s):this._makeStraightTriangleEdge(e,i,r,o,a,s)},Qt.prototype._makeCurveTriangleEdge=function(e,t,n,i,r,o,a){for(var s=this._pointArray(84),l=this._getTFromLengthOnQuadraticCurve(e,t,n,i),u=(this._getTFromLengthOnQuadraticCurve(e,t,n,r)-l)/41,d=(a-o)/41/2,c=o/2,h=l,p=0;p<=41;++p){var g=this._getPointOnQuadraticCurve(e,t,n,h),m=this._getTangentOnQuadraticCurve(e,t,n,h),b=this._getOrthogonal(m),v=b.x*c,y=b.y*c,S=s[p],A=s[83-p];S.x=g.x+v,S.y=g.y+y,A.x=g.x-v,A.y=g.y-y,h+=u,c+=d}return s},Qt.prototype._makeSelfLoopTriangleEdge=function(e,t,n,i,r,o,a,s){for(var l=this._pointArray(84),u=this._getTFromLengthOnCubicCurve(e,t,n,i,r),d=(this._getTFromLengthOnCubicCurve(e,t,n,i,o)-u)/41,c=(s-a)/41/2,h=a/2,p=u,g=0;g<=41;++g){var m=this._getPointOnCubicCurve(e,t,n,i,p),b=this._getTangentOnCubicCurve(e,t,n,i,p),v=this._getOrthogonal(b),y=v.x*h,S=v.y*h,A=l[g],C=l[83-g];A.x=m.x+y,A.y=m.y+S,C.x=m.x-y,C.y=m.y-S,p+=d,h+=c}return l},Qt.prototype._makeStraightTriangleEdge=function(e,t,n,i,r,o){var a=t.x-e.x,s=t.y-e.y,l=Math.sqrt(a*a+s*s),u=this._point(a/l,s/l),d=this._getOrthogonal(u),c=r/2,h=o/2,p=this._pointArray(4),g=p[0],m=p[1],b=p[2],v=p[3],y=e.x+u.x*n,S=e.y+u.y*n,A=e.x+u.x*i,C=e.y+u.y*i,O=d.x*c,N=d.y*c,P=d.x*h,F=d.y*h;return g.x=y+O,g.y=S+N,m.x=y-O,m.y=S-N,b.x=A-P,b.y=C-F,v.x=A+P,v.y=C+F,p},Qt.prototype._makeEdgeExtremityPoints=function(e,t,n,i){for(var r=this._pointArray(i.length),o=n/2,a=e.x+t.x*o,s=e.y+t.y*o,l=t.x,u=t.y,d=0;d<i.length;++d){var c=i[d],h=r[d],g=(u*c.x+l*c.y)*o;h.x=a+(l*c.x-u*c.y)*o,h.y=s+g,h.r=c.r*o}return r},Qt.prototype._drawLine=function(e,t,n,i){t?n?this._drawCubicCurve(e,t,n,i):this._drawQuadraticCurve(e,t,i):this._drawStraightLine(e,i)},Qt.prototype._getSelfLoopControlPoints=function(e,t,n){return Ya(e.x,e.y,t,n,this._viewAngle,this._tmp)},Qt.prototype._getQuadraticCurveControlPoint=function(e){return fa(e.pos1.x,e.pos1.y,e.pos2.x,e.pos2.y,e.curvature,this._point(0,0))},Qt.prototype._graphToScreenCoordinates=function(e){var i=(e.x-this._viewX)*this._viewZoom,r=(e.y-this._viewY)*this._viewZoom,o=this._viewAngleCos,a=this._viewAngleSin;return this._point(o*i+a*r+this._width/2,-a*i+o*r+this._height/2)},Qt.prototype._blendColor=function(e,t){return e?this._mixColor(this._backgroundColor,e,t,1):null},Qt.prototype._getTangentOnLine=function(e,t,n,i,r){return t?n?this._getTangentOnCubicCurve(e,t,n,i,r):this._getTangentOnQuadraticCurve(e,t,i,r):this._getTangentOnStraightLine(e,i)},Qt.prototype._getTangentOnStraightLine=function(e,t){var n=t.x-e.x,i=t.y-e.y,r=Math.sqrt(n*n+i*i);return this._point(n/r,i/r)},Qt.prototype._getTangentOnQuadraticCurve=function(e,t,n,i){var r=1-i,o=r*t.x+i*n.x-(r*e.x+i*t.x),a=r*t.y+i*n.y-(r*e.y+i*t.y),s=Math.sqrt(o*o+a*a);return this._point(o/s,a/s)},Qt.prototype._getTangentOnCubicCurve=function(e,t,n,i,r){var o=1-r,a=o*o,s=r*r,l=a*(t.x-e.x)+2*o*r*(n.x-t.x)+s*(i.x-n.x),u=a*(t.y-e.y)+2*o*r*(n.y-t.y)+s*(i.y-n.y),d=Math.sqrt(l*l+u*u);return this._point(l/d,u/d)},Qt.prototype._mixPoints=function(e,t,n){var i=It(e.x,t.x,n),r=It(e.y,t.y,n);return this._point(i,r)},Qt.prototype._getOrthogonal=function(e){return this._point(-e.y,e.x)},Qt.prototype._getPointOnLine=function(e,t,n,i,r){return t?n?this._getPointOnCubicCurve(e,t,n,i,r):this._getPointOnQuadraticCurve(e,t,i,r):this._mixPoints(e,i,r)},Qt.prototype._getPointOnQuadraticCurve=function(e,t,n,i){var r=Cs(e.x,t.x,n.x,i),o=Cs(e.y,t.y,n.y,i);return this._point(r,o)},Qt.prototype._getPointOnCubicCurve=function(e,t,n,i,r){var o=sl(e.x,t.x,n.x,i.x,r),a=sl(e.y,t.y,n.y,i.y,r);return this._point(o,a)},Qt.prototype._getTFromLengthOnCubicCurve=function(e,t,n,i,r){for(var o=e.x,a=e.y,s=0,l=0,u=0;u<41;++u){var d=sl(e.x,t.x,n.x,i.x,s+=1/41),c=sl(e.y,t.y,n.y,i.y,s),h=d-o,p=c-a,g=Math.sqrt(h*h+p*p),m=l+g;if(r<m)return s-1/41*((m-r)/g);l=m,o=d,a=c}return 1},Qt.prototype._getTFromLengthOnQuadraticCurve=function(e,t,n,i){for(var r=e.x,o=e.y,a=0,s=0,l=0;l<41;++l){var u=Cs(e.x,t.x,n.x,a+=1/41),d=Cs(e.y,t.y,n.y,a),c=u-r,h=d-o,p=Math.sqrt(c*c+h*h),g=s+p;if(i<g)return a-1/41*((g-i)/p);s=g,r=u,o=d}return 1},Qt);function Qt(e){var t=nf.call(this,e)||this;return t._cachePoints=[],t._nextCachePoint=0,t._tmp={x1:0,y1:0,x2:0,y2:0},t._pointCopies=Array(128),t._clipViewport=!0,t}var of,D0=!di().__dummy,R0=(bt(hi,of=rf),hi.getName=function(){return"Canvas"},hi.isAvailable=function(){return D0},hi.prototype.getDomElement=function(){return this._canvas},hi.prototype._render=function(e){e.dimensionsChanged&&up(this._canvas,this._width,this._height,this._pixelRatio);var t=this._ctx,n=this._width*this._pixelRatio,i=this._height*this._pixelRatio;t.clearRect(0,0,n,i),this._backgroundColor&&this._renderBackground&&(t.fillStyle=this._backgroundColor,t.fillRect(0,0,n,i));for(var r=this._bufferList.getBuffersByAscendingDepth(),o=0;o<r.length;++o){var a=r[o];this._isBufferDisplayable(a)&&this._displayBuffer(a)}},hi.prototype._drawCircle=function(e,t){var n=this._ctx,i=this._pixelRatio,r=e.x*i,o=e.y*i,a=t*i;n.beginPath(),n.arc(r,o,a,0,2*Math.PI)},hi.prototype._drawPolygon=function(e){var t=this._ctx,n=this._pixelRatio;t.beginPath();var i=e[0];t.moveTo(i.x*n,i.y*n);for(var r=1;r<e.length;++r){var o=e[r];t.lineTo(o.x*n,o.y*n)}t.closePath()},hi.prototype._drawStraightLine=function(e,t){var n=this._ctx,i=this._pixelRatio;n.beginPath(),n.moveTo(e.x*i,e.y*i),n.lineTo(t.x*i,t.y*i)},hi.prototype._drawQuadraticCurve=function(e,t,n){var i=this._ctx,r=this._pixelRatio;i.beginPath(),i.moveTo(e.x*r,e.y*r),i.quadraticCurveTo(t.x*r,t.y*r,n.x*r,n.y*r)},hi.prototype._drawCubicCurve=function(e,t,n,i){var r=this._ctx,o=this._pixelRatio;r.beginPath(),r.moveTo(e.x*o,e.y*o),r.bezierCurveTo(t.x*o,t.y*o,n.x*o,n.y*o,i.x*o,i.y*o)},hi.prototype._fill=function(e){var t=this._ctx;t.fillStyle=e,t.fill()},hi.prototype._stroke=function(e,t,n){var i=this;void 0===n&&(n=[]);var r=this._ctx;r.setLineDash(n.map(function(o){return o*i._pixelRatio})),r.lineWidth=t,r.strokeStyle=e,r.stroke()},hi.prototype._startClip=function(){this._ctx.save(),this._ctx.clip()},hi.prototype._endClip=function(){this._ctx.restore()},hi.prototype._startReverseClip=function(){this._ctx.save(),this._ctx.rect(0,0,this._canvas.width,this._canvas.height),this._ctx.clip("evenodd")},hi.prototype._endReverseClip=function(){this._ctx.restore()},hi.prototype._displayText=function(e,t,n,i,r,o,a,s,l){var u=this._ctx,d=this._pixelRatio,c=e.x*d,h=e.y*d,p=o*d,g="center"===s?0:-l/2;if(u.save(),u.translate(c,h),u.rotate(-t),u.textAlign=s,u.textBaseline="middle",ca(u,r,p,a),u.fillStyle=i,-1!==n.indexOf("\n"))for(var m=n.split("\n"),b=m.length,v=(1-b)/2*p,y=0;y<b;++y)u.fillText(m[y],g,v),v+=p;else u.fillText(n,g,-1);u.restore()},hi.prototype._displayImage=function(e,t,n,i,r,o,a){if(!this._hideImages&&!("isDummy"in i)){var s=i;1!==a&&(s=this._blendImageOnBackground(i,a));var l=this._ctx,u=this._pixelRatio,d=e.x*u,c=e.y*u,h=t*u,p=n*u,g=s.width*u,m=s.height*u;if(r)l.drawImage(s,d-h/2,c-p/2,h,p);else if(o){for(var b=d-h/2,v=c-p/2,y=d+h/2,S=c+p/2,A=d-g/2,C=c-m/2;b<A;)A-=g;for(;v<C;)C-=m;for(var O=C;A<y;){for(;C<S;)l.drawImage(s,A,C,g,m),C+=m;A+=g,C=O}}else l.drawImage(s,d-g/2,c-m/2,g,m)}},hi.prototype._displayPieChart=function(e,t,n){var i=this._ctx,r=this._pixelRatio,o=e.x*r,a=e.y*r,s=t*r*2,l=2*s;1===n.length?(i.fillStyle=n[0],i.fillRect(o-s,a-s,l,l)):2===n.length?(i.fillStyle=n[0],i.fillRect(o-s,a,l,s),i.fillStyle=n[1],i.fillRect(o-s,a-s,l,s)):mp(i,n,o,a,s)},hi.prototype._blendImageOnBackground=function(e,t){var n=this._backgroundRgba,i="rgb("+Math.round(255*n[0])+","+Math.round(255*n[1])+","+Math.round(255*n[2])+")";return this._imgCanvas.width=e.width,this._imgCanvas.height=e.height,this._imgCtx.clearRect(0,0,e.width,e.height),this._imgCtx.globalAlpha=1,this._imgCtx.fillStyle=i,this._imgCtx.fillRect(0,0,e.width,e.height),this._imgCtx.globalAlpha=t,this._imgCtx.drawImage(e,0,0),this._imgCanvas},hi.prototype.getImageData=function(){return this._ctx.getImageData(0,0,this._canvas.width,this._canvas.height)},hi);function hi(e){var t=of.call(this,e)||this;return t._canvas=di(),t._imgCanvas=di(),t._initCanvas(t._canvas),t._ctx=t._canvas.getContext("2d"),t._imgCtx=t._imgCanvas.getContext("2d"),t}var af=[1/0,1/0,-1/0,-1/0];function Gd(e,t,n,i,r,o){void 0===o&&(o={x:0,y:0});var a=Math.cos(r),s=Math.sin(r),l=e-n,u=t-i;return o.x=a*l-s*u+n,o.y=s*l+a*u+i,o}function vi(e,t,n,i){return Math.sqrt((e-n)*(e-n)+(t-i)*(t-i))}function ul(e,t,n,i){var r=e-n,o=t-i;return r*r+o*o}function sf(e){return 180*e/Math.PI}var uf=!1;try{uf=!!hn("svg")}catch(e){}var ll="none",z0={left:"start",center:"middle",right:"end"},no="data-element-id";function Xa(e){return Math.round(1e3*e)/1e3}function lf(e,t,n,i,r,o){var a=hn("image");return a.setAttribute("width",Xa(i)),a.setAttribute("height",Xa(r)),a.setAttribute("x",Xa(t)),a.setAttribute("y",Xa(n)),a.setAttribute("href",e),o&&o.appendChild(a),a}function qd(e,t,n,i,r,o,a){void 0===o&&(o=1);var s=hn("rect");return s.setAttribute("x",e),s.setAttribute("y",t),s.setAttribute("width",n),s.setAttribute("height",i),s.setAttribute("fill",r),s.setAttribute("fill-opacity",o),a&&a.appendChild(s),s}var Hd,B0=(bt(ri,Hd=rf),ri.getName=function(){return"SVG"},ri.isAvailable=function(){return uf},ri.prototype.getDomElement=function(){return this._svg},ri.prototype._render=function(e){if(e.dimensionsChanged&&Er(this._svg,{width:this._width,height:this._height}),this._backgroundColor&&this._renderBackground){var t=this._colorManager.rgbaToRgb(this._backgroundColor);this._background.setAttribute("fill",t.color),this._background.setAttribute("fill-opacity",t.opacity)}var n=this._bufferList.getBuffersByAscendingDepth();this._clear(),this._svg.removeChild(this._container);for(var i=0;i<n.length;++i){var r=n[i];this._isBufferDisplayable(r)&&this._displayBuffer(r)}this._svg.appendChild(this._container)},ri.prototype._clear=function(){this._container&&this._svg.removeChild(this._container),this._container=hn("g"),this._svg.appendChild(this._container),this._clipPaths&&this._defs.removeChild(this._clipPaths),this._clipPaths=hn("g"),this._defs.appendChild(this._clipPaths),this._filters&&this._defs.removeChild(this._filters),this._filters=hn("g"),this._defs.appendChild(this._filters)},ri.prototype._displayElement=function(e,t){this._currentElementId=0<=e.id?"n"+e.id:"e"+-e.id,Hd.prototype._displayElement.call(this,e,t)},ri.prototype._addBackgroundBlendingFilter=function(e){var t=this._colorManager.parseColor(this._backgroundColor),n=1-e,i=[e,0,0,0,t[0]*n,0,e,0,0,t[1]*n,0,0,e,0,t[2]*n,0,0,0,1,0].join(" "),r="filter-"+this._currentElementId,o=hn("filter",{id:r}),a=hn("feColorMatrix",{in:"SourceGraphic",type:"matrix",values:i});return o.appendChild(a),this._filters.appendChild(o),r},ri.prototype._drawCircle=function(e,t){var n="M "+(e.x-t)+", "+e.y+" a "+t+","+t+" 0 1,0 "+2*t+",0 a "+t+","+t+" 0 1,0 -"+2*t+",0",i=hn("path");i.setAttribute("d",n),i.setAttribute("fill",ll),i.setAttribute(no,this._currentElementId),this._container.appendChild(i),this._element=i},ri.prototype._drawPolygon=function(e){for(var t=hn("path"),n="",i=0;i<e.length;i++){var r=e[i];n+=(0===i?"M":"L")+r.x+","+r.y+" "}t.setAttribute("d",n+="Z"),t.setAttribute(no,this._currentElementId),t.setAttribute("fill",ll),this._container.appendChild(t),this._element=t},ri.prototype._drawStraightLine=function(e,t){var n=hn("path");n.setAttribute("d","M "+e.x+","+e.y+" L"+t.x+","+t.y),n.setAttribute(no,this._currentElementId),this._container.appendChild(n),this._element=n},ri.prototype._drawQuadraticCurve=function(e,t,n){var i=hn("path");i.setAttribute("d","M "+e.x+","+e.y+" Q"+t.x+","+t.y+" "+n.x+","+n.y),i.setAttribute("fill",ll),i.setAttribute(no,this._currentElementId),this._container.appendChild(i),this._element=i},ri.prototype._drawCubicCurve=function(e,t,n,i){var r=hn("path");r.setAttribute("d","M "+e.x+","+e.y+" C"+t.x+","+t.y+" "+n.x+","+n.y+" "+i.x+","+i.y),r.setAttribute("fill",ll),r.setAttribute(no,this._currentElementId),this._container.appendChild(r),this._element=r},ri.prototype._fill=function(e){var t=this._colorManager.rgbaToRgb(e);this._element.setAttribute("fill",t.color),this._element.setAttribute("fill-opacity",t.opacity),this._currentClipPathId&&this._element.setAttribute("clip-path","url(#"+this._currentClipPathId+")")},ri.prototype._stroke=function(e,t,n){void 0===n&&(n=[]);var i=this._element;i.setAttribute("stroke-width",t);var r=this._colorManager.rgbaToRgb(e);i.setAttribute("stroke",r.color),i.setAttribute("stroke-opacity",r.opacity),0<n.length&&i.setAttribute("stroke-dasharray",n.map(Xa).toString())},ri.prototype._startClip=function(){var e=hn("clipPath"),t=this._element.cloneNode(!1);this._currentClipPathId="clip-path-"+this._clipPathCounter++,e.appendChild(t),this._clipPaths.appendChild(e),e.setAttribute("id",this._currentClipPathId)},ri.prototype._endClip=function(){this._currentClipPathId=null},ri.prototype._startReverseClip=function(){var e=hn("clipPath"),t=this._element.cloneNode(!1),n=t.getAttribute("d");t.setAttribute("clip-rule","evenodd"),t.setAttribute("d",n+" M 0 0 L "+this._width+" 0 L "+this._width+" "+this._height+" L 0 "+this._height),this._currentClipPathId="clip-path-"+this._clipPathCounter++,e.appendChild(t),this._clipPaths.appendChild(e),e.setAttribute("id",this._currentClipPathId)},ri.prototype._endReverseClip=function(){this._currentClipPathId=null},ri.prototype._displayText=function(e,t,n,i,r,o,a,s,l){var u=hn("text");u.setAttribute(no,this._currentElementId);var d=this._colorManager.rgbaToRgb(i),c=d.opacity,h=this._colorManager.rgbaToRgb(d.color),p=e.x,g=e.y;a=a||"normal";var m=Xa(p);u.setAttribute("x",m),u.setAttribute("font-family",r),u.setAttribute("font-size",o),u.setAttribute("bold"===a?"font-weight":"font-style",a),u.setAttribute("fill",h.color),u.setAttribute("fill-opacity",c),t&&u.setAttribute("transform","rotate("+sf(-t)+" "+p+", "+g+")"),u.setAttribute("text-anchor",z0[s]||"middle");var b=n.split("\n"),v=b.length;u.setAttribute("y",Xa(g-((v+1)/2-1/3)*o));for(var S=0;S<v;S++){var A=hn("tspan");A.appendChild(ta(b[S])),A.setAttribute("x",m),A.setAttribute("dy",o),u.appendChild(A)}this._currentClipPathId&&u.setAttribute("clip-path","url(#"+this._currentClipPathId+")"),this._container.appendChild(u)},ri.prototype._displayImage=function(e,t,n,i,r,o,a){var s=e.x,l=e.y;if(!this._hideImages&&("isDummy"in i||i.width&&i.height)){var u,d=i.width,c=i.height;if(r&&(d=t,c=n),o){var h=s-t/2,p=l-n/2,g=s+t/2,m=l+n/2,b=s-d/2,v=l-c/2;for((u=hn("g")).setAttribute(no,this._currentElementId);h<b;)b-=d;for(;p<v;)v-=c;for(var y=v;b<g;){for(;v<m;)lf(i.src,b,v,d,c,u),v+=c;v=y,b+=d}}else(u=lf(i.src,s-d/2,l-c/2,d,c)).setAttribute(no,this._currentElementId);if(this._currentClipPathId&&u.setAttribute("clip-path","url(#"+this._currentClipPathId+")"),1!==a){var S=this._addBackgroundBlendingFilter(a);u.setAttribute("filter","url(#"+S+")")}this._container.appendChild(u)}},ri.prototype._displayPieChart=function(e,t,n){var i,r=2*t,o=2*r,a=e.x,s=e.y,l=hn("g");l.setAttribute(no,this._currentElementId),1===n.length?i=qd(a-r,s-r,o,o,n[0],1,l):2===n.length?(i=qd(a-r,s,o,r,n[0],1,l),i=qd(a-r,s-r,o,r,n[1],1,l)):_p(n,function(u,d,c){var h=a+t*Math.cos(c),p=s+t*Math.sin(c),g=a+t*Math.cos(d),m=s+t*Math.sin(d),b=c-d<=Math.PI?0:1,v="M "+h+","+p+" A "+t+","+t+" 0 "+b+" 0 "+g+","+m+" L "+a+","+s+" L "+h+","+p;(i=hn("path")).setAttribute("d",v),i.setAttribute("fill",u),i.setAttribute("stroke-width",0),l.appendChild(i)}),this._currentClipPathId&&l.setAttribute("clip-path","url(#"+this._currentClipPathId+")"),this._container.appendChild(l)},ri);function ri(e){var t=Hd.call(this,e)||this;return t._svg=hn("svg"),t._defs=hn("defs"),t._styles=hn("g",{class:"styles"}),t._background=hn("rect",{width:"100%",height:"100%",fill:"none",class:"ogma-svg-background"}),t._currentElementId="0",t._currentClipPathId=null,t._clipPathCounter=1,t._defs.appendChild(t._styles),t._svg.setAttribute("pointer-events","none"),t._svg.style.userSelect="none",t._svg.appendChild(t._defs),t._svg.appendChild(t._background),t._clear(),t}var V0=(Ts.prototype.reset=function(){this._initialize()},Ts.prototype._initialize=function(){this._mustUpdate=!0,this.maxCoord=0,this.maxScaledSize=0,this.maxMinVisibleSize=0,this.maxSymbolicSize=0,this.maxDashLength=0,this.maxGapLength=0,this.maxPatternScale=0},Ts.prototype.set=function(e){var t=e.maxCoord,n=e.maxScaledSize,i=e.maxMinVisibleSize,r=e.maxSymbolicSize,o=e.maxDashLength,a=e.maxGapLength,s=e.maxPatternScale,l=this.maxCoord<t||this.maxScaledSize<n||this.maxMinVisibleSize<i||this.maxSymbolicSize<r||this.maxDashLength<o||this.maxGapLength<a||this.maxPatternScale<s;return l&&(this.maxCoord=t,this.maxScaledSize=n,this.maxMinVisibleSize=i,this.maxSymbolicSize=r,this.maxDashLength=o,this.maxGapLength=a,this.maxPatternScale=s,this._mustUpdate=!0),l},Ts.prototype.update=function(){return this._mustUpdate&&(this._version+=1,this._mustUpdate=!1),this},Ts.prototype.getVersion=function(){return this._version},Ts);function Ts(){this._version=0,this._initialize()}var U0={linear:[0,1,0,0],quadraticIn:[0,0,1,0],quadraticOut:[0,2,-1,0],quadraticInOut:[0,0,2,0,-1,4,-2,0],cubicIn:[0,0,0,1],cubicOut:[0,3,-3,1],cubicInOut:[0,0,0,4,-3,12,-12,4]},j0=(dl.prototype.add=function(e){var t=this;Object.keys(e).forEach(function(n){var i=e[n].slice();i.length<8&&(i[4]=i[0],i[5]=i[1],i[6]=i[2],i[7]=i[3]);var r=Jr(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]);t._nameToPolygon[n]=i,t._polygonToName[r]=n})},dl.prototype.getCoefficients=function(e){return this._nameToPolygon[e]||this._linearEasing},dl.prototype.getName=function(e,t,n,i,r,o,a,s){var l=Jr(e,t,n,i,r,o,a,s);return this._polygonToName[l]||"linear"},dl);function dl(){this._linearEasing=[0,1,0,0,0,1,0,0],this._nameToPolygon={},this._polygonToName={},this.add(U0)}var Z0=(Vn.prototype.resizeBoundaries=function(e,t,n,i,r,o){this._maxScaledSize=e,this._maxMinVisibleSize=t,this._maxSymbolicSize=n,this._maxDashLength=i,this._maxGapLength=r,this._maxPatternScale=o,this._actualScaledSizeToBytes=65535/e,this._actualMinVisibleSizeToBytes=15/t,this._actualSymbolicSizeToBytes=255/n,this._actualDashLengthToBytes=3/i,this._actualGapLengthToBytes=3/r,this._actualPatternScaleToBytes=255/o},Vn.prototype.storeGenericObject=function(e,t,n){var i=this._shapeManager.getIdFromName(n.shape),r=n.pieceId,o=this._dashLengthToBytes(n.dashLength),a=this._gapLengthToBytes(n.gapLength),s=+n.hasHead,l=+n.hasTail,u=+n.isBodyTriangle,d=+n.isSelfLoop,c=this._patternScaleToBytes(n.patternScale),h=this._offsetAngleToBytes(n.offsetAngle),p=+n.isText,g=+n.adjustTextAngle,m=+n.unusedFlag1,b=+n.unusedFlag2,v=+n.unusedFlag3,y=this._opacityToBytes(n.opacity),S=this._minVisibleSizeToBytes(n.globalMinVisibleSize),A=this._minVisibleSizeToBytes(n.strokeMinVisibleSize),C=this._minVisibleSizeToBytes(n.patternMinVisibleSize),O=this._symbolicSizeToBytes(n.symbolicSize),N=this._curvatureToBytes(n.curvature),P=this._patternManager.getIdFromDefinition(n.pattern),F=this._colorToBytes(n.fillColor),L=this._colorToBytes(n.strokeColor),B=this._colorToBytes(n.patternColor),Y=this._coordToBytes(n.x1),X=this._coordToBytes(n.y1),ae=this._coordToBytes(n.x2),ie=this._coordToBytes(n.y2),U=this._scaledSizeToBytes(n.rectWidthOrSourceRadiusScaled),W=this._fixedSizeToBytes(n.rectWidthOrSourceRadiusFixed),ce=this._scaledSizeToBytes(n.rectHeightOrTargetRadiusScaled),he=this._fixedSizeToBytes(n.rectHeightOrTargetRadiusFixed),Ee=this._scaledSizeToBytes(n.thicknessOrFontSizeScaled),Te=this._fixedSizeToBytes(n.thicknessOrFontSizeFixed),it=this._scaledSizeToBytes(n.strokeWidthScaled),rt=this._fixedSizeToBytes(n.strokeWidthFixed),We=this._scaledSizeToBytes(n.offsetScaled),_t=this._fixedSizeToBytes(n.offsetFixed),Ue=c+(h<<8)+(p<<11)+(g<<12)+(m<<13)+(b<<14)+(v<<15),Ze=y+(S<<4)+(A<<8)+(C<<12),Ne=O+(N<<8);this._setUint16(e,t+0,i+(r<<4)+(o<<8)+(a<<10)+(s<<12)+(l<<13)+(u<<14)+(d<<15)),this._setUint16(e,t+2,Ue),this._setUint16(e,t+4,Ze),this._setUint16(e,t+6,Ne),this._setUint16(e,t+8,P),this._setUint16(e,t+10,F),this._setUint16(e,t+12,L),this._setUint16(e,t+14,B),this._setFloat32(e,t+16,Y),this._setFloat32(e,t+20,X),this._setFloat32(e,t+24,ae),this._setFloat32(e,t+28,ie),this._setUint16(e,t+32,U),this._setUint16(e,t+34,W),this._setUint16(e,t+36,ce),this._setUint16(e,t+38,he),this._setUint16(e,t+40,Ee),this._setUint16(e,t+42,Te),this._setUint16(e,t+44,it),this._setUint16(e,t+46,rt),this._setUint16(e,t+48,We),this._setUint16(e,t+50,_t)},Vn.prototype._setUint16=function(e,t,n){e.setUint16(t,n,this._littleEndian)},Vn.prototype._setFloat32=function(e,t,n){e.setFloat32(t,n,this._littleEndian)},Vn.prototype._colorToBytes=function(e){var t=this._colorParser(e);return Math.round(15*t[0])+(Math.round(15*t[1])<<4)+(Math.round(15*t[2])<<8)+(Math.round(15*t[3])<<12)},Vn.prototype._coordToBytes=function(e){return e},Vn.prototype._scaledSizeToBytes=function(e){return Math.ceil(Math.min(e,this._maxScaledSize)*this._actualScaledSizeToBytes)},Vn.prototype._fixedSizeToBytes=function(e){return e},Vn.prototype._minVisibleSizeToBytes=function(e){return Math.round(Math.min(e,this._maxMinVisibleSize)*this._actualMinVisibleSizeToBytes)},Vn.prototype._symbolicSizeToBytes=function(e){return Math.round(Math.min(e,this._maxSymbolicSize)*this._actualSymbolicSizeToBytes)},Vn.prototype._dashLengthToBytes=function(e){return Math.round(Math.min(e,this._maxDashLength)*this._actualDashLengthToBytes)},Vn.prototype._gapLengthToBytes=function(e){return Math.round(Math.min(e,this._maxGapLength)*this._actualGapLengthToBytes)},Vn.prototype._patternScaleToBytes=function(e){return Math.round(Math.min(e,this._maxPatternScale)*this._actualPatternScaleToBytes)},Vn.prototype._offsetAngleToBytes=function(e){return Math.round((e+gu)%gu*(8/gu))},Vn.prototype._opacityToBytes=function(e){return Math.round(15*Math.min(e,1))},Vn.prototype._curvatureToBytes=function(e){return this._signedToUnsignedByte(e)},Vn.prototype._signedToUnsignedByte=function(e){return _e(e,-128,127)+128},Vn.prototype.storeAnimationInformation=function(e,t,n,i){var o=n.duration;this._setAnimationBeginTime(e,t,n.beginTime),this._setAnimationDuration(e,t,o),this._setAnimationEasing(e,t,i)},Vn.prototype._setAnimationBeginTime=function(e,t,n){this._setFloat32(e,t,n)},Vn.prototype._setAnimationDuration=function(e,t,n){this._setFloat32(e,t+4,n)},Vn.prototype._setAnimationEasing=function(e,t,n){this._setUint16(e,t+8,(n[0]+128<<8)+(n[4]+128)),this._setUint16(e,t+10,(n[1]+128<<8)+(n[5]+128)),this._setUint16(e,t+12,(n[2]+128<<8)+(n[6]+128)),this._setUint16(e,t+14,(n[3]+128<<8)+(n[7]+128))},Vn.prototype.extractGenericElement=function(e,t,n){var i=e.getElementType(),r=e.isAnimated(),o=e.getDataView(),a=t*e.getElementSize(),s=this._genericObject;if(s.valid=!1,o.getUint16(a)&&(s.valid=!0,this._extractGenericObject(s.end,o,a,n),r&&(this._extractGenericObject(s.start,o,52+a,n),this._extractAnimationInformation(s.animation,o,104+a)),s.id=this._idRecorder.get(e,t),2===i)){var l=e.getSideDataView(),u=t*e.getTotalSideElementsSize(),d=u+e.getTotalSideElementsSize();this._extractTextCharacters(s.end,l,u,d)}return s},Vn.prototype._extractGenericObject=function(e,t,n,i){var r=i.bytesToActualCoord,o=i.bytesToActualScaledSize,a=i.bytesToActualMinVisibleSize,s=i.bytesToActualPatternScale,l=i.bytesToActualSymbolicSize,u=i.bytesToActualDashLength,d=i.bytesToActualGapLength,c=t,h=n,p=this._littleEndian,g=c.getUint16(h,p),m=Hn(g,0,4),b=Hn(g,4,8),v=Hn(g,8,10),y=Hn(g,10,12),S=Hn(g,12,13),A=Hn(g,13,14),C=Hn(g,14,15),O=Hn(g,15,16),N=c.getUint16(h+2,p),P=Hn(N,0,8),F=Hn(N,8,11),L=Hn(N,11,12),B=Hn(N,12,13),Y=Hn(N,13,14),X=Hn(N,14,15),ae=Hn(N,15,16),ie=c.getUint16(h+4,p),U=Hn(ie,0,4),W=Hn(ie,4,8),ce=Hn(ie,8,12),he=Hn(ie,12,16),Ee=c.getUint16(h+6,p),Te=Hn(Ee,0,8),it=Hn(Ee,8,16),rt=c.getUint16(h+8,p),We=c.getUint16(h+10,p),_t=c.getUint16(h+12,p),wt=c.getUint16(h+14,p),Ue=c.getFloat32(h+16,p),Ze=c.getFloat32(h+20,p),Ne=c.getFloat32(h+24,p),Ge=c.getFloat32(h+28,p),Xe=c.getUint16(h+32,p),$e=c.getUint16(h+34,p),we=c.getUint16(h+36,p),Pe=c.getUint16(h+38,p),je=c.getUint16(h+40,p),Je=c.getUint16(h+42,p),ut=c.getUint16(h+44,p),Gt=c.getUint16(h+46,p),Xt=c.getUint16(h+48,p),an=c.getUint16(h+50,p);e.pieceId=b,e.shape=this._shapeManager.getNameFromId(m),e.x1=Vr(Ue,r),e.y1=Vr(Ze,r),e.x2=Vr(Ne,r),e.y2=Vr(Ge,r),e.rectWidthOrSourceRadiusScaled=Vr(Xe,o),e.rectWidthOrSourceRadiusFixed=$e,e.rectHeightOrTargetRadiusScaled=Vr(we,o),e.rectHeightOrTargetRadiusFixed=Pe,e.thicknessOrFontSizeScaled=Vr(je,o),e.thicknessOrFontSizeFixed=Je,e.strokeWidthScaled=Vr(ut,o),e.strokeWidthFixed=Gt,e.offsetScaled=Vr(Xt,o),e.offsetFixed=an,e.pattern=this._patternManager.getDefinitionFromId(rt),e.opacity=U/15,e.fillColor=Wd(We),e.strokeColor=Wd(_t),e.patternColor=Wd(wt),e.globalMinVisibleSize=Vr(W,a),e.strokeMinVisibleSize=Vr(ce,a),e.patternMinVisibleSize=Vr(he,a),e.offsetAngle=F*(2*Math.PI/8),e.patternScale=P*s,e.symbolicSize=Te*l,e.curvature=it-128,e.dashLength=v*u,e.gapLength=y*d,e.hasHead=!!S,e.hasTail=!!A,e.isBodyTriangle=!!C,e.isSelfLoop=!!O,e.isText=!!L,e.adjustTextAngle=!!B,e.unusedFlag1=!!Y,e.unusedFlag2=!!X,e.unusedFlag3=!!ae},Vn.prototype._extractAnimationInformation=function(e,t,n){var i=t,r=n,o=this._littleEndian,a=i.getFloat32(r,o),s=i.getFloat32(r+4,o),l=i.getUint16(r+8,o),u=i.getUint16(r+10,o),d=i.getUint16(r+12,o),c=i.getUint16(r+14,o),h=(l>>8)-128,p=(u>>8)-128,g=(d>>8)-128,m=(c>>8)-128,b=l%256-128,v=u%256-128,y=d%256-128,S=c%256-128;e.beginTime=a,e.duration=s,e.easing=this._easingManager.getName(h,p,g,m,b,v,y,S)},Vn.prototype._extractTextCharacters=function(e,t,n,i){e.pattern=this._textManager.extractTextFromDataView(t,n,i)},Vn);function Vn(e,t,n,i,r,o){this._littleEndian=fr(),this._maxScaledSize=0,this._maxMinVisibleSize=0,this._maxSymbolicSize=0,this._maxDashLength=0,this._maxGapLength=0,this._maxPatternScale=0,this._actualScaledSizeToBytes=32767,this._actualMinVisibleSizeToBytes=15,this._actualSymbolicSizeToBytes=255,this._actualDashLengthToBytes=3,this._actualGapLengthToBytes=3,this._actualPatternScaleToBytes=255,this._genericObject={valid:!1,id:void 0,end:{pieceId:0,shape:"circle",x1:0,y1:0,x2:0,y2:0,rectWidthOrSourceRadiusScaled:0,rectWidthOrSourceRadiusFixed:0,rectHeightOrTargetRadiusScaled:0,rectHeightOrTargetRadiusFixed:0,thicknessOrFontSizeScaled:0,thicknessOrFontSizeFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,offsetScaled:0,offsetFixed:0,pattern:{id:void 0,type:0,attributes:{}},opacity:1,fillColor:null,strokeColor:null,patternColor:null,globalMinVisibleSize:0,strokeMinVisibleSize:0,patternMinVisibleSize:0,offsetAngle:0,patternScale:0,symbolicSize:-1,curvature:0,dashLength:0,gapLength:0,hasHead:!1,hasTail:!1,isBodyTriangle:!1,isSelfLoop:!1,isText:!1,adjustTextAngle:!1,unusedFlag1:!1,unusedFlag2:!1,unusedFlag3:!1},start:{pieceId:0,shape:"circle",x1:0,y1:0,x2:0,y2:0,rectWidthOrSourceRadiusScaled:0,rectWidthOrSourceRadiusFixed:0,rectHeightOrTargetRadiusScaled:0,rectHeightOrTargetRadiusFixed:0,thicknessOrFontSizeScaled:0,thicknessOrFontSizeFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,offsetScaled:0,offsetFixed:0,pattern:{id:void 0,type:0,attributes:{}},opacity:1,fillColor:null,strokeColor:null,patternColor:null,globalMinVisibleSize:0,strokeMinVisibleSize:0,patternMinVisibleSize:0,offsetAngle:0,patternScale:0,symbolicSize:-1,curvature:0,dashLength:0,gapLength:0,hasHead:!1,hasTail:!1,isBodyTriangle:!1,isSelfLoop:!1,isText:!1,adjustTextAngle:!1,unusedFlag1:!1,unusedFlag2:!1,unusedFlag3:!1},animation:{duration:0,beginTime:-1,easing:"linear"}},this._shapeManager=t,this._patternManager=e,this._textManager=n,this._idRecorder=i,this._easingManager=r,this._colorParser=o}function Hn(e,t,n){return e%(1<<n)>>t}function Vr(e,t){return e*t}var df=new Array(65535);function Wd(e){var t=df[e];if(!t){var n=Hn(e,0,4)/15,i=Hn(e,4,8)/15,r=Hn(e,8,12)/15,o=Hn(e,12,16)/15;t="rgba("+(255*n|0)+", "+(255*i|0)+", "+(255*r|0)+", "+o+")",n+i+r+o==0&&(t=null),df[e]=t}return t}var G0=(Ui.prototype.setDepth=function(e){return this._depth=e,this},Ui.prototype.reset=function(e,t,n,i){return this._elementType=e,this._animated=t,this._depth=n,this._id=i,this._stencilUsage=1,this._size=0,this},Ui.prototype.setStencilUsage=function(e){this._stencilUsage=e},Ui.prototype.next=function(){if(this._size>=this._capacity)throw new Error("internal error: block.next() was called on a full block");return this._list[this._size++]},Ui.prototype.nextAndReset=function(){var e,t=this.next();return sp(t.end),sp(t.start),(e=t.animation).duration=0,e.beginTime=-1,e.easing="linear",t},Ui.prototype.forEach=function(e){this._list.forEach(e)},Ui.prototype.getElement=function(e){return this._list[e]},Ui.prototype.getCurrentElement=function(){return this._list[this._size-1]},Ui.prototype.getSize=function(){return this._size},Ui.prototype.getDepth=function(){return this._depth},Ui.prototype.getElements=function(){return this._list},Ui.prototype.getType=function(){return this._elementType},Ui.prototype.getId=function(){return this._id},Ui.prototype.isAnimated=function(){return this._animated},Ui.prototype.getStencilUsage=function(){return this._stencilUsage},Ui.prototype.setGlobalAnimation=function(e,t,n){for(var i=0;i<this._size;++i){var r=this._list[i].animation;r.duration=e,r.beginTime=t,r.easing=n}},Ui);function Ui(){this._elementType=1,this._animated=!1,this._size=0,this._capacity=128,this._depth=0,this._id=0,this._stencilUsage=1,this._list=Array(this._capacity);for(var e=0;e<this._capacity;++e)this._list[e]={valid:!1,id:void 0,end:{pieceId:0,shape:"circle",x1:0,y1:0,x2:0,y2:0,rectWidthOrSourceRadiusScaled:0,rectWidthOrSourceRadiusFixed:0,rectHeightOrTargetRadiusScaled:0,rectHeightOrTargetRadiusFixed:0,thicknessOrFontSizeScaled:0,thicknessOrFontSizeFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,offsetScaled:0,offsetFixed:0,pattern:{id:void 0,type:0,attributes:{}},opacity:1,fillColor:null,strokeColor:null,patternColor:null,globalMinVisibleSize:0,strokeMinVisibleSize:0,patternMinVisibleSize:0,offsetAngle:0,patternScale:0,symbolicSize:-1,curvature:0,dashLength:0,gapLength:0,hasHead:!1,hasTail:!1,isBodyTriangle:!1,isSelfLoop:!1,isText:!1,adjustTextAngle:!1,unusedFlag1:!1,unusedFlag2:!1,unusedFlag3:!1},start:{pieceId:0,shape:"circle",x1:0,y1:0,x2:0,y2:0,rectWidthOrSourceRadiusScaled:0,rectWidthOrSourceRadiusFixed:0,rectHeightOrTargetRadiusScaled:0,rectHeightOrTargetRadiusFixed:0,thicknessOrFontSizeScaled:0,thicknessOrFontSizeFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,offsetScaled:0,offsetFixed:0,pattern:{id:void 0,type:0,attributes:{}},opacity:1,fillColor:null,strokeColor:null,patternColor:null,globalMinVisibleSize:0,strokeMinVisibleSize:0,patternMinVisibleSize:0,offsetAngle:0,patternScale:0,symbolicSize:-1,curvature:0,dashLength:0,gapLength:0,hasHead:!1,hasTail:!1,isBodyTriangle:!1,isSelfLoop:!1,isText:!1,adjustTextAngle:!1,unusedFlag1:!1,unusedFlag2:!1,unusedFlag3:!1},animation:{duration:0,beginTime:-1,easing:"linear"}}}var q0=(cl.prototype.reset=function(){this._maps=[]},cl.prototype.set=function(e,t,n){for(var i=e.getId();this._maps.length<=i;)this._maps.push(new Array(512));this._maps[i][t]=n},cl.prototype.get=function(e,t){return this._maps[e.getId()][t]},cl);function cl(){this._maps=[]}var H0={x:0,y:0,zoom:1,angle:0,width:80,height:60,pixelRatio:1,backgroundColor:null,currentTime:0,isBufferDisplayable:function(){return!0},hideImages:!1,renderBackground:!1},hl={webgl:b0,canvas:R0,svg:B0},cf=[0,0,0,0],Yd={webgl:null,svg:null,canvas:null},_u=(Vt.createInitData=function(){var e={};for(var t in hl)e[t]=hl[t].createInitData();return e},Vt.cacheInitData=function(e){Yd=e},Vt.getCachedInitData=function(){return Yd},Vt.clearCachedInitData=function(){Yd={webgl:null,svg:null,canvas:null}},Vt.prototype.addCanvas=function(e){e.style.touchAction="none",e.style.msContentZooming="none",this._resizeCanvas(e),this._additionalCanvases.push(e),this._updateDomElement()},Vt.prototype.removeCanvas=function(e){e.style.touchAction="",e.style.msContentZooming="",Pa(this._additionalCanvases,e),this._updateDomElement()},Vt.prototype._ensureDomElementsFitParent=function(){if(this._domElement.offsetWidth!==this._view.width||this._domElement.offsetHeight!==this._view.height){this._domElement.style.width=this._view.width+"px",this._domElement.style.height=this._view.height+"px";for(var e=0;e<this._additionalCanvases.length;++e)this._resizeCanvas(this._additionalCanvases[e])}},Vt.prototype._ensureCorrectBackgroundColor=function(){this._backgroundColor!==this._view.backgroundColor&&(this._domElement.style.backgroundColor=this._view.backgroundColor,this._backgroundColor=this._view.backgroundColor)},Vt.prototype.createBlock=function(){return new G0},Vt.prototype.parseColor=function(e){return this._colorManager.parseColor(e)},Vt.prototype.clear=function(){this._blockIdToAddress.fill(0),this._patternManager.reset(),this._boundariesManager.reset(),this._textManager.reset(),this._bufferList.reset(),this._idRecorder.reset()},Vt.prototype.notifyFontsReloaded=function(){this._patternManager.notifyUpdate(),this._textManager.clear(),this._refreshTexts=!0},Vt.prototype.notifyPatternUpdate=function(){this._patternManager.notifyUpdate()},Vt.prototype.getShapePoints=function(e){return this._shapeManager.getDefinitionFromName(e).points},Vt.prototype.checkShapeHit=function(e,t,n){var i=this._shapeManager.getDefinitionFromName(e),o=i.getDistanceFromStrokeHorizontally;return 0<=Math.min((0,i.getDistanceFromStrokeVertically)(t,n),o(t,n))},Vt.prototype.setGlobalBoundaries=function(e){var t=e.maxBlockId,n=void 0===t?0:t,i=e.maxScaledSize,r=e.maxMinVisibleSize,o=e.maxSymbolicSize,a=e.maxDashLength,s=e.maxGapLength,l=e.maxPatternScale;return n>this._blockIdToAddress.length&&this._resizeBlockArray(n),!!this._boundariesManager.set(e)&&(this._memoryManager.resizeBoundaries(i,r,o,a,s,l),!0)},Vt.prototype._resizeBlockArray=function(e){var t=new Uint32Array(e);t.set(this._blockIdToAddress),this._blockIdToAddress=t},Vt.prototype.registerShape=function(e,t){this._shapeManager.register(e,t)},Vt.prototype._bindBlock=function(e,t,n,i,r,o,a){this._checkBlockId(e);var l=this._bufferList.allocateBlock(this._blockIdToAddress[e],t,n,i,r,o,a);return this._blockIdToAddress[e]=l.address,this._currentDataView=l.buffer.getDataView(),this._currentElementSize=l.buffer.getElementSize(),this._currentBlockOffset=l.offset,this._currentByteOffset=this._currentBlockOffset*this._currentElementSize,this._currentSideDataView=l.buffer.getSideDataView(),this._currentSideElementSize=l.buffer.getTotalSideElementsSize(),this._currentSideByteOffset=this._currentBlockOffset*this._currentSideElementSize,l},Vt.prototype._setItemIndex=function(e){var t=this._currentBlockOffset+e;this._currentByteOffset=t*this._currentElementSize,this._currentSideByteOffset=t*this._currentSideElementSize},Vt.prototype._freeBlock=function(e){this._checkBlockId(e);var n=this._bufferList.freeBlock(this._blockIdToAddress[e]);return this._blockIdToAddress[e]=n},Vt.prototype._checkBlockId=function(e){e>=this._blockIdToAddress.length&&this._resizeBlockArray(Oi(e+1))},Vt.prototype._setTextCharacters=function(e){this._textManager.storeTextInDataView(this._currentSideDataView,this._currentSideByteOffset,this._currentSideByteOffset+this._currentSideElementSize,e)},Vt.prototype._storeElement=function(e,t){this._memoryManager.storeGenericObject(this._currentDataView,this._currentByteOffset,e.end),t&&(this._memoryManager.storeGenericObject(this._currentDataView,this._currentByteOffset+52,e.start),this._memoryManager.storeAnimationInformation(this._currentDataView,this._currentByteOffset+104,e.animation,this._easingManager.getCoefficients(e.animation.easing)))},Vt.prototype.storeBlock=function(e,t){if(!t||!t.getSize())return this._freeBlock(e);var n=t.getType(),i=t.getDepth(),r=t.getSize(),o=t.getElements(),a=t.isAnimated(),s=t.getStencilUsage(),l=t.getId(),u=0;if(2===n)for(var d=0;d<r;++d)7===(p=o[d]).end.pattern.type&&(u=Math.max(u,p.end.pattern.attributes.text.length)),a&&7===p.start.pattern.type&&(u=Math.max(u,p.start.pattern.attributes.text.length));var c=this._bindBlock(e,n,a,i,r,u,s);for(d=0;d<r;++d){var h=o[d];this._setItemIndex(d),this._storeElement(h,a),this._idRecorder.set(c.buffer,c.offset+d,l)}if(2===n)for(d=0;d<r;++d){var p=o[d];this._setItemIndex(d),this._setTextCharacters(p.end.pattern)}return c.address},Vt.prototype.freeBlock=function(e){return this._freeBlock(e)},Vt.prototype._refreshTextElements=function(){for(var e=0,t=this._bufferList.getBuffers();e<t.length;e++){var n=t[e];if(n&&2===n.getElementType()){for(var i=n.getSideDataView(),r=n.getTotalSideElementsSize(),o=n.getSize(),a=0,s=r,l=0;l<o;++l){var u=this._textManager.extractTextFromDataView(i,a,s);this._textManager.storeTextInDataView(i,a,s,u),a=s,s+=r}n.triggerUpdate()}}},Vt.prototype._extractElement=function(e,t){if(!e)return null;var n=this._bufferList.getBlockInfo(e);return this._renderer.extractElement(n.buffer,n.offset+t)},Vt.prototype.extractElement=function(e,t){return void 0===t&&(t=0),this._extractElement(e,t)},Vt.prototype.getDomElement=function(){return this._domElement},Vt.prototype.measureText=function(e,t,n,i){return void 0===i&&(i=1),this._textManager.measureText(e,t,n,i)},Vt.prototype.setRenderType=function(e){this._renderType!==e&&(this._renderType=e,this._switchMainRenderer=!0)},Vt.prototype._ensureMainRendererReady=function(){if(this._switchMainRenderer){var e=hl[this._renderType];e&&e.isAvailable()||(this._renderType="canvas"),this._renderer=this._renderersByType[this._renderType],this._renderer||(this._renderer=this._instanciateRenderer(this._renderType),this._renderersByType[this._renderType]=this._renderer),this._updateDomElement()}},Vt.prototype._updateDomElement=function(){for(var e=this._renderer&&this._renderer.getDomElement();this._domElement.firstChild;)this._domElement.removeChild(this._domElement.firstChild);e&&this._appendDomChild(e);for(var t=0;t<this._additionalCanvases.length;++t)this._appendDomChild(this._additionalCanvases[t])},Vt.prototype._appendDomChild=function(e){e.style.position="absolute",e.style.left="0",e.style.top="0",this._domElement.appendChild(e)},Vt.prototype._instanciateRenderer=function(e){return new(hl[e]||Cd)({initData:this._initData[e],bufferList:this._bufferList,shapeManager:this._shapeManager,patternManager:this._patternManager,boundariesManager:this._boundariesManager,textManager:this._textManager,colorManager:this._colorManager,easingManager:this._easingManager,memoryManager:this._memoryManager})},Vt.prototype.setView=function(e){this._view=Mt({},this._view,e)},Vt.prototype._updateManagers=function(){this._patternManager.setPixelRatio(this._view.pixelRatio),this._shapeManager.update(),this._patternManager.update(),this._textManager.update(),this._boundariesManager.update(),this._bufferList.update(),this._refreshTexts&&(this._refreshTexts=!1,this._refreshTextElements())},Vt.prototype._resizeCanvas=function(e){up(e,this._view.width,this._view.height,this._view.pixelRatio)},Vt.prototype.render=function(){this._ensureMainRendererReady(),this._ensureDomElementsFitParent(),this._ensureCorrectBackgroundColor(),this._updateManagers(),this._renderer.renderFrame(this._view)},Vt.prototype.ensureAnimationsReady=function(){this._ensureMainRendererReady(),this._renderer.ensureAnimationsReady()},Vt.prototype.export=function(e,t,n){var i=this._instanciateRenderer(e),r=Mt({},this._view,t);return"setViewportClipping"in i&&i.setViewportClipping(!1),r.renderBackground=!0,this._updateManagers(),i.renderFrame(r),i.export(n).then(function(){return i.getDomElement()})},Vt.prototype.getCurrentTime=function(){return R()},Vt.prototype.getImageData=function(){return this._renderer&&this._renderer.getImageData()},Vt.prototype.destroy=function(){for(var e=0,t=Object.keys(this._renderersByType);e<t.length;e++){var i=this._renderersByType[t[e]];i&&i.destroy()}},Vt.prototype.transparentify=function(e){var t=this.parseColor(e)||cf;return"rgba("+Math.round(255*t[0])+","+Math.round(255*t[1])+","+Math.round(255*t[2])+",0)"},Vt.prototype.initDebugRenderingLoop=function(e){var t=this,n=void 0===e?{}:e,i=n.triggerKey,r=void 0===i?"r":i,o=n.start,a=void 0===o||o;document.addEventListener("keydown",function(l){l.key===r&&(a=!a)});var s=function(l){(a||l)&&(t.setView({currentTime:R()}),t.render()),window.requestAnimationFrame(function(){s()})};window.requestAnimationFrame(function(){document.body.appendChild(t.getDomElement()),s(!0)})},Vt);function Vt(e){var t=this;this._view=rn(H0),this._domElement=nr?document.createElement("div"):$o(),this._currentDataView=null,this._currentElementSize=0,this._currentBlockOffset=0,this._currentByteOffset=0,this._blockIdToAddress=new Uint32Array(0),this._renderersByType={},this._switchMainRenderer=!0,this._renderer=null,this._additionalCanvases=[],this._refreshTexts=!1,this._backgroundColor=null,this._initData=e||{},this._colorManager=new ou,this._easingManager=new j0,this._patternManager=new zy,this._shapeManager=new Vy,this._boundariesManager=new V0,this._textManager=new _0(this._patternManager),this._idRecorder=new q0,this._memoryManager=new Z0(this._patternManager,this._shapeManager,this._textManager,this._idRecorder,this._easingManager,function(n){return t.parseColor(n)||cf}),this._bufferList=new jy}var hf,W0=(bt(pl,hf=Rd),Object.defineProperty(pl.prototype,"src",{get:function(){return this._src},set:function(e){var t=this;e&&(this._src=e,setTimeout(function(){t.onload&&t.onload.call(t),t.width=1,t.height=1,t.fire("load")},10))},enumerable:!0,configurable:!0}),pl.prototype.addEventListener=function(e,t){this.on(e,t)},pl);function pl(e,t){var n=hf.call(this)||this;return n.isDummy=!0,n.width=0,n.height=0,n}var Y0=(ga.prototype.setImgCrossOrigin=function(e){this._crossOrigin=e},ga.prototype.clear=function(){this._images={},this._nbLoaded=0,this._nbToLoad=0},ga.prototype.getImage=function(e){var i=this,r=this._images[e];return void 0===r&&(this._nbToLoad+=1,(r=new("undefined"!=typeof Image?Image:W0)(undefined,undefined)).crossOrigin=this._crossOrigin,r.onload=function(){return i._onImgLoad(e)},r.onerror=function(){i._onImgLoad(e),i._images[e]=null},r.src=e,this._images[e]=r),r},ga.prototype._onImgLoad=function(e){this._nbLoaded+=1,this._onFetch.forEach(function(t){return t(e)}),this._nbLoaded===this._nbToLoad&&(this._whenReady.forEach(function(t){return t()}),this._whenReady=[])},ga.prototype.onFetch=function(e){this._onFetch.push(e)},ga.prototype.whenReady=function(){var e=this;return this._nbLoaded===this._nbToLoad?Promise.resolve():new Promise(function(t){return e._whenReady.push(t)})},ga.prototype.destroy=function(){this._whenReady=[],this._onFetch=[]},ga);function ga(){this._images={},this._crossOrigin="anonymous",this._whenReady=[],this._onFetch=[],this._nbLoaded=0,this._nbToLoad=0}function pf(e,t,n,i,r,o,a,s,l){void 0===s&&(s=0),void 0===l&&(l=!1);var u=vi(n,i,r,o),d=(a/2*(l?vi(e,t,r,o)/u:1)+s)/u,c=(r-n)*d,h=(o-i)*d,p=n+h,g=i-c,m=e-p,b=t-g,v=n-h-p,y=i+c-g,S=r+h-p,A=o-c-g,C=m*v+b*y,O=m*S+b*A;return 0<C&&C<v*v+y*y&&0<O&&O<S*S+A*A}function fl(e,t){return e.x===t.x&&e.y===t.y}function Ms(e,t,n,i){return Math.atan2(i-t,n-e)}function mu(e,t,n,i,r,o,a,s){var l=e-n,u=t-i,d=r-a,c=o-s,h=l*c-d*u,p=(u*(e-r)-l*(t-o))/h;if(p<0||1<p)return null;var g=(d*(o-t)+c*(e-r))/h;return 0<=g&&g<=1?{x:e-g*l,y:t-g*u}:null}function ff(e,t,n,i,r,o,a,s){var l,u=[];return(l=mu(e,t,n,i,r,o,r,s))&&u.push(l),(l=mu(e,t,n,i,r,s,a,s))&&u.push(l),(l=mu(e,t,n,i,a,s,a,o))&&u.push(l),(l=mu(e,t,n,i,a,o,r,o))&&u.push(l),u}function Is(e,t,n,i,r,o,a,s){var l=((a-r)*(t-o)-(s-o)*(e-r))/((s-o)*(n-e)-(a-r)*(i-t)),u=((n-e)*(t-o)-(i-t)*(e-r))/((s-o)*(n-e)-(a-r)*(i-t));return 0<=l&&l<=1&&0<=u&&u<=1}function Xd(e,t,n,i,r,o,a,s){return r<=e&&o<=t&&e<=a&&t<=s||r<=n&&o<=i&&n<=a&&i<=s||!!Is(e,t,n,i,r,o,r,s)||!!Is(e,t,n,i,a,o,a,s)||!!Is(e,t,n,i,r,o,a,o)||!!Is(e,t,n,i,r,s,a,s)}function gf(e,t,n){return Math.sqrt(Jd(e.x,e.y,t.x,t.y,n.x,n.y))}function Jd(e,t,n,i,r,o){var a=ul(n,i,r,o);if(0===a)return ul(e,t,n,i);var s=((e-n)*(r-n)+(t-i)*(o-i))/a;return ul(e,t,n+(s=Math.max(0,Math.min(1,s)))*(r-n),i+s*(o-i))}function _f(e,t,n,i,r,o){var a=r-n,s=o-i;if(0==a&&0==s)return{x:n,y:i};var l=((e-n)*a+(t-i)*s)/(a*a+s*s);return l<0?{x:n,y:i}:1<l?{x:r,y:o}:{x:n+l*a,y:i+l*s}}function mf(){for(var e=arguments,t=e.length-1,n=t,i=[],r=0;r<=t&&Math.abs(e[r])<=1e-12;r++)t--;switch(t){case 1:o=e[n],void 0===(s=i)&&(s=[]),0!==(a=e[n-1])&&s.push(-o/a);break;case 2:!function(o,a,s,l){void 0===l&&(l=[]);var u=a/s,d=u*u-o/s*4;if(0<d){var c=Math.sqrt(d);l.push(.5*(-u+c)),l.push(.5*(-u-c))}else 0==d&&l.push(.5*-u)}(e[n],e[n-1],e[n-2],i);break;case 3:!function(o,a,s,l,u){void 0===u&&(u=[]);var d,c,h=s/l,p=a/l,g=(3*p-h*h)/3,m=(2*h*h*h-9*p*h+o/l*27)/27,b=h/3,v=m*m/4+g*g*g/27,y=m/2;if(Math.abs(v)<=1e-6&&(v=0),0<v){var S=Math.sqrt(v);c=0<=(d=-y+S)?Math.pow(d,1/3):-Math.pow(-d,1/3),0<=(d=-y-S)?c+=Math.pow(d,1/3):c-=Math.pow(-d,1/3),u.push(c-b)}else if(v<0){var A=Math.sqrt(-g/3),C=Math.atan2(Math.sqrt(-v),-y)/3,O=Math.cos(C),N=Math.sin(C),P=Math.sqrt(3);u.push(2*A*O-b),u.push(-A*(O+P*N)-b),u.push(-A*(O-P*N)-b)}else d=0<=y?-Math.pow(y,1/3):Math.pow(-y,1/3),u.push(2*d-b),u.push(-d-b)}(e[n],e[n-1],e[n-2],e[n-3],i)}var o,a,s;return i}function _a(e,t,n,i,r,o,a,s,l,u,d){for(var c,h,p=Math.min(a,l),g=Math.min(s,u),m=Math.max(a,l),b=Math.max(s,u),v=mf((c=s-u)*(e+-2*n+r)+(h=l-a)*(t+-2*i+o),c*(-2*e+2*n)+h*(-2*t+2*i),c*e+h*t+(a*u-l*s)),y=0;y<v.length;y++){var S=v[y];if(0<=S&&S<=1){var A=e+(n-e)*S,C=t+(i-t)*S,O=A+(n+(r-n)*S-A)*S,N=C+(i+(o-i)*S-C)*S;if(a===l){if(g<=N&&N<=b){if(!d)return 1;d.push(O,N)}}else if(s===u){if(p<=O&&O<=m){if(!d)return 1;d.push(O,N)}}else if(p<=O&&g<=N&&O<=m&&N<=b){if(!d)return 1;d.push(O,N)}}}return d?d.length/2:0}function vf(e,t,n,i,r,o,a,s,l,u,d){return d?(_a(e,t,n,i,r,o,a,s,l,s,d),_a(e,t,n,i,r,o,l,s,l,u,d),_a(e,t,n,i,r,o,a,u,l,u,d),_a(e,t,n,i,r,o,a,s,a,u,d),d.length/2):a<=e&&e<=l&&s<=t&&t<=u||a<=r&&r<=l&&s<=o&&o<=u||_a(e,t,n,i,r,o,a,s,l,s)||_a(e,t,n,i,r,o,l,s,l,u)||_a(e,t,n,i,r,o,a,u,l,u)||_a(e,t,n,i,r,o,a,s,a,u)?1:0}function ma(e,t,n,i,r,o,a,s,l,u,d,c,h){for(var p,g,m=Math.min(l,d),b=Math.min(u,c),v=Math.max(l,d),y=Math.max(u,c),S=mf((p=u-c)*(-1*e+3*n+-3*r+a)+(g=d-l)*(-1*t+3*i+-3*o+s),p*(3*e+-6*n+3*r)+g*(3*t+-6*i+3*o),p*(-3*e+3*n)+g*(-3*t+3*i),p*e+g*t+(l*c-d*u)),A=0;A<S.length;A++){var C=S[A];if(0<=C&&C<=1){var O=e+(n-e)*C,N=t+(i-t)*C,P=n+(r-n)*C,F=i+(o-i)*C,L=O+(P-O)*C,B=N+(F-N)*C,Y=L+(P+(r+(a-r)*C-P)*C-L)*C,X=B+(F+(o+(s-o)*C-F)*C-B)*C;if(l===d){if(b<=X&&X<=y){if(!h)return 1;h.push(Y,X)}}else if(u===c){if(m<=Y&&Y<=v){if(!h)return 1;h.push(Y,X)}}else if(m<=Y&&b<=X&&Y<=v&&X<=y){if(!h)return 1;h.push(Y,X)}}}return h?h.length/2:0}function yf(e,t,n,i,r,o,a,s,l,u,d,c,h){return h?(ma(e,t,n,i,r,o,a,s,l,u,d,u,h),ma(e,t,n,i,r,o,a,s,d,u,d,c,h),ma(e,t,n,i,r,o,a,s,l,c,d,c,h),ma(e,t,n,i,r,o,a,s,l,u,l,c,h),h.length/2):l<=e&&e<=d&&u<=t&&t<=c||l<=a&&a<=d&&u<=s&&s<=c||ma(e,t,n,i,r,o,a,s,l,u,d,u)||ma(e,t,n,i,r,o,a,s,d,u,d,c)||ma(e,t,n,i,r,o,a,s,l,c,d,c)||ma(e,t,n,i,r,o,a,s,l,u,l,c)?1:0}function Qd(e,t,n,i,r,o,a,s){return void 0===s&&(s={x:0,y:0}),s.x=(1-e)*(1-e)*t+2*(1-e)*e*o+e*e*i,s.y=(1-e)*(1-e)*n+2*(1-e)*e*a+e*e*r,s}function xf(e,t,n,i,r,o,a,s,l,u,d){void 0===u&&(u=0),void 0===d&&(d=!1);var c=n-2*a+r,h=i-2*s+o,p=-((n-e)*h-(i-t)*c)/((2*a-2*n)*h-(2*s-2*i)*c);if(p<0||1<p)return!1;var g=l/2;return d&&(g*=1-p),g+=u,vi(Cs(n,a,r,p),Cs(i,s,o,p),e,t)<=g}function vu(e,t,n,i,r,o,a,s,l,u){void 0===u&&(u={x:0,y:0});var d=(1-e)*(1-e)*(1-e),c=3*e*(1-e)*(1-e),h=3*e*e*(1-e),p=e*e*e;return u.x=d*t+c*o+h*s+p*i,u.y=d*n+c*a+h*l+p*r,u}function bf(e,t,n,i,r,o,a,s,l,u,d,c){var h=vi(n,i,a,s);if(Math.abs(e-n)>h||Math.abs(t-i)>h)return!1;for(var p,g=.5,m=vi(e,t,n,i)<vi(e,t,r,o)?-.01:.01,b=100,v=vu(g,n,i,r,o,a,s,l,u),y=vi(e,t,v.x,v.y),S=d/2+c;0<b--&&0<=g&&g<=1&&S<y&&(.001<m||m<-.001);)p=y,vu(g,n,i,r,o,a,s,l,u,v),p<(y=vi(e,t,v.x,v.y))?g+=m=-m/2:g+m<0||1<g+m?(m/=2,y=p):g+=m;return y<S}function Kd(e,t,n,i,r,o,a){void 0===a&&(a={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0});var s=e+2/3*(n-e),l=t+2/3*(i-t);return gl(e,t,s,l,s+1/3*(r-e),l+1/3*(o-t),r,o,a)}function gl(e,t,n,i,r,o,a,s,l){void 0===l&&(l={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0});var u,d,c,h,p,g=Math.min,m=Math.max,b=Math.sqrt;l.minX=g(e,a),l.maxX=m(e,a),l.minY=g(t,s),l.maxY=m(t,s);for(var v=void 0,y=void 0,S=void 0,A=void 0,C=void 0,O=void 0,N=void 0,P=0;P<2;++P)if(p=0===P?(d=e,c=n,h=r,a):(d=t,c=i,h=o,s),y=6*d-12*c+6*h,v=-3*d+9*c-9*h+3*p,S=3*c-3*d,y|=0,S|=0,0!=(v|=0))(C=y*y-4*S*v)<0||(0<(O=(-y+b(C))/(2*v))&&O<1&&(u=$d(O,d,c,h,p),0===P?(l.minX=g(l.minX,u),l.maxX=m(l.maxX,u)):(l.minY=g(l.minY,u),l.maxY=m(l.maxY,u))),0<(N=(-y-b(C))/(2*v))&&N<1&&(u=$d(N,d,c,h,p),0===P?(l.minX=g(l.minX,u),l.maxX=m(l.maxX,u)):(l.minY=g(l.minY,u),l.maxY=m(l.maxY,u))));else{if(0===y)continue;0<(A=-S/y)&&A<1&&(u=$d(A,d,c,h,p),0===P?(l.minX=g(l.minX,u),l.maxX=m(l.maxX,u)):(l.minY=g(l.minY,u),l.maxY=m(l.maxY,u)))}return l}function $d(e,t,n,i,r){return Math.pow(1-e,3)*t+3*Math.pow(1-e,2)*e*n+3*(1-e)*Math.pow(e,2)*i+Math.pow(e,3)*r}var Q0={left:{x:-1,y:0},right:{x:1,y:0},top:{x:0,y:-1},bottom:{x:0,y:1},center:{x:0,y:0}},K0=(Vo.prototype.getDefinition=function(){return this._attributesManager.getAttributeLayerDefinition(this._id)},Vo.prototype.update=function(e){this._attributesManager.updateAttributeLayer(this._id,e)},Vo.prototype.destroy=function(){this._attributesManager.destroyAttributeLayer(this._id)},Vo.prototype.updateElements=function(e){this._attributesManager.updateElementsForAttributeLayer(this._id,e)},Vo.prototype.updateAll=function(){this._attributesManager.updateAllForAttributeLayer(this._id)},Vo.prototype.setAttributeValues=function(e,t,n){this._attributesManager.setAttributeLayerValues(this._id,e,t,n)},Vo.prototype.getUsedAttributeNames=function(e){return this._attributesManager.getUsedAttributeLayerAttributes(this._id,e)},Vo.prototype.getFlexArrays=function(){return this._attributesManager.getAttributeLayerFlexArrays(this._id)},Vo);function Vo(e,t){this._attributesManager=e,this._id=t}var Ef={storage:1,default:0},_l=(io.prototype._getAllIndexes=function(){for(var e=this._isNode?this._graph.getNodeMaxIndex():this._graph.getEdgeMaxIndex(),t=new Uint32Array(e),n=1;n<=e;++n)t[n-1]=n;return t},io.prototype.addAll=function(){this._all=!0},io.prototype.add=function(e){if(!this._all)for(var t=0;t<e._indexes.length;t++)this._addIndex(e._indexes[t])},io.prototype._addIndex=function(e){0===this._flexArray.get(e)&&(this._flexArray.set(e,1),this._indexList.push(e))},io.prototype.isEmpty=function(){return!this._all&&this._indexList.isEmpty()},io.prototype.isFull=function(){return this._all},io.prototype.getListAndClear=function(){var e=this.getList();return this.clear(),e},io.prototype.getList=function(){var e=null;if(this._all&&!this._includeRemovedElements)e=this._isNode?this._graph.getNodes("all"):this._graph.getEdges("all");else{var t=this._all?this._getAllIndexes():this._indexList.slice();e=this._eltList(t)}return e},io.prototype.clear=function(){this._all=!1,this._indexList.isEmpty()||(this._indexList.reset(),this._flexArray.reset())},io.prototype.addSet=function(e){if(e._all)this.addAll();else for(var t=e._indexList.getBuffer(),n=e._indexList.getLength(),i=0;i<n;++i)this._addIndex(t[i])},io);function io(e){var t=e.graph,n=e.isNode,i=e.includeRemovedElements;this._all=!1,this._isNode=n,this._graph=t,this._includeRemovedElements=i,this._eltList=n?this._graph.nodeList:this._graph.edgeList,this._flexArray=n?this._graph.createNodeAttribute(Ef):this._graph.createEdgeAttribute(Ef),this._all=!1,this._indexList=this._graph.createIndexList(n)}function yu(e){return"string"==typeof e}function ec(e,t){return e?e+"."+t:t}function Ni(e){return"boolean"==typeof e||0===e||1===e?e:void 0}function va(e){return"number"==typeof e&&isFinite(e)?e:void 0}function Un(e){return"number"==typeof e&&isFinite(e)&&0<=e?e:void 0}var Af=new Function("x","return (typeof x === 'number' && isFinite(x) && x % 1 === 0 && x >= -1 && x <= 4) ? x : undefined;");function Uo(e){return null===e||"string"==typeof e||"number"==typeof e?e:void 0}function ya(e){return"fixed"===e||"scaled"===e?e:void 0}function xa(e,t){return t.parseColor(e)?e:void 0}function Qi(e,t){return"inherit"===e||t.parseColor(e)?e:void 0}function ks(e){return null===e?null:"string"==typeof e?e.split(",").map(function(t){var n=t.trim(),i=-1!==n.indexOf(" "),r=n[0];return i&&'"'!==r&&"'"!==r?'"'+n+'"':n}).join(","):void 0}function Os(e){return"none"===e?"normal":"normal"===e||"italic"===e||"bold"===e||"italic bold"===e?e:void 0}function ml(e){return"left"===e||"center"===e?e:void 0}function wf(e){return[null,"arrow","circle-hole-arrow","triangle-hole-arrow","short-arrow","sharp-arrow","circle","square"].includes(e)?e:void 0}function pn(e){return new Function("x",["if (typeof x === 'number') { return (typeof x === 'number' && isFinite(x) && x >= 0) ? x : undefined; }","else if (typeof x !== 'string' || x.charAt(x.length - 1) !== '%') { return undefined; }","else { var p = parseFloat(x); return isNaN(p) ? undefined : ("+e+" * p / 100); }"].join("\n"))}function vl(e){return{_check:Uo,_set:new Function("flexArrays","index","value",["flexArrays.badges."+e+".text.content.set(index, value);","if (value === null || value === undefined) flexArrays.badges."+e+".image.url.set(index, value);"].join("\n")),_get:new Function("flexArrays","index","return flexArrays.badges."+e+".text.content.get(index);"),color:{_flexArray:"white",_check:Qi},scale:{_flexArray:.45,_check:pn(.45)},positionScale:{_flexArray:1,_check:Un},minVisibleSize:{_flexArray:12,_check:pn(12)},image:{_alias:"badges."+e+".image.url",url:{_flexArray:null,_check:Uo},scale:{_flexArray:1,_check:pn(1)}},stroke:{color:{_flexArray:"black",_check:Qi},width:{_flexArray:2,_check:pn(2)},scalingMethod:{_flexArray:"fixed",_check:ya}},text:{_alias:"badges."+e+".text.content",content:{_flexArray:null,_check:Uo},color:{_flexArray:"black",_check:Qi},font:{_flexArray:"Arial",_check:ks},style:{_flexArray:"normal",_check:Os},scale:{_flexArray:.5,_check:pn(.5)}},threshold:"badges."+e+".minVisibleSize"}}var Cf={_check:Ni,_get:function(e,t){return 0===e.opacity.get(t)},_set:function(e,t,n){e.opacity.set(t,void 0===n?void 0:+!n)}},$0={x:{_flexArray:0,_check:va,_disableMemoryOptimization:!0},y:{_flexArray:0,_check:va,_disableMemoryOptimization:!0},radius:{_flexArray:5,_check:pn(5)},scalingMethod:{_flexArray:"scaled",_check:ya},color:{_flexArray:"grey",_check:function(e,t){if(t.parseColor(e))return e;if(Array.isArray(e)){if(e.length<1)return;for(var n=0;n<e.length;++n)if(!t.parseColor(e[n]))return;return e}}},opacity:{_flexArray:1,_check:Un},hidden:Cf,shape:{_flexArray:"circle",_check:function(e){return"equilateral"===e?"pentagon":"circle"===e||"square"===e||"cross"===e||"diamond"===e||"pentagon"===e||"star"===e?e:void 0}},layer:{_flexArray:0,_check:Af},detectable:{_flexArray:!0,_check:Ni},draggable:{_flexArray:!0,_check:Ni},layoutable:{_flexArray:!0,_check:Ni},innerStroke:{_alias:"innerStroke.color",width:{_flexArray:2,_check:pn(2)},scalingMethod:{_flexArray:"fixed",_check:ya},color:{_flexArray:"white",_check:Qi},minVisibleSize:{_flexArray:12,_check:pn(12)},threshold:"innerStroke.minVisibleSize"},outerStroke:{_alias:"outerStroke.color",width:{_flexArray:5,_check:pn(5)},scalingMethod:{_flexArray:"fixed",_check:ya},color:{_flexArray:null,_check:Qi},minVisibleSize:{_flexArray:0,_check:pn(0)},threshold:"outerStroke.minVisibleSize"},badges:{_check:function(e){return null===e?e:void 0},_set:function(e,t,n){e.badges.topLeft.text.content.set(t,n),e.badges.topLeft.image.url.set(t,n),e.badges.topRight.text.content.set(t,n),e.badges.topRight.image.url.set(t,n),e.badges.bottomLeft.text.content.set(t,n),e.badges.bottomLeft.image.url.set(t,n),e.badges.bottomRight.text.content.set(t,n),e.badges.bottomRight.image.url.set(t,n)},topLeft:vl("topLeft"),topRight:vl("topRight"),bottomLeft:vl("bottomLeft"),bottomRight:vl("bottomRight")},halo:{_alias:"halo.color",color:{_flexArray:null,_check:xa},width:{_flexArray:50,_check:pn(50)},scalingMethod:{_flexArray:"fixed",_check:ya},strokeColor:{_flexArray:null,_check:xa},strokeWidth:{_flexArray:1,_check:pn(1)},clustering:{_flexArray:!1,_check:Ni},hideNonAdjacentEdges:{_flexArray:!1,_check:Ni},size:"halo.width"},pulse:{enabled:{_flexArray:!1,_check:Ni},duration:{_flexArray:1e3,_check:Un},interval:{_flexArray:800,_check:Un},startColor:{_flexArray:"rgba(0, 0, 0, 0.6)",_check:Qi},endColor:{_flexArray:"rgba(0, 0, 0, 0)",_check:Qi},width:{_flexArray:50,_check:Un},startRatio:{_flexArray:1,_check:Un},endRatio:{_flexArray:2,_check:Un}},icon:{_alias:"icon.content",content:{_flexArray:null,_check:Uo},font:{_flexArray:"Arial",_check:ks},color:{_flexArray:"black",_check:xa},scale:{_flexArray:.7,_check:pn(.7)},style:{_flexArray:"normal",_check:Os},minVisibleSize:{_flexArray:12,_check:pn(12)},threshold:"icon.minVisibleSize"},image:{_alias:"image.url",url:{_flexArray:null,_check:Uo},scale:{_flexArray:1,_check:pn(1)},fit:{_flexArray:!0,_check:Ni},tile:{_flexArray:!1,_check:Ni},minVisibleSize:{_flexArray:12,_check:pn(12)},rescale:"image.fit",duplicate:"image.tile",threshold:"image.minVisibleSize"},outline:{_alias:"outline.enabled",enabled:{_flexArray:!1,_check:Ni},color:{_flexArray:"rgba(0, 0, 0, 0.36)",_check:xa},minVisibleSize:{_flexArray:12,_check:pn(12)}},text:{_alias:"text.content",content:{_flexArray:null,_check:Uo},font:{_flexArray:"Arial",_check:ks},color:{_flexArray:"black",_check:Qi},size:{_flexArray:12,_check:pn(12)},scale:{_flexArray:.1,_check:Un},style:{_flexArray:"normal",_check:Os},align:{_flexArray:"center",_check:ml},margin:{_flexArray:10,_check:pn(10)},padding:{_flexArray:2,_check:pn(2)},backgroundColor:{_flexArray:null,_check:Qi},tip:{_flexArray:!0,_check:Ni},minVisibleSize:{_flexArray:24,_check:pn(24)},scaling:{_flexArray:!1,_check:Ni},position:{_flexArray:"bottom",_check:function(e){return"top"===e||"bottom"===e||"left"===e||"right"===e||"center"===e?e:void 0}},maxLineLength:{_flexArray:0,_check:Un},truncateLength:{_flexArray:0,_check:Un},backgroundArrowBaseSize:"text.margin",backgroundMargin:"text.padding",threshold:"text.minVisibleSize",secondary:{_alias:"text.secondary.content",content:{_flexArray:null,_check:Uo},font:{_flexArray:"Arial",_check:ks},color:{_flexArray:"black",_check:Qi},size:{_flexArray:10,_check:pn(10)},scale:{_flexArray:.08,_check:Un},style:{_flexArray:"normal",_check:Os},align:{_flexArray:"center",_check:ml},margin:{_flexArray:5,_check:pn(5)},padding:{_flexArray:2,_check:pn(2)},backgroundColor:{_flexArray:null,_check:Qi},minVisibleSize:{_flexArray:24,_check:pn(24)},backgroundArrowBaseSize:"text.secondary.margin",backgroundMargin:"text.secondary.padding",threshold:"text.secondary.minVisibleSize"}}},ex={width:{_flexArray:1,_check:pn(1)},scalingMethod:{_flexArray:"scaled",_check:ya},color:{_flexArray:"grey",_check:function(e,t){return"source"===e||"target"===e||t.parseColor(e)?e:void 0}},opacity:{_flexArray:1,_check:Un},hidden:Cf,minVisibleSize:{_flexArray:0,_check:Un},threshold:"minVisibleSize",layer:{_flexArray:0,_check:Af},detectable:{_flexArray:!0,_check:Ni},curvature:{_flexArray:0,_check:va},adjustAnchors:{_flexArray:!0,_check:Ni},shape:{_check:function(e){return["line","tapered","arrow","dashed","dotted"].includes(e)?e:void 0},_set:function(e,t,n){var i=void 0,r=void 0,o=void 0,a=void 0;"line"===n?(i="line",r="plain",a=o=null):"arrow"===n?(i="line",r="plain",o="arrow",a=null):"tapered"===n?(i="triangle",r="plain",a=o=null):"dashed"===n?(i="line",r="dashed",a=o=null):"dotted"===n&&(i="line",r="dotted",a=o=null),e.shape.type.set(t,i),e.shape.style.set(t,r),e.shape.head.set(t,o),e.shape.tail.set(t,a)},type:{_flexArray:"line",_check:function(e){return"line"===e||"triangle"===e?e:void 0}},head:{_flexArray:null,_check:wf},tail:{_flexArray:null,_check:wf},style:{_flexArray:"plain",_check:function(e){return"plain"===e||"dashed"===e||"dotted"===e?e:void 0}}},stroke:{color:{_flexArray:"inherit",_check:Qi},width:{_flexArray:0,_check:pn(0)},scalingMethod:{_flexArray:"fixed",_check:ya},minVisibleSize:{_flexArray:0,_check:Un}},strokeWidth:"stroke.width",halo:{_alias:"halo.color",color:{_flexArray:null,_check:xa},width:{_flexArray:10,_check:pn(10)},scalingMethod:{_flexArray:"fixed",_check:ya},size:"halo.width"},pulse:{enabled:{_flexArray:!1,_check:Ni},duration:{_flexArray:1e3,_check:Un},interval:{_flexArray:800,_check:Un},startColor:{_flexArray:"rgba(0, 0, 0, 0.6)",_check:Qi},endColor:{_flexArray:"rgba(0, 0, 0, 0)",_check:Qi},width:{_flexArray:10,_check:Un},startRatio:{_flexArray:1,_check:Un},endRatio:{_flexArray:2,_check:Un}},outline:{_alias:"outline.enabled",enabled:{_flexArray:!1,_check:Ni},color:{_flexArray:"rgba(0, 0, 0, 0.36)",_check:xa},minVisibleSize:{_flexArray:0,_check:Un}},text:{_alias:"text.content",content:{_flexArray:null,_check:Uo},font:{_flexArray:"Arial",_check:ks},color:{_flexArray:"black",_check:xa},size:{_flexArray:12,_check:pn(12)},scale:{_flexArray:1,_check:Un},style:{_flexArray:"normal",_check:Os},align:{_flexArray:"center",_check:ml},margin:{_flexArray:2,_check:pn(2)},padding:{_flexArray:2,_check:pn(2)},backgroundColor:{_flexArray:null,_check:Qi},minVisibleSize:{_flexArray:4,_check:Un},threshold:"text.minVisibleSize",adjustAngle:{_flexArray:!0,_check:Ni},scaling:{_flexArray:!1,_check:Ni},maxLineLength:{_flexArray:0,_check:Un},secondary:{_alias:"text.secondary.content",content:{_flexArray:null,_check:Uo},font:{_flexArray:"Arial",_check:ks},color:{_flexArray:"black",_check:xa},size:{_flexArray:12,_check:pn(12)},scale:{_flexArray:.8,_check:Un},style:{_flexArray:"normal",_check:Os},align:{_flexArray:"center",_check:ml},margin:{_flexArray:2,_check:pn(2)},padding:{_flexArray:2,_check:pn(2)},backgroundColor:{_flexArray:null,_check:Qi},minVisibleSize:{_flexArray:4,_check:Un},threshold:"text.secondary.minVisibleSize"}}};function tx(){}function nx(){}function Tf(e,t){if(!e._check)throw new Error("error somewhere for "+t);return{check:e._check,set:new Function("flexArrays","index","value","flexArrays."+t+".set(index, value);"),get:new Function("flexArrays","index","return flexArrays."+t+".get(index);"),nested:{}}}function tc(e,t,n){if(void 0!==(t=t||e)._flexArray)return Tf(t,n);var i={check:null,get:null,set:null,nested:null};if(yu(t)||t._alias){var r=yu(t)?t:t._alias;i=Tf(u=xn(e,r),r)}else{if(t._set?(i.set=t._set,i.check=t._check):(i.set=tx,i.check=nx),t._get)i.get=t._get;else{var o="return "+function d(c,h){if(void 0!==c._flexArray)return"flexArrays."+h+".get(index)";for(var p=[],g=0,m=Object.keys(c);g<m.length;g++){var b=m[g],v=c[b];if(!b.startsWith("_")&&Jt(v)){var y=d(c[b],ec(h,b));y&&p.push(b+": "+y)}}return p.length?"{\n"+p.join(",\n").split("\n").map(function(S){return"  "+S}).join("\n")+"\n}":""}(t,n)+";";i.get=new Function("flexArrays","index",o)}i.nested={}}if(!yu(t))for(var a=0,s=Object.keys(t);a<s.length;a++){var l=s[a],u=t[l];l.startsWith("_")||(i.nested[l]=tc(e,u,ec(n,l)))}return i}function Mf(e){return e}function nc(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}var ix=tc($0),rx=tc(ex),ox={name:"animationStart",storage:32,default:0},ax={name:"animationDuration",storage:16,default:0},sx={name:"animationEasing",storage:"resource",default:"linear"},ux={self:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},adjacentNodes:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},adjacentEdges:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},allNodes:null,allEdges:null},lx={self:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},extremities:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},parallelEdges:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},allNodes:null,allEdges:null},dx={x:1,y:1,radius:1,"halo.hideNonAdjacentEdges":1},If=Object.freeze({__proto__:null,linear:Mf,quadraticIn:function(e){return e*e},quadraticOut:function(e){return e*(2-e)},quadraticInOut:nc,cubicIn:function(e){return e*e*e},cubicOut:function(e){return--e*e*e+1},cubicInOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}}),ic="_visible",rc="_data",Ja="_hovered",oc="_hoverExtremityHighlighted",yi="_selected",yl="_selectionExtremityHighlighted",xl="_dragged",kf="_rewirable",Qa="_export",oi="_faded",ba="_transparent",Of=[yi,xl,yl,Ja,oc,kf,Qa,oi,ba],cx=["hover","zoom","panning","rotation","gesture","drag","selection","tooltip","user","interactions","resizing","rewiring","connectNodes","lasso"];function Nf(e,t){return{attributes:Lf(e),tags:t?[t]:[]}}function Lf(e){var i=null;return void 0===e.output?("function"==typeof e.attributes&&(i="all"),Jt(e.attributes)&&(i=bi(e.attributes))):i=e.output.attributes,bl(i,e.allAttributePaths)}function yo(e,t,n,i,r,o){!function(a,s,l,u){if(l<u)for(var d=0,c=s.attributes;d<c.length;d++)for(var h=c[d],p=0,g=a.attributes;p<g.length;p++)if(g[p]===h)return!0;for(var m=0,b=s.tags;m<b.length;m++)for(var v=b[m],y=0,S=a.tags;y<S.length;y++)if(v===S[y])return!0;return!1}(n,i,r,o)||e.push(t)}function hx(e){var t=e.dependencies;void 0===t?t=ux:Jt(t)||(t={});var r=Xn(e.attributes).some(function(a){return"function"==typeof a})||e.selector&&!e.standaloneSelector,o=t.adjacentEdges;return!o&&t.adjacentNodes&&(o=!0),{self:xo(t.self,r,e.allAttributePaths),adjacentNodes:xo(t.adjacentNodes,r,e.allAttributePaths),adjacentEdges:xo(o,r,e.allAttributePaths),allNodes:xo(t.allNodes,r,e.allAttributePaths),allEdges:xo(t.allEdges,r,e.allAttributePaths)}}function px(e){var t=e.dependencies;void 0===t?t=lx:Jt(t)||(t={});var r=Xn(e.attributes).some(function(o){return"function"==typeof o})||e.selector&&!e.standaloneSelector;return{self:xo(t.self,r,e.allAttributePaths),extremities:xo(t.extremities,r,e.allAttributePaths),parallelEdges:xo(t.parallelEdges,r,e.allAttributePaths),allNodes:xo(t.allNodes,r,e.allAttributePaths),allEdges:xo(t.allEdges,r,e.allAttributePaths)}}function xo(e,t,n){if(!t)return{attributes:[],tags:[]};if(!0===e)return{attributes:[],tags:[ic]};var i,r={attributes:bl((e=e||{}).attributes,n),tags:(i=e.tags,Array.isArray(i)?i.filter(yu):[])};return e.data&&r.tags.push(rc),e.selection&&r.tags.push(yi),e.hover&&r.tags.push(Ja),r}function fx(e){return Array.isArray(e)?e.join("."):e}function bl(e,t){if("all"===e)return t.slice();if(!Array.isArray(e))return[];var n=e.map(fx).filter(yu);return t?t.filter(function(i){return n.some(function(r){return i.startsWith(r)})}):n}var Ff=(An.prototype.clear=function(){this._elementsToRedraw.clear(),this._elementsUpdated.clear(),this._updatedAttributes.clear(),this._updatedAttributesTmp.clear()},An.prototype.getAttributeFlexArrays=function(){return this._finalFlexArraysWrapped},An.prototype.getPrevAttributeFlexArrays=function(){return this._prevFlexArrays},An.prototype.getAnimationInformation=function(e){for(var t=e._indexes,n=Array(t.length),i=0;i<t.length;i++){var r=t[i];n[i]={duration:this._finalFlexArraysWrapped.animationDuration.get(r),start:this._finalFlexArraysWrapped.animationStart.get(r),easing:this._finalFlexArraysWrapped.animationEasing.get(r)}}return n},An.prototype.startUpdate=function(){},An.prototype.prepareFlexArraysUpdate=function(e){this._currentFlexArrays=e.inputFlexArrays},An.prototype.setLastFlexArrays=function(e){this._lastFlexArrays=e},An.prototype.updateFlexArrays=function(e){var t=e.attributes,n=e.selector,i=e.context,r=e.outputFlexArrays,o=e.toUpdate,a=e.formattedOutput;this._elementsUpdated.addSet(o),this._elementsToRedraw.addSet(o);var s=o.getListAndClear();if(t&&s.size){for(var l=Dh(this._graph,s,n,i),u=l.valid,d=l.invalid,c=0,h=a.attributes;c<h.length;c++)for(var p=xn(r,h[c]),g=0;g<d._indexes.length;g++)p.set(d._indexes[g],void 0);this._assignAttributesToFlexArrays(this._accessors,r,u,t,i),this._addUpdatedAttributes(e)}},An.prototype.endUpdate=function(){for(var e=this._elementsUpdated.getList(),t=0,n=du(this._updatedAttributesTmp);t<n.length;t++)for(var i=n[t],r=xn(this._lastFlexArrays,i),o=xn(this._finalFlexArrays,i),a=0;a<e._indexes.length;a++){var s=e._indexes[a];o.set(s,r.get(s))}this._updatedAttributesTmp.clear(),this._currentFlexArrays=this._finalFlexArrays},An.prototype.setAttributeValues=function(e,t,n,i){this._assignAttributesToFlexArrays(this._accessors,e.outputFlexArrays,t,n,null),this._addUpdatedAttributes(e,i),this._elementsUpdated.add(t),this._elementsToRedraw.add(t)},An.prototype.notifyLayerDestroyed=function(e){this._addUpdatedAttributes(e)},An.prototype._addUpdatedAttributes=function(e,t){for(var n=e.outputFlexArrays,i=e.formattedOutput,r=0,o=Array.isArray(t)?bl(t):i.attributes;r<o.length;r++){var a=o[r];xn(n,a).isInitialized()&&(this._updatedAttributes.add(a),this._updatedAttributesTmp.add(a),this._allUsedAttributes.add(a))}},An.prototype.getUsedAttributeNames=function(e){return function t(n,i,r){return void 0===i&&(i=[]),void 0===r&&(r=""),n.constructor===Ln?n.isInitialized()&&i.push(r):n.constructor===Object&&Object.keys(n).forEach(function(o){t(n[o],i,ec(r,o))}),i}(e.outputFlexArrays)},An.prototype.redrawElements=function(e){this._elementsToRedraw.add(e)},An.prototype.redrawAll=function(){this._elementsToRedraw.addAll()},An.prototype.getAndResetElementsToRedraw=function(){return this._elementsToRedraw.getListAndClear()},An.prototype.getAndResetElementsUpdated=function(){return this._elementsUpdated.getListAndClear()},An.prototype.getAndResetAttributesUpdated=function(){var e=du(this._updatedAttributes);return this._updatedAttributes.clear(),e},An.prototype.createFlexArrays=function(){return this._createFlexArrays(this._graph,{named:!1,useDefaultValues:!1})},An.prototype.getAttributeValues=function(e,t,n,i){var r=i?this._prevFlexArrays:this._currentFlexArrays;return n?this._getMultipleAttributeValues(e,t,r):this._getSingleAttributeValues(e,t,r)},An.prototype._getAccessor=function(e){void 0===e&&(e="");for(var t=this._accessors,n=Pr(e),i=0,r=n;i<r.length;i++)if(!(t=t.nested[r[i]]))throw new Error(this._eltName+' attribute "'+n.join("")+'" does not exist');return t},An.prototype._getSingleAttributeValues=function(e,t,n){for(var i=this._getAccessor(t),r=e._indexes,o=Array(r.length),a=0;a<r.length;a++)o[a]=i.get(n,r[a]);return o},An.prototype._getMultipleAttributeValues=function(e,t,n){if(!t||"all"===t)return this._getSingleAttributeValues(e,"",n);for(var i=Array(e.size),r=0;r<i.length;++r)i[r]={};for(r=0;r<t.length;r++)for(var o=t[r],a=this._getSingleAttributeValues(e,o,n),s=0;s<i.length;++s)Ht(i[s],o,a[s]);return i},An.prototype.setAnimationAttributes=function(e,t){var n=t.duration,i=t.startTime,r=t.easing,o=e._indexes,a=this._finalFlexArraysWrapped.animationDuration,s=this._finalFlexArraysWrapped.animationStart,l=this._finalFlexArraysWrapped.animationEasing,u=du(this._allUsedAttributes);if(n){for(var d=!1,c=0,h=u;c<h.length;c++){var p=h[c];if("x"!==p&&"y"!==p)for(var g=xn(this._finalFlexArrays,p),m=xn(this._prevFlexArrays,p),b=0;b<o.length;b++){var v=o[b];m.set(v,g.get(v))}else d=!0}if(d){var y=R(),S=this._finalFlexArrays.x,A=this._finalFlexArrays.y,C=this._prevFlexArrays.x,O=this._prevFlexArrays.y;for(b=0;b<o.length;b++){var N=a.get(v=o[b]);if(N){var P=s.get(v),F=l.get(v),L=(If[F]||Mf)(Math.min((y-P)/N,1)),B=Nt(C.get(v),S.get(v),L),Y=Nt(O.get(v),A.get(v),L);C.set(v,B),O.set(v,Y)}else C.set(v,S.get(v)),O.set(v,A.get(v))}}}a.fill(o,n),s.fill(o,i),l.fill(o,r)},An.prototype.resetAnimationAttributes=function(e){this._finalFlexArraysWrapped.animationDuration.fill(e._indexes,0)},An.prototype.getUsedAttributes=function(){return du(this._allUsedAttributes)},An.prototype.getDefaultFlexArrays=function(){return this._defaultFlexArrays},An.prototype._assignAttributesToFlexArrays=function(e,t,n,i,r,o){if(void 0===o&&(o=[]),"function"==typeof i)for(var a=o.join("."),s=0;s<n.size;++s){var l=i(m=n.get(s),r,a);this._assignSingleValueToFlexArray(t,m,e,l,o)}else if(Jt(i)){var u=Object.keys(i);for(s=0;s<u.length;++s){var d=u[s];o.push(d);var c=this._getNestedAccessor(e,d,o);this._assignAttributesToFlexArrays(c,t,n,i[d],r,o),o.pop()}}else if((Array.isArray(i)||ArrayBuffer.isView(i))&&"color"!==o[0])if(o.length)for(s=0;s<n.size;++s){var p=n._indexes[s],g=e.check(i[s],this._colorManager);e.set(t,p,g)}else for(s=0;s<n.size;++s)this._assignSingleValueToFlexArray(t,n.get(s),e,i[s],o);else for(g=e.check(i,this._colorManager),s=0;s<n.size;++s){var m=n.get(s);e.set(t,m._index,g)}},An.prototype._getNestedAccessor=function(e,t,n){var i=e.nested[t];if(!i)throw new Error(this._eltName+' attribute "'+n.join(".")+'" does not exist');return i},An.prototype._assignSingleValueToFlexArray=function(e,t,n,i,r){if(Jt(i))for(var o=0,a=Object.keys(i);o<a.length;o++){var s=a[o];r.push(s);var l=i[s],u=this._getNestedAccessor(n,s,r);this._assignSingleValueToFlexArray(e,t,u,l,r),r.pop()}else{var d=n.check(i,this._colorManager);n.set(e,t._index,d)}},An);function An(e,t,n,i){this._lastFlexArrays=null,this._updatedAttributes=new Set,this._updatedAttributesTmp=new Set,this._allUsedAttributes=new Set,this._colorManager=t,this._graph=e,this._eltName=n?"node":"edge",this._accessors=n?ix:rx,this._createFlexArrays=i,this._finalFlexArrays=this._createFlexArrays(this._graph,{named:!0,useDefaultValues:!0}),this._prevFlexArrays=this._createFlexArrays(this._graph,{named:!1,useDefaultValues:!0}),this._defaultFlexArrays=this._createFlexArrays(this._graph,{named:!1,useDefaultValues:!0}),this._currentFlexArrays=this._defaultFlexArrays,this.setLastFlexArrays(this._defaultFlexArrays),this._elementsToRedraw=new _l({graph:this._graph,isNode:n,includeRemovedElements:!0}),this._elementsUpdated=new _l({graph:this._graph,isNode:n,includeRemovedElements:!1}),this._finalFlexArraysWrapped=Mt({},this._finalFlexArrays,{excluded:this._graph.getAttribute(n,"excluded"),textHidden:this._graph.getAttribute(n,"textHidden"),animationStart:this._graph.createAttribute(n,ox),animationDuration:this._graph.createAttribute(n,ax),animationEasing:this._graph.createAttribute(n,sx),id:this._graph.getAttribute(n,"id")},!n&&{source:this._graph.getEdgeAttribute("source"),target:this._graph.getEdgeAttribute("target")})}function gx(e,t){var n=t.named,i=t.useDefaultValues,r="resource";return{x:e.createAttribute(!0,{storage:"any",default:i?0:void 0,name:n?"x":void 0}),y:e.createAttribute(!0,{storage:"any",default:i?0:void 0,name:n?"y":void 0}),radius:e.createAttribute(!0,{storage:r,default:i?5:void 0,name:n?"radius":void 0}),scalingMethod:e.createAttribute(!0,{storage:r,default:i?"scaled":void 0,name:n?"scalingMethod":void 0}),color:e.createAttribute(!0,{storage:r,default:i?"grey":void 0,name:n?"color":void 0}),opacity:e.createAttribute(!0,{storage:r,default:i?1:void 0,name:n?"opacity":void 0}),shape:e.createAttribute(!0,{storage:r,default:i?"circle":void 0,name:n?"shape":void 0}),layer:e.createAttribute(!0,{storage:r,default:i?0:void 0,name:n?"layer":void 0}),detectable:e.createAttribute(!0,{storage:r,default:!!i||void 0,name:n?"detectable":void 0}),draggable:e.createAttribute(!0,{storage:r,default:!!i||void 0,name:n?"draggable":void 0}),layoutable:e.createAttribute(!0,{storage:r,default:!!i||void 0,name:n?"layoutable":void 0}),innerStroke:{width:e.createAttribute(!0,{storage:r,default:i?2:void 0,name:n?"innerStroke.width":void 0}),scalingMethod:e.createAttribute(!0,{storage:r,default:i?"fixed":void 0,name:n?"innerStroke.scalingMethod":void 0}),color:e.createAttribute(!0,{storage:r,default:i?"white":void 0,name:n?"innerStroke.color":void 0}),minVisibleSize:e.createAttribute(!0,{storage:r,default:i?12:void 0,name:n?"innerStroke.minVisibleSize":void 0})},outerStroke:{width:e.createAttribute(!0,{storage:r,default:i?5:void 0,name:n?"outerStroke.width":void 0}),scalingMethod:e.createAttribute(!0,{storage:r,default:i?"fixed":void 0,name:n?"outerStroke.scalingMethod":void 0}),color:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"outerStroke.color":void 0}),minVisibleSize:e.createAttribute(!0,{storage:r,default:i?0:void 0,name:n?"outerStroke.minVisibleSize":void 0})},badges:{topLeft:{color:e.createAttribute(!0,{storage:r,default:i?"white":void 0,name:n?"badges.topLeft.color":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?.45:void 0,name:n?"badges.topLeft.scale":void 0}),positionScale:e.createAttribute(!0,{storage:r,default:i?1:void 0,name:n?"badges.topLeft.positionScale":void 0}),minVisibleSize:e.createAttribute(!0,{storage:r,default:i?12:void 0,name:n?"badges.topLeft.minVisibleSize":void 0}),image:{url:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"badges.topLeft.image.url":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?1:void 0,name:n?"badges.topLeft.image.scale":void 0})},stroke:{color:e.createAttribute(!0,{storage:r,default:i?"black":void 0,name:n?"badges.topLeft.stroke.color":void 0}),width:e.createAttribute(!0,{storage:r,default:i?2:void 0,name:n?"badges.topLeft.stroke.width":void 0}),scalingMethod:e.createAttribute(!0,{storage:r,default:i?"fixed":void 0,name:n?"badges.topLeft.stroke.scalingMethod":void 0})},text:{content:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"badges.topLeft.text.content":void 0}),color:e.createAttribute(!0,{storage:r,default:i?"black":void 0,name:n?"badges.topLeft.text.color":void 0}),font:e.createAttribute(!0,{storage:r,default:i?"Arial":void 0,name:n?"badges.topLeft.text.font":void 0}),style:e.createAttribute(!0,{storage:r,default:i?"normal":void 0,name:n?"badges.topLeft.text.style":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?.5:void 0,name:n?"badges.topLeft.text.scale":void 0})}},topRight:{color:e.createAttribute(!0,{storage:r,default:i?"white":void 0,name:n?"badges.topRight.color":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?.45:void 0,name:n?"badges.topRight.scale":void 0}),positionScale:e.createAttribute(!0,{storage:r,default:i?1:void 0,name:n?"badges.topRight.positionScale":void 0}),minVisibleSize:e.createAttribute(!0,{storage:r,default:i?12:void 0,name:n?"badges.topRight.minVisibleSize":void 0}),image:{url:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"badges.topRight.image.url":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?1:void 0,name:n?"badges.topRight.image.scale":void 0})},stroke:{color:e.createAttribute(!0,{storage:r,default:i?"black":void 0,name:n?"badges.topRight.stroke.color":void 0}),width:e.createAttribute(!0,{storage:r,default:i?2:void 0,name:n?"badges.topRight.stroke.width":void 0}),scalingMethod:e.createAttribute(!0,{storage:r,default:i?"fixed":void 0,name:n?"badges.topRight.stroke.scalingMethod":void 0})},text:{content:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"badges.topRight.text.content":void 0}),color:e.createAttribute(!0,{storage:r,default:i?"black":void 0,name:n?"badges.topRight.text.color":void 0}),font:e.createAttribute(!0,{storage:r,default:i?"Arial":void 0,name:n?"badges.topRight.text.font":void 0}),style:e.createAttribute(!0,{storage:r,default:i?"normal":void 0,name:n?"badges.topRight.text.style":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?.5:void 0,name:n?"badges.topRight.text.scale":void 0})}},bottomLeft:{color:e.createAttribute(!0,{storage:r,default:i?"white":void 0,name:n?"badges.bottomLeft.color":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?.45:void 0,name:n?"badges.bottomLeft.scale":void 0}),positionScale:e.createAttribute(!0,{storage:r,default:i?1:void 0,name:n?"badges.bottomLeft.positionScale":void 0}),minVisibleSize:e.createAttribute(!0,{storage:r,default:i?12:void 0,name:n?"badges.bottomLeft.minVisibleSize":void 0}),image:{url:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"badges.bottomLeft.image.url":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?1:void 0,name:n?"badges.bottomLeft.image.scale":void 0})},stroke:{color:e.createAttribute(!0,{storage:r,default:i?"black":void 0,name:n?"badges.bottomLeft.stroke.color":void 0}),width:e.createAttribute(!0,{storage:r,default:i?2:void 0,name:n?"badges.bottomLeft.stroke.width":void 0}),scalingMethod:e.createAttribute(!0,{storage:r,default:i?"fixed":void 0,name:n?"badges.bottomLeft.stroke.scalingMethod":void 0})},text:{content:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"badges.bottomLeft.text.content":void 0}),color:e.createAttribute(!0,{storage:r,default:i?"black":void 0,name:n?"badges.bottomLeft.text.color":void 0}),font:e.createAttribute(!0,{storage:r,default:i?"Arial":void 0,name:n?"badges.bottomLeft.text.font":void 0}),style:e.createAttribute(!0,{storage:r,default:i?"normal":void 0,name:n?"badges.bottomLeft.text.style":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?.5:void 0,name:n?"badges.bottomLeft.text.scale":void 0})}},bottomRight:{color:e.createAttribute(!0,{storage:r,default:i?"white":void 0,name:n?"badges.bottomRight.color":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?.45:void 0,name:n?"badges.bottomRight.scale":void 0}),positionScale:e.createAttribute(!0,{storage:r,default:i?1:void 0,name:n?"badges.bottomRight.positionScale":void 0}),minVisibleSize:e.createAttribute(!0,{storage:r,default:i?12:void 0,name:n?"badges.bottomRight.minVisibleSize":void 0}),image:{url:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"badges.bottomRight.image.url":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?1:void 0,name:n?"badges.bottomRight.image.scale":void 0})},stroke:{color:e.createAttribute(!0,{storage:r,default:i?"black":void 0,name:n?"badges.bottomRight.stroke.color":void 0}),width:e.createAttribute(!0,{storage:r,default:i?2:void 0,name:n?"badges.bottomRight.stroke.width":void 0}),scalingMethod:e.createAttribute(!0,{storage:r,default:i?"fixed":void 0,name:n?"badges.bottomRight.stroke.scalingMethod":void 0})},text:{content:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"badges.bottomRight.text.content":void 0}),color:e.createAttribute(!0,{storage:r,default:i?"black":void 0,name:n?"badges.bottomRight.text.color":void 0}),font:e.createAttribute(!0,{storage:r,default:i?"Arial":void 0,name:n?"badges.bottomRight.text.font":void 0}),style:e.createAttribute(!0,{storage:r,default:i?"normal":void 0,name:n?"badges.bottomRight.text.style":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?.5:void 0,name:n?"badges.bottomRight.text.scale":void 0})}}},halo:{color:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"halo.color":void 0}),width:e.createAttribute(!0,{storage:r,default:i?50:void 0,name:n?"halo.width":void 0}),scalingMethod:e.createAttribute(!0,{storage:r,default:i?"fixed":void 0,name:n?"halo.scalingMethod":void 0}),strokeColor:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"halo.strokeColor":void 0}),strokeWidth:e.createAttribute(!0,{storage:r,default:i?1:void 0,name:n?"halo.strokeWidth":void 0}),clustering:e.createAttribute(!0,{storage:r,default:!i&&void 0,name:n?"halo.clustering":void 0}),hideNonAdjacentEdges:e.createAttribute(!0,{storage:r,default:!i&&void 0,name:n?"halo.hideNonAdjacentEdges":void 0})},pulse:{enabled:e.createAttribute(!0,{storage:r,default:!i&&void 0,name:n?"pulse.enabled":void 0}),duration:e.createAttribute(!0,{storage:r,default:i?1e3:void 0,name:n?"pulse.duration":void 0}),interval:e.createAttribute(!0,{storage:r,default:i?800:void 0,name:n?"pulse.interval":void 0}),startColor:e.createAttribute(!0,{storage:r,default:i?"rgba(0, 0, 0, 0.6)":void 0,name:n?"pulse.startColor":void 0}),endColor:e.createAttribute(!0,{storage:r,default:i?"rgba(0, 0, 0, 0)":void 0,name:n?"pulse.endColor":void 0}),width:e.createAttribute(!0,{storage:r,default:i?50:void 0,name:n?"pulse.width":void 0}),startRatio:e.createAttribute(!0,{storage:r,default:i?1:void 0,name:n?"pulse.startRatio":void 0}),endRatio:e.createAttribute(!0,{storage:r,default:i?2:void 0,name:n?"pulse.endRatio":void 0})},icon:{content:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"icon.content":void 0}),font:e.createAttribute(!0,{storage:r,default:i?"Arial":void 0,name:n?"icon.font":void 0}),color:e.createAttribute(!0,{storage:r,default:i?"black":void 0,name:n?"icon.color":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?.7:void 0,name:n?"icon.scale":void 0}),style:e.createAttribute(!0,{storage:r,default:i?"normal":void 0,name:n?"icon.style":void 0}),minVisibleSize:e.createAttribute(!0,{storage:r,default:i?12:void 0,name:n?"icon.minVisibleSize":void 0})},image:{url:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"image.url":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?1:void 0,name:n?"image.scale":void 0}),fit:e.createAttribute(!0,{storage:r,default:!!i||void 0,name:n?"image.fit":void 0}),tile:e.createAttribute(!0,{storage:r,default:!i&&void 0,name:n?"image.tile":void 0}),minVisibleSize:e.createAttribute(!0,{storage:r,default:i?12:void 0,name:n?"image.minVisibleSize":void 0})},outline:{enabled:e.createAttribute(!0,{storage:r,default:!i&&void 0,name:n?"outline.enabled":void 0}),color:e.createAttribute(!0,{storage:r,default:i?"rgba(0, 0, 0, 0.36)":void 0,name:n?"outline.color":void 0}),minVisibleSize:e.createAttribute(!0,{storage:r,default:i?12:void 0,name:n?"outline.minVisibleSize":void 0})},text:{content:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"text.content":void 0}),font:e.createAttribute(!0,{storage:r,default:i?"Arial":void 0,name:n?"text.font":void 0}),color:e.createAttribute(!0,{storage:r,default:i?"black":void 0,name:n?"text.color":void 0}),size:e.createAttribute(!0,{storage:r,default:i?12:void 0,name:n?"text.size":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?.1:void 0,name:n?"text.scale":void 0}),style:e.createAttribute(!0,{storage:r,default:i?"normal":void 0,name:n?"text.style":void 0}),align:e.createAttribute(!0,{storage:r,default:i?"center":void 0,name:n?"text.align":void 0}),margin:e.createAttribute(!0,{storage:r,default:i?10:void 0,name:n?"text.margin":void 0}),padding:e.createAttribute(!0,{storage:r,default:i?2:void 0,name:n?"text.padding":void 0}),backgroundColor:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"text.backgroundColor":void 0}),tip:e.createAttribute(!0,{storage:r,default:!!i||void 0,name:n?"text.tip":void 0}),minVisibleSize:e.createAttribute(!0,{storage:r,default:i?24:void 0,name:n?"text.minVisibleSize":void 0}),scaling:e.createAttribute(!0,{storage:r,default:!i&&void 0,name:n?"text.scaling":void 0}),position:e.createAttribute(!0,{storage:r,default:i?"bottom":void 0,name:n?"text.position":void 0}),maxLineLength:e.createAttribute(!0,{storage:r,default:i?0:void 0,name:n?"text.maxLineLength":void 0}),truncateLength:e.createAttribute(!0,{storage:r,default:i?0:void 0,name:n?"text.truncateLength":void 0}),secondary:{content:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"text.secondary.content":void 0}),font:e.createAttribute(!0,{storage:r,default:i?"Arial":void 0,name:n?"text.secondary.font":void 0}),color:e.createAttribute(!0,{storage:r,default:i?"black":void 0,name:n?"text.secondary.color":void 0}),size:e.createAttribute(!0,{storage:r,default:i?10:void 0,name:n?"text.secondary.size":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?.08:void 0,name:n?"text.secondary.scale":void 0}),style:e.createAttribute(!0,{storage:r,default:i?"normal":void 0,name:n?"text.secondary.style":void 0}),align:e.createAttribute(!0,{storage:r,default:i?"center":void 0,name:n?"text.secondary.align":void 0}),margin:e.createAttribute(!0,{storage:r,default:i?5:void 0,name:n?"text.secondary.margin":void 0}),padding:e.createAttribute(!0,{storage:r,default:i?2:void 0,name:n?"text.secondary.padding":void 0}),backgroundColor:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"text.secondary.backgroundColor":void 0}),minVisibleSize:e.createAttribute(!0,{storage:r,default:i?24:void 0,name:n?"text.secondary.minVisibleSize":void 0})}}}}function _x(e,t){var n=t.named,i=t.useDefaultValues,r="resource";return{width:e.createAttribute(!1,{storage:r,default:i?1:void 0,name:n?"width":void 0}),scalingMethod:e.createAttribute(!1,{storage:r,default:i?"scaled":void 0,name:n?"scalingMethod":void 0}),color:e.createAttribute(!1,{storage:r,default:i?"grey":void 0,name:n?"color":void 0}),opacity:e.createAttribute(!1,{storage:r,default:i?1:void 0,name:n?"opacity":void 0}),minVisibleSize:e.createAttribute(!1,{storage:r,default:i?0:void 0,name:n?"minVisibleSize":void 0}),layer:e.createAttribute(!1,{storage:r,default:i?0:void 0,name:n?"layer":void 0}),detectable:e.createAttribute(!1,{storage:r,default:!!i||void 0,name:n?"detectable":void 0}),curvature:e.createAttribute(!1,{storage:r,default:i?0:void 0,name:n?"curvature":void 0}),adjustAnchors:e.createAttribute(!1,{storage:r,default:!!i||void 0,name:n?"adjustAnchors":void 0}),shape:{type:e.createAttribute(!1,{storage:r,default:i?"line":void 0,name:n?"shape.type":void 0}),head:e.createAttribute(!1,{storage:r,default:i?null:void 0,name:n?"shape.head":void 0}),tail:e.createAttribute(!1,{storage:r,default:i?null:void 0,name:n?"shape.tail":void 0}),style:e.createAttribute(!1,{storage:r,default:i?"plain":void 0,name:n?"shape.style":void 0})},stroke:{color:e.createAttribute(!1,{storage:r,default:i?"inherit":void 0,name:n?"stroke.color":void 0}),width:e.createAttribute(!1,{storage:r,default:i?0:void 0,name:n?"stroke.width":void 0}),scalingMethod:e.createAttribute(!1,{storage:r,default:i?"fixed":void 0,name:n?"stroke.scalingMethod":void 0}),minVisibleSize:e.createAttribute(!1,{storage:r,default:i?0:void 0,name:n?"stroke.minVisibleSize":void 0})},halo:{color:e.createAttribute(!1,{storage:r,default:i?null:void 0,name:n?"halo.color":void 0}),width:e.createAttribute(!1,{storage:r,default:i?10:void 0,name:n?"halo.width":void 0}),scalingMethod:e.createAttribute(!1,{storage:r,default:i?"fixed":void 0,name:n?"halo.scalingMethod":void 0})},pulse:{enabled:e.createAttribute(!1,{storage:r,default:!i&&void 0,name:n?"pulse.enabled":void 0}),duration:e.createAttribute(!1,{storage:r,default:i?1e3:void 0,name:n?"pulse.duration":void 0}),interval:e.createAttribute(!1,{storage:r,default:i?800:void 0,name:n?"pulse.interval":void 0}),startColor:e.createAttribute(!1,{storage:r,default:i?"rgba(0, 0, 0, 0.6)":void 0,name:n?"pulse.startColor":void 0}),endColor:e.createAttribute(!1,{storage:r,default:i?"rgba(0, 0, 0, 0)":void 0,name:n?"pulse.endColor":void 0}),width:e.createAttribute(!1,{storage:r,default:i?10:void 0,name:n?"pulse.width":void 0}),startRatio:e.createAttribute(!1,{storage:r,default:i?1:void 0,name:n?"pulse.startRatio":void 0}),endRatio:e.createAttribute(!1,{storage:r,default:i?2:void 0,name:n?"pulse.endRatio":void 0})},outline:{enabled:e.createAttribute(!1,{storage:r,default:!i&&void 0,name:n?"outline.enabled":void 0}),color:e.createAttribute(!1,{storage:r,default:i?"rgba(0, 0, 0, 0.36)":void 0,name:n?"outline.color":void 0}),minVisibleSize:e.createAttribute(!1,{storage:r,default:i?0:void 0,name:n?"outline.minVisibleSize":void 0})},text:{content:e.createAttribute(!1,{storage:r,default:i?null:void 0,name:n?"text.content":void 0}),font:e.createAttribute(!1,{storage:r,default:i?"Arial":void 0,name:n?"text.font":void 0}),color:e.createAttribute(!1,{storage:r,default:i?"black":void 0,name:n?"text.color":void 0}),size:e.createAttribute(!1,{storage:r,default:i?12:void 0,name:n?"text.size":void 0}),scale:e.createAttribute(!1,{storage:r,default:i?1:void 0,name:n?"text.scale":void 0}),style:e.createAttribute(!1,{storage:r,default:i?"normal":void 0,name:n?"text.style":void 0}),align:e.createAttribute(!1,{storage:r,default:i?"center":void 0,name:n?"text.align":void 0}),margin:e.createAttribute(!1,{storage:r,default:i?2:void 0,name:n?"text.margin":void 0}),padding:e.createAttribute(!1,{storage:r,default:i?2:void 0,name:n?"text.padding":void 0}),backgroundColor:e.createAttribute(!1,{storage:r,default:i?null:void 0,name:n?"text.backgroundColor":void 0}),minVisibleSize:e.createAttribute(!1,{storage:r,default:i?4:void 0,name:n?"text.minVisibleSize":void 0}),adjustAngle:e.createAttribute(!1,{storage:r,default:!!i||void 0,name:n?"text.adjustAngle":void 0}),scaling:e.createAttribute(!1,{storage:r,default:!i&&void 0,name:n?"text.scaling":void 0}),maxLineLength:e.createAttribute(!1,{storage:r,default:i?0:void 0,name:n?"text.maxLineLength":void 0}),secondary:{content:e.createAttribute(!1,{storage:r,default:i?null:void 0,name:n?"text.secondary.content":void 0}),font:e.createAttribute(!1,{storage:r,default:i?"Arial":void 0,name:n?"text.secondary.font":void 0}),color:e.createAttribute(!1,{storage:r,default:i?"black":void 0,name:n?"text.secondary.color":void 0}),size:e.createAttribute(!1,{storage:r,default:i?12:void 0,name:n?"text.secondary.size":void 0}),scale:e.createAttribute(!1,{storage:r,default:i?.8:void 0,name:n?"text.secondary.scale":void 0}),style:e.createAttribute(!1,{storage:r,default:i?"normal":void 0,name:n?"text.secondary.style":void 0}),align:e.createAttribute(!1,{storage:r,default:i?"center":void 0,name:n?"text.secondary.align":void 0}),margin:e.createAttribute(!1,{storage:r,default:i?2:void 0,name:n?"text.secondary.margin":void 0}),padding:e.createAttribute(!1,{storage:r,default:i?2:void 0,name:n?"text.secondary.padding":void 0}),backgroundColor:e.createAttribute(!1,{storage:r,default:i?null:void 0,name:n?"text.secondary.backgroundColor":void 0}),minVisibleSize:e.createAttribute(!1,{storage:r,default:i?4:void 0,name:n?"text.secondary.minVisibleSize":void 0})}}}}var mx=(tn.prototype._getLayerById=function(e){for(var t=0;t<this._layers.length;++t){var n=this._layers[t];if(n.id===e)return n.index=t,n}throw new Error("usage of a destroyed style rule or class")},tn.prototype._fetch=function(e){return e.isNode?this._nodes:this._edges},tn.prototype.getFlexArrays=function(){return{nodes:{current:this._nodes.getAttributeFlexArrays(),previous:this._nodes.getPrevAttributeFlexArrays()},edges:{current:this._edges.getAttributeFlexArrays(),previous:this._edges.getPrevAttributeFlexArrays()}}},tn.prototype.createFlexArrays=function(){return{nodes:this._nodes.createFlexArrays(),edges:this._edges.createFlexArrays()}},tn.prototype.clear=function(){this._updateOngoing=!1,this._needUpdate=!1,this._destroyedLayers=[],this._nodes.clear(),this._edges.clear(),this.updateAllForAllAttributeLayers()},tn.prototype.redrawElements=function(e){e.size&&(this._fetch(e).redrawElements(e),this._dom.refresh())},tn.prototype.redrawAll=function(){this._nodes.redrawAll(),this._edges.redrawAll(),this._dom.refresh()},tn.prototype._triggerUpdate=function(){this._needUpdate=!0,this._dom.refresh()},tn.prototype._reconstructAttributeLayersIfNecessary=function(){return!!this._layersNeedUpdate&&(this._reconstructAttributeLayers(),this._layersNeedUpdate=!1,this._dom.refresh(),!0)},tn.prototype.getAnimationInformation=function(e){return this._fetch(e).getAnimationInformation(e)},tn.prototype.update=function(){if(!this._needUpdate||this._updateOngoing||!this._ogma._token)return!1;this._reconstructAttributeLayersIfNecessary(),this._updateOngoing=!0,this._nodes.startUpdate(),this._edges.startUpdate();for(var e=0,t=this._destroyedLayers;e<t.length;e++)(r=t[e]).initialized&&(this._nodes.notifyLayerDestroyed(r.nodes),this._edges.notifyLayerDestroyed(r.edges));for(var n=0,i=this._layers;n<i.length;n++){var r,o=(r=i[n]).nodes,a=r.edges;this._nodes.prepareFlexArraysUpdate(o),this._edges.prepareFlexArraysUpdate(a),this._nodes.updateFlexArrays(o),this._edges.updateFlexArrays(a)}return this._nodes.endUpdate(),this._edges.endUpdate(),this._updateOngoing=!1,!(this._needUpdate=!1)},tn.prototype.setAttributeLayerValues=function(e,t,n,i){var r=this._getLayerById(e),o=t.isNode?r.nodes:r.edges;this._reconstructAttributeLayersIfNecessary(),this._fetch(t).setAttributeValues(o,t,n,i),this._updateElementsForAttributeLayers([r],t)},tn.prototype.getAttributeLayerFlexArrays=function(e){var t=this._getLayerById(e);return{nodes:t.nodes.outputFlexArrays,edges:t.edges.outputFlexArrays}},tn.prototype.getUsedAttributeLayerAttributes=function(e,t){var n=this._getLayerById(e);return this._fetch(t).getUsedAttributeNames(t.isNode?n.nodes:n.edges)},tn.prototype.getAndResetElementsUpdated=function(){return{nodes:this._nodes.getAndResetElementsUpdated(),edges:this._edges.getAndResetElementsUpdated(),nodeAttributes:this._nodes.getAndResetAttributesUpdated(),edgeAttributes:this._edges.getAndResetAttributesUpdated()}},tn.prototype.getAndResetElementsToRedraw=function(){return{nodes:this._nodes.getAndResetElementsToRedraw(),edges:this._edges.getAndResetElementsToRedraw()}},tn.prototype.addAttributeLayer=function(e){if(void 0===e&&(e={}),e.name&&this._layers.find(function(n){return n.name===e.name}))throw new Error('attribute layer with name "'+e.name+'" already exists');var t={id:++this._layerIdCounter,name:e.name,tag:e.tag,priority:0,depsNodeSelf:[],depsNodeAdjacentNodes:[],depsNodeAdjacentEdges:[],depsNodeAllNodes:[],depsNodeAllEdges:[],depsEdgeSelf:[],depsEdgeExtremities:[],depsEdgeParallelEdges:[],depsEdgeAllNodes:[],depsEdgeAllEdges:[],initialized:!1,nodes:{type:"node",name:e.name,standaloneSelector:!!e.standaloneSelectors,toUpdate:new _l({graph:this._graph,isNode:!0,includeRemovedElements:!1}),outputFlexArrays:this._nodes.createFlexArrays(),inputFlexArrays:null,formattedDependencies:null,formattedOutput:null},edges:{type:"edge",name:e.name,standaloneSelector:!!e.standaloneSelectors,toUpdate:new _l({graph:this._graph,isNode:!1,includeRemovedElements:!1}),outputFlexArrays:this._edges.createFlexArrays(),inputFlexArrays:null,formattedDependencies:null,formattedOutput:null}};return this._layers.push(t),this._updateLayer(t,e),new K0(this,this._layerIdCounter)},tn.prototype._reconstructAttributeLayers=function(){this._layers.sort(function(B,Y){return B.priority-Y.priority});for(var e=rn(this._nodes.getDefaultFlexArrays()),t=rn(this._edges.getDefaultFlexArrays()),n=bi(e),i=bi(t),r=0,o=this._layers;r<o.length;r++)(L=o[r]).nodes.allAttributePaths=n,L.edges.allAttributePaths=i,L.nodes.formattedDependencies=hx(L.nodes),L.edges.formattedDependencies=px(L.edges),L.nodes.formattedOutput=Nf(L.nodes,L.tag),L.edges.formattedOutput=Nf(L.edges,L.tag),L.nodes.redrawAdjacentEdges=L.nodes.formattedOutput.attributes.some(function(B){return dx[B]}),L.initialized=!0;for(var a=0,s=this._layers;a<s.length;a++){(L=s[a]).nodes.inputFlexArrays=rn(e),L.edges.inputFlexArrays=rn(t),L.depsNodeSelf=[],L.depsNodeAdjacentNodes=[],L.depsNodeAdjacentEdges=[],L.depsNodeAllNodes=[],L.depsNodeAllEdges=[],L.depsEdgeSelf=[],L.depsEdgeExtremities=[],L.depsEdgeParallelEdges=[],L.depsEdgeAllNodes=[],L.depsEdgeAllEdges=[],L.nodes.toUpdate.addAll(),L.edges.toUpdate.addAll();for(var l=0,u=L.nodes.formattedOutput.attributes;l<u.length;l++){var d=xn(e,p=u[l]);(g=xn(L.nodes.outputFlexArrays,p)).setFallback(d),Ht(e,p,g)}for(var c=0,h=L.edges.formattedOutput.attributes;c<h.length;c++){var p,g;d=xn(t,p=h[c]),(g=xn(L.edges.outputFlexArrays,p)).setFallback(d),Ht(t,p,g)}for(var m=0,b=this._layers;m<b.length;m++){var v=b[m];if(L!==v){var y=L.priority,S=v.priority,A=L.nodes.formattedOutput,C=L.edges.formattedOutput,O=v.nodes.formattedDependencies,N=v.edges.formattedDependencies;yo(L.depsNodeSelf,v,A,O.self,y,S),yo(L.depsNodeAdjacentNodes,v,A,O.adjacentNodes,y,S),yo(L.depsNodeAdjacentEdges,v,C,N.extremities,y,S),yo(L.depsNodeAllNodes,v,A,O.allNodes,y,S),yo(L.depsNodeAllEdges,v,C,N.allNodes,y,S),yo(L.depsEdgeSelf,v,C,N.self,y,S),yo(L.depsEdgeExtremities,v,A,O.adjacentEdges,y,S),yo(L.depsEdgeParallelEdges,v,C,N.parallelEdges,y,S),yo(L.depsEdgeAllNodes,v,A,O.allEdges,y,S),yo(L.depsEdgeAllEdges,v,C,N.allEdges,y,S)}}}this._nodes.setLastFlexArrays(e),this._edges.setLastFlexArrays(t);for(var P=0,F=this._layers;P<F.length;P++){var L;(L=F[P]).nodes.needAdjacentElements=L.nodes.redrawAdjacentEdges||0<L.depsNodeAdjacentNodes.length||0<L.depsNodeAdjacentEdges.length,L.edges.needAdjacentElements=0<L.depsEdgeExtremities.length||0<L.depsEdgeParallelEdges.length}},tn.prototype._updateLayer=function(e,t){void 0===t&&(t={});var n=t.priority,i=t.fullOverwrite,r=t.nodeAttributes,o=t.nodeSelector,a=t.nodeContext,s=t.nodeDependencies,l=t.nodeOutput,u=t.edgeAttributes,d=t.edgeSelector,c=t.edgeContext,h=t.edgeDependencies,p=t.edgeOutput;void 0!==r&&(e.nodes.attributes=i?r:tr(e.nodes.attributes,r)),void 0!==o&&(e.nodes.selector=o),void 0!==a&&(e.nodes.context=a),void 0!==s&&(e.nodes.dependencies=s),void 0!==l&&(e.nodes.output=l),void 0!==u&&(e.edges.attributes=i?u:tr(e.edges.attributes,u)),void 0!==d&&(e.edges.selector=d),void 0!==c&&(e.edges.context=c),void 0!==h&&(e.edges.dependencies=h),void 0!==p&&(e.edges.output=p),void 0!==n&&(e.priority=n),this._triggerLayerUpdate()},tn.prototype._triggerLayerUpdate=function(){this._layersNeedUpdate=!0,this._triggerUpdate()},tn.prototype.updateAllForAttributeLayer=function(e){var t=this._getLayerById(e);this._updateAllForAttributeLayer(t)},tn.prototype.updateAllForAllAttributeLayers=function(){for(var e=0,t=this._layers;e<t.length;e++)this._updateAllForAttributeLayer(t[e])},tn.prototype._updateAllForAttributeLayer=function(e,t,n){if(void 0===t&&(t=!0),void 0===n&&(n=!0),t&&!e.nodes.toUpdate.isFull()){e.nodes.toUpdate.addAll();for(var i=0,r=e.depsNodeSelf;i<r.length;i++){var o=r[i];this._updateAllForAttributeLayer(o,!0,!1)}for(var a=0,s=e.depsNodeAdjacentNodes;a<s.length;a++)this._updateAllForAttributeLayer(o=s[a],!0,!1);for(var l=0,u=e.depsNodeAdjacentEdges;l<u.length;l++)this._updateAllForAttributeLayer(o=u[l],!1,!0);for(var d=0,c=e.depsNodeAllNodes;d<c.length;d++)this._updateAllForAttributeLayer(o=c[d],!0,!1);for(var h=0,p=e.depsNodeAllEdges;h<p.length;h++)this._updateAllForAttributeLayer(o=p[h],!1,!0)}if(n&&!e.edges.toUpdate.isFull()){e.edges.toUpdate.addAll();for(var g=0,m=e.depsEdgeSelf;g<m.length;g++)this._updateAllForAttributeLayer(o=m[g],!1,!0);for(var b=0,v=e.depsEdgeExtremities;b<v.length;b++)this._updateAllForAttributeLayer(o=v[b],!0,!1);for(var y=0,S=e.depsEdgeParallelEdges;y<S.length;y++)this._updateAllForAttributeLayer(o=S[y],!1,!0);for(var A=0,C=e.depsEdgeAllNodes;A<C.length;A++)this._updateAllForAttributeLayer(o=C[A],!0,!1);for(var O=0,N=e.depsEdgeAllEdges;O<N.length;O++)this._updateAllForAttributeLayer(o=N[O],!1,!0)}this._triggerUpdate()},tn.prototype.updateElementsForAttributeLayer=function(e,t){var n=this._getLayerById(e);this._updateElementsForAttributeLayers([n],t)},tn.prototype.updateForAllAttributeLayers=function(e){this._updateElementsForAttributeLayers(this._layers,e)},tn.prototype._updateElementsForAttributeLayers=function(e,t){var n=null;if(t.isNode){for(var i=0,r=e;i<r.length;i++)if(!(y=r[i]).nodes.toUpdate.isFull()){y.nodes.needAdjacentElements&&(n=n||t.fastGetAdjacentElements()),y.nodes.toUpdate.add(t);for(var o=0,a=y.depsNodeSelf;o<a.length;o++)(p=a[o]).nodes.toUpdate.add(t);for(var s=0,l=y.depsNodeAdjacentNodes;s<l.length;s++)(p=l[s]).nodes.toUpdate.add(n.nodes);for(var u=0,d=y.depsNodeAdjacentEdges;u<d.length;u++)(p=d[u]).edges.toUpdate.add(n.edges);for(var c=0,h=y.depsNodeAllNodes;c<h.length;c++){var p=h[c];this._updateAllForAttributeLayer(p,!0,!1)}for(var g=0,m=y.depsNodeAllEdges;g<m.length;g++)this._updateAllForAttributeLayer(p=m[g],!1,!0);y.nodes.redrawAdjacentEdges&&this._edges.redrawElements(n.edges)}}else for(var b=0,v=e;b<v.length;b++){var y;if(!(y=v[b]).edges.toUpdate.isFull()){y.edges.needAdjacentElements&&(n=n||t.fastGetAdjacentElements()),y.edges.toUpdate.add(t);for(var S=0,A=y.depsEdgeSelf;S<A.length;S++)(p=A[S]).edges.toUpdate.add(t);for(var C=0,O=y.depsEdgeExtremities;C<O.length;C++)(p=O[C]).nodes.toUpdate.add(n.nodes);for(var N=0,P=y.depsEdgeParallelEdges;N<P.length;N++)(p=P[N]).edges.toUpdate.add(n.edges);for(var F=0,L=y.depsEdgeAllNodes;F<L.length;F++)this._updateAllForAttributeLayer(p=L[F],!0,!1);for(var B=0,Y=y.depsEdgeAllEdges;B<Y.length;B++)this._updateAllForAttributeLayer(p=Y[B],!1,!0)}}this._triggerUpdate()},tn.prototype.destroyAttributeLayer=function(e){var t=this._getLayerById(e);this._destroyedLayers.push(t),this._layers.splice(t.index,1),this._triggerLayerUpdate()},tn.prototype.updateAttributeLayer=function(e,t){var n=this._getLayerById(e);this._updateLayer(n,t)},tn.prototype.getAttributeLayerDefinition=function(e){var t=this._getLayerById(e),i=t.nodes,r=t.edges;return{priority:t.priority,nodeAttributes:i.attributes,nodeSelector:i.selector,nodeContext:i.context,nodeDependencies:i.dependencies,nodeOutput:i.output,edgeAttributes:r.attributes,edgeSelector:r.selector,edgeContext:r.context,edgeDependencies:r.dependencies,edgeOutput:r.output}},tn.prototype.getAttributeValues=function(e,t,n,i){return this.update(),this._fetch(e).getAttributeValues(e,t,n,i)},tn.prototype.setAnimationAttributes=function(e,t){var i=e.edges;this._nodes.setAnimationAttributes(e.nodes,t),this._edges.setAnimationAttributes(i,t)},tn.prototype.resetAnimationAttributes=function(e){var n=e.edges;this._nodes.resetAnimationAttributes(e.nodes),this._edges.resetAnimationAttributes(n)},tn.prototype.setTextHidden=function(e,t){var n=this._textHiddenSet.addOrRemoveElements(e,t);this.redrawElements(n)},tn.prototype.resetTextHidden=function(){var e=this._textHiddenSet.getElements(),t=e.nodes,n=e.edges;this._textHiddenSet.clear(),this._nodes.redrawElements(t),this._edges.redrawElements(n)},tn.prototype.getUsedNodeAttributes=function(){return this._nodes.getUsedAttributes()},tn.prototype.getUsedEdgeAttributes=function(){return this._edges.getUsedAttributes()},tn);function tn(e,t,n){this._colorManager=new ou,this._layerIdCounter=0,this._layers=[],this._destroyedLayers=[],this._layersNeedUpdate=!1,this._updateOngoing=!1,this._needUpdate=!1,this._ogma=n,this._graph=e,this._dom=t,this._textHiddenSet=new hu(this._graph,"textHidden"),this._nodes=new Ff(e,this._colorManager,!0,gx),this._edges=new Ff(e,this._colorManager,!1,_x)}function ro(e,t,n){return void 0===n&&(n=0),"inherit"===e?Array.isArray(t)?t[n/(2*Math.PI)*t.length|0]:t:e}function El(e,t){var n=e(),i=bi(n).map(function(r){var o=xn(n,r);return Array.isArray(o)?"for (var i = 0; i < "+o.length+"; ++i) {\n        target."+r+"[i] = source."+r+"[i]."+t+";\n      }\n      return target;":"target."+r+" = source."+r+"."+t+";"}).join("\n");return new Function("source, target",i)}function Pf(e){var t=e(),n=bi(t).map(function(i){var r=xn(t,i);return Array.isArray(r)?"for (var i = 0; i < "+r.length+"; ++i) {\n        target."+i+"[i] = target."+i+"[i] || source."+i+"[i];\n      }":"target."+i+" = target."+i+" || source."+i+";"}).join("\n");return new Function("target","source",n)}function Df(e){var t=(e.getDepth()-3)%6;return 0<=t&&0!==t&&3!==t}function Rf(e,t,n,i){var r,o,a,s,l,u,d,c,h,p;r=e,o=t,l=+("scaled"===(a=n).scalingMethod.get(s=i)),u=2*a.radius.get(s),d=a.innerStroke.width.get(s),c=+("scaled"===a.innerStroke.scalingMethod.get(s)),h=a.outerStroke.width.get(s),p=+("scaled"===a.outerStroke.scalingMethod.get(s)),o.x=a.x.get(s),o.y=a.y.get(s),o.shape=a.shape.get(s),o.color=a.color.get(s),o.opacity=a.opacity.get(s),o.diameterScaled=u*l,o.diameterFixed=u*(1-l),o.innerStroke.color=ro(a.innerStroke.color.get(s),o.color),o.innerStroke.widthScaled=d*c,o.innerStroke.widthFixed=d*(1-c),o.innerStroke.minVisibleSize=a.innerStroke.minVisibleSize.get(s),o.outerStroke.color=ro(a.outerStroke.color.get(s),o.color),o.outerStroke.widthScaled=h*p,o.outerStroke.widthFixed=h*(1-p),o.halo.color=a.halo.color.get(s),o.halo.strokeColor=a.halo.strokeColor.get(s),o.icon.content=r.formatText(a.icon.content.get(s)),o.image.url=a.image.url.get(s),o.outline.enabled=a.outline.enabled.get(s),o.textHidden=!!a.textHidden.get(s),zf(e,t.texts.primary,n.text,i,t),zf(e,t.texts.secondary,n.text.secondary,i,t),Sl(e,t.badges.topLeft,n.badges.topLeft,i),Sl(e,t.badges.topRight,n.badges.topRight,i),Sl(e,t.badges.bottomLeft,n.badges.bottomLeft,i),Sl(e,t.badges.bottomRight,n.badges.bottomRight,i)}function zf(e,t,n,i,r){if(t.hidden=r.textHidden,t.content=e.formatText(n.content.get(i)),t.backgroundColor=ro(n.backgroundColor.get(i),r.color),t===r.texts.primary){var o=n;t.tip=o.tip.get(i),t.position=o.position.get(i)}else t.position="bottom"}function Sl(e,t,n,i){t.textContent=e.formatText(n.text.content.get(i)),t.imageUrl=n.image.url.get(i)}function Bf(){return{x:0,y:0,shape:"",color:"",opacity:0,diameterScaled:0,diameterFixed:0,innerStroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},outerStroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},icon:{content:"",font:"",color:"",scale:0,size:0,style:"none",minVisibleSize:0},image:{url:"",content:null,scale:0,rescale:!1,duplicate:!1,minVisibleSize:0},halo:{widthScaled:0,widthFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,color:"",strokeColor:""},outline:{enabled:!1,color:"",minVisibleSize:0},badges:{topLeft:Al(Yp),topRight:Al(Xp),bottomLeft:Al(Jp),bottomRight:Al(Qp)},textHidden:!1,texts:{primary:{hidden:!1,content:"",position:"",backgroundColor:"",tip:!1,font:"",color:"",sizeScaled:0,sizeFixed:0,style:"none",align:"left",minVisibleSize:0,margin:0,padding:0,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,isPositionCenter:!1,isPositionVertical:!1,isPositionHorizontal:!1},secondary:{hidden:!1,content:"",position:"",backgroundColor:"",tip:!1,font:"",color:"",sizeScaled:0,sizeFixed:0,style:"none",align:"left",minVisibleSize:0,margin:0,padding:0,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,isPositionCenter:!1,isPositionVertical:!1,isPositionHorizontal:!1}}}}function Al(e){return{angle:e,color:"",scale:0,positionScale:0,minVisibleSize:0,strokeColor:"",strokeWidthScaled:0,strokeWidthFixed:0,textContent:"",textFont:"",textColor:"",textScale:0,textStyle:"none",imageUrl:"",imageContent:null,imageScale:0}}function xu(e,t){var n=t||{edgeHalo:0,nodeHaloStroke:0,nodeHalo:0,edgeBody:0,edgeTextBackground:0,edgeText:0,nodeBody:0,nodeTextBackground:0,nodeText:0},i=6*(e- -1)+3;return n.edgeHalo=0,n.nodeHaloStroke=1,n.nodeHalo=2,n.edgeBody=i+0,n.edgeTextBackground=i+1,n.edgeText=i+2,n.nodeBody=i+3,n.nodeTextBackground=i+4,n.nodeText=i+5,n}function Uf(e,t){var n,i;i=t,(n=e).body=!0,n.icon=!!i.icon.content,n.image=!!i.image.url,n.pieChart=Array.isArray(i.color),n.outerStroke=!!i.outerStroke.color,n.outline=!!i.outline.enabled,n.halo=!!i.halo.color,n.haloStroke=n.halo&&!!i.halo.strokeColor,jf(e.texts.primary,t.texts.primary),jf(e.texts.secondary,t.texts.secondary),wl(e.badges.topLeft,t.badges.topLeft),wl(e.badges.topRight,t.badges.topRight),wl(e.badges.bottomLeft,t.badges.bottomLeft),wl(e.badges.bottomRight,t.badges.bottomRight)}function jf(e,t){e.text=!t.hidden&&!!t.content,e.background=e.text&&!!t.backgroundColor,e.tip=e.background&&t.tip&&"center"!==t.position}function wl(e,t){e.text=!!t.textContent,e.image=!!t.imageUrl}function Cl(e,t){e.pieceId=1,e.x1=t.x,e.y1=t.y,e.x2=t.x,e.y2=t.y,e.rectWidthOrSourceRadiusScaled=t.diameterScaled,e.rectWidthOrSourceRadiusFixed=t.diameterFixed,e.rectHeightOrTargetRadiusScaled=t.diameterScaled,e.rectHeightOrTargetRadiusFixed=t.diameterFixed,e.shape=t.shape,e.opacity=t.opacity,e.symbolicSize=t.diameterScaled,e.thicknessOrFontSizeScaled=0,e.thicknessOrFontSizeFixed=0,e.strokeWidthScaled=0,e.strokeWidthFixed=0,e.offsetScaled=0,e.offsetFixed=0,e.fillColor=null,e.strokeColor=null,e.globalMinVisibleSize=0,e.strokeMinVisibleSize=0,e.offsetAngle=0,e.curvature=0,e.dashLength=0,e.gapLength=0,e.hasHead=!1,e.hasTail=!1,e.isSelfLoop=!1,e.isText=!1}function Zf(e,t,n){var i=n.diameterScaled*t.scale,r=n.diameterFixed*t.scale,o=n.diameterScaled*t.positionScale/2,a=n.diameterFixed*t.positionScale/2;e.pieceId=1,e.shape="circle",e.x1=n.x,e.y1=n.y,e.x2=n.x,e.y2=n.y,e.rectWidthOrSourceRadiusScaled=i,e.rectWidthOrSourceRadiusFixed=r,e.rectHeightOrTargetRadiusScaled=i,e.rectHeightOrTargetRadiusFixed=r,e.thicknessOrFontSizeScaled=0,e.thicknessOrFontSizeFixed=0,e.strokeWidthScaled=t.strokeWidthScaled,e.strokeWidthFixed=t.strokeWidthFixed,e.offsetScaled=o,e.offsetFixed=a,e.pattern.type=0,e.opacity=n.opacity,e.fillColor=t.color,e.strokeColor=t.strokeColor,e.patternColor=null,e.globalMinVisibleSize=t.minVisibleSize,e.strokeMinVisibleSize=0,e.patternMinVisibleSize=0,e.offsetAngle=t.angle,e.patternScale=0,e.symbolicSize=n.diameterScaled,e.curvature=0,e.dashLength=0,e.gapLength=0,e.hasHead=!1,e.hasTail=!1,e.isSelfLoop=!1,e.isText=!1}function Gf(e,t,n){var i,r,o=0,a=0;if(t.isPositionCenter||(o+=n.innerStroke.widthScaled+n.outerStroke.widthScaled+n.diameterScaled/2,a+=n.innerStroke.widthFixed+n.outerStroke.widthFixed+n.diameterFixed/2+t.margin+t.padding),t.isPositionVertical){if(o+=t.heightScaled/2,a+=t.heightFixed/2,t===n.texts.secondary&&"bottom"===n.texts.primary.position){var s=n.texts.primary;o+=s.heightScaled,a+=s.heightFixed+s.margin+2*s.padding}}else t.isPositionHorizontal&&(o+=t.widthScaled/2,a+=t.widthFixed/2);r=0<t.sizeScaled?(i="sdf",1):(i=t.sizeFixed,0),e.pieceId=1,e.shape="square",e.x1=n.x,e.y1=n.y,e.x2=n.x,e.y2=n.y,e.rectWidthOrSourceRadiusScaled=t.widthScaled,e.rectWidthOrSourceRadiusFixed=t.widthFixed+2*t.padding,e.rectHeightOrTargetRadiusScaled=t.heightScaled,e.rectHeightOrTargetRadiusFixed=t.heightFixed+2*t.padding,e.thicknessOrFontSizeScaled=0,e.thicknessOrFontSizeFixed=0,e.strokeWidthScaled=0,e.strokeWidthFixed=0,e.offsetScaled=o,e.offsetFixed=a,e.pattern.type=0,e.pattern.attributes.size=i,e.opacity=n.opacity,e.fillColor=null,e.strokeColor=null,e.patternColor=null,e.globalMinVisibleSize=t.minVisibleSize,e.strokeMinVisibleSize=0,e.patternMinVisibleSize=0,e.offsetAngle=t.positionAngle,e.patternScale=r,e.symbolicSize=n.diameterScaled,e.curvature=0,e.dashLength=0,e.gapLength=0,e.hasHead=!1,e.hasTail=!1,e.isSelfLoop=!1,e.isText=!1}function qf(e,t,n,i,r,o){var a=r.badges,s=i.badges,l=o.badges;(function(u,d,c,h,p){if(h.halo){var g=c.halo.width.get(d),m=+("scaled"===c.halo.scalingMethod.get(d));p.halo.widthScaled=g*m,p.halo.widthFixed=g*(1-m),S=(y=p).diameterScaled+2*y.halo.widthScaled,A=y.diameterFixed+2*y.halo.widthFixed,(v=h.halo).pieceId=1,v.shape="circle",v.x1=y.x,v.y1=y.y,v.x2=y.x,v.y2=y.y,v.rectWidthOrSourceRadiusScaled=S,v.rectWidthOrSourceRadiusFixed=A,v.rectHeightOrTargetRadiusScaled=S,v.rectHeightOrTargetRadiusFixed=A,v.thicknessOrFontSizeScaled=0,v.thicknessOrFontSizeFixed=0,v.strokeWidthScaled=0,v.strokeWidthFixed=0,v.offsetScaled=0,v.offsetFixed=0,v.pattern.type=0,v.opacity=y.opacity,v.fillColor=y.halo.color,v.strokeColor=null,v.patternColor=null,v.globalMinVisibleSize=0,v.strokeMinVisibleSize=0,v.patternMinVisibleSize=0,v.offsetAngle=0,v.patternScale=0,v.symbolicSize=y.diameterScaled,v.curvature=0,v.dashLength=0,v.gapLength=0,v.hasHead=!1,v.hasTail=!1,v.isSelfLoop=!1,v.isText=!1,h.haloStroke&&(p.halo.strokeWidthScaled=0,p.halo.strokeWidthFixed=c.halo.strokeWidth.get(d),function(v,y){var S=y.diameterScaled+2*y.halo.widthScaled,A=y.diameterFixed+2*y.halo.widthFixed;v.pieceId=1,v.shape="circle",v.x1=y.x,v.y1=y.y,v.x2=y.x,v.y2=y.y,v.rectWidthOrSourceRadiusScaled=S,v.rectWidthOrSourceRadiusFixed=A,v.rectHeightOrTargetRadiusScaled=S,v.rectHeightOrTargetRadiusFixed=A,v.thicknessOrFontSizeScaled=0,v.thicknessOrFontSizeFixed=0,v.strokeWidthScaled=y.halo.strokeWidthScaled,v.strokeWidthFixed=y.halo.strokeWidthFixed,v.offsetScaled=0,v.offsetFixed=0,v.pattern.type=0,v.opacity=y.opacity,v.fillColor=null,v.strokeColor=y.halo.strokeColor,v.patternColor=null,v.globalMinVisibleSize=0,v.strokeMinVisibleSize=0,v.patternMinVisibleSize=0,v.offsetAngle=0,v.patternScale=0,v.symbolicSize=y.diameterScaled,v.curvature=0,v.dashLength=0,v.gapLength=0,v.hasHead=!1,v.hasTail=!1,v.isSelfLoop=!1,v.isText=!1}(h.haloStroke,p))}var v,y,S,A;h.outline&&(p.outline.color=c.outline.color.get(d),p.outline.minVisibleSize=c.outline.minVisibleSize.get(d),function(v,y){var S=1.1*y.diameterScaled,A=1.1*y.diameterFixed,C=.07*y.diameterScaled,O=.07*y.diameterFixed+1;y.outerStroke.color&&(C+=y.outerStroke.widthScaled/2,O+=y.outerStroke.widthFixed/2),v.pieceId=1,v.shape=y.shape,v.x1=y.x,v.y1=y.y,v.x2=y.x,v.y2=y.y,v.rectWidthOrSourceRadiusScaled=S,v.rectWidthOrSourceRadiusFixed=A,v.rectHeightOrTargetRadiusScaled=S,v.rectHeightOrTargetRadiusFixed=A,v.thicknessOrFontSizeScaled=0,v.thicknessOrFontSizeFixed=0,v.strokeWidthScaled=0,v.strokeWidthFixed=0,v.offsetScaled=C,v.offsetFixed=O,v.pattern.type=0,v.opacity=y.opacity,v.fillColor=y.outline.color,v.strokeColor=null,v.patternColor=null,v.globalMinVisibleSize=y.outline.minVisibleSize,v.strokeMinVisibleSize=0,v.patternMinVisibleSize=0,v.offsetAngle=1.5707963267948966,v.patternScale=0,v.symbolicSize=y.diameterScaled,v.curvature=0,v.dashLength=0,v.gapLength=0,v.hasHead=!1,v.hasTail=!1,v.isSelfLoop=!1,v.isText=!1}(h.outline,p)),h.outerStroke&&(p.outerStroke.minVisibleSize=c.outerStroke.minVisibleSize.get(d),function(v,y){var S=y.diameterScaled+2*y.innerStroke.widthScaled,A=y.diameterFixed+2*y.innerStroke.widthFixed;v.pieceId=1,v.shape=y.shape,v.x1=y.x,v.y1=y.y,v.x2=y.x,v.y2=y.y,v.rectWidthOrSourceRadiusScaled=S,v.rectWidthOrSourceRadiusFixed=A,v.rectHeightOrTargetRadiusScaled=S,v.rectHeightOrTargetRadiusFixed=A,v.thicknessOrFontSizeScaled=0,v.thicknessOrFontSizeFixed=0,v.strokeWidthScaled=y.outerStroke.widthScaled,v.strokeWidthFixed=y.outerStroke.widthFixed,v.offsetScaled=0,v.offsetFixed=0,v.pattern.type=0,v.opacity=y.opacity,v.fillColor=null,v.strokeColor=y.outerStroke.color,v.patternColor=null,v.globalMinVisibleSize=y.outerStroke.minVisibleSize,v.strokeMinVisibleSize=0,v.patternMinVisibleSize=0,v.offsetAngle=0,v.patternScale=0,v.symbolicSize=y.diameterScaled,v.curvature=0,v.dashLength=0,v.gapLength=0,v.hasHead=!1,v.hasTail=!1,v.isSelfLoop=!1,v.isText=!1}(h.outerStroke,p)),h.pieChart&&function(v,y){Cl(v,y),Array.isArray(y.color)&&(v.pattern.type=4,v.pattern.attributes.colors=y.color.join(";"),v.patternScale=1,v.patternMinVisibleSize=0,v.patternColor=null)}(h.pieChart,p),h.image&&(p.image.content=u.imageManager.getImage(p.image.url),p.image.fit=c.image.fit.get(d),p.image.tile=c.image.tile.get(d),p.image.scale=c.image.scale.get(d),p.image.minVisibleSize=c.image.minVisibleSize.get(d),function(v,y){var S=y.image.fit&&!y.image.tile;Cl(v,y),v.pattern.type=2,v.pattern.attributes.image=y.image.content,v.pattern.attributes.scaled=S,v.pattern.attributes.duplicated=y.image.tile,v.patternScale=S?y.image.scale:0,v.patternMinVisibleSize=y.image.minVisibleSize,v.patternColor=null}(h.image,p)),h.icon&&(p.icon.font=u.fontManager.getFont(c.icon.font.get(d)),p.icon.style=c.icon.style.get(d),p.icon.color=c.icon.color.get(d),p.icon.scale=c.icon.scale.get(d),p.icon.minVisibleSize=c.icon.minVisibleSize.get(d),function(v,y){Cl(v,y),v.pattern.type=5,v.pattern.attributes.text=y.icon.content,v.pattern.attributes.font=y.icon.font,v.pattern.attributes.style=y.icon.style,v.pattern.attributes.size="sdf",v.patternMinVisibleSize=y.icon.minVisibleSize,v.patternColor=y.icon.color,v.patternScale=y.icon.scale}(h.icon,p)),h.body&&function(v,y,S){Cl(v,y),v.fillColor=Array.isArray(y.color)?null:y.color,v.strokeColor=y.innerStroke.color,v.strokeMinVisibleSize=y.innerStroke.minVisibleSize,v.strokeWidthScaled=y.innerStroke.widthScaled,v.strokeWidthFixed=y.innerStroke.widthFixed,S&&(v.pattern.type=0)}(h.body,p,!h.pieChart&&!h.image&&!h.icon)})(t,n,i,r,o),Hf(e,t,n,i.text,r.texts.primary,o.texts.primary,o),Hf(e,t,n,i.text.secondary,r.texts.secondary,o.texts.secondary,o),Tl(e,t,n,s.topLeft,a.topLeft,l.topLeft,o),Tl(e,t,n,s.topRight,a.topRight,l.topRight,o),Tl(e,t,n,s.bottomLeft,a.bottomLeft,l.bottomLeft,o),Tl(e,t,n,s.bottomRight,a.bottomRight,l.bottomRight,o)}function Tl(e,t,n,i,r,o,a){if(r.image||r.text){var s=i.stroke.width.get(n),l=+("scaled"===i.stroke.scalingMethod.get(n));o.color=ro(i.color.get(n),a.color,o.angle),o.strokeColor=i.stroke.color.get(n),o.strokeWidthScaled=s*l,o.strokeWidthFixed=s*(1-l),o.minVisibleSize=i.minVisibleSize.get(n),o.positionScale=i.positionScale.get(n),o.scale=i.scale.get(n)}var u,d,c,h;if(r.image&&(o.imageContent=t.imageManager.getImage(o.imageUrl),o.imageScale=i.image.scale.get(n),Zf(u=r.image,d=o,a),d.imageContent?(u.pattern.type=2,u.pattern.attributes.image=d.imageContent,u.pattern.attributes.scaled=!0,u.pattern.attributes.duplicated=!1,u.patternScale=d.imageScale,u.patternMinVisibleSize=0,u.patternColor=null):(u.fillColor=null,u.strokeColor=null)),r.text){if(o.textFont=t.fontManager.getFont(i.text.font.get(n)),o.textStyle=i.text.style.get(n),o.textColor=ro(i.text.color.get(n),a.color),o.textScale=i.text.scale.get(n),1<e.measureText(o.textContent,o.textFont,o.textStyle,o.textScale).width){for(var p=0,g=0;g<o.textContent.length&&p<1;)p+=e.measureText(o.textContent[g],o.textFont,o.textStyle,o.textScale).width,g+=1;g!==o.textContent.length&&(o.textContent=o.textContent.substring(0,g-1)+"\u2025")}Zf(c=r.text,h=o,a),h.textContent&&(c.pattern.type=6,c.pattern.attributes.text=h.textContent,c.pattern.attributes.font=h.textFont,c.pattern.attributes.style=h.textStyle,c.pattern.attributes.size="sdf",c.patternMinVisibleSize=0,c.patternColor=h.textColor,c.patternScale=h.textScale),!h.imageUrl&&h.textContent||(c.fillColor=null,c.strokeColor=null)}}function Hf(e,t,n,i,r,o,a){if(r.text){var s=i,l=s.scaling.get(n);if(o.font=t.fontManager.getFont(s.font.get(n)),o.color=ro(s.color.get(n),a.color),o.style=s.style.get(n),o.align=s.align.get(n),o.minVisibleSize=s.minVisibleSize.get(n),o.margin=s.margin.get(n),o.padding=s.padding.get(n),o.maxLineLength=s.maxLineLength.get(n),o.content=Bd(o.content,o.maxLineLength),l){var u=s.scale.get(n);o.sizeScaled=a.diameterScaled*u,o.sizeFixed=a.diameterFixed*u}else o.sizeFixed=s.size.get(n),o.sizeScaled=0;var d=e.measureText(o.content,o.font,o.style);o.widthScaled=d.width*o.sizeScaled,o.widthFixed=d.width*o.sizeFixed,o.heightScaled=d.height*o.sizeScaled,o.heightFixed=d.height*o.sizeFixed,o.positionAngle=F0[o.position],o.isPositionCenter="center"===o.position,o.isPositionVertical="top"===o.position||"bottom"===o.position,o.isPositionHorizontal="left"===o.position||"right"===o.position,Gf(O=r.text,N=o,a),O.pattern.type=7,O.pattern.attributes.text=N.content,O.pattern.attributes.font=N.font,O.pattern.attributes.style=N.style,O.pattern.attributes.align=N.align,O.patternMinVisibleSize=0,O.patternColor=N.color,O.thicknessOrFontSizeScaled=N.sizeScaled,O.thicknessOrFontSizeFixed=N.sizeFixed,O.isText=!0,r.background&&(Gf(A=r.background,C=o,a),A.fillColor=C.backgroundColor,r.tip&&(c=r.tip,h=o,p=a,g=Math.ceil(h.margin/2)+1,m=p.diameterScaled/2+p.innerStroke.widthScaled+p.outerStroke.widthScaled,b=p.diameterFixed/2+p.innerStroke.widthFixed+p.outerStroke.widthFixed+g,v=P0[h.position],y=Math.cos(v),S=Math.sin(v),c.pieceId=1,c.shape="triangle",c.x1=p.x-y,c.y1=p.y-S,c.x2=p.x+y,c.y2=p.y+S,c.rectWidthOrSourceRadiusScaled=0,c.rectWidthOrSourceRadiusFixed=h.margin,c.rectHeightOrTargetRadiusScaled=0,c.rectHeightOrTargetRadiusFixed=.6666666666666666*h.margin,c.thicknessOrFontSizeScaled=0,c.thicknessOrFontSizeFixed=0,c.strokeWidthScaled=0,c.strokeWidthFixed=0,c.offsetScaled=m,c.offsetFixed=b,c.pattern.type=0,c.opacity=p.opacity,c.fillColor=h.backgroundColor,c.strokeColor=null,c.patternColor=null,c.globalMinVisibleSize=h.minVisibleSize,c.strokeMinVisibleSize=0,c.patternMinVisibleSize=0,c.offsetAngle=h.positionAngle,c.patternScale=0,c.symbolicSize=p.diameterScaled,c.curvature=0,c.dashLength=0,c.gapLength=0,c.hasHead=!1,c.hasTail=!1,c.isSelfLoop=!1))}var c,h,p,g,m,b,v,y,S,A,C,O,N}var vx=El(Ea,"start"),yx=El(Ea,"end"),xx=Pf(Ea),bx=(Tr.prototype.drawNode=function(e){if(this._computeBlockIds(e),this._attributes.excluded.get(e))return this._freeBlocks();var t=this._engine,n=this._helper,i=e,r=xu(this._attributes.layer.get(e),this._depthInfo),o=this._attributes.animationDuration.get(e),a=0<o;if(this._prepareBlocks(a,r,i),Rf(n,this._endInput,this._attributes,e),Uf(this._endFlags,this._endInput),a&&(Rf(n,this._startInput,this._attributesPrev,e),Uf(this._startFlags,this._startInput),xx(this._endFlags,this._startFlags)),this._initComponents(this._fullComponents,this._endFlags,this._blocks),yx(this._fullComponents,this._endComponents),qf(t,n,e,this._attributes,this._endComponents,this._endInput),a&&(vx(this._fullComponents,this._startComponents),qf(t,n,e,this._attributesPrev,this._startComponents,this._startInput)),a){var s=this._attributes.animationStart.get(e),l=this._attributes.animationEasing.get(e);this._setBlocksAnimation(o,s,l)}this._endFlags.halo&&this._attributes.halo.hideNonAdjacentEdges.get(e)&&(this._blocks.halo.setStencilUsage(2),this._blocks.haloStroke.setStencilUsage(2)),this._storeBlocks()},Tr.prototype._computeBlockIds=function(e){var t=10*e,n=this._blockIds;n.body=0+t,n.text=1+t,n.textBg=2+t,n.halo=3+t,n.haloStroke=4+t},Tr.prototype._prepareBlocks=function(e,t,n){var i=this._blocks;i.body.reset(1,e,t.nodeBody,n),i.text.reset(2,e,t.nodeText,n),i.textBg.reset(1,e,t.nodeTextBackground,n),i.halo.reset(1,e,t.nodeHalo,n),i.haloStroke.reset(1,e,t.nodeHaloStroke,n)},Tr.prototype._storeBlocks=function(){var e=this._engine,t=this._blocks,n=this._blockIds;e.storeBlock(n.body,t.body),e.storeBlock(n.text,t.text),e.storeBlock(n.textBg,t.textBg),e.storeBlock(n.halo,t.halo),e.storeBlock(n.haloStroke,t.haloStroke)},Tr.prototype._freeBlocks=function(){var e=this._engine,t=this._blockIds;e.freeBlock(t.body),e.freeBlock(t.text),e.freeBlock(t.textBg),e.freeBlock(t.halo),e.freeBlock(t.haloStroke)},Tr.prototype._setBlocksAnimation=function(e,t,n){var i=this._blocks;i.body.setGlobalAnimation(e,t,n),i.text.setGlobalAnimation(e,t,n),i.textBg.setGlobalAnimation(e,t,n),i.halo.setGlobalAnimation(e,t,n),i.haloStroke.setGlobalAnimation(e,t,n)},Tr.prototype._initComponents=function(e,t,n){this._nodePatternAssigned=!1,this._initBaseComponents(e,t,n),this._initBadgeComponents(e.badges.topLeft,t.badges.topLeft,n),this._initBadgeComponents(e.badges.topRight,t.badges.topRight,n),this._initBadgeComponents(e.badges.bottomLeft,t.badges.bottomLeft,n),this._initBadgeComponents(e.badges.bottomRight,t.badges.bottomRight,n),this._initTextComponents(e.texts.primary,t.texts.primary,n),this._initTextComponents(e.texts.secondary,t.texts.secondary,n)},Tr.prototype._initBaseComponents=function(e,t,n){e.haloStroke=this._nextElement(t.haloStroke,n.haloStroke),e.halo=this._nextElement(t.halo,n.halo),e.outline=this._nextElement(t.outline,n.body),e.outerStroke=this._nextElement(t.outerStroke,n.body),e.body=this._nextElement(t.body,n.body),e.pieChart=this._getNodePatternElement(t.pieChart,n),e.image=this._getNodePatternElement(t.image,n),e.icon=this._getNodePatternElement(t.icon,n)},Tr.prototype._initBadgeComponents=function(e,t,n){e.image=this._nextElement(t.image,n.body),e.text=this._nextElement(t.text,n.body)},Tr.prototype._initTextComponents=function(e,t,n){e.background=this._nextElement(t.background,n.textBg),e.tip=this._nextElement(t.tip,n.textBg),e.text=this._nextElement(t.text,n.text)},Tr.prototype._nextElement=function(e,t){return e?t.next():this._nullElt},Tr.prototype._getNodePatternElement=function(e,t){return e?this._nodePatternAssigned?t.body.next():(this._nodePatternAssigned=!0,t.body.getCurrentElement()):this._nullElt},Tr);function Tr(e){var t=e.engine,n=e.imageManager,i=e.fontManager,r=e.formatText,o=e.attributes,a=e.attributesPrev;this._fullComponents={haloStroke:void 0,halo:void 0,outline:void 0,outerStroke:void 0,body:void 0,pieChart:void 0,image:void 0,icon:void 0,badges:{topLeft:{text:void 0,image:void 0},topRight:{text:void 0,image:void 0},bottomLeft:{text:void 0,image:void 0},bottomRight:{text:void 0,image:void 0}},texts:{primary:{text:void 0,background:void 0,tip:void 0},secondary:{text:void 0,background:void 0,tip:void 0}}},this._startComponents={haloStroke:void 0,halo:void 0,outline:void 0,outerStroke:void 0,body:void 0,pieChart:void 0,image:void 0,icon:void 0,badges:{topLeft:{text:void 0,image:void 0},topRight:{text:void 0,image:void 0},bottomLeft:{text:void 0,image:void 0},bottomRight:{text:void 0,image:void 0}},texts:{primary:{text:void 0,background:void 0,tip:void 0},secondary:{text:void 0,background:void 0,tip:void 0}}},this._endComponents={haloStroke:void 0,halo:void 0,outline:void 0,outerStroke:void 0,body:void 0,pieChart:void 0,image:void 0,icon:void 0,badges:{topLeft:{text:void 0,image:void 0},topRight:{text:void 0,image:void 0},bottomLeft:{text:void 0,image:void 0},bottomRight:{text:void 0,image:void 0}},texts:{primary:{text:void 0,background:void 0,tip:void 0},secondary:{text:void 0,background:void 0,tip:void 0}}},this._startFlags={haloStroke:void 0,halo:void 0,outline:void 0,outerStroke:void 0,body:void 0,pieChart:void 0,image:void 0,icon:void 0,badges:{topLeft:{text:void 0,image:void 0},topRight:{text:void 0,image:void 0},bottomLeft:{text:void 0,image:void 0},bottomRight:{text:void 0,image:void 0}},texts:{primary:{text:void 0,background:void 0,tip:void 0},secondary:{text:void 0,background:void 0,tip:void 0}}},this._endFlags={haloStroke:void 0,halo:void 0,outline:void 0,outerStroke:void 0,body:void 0,pieChart:void 0,image:void 0,icon:void 0,badges:{topLeft:{text:void 0,image:void 0},topRight:{text:void 0,image:void 0},bottomLeft:{text:void 0,image:void 0},bottomRight:{text:void 0,image:void 0}},texts:{primary:{text:void 0,background:void 0,tip:void 0},secondary:{text:void 0,background:void 0,tip:void 0}}},this._startInput=Bf(),this._endInput=Bf(),this._depthInfo={edgeHalo:0,nodeHaloStroke:0,nodeHalo:0,edgeBody:0,edgeTextBackground:0,edgeText:0,nodeBody:0,nodeTextBackground:0,nodeText:0},this._nodePatternAssigned=!1,this._nullElt={id:-1,valid:!0,animation:null,start:null,end:null},this._engine=t,this._attributes=o,this._attributesPrev=a,this._helper={imageManager:n,fontManager:i,formatText:r},this._blocks=Wf(function(){return t.createBlock()}),this._blockIds=Wf(function(){return 0})}function Wf(e){return{body:e(),text:e(),textBg:e(),halo:e(),haloStroke:e()}}function Ea(){return{haloStroke:void 0,halo:void 0,outline:void 0,outerStroke:void 0,body:void 0,pieChart:void 0,image:void 0,icon:void 0,badges:{topLeft:{text:void 0,image:void 0},topRight:{text:void 0,image:void 0},bottomLeft:{text:void 0,image:void 0},bottomRight:{text:void 0,image:void 0}},texts:{primary:{text:void 0,background:void 0,tip:void 0},secondary:{text:void 0,background:void 0,tip:void 0}}}}function sc(e,t,n,i,r,o){var a,s,l,u,d,c,h,p,g;return s=i-e,l=r-t,n+o<(u=Math.sqrt(s*s+l*l))||u<Math.abs(n-o)?null:(g=t+l*(a=(n*n-o*o+u*u)/(2*u))/u,[[(p=e+s*a/u)+(c=(d=Math.sqrt(n*n-a*a))/u*-l),g+(h=d/u*s)],[p-c,g-h]])}function uc(e,t,n,i,r,o){if(0<=e-r&&n-r<0)return 1;if(e-r<0&&0<=n-r)return-1;if(e-r==0&&n-r==0)return 0<=t-i||0<=i-o?t-i:i-t;var a=(e-r)*(i-o)-(n-r)*(t-o);return a<0?1:0<a?-1:(e-r)*(e-r)+(t-o)*(t-o)-((n-r)*(n-r)+(i-o)*(i-o))}function Yf(e,t,n){var r=e[1],o=e[2],a=Math.abs(e[0]-t),s=Math.abs(r-n);return a+s<=o||!(o<a||o<s)&&Math.sqrt(a*a+s*s)<o+1e-12}function Xf(e,t,n,i){var r=e[0]-t,o=e[1]-n,a=e[2]-i;return r*r+o*o<a*a+1e-6}function lc(e,t,n,i,r,o,a){var s=e-Math.max(i,Math.min(o,e)),l=t-Math.max(r,Math.min(a,t));return s*s+l*l<n*n}function Jf(e,t,n,i,r,o,a,s){void 0===s&&(s={x:0,y:0});var l,u,d,c,h=s||{x:0,y:0};if(n===e){var p=e-r,g=a*a-p*p;if(g<0)return null;var m=Math.sqrt(g);d=l=e,u=o+m,c=o-m}else{var b=(i-t)/(n-e),v=t-b*e,y=v-o,S=b*b+1,A=2*(b*y-r),C=A*A-4*S*(r*r+y*y-a*a);if(C<0)return null;var O=-A,N=Math.sqrt(C),P=2*S;u=b*(l=(O+N)/P)+v,c=b*(d=(O-N)/P)+v}var F=e-l,L=t-u,B=e-d,Y=t-c;return F*F+L*L<B*B+Y*Y?(h.x=l,h.y=u):(h.x=d,h.y=c),h}function Qf(e,t,n,i,r,o){(function(a,s,l,u,d){var _t,c=u.source,h=u.target,p=s.source.get(l),g=s.target.get(l),m=c.x.get(p),b=c.y.get(p),v=c.radius.get(p),y=c.color.get(p),S=+("scaled"===c.scalingMethod.get(p)),A=h.x.get(g),C=h.y.get(g),O=h.radius.get(g),N=h.color.get(g),P=+("scaled"===h.scalingMethod.get(g)),F="source"===(_t=s.color.get(l))?y:"target"===_t?N:_t,L=s.width.get(l),B=+("scaled"===s.scalingMethod.get(l)),Y=s.stroke.width.get(l),X=+("scaled"===s.stroke.scalingMethod.get(l)),ae=L0[s.shape.style.get(l)],ie=s.adjustAnchors.get(l);if(a.source=p,a.target=g,a.sourceX=m,a.sourceY=b,a.targetX=A,a.targetY=C,a.sourceRadiusScaled=v*S,a.sourceRadiusFixed=v*(1-S),a.targetRadiusScaled=O*P,a.targetRadiusFixed=O*(1-P),a.widthScaled=L*B,a.widthFixed=L*(1-B),a.curvature=s.curvature.get(l),a.isSelfLoop=p===g,a.color=F,a.opacity=s.opacity.get(l),a.minVisibleSize=s.minVisibleSize.get(l),a.shape.type=s.shape.type.get(l),a.shape.head=s.shape.head.get(l),a.shape.tail=s.shape.tail.get(l),a.shape.dashLength=ae.dash,a.shape.gapLength=ae.gap,a.shape.isBodyTriangle="triangle"===a.shape.type,a.stroke.color=ro(s.stroke.color.get(l),F),a.stroke.widthScaled=Y*X,a.stroke.widthFixed=Y*(1-X),a.stroke.minVisibleSize=s.stroke.minVisibleSize.get(l),a.halo.color=s.halo.color.get(l),a.outline.enabled=s.outline.enabled.get(l),a.textHidden=1===s.textHidden.get(l),ie&&(a.shape.head||a.shape.tail||"triangle"===a.shape.type)){var U=a,W=U.curvature,ce=U.sourceX,he=U.sourceY,Ee=U.targetX,Te=U.targetY,it=1,rt=1;if(W){if(!U.isSelfLoop){var We=fa(ce,he,Ee,Te,W/2);it=Ml(0,d,c,p,ce,he,We.x,We.y),rt=Ml(0,d,h,g,Ee,Te,We.x,We.y)}}else it=Ml(0,d,c,p,ce,he,Ee,Te),rt=Ml(0,d,h,g,Ee,Te,ce,he);a.sourceRadiusScaled*=it,a.sourceRadiusFixed*=it,a.targetRadiusScaled*=rt,a.targetRadiusFixed*=rt}})(t,n,i,r,o),Kf(e,t.texts.primary,n.text,i,t),Kf(e,t.texts.secondary,n.text.secondary,i,t)}function Kf(e,t,n,i,r){t.hidden=r.textHidden,t.content=e.formatText(n.content.get(i)),t.backgroundColor=ro(n.backgroundColor.get(i),r.color)}function Ml(e,t,n,i,r,o,a,s){var l=t.angle,u=Math.atan2(s-o,a-r)-l,d=1,c=0,h=null;u<-Br?u+=gu:Br<u&&(u-=gu),h=u<-Br/2?(c=Yp,n.badges.topLeft):u<0?(c=Xp,n.badges.topRight):u<Br/2?(c=Qp,n.badges.bottomRight):(c=Jp,n.badges.bottomLeft),c+=l;var p,g=h.text.content.get(i),m=h.image.url.get(i);if((p=g)||0===p||m){var b=h.positionScale.get(i),v=h.scale.get(i),y=Jf(a,s,r,o,r+(O=Math.cos(c))*b,o+(N=Math.sin(c))*b,v);if(y){var S=y.x-r,A=y.y-o,C=Math.sqrt(S*S+A*A);d=Math.max(d,C)}}if("square"===n.shape.get(i)){var O=Math.abs(Math.cos(u)),N=Math.abs(Math.sin(u)),P=1/Math.max(O,N);d=Math.max(d,P)}return d}function tg(e,t){dc(e.body,t,!0,!0),dc(e.outline,t,t.outline.enabled,!0),dc(e.halo,t,!!t.halo.color,!1),ng(e.texts.primary,t.texts.primary),ng(e.texts.secondary,t.texts.secondary)}function dc(e,t,n,i){e.body=n,e.head=n&&i&&!!t.shape.head,e.tail=n&&i&&!!t.shape.tail}function ng(e,t){e.text=!t.hidden&&!!t.content,e.background=e.text&&!!t.backgroundColor}function Ex(e,t,n,i){cc(e,t,n,i),e.thicknessOrFontSizeScaled=t.widthScaled,e.thicknessOrFontSizeFixed=t.widthFixed,e.strokeWidthScaled=t.stroke.widthScaled,e.strokeWidthFixed=t.stroke.widthFixed,e.offsetScaled=0,e.offsetFixed=0,e.fillColor=t.color,e.strokeColor=t.stroke.color,e.globalMinVisibleSize=t.minVisibleSize,e.strokeMinVisibleSize=t.stroke.minVisibleSize,e.offsetAngle=0,e.symbolicSize=t.widthScaled,e.dashLength=t.shape.dashLength,e.gapLength=t.shape.gapLength,e.hasHead=!!t.shape.head,e.hasTail=!!t.shape.tail,e.isBodyTriangle=t.shape.isBodyTriangle}function cc(e,t,n,i){e.pieceId=n,e.shape=i,e.x1=t.sourceX,e.y1=t.sourceY,e.x2=t.targetX,e.y2=t.targetY,e.rectWidthOrSourceRadiusScaled=t.sourceRadiusScaled,e.rectWidthOrSourceRadiusFixed=t.sourceRadiusFixed,e.rectHeightOrTargetRadiusScaled=t.targetRadiusScaled,e.rectHeightOrTargetRadiusFixed=t.targetRadiusFixed,e.thicknessOrFontSizeScaled=0,e.thicknessOrFontSizeFixed=0,e.strokeWidthScaled=0,e.strokeWidthFixed=0,e.offsetScaled=0,e.offsetFixed=0,e.pattern.type=0,e.opacity=t.opacity,e.fillColor=null,e.strokeColor=null,e.patternColor=null,e.globalMinVisibleSize=t.minVisibleSize,e.strokeMinVisibleSize=null,e.patternMinVisibleSize=0,e.offsetAngle=0,e.patternScale=0,e.symbolicSize=t.widthScaled,e.curvature=t.curvature,e.dashLength=0,e.gapLength=0,e.hasHead=!1,e.hasTail=!1,e.isSelfLoop=t.isSelfLoop,e.isText=!1}function Sx(e,t,n){var i=t.widthScaled+2*t.halo.widthScaled,r=t.widthFixed+2*t.halo.widthFixed;cc(e,t,n,"line"),e.thicknessOrFontSizeScaled=i,e.thicknessOrFontSizeFixed=r,e.strokeWidthScaled=0,e.strokeWidthFixed=0,e.offsetScaled=0,e.offsetFixed=0,e.fillColor=t.halo.color,e.strokeColor=null,e.globalMinVisibleSize=t.minVisibleSize,e.strokeMinVisibleSize=0,e.offsetAngle=0,e.symbolicSize=t.widthScaled,e.dashLength=0,e.gapLength=0,e.hasHead=!1,e.hasTail=!1,e.isBodyTriangle=!1}function Ax(e,t,n,i){cc(e,t,n,i),e.thicknessOrFontSizeScaled=1*t.widthScaled,e.thicknessOrFontSizeFixed=1*t.widthFixed,e.strokeWidthScaled=0,e.strokeWidthFixed=0,e.offsetScaled=.17*t.widthScaled,e.offsetFixed=.17*t.widthFixed+1,e.fillColor=t.outline.color,e.strokeColor=null,e.globalMinVisibleSize=Math.max(t.minVisibleSize,t.outline.minVisibleSize),e.strokeMinVisibleSize=0,e.offsetAngle=Math.PI/2,e.symbolicSize=t.widthScaled,e.dashLength=t.shape.dashLength,e.gapLength=t.shape.gapLength,e.hasHead=!!t.shape.head,e.hasTail=!!t.shape.tail,e.isBodyTriangle=t.shape.isBodyTriangle}function ig(e,t,n){var i=(n.widthScaled+t.heightScaled)/2+n.stroke.widthScaled,r=(n.widthFixed+t.heightFixed)/2+n.stroke.widthFixed+t.padding+t.margin;e.pieceId=5,e.shape="square",e.x1=n.sourceX,e.y1=n.sourceY,e.x2=n.targetX,e.y2=n.targetY,e.rectWidthOrSourceRadiusScaled=t.widthScaled,e.rectWidthOrSourceRadiusFixed=t.widthFixed+2*t.padding+1,e.rectHeightOrTargetRadiusScaled=t.heightScaled,e.rectHeightOrTargetRadiusFixed=t.heightFixed+2*t.padding,e.thicknessOrFontSizeScaled=0,e.thicknessOrFontSizeFixed=0,e.strokeWidthScaled=n.sourceRadiusScaled+n.targetRadiusScaled,e.strokeWidthFixed=n.sourceRadiusFixed+n.targetRadiusFixed,e.offsetScaled=i,e.offsetFixed=r,e.pattern.type=0,e.opacity=n.opacity,e.fillColor=null,e.strokeColor=null,e.patternColor=null,e.globalMinVisibleSize=Math.max(t.minVisibleSize,n.minVisibleSize),e.strokeMinVisibleSize=0,e.patternMinVisibleSize=0,e.offsetAngle=t.offsetAngle,e.patternScale=0,e.symbolicSize=n.widthScaled,e.curvature=n.curvature,e.dashLength=0,e.gapLength=0,e.hasHead=!1,e.hasTail=!1,e.isSelfLoop=n.isSelfLoop,e.isText=!1,e.adjustTextAngle=t.adjustAngle}function rg(e,t,n,i,r,o){(function(a,s,l,u){if(hc(l.body,u,Ex),l.halo.body){var d=s.halo.width.get(a),c=+("scaled"===s.halo.scalingMethod.get(a));u.halo.widthScaled=d*c,u.halo.widthFixed=d*(1-c),hc(l.halo,u,Sx)}l.outline.body&&(u.outline.color=s.outline.color.get(a),u.outline.minVisibleSize=s.outline.minVisibleSize.get(a),hc(l.outline,u,Ax))})(n,i,r,o),og(e,t,n,i.text,r.texts.primary,o.texts.primary,o),og(e,t,n,i.text.secondary,r.texts.secondary,o.texts.secondary,o)}function hc(e,t,n){n(e.body,t,2,t.shape.type),e.head&&n(e.head,t,3,t.shape.head),e.tail&&n(e.tail,t,4,t.shape.tail)}function og(e,t,n,i,r,o,a){if(r.text){var s=i,l=s.scaling.get(n);if(o.font=t.fontManager.getFont(s.font.get(n)),o.color=ro(s.color.get(n),a.color),o.style=s.style.get(n),o.minVisibleSize=s.minVisibleSize.get(n),o.margin=s.margin.get(n),o.padding=s.padding.get(n),o.maxLineLength=s.maxLineLength.get(n),o.content=Bd(o.content,o.maxLineLength),o.adjustAngle=s.adjustAngle.get(n),o.align=s.align.get(n),l){var u=s.scale.get(n);o.sizeScaled=a.widthScaled*u,o.sizeFixed=a.widthFixed*u}else o.sizeFixed=s.size.get(n),o.sizeScaled=0;var d=e.measureText(o.content,o.font,o.style);o.widthScaled=d.width*o.sizeScaled,o.widthFixed=d.width*o.sizeFixed,o.heightScaled=d.height*o.sizeScaled,o.heightFixed=d.height*o.sizeFixed,o.offsetAngle=o===a.texts.primary?k0:O0,ig(p=r.text,g=o,a),p.pattern.type=7,p.pattern.attributes.text=g.content,p.pattern.attributes.size="sdf",p.pattern.attributes.font=g.font,p.pattern.attributes.style=g.style,p.pattern.attributes.align=g.align,p.patternColor=g.color,p.patternScale=1,p.thicknessOrFontSizeScaled=g.sizeScaled,p.thicknessOrFontSizeFixed=g.sizeFixed,p.isText=!0,r.background&&(ig(c=r.background,h=o,a),c.fillColor=h.backgroundColor)}var c,h,p,g}var wx=El(Sa,"start"),Cx=El(Sa,"end"),Tx=Pf(Sa),Mx=(Ur.prototype.drawEdge=function(e){if(this._computeBlockIds(e),this._attributes.excluded.get(e))this._freeBlocks();else{var t=this._engine,n=this._helper,i=this._extremitiesAttributes,r=-e,o=xu(this._attributes.layer.get(e),this._depthInfo),a=this._attributes,s=a.source.get(e),l=a.target.get(e),u=a.curvature.get(e),d=this._attributesPrev.curvature.get(e),c=a.animationDuration.get(e),h=a.animationStart.get(e),p=a.animationEasing.get(e),g=0<c;if(this._prepareBlocks(g,o,r,0!==u||g&&0!==d),i.source=this._nodeAttributes,i.target=this._nodeAttributes,Qf(n,this._endInput,a,e,i,this._view),tg(this._endFlags,this._endInput),g){var b=0<this._nodeAttributes.animationDuration.get(s),v=0<this._nodeAttributes.animationDuration.get(l);i.source=b?this._nodeAttributesPrev:this._nodeAttributes,i.target=v?this._nodeAttributesPrev:this._nodeAttributes,Qf(n,this._startInput,this._attributesPrev,e,i,this._view),tg(this._startFlags,this._startInput),Tx(this._endFlags,this._startFlags)}this._initComponents(this._fullComponents,this._endFlags,this._blocks),Cx(this._fullComponents,this._endComponents),rg(t,n,e,this._attributes,this._endComponents,this._endInput),g&&(wx(this._fullComponents,this._startComponents),rg(t,n,e,this._attributesPrev,this._startComponents,this._startInput),this._setBlocksAnimation(c,h,p)),this._setupHaloMasking(s,l),this._storeBlocks()}},Ur.prototype._setupHaloMasking=function(e,t){var n=this._nodeAttributes.halo,i=this._blocks,r=n.color.get(e)&&n.hideNonAdjacentEdges.get(e),o=n.color.get(t)&&n.hideNonAdjacentEdges.get(t),a=r||o?1:3;i.body.setStencilUsage(a),i.text.setStencilUsage(a),i.textBg.setStencilUsage(a)},Ur.prototype._computeBlockIds=function(e){var t=10*e,n=this._blockIds;n.body=5+t,n.halo=8+t,n.text=6+t,n.textBg=7+t},Ur.prototype._prepareBlocks=function(e,t,n,i){var r=this._blocks;r.body.reset(i?3:1,e,t.edgeBody,n),r.halo.reset(i?3:1,e,t.edgeHalo,n),r.text.reset(2,e,t.edgeText,n),r.textBg.reset(1,e,t.edgeTextBackground,n)},Ur.prototype._storeBlocks=function(){var e=this._engine,t=this._blocks,n=this._blockIds;e.storeBlock(n.body,t.body),e.storeBlock(n.halo,t.halo),e.storeBlock(n.text,t.text),e.storeBlock(n.textBg,t.textBg)},Ur.prototype._freeBlocks=function(){var e=this._engine,t=this._blockIds;e.freeBlock(t.body),e.freeBlock(t.halo),e.freeBlock(t.text),e.freeBlock(t.textBg)},Ur.prototype._setBlocksAnimation=function(e,t,n){var i=this._blocks;i.body.setGlobalAnimation(e,t,n),i.halo.setGlobalAnimation(e,t,n),i.text.setGlobalAnimation(e,t,n),i.textBg.setGlobalAnimation(e,t,n)},Ur.prototype._initComponents=function(e,t,n){this._initEdgeComponents(e.halo,t.halo,n.halo),this._initEdgeComponents(e.outline,t.outline,n.body),this._initEdgeComponents(e.body,t.body,n.body),this._initTextComponents(e.texts.primary,t.texts.primary,n),this._initTextComponents(e.texts.secondary,t.texts.secondary,n)},Ur.prototype._initEdgeComponents=function(e,t,n){e.head=this._nextElement(t.head,n),e.tail=this._nextElement(t.tail,n),e.body=this._nextElement(t.body,n)},Ur.prototype._initTextComponents=function(e,t,n){e.background=this._nextElement(t.background,n.textBg),e.text=this._nextElement(t.text,n.text)},Ur.prototype._nextElement=function(e,t){return e?t.next():this._nullElt},Ur);function Ur(e){var t=e.engine,n=e.imageManager,i=e.fontManager,r=e.formatText,o=e.view,a=e.attributes,s=e.attributesPrev,l=e.nodeAttributes,u=e.nodeAttributesPrev;this._extremitiesAttributes={source:null,target:null},this._fullComponents={halo:{body:void 0,head:void 0,tail:void 0},outline:{body:void 0,head:void 0,tail:void 0},body:{body:void 0,head:void 0,tail:void 0},texts:{primary:{text:void 0,background:void 0},secondary:{text:void 0,background:void 0}}},this._startComponents={halo:{body:void 0,head:void 0,tail:void 0},outline:{body:void 0,head:void 0,tail:void 0},body:{body:void 0,head:void 0,tail:void 0},texts:{primary:{text:void 0,background:void 0},secondary:{text:void 0,background:void 0}}},this._endComponents={halo:{body:void 0,head:void 0,tail:void 0},outline:{body:void 0,head:void 0,tail:void 0},body:{body:void 0,head:void 0,tail:void 0},texts:{primary:{text:void 0,background:void 0},secondary:{text:void 0,background:void 0}}},this._startFlags={halo:{body:void 0,head:void 0,tail:void 0},outline:{body:void 0,head:void 0,tail:void 0},body:{body:void 0,head:void 0,tail:void 0},texts:{primary:{text:void 0,background:void 0},secondary:{text:void 0,background:void 0}}},this._endFlags={halo:{body:void 0,head:void 0,tail:void 0},outline:{body:void 0,head:void 0,tail:void 0},body:{body:void 0,head:void 0,tail:void 0},texts:{primary:{text:void 0,background:void 0},secondary:{text:void 0,background:void 0}}},this._startInput={source:0,target:0,sourceX:0,sourceY:0,targetX:0,targetY:0,sourceRadiusScaled:0,sourceRadiusFixed:0,targetRadiusScaled:0,targetRadiusFixed:0,widthScaled:0,widthFixed:0,curvature:0,isSelfLoop:!1,color:"",opacity:0,minVisibleSize:0,shape:{type:"line",head:null,tail:null,dashLength:0,gapLength:0,isBodyTriangle:!1},stroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},halo:{widthScaled:0,widthFixed:0,color:""},outline:{enabled:!1,color:"",minVisibleSize:0},textHidden:!1,texts:{primary:{align:"left",hidden:!1,content:"",backgroundColor:"",font:"",color:"",sizeScaled:0,sizeFixed:0,style:"none",minVisibleSize:0,margin:0,padding:0,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,adjustAngle:!1,offsetAngle:0},secondary:{align:"left",hidden:!1,content:"",backgroundColor:"",font:"",color:"",sizeScaled:0,sizeFixed:0,style:"none",minVisibleSize:0,margin:0,padding:0,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,adjustAngle:!1,offsetAngle:0}}},this._endInput={source:0,target:0,sourceX:0,sourceY:0,targetX:0,targetY:0,sourceRadiusScaled:0,sourceRadiusFixed:0,targetRadiusScaled:0,targetRadiusFixed:0,widthScaled:0,widthFixed:0,curvature:0,isSelfLoop:!1,color:"",opacity:0,minVisibleSize:0,shape:{type:"line",head:null,tail:null,dashLength:0,gapLength:0,isBodyTriangle:!1},stroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},halo:{widthScaled:0,widthFixed:0,color:""},outline:{enabled:!1,color:"",minVisibleSize:0},textHidden:!1,texts:{primary:{align:"left",hidden:!1,content:"",backgroundColor:"",font:"",color:"",sizeScaled:0,sizeFixed:0,style:"none",minVisibleSize:0,margin:0,padding:0,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,adjustAngle:!1,offsetAngle:0},secondary:{align:"left",hidden:!1,content:"",backgroundColor:"",font:"",color:"",sizeScaled:0,sizeFixed:0,style:"none",minVisibleSize:0,margin:0,padding:0,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,adjustAngle:!1,offsetAngle:0}}},this._depthInfo={edgeHalo:0,nodeHaloStroke:0,nodeHalo:0,edgeBody:0,edgeTextBackground:0,edgeText:0,nodeBody:0,nodeTextBackground:0,nodeText:0},this._nullElt={id:-1,valid:!0,animation:null,start:null,end:null},this._engine=t,this._view=o,this._helper={imageManager:n,fontManager:i,formatText:r},this._attributes=a,this._attributesPrev=s,this._nodeAttributes=l,this._nodeAttributesPrev=u,this._blocks=ag(function(){return t.createBlock()}),this._blockIds=ag(function(){return 0})}function ag(e){return{body:e(),halo:e(),text:e(),textBg:e()}}function Sa(){return{halo:{body:void 0,head:void 0,tail:void 0},outline:{body:void 0,head:void 0,tail:void 0},body:{body:void 0,head:void 0,tail:void 0},texts:{primary:{text:void 0,background:void 0},secondary:{text:void 0,background:void 0}}}}var kx=ho&&document.fonts,pc="/qwerty/ [HELLO] \uf155\uf155\uf155",Ox=(Il.prototype._measureText=function(e,t){return this._ctx.font="12px "+t,this._ctx.measureText(e).width},Il.prototype.check=function(e){if(this._checkReliable)return this._fontFaceSet.check("12px "+e);var t=this._measureText(pc,"serif");return this._measureText(pc,e)!==t},Il.prototype.load=function(e){return this._fontFaceSet&&this._fontFaceSet.load?this._fontFaceSet.load("12px "+e):(this._ctx.font="12px "+e,this._ctx.fillText(pc,10,50),Promise.resolve())},Il);function Il(){this._fontFaceSet=kx?document.fonts:null,this._canvas=di(),this._checkReliable=this._fontFaceSet&&this._fontFaceSet.check&&!this._fontFaceSet.check("12px FontThatDoesNotExist"),this._ctx=this._canvas.getContext("2d")}var Nx=(Ka.prototype._setLoaded=function(){this._loaded=!0,this._value=this._fontName},Ka.prototype.getValue=function(){return this._value},Ka.prototype.isLoaded=function(){return this._loaded},Ka.prototype.destroy=function(){clearTimeout(this._timeout)},Ka.prototype.load=function(){var e=this;return this._tryLoad(200).then(function(){e._setLoaded()})},Ka.prototype._tryLoad=function(e){var t=this;return this._fontFaceSet.load(this._fontName).then(function(){if(!t._fontFaceSet.check(t._fontName))return new Promise(function(n){e<6e4&&(t._timeout=setTimeout(n,e))}).then(function(){return t._tryLoad(1.5*e)})})},Ka);function Ka(e,t){this._loaded=!1,this._value=null,this._timeout=null,this._fontFaceSet=e,this._fontName=t,this._loaded=!1,this._value=null,this._timeout=null,ho&&!this._fontFaceSet.check(this._fontName)||this._setLoaded()}var Lx=(Ns.prototype.setHideUntilFontsLoaded=function(e){this._hideUntilFontsLoaded=e},Ns.prototype.getFont=function(e){var t=this,n=this._fonts[e];return n||(n=new Nx(this._fontFaceSet,e),(this._fonts[e]=n).isLoaded()||n.load().then(function(){return t._triggerFontLoaded(e)})),!this._hideUntilFontsLoaded&&e||n.getValue()},Ns.prototype.onFontLoaded=function(e){this._onFontLoaded.push(e)},Ns.prototype.destroy=function(){var e=this;this._onFontLoaded=[],Object.keys(this._fonts).forEach(function(t){return e._fonts[t].destroy()})},Ns.prototype._triggerFontLoaded=function(e){this._onFontLoaded.forEach(function(t){return t(e)})},Ns);function Ns(){this._fontFaceSet=new Ox,this._fonts={},this._onFontLoaded=[],this._hideUntilFontsLoaded=!0}function bu(e,t,n){for(var i=n.length,r=i-1,o=!1,a=0;a<i;++a)(n[a].y<t&&n[r].y>=t||n[r].y<t&&n[a].y>=t)&&(n[a].x<=e||n[r].x<=e)&&(o=o!==n[a].x+(t-n[a].y)/(n[r].y-n[a].y)*(n[r].x-n[a].x)<e),r=a;return o}function kl(e){var t=e.x*e.x+e.y*e.y;return{x:e.x/t,y:e.y/t}}function sg(e,t){for(var n=1/0,i=-1/0,r=0,o=e.length;r<o;r++){var a=e[r],s=a.x*t.x+a.y*t.y;s<n&&(n=s),i<s&&(i=s)}return{x:n,y:i}}function fc(e,t){for(var n=function(l,u){var d=l[1],c=l[0],h=kl({x:d.x-c.x,y:d.y-c.y}),p=h.x;h.x=-h.y,h.y=p;var g=h;p=(h=kl({x:(d=l[2]).x-(c=l[1]).x,y:d.y-c.y})).x,h.x=-h.y,h.y=p;var m=h;p=(h=kl({x:(d=u[1]).x-(c=u[0]).x,y:d.y-c.y})).x,h.x=-h.y,h.y=p;var b=h;return p=(h=kl({x:(d=u[2]).x-(c=u[1]).x,y:d.y-c.y})).x,h.x=-h.y,h.y=p,[g,m,b,h]}(e,t),i=0,r=n.length;i<r;i++){var o=n[i],a=sg(e,o),s=sg(t,o);if(0==(a.x<=s.y&&a.y>=s.x?Math.min(a.y,s.y)-Math.max(a.x,s.x):0))return!1}return!0}function gc(e){var t=0,n=0,i=e.length;if(0===i)throw new Error("Compute centroid: at least one point is required");for(var r=0;r<i;++r){var o=e[r];t+=o.x,n+=o.y}return{x:t/=i,y:n/=i}}var Ls,vc,Fx=mc(4),Px=mc(5),Dx=mc(10,.4),Aa=1/3,Rx=[{x:-1,y:-Aa},{x:-.55,y:-Aa},{x:-1,y:-1},{x:1,y:0},{x:-1,y:1},{x:-.55,y:Aa},{x:-1,y:Aa}],ug=[{x:-.6,y:-.3},{x:.1,y:0},{x:-.6,y:.3}],zx={circle:{getDistanceFromStrokeVertically:function(e,t){return 1},getDistanceFromStrokeHorizontally:function(e,t){return 1-Math.sqrt(e*e+t*t)},points:[{x:0,y:0,r:1}],isSimple:!0},square:{getDistanceFromStrokeVertically:function(e,t){return 1-Math.abs(t)},getDistanceFromStrokeHorizontally:function(e,t){return 1-Math.abs(e)},points:[{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],isSimple:!0},line:{getDistanceFromStrokeVertically:function(e,t){return 1-Math.abs(t)},getDistanceFromStrokeHorizontally:function(e,t){return 1},points:[{x:-1,y:0},{x:1,y:0}],isSimple:!0},triangle:{getDistanceFromStrokeVertically:function(e,t){return(1-e)/2-Math.abs(t)},getDistanceFromStrokeHorizontally:function(e,t){return 1-Math.abs(e)},points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],isSimple:!0},arrow:{getDistanceFromStrokeVertically:function(e,t){return(1-e)/2-Math.abs(t)},getDistanceFromStrokeHorizontally:function(e,t){return 1-Math.abs(e)},points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],isSimple:!0},"circle-hole-arrow":{getDistanceFromStrokeVertically:function(e,t){return Math.min(Math.sqrt((e+.4)*(e+.4)+t*t)-.27,(1-e)/2-Math.abs(t))},getDistanceFromStrokeHorizontally:function(e,t){return 1-Math.abs(e)},points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],hole:[{x:-.4,y:0,r:.3}],isSimple:!0},"triangle-hole-arrow":{getDistanceFromStrokeVertically:function(e,t){var n=Math.min((1-e)/2-Math.abs(t),1-Math.abs(e)),i=-dg(e,t,ug);return Math.min(n,i)},getDistanceFromStrokeHorizontally:function(e,t){return 1},points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],hole:ug,isSimple:!0},"short-arrow":Eu([{x:-1,y:-Aa},{x:0,y:-Aa},{x:0,y:-1},{x:1,y:0},{x:0,y:1},{x:0,y:Aa},{x:-1,y:Aa}],!1),"sharp-arrow":Eu(Rx,!1),cross:{getDistanceFromStrokeVertically:function(e,t){return 1},getDistanceFromStrokeHorizontally:function(e,t){var n=Math.abs(e),i=Math.abs(t),r=.31-Math.min(n,i),o=1-Math.max(n,i);return Math.min(r,o)},points:[{x:-1,y:.31},{x:-1,y:-.31},{x:-.31,y:-.31},{x:-.31,y:-1},{x:.31,y:-1},{x:.31,y:-.31},{x:1,y:-.31},{x:1,y:.31},{x:.31,y:.31},{x:.31,y:1},{x:-.31,y:1},{x:-.31,y:.31}],isSimple:!1},diamond:Eu(Fx),pentagon:Eu(Px),star:Eu(Dx)},Bx=["circle","square","triangle","line"],Vx=["cross","diamond","pentagon","star"],Ux=["arrow","triangle-hole-arrow","circle-hole-arrow","short-arrow","sharp-arrow"];function lg(e,t){for(var n=0,i=Bx;n<i.length;n++)_c(e,i[n]);for(var r=t.nodes.current.shape.getValues(),o=t.edges.current.shape.head.getValues(),a=t.edges.current.shape.tail.getValues(),s=0,l=Vx;s<l.length;s++){var u=l[s];r.includes(u)&&_c(e,u)}for(var d=0,c=Ux;d<c.length;d++){var h=c[d];(o.includes(h)||a.includes(h))&&_c(e,h)}}function _c(e,t){e.registerShape(t,zx[t])}function dg(e,t,n){for(var i=1/0,r={x:e,y:t},o=0;o<n.length;++o)i=Math.min(i,gf(r,n[o],n[(o+1)%n.length]));return i*(bu(e,t,n)?1:-1)}function mc(e,t){void 0===t&&(t=1);for(var n=-Math.PI/2+1e-6,i=[],r=2*Math.PI/e,o=n,a=0;a<e;++a){var s=a%2==1?t:1;i.push({x:Math.cos(o)*s,y:Math.sin(o)*s}),o+=r}return i}function Eu(e,t){return void 0===t&&(t=!1),{getDistanceFromStrokeVertically:function(){return 1},getDistanceFromStrokeHorizontally:function(n,i){return dg(n,i,e)},points:e,isSimple:t}}(vc=Ls=Ls||{}).ZOOM="zoom",vc.ROTATE="rotate";var yc={duration:0,easing:"linear",startAfter:0,ignoreZoomLimits:!(vc.PAN="pan"),callback:function(){}};function Ol(e){return Math.abs(e)<1e-9}var cg,jx=(bt(vn,cg=E),Object.defineProperty(vn.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(vn.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(vn.prototype,"zoom",{get:function(){return this._zoom},enumerable:!0,configurable:!0}),Object.defineProperty(vn.prototype,"angle",{get:function(){return this._angle},enumerable:!0,configurable:!0}),Object.defineProperty(vn.prototype,"width",{get:function(){return this._dimensions.width},enumerable:!0,configurable:!0}),Object.defineProperty(vn.prototype,"height",{get:function(){return this._dimensions.height},enumerable:!0,configurable:!0}),vn.prototype.moveEnd=function(e){var t=this;this._dom.clearTimeout(this._timeout),this._timeout=this._dom.setTimeout(function(){t._timeout=null,t._events.fire(x.VIEW_CHANGED,{type:e})},80)},vn.prototype.getSize=function(){return{width:this._dimensions.width,height:this._dimensions.height}},vn.prototype.getCenter=function(){return{x:this._x,y:this._y}},vn.prototype.setCenter=function(e,t){var n=this,i=e.x,r=e.y,o=Mt({},yc,t),a=this._x,s=this._y,l=i-this._x,u=r-this._y;return Ol(l)&&Ol(u)?Promise.resolve():new Promise(function(d){o.callback=function(){n.moveEnd(Ls.PAN),d()},n._moveAnimation&&n._animations.end(n._moveAnimation,!1),n._moveAnimation=n._animations.play(function(c){n._x=a+l*c,n._y=s+u*c,n._events.fire(x.CAMERA_MOVE),n._events.fire(x.CAMERA_PAN)},o)})},vn.prototype.move=function(e,t){var n=hg({x:e.x,y:e.y},this._zoom,this._sinAngle,this._cosAngle);return this.setCenter({x:this._x+n.x,y:this._y+n.y},t)},vn.prototype.getZoom=function(){return this._zoom},vn.prototype.setZoom=function(e,t,n){var i=this;void 0===n&&(n={refX:void 0,refY:void 0}),t=Mt({},yc,t);var r=n.refX,o=n.refY,a=_e(e,this._minZoom,this._maxZoom);return t.ignoreZoomLimits||(a=this._applyZoomLimits(a)),Ol(this._zoom-a)?Promise.resolve():new Promise(function(s){var l=i._dimensions.width/2,u=i._dimensions.height/2,d=i._zoom,c=l/d-l/a;if(t.callback=function(){i.moveEnd(Ls.ZOOM),s()},void 0!==r&&void 0!==o){var h=(r-l)/d-(r-l)/a,p=(o-u)/d-(o-u)/a,g=i._cosAngle,m=i._sinAngle;i.setCenter({x:i._x+(g*h-m*p),y:i._y+(m*h+g*p)},t)}i._zoomAnimation&&i._animations.end(i._zoomAnimation,!1),i._dom.setTimeout(function(){i._events.fire(x.START_ZOOM,{duration:t.duration,easing:t.easing,startZoom:d,endZoom:a})}),i._zoomAnimation=i._animations.play(function(y){i._zoom=l/(l/d-c*y),i._events.fire(x.CAMERA_MOVE),i._events.fire(x.CAMERA_ZOOM)},t)})},vn.prototype._applyZoomLimits=function(e){var t=this._settings.get("interactions.zoom.minValue"),n=this._settings.get("interactions.zoom.maxValue"),i=this._modules.locate.getGraphBoundingBox(),r=this._zoom,o=this.getSize(),a=e;if(!isNaN(i.cx)){var s={smallestNodeSize:i.minScaledSize,biggestNodeSize:i.maxScaledSize,graphWidth:i.width+i.maxScaledSize,graphHeight:i.height+i.maxScaledSize,viewWidth:o.width,viewHeight:o.height},l=t&&t(s),u=n&&n(s);pg(l)&&a<l?a<r&&(a=Math.min(r,l)):pg(u)&&u<a&&r<a&&(a=Math.max(r,u))}return a},vn.prototype.zoomIn=function(e,t,n){return void 0===n&&(n={refX:void 0,refY:void 0}),"number"!=typeof e&&(n=t,t=e,e=this._settings.get("interactions.zoom.modifier")),this.setZoom(this._zoom*e,t,n)},vn.prototype.zoomOut=function(e,t,n){return void 0===n&&(n={refX:void 0,refY:void 0}),"number"!=typeof e&&(n=t,t=e,e=this._settings.get("interactions.zoom.modifier")),this.setZoom(this._zoom/e,t,n)},vn.prototype.getAngle=function(){return this._angle},vn.prototype.setAngle=function(e,t){var n=this;t=Mt({},yc,t);var i=this._angle,r=e-i;return Ol(r)?Promise.resolve():new Promise(function(o){t.callback=function(){n.moveEnd(Ls.ROTATE),o()},n._rotateAnimation&&n._animations.end(n._rotateAnimation,!1),n._rotateAnimation=n._animations.play(function(a){for(n._angle=i+r*a;n._angle>Math.PI;)n._angle-=2*Math.PI;for(;n._angle<-Math.PI;)n._angle+=2*Math.PI;n._sinAngle=Math.sin(n._angle),n._cosAngle=Math.cos(n._angle),n._events.fire(x.CAMERA_MOVE),n._events.fire(x.CAMERA_ROTATE)},t)})},vn.prototype.rotate=function(e,t){return this.setAngle(this._angle+e,t)},vn.prototype.getScreenCenter=function(){return{x:this._dimensions.width/2,y:this._dimensions.height/2}},vn.prototype.graphToScreenCoordinates=function(e,t){void 0===t&&(t={x:0,y:0});var r=this._dimensions.width/2,o=this._dimensions.height/2;return Gd((e.x-this._x)*this._zoom+r,(e.y-this._y)*this._zoom+o,r,o,-this._angle,t)},vn.prototype.screenToGraphCoordinates=function(e,t){return void 0===t&&(t={x:0,y:0}),Gd(this._x+(e.x-this._dimensions.width/2)/this._zoom,this._y+(e.y-this._dimensions.height/2)/this._zoom,this._x,this._y,this._angle,t)},vn.prototype.projectBounds=function(e,t){void 0===t&&(t=e);for(var n=e[0],i=e[1],r=e[2],o=e[3],a=this._x,s=this._y,l=this._dimensions.width/2,u=this._dimensions.height/2,d=this._sinAngle,c=this._cosAngle,h=1/this._zoom,p=1/0,g=1/0,m=-1/0,b=-1/0,v=[n,i,n,o,r,o,r,i],y=0;y<v.length;y+=2){var S=v[y],A=v[y+1],C=(S=a+(S-l)*h)-a,O=(A=s+(A-u)*h)-s;(S=c*C-d*O+a)<p&&(p=S),m<S&&(m=S),(A=d*C+c*O+s)<g&&(g=A),b<A&&(b=A)}return t[0]=p,t[1]=g,t[2]=m,t[3]=b,t},vn.prototype.screenToGraphVector=function(e){return hg({x:e.x,y:e.y},this._zoom,this._sinAngle,this._cosAngle)},vn.prototype.getView=function(){return{x:this._x,y:this._y,zoom:this._zoom,angle:this._angle,width:this._dimensions.width,height:this._dimensions.height}},vn.prototype.setView=function(e,t){var n=Mt({x:this._x,y:this._y,zoom:this._zoom,angle:this._angle},e),o=n.zoom,a=n.angle;return Promise.all([this.setCenter({x:n.x,y:n.y},t),this.setZoom(o,t),this.setAngle(a,t)]).then(function(){})},vn.prototype._reloadDimensions=function(){this._dimensions=this._dom.getDimensions()},vn.prototype.animationInProgress=function(){var e=this._moveAnimation,t=this._zoomAnimation;return e&&!e.done||t&&!t.done},vn.prototype.getProjectedScreenBounds=function(e){void 0===e&&(e=0);var t=this._dimensions,n=t.width,i=t.height,r=Math.max(n,i)*e;return this.projectBounds([0-r,0-r,n+r,i+r])},vn.prototype._reset=function(){this._zoom=1,this._x=0,this._y=0,this._angle=0,this._sinAngle=0,this._cosAngle=1,this._dimensions=this._dom.getDimensions()},vn);function vn(e){var t=cg.call(this)||this;return t._modules=e,t._events=e.events,t._dom=e.dom,t._animations=e.animations,t._settings=e.settings,t._zoomAnimation=null,t._moveAnimation=null,t._reset(),t._minZoom=1e-8,t._maxZoom=1e8,t._settings.register("minZoom",1e-8,function(n){t._minZoom=n,t._zoom<n&&(t._zoom=n,t._events.fire(x.CAMERA_MOVE))}),t._settings.register("maxZoom",1e8,function(n){t._maxZoom=n,t._zoom>n&&(t._zoom=n,t._events.fire(x.CAMERA_MOVE))}),t._timeout=null,t._events.on({setContainer:function(){t._reset(),t._events.fire(x.CAMERA_MOVE)},resize:function(){t._reloadDimensions(),t._events.fire(x.CAMERA_MOVE)}}),t}function hg(e,t,n,i){var r=e.x,o=e.y;return{x:i*(r/=t)-n*(o/=t),y:n*r+i*o}}function pg(e){return"number"==typeof e&&isFinite(e)}var fg,Zx={maxBlockId:1024,maxScaledSize:16,maxPixelSize:255,maxMinVisibleSize:64,maxDashOffset:4,maxDashLength:3,maxGapLength:1,maxSymbolicSize:0,maxPatternScale:0},gg=Rr?"webgl":null,Gx=(bt(Lt,fg=E),Lt.prototype.onMounted=function(e,t){var n=this;void 0!==t.renderer&&e.setOptions({renderer:t.renderer}),void 0!==t.imgCrossOrigin&&e.setOptions({imgCrossOrigin:t.imgCrossOrigin}),this._dom.addWindowEventListener("unload",function(){n.destroy()})},Lt.prototype.getTransparentBackgroundColor=function(){var e=this._settings.get("backgroundColor");return e?this._engine.transparentify(e):null},Lt.prototype._render=function(){var e=this._dom.getDimensions(),t=this._camera.getView(),n=Nn(),i=R(),r=this._settings.get("backgroundColor");this._engine.setView({x:t.x,y:t.y,zoom:t.zoom,angle:t.angle,width:e.width,height:e.height,pixelRatio:n,currentTime:i,backgroundColor:r,isBufferDisplayable:this._isBufferDisplayable});try{this._engine.render(),"requested"===this._rendererState.state&&this._updateRendererState({state:"ok"})}catch(p){if(this._debug)throw p;var a=p.message,s=p.code,l=void 0===s?"OTHER":s,u=this._rendererState.type,d=this._formatRendererName(u),c="requested"===this._rendererState.state?"Error while initializing the "+d+" renderer":"The "+d+" renderer encountered an unexpected runtime error",h=null;"webgl"===u&&(c+="; fallbacking on canvas renderer",h="canvas"),eo(a),eo(c),this._updateRendererState({state:"error",code:l,message:a}),this._settings.set("renderer",h)}},Lt.prototype._formatRendererName=function(e){return"webgl"===e?"WebGL":"svg"===e?"SVG":e},Lt.prototype._fireRendererStateChangeEvent=function(){this._events.fire(x.RENDERER_STATE_CHANGE,{type:this._rendererState.type,state:this._rendererState.state,code:this._rendererState.code,message:this._rendererState.message})},Lt.prototype._updateRendererState=function(e){var t=e.type,n=e.state,i=e.code,r=e.message,o=!1;void 0!==t&&this._rendererState.type!==t&&(this._rendererState.type=t,o=!0),void 0!==n&&this._rendererState.state!==n&&(this._rendererState.state=n,o=!0),void 0!==i&&this._rendererState.code!==i&&(this._rendererState.code=i,o=!0),void 0!==r&&this._rendererState.message!==r&&(this._rendererState.message=r,o=!0),o&&this._initDone&&this._fireRendererStateChangeEvent()},Lt.prototype.getImageData=function(){var e=this;return this._dom.afterNextFrame().then(function(){return e._engine.getImageData()})},Lt.prototype.addCanvas=function(e){this._engine.addCanvas(e)},Lt.prototype.removeCanvas=function(e){this._engine.removeCanvas(e)},Lt.prototype.getNodeAttributes=function(){return this._attributesManager.getFlexArrays().nodes.current},Lt.prototype.getEdgeAttributes=function(){return this._attributesManager.getFlexArrays().edges.current},Lt.prototype.getGraphicsEngine=function(){return this._engine},Lt.prototype.getImageManager=function(){return this._imageManager},Lt.prototype.getFontManager=function(){return this._fontManager},Lt.prototype.allocateGraphicsEngineBlockId=function(){return this._availableGeIndexes.length?this._availableGeIndexes.pop():10*this._nextGeIndex+++9},Lt.prototype.releaseGraphicsEngineBlockId=function(e){this._engine.freeBlock(e),this._availableGeIndexes.push(e),this._dom.refresh()},Lt.prototype.addCursorStyle=function(e){e&&(this._cursorStyle.push(e),this._applyCursorStyle())},Lt.prototype.removeCursorStyle=function(e){if(e){var t=this._cursorStyle.lastIndexOf(e);-1!==t&&(this._cursorStyle.splice(t,1),this._applyCursorStyle())}},Lt.prototype.reloadFonts=function(){this._events.fire(x.RELOAD_FONTS),this._engine.notifyFontsReloaded(),this._dom.refresh()},Lt.prototype.getDomElement=function(){return this._domElement},Lt.prototype.setTextHidden=function(e,t){this._attributesManager.setTextHidden(e,t)},Lt.prototype.resetTextHidden=function(){this._attributesManager.resetTextHidden(),this._dom.refresh()},Lt.prototype.getAttributesManager=function(){return this._attributesManager},Lt.prototype._checkFontsNewlyLoaded=function(){return!!this._fontsNewlyLoaded.length&&(this._fontsNewlyLoaded=[],!0)},Lt.prototype._loadGraphInGraphicsEngine=function(){this._attributesManager.update(),this._checkFontsNewlyLoaded()&&this._attributesManager.redrawAll();var e=this._attributesManager.getAndResetElementsToRedraw(),t=this._attributesManager.getAndResetElementsUpdated(),n=0<t.nodes.size||0<t.edges.size;(t.nodeAttributes.includes("radius")||t.edgeAttributes.includes("width"))&&(this._boundaries.maxSize=function(i){for(var r=i.getNodeAttribute("radius"),o=i.getEdgeAttribute("width"),a=i.getNodes(),s=i.getEdges(),l=0,u=0,d=0;d<a._indexes.length;d++){var c=a._indexes[d],h=r.get(c);l<h&&(l=h)}for(d=0;d<s._indexes.length;d++){var p=o.get(c=s._indexes[d]);u<p&&(u=p)}return Math.max(2*l,u)}(this._graph)),(t.nodeAttributes.includes("shape")||t.edgeAttributes.includes("shape.head")||t.edgeAttributes.includes("shape.tail"))&&lg(this._engine,this._attributesManager.getFlexArrays()),function(e){var t,n,a=e.graph,s=e.elements,l=e.engine,u=e.imageManager,d=e.fontManager,c=e.view,p=e.boundaries,g=e.formatText,m={nodeAttributes:n=tr((t=e.attributes).nodes.current,{text:{secondary:{scaling:t.nodes.current.text.scaling,maxLineLength:t.nodes.current.text.maxLineLength}}}),nodeAttributesPrev:tr(t.nodes.previous,{textHidden:n.textHidden,text:{secondary:{scaling:t.nodes.previous.text.scaling,maxLineLength:t.nodes.previous.text.maxLineLength}}}),edgeAttributes:tr(t.edges.current,{text:{secondary:{scaling:t.edges.current.text.scaling,maxLineLength:t.edges.current.text.maxLineLength,adjustAngle:t.edges.current.text.adjustAngle}}}),edgeAttributesPrev:tr(t.edges.previous,{source:t.edges.current.source,target:t.edges.current.target,textHidden:t.edges.current.textHidden,text:{secondary:{scaling:t.edges.previous.text.scaling,maxLineLength:t.edges.previous.text.maxLineLength,adjustAngle:t.edges.previous.text.adjustAngle}}})},b=m.nodeAttributes,v=m.nodeAttributesPrev,y=m.edgeAttributes,S=m.edgeAttributesPrev,A=s.nodes,C=s.edges,O=p.maxSize,N=p.maxMinVisibleSize;if(A.size||C.size){var P=10*(Math.max(a.getNodeMaxIndex(),a.getEdgeMaxIndex())+1),F=l.setGlobalBoundaries({maxBlockId:Oi(P),maxScaledSize:Oi(8*O),maxMinVisibleSize:Oi(N),maxSymbolicSize:Oi(O),maxDashLength:3,maxGapLength:1,maxPatternScale:2}),L=(F?a.getNodes("_all"):A)._indexes,B=(F?a.getEdges("_all"):C)._indexes;if(L.length)for(var Y=new bx({engine:l,imageManager:u,fontManager:d,formatText:g,attributes:b,attributesPrev:v}),X=0;X<L.length;++X)Y.drawNode(L[X]);if(B.length){var ae=new Mx({engine:l,imageManager:u,fontManager:d,formatText:g,view:c,attributes:y,attributesPrev:S,nodeAttributes:b,nodeAttributesPrev:v});for(X=0;X<B.length;++X)ae.drawEdge(B[X])}}}({graph:this._graph,elements:e,engine:this._engine,imageManager:this._imageManager,fontManager:this._fontManager,view:this._camera.getView(),attributes:this._attributesManager.getFlexArrays(),boundaries:this._boundaries,formatText:this._formatText}),n&&this._events.fire(x.UPDATE_ATTRIBUTES,t)},Lt.prototype._forceCompleteGraphRefresh=function(){this._attributesManager.redrawAll(),this._loadGraphInGraphicsEngine()},Lt.prototype.export=function(e,t,n,i){var r,o=this;return Promise.all([this._graph.getNodes().addClass(Qa),this._graph.getEdges().addClass(Qa)]).then(function(){return o.resolveAtNextFrame()}).then(function(){return o._imageManager.whenReady()}).then(function(){var a;return"all"===n?(r={nodes:_g(a=o._graph,!0),edges:_g(a,!1)},o._forceCompleteGraphRefresh()):o._loadGraphInGraphicsEngine(),o._engine.export(e,t,i)}).then(function(a){return Promise.all([o._graph.getNodes().removeClass(Qa),o._graph.getEdges().removeClass(Qa)]).then(function(){return a})}).then(function(a){var s,l,u;return"all"===n&&(l=(s=r).nodes,u=s.edges,mg(l),mg(u),o._forceCompleteGraphRefresh()),a})},Lt.prototype.addAttributeLayer=function(e){return this._attributesManager.addAttributeLayer(e)},Lt.prototype.createFlexArrays=function(){return this._attributesManager.createFlexArrays()},Lt.prototype.getAttributeValues=function(e,t,n,i){return this._attributesManager.getAttributeValues(e,t,n,i)},Lt.prototype.forceAttributesComputation=function(){this._attributesManager.update()},Lt.prototype.resolveAtNextFrame=function(e){return this._dom.afterNextFrame().then(function(){return e})},Lt.prototype.animate=function(e,t,n){var r,o,i=("number"==typeof(r=n)?r={duration:r}:"object"==typeof r&&null!==r||(r={duration:0}),{duration:(o=r.duration,"number"!=typeof o||!isFinite(o)||o<0?0:o),easing:r.easing||"linear",chain:!!r.chain});return i.duration&&this._engine.ensureAnimationsReady(),this._animate(e,t,i)},Lt.prototype.isAnimating=function(){return 0<this._animations.length},Lt.prototype.getAnimationInformation=function(e){return this._attributesManager.getAnimationInformation(e)},Lt.prototype._toSubGraph=function(e){if(e instanceof or||e instanceof _o)return{nodes:e.toList(),edges:e.getAdjacentEdges()};if(e instanceof vs||e instanceof ia)return{nodes:this._graph.nodeList(),edges:e.toList()};var t=e,n={nodes:t.nodes||this._graph.nodeList(),edges:t.edges||this._graph.edgeList()};return n.nodes.size&&(n.edges=n.edges.size?n.edges.concat(n.nodes.getAdjacentEdges()).dedupe():n.nodes.getAdjacentEdges()),n},Lt.prototype._animate=function(e,t,n){var i=n.duration,r=n.easing;if(!this._animations.length&&!i)return t(e),Promise.resolve(e);var o=this._toSubGraph(e),a=o.nodes,s=o.edges;if(!a.size&&!s.size)return Promise.resolve(e);a.size&&this._events.fire(x.ANIMATE,{elements:a,duration:i,easing:r}),s.size&&this._events.fire(x.ANIMATE,{elements:s,duration:i,easing:r});for(var l={id:this._nextAnimationId++,startTime:-1,finished:!1,func:function(){return t(e)},duration:i,easing:r,nodes:a,edges:s,resolve:void 0},u=new Promise(function(c){return l.resolve=function(){return c(e)}}),d=0;d<a._indexes.length;d++)this._nodeAnimationList.set(a._indexes[d],l.id);for(d=0;d<s._indexes.length;d++)this._edgeAnimationList.set(s._indexes[d],l.id);return this._animations.push(l),this._dom.refresh(),i||this._processAnimations(),u},Lt.prototype._endAnimation=function(e){e.resolve(e.elements),e.finished=!0},Lt.prototype._removeFinishedAnimations=function(){this._animations=this._animations.filter(function(e){return!e.finished})},Lt.prototype._getAnimationElements=function(e){for(var t=[],n=[],i=0;i<e.nodes._indexes.length;i++){var r=e.nodes._indexes[i];this._nodeAnimationList.get(r)===e.id&&t.push(r)}for(i=0;i<e.edges._indexes.length;i++)this._edgeAnimationList.get(r=e.edges._indexes[i])===e.id&&n.push(r);return{nodes:this._graph.nodeList(new Uint32Array(t)),edges:this._graph.edgeList(new Uint32Array(n))}},Lt.prototype._resetAnimationAttributes=function(e){var t=e.nodes,n=e.edges;this._attributesManager.resetAnimationAttributes({nodes:t,edges:n}),this._nodeAnimationList.fill(t._indexes,0),this._edgeAnimationList.fill(n._indexes,0)},Lt.prototype._processAnimations=function(){if(this._animations.length){var e=R(),t=[];this._attributesManager.update();for(var n=0,i=this._animations;n<i.length;n++)-1===(l=i[n]).startTime&&(l.startTime=e,t.push(l.func),0<l.duration&&this._attributesManager.setAnimationAttributes(this._getAnimationElements(l),l));for(var r=0,o=t;r<o.length;r++)(0,o[r])();for(var a=0,s=this._animations;a<s.length;a++){var l;e>=(l=s[a]).startTime+l.duration&&(this._resetAnimationAttributes(this._getAnimationElements(l)),this._endAnimation(l))}this._removeFinishedAnimations(),this._animations.length&&this._dom.refresh()}},Lt.prototype.hideTexts=function(){this.setNodeTextsVisibility(!1),this.setEdgeTextsVisibility(!1)},Lt.prototype.showTexts=function(){this.setNodeTextsVisibility(!0),this.setEdgeTextsVisibility(!0)},Lt.prototype.setNodesVisibility=function(e){return this._updateVisibilityCounter("nodes",e)},Lt.prototype.setNodeTextsVisibility=function(e){return this._updateVisibilityCounter("nodeTexts",e)},Lt.prototype.setEdgesVisibility=function(e){return this._updateVisibilityCounter("edges",e)},Lt.prototype.setEdgeTextsVisibility=function(e){return this._updateVisibilityCounter("edgeTexts",e)},Lt.prototype._updateVisibilityCounter=function(e,t){this._visibility[e]+=t?-1:1,this._dom.refresh()},Lt.prototype.detectNode=function(e){return function(t,n,i,r,o,a){var s=t.x,l=t.y,u=t.margin,d=t.texts,c=t.indexes;c=c||n.getNodes()._indexes;var h=r.getZoom(),p=n.getObjectList(!0),g=i.getFlexArrays().nodes.current,m=0;i.update();for(var b=0;b<c.length;++b){var v=c[b];if(!g.excluded.get(v)&&g.detectable.get(v)&&0===g.animationDuration.get(v)){var y=g.x.get(v),S=g.y.get(v),A=r.graphToScreenCoordinates({x:y,y:S}),C=A.x,O=A.y,N=g.shape.get(v),P="scaled"===g.scalingMethod.get(v),F=g.radius.get(v)*(P?h:1),L=F+u;if(o.checkShapeHit(N,(s-C)/L,(l-O)/L))m=v;else if(d){var X=a(g.text.content.get(v)),ae=g.textHidden.get(v),ie=g.text.minVisibleSize.get(v);if(!ae&&X&&ie<=(P?2*F:1/0)){var U=Bd(X,g.text.maxLineLength.get(v)),W=g.innerStroke.width.get(v),ce=g.outerStroke.width.get(v),he=g.text.margin.get(v),Ee=g.text.padding.get(v),Te=g.text.size.get(v),it=g.text.scale.get(v),rt=g.text.scaling.get(v),We=g.text.font.get(v),_t=g.text.style.get(v),wt=g.text.position.get(v),Ue=o.measureText(U,We,_t,1),Ze=rt?it*F:Te,Ne=Ue.width*Ze/2+Ee+u,Ge=Ue.height*Ze/2+Ee+u,Xe=Q0[wt],$e=W+ce+he+F,we=C+($e+Ne)*Xe.x,Pe=O+($e+Ge)*Xe.y;we-Ne<s&&s<we+Ne&&Pe-Ge<l&&l<Pe+Ge&&(m=v)}}}}return p.get(m)||null}(e,this._graph,this._attributesManager,this._camera,this._engine,this._formatText)},Lt.prototype.detectEdge=function(e){return function(t,n,i,r){var o=t.margin,a=t.indexes,s=void 0===a?n.getEdges()._indexes:a,l=n.getObjectList(!1),u=r.getFlexArrays(),d=u.edges.current,c=u.nodes.current,h=i.getZoom(),p=o/h,g=i.screenToGraphCoordinates(t),m=g.x,b=g.y,v=0;r.update();for(var y=0;y<s.length;++y){var S=s[y],A=d.source.get(S),C=d.target.get(S),O=d.excluded.get(S),N=d.detectable.get(S),P=0!==d.animationDuration.get(S),F=0!==c.animationDuration.get(A),L=0!==c.animationDuration.get(C);if(!O&&N&&!P&&!F&&!L){var B=A===C,Y=d.curvature.get(S),X="triangle"===d.shape.type.get(S),ae="scaled"===d.scalingMethod.get(S),ie=d.width.get(S)/(ae?1:h),U=c.x.get(A),W=c.y.get(A),ce=c.x.get(C),he=c.y.get(C);if(B){var Ee="scaled"===c.scalingMethod.get(A);bf(m,b,U,W,U,W,(Te=Ya(U,W,Y,c.radius.get(A)/(Ee?1:h),0)).x1,Te.y1,Te.x2,Te.y2,ie,p)&&(v=S)}else if(0!==Y){var Te;xf(m,b,U,W,ce,he,(Te=fa(U,W,ce,he,Y)).x,Te.y,ie,p,X)&&(v=S)}else pf(m,b,U,W,ce,he,ie,p,X)&&(v=S)}}return l.get(v)||null}(e,this._graph,this._camera,this._attributesManager)},Lt.prototype.getVisibilityCounters=function(){return this._visibility},Lt.prototype.destroy=function(){this.getGraphicsEngine().destroy(),this.getImageManager().destroy(),this.getFontManager().destroy()},Lt);function Lt(e,t){var n,i=e.dom,r=e.graph,o=e.camera,a=e.events,s=e.settings,l=fg.call(this)||this;return l._debug=!1,l._initDone=!1,l._boundaries={maxSize:10,maxMinVisibleSize:64},l._visibility={nodes:0,edges:0,nodeTexts:0,edgeTexts:0},l._nextAnimationId=1,l._animations=[],l._rendererState={type:null,code:null,state:"ok",message:""},l._cursorStyle=[],l._fontsNewlyLoaded=[],l._nextGeIndex=1,l._availableGeIndexes=[],l._isBufferDisplayable=function(u){var d,c=2===(d=u.getDepth())||1===d||3<=(d-3)%6,h=Df(u);return 0===(c?l._visibility.nodes:l._visibility.edges)&&(!h||0===(c?l._visibility.nodeTexts:l._visibility.edgeTexts))},l._applyCursorStyle=function(){var u=l._cursorStyle[l._cursorStyle.length-1]||l._settings.get("cursor.default");$r(l._domElement,u)},l._updateImageCrossOrigin=function(){l._imageManager.setImgCrossOrigin(l._settings.get("imgCrossOrigin"))},l._debug=t.isDebug(),l._events=a,l._dom=i,l._graph=r,l._camera=o,l._events=a,l._settings=s,l._formatText=zp().applyArabicShaping,l._attributesManager=new mx(r,i,t),l._imageManager=new Y0,l._fontManager=new Lx,l._engine=new _u(_u.getCachedInitData()),l._domElement=l._engine.getDomElement(),l._nodeAnimationList=l._graph.createNodeAttribute({storage:32,default:0}),l._edgeAnimationList=l._graph.createEdgeAttribute({storage:32,default:0}),l._events.register([x.RELOAD_FONTS,x.RENDERER_STATE_CHANGE,x.UPDATE_ATTRIBUTES,x.ANIMATE,x.CAMERA_MOVE,x.CAMERA_PAN,x.CAMERA_ZOOM,x.CAMERA_ROTATE,x.VIEW_CHANGED,x.START_ZOOM]),l._settings.register("renderer",gg,function(u){l._updateRendererState({type:u,state:"requested",code:null,message:null}),l._engine.setRenderType(u),l._dom.refresh()}),l._settings.register("backgroundColor","white",function(u){l._engine.parseColor(u)?l._dom.refresh():(eo('Invalid background color "'+u+'" specified; will default to black.'),l._settings.set("backgroundColor","black"))}),l._settings.register("texts.hideUntilFontsLoaded",!0,function(u){l._fontManager.setHideUntilFontsLoaded(u)}),l._settings.register("imgCrossOrigin","anonymous",l._updateImageCrossOrigin),l._settings.register("cursor.default","default",l._applyCursorStyle),l._dom.setLayer("graphics",l._domElement),l._engine.setGlobalBoundaries(Zx),l._dom.beforeNextFrame().then(function(){l._initDone=!0,l._fireRendererStateChangeEvent()}),l._imageManager.onFetch(function(){l._engine.notifyPatternUpdate(),l._dom.refresh()}),l._fontManager.onFontLoaded(function(u){l._fontsNewlyLoaded.push(u),l._engine.notifyPatternUpdate(),l._dom.refresh()}),l._dom.addMediaListener("(min-resolution: 2dppx)",function(){l._dom.refresh()}),l._visibleAttributeLayer=l._attributesManager.addAttributeLayer({priority:0,name:"internal("+ic+")",tag:ic,nodeOutput:{attributes:"all"},edgeOutput:{attributes:"all"},nodeDependencies:null,edgeDependencies:null}),l._dataAttributeLayer=l._attributesManager.addAttributeLayer({priority:0,name:"internal(_data)",tag:rc,nodeDependencies:null,edgeDependencies:null}),lg(l._engine,l._attributesManager.getFlexArrays()),l._events.on(((n={})[x.CAMERA_MOVE]=function(){return l._dom.refresh()},n[x.NEW_FRAME]=function(){l._processAnimations(),l._loadGraphInGraphicsEngine(),l._render()},n[x.CLEAR_GRAPH]=function(){l._nextGeIndex=1,l._availableGeIndexes=[],l._engine.clear(),l._attributesManager.clear(),l._dom.refresh()},n[x.VIEW_CHANGED]=function(u){if(u.type===Ls.ROTATE){var d=l._graph.getEdges().filter(function(c){return c.getAttribute("adjustAnchors")});l._attributesManager.redrawElements(d)}},n[x.ADD_NODES+" "+x.ADD_EDGES]=function(u){l._attributesManager.updateForAllAttributeLayers(u.nodes||u.edges)},n[x.EXCLUDED_STATE_CHANGE]=function(u){l._visibleAttributeLayer.updateElements(u.elements)},n[x.SET_DATA]=function(u){l._dataAttributeLayer.updateElements(u.elements)},n)),_u.clearCachedInitData(),l}function _g(e,t){var n=t?e.getNodeAttribute("excluded"):e.getEdgeAttribute("excluded"),i=(t?e.getNodes("all"):e.getEdges("all"))._indexes,r=n.getMultiple(i);return n.fill(i,0),{excludedList:n,indexes:i,values:r}}function mg(e){e.excludedList.setMultiple(e.indexes,e.values)}var xc,qx=(bt(wa,xc=E),wa.prototype.register=function(e,t){var n=this;void 0===t&&(t=[]),e.forEach(function(i){if(n._events[i])throw new Error('event "'+i+'" already exists');n._events[i]=new vg(!1,i)}),t.forEach(function(i){if(n._events[i])throw new Error('event "'+i+'" already exists');n._events[i]=new vg(!0,i)})},wa.prototype.onAnyEvent=function(e){this._onAnyEvents.push(e)},wa.prototype.on=function(e,t){var n=this;return"string"==typeof e?e.split(" ").filter(function(i){return!!i}).forEach(function(i){return yg(n._events,i,"event").on(t)}):ft(e,function(i,r){return n.on(r,i)}),this},wa.prototype.removeListener=function(e){ft(this._events,function(t){t.off(e)})},wa.prototype.fire=function(e,t){void 0===t&&(t=null);var n=yg(this._events,e,"event");return this._onAnyEvents.forEach(function(i){return i(e,t)}),n.trigger(t),this},wa.prototype.once=function(e,t){var n=this,i=function(){t.apply(null,arguments),n.removeListener(i)};this.on(e,i)},wa);function wa(){var e=null!==xc&&xc.apply(this,arguments)||this;return e._events={},e._onAnyEvents=[],e}var vg=(Nl.prototype.trigger=function(e){for(var t=0,n=this._handlers;t<n.length;t++)(0,n[t])(e,this._name);return this},Nl.prototype.on=function(e){if("function"!=typeof e)throw new Error("handler is not a function");var t=this._reverseOrder?0:this._subscribers.length;return this._handlers.splice(t,0,e),this._subscribers.splice(t,0,e),this},Nl.prototype.off=function(e){for(var t;-1!==(t=this._subscribers.indexOf(e));)this._subscribers.splice(t,1),this._handlers.splice(t,1);return this},Nl);function Nl(e,t){this._subscribers=[],this._handlers=[],this._reverseOrder=e,this._name=t}function yg(e,t,n){if(!(t in e))throw new Error(n+" "+t+" does not exist");return e[t]}var xg,Hx=(bt(oo,xg=E),oo.prototype.getOriginalAttributes=function(){return this._originalAttributesLayer.getFlexArrays()},oo.prototype.setMultipleAttributes=function(e,t,n,i){var r=this;return this._graphics.animate(e,function(){r._individualAttributesLayer.setAttributeValues(e,t,i)},n)},oo.prototype.setSingleAttribute=function(e,t,n,i){var r={};return Ht(r,t,n),this.setMultipleAttributes(e,r,i)},oo.prototype.resetMultipleAttributes=function(e,t,n){var i=this;t=t||this._individualAttributesLayer.getUsedAttributeNames(e);for(var r={},o=0,a=t;o<a.length;o++)Ht(r,a[o],void 0);return this._graphics.animate(e,function(){i._individualAttributesLayer.setAttributeValues(e,r)},n)},oo.prototype.getMultipleAttributes=function(e,t){return this._graphics.getAttributeValues(e,t,!0,!1)},oo.prototype.getSingleAttribute=function(e,t){return this._graphics.getAttributeValues(e,t,!1,!1)},oo.prototype.replaceOriginalAttributes=function(e,t,n){void 0===n&&(n=[]);for(var i={},r=this._originalAttributesLayer.getUsedAttributeNames(e).filter(function(a){return!n.includes(a)}),o=0;o<r.length;++o)Ht(i,r[o],void 0);this._originalAttributesLayer.setAttributeValues(e,i),this._originalAttributesLayer.setAttributeValues(e,t)},oo.prototype.getSinglePreviousAttribute=function(e,t){return this._graphics.getAttributeValues(e,t,!1,!0)},oo.prototype.getMultiplePreviousAttributes=function(e,t){return this._graphics.getAttributeValues(e,t,!0,!0)},oo);function oo(e){var t=e.events,n=e.graphics,i=xg.call(this)||this;return i._events=t,i._graphics=n,i._events.on({"addNodes addEdges":function(r){var s=r.nodes||r.edges,l=r.objects.map(function(u){return u.attributes});i._originalAttributesLayer.setAttributeValues(s,l)}}),i._originalAttributesLayer=i._graphics.addAttributeLayer({name:"original-attributes",priority:1,nodeOutput:{attributes:"all"},edgeOutput:{attributes:"all"},nodeDependencies:null,edgeDependencies:null}),i._individualAttributesLayer=i._graphics.addAttributeLayer({name:"individual-attributes",priority:4,nodeOutput:{attributes:"all"},edgeOutput:{attributes:"all"},nodeDependencies:null,edgeDependencies:null}),i}var bc,Wx=(bt($a,bc=E),$a.prototype.onMounted=function(e,t){t.renderer&&this.update({renderer:t.renderer}),t.options&&this.update(t.options)},$a.prototype.register=function(e,t,n,i){return void 0===i&&(i=!0),this._keys.push(e),this._currentValue[e]=t,this._defaultValues[e]=t,this._onChange[e]=n||function(){},n&&i&&n(t),this},$a.prototype.update=function(e){e=Zt(e);for(var t=this._keys,n={},i=0;i<t.length;++i){var r=t[i];if(r in e){var o=e[r];void 0===o&&(o=this._defaultValues[r]),n[r]=this._currentValue[r],this._currentValue[r]=o}}var a=Object.keys(n);for(i=0;i<a.length;++i){var s=a[i],l=this._currentValue[s],u=n[s];l!==u&&this._onChange[s](l,u)}return bn(n)},$a.prototype.get=function(e){return arguments.length?this._currentValue[e]:bn(this._currentValue)},$a.prototype.set=function(e,t){var n=this._currentValue[e],i=this._onChange[e];this._currentValue[e]=t,i&&i(t,n)},$a);function $a(){var e=null!==bc&&bc.apply(this,arguments)||this;return e._currentValue={},e._onChange={},e._defaultValues={},e._keys=[],e}var Yx=(jr.prototype.getName=function(){return this._name},jr.prototype.getIndex=function(){return this._classes.getIndex(this._name)},jr.prototype.setIndex=function(e){return this._classes.setIndex(this._name,e)},jr.prototype.update=function(e){return this._classes.update(this._name,e),this},jr.prototype.getDefinition=function(){return this._classes.getDefinition(this._name)},jr.prototype.getNodes=function(){return this._classes.getElementsByClass(this._name).nodes},jr.prototype.getEdges=function(){return this._classes.getElementsByClass(this._name).edges},jr.prototype.clearNodes=function(){this.getNodes().removeClass(this._name)},jr.prototype.clearEdges=function(){this.getEdges().removeClass(this._name)},jr.prototype.add=function(e){e.addClass(this._name)},jr.prototype.remove=function(e){e.removeClass(this._name)},jr);function jr(e,t){this._classes=e,this._name=t}var bg,Xx=(bt(Kn,bg=E),Kn.prototype._getClassList=function(e){return e?this._builtinClasses:this._userClasses},Kn.prototype.createClass=function(e){void 0===e&&(e={});var t=e.name,n=e.isBuiltin,i=e.after,r=e.nodeAttributes,o=e.nodeDependencies,a=e.nodeOutput,s=e.edgeAttributes,l=e.edgeDependencies,u=e.edgeOutput;if("string"!=typeof t)throw new Error('the "name" argument should be a string');var d=this._getClassList(n),c=i?function(m,b){for(var v=0;v<m.length;++v)if(m[v].name===b)return v;return-1}(d,i)+1:d.length;if(-1===c)throw new Error('createClass: class specified as `after` parameter "'+i+'" does not exist');if(n&&!t.startsWith("_"))throw new Error('invalid builtin class name "'+t+"\": builtin classes should start with '_'");var h=new hu(this._graph),p=new Yx(this,t),g={name:t,elementSet:h,attributeLayer:this._graphics.addAttributeLayer({name:"class("+t+")",tag:t,standaloneSelectors:!0,nodeAttributes:r,edgeAttributes:s,nodeSelector:function(m,b){return b.hasElement(m)},edgeSelector:function(m,b){return b.hasElement(m)},nodeContext:h,edgeContext:h,nodeOutput:a,edgeOutput:u,nodeDependencies:o,edgeDependencies:l}),isBuiltin:n,wrapper:p};return d.splice(c,0,g),n&&d.sort(function(m,b){return Of.indexOf(m.name)-Of.indexOf(b.name)}),this._updatePriorities(n),this._classesByName[t]=g,this._events.register([Fs(t,!0,!0),Fs(t,!0,!1),Fs(t,!1,!0),Fs(t,!1,!1)]),p},Kn.prototype._updatePriorities=function(e){for(var t=this._getClassList(e),n=5+(e?.5:0),i=0;i<t.length;++i)t[i].attributeLayer.update({priority:n+5e-4*i})},Kn.prototype._get=function(e){var t=this._classesByName[e];if(!t)throw new Error('class "'+e+'" does not exist');return t},Kn.prototype.getIndex=function(e){var t=this._get(e);return this._getClassList(t.isBuiltin).indexOf(t)},Kn.prototype.setIndex=function(e,t){var n=this._get(e),i=this._getClassList(n.isBuiltin),r=i.indexOf(n),o=_e(t,0,i.length-1);i.splice(r,1),i.splice(o,0,n),this._updatePriorities(n.isBuiltin)},Kn.prototype.update=function(e,t){void 0===t&&(t={}),this._get(e).attributeLayer.update({nodeAttributes:t.nodeAttributes,edgeAttributes:t.edgeAttributes,nodeDependencies:t.nodeDependencies,edgeDependencies:t.edgeDependencies,nodeOutput:t.nodeOutput,edgeOutput:t.edgeOutput,fullOverwrite:t.fullOverwrite})},Kn.prototype.getDefinition=function(e){var t=this._get(e).attributeLayer.getDefinition();return{nodeAttributes:t.nodeAttributes,edgeAttributes:t.edgeAttributes,nodeDependencies:t.nodeDependencies,edgeDependencies:t.edgeDependencies,nodeOutput:t.nodeOutput,edgeOutput:t.edgeOutput}},Kn.prototype._addOrRemoveClassesToElements=function(e,t,n){for(var i=t.isNode,r=0;r<e.length;++r){var o=e[r],a=this._get(o),l=a.attributeLayer,u=a.elementSet.addOrRemoveElements(t,n),d=Fs(o,i,n);u.size&&(l.updateElements(u),this._events.fire(d,i?{nodes:u}:{edges:u}))}},Kn.prototype.addClassesToElements=function(e,t,n){var i=this,r=t.toList();return this._graphics.animate(t,function(){i._addOrRemoveClassesToElements(e,r,!0)},n)},Kn.prototype.removeClassesFromElements=function(e,t,n){var i=this,r=t.toList();return this._graphics.animate(t,function(){i._addOrRemoveClassesToElements(e,r,!1)},n)},Kn.prototype.hasSingleElementClass=function(e,t){return this._get(e).elementSet.hasElement(t)},Kn.prototype.getElementsClassList=function(e,t){void 0===t&&(t={});for(var n=t.includeBuiltinClasses,i=void 0!==n&&n,r=new Array(e.size),o=0;o<r.length;++o)r[o]=[];return this._addClassNamesToList(r,e,this._userClasses),i&&this._addClassNamesToList(r,e,this._builtinClasses),r},Kn.prototype._addClassNamesToList=function(e,t,n){for(var i=t.toList(),r=0;r<n.length;++r)for(var o=this._userClasses[r],a=o.name,s=o.elementSet,l=0;l<i.size;++l){var u=i.get(l);s.hasElement(u)&&e[l].push(a)}},Kn.prototype.getClassByName=function(e,t){void 0===t&&(t=!1);var n=this._classesByName[e]||null;if(t&&!n)throw new Error('class "'+e+'" does not exist');return n&&n.wrapper},Kn.prototype.getClassList=function(){return this._userClasses.map(function(e){return e.wrapper})},Kn.prototype.getElementsByClass=function(e){var t=this._get(e).elementSet.getElements();return{nodes:t.nodes.filter(function(n){return n.isVisible()}),edges:t.edges.filter(function(n){return n.isVisible()})}},Kn.prototype._onClassEvent=function(e,t,n,i){var r=Fs(e,n,i);this._events.on(r,t)},Kn.prototype.onNodeClassAdded=function(e,t){this._onClassEvent(e,t,!0,!0)},Kn.prototype.onNodeClassRemoved=function(e,t){this._onClassEvent(e,t,!0,!1)},Kn.prototype.onEdgeClassAdded=function(e,t){this._onClassEvent(e,t,!1,!0)},Kn.prototype.onEdgeClassRemoved=function(e,t){this._onClassEvent(e,t,!1,!1)},Kn);function Kn(e){var t,n=bg.call(this)||this;return n._builtinClasses=[],n._userClasses=[],n._classesByName={},n._events=e.events,n._graphics=e.graphics,n._graph=e.graph,n._events.on(((t={})[x.EXCLUDED_STATE_CHANGE]=function(i){var r=i.elements;if(i.value){var o=n._builtinClasses.map(function(a){return a.name});n._addOrRemoveClassesToElements(o,r,!1)}},t.clear=function(){n._builtinClasses.concat(n._userClasses).forEach(function(i){return i.elementSet.clear()})},t)),n}function Fs(e,t,n){return(t?"node":"edge")+"Class"+(n?"Added":"Removed")+"_"+e}for(var Ps,Su,es=[0,1],Ll=[0,2],Fl=4;Fl<65535;Fl<<=2)for(var Pl=0,Jx=es.length;Pl<Jx;Pl++)es.push(es[Pl]|Fl),Ll.push((es[Pl]|Fl)<<1);function ao(e,t){return(Ll[255&t]|es[255&e])+65536*(Ll[t>>8&255]|es[e>>8&255])+4294967296*(Ll[t>>16&255]|es[e>>16&255])}function Eg(e,t){if(void 0===t&&(t=[]),0xffffffffffff<e)throw"Only morton codes up to 48 bits are supported.";if(!Ps){Ps={},Su={};for(var n=0;n<256;n++)Ps[ao(n,0)]=n,Su[ao(0,n)]=n}var i=Ps[21845&e],r=Su[43690&e];return 65535<e&&(i|=Ps[21845&(e/=65536)]<<8,r|=Su[43690&e]<<8,65535<e&&(i|=Ps[21845&(e/=65536)]<<16,r|=Su[43690&e]<<16)),t[0]=i,t[1]=r,t}function _r(e,t,n){void 0===e&&(e=Int32Array),void 0===t&&(t=16),void 0===n&&(n=8),this._BIG_LIST=new Uint8Array([-1])[0],this._ArrayType=e,this._capacity=t,this._MAX_LIST_SIZE=n,this._freeIndex=-1,this.clear()}ao.code=function(e,t,n){if(24<e)throw"Morton codes are only supported up to Z=24";var i=1<<24-e;return ao(t*i,n*i)},ao.range=function(e,t,n){if(24<e)throw"Morton ranges are only supported up to Z=24";var i=1<<24-e,r=ao(t*i,n*i);return[r,r+i*i-1]},ao.reverse=Eg,ao.decode=function(e,t){var n=Eg(t),i=1<<24-e;return[n[0]/i,n[1]/i]},ao.min=function(e,t){var r=2863311530&e,o=2863311530&t;return Math.min(1431655765&e,1431655765&t)+Math.min(r,o)};var Sg={averageSize:{configurable:!0}};function Ag(e,t){var n=new e.constructor(t);return n.set(e),n}function Dl(e,t,n){return n|ao(e,t)<<4}function Ec(e,t){return void 0===t&&(t=[]),ao.reverse(e>>4,t),t[2]=e&Kx,t}function ji(e,t,n,i,r){void 0===n&&(n=16),void 0===i&&(i=65536),void 0===r&&(r=Int32Array),this._intersects=e,this._getBounds=t,this._occupied=0,this._cells=new _r(r),this._objectsAtLevel=new Array(16).fill(0),this._idToCode=new wg,this._codeCache=[],this._offset=i,this._min=-i,this._max=i,this._resolution=65535/(this._max-this._min),this._minCellSize=n*this._resolution,this._bounds=new Array(64);for(var o=0;o<16;o++)this._bounds[4*o]=1/0,this._bounds[4*o+1]=1/0,this._bounds[4*o+2]=-1/0,this._bounds[4*o+3]=-1/0}_r.prototype.clear=function(){this._buffer=new this._ArrayType(this._capacity*this._MAX_LIST_SIZE),this._sizes=new Uint8Array(this._capacity),this._bigLists=[],this._nextIndex=0,this._idToIndex={},this._constList=new Array(this._MAX_LIST_SIZE)},_r.prototype.addEntry=function(e){var t;return-1===this._freeIndex?t=this._nextIndex++:(t=this._freeIndex,this._freeIndex=-1),(this._idToIndex[e]=t)>=this._capacity&&this._expand(t+1),this._sizes[t]=0,t},_r.prototype.getItems=function(e){var t=this._idToIndex[e];if(void 0!==t){var n=this._sizes[t],i=this._MAX_LIST_SIZE*t;if(n<=this._MAX_LIST_SIZE){for(var r=0,o=this._constList.length=n;r<o;++r)this._constList[r]=this._buffer[i+r];return this._constList}if(n===this._BIG_LIST)return this._bigLists[this._buffer[i]]}},_r.prototype.removeEntry=function(e){var t=this._idToIndex[e];this._sizes[t]===this._BIG_LIST&&(this._bigLists[this._buffer[this._MAX_LIST_SIZE*t]].length=0),this._sizes[t]=0,this._freeIndex=t},_r.prototype.size=function(e){var t=this._idToIndex[e],n=this._sizes[t];return n<=this._MAX_LIST_SIZE?n:this._bigLists[this._buffer[t*this._MAX_LIST_SIZE]].length},_r.prototype.sizes=function(e){for(var t=this._sizes,n=this._bigLists,i=this._buffer,r=this._MAX_LIST_SIZE,o=e.length,a=new Array(o),s=0;s<o;s++){var l=this._idToIndex[e[s]],u=t[l];a[s]=u<=r?u:n[i[l*r]].length}return a},_r.prototype.addTo=function(e,t){var n=this._idToIndex[e],i=this._sizes[n],r=n*this._MAX_LIST_SIZE;if(i<this._MAX_LIST_SIZE)this._buffer[r+i]=t,this._sizes[n]=i+1;else if(i===this._BIG_LIST)this._bigLists[this._buffer[r]].push(t);else{for(var a=new Array(this._MAX_LIST_SIZE),s=0;s<this._MAX_LIST_SIZE;++s)a[s]=this._buffer[r+s];a.push(t),this._bigLists.push(a),this._sizes[n]=this._BIG_LIST,this._buffer[r]=this._bigLists.length-1}},_r.prototype.removeFrom=function(e,t){this.removeFromAndGetSize(e,t)},_r.prototype.removeFromAndGetSize=function(e,t){var n=this._idToIndex[e],i=this._sizes[n],r=this._MAX_LIST_SIZE*n;if(i<=this._MAX_LIST_SIZE){for(var o=r,a=r+i;o<a;++o)if(this._buffer[o]===t)return--i,this._buffer[o]=this._buffer[a-1],this._sizes[n]=i}else if(i===this._BIG_LIST){var l=this._bigLists[this._buffer[r]],u=l.indexOf(t);if(-1!==u)return l.splice(u,1),l.length}},_r.prototype.reserve=function(e){this._capacity<e&&this._expand(e)},_r.prototype._expand=function(e){this._capacity=Math.pow(2,Math.ceil(Math.log2(e))),this._buffer=Ag(this._buffer,this._capacity*this._MAX_LIST_SIZE),this._sizes=Ag(this._sizes,this._capacity)},_r.prototype.has=function(e){var t=this._idToIndex[e];return!(void 0===t||t>=this._capacity)&&0!==this._sizes[t]},Sg.averageSize.get=function(){for(var e=0,t=0;t<this._capacity;t++)e+=this._sizes[t];return e/this._capacity},Object.defineProperties(_r.prototype,Sg);var wg="undefined"==typeof Map?function(){function e(){this._values={},this._size=0}var t={size:{configurable:!0}};return t.size.get=function(){return this._size},e.prototype.has=function(n){return!!this._values[n]},e.prototype.set=function(n,i){n in this._values||this._size++,this._values[n]=i},e.prototype.get=function(n){return this._values[n]},e.prototype.delete=function(n){n in this._values&&(delete this._values[n],this._size--)},e.prototype.keys=function(){return Object.keys(this._values)},e.prototype.clear=function(){this._values={},this._size=0},Object.defineProperties(e.prototype,t),e}():Map,Qx="undefined"==typeof Set?function(){function e(){this._values={},this._size=0}var t={size:{configurable:!0}};return t.size.get=function(){return this._size},e.prototype.has=function(n){return!!this._values[n]},e.prototype.add=function(n){n in this._values||this._size++,this._values[n]=!0},e.prototype.delete=function(n){n in this._values&&(delete this._values[n],this._size--)},e.prototype.keys=function(){return Object.keys(this._values)},e.prototype.clear=function(){this._values={},this._size=0},Object.defineProperties(e.prototype,t),e}():Set,Kx=(1<<Math.log2(16))-1,Sc={averageCellOccupancy:{configurable:!0},size:{configurable:!0}};ji.prototype.setMinCellSize=function(e){return this._minCellSize=e,this},ji.prototype.setOffset=function(e){return this._offset=e,this._min=-e,this._max=e,this._resolution=65535/(this._max-this._min),this},ji.prototype.setIntersector=function(e){return this._intersects=e,this},ji.prototype.setBoundsGetter=function(e){return this._getBounds=e,this},ji.prototype.insert=function(e,t){void 0===t&&(t=this._getBounds(e));var n,i=Math.max(t[2]-t[0],t[3]-t[1]),r=this._minCellSize;for(n=0;r<i&&n<16;n++)r*=2;var o=this._resolution,a=this._min,s=o*(.5*(t[2]+t[0])-a)/r|0,l=o*(.5*(t[3]+t[1])-a)/r|0,u=Dl(s,l,n);this._cells.has(u)||this._cells.addEntry(u),this._cells.addTo(u,e),this._objectsAtLevel[n]++,this._occupied|=1<<n;var d=4*n,c=this._bounds;return s<c[d]&&(c[d]=s),l<c[1+d]&&(c[1+d]=l),s>c[2+d]&&(c[2+d]=s),l>c[3+d]&&(c[3+d]=l),this._idToCode.set(e,u),u},ji.prototype.has=function(e){return this._idToCode.has(e)},ji.prototype.update=function(e,t){return this.remove(e),this.insert(e,t)},ji.prototype.remove=function(e){var t=this._idToCode.get(e);Ec(t,this._codeCache);var n=this._codeCache[2];return 0==--this._objectsAtLevel[n]&&(this._occupied&=~(1<<n),this._bounds[4*n]=1/0,this._bounds[4*n+1]=1/0,this._bounds[4*n+2]=-1/0,this._bounds[4*n+3]=-1/0),this._cells.removeFrom(t,e),this._idToCode.delete(e),this},ji.prototype.query=function(e){var t=e[0],n=e[1],i=e[2],r=e[3],o=this._cells,a=this._bounds,s=this._intersects,l=this._min,u=this._resolution,d=this._minCellSize,c=this._occupied,h=[];t=u*(t-l),n=u*(n-l),i=u*(i-l),r=u*(r-l);for(var p=0;p<16&&0!==c;d*=2,c>>=1,p++)if(0!=(1&c))for(var g=1/d,m=4*p,b=Math.max(a[m],t*g-1>>0),v=Math.max(a[1+m],n*g-1>>0),y=Math.min(a[2+m],i*g+1>>0),S=Math.min(a[3+m],r*g+1>>0),A=b;A<=y;A++)for(var C=v;C<=S;C++){var O=Dl(A,C,p),N=o.getItems(O);if(void 0!==N)for(var P=0;P<N.length;P++){var F=N[P];s(F,e)&&h.push(F)}}return h},ji.prototype.collisions=function(e,t){if(void 0===t&&(t=this._getBounds),"function"!=typeof t)throw new Error("getBounds function is required to get the object bounds");for(var n=Array.from(this._idToCode.keys()),i=this._min,r=this._resolution,o=this._cells,a=new wg,s=[],l=0;l<n.length;l++){var u=0,d=this._minCellSize,c=this._occupied,h=n[l],p=t(h),g=p[0],m=p[1],b=p[2],v=p[3],y=Math.max(b-g,v-m);for(u=0;d<y;u++)d*=2,c>>=1;g=r*(g-i),m=r*(m-i),b=r*(b-i),v=r*(v-i);for(var S=u;S<16&&0!==c;d*=2,c>>=1,S++)if(0!=(1&c))for(var A=1/d,C=m*A-1>>0,O=b*A+1>>0,N=v*A+1>>0,P=g*A-1>>0;P<=O;P++)for(var F=C;F<=N;F++){var L=Dl(P,F,S);if(a.get(L)!==l){a.set(L,l);var B=o.getItems(L);if(void 0!==B)for(var Y=0;Y<B.length;Y++){var X=B[Y];X!==h&&e(h,X)&&s.push(h,X)}}}}return function(ae){for(var ie=new Qx,U=[],W=0;W<ae.length;W+=2){var ce=ae[W],he=ae[W+1],Ee=ce<he?ce*he+(he-ce-1)*(he-ce-1)/4:ce*he+(ce-he-1)*(ce-he-1)/4;ie.has(Ee)||(ie.add(Ee),U.push(ce,he))}return U}(s)},ji.prototype.clear=function(){this._occupied=0,this._cells.clear(),this._idToCode.clear(),this._objectsAtLevel=new Array(16).fill(0),this._bounds=new Array(64);for(var e=0;e<16;e++)this._bounds[4*e]=1/0,this._bounds[4*e+1]=1/0,this._bounds[4*e+2]=-1/0,this._bounds[4*e+3]=-1/0;return this},ji.prototype.keyToBBox=function(e){var t=Ec(e),n=t[0],i=t[1],o=this._minCellSize*(1<<t[2]),a=this._min,s=this._resolution;return[n*o/s+a,i*o/s+a,(n+1)*o/s+a,(i+1)*o/s+a]},ji.prototype.keys=function(){return Object.keys(this._cells._idToIndex)},Sc.averageCellOccupancy.get=function(){return this._cells.averageSize},Sc.size.get=function(){return this._idToCode.size},Object.defineProperties(ji.prototype,Sc),ji.code=Dl,ji.decode=Ec;var Tg,$x=["x","y","radius"],eb=["width","curvature"],tb=(bt(Li,Tg=E),Li.prototype._getIntersector=function(){var e=this._graph,t=e.getNodeAttributes(["x","y","radius"]),n=t[0],i=t[1],r=t[2],o=e.getEdgeAttributes(["source","target","width","curvature"]),a=o[0],s=o[1],l=o[2],u=o[3],d={x:0,y:0,x1:0,y1:0,x2:0,y2:0};return function(c,h){if(c<0){var p=a.get(c=-c),g=s.get(c),m=u.get(c),b=l.get(c)/2,v=n.get(p),y=i.get(p),S=n.get(g),A=i.get(g);return p===g?(Ya(v,y,m,r.get(p),0,d),yf(v,y,d.x1,d.y1,d.x2,d.y2,S,A,h[0]-b,h[1]-b,h[2]+b,h[3]+b)):0===m?Xd(v,y,S,A,h[0]-b,h[1]-b,h[2]+b,h[3]+b):(fa(v,y,S,A,m,d),vf(v,y,d.x,d.y,S,A,h[0]-b,h[1]-b,h[2]+b,h[3]+b))}return lc(n.get(c),i.get(c),r.get(c),h[0],h[1],h[2],h[3])}},Li.prototype._boundsGetter=function(){var e=this._graph,t=e.getNodeAttributes(["x","y","radius"]),n=t[0],i=t[1],r=t[2],o=e.getEdgeAttributes(["source","target","curvature"]),a=o[0],s=o[1],l=o[2],u={x:0,y:0,x1:0,y1:0,x2:0,y2:0},d={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(c){if(c<0){var h=a.get(c=-c),p=s.get(c),g=l.get(c),m=n.get(h),b=i.get(h),v=n.get(p),y=i.get(p);h===p?(Ya(m,b,g,r.get(h),0,u),gl(m,b,u.x1,u.y1,u.x2,u.y2,v,y,d)):0===g?(d.minX=Math.min(m,v),d.minY=Math.min(b,y),d.maxX=Math.max(m,v),d.maxY=Math.max(b,y)):(fa(m,b,v,y,g,u),Kd(m,b,u.x,u.y,v,y,d))}else{var S=n.get(c),A=i.get(c),C=r.get(c);d.minX=S-C,d.minY=A-C,d.maxX=S+C,d.maxY=A+C}return[d.minX,d.minY,d.maxX,d.maxY]}},Li.prototype.reindex=function(){this._graphics.forceAttributesComputation(),this._index.clear(),this._elementsToUpdate.clear(),this._updateItems(this._graph.getNodes("all")._indexes,this._graph.getEdges("all")._indexes)},Li.prototype._updateIndex=function(){if(!this._elementsToUpdate.isEmpty()){var e=this._elementsToUpdate.getElements();this._updateItems(e.nodes._indexes,e.edges._indexes),this._elementsToUpdate.clear()}},Li.prototype._updateItems=function(e,t){for(var n=this._index,i=this._removedNodes,r=this._removedEdges,o=[],a=[],s=0;s<e.length;s++){var l=e[s];0!==i.get(l)?o.push(l):(n.has(l)&&o.push(l),a.push(l))}for(s=0;s<t.length;s++)0!==r.get(-(l=-t[s]))?o.push(l):(n.has(l)&&o.push(l),a.push(l));for(var u=0,d=o;u<d.length;u++)n.remove(l=d[u]);for(var c=0,h=a;c<h.length;c++)n.insert(l=h[c])},Li.prototype.getNodesInScreenByDistance=function(e){var t=e.getPositionOnScreen(),n=t.x,i=t.y;return this._graph.getNodes().filter(function(r){return r.isInScreen()&&r!==e}).sort(function(r,o){var a=r.getPositionOnScreen(),s=o.getPositionOnScreen();return vi(a.x,a.y,n,i)-vi(s.x,s.y,n,i)})},Li.prototype.getNearestNodesForNode=function(e,t,n){void 0===t&&(t=240);var i=e.getPosition();return this.getNearestNodes(i.x,i.y,t,n,e)},Li.prototype.getNearestNodes=function(e,t,n,i,r){if(this._updateIndex(),i){var o=this._camera.screenToGraphVector({x:n,y:n});n=vi(0,0,o.x,o.y)}return this._getNearestNodes(e,t,n,r)},Li.prototype._getNearestNodes=function(e,t,n,i){for(var r=[],o=n*n,a=i?i._index:0,s=this._graph.getNodes()._indexes,l=this._graph.getNodeAttributes(["x","y"]),u=l[0],d=l[1],c=0,h=s.length;c<h;c++){var p=s[c];if(p!==a){var g=e-u.get(p),m=t-d.get(p);g*g+m*m<=o&&r.push(p)}}return this._graph.nodeList(new Uint32Array(r))},Li.prototype.queryRaw=function(e,t,n,i){this._updateIndex();var r=this._queryBounds;r[0]=e,r[1]=t,r[2]=n,r[3]=i;var o=this._index.query(r),a=this._queryResult,s=a.nodes,l=a.edges;s.length=l.length=0;for(var u=0;u<o.length;u++){var d=o[u];d<0?l.push(-d):s.push(d)}return this._queryResult},Li.prototype.queryRawProjected=function(e,t,n,i){var r=this._queryBounds;return r[0]=e,r[1]=t,r[2]=n,r[3]=i,this._camera.projectBounds(r),this.queryRaw(r[0],r[1],r[2],r[3])},Li.prototype.query=function(e,t,n,i){var r=this._graph,o=this.queryRaw(e,t,n,i),s=o.edges;return{nodes:r.nodeList(new Uint32Array(o.nodes.slice())),edges:r.edgeList(new Uint32Array(s.slice()))}},Li.prototype.queryProjected=function(e,t,n,i){var r=this._graph,o=this.queryRawProjected(e,t,n,i),s=o.edges;return{nodes:r.nodeList(new Uint32Array(o.nodes.slice())),edges:r.edgeList(new Uint32Array(s.slice()))}},Li.prototype.getNodesByBoundingBox=function(e,t,n,i,r){if(this._updateIndex(),r){var o=void 0;e=(o=this._camera.screenToGraphVector({x:e,y:t})).x,t=o.y,n=(o=this._camera.screenToGraphVector({x:n,y:i})).x,i=o.y}for(var a=this._graph,s=a.getNodes()._indexes,l=[],u=a.getNodeAttribute("excluded"),d=a.getNodeAttributes(["x","y"]),c=d[0],h=d[1],p=0,g=s.length;p<g;p++){var m=s[p];if(!u.get(m)){var b=c.get(m),v=h.get(m);e<=b&&b<=n&&t<=v&&v<=i&&l.push(m)}}return a.nodeList(new Uint32Array(l))},Li.prototype.toggleDebug=function(e){e?(this._canvas=di(),this._graphics.addCanvas(this._canvas),this._ctx=this._canvas.getContext("2d")):this._canvas&&(this._graphics.removeCanvas(this._canvas),this._canvas=this._ctx=null)},Li.prototype.renderDebug=function(e){this._ctx||this.toggleDebug(!0),function(t,n){function i(B,Y){return{x:(B-y)*v,y:(Y-S)*v}}var r=void 0===n?{}:n,o=r.cells,a=void 0===o||o,s=r.boxes,l=void 0===s||s,u=r.query,d=void 0===u||u,c=Nn(),h=t._ctx,p=t._canvas,g=t._camera,m=t._index,b=-g.getAngle(),v=g.getZoom()*c,y=g._x,S=g._y,A=g._dimensions.width*c/2,C=g._dimensions.height*c/2,O=m.keys().map(function(B){return m.keyToBBox(B)}),N=Array.from(m._idToCode.keys()).map(function(B){return m._getBounds(B)});if(h.clearRect(0,0,p.width,p.height),h.save(),h.translate(A,C),h.rotate(b),a&&(h.beginPath(),h.lineWidth=1,h.strokeStyle="#707070",O.forEach(function(B){var Y=i(B[0],B[1]),X=i(B[2],B[3]);h.rect(Y.x,Y.y,X.x-Y.x,X.y-Y.y)}),h.stroke()),l&&(h.beginPath(),h.lineWidth=1,h.strokeStyle="#ff7070",N.forEach(function(B){var Y=i(B[0],B[1]),X=i(B[2],B[3]);h.rect(Y.x,Y.y,X.x-Y.x,X.y-Y.y)}),h.closePath(),h.stroke()),d&&t._queryBounds){var P=t._queryBounds;h.beginPath(),h.lineWidth=2,h.strokeStyle="#3030ff";var F=i(P[0],P[1]),L=i(P[2],P[3]);h.rect(F.x,F.y,L.x-F.x,L.y-F.y),h.closePath(),h.stroke()}h.restore()}(this,e)},Li);function Li(e){var t=Tg.call(this)||this;t._minCellSize=8;var n=e.graph,i=e.camera,r=e.graphics,o=e.events;return t._graph=n,t._camera=i,t._graphics=r,t._index=new ji(t._getIntersector(),t._boundsGetter(),t._minCellSize,1e6),t._elementsToUpdate=new hu(t._graph),t._removedNodes=n.getNodeAttribute("removed"),t._removedEdges=n.getEdgeAttribute("removed"),t._queryResult={edges:[],nodes:[]},t._queryBounds=[0,0,0,0],o.on({"addNodes addEdges removeNodes removeEdges updateAttributes":function(a){if(a.nodes&&(!a.nodeAttributes||a.nodeAttributes.some(function(l){return $x.includes(l)}))){var s=a.nodes.fastGetAdjacentElements().edges;t._elementsToUpdate.addElements(a.nodes),t._elementsToUpdate.addElements(s)}a.edges&&(a.edgeAttributes&&!a.edgeAttributes.some(function(l){return eb.includes(l)})||t._elementsToUpdate.addElements(a.edges))},clear:function(){t._index.clear(),t._elementsToUpdate.clear()}}),t}var Mg,Yt,Ac,nb=(bt(Wn,Mg=E),Wn.prototype.onMounted=function(){this.locateGraph({},!0)},Wn.prototype.locateGraph=function(e,t){var n=this;return void 0===t&&(t=!1),t?this._locateGraph(e):this._transformations.whenApplied().then(function(){return n._locateGraph(e)})},Wn.prototype._locateGraph=function(e){return this._locateBoundingBox(this.getGraphBoundingBox(),e)},Wn.prototype.locateElements=function(e,t){var n=this;return this._transformations.whenApplied().then(function(){return n._locateBoundingBox(n.getBoundingBox(e),t)})},Wn.prototype.locateRawGraph=function(e,t){return this._locateBoundingBox(this.getRawGraphBoundingBox(e),t)},Wn.prototype.getGraphBoundingBox=function(){return this._cacheValid||this._updateCache(),Object.assign({},this._cachedGraphBoundingBox)},Wn.prototype.forceInvalidCache=function(){this._invalidCache()},Wn.prototype._invalidCache=function(){this._cacheValid=!1},Wn.prototype._updateCache=function(){this._cacheValid=!0,this._cachedGraphBoundingBox=this.getBoundingBox(this._graph.getNodes())},Wn.prototype.getBoundingBox=function(e,t){return e.isNode?this._getNodesBoundingBox(e.toList()):this._getEdgesBoundingBox(e.toList(),t)},Wn.prototype._getNodesBoundingBox=function(e){this._graphics.forceAttributesComputation();for(var t=this._graphics.getNodeAttributes(),n=[],i=[],r=[],o=[],a=0;a<e.size;++a){var s=e._indexes[a];if(0===t.excluded.get(s)){var l=t.x.get(s),u=t.y.get(s),d=2*t.radius.get(s);"scaled"===t.scalingMethod.get(s)?r.push(d):o.push(d),n.push(l),i.push(u)}}return new Cr({xValues:n,yValues:i,scaledSizeValues:r,fixedSizeValues:o})},Wn.prototype._getEdgesBoundingBox=function(e,t){void 0===t&&(t=!1),this._graphics.forceAttributesComputation();for(var n=this._graphics.getEdgeAttributes(),i=this._graphics.getNodeAttributes(),r={x1:0,y1:0,x2:0,y2:0},o={x:0,y:0},a={minX:0,minY:0,maxX:0,maxY:0},s=[],l=[],u=[],d=[],c=0;c<e.size;++c){var h=e._indexes[c],p=n.source.get(h),g=n.target.get(h),m=n.curvature.get(h),b=i.x.get(p),v=i.y.get(p),y="scaled"===i.scalingMethod.get(p),S=2*i.radius.get(p),A=i.x.get(g),C=i.y.get(g),O="scaled"===i.scalingMethod.get(g),N=2*i.radius.get(g);y?u.push(S):d.push(S),O?u.push(N):d.push(N),t||0===m?(s.push(b,A),l.push(v,C)):(p===g?(Ya(b,v,m,S/2,0,r),gl(b,v,r.x1,r.y1,r.x2,r.y2,A,C,a)):(fa(b,v,A,C,m,o),Kd(b,v,o.x,o.y,A,C,a)),s.push(a.minX,a.maxX),l.push(a.minY,a.maxY))}return new Cr({xValues:s,yValues:l,scaledSizeValues:u,fixedSizeValues:d})},Wn.prototype.getRawGraphBoundingBox=function(e){for(var t=e.nodes.length,n=new Array(t),i=new Array(t),r=new Array(t),o=0;o<t;o++){var a=e.nodes[o].attributes||{};n[o]=a.x||0,i[o]=a.y||0,r[o]=a.radius||5}return new Cr({xValues:n,yValues:i,scaledSizeValues:r})},Wn.prototype._computeCameraConfig=function(e,t,n){"number"==typeof t&&(t={left:t,right:t,top:t,bottom:t});var i,r=void 0===t.left?40:t.left,o=void 0===t.right?40:t.right,a=void 0===t.top?40:t.top,s=void 0===t.bottom?40:t.bottom,l=this._dom.getDimensions(),u=r+o,d=a+s,c=0===e.width?e.maxFixedSize:e.width,h=0===e.height?e.maxFixedSize:e.height,y=(i=[(l.width-u)/(c+e.maxScaledSize),(l.height-d)/(h+e.maxScaledSize),(l.width-u-e.maxFixedSize)/c,(l.height-d-e.maxFixedSize)/h,n/e.maxScaledSize||NaN].filter(function(S){return isFinite(S)&&0<S})).length?gn(i):1;return{x:e.cx+(o-r)/(2*y),y:e.cy+(s-a)/(2*y),zoom:y}},Wn.prototype._locateBoundingBox=function(e,t){if(void 0===t&&(t={}),isNaN(e.cx))return Promise.resolve();var n=t.padding,r=t.easing,o=void 0===r?"quadraticInOut":r,a=t.duration,s=void 0===a?0:a,l=t.maxNodeSizeOnScreen,d=t.ignoreZoomLimits,c=void 0!==d&&d,h=this._computeCameraConfig(e,void 0===n?{}:n,void 0===l?200:l),p=h.x,g=h.y,m=h.zoom,b=m/this._camera.getZoom();return this._moveCamera(p,g,m,s,o,b,c)},Wn.prototype._moveCamera=function(e,t,n,i,r,o,a){return 1.01<o?(this._camera.setCenter({x:e,y:t},{duration:i,easing:r,ignoreZoomLimits:a}),this._camera.setZoom(n,{duration:i,easing:r,ignoreZoomLimits:a,startAfter:.5})):o<.99?(this._camera.setCenter({x:e,y:t},{duration:i,easing:r,ignoreZoomLimits:a,startAfter:.5}),this._camera.setZoom(n,{duration:i,easing:r,ignoreZoomLimits:a})):this._camera.setCenter({x:e,y:t},{duration:i,easing:r,ignoreZoomLimits:a})},Wn.prototype.computeConfigForBounds=function(e,t){void 0===t&&(t={});var n=t.padding,r=t.maxNodeSizeOnScreen;return this._computeCameraConfig(e,void 0===n?{}:n,void 0===r?200:r)},Wn.prototype.layoutDataBoundingBox=function(e){for(var t=e.x,n=e.y,i=e.indexes,r=this._graphics.getNodeAttributes(),o=[],a=[],s=[],l=[],u=0;u<i.length;++u){var d=i[u],c=t[u],h=n[u],p=2*r.radius.get(d),g="scaled"===r.scalingMethod.get(d);o.push(c),a.push(h),g?s.push(p):l.push(p)}return new Cr({xValues:o,yValues:a,scaledSizeValues:s,fixedSizeValues:l})},Wn.prototype.isEdgeInPolygon=function(e,t){var n=e.getSource(),i=e.getTarget(),r=n.getPositionOnScreen(),o=i.getPositionOnScreen();if(bu(r.x,r.y,t)||bu(o.x,o.y,t))return!0;for(var a=Ig(e,this._camera.getZoom()),s=0;s<a.length-1;++s)for(var l=a[s],u=a[s+1],d=0;d<t.length-1;++d){var c=t[d],h=t[d+1];if(Is(l.x,l.y,u.x,u.y,c.x,c.y,h.x,h.y))return!0}return!1},Wn.prototype.isElementInView=function(e,t){var n=(void 0===t?{}:t).margin,i=void 0===n?0:n,r=this._camera.getSize(),o={minX:-i,minY:-i,maxX:r.width+i,maxY:r.height+i};return e.isNode?this.isNodeInRectangle(e,o):this.isEdgeInRectangle(e,o)},Wn.prototype.isNodeInRectangle=function(e,t){var n=e.getPositionOnScreen(),i=e.getAttribute("radius")*this._camera.getZoom();return n.x+i>=t.minX&&n.x-i<=t.maxX&&n.y+i>=t.minY&&n.y-i<=t.maxY},Wn.prototype.isNodeInPolygon=function(e,t){var n=e.getPositionOnScreen();return bu(n.x,n.y,t)},Wn.prototype.isEdgeInRectangle=function(e,t){for(var n=Ig(e,this._camera.getZoom()),i=0;i<n.length-1;++i){var r=n[i],o=n[i+1];if(Xd(r.x,r.y,o.x,o.y,t.minX,t.minY,t.maxX,t.maxY))return!0}return!1},Wn);function Wn(e){var t=Mg.call(this)||this;return t._cacheValid=!0,t._cachedGraphBoundingBox=new Cr,t._dom=e.dom,t._events=e.events,t._camera=e.camera,t._graph=e.graph,t._graphics=e.graphics,t._settings=e.settings,t._sync=e.sync,t._transformations=e.transformations,t._events.on({"addNodes removeNodes addEdges removeEdges excludedStateChange clear updateAttributes":function(){return t._invalidCache()}}),t}function Ig(e,t){var n=e.getAttribute("curvature"),i=e.getSource(),r=e.getTarget(),o=i.getPositionOnScreen();if(i===r){var a=5*(n+i.getAttribute("radius"))*t,s=o.x,l=o.y,u=s-a,d=l,c=s,h=l+a;return[o].concat([.2,.4,.6,.8].map(function(O){return vu(O,s,l,s,l,u,d,c,h)}),[o])}var p=r.getPositionOnScreen();if(0===n)return[o,p];var g=p.x-o.x,m=p.y-o.y,b=Math.sqrt(g*g+m*m),S=n*(b/5)*2,A=(o.x+p.x)/2+m/b*S,C=(o.y+p.y)/2+-g/b*S;return[o].concat([.25,.5,.75].map(function(O){return Qd(O,o.x,o.y,p.x,p.y,A,C)}),[p])}(Ac=Yt=Yt||{}).LEFT="left",Ac.MIDDLE="middle",Ac.RIGHT="right";var ib=Hi&&"msLaunchUri"in navigator&&!("documentMode"in document);if(Rr){var kg=[];document.documentElement.addEventListener("mousemove",function(e){for(var t=0;t<kg.length;t++)kg[t](e)})}var Og,rb=(bt(ur,Og=E),Object.defineProperty(ur.prototype,"x",{get:function(){return this._position.x},enumerable:!0,configurable:!0}),Object.defineProperty(ur.prototype,"y",{get:function(){return this._position.y},enumerable:!0,configurable:!0}),Object.defineProperty(ur.prototype,"left",{get:function(){return this._left},enumerable:!0,configurable:!0}),Object.defineProperty(ur.prototype,"right",{get:function(){return this._right},enumerable:!0,configurable:!0}),Object.defineProperty(ur.prototype,"middle",{get:function(){return this._middle},enumerable:!0,configurable:!0}),ur.prototype._isEnabled=function(){return this._settings.get("mouse.enabled")},ur.prototype._isWheelEnabled=function(){return this._settings.get("mouse.wheelEnabled")},ur.prototype._disableWheelUntilMouseDown=function(){return this._settings.get("mouse.disableWheelUntilMouseDown")},ur.prototype._getDoubleClickTimer=function(){return this._settings.get("mouse.doubleClickTimer")},ur.prototype._resetClickCounter=function(e,t){void 0===t&&(t=0),e?this._clickCounter[e]=t:(this._clickCounter.left=t,this._clickCounter.middle=t,this._clickCounter.right=t),this._dom.clearTimeout(this._dbclickTimer),this._lastMouseDownTarget=null},ur.prototype._setXY=function(e){var t=this._domElt.getBoundingClientRect();return!!(this._bounds=t)&&(this._evt=e,this._button=Ti[e.button],this._px=this._position.x,this._py=this._position.y,this._position.x=e.clientX-t.left,this._position.y=e.clientY-t.top,this._left=this._buttons.left,this._right=this._buttons.right,this._middle=this._buttons.middle,!0)},ur.prototype._applyMouseWheelZoom=function(e){var t;this._setXY(e)&&this._events.fire(x.MOUSE_WHEEL,{delta:(t=e,ib?t.wheelDeltaY/2:t.deltaY&&0===t.deltaMode?-t.deltaY/Nn():t.deltaY&&1===t.deltaMode?20*-t.deltaY:t.deltaY&&2===t.deltaMode?60*-t.deltaY:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?20*-t.detail:t.detail?t.detail/-32765*60:0),x:this._position.x,y:this._position.y,domEvent:this._evt})},ur.prototype._initializeListeners=function(){var e=this,t=this._domElt,n=this._dom;ho&&this._dom.addElementEventListener(document,"contextmenu",function(r){e._lastMouseDownTarget&&r.target!==e._lastMouseDownTarget&&r.preventDefault()}),n.addElementEventListener(t,"contextmenu",function(r){e._setXY(r),e._dom.hasFocus()&&e._settings.get("mouse.enabled")&&r.preventDefault()},!1),n.addElementEventListener(t,"onwheel"in t?"wheel":void 0!==t.onmousewheel?"mousewheel":"DOMMouseScroll",this._onMouseWheel),n.addElementEventListener(t,"mousemove",this._onMouseMove),n.addElementEventListener(t,"mouseleave",function(){e._isEnabled()&&(e._dom.blur(),e._events.fire(x.MOUSE_LEAVE,{domEvent:e._evt}))}),n.addElementEventListener(t,"mousedown",this._onMouseDown),n.addElementEventListener(t,"mouseup",this._onMouseUp)},ur);function ur(e){var t=e.dom,n=e.position,i=e.settings,r=e.events,o=e.graphics,a=Og.call(this)||this;return a._px=0,a._py=0,a._pressX=0,a._pressY=0,a._left=!1,a._middle=!1,a._right=!1,a._evt=null,a._bounds=null,a._clickCounter={left:0,middle:0,right:0},a._buttons={left:!1,middle:!1,right:!1},a._button=null,a._lastMouseDownTarget=null,a._skipNextMove=!1,a._onMouseWheel=function(s){a._isEnabled()&&a._isWheelEnabled()&&(!a._disableWheelUntilMouseDown()||a._dom.hasFocus())&&(s.preventDefault(),s.stopPropagation(),a._applyMouseWheelZoom(s))},a._onMouseMove=function(s){if(a._isEnabled()&&a._setXY(s)){var l=a._position.x,u=a._position.y,d=l-a._px,c=u-a._py;0==d&&0==c||(a._skipNextMove?a._skipNextMove=!1:6<=vi(l,u,a._pressX,a._pressY)&&(a._resetClickCounter(),a._events.fire(x.MOUSE_MOVE,{x:l,y:u,dx:d,dy:c,domEvent:a._evt})))}},a._onDocumentMouseMove=function(s){if(a._isEnabled()&&a._setXY(s)){var l=a._position.x,u=a._position.y,d=a._bounds;(l<0||l>d.width||u<0||u>d.height)&&a._events.fire(x.DOCUMENT_MOUSE_MOVE,{x:l,y:u,dx:l-a._px,dy:u-a._py,domEvent:a._evt})}},a._onMouseUp=function(s){if(a._isEnabled()&&a._setXY(s)){var l=a._position.x,u=a._position.y,d=a._button,c=a._evt;a._buttons[d]=!1,1===a._clickCounter[a._button]?a._events.fire(x.MOUSE_CLICK,{button:d,x:l,y:u,domEvent:c}):1<a._clickCounter[d]&&(a._events.fire(x.MOUSE_DOUBLE_CLICK,{button:d,x:l,y:u,domEvent:c}),a._resetClickCounter(d)),a._events.fire(x.MOUSE_UP,{button:d,x:l,y:u,domEvent:c})}},a._onDocumentMouseup=function(s){if(a._isEnabled()&&a._setXY(s)){var l=a._position.x,u=a._position.y,d=a._button;a._buttons[d]=!1,a._events.fire(x.DOCUMENT_MOUSE_UP,{button:d,x:l,y:u,domEvent:a._evt}),a._dom.removeDocumentEventListener(x.MOUSE_MOVE,a._onDocumentMouseMove),a._dom.removeDocumentEventListener(x.MOUSE_UP,a._onDocumentMouseup)}},a._onMouseDown=function(s){if(a._isEnabled()&&a._setXY(s)){var l=a._position.x,u=a._position.y,d=a._button;a._skipNextMove=!0,a._pressX=l,a._pressY=u,a._lastMouseDownTarget=s.target,a._dom.focus(),a._buttons[d]=!0,a._clickCounter[d]+=1;var c=d;a._dbclickTimer=a._dom.setTimeout(function(){a._resetClickCounter(c,0)},a._getDoubleClickTimer()),a._events.fire(x.MOUSE_DOWN,{button:d,x:l,y:u,domEvent:a._evt}),a._dom.addDocumentEventListener(x.MOUSE_MOVE,a._onDocumentMouseMove),a._dom.addDocumentEventListener(x.MOUSE_UP,a._onDocumentMouseup)}},a._dom=t,a._settings=i,a._events=r,a._graphics=o,a._position=n,a._domElt=a._graphics.getDomElement(),i.register("mouse.enabled",!0),i.register("mouse.wheelEnabled",!0),i.register("mouse.disableWheelUntilMouseDown",!1),i.register("mouse.doubleClickTimer",500),r.register([x.MOUSE_DOWN,x.MOUSE_UP,x.MOUSE_MOVE,x.MOUSE_WHEEL,x.MOUSE_CLICK,x.MOUSE_DOUBLE_CLICK,x.MOUSE_LEAVE,x.DOCUMENT_MOUSE_UP,x.DOCUMENT_MOUSE_MOVE]),t.afterNextFrame().then(function(){return a._initializeListeners()}),a}var Ng,ab=(bt(ts,Ng=E),Object.defineProperty(ts.prototype,"x",{get:function(){return this._position.x},enumerable:!0,configurable:!0}),Object.defineProperty(ts.prototype,"y",{get:function(){return this._position.y},enumerable:!0,configurable:!0}),Object.defineProperty(ts.prototype,"pressed",{get:function(){return this._pressed},enumerable:!0,configurable:!0}),ts.prototype._listen=function(e,t,n){if(me){if(t===re.START)return function(e,t,n){function i(r){ke(r)||(Ae(r)&&r.preventDefault(),oe(r,n))}return e(t,G,i,!1),i}(this._addEvent,e,n);if(t===re.MOVE)return function(e,t,n){function i(r){ke(r)&&0===r.buttons||oe(r,n)}return e(t,J,i,!1),i}(this._addDocEvent,e,n);if(t===re.END)return function(e,t,n){function i(r){return oe(r,n)}return e(t,K,i,!1),e(t,se,i,!1),i}(this._addDocEvent,e,n);if(t===re.CANCEL)return function(e,t,n){function i(r){Ae(r)&&r.preventDefault(),oe(r,n)}return e(t,se,i,!1),i}(this._addDocEvent,e,n)}return this._dom.addElementEventListener(e,t,n)},ts.prototype._initialize=function(e){function t(){s._position.x=l,s._position.y=u,s._pressed=h}function n(C,O){var N=s._domElt.getBoundingClientRect();if(!N)return null;var P=C.touches[0].clientX-N.left,F=C.touches[0].clientY-N.top,L=C.touches[1].clientX-N.left,B=C.touches[1].clientY-N.top,Y=(P+L)/2,X=(F+B)/2,ae=Y-l,ie=X-u,U=vi(P,F,L,B),W=U/v,ce=Ms(P,F,L,B),he={dx:ae,dy:ie,rotation:ce-y,scale:W};return v=U,y=ce,l=Y,u=X,t(),he}function i(C){if(p=Ti[C.button],1!==C.touches.length)return h=!1,1<C.touches.length&&s._events.fire(x.TOUCH_UP,{x:l,y:u,domEvent:S,button:p}),!1;var O=s._domElt.getBoundingClientRect();return O&&(d=l,c=u,l=C.touches[0].clientX-O.left|0,u=C.touches[0].clientY-O.top|0,h=!0,S=C,t()),!0}function r(){g=0,s._dom.clearTimeout(A)}function o(C){if(C.preventDefault(),2!==C.touches.length&&b&&(b=!1,s._events.fire(x.TOUCH_END_GESTURE,{domEvent:S})),i(C),0===C.touches.length){var O={x:l,y:u,domEvent:S,button:p};1===g&&s._events.fire(x.TOUCH_TAP,O),1<g&&(s._events.fire(x.TOUCH_DOUBLE_TAP,O),r()),s._events.fire(x.TOUCH_UP,O)}var N=zi().documentElement;ye(s._removeDocEvent,N,re.MOVE,s._onMove),ye(s._removeDocEvent,N,re.END,s._onEnd)}function a(C){(function(O){if(2===O.touches.length&&b){var N=n(O);N&&s._events.fire(x.TOUCH_PROGRESS_GESTURE,{dx:N.dx,dy:N.dy,rotation:N.rotation,scale:N.scale,x:l,y:u,domEvent:S,button:p})}})(C),m?m=!1:(r(),i(C)&&s._events.fire(x.TOUCH_MOVE,{x:l,y:u,dx:l-d,dy:u-c,domEvent:S,button:p}))}var s=this,l=0,u=0,d=0,c=0,h=!1,p=Yt.LEFT,g=0,m=!1,b=!1,v=1,y=0,S=null,A=null;this._listen(this._domElt,re.START,function(C){2!==C.touches.length||b||n(C)&&(b=!0,s._events.fire(x.TOUCH_START_GESTURE,{domEvent:S})),i(C)&&(s._dom.focus(),s._events.fire(x.TOUCH_DOWN,{x:l,y:u,domEvent:S,button:p}),g+=1,A=s._dom.setTimeout(r,500),m=!0);var O=zi().documentElement;s._onMove=s._listen(O,re.MOVE,a),s._onEnd=s._listen(O,re.END,o)})},ts);function ts(e){var t=e.dom,n=e.events,i=e.settings,r=e.graphics,o=e.position,a=Ng.call(this)||this;return a._pressed=!1,a._addEvent=function(s,l,u,d){a._dom.addElementEventListener(s,l,u,d)},a._addDocEvent=function(s,l,u,d){a._dom.addDocumentEventListener(l,u,d)},a._removeDocEvent=function(s,l,u){a._dom.removeDocumentEventListener(l,u)},a._dom=t,a._events=n,a._settings=i,a._graphics=r,a._position=o,a._domElt=a._graphics.getDomElement(),a._settings.register("touch.enabled",!0),a._events.register([x.TOUCH_DOWN,x.TOUCH_UP,x.TOUCH_TAP,x.TOUCH_DOUBLE_TAP,x.TOUCH_MOVE,x.TOUCH_START_GESTURE,x.TOUCH_PROGRESS_GESTURE,x.TOUCH_END_GESTURE,x.DOCUMENT_TOUCH_MOVE,x.DOCUMENT_TOUCH_UP]),a._dom.afterNextFrame().then(function(){a._initialize(a)}),a}var Lg,sb=(bt(Ca,Lg=E),Ca.prototype._fetchSubEltsList=function(e){return e?this._subNodesList:this._subEdgesList},Ca.prototype._fetchMetaEltList=function(e){return e?this._metaNodeList:this._metaEdgeList},Ca.prototype.setSubElements=function(e,t){this._fetchSubEltsList(e.isNode).setMultiple(e._indexes,t)},Ca.prototype.setMetaElement=function(e,t){this._fetchMetaEltList(e.isNode).setMultiple(e._indexes,t)},Ca.prototype.getSubElements=function(e){return this._fetchSubEltsList(e.isNode).getMultiple(e._indexes)},Ca.prototype.getMetaElement=function(e){return this._fetchMetaEltList(e.isNode).getMultiple(e._indexes)},Ca);function Ca(e){var t=e.graph,n=Lg.call(this)||this;return n._graph=t,n._subNodesList=n._graph.createNodeAttribute({storage:"any",default:null}),n._subEdgesList=n._graph.createEdgeAttribute({storage:"any",default:null}),n._metaNodeList=n._graph.createNodeAttribute({storage:"any",default:null}),n._metaEdgeList=n._graph.createEdgeAttribute({storage:"any",default:null}),n}var ub=(Mr.prototype.getName=function(){return this._module.getName(this._id)},Mr.prototype.getId=function(){return this._id},Mr.prototype.whenApplied=function(){return this._whenApplied},Mr.prototype.isEnabled=function(){return this._module.isEnabled(this._id)},Mr.prototype.enable=function(e){return this._module.enable(this._id,e)},Mr.prototype.disable=function(e){return this._module.disable(this._id,e)},Mr.prototype.toggle=function(e){return this._module.toggle(this._id,e)},Mr.prototype.getIndex=function(){return this._module.getIndex(this._id)},Mr.prototype.setIndex=function(e){return this._module.setIndex(this._id,e)},Mr.prototype.destroy=function(e){return this._module.remove(this._id,e)},Mr.prototype.refresh=function(){return this._module.refresh(this._id)},Mr.prototype.delete=function(e){return this.destroy(e)},Mr);function Mr(e,t){var n=this;this._module=e,this._id=t,this._whenApplied=e.whenApplied().then(function(){return n})}var Au=(Fg.prototype.cleanup=function(e){return Promise.resolve()},Fg);function Fg(e){}var Pg,lb=(bt(Fn,Pg=E),Fn.prototype._invalidState=function(){var e=this;this._afterCurrentUpdate.then(function(){(e._list.length||e._currentPipeline.length)&&(e._mustRefresh=!0,e._dom.refresh())})},Fn.prototype._onUpdate=function(){var e=this;return this._afterCurrentUpdate.then(function(){return e._dom.refresh(),new Promise(function(t,n){return e._resolvers.push({resolve:t,reject:n})})})},Fn.prototype._resetEltTransformationIds=function(){this._nodeTransformationIdList.reset(),this._edgeTransformationIdList.reset()},Fn.prototype._assignTransformationIds=function(e){this._assignTransformationIdsToElements(!0,e),this._assignTransformationIdsToElements(!1,e)},Fn.prototype._assignTransformationIdsToElements=function(e,t){for(var n=e?this._graph.getNodes("all"):this._graph.getEdges("all"),i=this._graph.getAttribute(e,"virtual"),r=this._graph.getAttribute(e,"excluded"),o=e?this._nodeTransformationIdList:this._edgeTransformationIdList,a=0;a<n._indexes.length;a++){var s=n._indexes[a];if(!o.get(s)){var l=r.get(s),u=i.get(s);!l&&u&&o.set(s,t)}}},Fn.prototype._resolveTransformations=function(e,t,n){var i=this;n||(e.forEach(function(d){return d.duration=0}),t.forEach(function(d){return d.duration=0})),this._resetEltTransformationIds();for(var r=this._selection.getSelectedNodes().getId(),o=this._selection.getSelectedEdges().getId(),a=Promise.resolve(),s=function(d){var c=e[d];null!==c.context&&(a=a.then(function(){return c.methods.undo(c)})),t.some(function(h){return h.id===c.id})||(a=a.then(function(){return c.methods.cleanup(c)}).then(function(){c.context=null}))},l=e.length-1;0<=l;--l)s(l);var u=function(d){var c=t[d],h=null;a=a.then(function(){return c.methods.run(c)}).catch(function(p){return c.error=p,!0}).then(function(p){if(h=p,c.context)return c.methods.cleanup(c)}).then(function(){i._assignTransformationIds(c.id),c.context=h})};for(l=0;l<t.length;++l)u(l);return a=a.then(function(){i._destroyed||(i._graph.getNodes(r).setSelected(!0),i._graph.getEdges(o).setSelected(!0))})},Fn.prototype.getList=function(){return this._list.map(function(e){return e.wrapper})},Fn.prototype.clear=function(){return this._list=[],this._invalidState(),this._onUpdate()},Fn.prototype._get=function(e,t){void 0===t&&(t=!0);for(var n=0;n<this._list.length;++n){var i=this._list[n];if(i.id===e)return i.index=n,i}if(t)throw new Error("calling a method on a destroyed transformation");return null},Fn.prototype.getName=function(e){return this._get(e).methods.getName()},Fn.prototype.enable=function(e,t){var n=this;return this._afterCurrentUpdate.then(function(){var i=n._get(e);return i.enabled||(i.enabled=!0,i.duration=t,n._invalidState()),n._onUpdate()})},Fn.prototype._setRemovalDuration=function(e,t){for(var n=0;n<this._currentPipeline.length;++n){var i=this._currentPipeline[n];i.id===e&&(i.duration=t)}},Fn.prototype.disable=function(e,t){var n=this;return this._afterCurrentUpdate.then(function(){var i=n._get(e);return i.enabled&&(i.enabled=!1,n._setRemovalDuration(e,t),n._invalidState()),n._onUpdate()})},Fn.prototype.remove=function(e,t){var n=this;return this._afterCurrentUpdate.then(function(){var i=n._get(e);return n._list.splice(i.index,1),n._setRemovalDuration(e,t),n._invalidState(),n._onUpdate()})},Fn.prototype.toggle=function(e,t){var n=this;return this._afterCurrentUpdate.then(function(){return n._get(e).enabled?n.disable(e,t):n.enable(e,t)})},Fn.prototype.setIndex=function(e,t){var n=this;return this._afterCurrentUpdate.then(function(){var i=n._get(e);return n._list.splice(i.index,1),n._list.splice(_e(t,0,n._list.length),0,i),n._invalidState(),n._onUpdate()})},Fn.prototype.getIndex=function(e){return this._get(e).index},Fn.prototype.add=function(e,t){var n=void 0===t?{}:t,i=n.duration,r=void 0===i?0:i,o=n.enabled,a=void 0===o||o;e.cleanup||(e.cleanup=function(){return Promise.resolve()});var s={ogma:this._ogma,id:++this._idCounter,methods:e,duration:r,enabled:a,context:null,wrapper:new ub(this,this._idCounter),index:-1,error:null};return this._list.push(s),this._invalidState(),s.wrapper},Fn.prototype.whenApplied=function(){return this._onUpdate()},Fn.prototype.refresh=function(){return this._invalidState(),this._onUpdate()},Fn.prototype.isEnabled=function(e){return this._get(e).enabled},Fn.prototype._getElementTransformationId=function(e){return(e.isNode?this._nodeTransformationIdList:this._edgeTransformationIdList).get(e._index)},Fn.prototype.isElementVirtual=function(e){return!!this._getElementTransformationId(e)},Fn.prototype.getElementTransformation=function(e){var t=this._get(this._getElementTransformationId(e),!1);return t&&t.wrapper},Fn.prototype.destroy=function(){this._destroyed=!0},Fn);function Fn(e,t){var n,i=Pg.call(this)||this;return i._list=[],i._currentPipeline=[],i._idCounter=0,i._mustRefresh=!1,i._safeGuard=!1,i._resolvers=[],i._afterCurrentUpdate=Promise.resolve(),i._destroyed=!1,i._computeTransformations=function(){if(!i._safeGuard){if(i._safeGuard=!0,i._afterCurrentUpdate=Promise.resolve(),i._mustRefresh){i._captor.setDetectionEnabled(!1);var r,o,l,a=i._currentPipeline.filter(function(u){return u.enabled}),s=i._list.filter(function(u){return u.enabled});l=a.length===s.length+1&&Dg(a,s,s.length)?(r=[a.pop()],o=[],!0):s.length===a.length+1&&Dg(a,s,a.length)?(r=[],o=[s.pop()],!0):(r=a,o=s,!1),i._afterCurrentUpdate=i._afterCurrentUpdate.then(function(){return i._resolveTransformations(r,o,l)}).then(function(){return i._captor.setDetectionEnabled(!0),i._currentPipeline=i._list.map(function(u){return Mt({},u)}),i._mustRefresh=!1,i._dom.afterNextFrame()})}i._afterCurrentUpdate=i._afterCurrentUpdate.then(function(){i._safeGuard=!1,i._resolvers.forEach(function(u,d){var c=u.resolve,p=i._list[d];return p&&p.error?(0,u.reject)(p.error):c()}),i._resolvers=[]})}},i._settings=e.settings,i._dom=e.dom,i._events=e.events,i._graph=e.graph,i._captor=e.captor,i._classes=e.classes,i._selection=e.selection,i._ogma=t,i._classes.createClass({name:oi,isBuiltin:!0,nodeAttributes:{opacity:0,radius:0},edgeAttributes:{opacity:0,width:0}}),i._classes.createClass({name:ba,isBuiltin:!0,nodeAttributes:{opacity:0},edgeAttributes:{opacity:0}}),i._nodeTransformationIdList=i._graph.createNodeAttribute({storage:16,default:0}),i._edgeTransformationIdList=i._graph.createEdgeAttribute({storage:16,default:0}),i._settings.register("transformations.updateOnDataChange",!0),i._events.on(((n={})[[x.ADD_NODES,x.ADD_EDGES,x.REMOVE_NODES,x.REMOVE_EDGES].join(" ")]=function(r){r.virtual||i._invalidState()},n[x.UPDATE_NODE_DATA+" "+x.UPDATE_EDGE_DATA]=function(){i._settings.get("transformations.updateOnDataChange")&&!i._safeGuard&&i._invalidState()},n[x.AFTER_NEW_FRAME]=i._computeTransformations,n)),i}function Dg(e,t,n){for(var i=0;i<n;++i)if(e[i].id!==t[i].id)return!1;return!0}var Rg,zg={layer:2,outline:!0,outerStroke:{color:"red",width:5},innerStroke:{minVisibleSize:0},text:{backgroundColor:"rgb(220, 220, 220)",minVisibleSize:0}},db={layer:2,color:"red",outline:!0,text:{backgroundColor:"rgb(220, 220, 220)",minVisibleSize:0},stroke:{width:2}},cb=(bt(Ir,Rg=E),Ir.prototype.onMounted=function(e){function t(){n._selectionExtremityHighlightedClass.clearNodes(),n._selectedClass.getEdges().getExtremities().addClass(yl)}var n=this;e.events.onEdgesClassAdded(yi,t),e.events.onEdgesClassRemoved(yi,t)},Ir.prototype.setNodeAttributes=function(e,t){this._selectedClass.update({nodeAttributes:e,fullOverwrite:t}),this._selectionExtremityHighlightedClass.update({nodeAttributes:e,fullOverwrite:t}),this._updateExtremityHighlightLayer()},Ir.prototype.setEdgeAttributes=function(e,t){this._selectedClass.update({edgeAttributes:e,fullOverwrite:t}),this._updateExtremityHighlightLayer()},Ir.prototype._updateExtremityHighlightLayer=function(){var e=this._selectedClass.getDefinition().edgeAttributes;this._selectionExtremityHighlightedClass.update({nodeAttributes:{layer:e?e.layer:void 0},fullOverwrite:!1})},Ir.prototype.setActive=function(e,t){if(ui(t)){var n=[],i=[];e.toList().forEach(function(r,o){(t[o]?n:i).push(r.getId())}),0!==n.length&&this._graph.getElements(e.isNode,n).addClass(yi),0!==i.length&&this._graph.getElements(e.isNode,i).removeClass(yi)}else e[t?"addClass":"removeClass"](yi)},Ir.prototype.areActive=function(e){return e.hasClass(yi)},Ir.prototype.getSelectedNodes=function(){return this._selectedClass.getNodes()},Ir.prototype.getSelectedEdges=function(){return this._selectedClass.getEdges()},Ir.prototype.getNonSelectedNodes=function(){return this._graph.getNodes().filter(function(e){return!e.hasClass(yi)})},Ir.prototype.getNonSelectedEdges=function(){return this._graph.getEdges().filter(function(e){return!e.hasClass(yi)})},Ir.prototype.clear=function(){this._selectedClass.clearNodes(),this._selectedClass.clearEdges()},Ir);function Ir(e){var t=Rg.call(this)||this;return t._events=e.events,t._settings=e.settings,t._graph=e.graph,t._keyboard=e.keyboard,t._graphics=e.graphics,t._interactions=e.interactions,t._selectionExtremityHighlightedClass=e.classes.createClass({name:yl,isBuiltin:!0,nodeAttributes:zg}),t._selectedClass=e.classes.createClass({name:yi,isBuiltin:!0,nodeAttributes:zg,edgeAttributes:db}),t._settings.register("interactions.selection.enabled",!0),t._settings.register("interactions.selection.multiSelectionKey","ctrl"),t._interactions.onClick({priority:"selection",check:function(n){var i=n.button,r=t._settings.get("interactions.selection.enabled");return"left"===i&&r&&!t._graphics.isAnimating()},handler:function(n){var i=n.target;if(i){var r=t._settings.get("interactions.selection.multiSelectionKey"),o=r&&t._keyboard.isPressed(r);i.isNode?t._selectedClass.clearEdges():t._selectedClass.clearNodes(),o?i.hasClass(yi)?i.removeClass(yi):i.addClass(yi):((i.isNode?t._selectedClass.getNodes():t._selectedClass.getEdges()).filter(function(a){return a!==i}).removeClass(yi),i.hasClass(yi)||i.addClass(yi))}else t._selectedClass.clearNodes(),t._selectedClass.clearEdges()}}),t._events.on(x.BEFORE_REMOVE_EDGES,function(n){return n.edges.setSelected(!1)}),t}var Bg,hb=(bt(Rl,Bg=E),Rl.prototype._nextTimeIdle=function(e){var t=this,n=new pb(this._dom,this._idIdle,e);return this._delayedCalls.push(n),n.whenDone().then(function(){t._delayedCalls.splice(t._delayedCalls.indexOf(n),1)})},Rl.prototype.debounceIdle=function(e,t){var n=this;function i(){var a=o;r=!1,o=[],e(),a.forEach(function(s){return s()})}void 0===t&&(t=0);var r=!1,o=[];return function(){return new Promise(function(a){o.push(a),r||(r=!0,n._nextTimeIdle(t).then(i))})}},Rl);function Rl(e){var t=Bg.call(this)||this;return t._dom=e.dom,t._events=e.events,t._captor=e.captor,t._delayedCalls=[],t._idIdle=function(){return!t._captor.isAnyButtonPressed()&&!t._dom.isPlayingFrame()},t._events.on({"down up beforeNewFrame newFrame":function(){t._delayedCalls.forEach(function(n){return n.reset()})}}),t}var pb=(zl.prototype._startTimeout=function(){var e=this;this._timeout=this._dom.setTimeout(function(){e._isIdle()?(e._done=!0,e._resolve()):e._startTimeout()},this._delay)},zl.prototype.reset=function(){this._done||(this._dom.clearTimeout(this._timeout),this._startTimeout())},zl.prototype.whenDone=function(){return this._promise},zl);function zl(e,t,n){var i=this;this._timeout=null,this._done=!1,this._dom=e,this._promise=new Promise(function(r){return i._resolve=r}),this._isIdle=t,this._delay=n,this._startTimeout()}var Vg,fb={number:1,duration:1e3,interval:800,startColor:"rgba(0,0,0,0.6)",endColor:"rgba(0,0,0,0.0)",width:50,startRatio:1,endRatio:2},gb={number:1,duration:1e3,interval:800,startColor:"rgba(0,0,0,0.6)",endColor:"rgba(0,0,0,0.0)",width:10,startRatio:1,endRatio:2},_b=(bt(Ta,Vg=E),Ta.prototype._onElementsAttributeChange=function(e,t){if(t.includes("pulse.enabled")){var n=Dh(this._graph,e,function(o){return o.getAttribute("pulse.enabled")}),i=n.valid,r=n.invalid;this._hasPulses.removeElements(r),this._hasPulses.addElements(i),this._removePulses(r)}},Ta.prototype._removePulses=function(e){for(var t=e.isNode?this._nodePulses:this._edgePulses,n=0;n<e._indexes.length;n++){var i=e._indexes[n],r=t.get(i);if(r){for(var o=0;o<r.length;o++)this._graphics.releaseGraphicsEngineBlockId(r[o].blockId);t.set(i,null)}}},Ta.prototype._refreshElementsPulses=function(e,t){for(var n=e.isNode,i=n?this._nodePulses:this._edgePulses,r=n?this._nodeFlexArrays.pulse.duration:this._edgeFlexArrays.pulse.duration,o=n?"_createNodePulseBlock":"_createEdgePulseBlock",a=n?this._nodeFlexArrays.pulse.interval:this._edgeFlexArrays.pulse.interval,s=n?this._nodeNbPulsesRemaining:this._edgeNbPulsesRemaining,l=0;l<e._indexes.length;l++){var u=e._indexes[l],d=i.get(u);d||i.set(u,d=[]);for(var c=0;c<d.length;c++){var h=d[c],g=h.duration;h.startTime+g<=t&&(this._graphics.releaseGraphicsEngineBlockId(h.blockId),d.splice(c--,1))}var b=d[d.length-1];if(!b||t>=b.startTime+a.get(u)){g=r.get(u);var v=s.get(u);0!==v&&d.push({blockId:this[o](u,t,g),startTime:t,duration:g}),0<v&&s.set(u,v-1)}}},Ta.prototype._createNodePulseBlock=function(e,t,n){var i=this._nodeFlexArrays,r=i.color.get(e),o=i.layer.get(e),a=i.x.get(e),s=i.y.get(e),l=i.radius.get(e),u="scaled"===i.scalingMethod.get(e),d=i.pulse.startRatio.get(e),c=i.pulse.endRatio.get(e),h=i.pulse.width.get(e),p=2*l*d,g=2*l*c,m=xu(o).nodeBody,b=i.pulse.startColor.get(e),v=i.pulse.endColor.get(e),y=this._graphics.allocateGraphicsEngineBlockId(),S=this._block.reset(1,!0,m),A=S.nextAndReset(),C=ro(b,r),O=ro(v,r);return A.end.shape="circle",A.end.pieceId=1,A.end.x1=a,A.end.y1=s,A.end.x2=a,A.end.y2=s,A.end.rectWidthOrSourceRadiusScaled=u?g:0,A.end.rectHeightOrTargetRadiusScaled=u?g:0,A.end.rectWidthOrSourceRadiusFixed=u?0:g,A.end.rectHeightOrTargetRadiusFixed=u?0:g,A.end.strokeWidthFixed=h,A.end.strokeColor=O,A.start.shape="circle",A.start.pieceId=1,A.start.x1=a,A.start.y1=s,A.start.x2=a,A.start.y2=s,A.start.rectWidthOrSourceRadiusScaled=u?p:0,A.start.rectHeightOrTargetRadiusScaled=u?p:0,A.start.rectWidthOrSourceRadiusFixed=u?0:p,A.start.rectHeightOrTargetRadiusFixed=u?0:p,A.start.strokeWidthFixed=h,A.start.strokeColor=C,A.animation.duration=n,A.animation.beginTime=t,this._engine.storeBlock(y,S),y},Ta.prototype._createEdgePulseBlock=function(e,t,n){var i=this._edgeFlexArrays,r=this._nodeFlexArrays,o=i.pulse.startRatio.get(e),a=i.pulse.endRatio.get(e),s=i.pulse.startColor.get(e),l=i.pulse.endColor.get(e),u=xu(i.layer.get(e)).edgeBody,d=this._edgeSourceList.get(e),c=this._edgeTargetList.get(e),h=i.curvature.get(e),p=0!==h,g=this._graphics.allocateGraphicsEngineBlockId(),m=this._block.reset(p?3:1,!0,u),b=m.nextAndReset(),v={isSelfLoop:d===c,curvature:h,sourceX:r.x.get(d),sourceY:r.y.get(d),targetX:r.x.get(c),targetY:r.y.get(c),sourceRadius:r.radius.get(d),targetRadius:r.radius.get(c),isSourceRadiusScaled:"scaled"===r.scalingMethod.get(d),isTargetRadiusScaled:"scaled"===r.scalingMethod.get(c),width:i.width.get(e),isWidthScaled:"scaled"===i.scalingMethod.get(e),strokeWidth:i.pulse.width.get(e)};return Ug(b.start,v),Ug(b.end,v),b.start.strokeColor=s,b.end.strokeColor=l,b.start.thicknessOrFontSizeScaled*=o,b.start.thicknessOrFontSizeFixed*=o,b.end.thicknessOrFontSizeScaled*=a,b.end.thicknessOrFontSizeFixed*=a,b.animation.duration=n,b.animation.beginTime=t,this._engine.storeBlock(g,m),g},Ta.prototype.pulse=function(e,t){var n=e.isNode,i=Mt({},n?fb:gb,t),r=i.number,s=n?this._nodeNbPulsesRemaining:this._edgeNbPulsesRemaining,l=(r-1)*i.interval+i.duration;delete i.number,i.enabled=!0,e.setAttributes({pulse:i}),s.setMultiple(e._indexes,r),this._dom.setTimeout(function(){e.setAttribute("pulse.enabled",!1),s.setMultiple(e._indexes,-1)},l)},Ta);function Ta(e){var t=e.graphics,n=e.graph,i=e.dom,r=e.events,o=Vg.call(this)||this;return o._onAttributeChange=function(a){var l=a.edges,d=a.edgeAttributes;o._onElementsAttributeChange(a.nodes,a.nodeAttributes),o._onElementsAttributeChange(l,d)},o._refreshPulses=function(){var a=o._hasPulses.getElements(),s=a.nodes,l=a.edges;if(0!==s.size||0!==l.size){var u=o._engine.getCurrentTime();o._refreshElementsPulses(s,u),o._refreshElementsPulses(l,u),o._dom.refresh()}},o._graph=n,o._dom=i,o._graphics=t,r.on(x.UPDATE_ATTRIBUTES,o._onAttributeChange),r.on(x.NEW_FRAME,o._refreshPulses),r.on(x.BEFORE_REMOVE_NODES+" "+x.BEFORE_REMOVE_EDGES,function(a){(a.nodes||a.edges).setAttribute("pulse.enabled",!1)}),r.on(x.CLEAR_GRAPH,function(){return o._hasPulses.clear()}),o._engine=o._graphics.getGraphicsEngine(),o._block=o._engine.createBlock(),o._nodePulses=n.createNodeAttribute({storage:"any"}),o._edgePulses=n.createEdgeAttribute({storage:"any"}),o._nodeNbPulsesRemaining=n.createNodeAttribute({storage:"int16",default:-1}),o._edgeNbPulsesRemaining=n.createEdgeAttribute({storage:"int16",default:-1}),o._nodeFlexArrays=o._graphics.getNodeAttributes(),o._edgeFlexArrays=o._graphics.getEdgeAttributes(),o._edgeSourceList=n.getEdgeAttribute("source"),o._edgeTargetList=n.getEdgeAttribute("target"),o._hasPulses=new hu(o._graph),o}function Ug(e,t){var n=t.sourceX,i=t.sourceY,r=t.targetX,o=t.targetY,a=t.isSourceRadiusScaled,s=t.isTargetRadiusScaled,l=t.targetRadius,u=t.sourceRadius,d=t.isWidthScaled,c=t.width,h=t.strokeWidth,p=t.curvature,g=t.isSelfLoop;e.pieceId=2,e.shape="line",e.x1=n,e.y1=i,e.x2=r,e.y2=o,e.rectWidthOrSourceRadiusScaled=a?u:0,e.rectWidthOrSourceRadiusFixed=a?0:u,e.rectHeightOrTargetRadiusScaled=s?l:0,e.rectHeightOrTargetRadiusFixed=s?0:l,e.thicknessOrFontSizeScaled=d?c:0,e.thicknessOrFontSizeFixed=d?0:c,e.strokeWidthFixed=h,e.curvature=p,e.isSelfLoop=g}var jg,mb={duration:0,easing:"linear",callback:function(){},startAfter:0},vb=(bt(Bl,jg=E),Bl.prototype.play=function(e,t){var n=on(t,mb),i=n.duration,r=n.easing,o=n.callback,a=n.startAfter,s=null;return i<=0?(e(1),o()):(s={func:e,easing:"function"==typeof r?r:If[r],duration:i,callback:o,startAfter:a,creationDate:R(),done:!1},this._animationList.push(s),this._dom.refresh()),s},Bl.prototype.end=function(e,t){void 0===t&&(t=!0);var n=this._animationList.indexOf(e);-1!==n&&(e.func(1),this._animationList.splice(n,1),e.done=!0,t&&e.callback(!0))},Bl);function Bl(e){var t=jg.call(this)||this;return t._animationList=[],t._update=function(){if(0!==t._animationList.length){for(var n=R(),i=[],r=0;r<t._animationList.length;++r){var o=t._animationList[r],a=(n-o.creationDate)/o.duration,s=o.startAfter,l=o.easing(a);1<=a?(o.func(1),o.done=!0,t._animationList.splice(r,1),--r,i.push(o.callback)):s<=l&&o.func(l=1/(1-s)*(l-s))}for(var u=0;u<i.length;++u)i[u](!1);t._dom.refresh()}},t._dom=e.dom,t._events=e.events,t._animationList=[],t._events.on(x.BEFORE_NEW_FRAME,t._update),t}function Zg(e){return e+(-1===e.indexOf("?")?"?":"&")+"noCache="+Date.now()}var yb={tileLayers:function(e,t,n,i,r){var o=n._getMapPanePos(),a=i.DomUtil.getPosition(e.getContainer());n.removeLayer(e),e.options.crossOrigin="anonymous";var s=[],l=[];return e.on("tileload",function(u){var d=u.tile,c=i.DomUtil.getPosition(d),h=c.x,p=c.y;s.push(d),l.push({x:h-a.x+o.x-r.x,y:p-a.y+o.y-r.y})}),n.addLayer(e),new Promise(function(u){e.once("load",function(){var d=e.getTileSize();s.forEach(function(c,h){var p=l[h];t.drawImage(c,p.x,p.y,d.x,d.y)}),u()})})},imageOverlays:function(e,t,n,i,r){return new Promise(function(o){n.removeLayer(e),e.setUrl(Zg(e.getUrl())),e.options.crossOrigin="anonymous",e.once("load",function(){var a=e.getBounds(),s=n.latLngToContainerPoint(a.getNorthWest()),l=n.latLngToContainerPoint(a.getSouthEast());t.drawImage(e._image,s.x-r.x,s.y-r.y,l.x-s.x,l.y-s.y),o()}),n.addLayer(e)})},vectorLayers:function(e,t,n,i,r,o){return new Promise(function(a){var s=e.options.renderer;n.removeLayer(e),e.options.renderer=o,n.addLayer(e),o._updatePaths();var l=n._getMapPanePos(),u=o._container,d=i.DomUtil.getPosition(u),c=Nn();t.drawImage(o._container,d.x+l.x-r.x,d.y+l.y-r.y,u.width/c,u.height/c),n.removeLayer(e),e.options.renderer=s,n.addLayer(e),a()})},markers:function(e,t,n,i,r){return new Promise(function(o){var a=n.getPixelBounds().min,s=n.project(e.getLatLng(),n.getZoom()),l=/^data\:/.test(e._icon.src),u=l?e._icon.src:Zg(e._icon.src),d=new Image,c=e.options.icon.options,h=c.iconSize,p=s.subtract(a),g=c.iconAnchor;Array.isArray(h)||(h=[h.x,h.y]),Array.isArray(g)||(g=[g.x,g.y]);var m=Math.round(p.x-h[0]+g[0])-r.x,b=Math.round(p.y-g[1])-r.y;function v(){t.drawImage(d,m,b,h[0],h[1]),o()}d.crossOrigin="",d.onload=v,d.src=u,l&&v()})},vectorMap:function(e,t,n,i,r){var o=n._getMapPanePos(),a=e.getMapboxMap(),s=e.getCanvas(),l=e.getSize().round(),u=i.DomUtil.getPosition(e.getContainer()),d=u.x+o.x-r.x,c=u.y+o.y-r.y;return new Promise(function(h){function p(){t.drawImage(s,d,c,l.x,l.y),h()}if(a.loaded())return p();a.once("idle",p)})}};var Gg,qg={"top-left":"left","bottom-left":"left","top-right":"right","bottom-right":"right"},Eb={"top-left":"top","bottom-left":"bottom","top-right":"top","bottom-right":"bottom"},Hg={position:"bottom-right",horizontalMargin:0,verticalMargin:0,className:null},Sb=(bt(Vl,Gg=E),Vl.prototype.set=function(e,t){var n=Mt({},Hg,t),i=n.position,r=n.horizontalMargin,o=n.verticalMargin,a=n.className;qg[i]||(i=Hg.position),this.remove();var s=document.createElement("div");return s.innerHTML=e,s.style.position="absolute",Wg(s,i,r,o),s.style.padding="0px 0px 0px 0px",s.style.zIndex="10",a&&s.setAttribute("class",a),this._brand=s,this._dom.setLayer("brand",this._brand),s},Vl.prototype.remove=function(){this._dom.setLayer("brand",null),this._brand=null},Vl);function Vl(e){var t=Gg.call(this)||this;return t._dom=e.dom,t._brand=null,t}function Wg(e,t,n,i){var o=void 0===i?"":i+"px";e.style[qg[t]]=void 0===n?"":n+"px",e.style[Eb[t]]=o}var Yg,Ab=(bt(Ft,Yg=E),Ft.prototype._onCameraUpdate=function(){var e=this;if(this._enabled&&this._map&&this._map._loaded&&(this._x-this._camera.x||this._y-this._camera.y)){this._updating||(this._updating=!0,this._layer.setLocked(!0),this._map._moveStart(!0,!1));var i=this._fromPointToLatLng(this._camera.x,this._camera.y),r=gd(this._camera.zoom),o=this.L.latLng(i.latitude,i.longitude);this._map._move(o,r,{pinch:!0,round:!1}),clearTimeout(this._updateRequest),this._updateRequest=setTimeout(function(){e._updating=!1,e._layer.setLocked(!1),e._map&&e._map._move(o,r,{pinch:!0})._moveEnd(!0)},this._updateRate)}},Ft.prototype._onNodesDragStart=function(){this._enabled&&(this._setMapDragging(!1),this._nodeDragOffsetX=this._nodeDragOffsetY=0)},Ft.prototype._onNodesDragged=function(e){var t=this,n=e.nodes,i=e.dx,r=e.dy;if(this._enabled){var o=n.map(function(a){var s=a.getAttributes(["x","y"]);return t._fromPointToLatLng(s.x+i-t._nodeDragOffsetX,s.y+r-t._nodeDragOffsetY)});return this._nodeDragOffsetX=i,this._nodeDragOffsetY=r,n.setGeoCoordinates(o)}},Ft.prototype._onDataChange=function(e){var t=this,n=e.filter(function(r){var o=r.property;return o===t.latitudePath||o===t.longitudePath});if(n.length){var i=n.reduce(function(r,o){var a=o.nodes,s=o.newValues;if(!a)return r;var l=a.filter(function(u,d){return null!=s[d]});return r?r.concat(l):l},null);this._refreshOrAddNodes(i)}},Ft.prototype._refreshOrAddNodes=function(e){this._updateNodesCoordinates(e),this._enabled&&(this._filter.refresh(),this._updatePrevNodesCoordinates(e))},Ft.prototype._updatePrevNodesCoordinates=function(e){Hu(this._graph,e,ra,"geo.prevLat"),Hu(this._graph,e,oa,"geo.prevLng")},Ft.prototype._restorePrevNodesCoordinates=function(e){Hu(this._graph,e,"geo.prevLat",ra),Hu(this._graph,e,"geo.prevLng",oa)},Ft.prototype._updateNodesCoordinates=function(e){!function(t,n,i){for(var r=i.longitudePath,o=i.latitudePath,a=i.wrapCoordinates,s=t.getAttributes(!0,[ra,oa]),l=s[0],u=s[1],d=n._indexes,c=n.getId(),h=d.length,p=n.getData(o),g=n.getData(r),m=0;m<h;m++){var b=g[m],v=p[m],y=d[m],S=c[m];null!=v&&null!=b&&(Xh(S,b),Jh(S,v),a&&(b%=180,v=_e(+v,-nu,nu)),u.set(y,b),l.set(y,v))}}(this._graph,e,this._settings)},Ft.prototype._createMapTileLayer=function(e,t){return Jt(e)?(e.wms?this.L.tileLayer.wms:this.L.tileLayer)(e.url,Mt({attribution:null==t&&e.url===ys.tiles.url?'Map data &copy; <a target="_blank" href="http://osm.org/copyright">OpenStreetMap contributors</a>':null},e)):e},Ft.prototype._setupTileLayer=function(e,t){var n=this,i=this._createMapTileLayer(e,t);return i.once("load",function(){n._events.fire(x.GEO_LOADED)}),i.addTo(this._map),i},Ft.prototype._onSettingsChanged=function(e,t){var n,i;(e.wrapCoordinates!==t.wrapCoordinates||e.latitudePath!==t.latitudePath||e.longitudePath!==t.longitudePath)&&this._updateNodesCoordinates(this._graph.getNodes("all")),this._enabled&&((n=e).attribution===(i=t).attribution&&n.tiles===i.tiles||!this._map||(this._map.removeLayer(this._tileLayer),this._tileLayer=this._setupTileLayer(t.tiles,t.attribution)),e.sizeRatio!==t.sizeRatio&&this._updateSizes(),e.maxZoomLevel!==t.maxZoomLevel&&this._settingsModule.update({minZoom:1,maxZoom:Math.pow(2,t.maxZoomLevel)}),e.disableNodeDragging!==t.disableNodeDragging&&this._setDragging(!t.disableNodeDragging),e.attributionOptions!==t.attributionOptions&&this._setAttributionOptions(t.attributionOptions,t.attribution))},Ft.prototype._setMapDragging=function(e){this._map&&this._map.dragging[e?"enable":"disable"]()},Ft.prototype._fromLatLngToPoint=function(e,t){return this._map.options.crs.latLngToPoint(this.L.latLng(e,t),1)},Ft.prototype._fromPointToLatLng=function(e,t){var n=this._map.options.crs.pointToLatLng(this.L.point({x:e,y:t}),1);return{latitude:n.lat,longitude:n.lng}},Ft.prototype._updateSizes=function(){this._enabled&&this._projection&&this._projection.updateAll()},Ft.prototype.enable=function(e){return this.setEnabled(!0,e)},Ft.prototype.getMap=function(){if(this._enabled)return this._map},Ft.prototype.getOptions=function(){if(this._enabled)return Mt({},this._settings,{tiles:Mt({},this._settings.tiles)})},Ft.prototype.setOptions=function(e){if(this._enabled){!function(n,i){void 0===n&&(n={});var r=n.tileUrlSubdomains,o=n.tileUrlTemplate,a=n.attribution,s=n.attributionOptions,l=n.latitudePath,u=n.longitudePath,d=n.sizeRatio,c=n.tiles;if(null!=o&&"string"!=typeof o)throw new TypeError("Geo mode: tileUrlTemplate must be a URL string");if(null!=r&&"string"!=typeof r)throw new TypeError("Geo mode: tileUrlTemplate must be a string");if(null!=c){if(!(Jt(c)||c instanceof i.Layer))throw new TypeError("Geo mode: tiles must be a object or L.Layer instance");var h=c;if(null!=h.url&&"string"!=typeof h.url)throw new TypeError("Geo mode: tiles.url must be a string");if(null!=h.subdomains&&"string"!=typeof h.subdomains)throw new TypeError("Geo mode: tiles.subdomains must be a string");if(h.tms&&"boolean"!=typeof h.tms)throw new TypeError("Geo mode: tiles.tms must be a boolean");if(h.wms&&"boolean"!=typeof h.wms)throw new TypeError("Geo mode: tiles.wms must be a boolean")}if(null!=a&&"string"!=typeof a)throw new TypeError("Geo mode: Map attribution must be a string");if(null!=s&&!Jt(s))throw new TypeError("Geo mode: attributionOptions must to be a BrandOptions object");if(null!=l&&"string"!=typeof l&&!Array.isArray(l))throw new TypeError("Geo mode: Latitude path must be a valid property path: a string or an array of strings.");if(null!=u&&"string"!=typeof u&&!Array.isArray(u))throw new TypeError("Geo mode: Longitude path must be a valid property path: a string or an array of strings.");if(null!=d&&(!isFinite(d)||d<=0))throw new TypeError("Geo mode: sizeRatio must be a positive number.")}(e,this.L);var t=this._settings;this._settings=Mt({},ys,e,{tiles:function(n,i){if(void 0===i&&(i={}),void 0===i.tiles||i.tileUrlTemplate||i.tileUrlSubdomains){var r=ys.tiles;return Mt({},i.tiles||{},ys.tiles,{url:i.tileUrlTemplate||r.url,subdomains:i.tileUrlSubdomains||r.subdomains})}return Jt(i.tiles)?Mt({},n.tiles,i.tiles):i.tiles}(ys,e)}),this._onSettingsChanged(t,this._settings)}},Ft.prototype.disable=function(e){return this.setEnabled(!1,e)},Ft.prototype.isEnabled=function(){return this._enabled},Ft.prototype.toggle=function(e){return this.setEnabled(!this._enabled,e)},Ft.prototype.getContainerCoords=function(e){var t=this;return e.getGeoCoordinates().map(function(n){return t._map.latLngToContainerPoint([n.latitude,n.longitude])})},Ft.prototype.setEnabled=function(e,t){var n=this;if(!Wh())throw new Error("Ogma Geo cannot be used outside a browser");if(!this.L)throw new Error("You are trying to use Geo mode but Leaflet has not been found. Please follow our migration guide: https://bit.ly/2SYkF8A");if(this._transition||e===this._enabled)return Promise.resolve();this._enabled=e,this._transition=!0,this.setOptions(t);var r=this._settings;return e?(this._nodeDraggingSetting=this._settingsModule.get("interactions.drag.enabled"),this._setDragging(!r.disableNodeDragging),this._show().then(function(){n._setDragging(!r.disableNodeDragging),n._setMapDragging(r.disableNodeDragging),n._transition=!1,n._updating=!1,n._events.fire(x.GEO_ENABLED),n._events.fire(x.GEO_READY)})):this._hide().then(function(){n._transition=!1,n._events.fire(x.GEO_DISABLED),n._setDragging(n._nodeDraggingSetting,!0)})},Ft.prototype._setDragging=function(e,t){void 0===t&&(t=!1),this._settingsModule.update({interactions:{drag:{enabled:e,applyResult:t}}})},Ft.prototype._setAttributionOptions=function(e,t){if(this._attribution&&(this._attribution.remove(),this._attribution=null),this._attribution=this.L.control.attribution({prefix:!1}).addTo(this._map),Jt(e)){this._attribution.setPrefix(""),e.position=e.position||"bottom-right";var n=e.position.replace("-","");this._attribution.setPosition(n);var i=this._attribution.getContainer();e.className&&this.L.DomUtil.addClass(i,e.className),Wg(i,e.position||"bottom-right",e.horizontalMargin,e.verticalMargin)}void 0!==t&&this._attribution.addAttribution(t)},Ft.prototype._nodeIsVisible=function(e){return t=e,n=this._settings,i=this._hasCustomProjection(),o=n.latitudePath,a=n.wrapCoordinates,s=t.getData(n.longitudePath),l=t.getData(o),null!=s&&null!=l&&(!(!a&&!i)||Math.abs(l)<=nu&&Math.abs(s)<=180);var t,n,i,o,a,s,l},Ft.prototype._updateSettingsForMap=function(){var e=this._graphics.getGraphicsEngine().parseColor(this._settings.backgroundColor);e[3]=0,this._prevSettings=this._settingsModule.update({backgroundColor:ep(e),minZoom:1e-6,interactions:{rotation:{enabled:!1},drag:{enabled:!1},pan:{enabled:!1},zoom:{enabled:!1,onDoubleClick:!1}},mouse:{wheelEnabled:!1}})},Ft.prototype.getGraphPosition=function(e){var t,n=this.L.latLngBounds((t=[[1/0,1/0],[-1/0,-1/0]],e.getGeoCoordinates().reduce(function(i,r){var o=r.latitude,a=r.longitude,s=i[0],l=i[1];return s[0]=Math.min(s[0],o),s[1]=Math.min(s[1],a),l[0]=Math.max(l[0],o),l[1]=Math.max(l[1],a),i},t)));return{center:0<e.size?n.getCenter():this.L.latLng([0,0]),zoom:this._map.getBoundsZoom(n)}},Ft.prototype._initMap=function(){this._updateSettingsForMap(),this._mapContainer=function(t){var n=zi().createElement("div");n.className="ogma-geo-container",n.style.width=n.style.height="100%";var i=t||Fy;return i.insertBefore(n,i.firstChild),n}(this._dom.getContainer());var e=Mt({},Ly,{minZoom:this._settings.minZoomLevel,maxZoom:this._settings.maxZoomLevel});this._hasCustomProjection()&&(e.crs=this._settings.crs,e.worldCopyJump=!1,e.maxBoundsViscosity=0),this._map=new this.L.Map(this._mapContainer,e),this._hasCustomProjection()||this._map.setMaxBounds(this.L.latLngBounds([[nu,-180],[-nu,180]])),this._setAttributionOptions(this._settings.attributionOptions,this._settings.attribution),this._setupLayers()},Ft.prototype._show=function(){var e=this;return this._filter=this._filters.addNodeFilter(function(t){return e._nodeIsVisible(t)}),this._filter.whenApplied().then(function(){e._initMap();var t=e._graph.getNodes(),n=e._graph.getEdges(),i=e.getGraphPosition(t),r=i.center,o=i.zoom;e._zoom=o;var a=e._transformToGeo(),s=a.offset;return e._camera.setView(a.newCameraView,{ignoreZoomLimits:!0}).then(function(){return e._updatePrevNodesCoordinates(t),e._map.setView(r,o),e._zoom=o,e._graphics.animate({nodes:t,edges:n},function(){e._projection=e._createFinalPositionLayer()},e._settings.duration)}).then(function(){return s.destroy()})})},Ft.prototype._hasCustomProjection=function(){return null!=this._settings.crs},Ft.prototype._setupLayers=function(){var e=this;this._settings.tiles&&(this._tileLayer=this._setupTileLayer(this._settings.tiles,this._settings.attribution)),this._layer=new this.L.OgmaOverlay({container:this._graphics.getDomElement(),mapContainer:this._mapContainer,onUpdate:function(){return e._onMapUpdate()}}),this._layer.addTo(this._map)},Ft.prototype._onMapUpdate=function(){var e,t=this._map.getCenter(),r=this._fromLatLngToPoint(t.lat,t.lng);return this._x=r.x,this._y=r.y,this._camera.setView({zoom:(e=this._map.getZoom(),Math.pow(2,e-1)),x:r.x,y:r.y},{ignoreZoomLimits:!0})},Ft.prototype._hide=function(){var e=this;if(!this._map)return Promise.resolve();this._settingsModule.update(this._prevSettings),this._map.removeLayer(this._layer);var t=this._dom.getContainer(),n=this._graphics.getDomElement();t&&t.appendChild(n),this._map.getContainer().style.zIndex=0;var i=this._graph.getNodes("all"),r=this._graph.getEdges("all"),o=this._transformToGraph(),a=o.offset;return this._camera.setView(o.newCameraView).then(function(){return Promise.all([w(e._map.getContainer(),1,0,e._settings.duration/2).then(function(){e._map.remove(),e._mapContainer.parentNode.removeChild(e._mapContainer)}),e._graphics.animate({nodes:i,edges:r},function(){return a.destroy()},e._settings.duration)])}).then(function(){return e._map=null,e._filter.delete()})},Ft.prototype._transformToGeo=function(){var e=this,t=function(e,t,n,i){var r=e.filter(function(F){return F.isVisible()}),o=0===r.size,a=r.reduce(function(F,L){var B=L.getGeoCoordinates(),ae=i(B.latitude,B.longitude),U=ae.y;return F.mapX.push(ae.x),F.mapY.push(U),F},{mapX:[],mapY:[]}),s=a.mapX,l=a.mapY,u=r.getAttribute("x"),d=r.getAttribute("y"),c=r.getAttribute("radius"),h=new Cr({xValues:u,yValues:d,scaledSizeValues:c}),p=new Cr({xValues:s,yValues:l});o&&(h.cx=h.cy=0,h.width=h.height=0),isFinite(p.width)&&isFinite(p.height)||(p.cx=p.cy=0,p.width=p.height=0);var g=p.cx-h.cx,m=p.cy-h.cy,b=o?1:Math.max(p.width,p.height)/Math.max(h.width,h.height),v=c.reduce(function(F,L){return F[0]=Math.min(F[0],L*b),F[1]=Math.max(F[1],L*b),F},[1/0,0]),y=v[0],S=v[1];p.pad(S),p.minScaledSize=y,p.maxScaledSize=S;var C=n.computeConfigForBounds(p),O=t.zoom/Math.pow(2,Math.ceil(Math.log2(C.zoom))),N=h.cx+(g+=(h.cx-t.x)*O),P=h.cy+(m+=(h.cy-t.y)*O);return{offsetChanges:{name:"graph-to-geo",nodeAttributes:{radius:function(F){return F.getAttribute("radius")*O},x:function(F){return(F.getAttribute("x")+g-N)*O+N},y:function(F){return(F.getAttribute("y")+m-P)*O+P}},edgeAttributes:{width:function(F){return F.getAttribute("width")*O}}},camera:Mt({zoom:t.zoom/O,x:(t.x+g-N)*O+N,y:(t.y+m-P)*O+P,angle:0},t.getSize())}}(this._graph.getNodes(),this._camera,this._locate,function(r,o){return e._fromLatLngToPoint(r,o)}),i=t.camera;return{offset:this._addGraphAttributesLayer(t.offsetChanges),newCameraView:i}},Ft.prototype._addGraphAttributesLayer=function(e){return this._graphics.addAttributeLayer(Mt({priority:6,nodeSelector:function(t){return t.isVisible()},edgeSelector:function(t){return t.isVisible()}},e))},Ft.prototype._transformToGraph=function(){var e=this,t=function(r,o,a,s){var l=r.getAttributes(["x","y","radius"]),u=r.getBoundingBox(),d=0===r.size,c=r.reduce(function(P,F,L){return P[F._index]=L,P},{});e._projection&&(e._projection.destroy(),e._projection=null);var h=r.getAttribute("x"),p=r.getAttribute("y"),g=r.getAttribute("radius"),m=new Cr({xValues:h,yValues:p,scaledSizeValues:g.map(function(P){return 2*P})});d&&(u.reset(),m.reset());var b,v,y=m.cx-u.cx,S=m.cy-u.cy,A=0,C=0,O=a.computeConfigForBounds(m),N=o.zoom/O.zoom;return v=isNaN(u.cx)||isNaN(u.cy)?(u.cx=o.x,u.cy=o.y,b=O.x,O.y):(b=(o.x+(y+=(u.cx-o.x)*N)-(A=u.cx+y))*N+A,(o.y+(S+=(u.cy-o.y)*N)-(C=u.cy+S))*N+C),{offsetChanges:{name:"geo-to-graph",nodeAttributes:{x:function(P){return(l[c[P._index]].x+y-A)*N+A},y:function(P){return(l[c[P._index]].y+S-C)*N+C}}},camera:Mt({zoom:O.zoom,x:b,y:v,angle:0},o.getSize())}}(this._graph.getNodes("all"),this._camera,this._locate),i=t.camera;return{offset:this._addGraphAttributesLayer(t.offsetChanges),newCameraView:i}},Ft.prototype.getPointFromLatLng=function(e){var t=e.getGeoCoordinates(),n=t.latitude,i=t.longitude;return null==n?e.getAttributes(["x","y"]):this._fromLatLngToPoint(n,i)},Ft.prototype._createFinalPositionLayer=function(){var e=this;return this._addGraphAttributesLayer({name:"graph-2-geo-animation",nodeAttributes:{scalingMethod:"fixed",radius:function(t){return t.getAttribute("radius")*e._settings.sizeRatio},x:function(t){return e.getPointFromLatLng(t).x},y:function(t){return e.getPointFromLatLng(t).y}},edgeAttributes:{scalingMethod:"fixed",width:function(t){return t.getAttribute("width")*e._settings.sizeRatio}}})},Ft.prototype.destroy=function(){return Promise.resolve()},Ft.prototype.setCenter=function(e,t){return this._enabled?this.setView(e,t,gd(this._camera.getZoom())):Promise.resolve()},Ft.prototype.setZoom=function(e){return this._enabled?(this._zoom=e,this._map.setZoom(e),this._onMapUpdate()):Promise.resolve()},Ft.prototype.setView=function(e,t,n){if(this._enabled)return this._map.setView(this.L.latLng([e,t]),n,{animate:!1}),this._zoom=n,this._onMapUpdate()},Ft.prototype.getView=function(){if(this._enabled){var e=this._map.getCenter();return{zoom:this._zoom,latitude:e.lat,longitude:e.lng}}},Ft.prototype.getCenter=function(){if(this._enabled){var e=this._map.getCenter();return{latitude:e.lat,longitude:e.lng}}},Ft.prototype.getZoom=function(){if(this._enabled)return this._zoom},Ft.prototype.resetCoordinates=function(){if(this._enabled){var e=this._graph.getNodes();this._restorePrevNodesCoordinates(this._graph.getNodes());var t=this._graph.getNodeAttribute(ra).getMultiple(e._indexes),n=this._graph.getNodeAttribute(oa).getMultiple(e._indexes);e.setData(this._settings.latitudePath,t),e.setData(this._settings.longitudePath,n),this._projection.update()}},Ft.prototype.updateCoordinates=function(){eo("The ogma.geo.updateCoordinates() API has been deprecated. The coordinates are updated by default now.")},Ft.prototype.getUnprojectedCoordinates=function(e){eo("The ogma.geo.getUnprojectedCoordinates() API has been deprecated. Original graph coordinates are only available when in graph mode."),this._projection.destroy();var t=e.getPosition();return this._projection=this._createFinalPositionLayer(),t},Object.defineProperty(Ft.prototype,"latitudePath",{get:function(){return this._settings.latitudePath},enumerable:!0,configurable:!0}),Object.defineProperty(Ft.prototype,"longitudePath",{get:function(){return this._settings.longitudePath},enumerable:!0,configurable:!0}),Ft.prototype.exportBackground=function(e){var t=this,n=di();n.width=e.width,n.height=e.height;var i=n.getContext("2d"),r=this._map.getSize(),o=this.getView(),a=Mt({zoom:gd(e.zoom)},this._fromPointToLatLng(e.x,e.y)),s={x:(r.x-e.width)/2,y:(r.y-e.height)/2},l=new this.L.Canvas;this._map.addLayer(l);var u=function(e,t,n,i,r,o){var a={vectorMap:[],tileLayers:[],vectorLayers:[],imageOverlays:[],markers:[]};return t.eachLayer(function(s){if(s!==e){var l=(d=s)instanceof(c=i).TileLayer?"tileLayers":d instanceof c.ImageOverlay?"imageOverlays":d instanceof c.Path?"vectorLayers":d instanceof c.Marker?"markers":"MapboxGL"in c&&d instanceof c.MapboxGL?"vectorMap":void 0;if(l in a){var u=yb[l];a[l].push(function(){return u(s,n,t,i,r,o)})}}var d,c}),a}(this._layer,this._map,i,this.L,s,l),d=u.vectorMap,c=u.tileLayers,h=u.vectorLayers,p=u.imageOverlays,g=u.markers,m=this._map.options.zoomSnap;return this.setView(a.latitude,a.longitude,a.zoom).then(function(){return t._map._onResize()}).then(function(){return Gi(d.concat(c,p,h,g))}).then(function(){t._map._onResize(),t.setView(o.latitude,o.longitude,o.zoom),t._map.options.zoomSnap=m}).then(function(){return new Promise(function(b){return t.L.Util.requestAnimFrame(b)})}).then(function(){return t._map.removeLayer(l)}).then(function(){return n})},Ft);function Ft(e){var t,n=e.camera,i=e.graph,r=e.settings,o=e.filters,a=e.events,s=e.dom,l=e.graphics,u=e.locate,d=Yg.call(this)||this;return d._enabled=!1,d._zoom=0,d._nodeDraggingSetting=!1,d._transition=!1,d._map=null,d._attribution=null,d._updating=!1,d._updateRate=50,d._x=0,d._y=0,d._graph=i,d._camera=n,d._settingsModule=r,d._filters=o,d._events=a,d._dom=s,d._graphics=l,d._locate=u,d._events.register(["geoEnabled","geoDisabled","geoLoaded","geoReady"]),d.L=null,Wh()&&(d.L=xi("L")||xi("leaflet"),d.L&&function(c){c.TileLayer.prototype.getUrl=function(){return this._url},c.ImageOverlay.prototype.getUrl=function(){return this._url};var h="leaflet-zoom-animated";c.OgmaOverlay||(c.OgmaOverlay=c.Layer.extend({options:{pane:"overlayPane",padding:0,onUpdate:function(){}},initialize:function(p){var g=p.container;c.Util.setOptions(this,p),this._container=g},setLocked:function(p){return this._locked=p,this},onAdd:function(p){this._map=p,this.getPane().appendChild(this._container),this._wgsOrigin=c.latLng([0,0]),this._wgsInitialShift=p.project(this._wgsOrigin,this._initialZoom),c.DomUtil.addClass(this._container,"leaflet-layer"),this._zoomAnimated&&(c.DomUtil.addClass(this._container,h),this._container.style.position="absolute",this._container.style.zIndex=9999),this._initialZoom=(this._map.getMaxZoom()+this._map.getMinZoom())/2,this._mapInitialZoom=this._map.getZoom(),this._updateBounds(),this._update({})},_updateBounds:function(){var p=this.options.padding,g=this._map.getSize(),m=this._map.containerPointToLayerPoint(g.multiplyBy(-p));this._bounds=new c.Bounds(m,m.add(g.multiplyBy(1+2*p))),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()},_update:function(p){var g=this;this._updateBounds(),this._redraw(this._bounds.min,p),this._positionTimer=c.Util.requestAnimFrame(function(){return c.DomUtil.setPosition(g._container,g._bounds.min)})},_redraw:function(p,g){this.options.onUpdate()},_updateTransform:function(p,g){if(!this._locked){var m=this._map.getZoomScale(g,this._zoom),b=this._map.getSize().multiplyBy(.5+this.options.padding),v=this._map.project(this._center,g),y=b.multiplyBy(-m).add(v).subtract(this._map._getNewPixelOrigin(p,g));c.Browser.any3d?c.DomUtil.setTransform(this._container,y,m):c.DomUtil.setPosition(this._container,y)}},_onZoom:function(p){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_onMoveEnd:function(p){this._update(p)},_onAnimZoom:function(p){this._updateTransform(p.center,p.zoom)},bringToFront:function(){c.DomUtil.toFront(this._container)},getEvents:function(){return{zoom:this._onZoom,moveend:this._onMoveEnd,zoomanim:this._onAnimZoom,layeradd:this.bringToFront,zoomend:this.options.onUpdate}},onRemove:function(){c.DomUtil.removeClass(this._container,h);var p=this._container;["transform","webkitTransform","OTransform","MozTransform","msTransform","zIndex","position"].forEach(function(g){return p.style[g]=null}),c.Util.cancelAnimFrame(this._positionTimer),this._container=null}}))}(d.L)),d._graph.createNodeAttribute({name:"geo.prevLat",storage:"float"}),d._graph.createNodeAttribute({name:"geo.prevLng",storage:"float"}),d._graph.createNodeAttribute({name:ra,storage:"float"}),d._graph.createNodeAttribute({name:oa,storage:"float"}),d._settings=Mt({},ys),d._events.on(((t={addNodes:function(c){return d._refreshOrAddNodes(c.nodes)}})[x.UPDATE_NODE_DATA]=function(c){d._enabled&&d._onDataChange(c.changes)},t.progressMoveNodesByDragging=function(c){return d._onNodesDragged(c)},t.startMoveNodesByDragging=function(){return d._onNodesDragStart()},t.endMoveNodesByDragging=function(){return d._setMapDragging(!0)},t[x.CAMERA_MOVE]=function(){return d._onCameraUpdate()},t[x.VIEW_CHANGED]=function(){return d._onCameraUpdate()},t)),d}function wc(e,t,n,i,r){for(var o=new Array(e.length),a=0;a<t.length;a++){var s=i[t[a]],l=i[n[a]];o[s]=o[s]||[],o[s].push(l),r&&(o[l]=o[l]||[],o[l].push(s))}return o}function wu(e,t){return-1===e[t]?t:wu(e,e[t])}function Xg(e,t,n,i,r,o,a,s){if(i[e]=r,n[e])return!0;if(t[e])return!1;t[e]=1,n[e]=1;var l=o[e];if(l)for(var u=0,d=l;u<d.length;u++){var c=d[u];if(Xg(c,t,n,i,e,o,a,s))return a.push(s[c]),!0}return n[e]=0,!1}function Jg(e,t,n){for(var i=e.length,r=new Uint8Array(i),o=new Uint8Array(i),a=new Int32Array(i),s={},l=0;l<i;l++)s[e[l]]=l;var u=wc(e,t,n,s,!1);for(l=0;l<i;l++){var d=[];if(Xg(l,r,o,a,-1,u,d,e)&&1<d.length){for(var c=d[0],h=1;h<d.length;h++)if(d[h]===c){d.length=h;break}return d.push(c),d.reverse()}}return!1}function Qg(e,t,n,i,r,o,a){t[e]=1,i[e]=n;var s=r[e];if(s)for(var l=0,u=s;l<u.length;l++){var d=u[l];if(t[d]){if(d!==n)return i[d]=e,o.push(a[d]),!0}else if(Qg(d,t,e,i,r,o,a))return o.push(a[d]),!0}return!1}var Kg=(Cc.prototype.getCycles=function(){this.visited=new Uint8Array(this.nodes.length),this.visitedStack=[];for(var e=0;e<this.nodes.length;e++)for(this.backtrack(e,e);0!==this.visitedLength;){var t=this.visitedStack.pop();this.visited[t]&&(this.visited[t]=0,this.visitedLength--)}return this.cycles},Cc.prototype.backtrack=function(e,t){var n=!1;this.stack.push(t),this.visited[t]||(this.visited[t]=1,this.visitedLength++),this.visitedStack.push(t);for(var i=0,r=this.adjacency[t]||[];i<r.length;i++){var o=r[i];if(this.removed[t]=this.removed[t]||{},!this.removed[t][o])if(o<e)this.removed[t][o]=!0;else if(o===e){for(var a=[],s=0,l=!(n=!0);s<this.stack.length;s++){var u=this.stack[s];e===u&&(l=!0),l&&a.push(this.nodes[u])}this.cycles.push(a)}else if(!this.visited[o]){var d=this.backtrack(e,o);n=n||d}}if(n)for(var c=void 0;c=this.visitedStack.pop(),this.visited[c]&&(this.visited[c]=null,this.visitedLength--),c!==t;);return this.stack.pop(),n},Cc);function Cc(e,t,n){this.cycles=[],this.visitedLength=0,this.visitedStack=[],this.stack=[],this.idToIndex={},this.removed={},this.nodes=e,this.visited=new Uint8Array(this.nodes.length);for(var i=0;i<e.length;i++)this.idToIndex[e[i]]=i;this.adjacency=wc(e,t,n,this.idToIndex)}var $g,wb=(bt(Ds,$g=E),Ds.prototype.shortestPath=function(e){void 0===e&&(e={source:void 0,target:void 0});var n=e.target,i=e.directed,r=void 0!==i&&i,o=e.filter,a=void 0===o?"visible":o,s=e.edgeCostFunction,l=void 0===s?function(){return 1}:s,u=e.heuristicFunction,d=void 0===u?function(){return 0}:u,c=this._graph.getNode(e.source),h=this._graph.getNode(n);if(!c)throw new Error("the source is not a node");if(!h)throw new Error("the target is not a node");var p=c._index,g=h._index,m=null;if(p===g)m={nodes:c.toList(),edges:this._graph.edgeList()};else{var b=this._graph.getNodeMaxIndex()+1,v=new Int32Array(b),y=new Float32Array(b),S=new Float32Array(b),A=new Set,C=new Fp(S);for(y.fill(1/0),S.fill(1/0),v.fill(-1),C.add(p),y[p]=0,S[p]=d(c,h);!C.isEmpty();){var O=C.removeMin();if(O===g){m=this._constructPath(v,p,g);break}A.add(O);var N=this._graph.getAdjacentDirections(O);if(N)for(var P=0;P<N.length;++P){for(var L=this._graph.getEdgeIndexesInDirection(N[P]),B=-1,Y=0,X=-1,ae=0;ae<L.length;++ae){var ie=L[ae],U=this._sourceList.get(ie),W=this._targetList.get(ie);if(U!==W&&!(r&&O!==U||"visible"===a&&this._excludedList.get(ie)||"raw"===a&&this._virtualList.get(ie))){var ce=l(this._edgeList.get(ie));(-1===B||ce<Y)&&(B=ie,Y=ce,X=U===O?W:U)}}if(-1!==X||A.has(X)){var he=y[O]+Y;if(!C.has(X)||he<y[X]){var Ee=this._nodeList.get(O);v[X]=B,y[X]=he,S[X]=he+d(Ee,h),C.add(X)}}}}}return Promise.resolve(m)},Ds.prototype._constructPath=function(e,t,n){for(var i=[n],r=[],o=n;o!==t;){var a=e[o],s=this._sourceList.get(a),l=this._targetList.get(a);i.push(o=o===s?l:s),r.push(a)}return i.reverse(),r.reverse(),{nodes:this._graph.nodeList(new Uint32Array(i)),edges:this._graph.edgeList(new Uint32Array(r))}},Ds.prototype.detectCycle=function(e,t){var n=t.getSource(),i=t.getTarget(),r=Jg(e._indexes,n._indexes,i._indexes);return r?this._graph.nodeList(new Uint32Array(r)).dedupe():null},Ds.prototype.getAllSimpleCycles=function(e,t){var n=this,i=t.getSource(),r=t.getTarget();return new Kg(e._indexes,i._indexes,r._indexes).getCycles().map(function(o){return n._graph.nodeList(new Uint32Array(o))})},Ds);function Ds(e){var t=e.graph,n=$g.call(this)||this;return n._graph=t,n._nodeList=t.getNodeAttribute("object"),n._edgeList=t.getEdgeAttribute("object"),n._sourceList=t.getEdgeAttribute("source"),n._targetList=t.getEdgeAttribute("target"),n._excludedList=t.getEdgeAttribute("excluded"),n._virtualList=t.getEdgeAttribute("virtual"),n}var e_,Cb=(bt(Tc,e_=E),Tc.prototype._addAttributeLayer=function(){return this._graphics.addAttributeLayer({name:"curvature",priority:2,edgeDependencies:{parallelEdges:!0},edgeContext:this._context,edgeAttributes:{curvature:function(e,t){var n,i=t.edgesAlwaysCurvy,r=t.directedEdges,o=e.getSource()===e.getTarget(),a=e.getParallelEdges(),s=a.indexOf(e);if(-1===s)return 0;if(o)n=s+1;else{var l=e.getSource(),u=a.size;if(1===u&&!i)return 0;if(r){for(var d=0,c=0;c<s;++c)a.get(c).getSource()===l&&(d+=1);n=d+1}else{var h=l!==a.get(0).getSource();n=u%2!=1||i?(1+(s/2|0))*(s%2==0?1:-1)*(h?-1:1):0===s?0:((s+1)/2|0)*(s%2==0?1:-1)*(h?-1:1)}}return n}}})},Tc);function Tc(e){var t=e_.call(this)||this;return t._context={edgesAlwaysCurvy:!1,directedEdges:!1},t._settings=e.settings,t._graphics=e.graphics,t._attributeLayer=t._addAttributeLayer(),t._settings.register("edgesAlwaysCurvy",!1,function(n){t._context.edgesAlwaysCurvy=n,t._attributeLayer.updateAll()}),t._settings.register("directedEdges",!1,function(n){t._context.directedEdges=n,t._attributeLayer.updateAll()}),t}function Tb(){return{}}function Mb(){}function Ib(){return!1}function kb(){}function Ob(){}function Nb(){}var t_,n_=(bt(ns,t_=Rd),ns.prototype.configure=function(e){this._onStart=e.onStart||Ob,this._onEnd=e.onEnd||Nb,this._update=e.update||Mb,this._onUpdate=e.onUpdate||kb,this._createContext=e.context||Tb,this._isRunning=e.isRunning||Ib},ns.prototype.setData=function(e){this._data=e},ns.prototype.getData=function(){return this._data},ns.prototype.onStart=function(){return this.fire("start",{target:this}),this._onStart.call(this),this},ns.prototype.stop=function(){},ns);function ns(e,t,n){var i=t_.call(this)||this;return i._complete=!1,i._data=null,i._dependencies=t,i._dom=n,i.configure(e),i}var i_,Lb=(bt(Cu,i_=n_),Cu.prototype.sync=function(e){var t=e.data.isRunning,n=e.data.result,i=this._onUpdate.call(this,n,this._dependencies,t);return this.fire("update",{target:this,isRunning:t}),t?this.send(i):this.stop(n)},Cu.prototype.stop=function(e){return this._complete||(this._onEnd.call(this,e,this._dependencies),this._worker.terminate(),this.fire("stop",{target:this})),this._complete=!0,this},Cu.prototype.send=function(e){return this._worker.postMessage(Cp(e)),this},Cu);function Cu(e,t,n){var i=i_.call(this,e,t,n)||this,r=[function(o){void 0===o&&(o={});for(var a=Object.keys(o),s=[],l=0,u=a.length;l<u;l++){var d=a[l],c=o[d];if("function"!=typeof c)throw new Error('Asynchronous task: dependency "'+d+'" is not found');var h=Fb(c);h?(s.push(o_(c,d)),h!==d&&s.push("var "+d+" = "+h+";")):s.push("var "+d+" = "+o_(c,d)+";")}return s.join("\n")}(e.imports),"","","var __CONTEXT = ("+i._createContext.toString()+")();","var __UPDATE_FUNC = "+i._update.toString()+";","var __IS_RUNNING_FUNC = "+i._isRunning.toString()+";","",'self.addEventListener("message", function (evt) {',"  var result    = __UPDATE_FUNC(evt.data, __CONTEXT);","  var isRunning = __IS_RUNNING_FUNC(__CONTEXT, evt.data);","  self.postMessage({ result: result, isRunning: isRunning });","});"].join("\n");return i._worker=Tp(r),i._worker.addEventListener("message",function(o){i._dom.isDestroyed()||i.sync(o)}),i}var r_=/^function\s*\(/;function o_(e,t){var n=e.toString();return r_.test(n)?"function "+(e.name||t)+" "+n.substring(n.indexOf("(")):n}function Fb(e){var t=e.toString();return e.name?e.name:r_.test(t)?null:t.substring("function ".length,t.indexOf("(")).trim()}var a_,Pb=(bt(Tu,a_=n_),Tu.prototype.sync=function(e){var t=this._update(e,this._context),n=this._isRunning(this._context,e),i=this._onUpdate.call(this,t,this._dependencies,n);this.fire("update",{target:this,isRunning:n}),n?this.send(i):this.stop(t)},Tu.prototype.send=function(e){var t=this;return this._complete||this._dom.setTimeout(function(){return t.sync(e)},0),this},Tu.prototype.stop=function(e){return this._complete||(this._onEnd(e,this._dependencies),this._complete=!0),this},Tu);function Tu(e,t,n){var i=a_.call(this,e,t,n)||this;return i._context=i._createContext(),i}var s_,Db=(bt(Mc,s_=E),Mc.prototype.run=function(e,t,n,i){var s,u,r=n,o=(void 0===(u=(e.configure||function(a){return a})(s=t,i))&&(u=s),u);return new(r?Lb:Pb)(e,i,this._dom).onStart().send(o)},Mc);function Mc(e){var t=e.dom,n=s_.call(this)||this;return n._dom=t,n}var u_,Ul="complete",Ub=(bt(jo,u_=E),jo.prototype.register=function(e,t){if(e in this._layouts)throw new Error("Layout "+e+" already exists");var n=Mt({},t,{name:e});this._layouts[e]=n},jo.prototype.getAvailableLayouts=function(){return Object.keys(this._layouts)},jo.prototype.start=function(e,t){var n=this;void 0===t&&(t={});var i=this._layouts[e];return new Promise(function(r){if(!i)throw new Error("layout "+e+" does not exist");n._currentLayout&&n.stop(),t.duration="number"==typeof t.duration?t.duration:500;var o=i.onSync,a=-1/0;t.skipTextDrawing=void 0===t.skipTextDrawing||t.skipTextDrawing;var s=t.locate||false;s&&"boolean"==typeof s&&(s={}),t.locate=s;var l=n._onTaskStart,u=n._onTaskUpdate,d=n._onTaskComplete,c={name:e,update:i.update,isRunning:i.isRunning,configure:i.configure,context:i.context,imports:i.imports,onStart:function(){l(i,t,this)},onUpdate:function(p,g,m){var b=R();m&&b-a<40||(a=b,u(this,e,p,m,o,t))},onEnd:function(p){var g=this;this.once(Ul,function(m){d(p,m,i,t,r,g.getData())})}};n._graphics.forceAttributesComputation(),n._currentLayout=n._tasks.run(c,t,void 0===t.useWebWorker||t.useWebWorker,n._modules)})},jo.prototype._animateCamera=function(e,t,n){if(0===e.indexes.length)return Promise.resolve();var i=this._locate.layoutDataBoundingBox(e),r=this._locate.computeConfigForBounds(i,t);return this._camera.setView(r,{duration:n,easing:t.easing})},jo.prototype.stop=function(){return null!==this._currentLayout&&(this._currentLayout.stop(),this._currentLayout.fire(Ul,null),this._currentLayout=null),Promise.resolve()},jo.prototype.isRunning=function(){return null!==this._currentLayout},jo.prototype._assignNodePositions=function(e,t,n){if(!e||n){var i=e?new Uint32Array(e.indexes):void 0,r=this._graph.nodeList(i);return Promise.resolve(r)}for(var a=e.x,s=e.y,l=this._graph.nodeList(new Uint32Array(e.indexes)),u=Ic(e),d=0;d<u.length;d++)u[d]={x:a[d],y:s[d]};return l.setAttributes(u,t)},jo);function jo(e){var t=u_.call(this)||this;return t._currentLayout=null,t._onTaskUpdate=function(n,i,r,o,a,s){var l=s.duration,u=s.onSync,d=s.onUpdate,c=s.dryRun,h=s.locate;if(u&&t._dom.setTimeout(function(){return u(r,t._modules,o)},l),a){var p=a(r,t._modules,o);t._events.fire(x.LAYOUT_COMPUTED,{type:x.LAYOUT_COMPUTED,name:i,positions:p}),d&&d(r,p,o);var g=t._assignNodePositions(p,l,c);o||(h&&t._animateCamera(p,h,s.duration),g.then(function(){return n.fire(Ul,p)}))}else o||n.fire(Ul,r)},t._onTaskComplete=function(n,i,r,o,a,s){t._currentLayout=null,r.onEnd&&n&&r.onEnd(n,t._modules),o.skipTextDrawing&&t._dom.setTimeout(function(){return t._graphics.showTexts()},50);var l=t._graph.nodeList(new Uint32Array(s.indexes)),u=o.dryRun&&n?i:l_(l),d=l.getId(),c={before:Ic(s),current:Ic(u)};t._events.fire(x.LAYOUT_END,{type:x.LAYOUT_END,name:r.name,positions:c,ids:d}),t._dom.setTimeout(function(){o.onEnd&&o.onEnd(n),a({name:r.name,positions:c,ids:d})})},t._onTaskStart=function(n,i,r){i.skipTextDrawing&&t._graphics.hideTexts();var o=l_(t._graph.getNodes(i.nodes)),a=o.ids;r.setData(o),t._events.fire(x.LAYOUT_START,{type:x.LAYOUT_START,name:n.name,ids:a,task:r})},t._modules=e,t._dom=e.dom,t._events=e.events,t._graph=e.graph,t._graphics=e.graphics,t._tasks=e.tasks,t._locate=e.locate,t._camera=e.camera,t._layouts={},t._events.register([x.LAYOUT_START,x.LAYOUT_END,x.LAYOUT_COMPUTED]),t._currentLayout=null,t._events.on(x.CLEAR_GRAPH,function(){return t.stop()}),t}function Ic(e){for(var t=e.x,n=e.y,i=e.indexes.length,r=new Array(i),o=0;o<i;o++)r[o]={x:t[o],y:n[o]};return r}function l_(e){var t=e.getAttribute("x"),n=e.getAttribute("y");return{ids:e.getId(),indexes:e._indexes,x:t,y:n}}function jl(e){return"number"==typeof e&&isFinite(e)}var jb=(Rs.prototype.onUpdate=function(e){this._onUpdateHandlers.push(e)},Rs.prototype.getPropertyInfo=function(){return this._info},Rs.prototype.getPath=function(){return this._path.slice()},Rs.prototype.destroy=function(){this._module.unwatchPropertyInformation(this._isNode,this._path,this._triggerUpdate,this._filter,this._unwindArrays)},Rs.prototype.kill=function(){return this.destroy()},Rs);function Rs(e,t,n){var i=n.path,r=n.filter,o=n.unwindArrays,a=this;this._module=e,this._isNode=t,this._path=i||[],this._filter=r,this._unwindArrays=o,this._onUpdateHandlers=[],this._triggerUpdate=function(s){for(var l=0;l<a._onUpdateHandlers.length;++l)a._onUpdateHandlers[l](s)},this._info=e.watchPropertyInformation(this._isNode,this._path,this._triggerUpdate,this._filter,this._unwindArrays)}var Zb=(Object.defineProperty(mr.prototype,"path",{get:function(){return this._path},enumerable:!0,configurable:!0}),mr.prototype.onPropertyAdded=function(e){return this._onAddHandlers.push(e),this},mr.prototype.onPropertyRemoved=function(e){return this._onRemoveHandlers.push(e),this},mr.prototype.onPropertyUpdated=function(e){return this._onUpdateHandlers.push(e),this},mr.prototype.getPath=function(){return this._path.slice()},mr.prototype.getProperties=function(){return this._propertyList.slice()},mr.prototype.getPropertyInfo=function(e){var t=this._properties[e];return t?t.info:null},mr.prototype.destroy=function(){var e=this;ft(this._properties,function(n,i){var r=n.handler,o=e._path.concat([i]);e._module.unwatchPropertyInformation(e._isNode,o,r,e._filter,e._unwindArrays)}),this._propertyList=void 0,this._properties=void 0,this._onAddHandlers=void 0,this._onRemoveHandlers=void 0,this._onUpdateHandlers=void 0;var t=this._module._objectPropertyWatchers.indexOf(this);this._module._objectPropertyWatchers.splice(t,1)},mr.prototype.kill=function(){return this.destroy()},mr.prototype.updateSubPropertiesToWatch=function(e,t){if(e===this._isNode)for(var n=t.getData(this._path),i=0;i<n.length;i++){var r=n[i];if(Qr(r))for(var o=Object.keys(r),a=0;a<o.length;a++)this._addSubPropertyToWatch(o[a])}},mr.prototype._addSubPropertyToWatch=function(e){var t=this;if(!this._properties[e]){var n=this._path.concat([e]),i=function(){return t._triggerPropertyUpdate(e)},s=this._module.watchPropertyInformation(this._isNode,n,i,this._filter,this._unwindArrays);this._properties[e]={handler:i,info:s},this._triggerPropertyUpdate(e)}},mr.prototype._triggerPropertyUpdate=function(e){var t=this._properties[e].info,n=this._propertyList.indexOf(e),i=-1!==n,r="undefined"!==t.getType();!i&&r?(this._propertyList.push(e),this._triggerHandlers("_onAddHandlers",e,t),this._triggerHandlers("_onUpdateHandlers",e,t)):i&&!r?(this._propertyList.splice(n,1),this._triggerHandlers("_onUpdateHandlers",e,t),this._triggerHandlers("_onRemoveHandlers",e,t)):i&&r&&this._triggerHandlers("_onUpdateHandlers",e,t)},mr.prototype._triggerHandlers=function(e,t,n){for(var i=this[e],r=0,o=i.length;r<o;r++)i[r](t,n)},mr);function mr(e,t,n){var i=n.path,r=n.filter,o=n.unwindArrays;this._module=e,this._isNode=t,this._path=i,this._filter=r,this._unwindArrays=o,this._propertyList=[],this._properties={},this._onAddHandlers=[],this._onRemoveHandlers=[],this._onUpdateHandlers=[]}var Gb=(Ma.prototype.isNode=function(){return this._watcher.isNode},Ma.prototype.getPath=function(){return this._watcher.property.slice()},Ma.prototype.getBoundaries=function(){var e=this._watcher.boundaries;return e?{min:e.min,max:e.max}:null},Ma.prototype.getValues=function(){return this._watcher.values.keys()},Ma.prototype.getValueCount=function(e){return this._watcher.values.get(e)||0},Ma.prototype.getCount=function(){return this._watcher.total},Ma.prototype.getType=function(){return 0<this._watcher.any?"any":0<this._watcher.numbers?"number":"undefined"},Ma);function Ma(e){this._watcher=e}function d_(e){return"number"==typeof e&&isNaN(e)}var c_=(Zo.prototype.set=function(e,t){var n=this._getIndex(e);return-1===n?(this._keys.push(e.slice()),this._values.push(t),!0):(this._values[n]=t,!1)},Zo.prototype.get=function(e){var t=this._getIndex(e);return-1===t?void 0:this._values[t]},Zo.prototype.has=function(e){return-1!==this._getIndex(e)},Zo.prototype.delete=function(e){var t=this._getIndex(e);return-1!==t&&(this._keys.splice(t,1),this._values.splice(t,1),!0)},Zo.prototype.keys=function(){return this._keys.map(function(e){return e.slice()})},Zo.prototype.values=function(){return this._values.slice()},Zo.prototype._getIndex=function(e){for(var t=0;t<this._keys.length;t++){var n=this._keys[t];if(n.length===e.length){for(var i=!0,r=0;r<e.length;r++){var o=n[r],a=e[r];if(!(o===a||d_(o)&&d_(a))){i=!1;break}}if(i)return t}}return-1},Object.defineProperty(Zo.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Zo);function Zo(){this._keys=[],this._values=[]}var qb=(Ia.prototype.clear=function(){return this._arrays=new c_,this._map.clear()},Ia.prototype.delete=function(e){return ui(e)?this._arrays.delete(e):this._map.delete(e)},Ia.prototype.get=function(e){return ui(e)?this._arrays.get(e):this._map.get(e)},Ia.prototype.set=function(e,t){return ui(e)?this._arrays.set(e,t):this._map.set(e,t),this},Ia.prototype.keys=function(){return il(this._map).concat(this._arrays.keys())},Ia.prototype.values=function(){return ws(this._map).concat(this._arrays.values())},Object.defineProperty(Ia.prototype,"size",{get:function(){return this._map.size+this._arrays.size},enumerable:!0,configurable:!0}),Ia);function Ia(){this._map=new Map,this._arrays=new c_}var h_,Hb=(bt(Zr,h_=E),Zr.prototype.watchNodeObjectProperty=function(e){return this._watchObjectProperty(!0,ql(e))},Zr.prototype.watchEdgeObjectProperty=function(e){return this._watchObjectProperty(!1,ql(e))},Zr.prototype.watchNodeNonObjectProperty=function(e){return this._watchNonObjectProperty(!0,ql(e))},Zr.prototype.watchEdgeNonObjectProperty=function(e){return this._watchNonObjectProperty(!1,ql(e))},Zr.prototype.watchPropertyInformation=function(e,t,n,i,r){var o=this._findWatcher(e,t,i,r)||this._createWatcher(e,t,i,r);return n&&o.onChange.push(n),o.info},Zr.prototype.unwatchPropertyInformation=function(e,t,n,i,r){var o=this._findWatcher(e,t,i,r);if(o){var a=o.onChange,s=a.indexOf(n);if(-1!==s&&(a.splice(s,1),0===a.length)){var l=this._propertyWatchers.indexOf(o);this._propertyWatchers.splice(l,1)}}},Zr.prototype._watchObjectProperty=function(e,t){var n=new Zb(this,e,t);return this._objectPropertyWatchers.push(n),n.updateSubPropertiesToWatch(e,this._graph[e?"getNodes":"getEdges"](t.filter)),n},Zr.prototype._watchNonObjectProperty=function(e,t){return new jb(this,e,t)},Zr.prototype._findWatcher=function(e,t,n,i){for(var r=0;r<this._propertyWatchers.length;++r){var o=this._propertyWatchers[r];if(o.isNode===e&&o.filter===n&&o.unwindArrays===i&&Wb(o.property,t))return o}return null},Zr.prototype._createWatcher=function(e,t,n,i){var r={isNode:e,property:t,numbers:0,any:0,total:0,values:new qb,boundaries:null,onChange:[],filter:n,unwindArrays:i,info:void 0};return r.info=new Gb(r),Mu(r,this._graph[e?"getNodes":"getEdges"](n).getData(t)),this._propertyWatchers.push(r),r},Zr);function Zr(e){var t,n=e.graph,i=e.events,r=h_.call(this)||this;return r._onExcludedStateChange=function(o){for(var a=o.elements,s=!o.value,l=0,u=r._propertyWatchers.length;l<u;l++){var d=r._propertyWatchers[l];d.isNode===a.isNode&&"visible"===d.filter&&(s?Mu(d,a.getData(d.property)):Gl(d,a.getData(d.property)),Zl(d))}},r._onDataChange=function(o){for(var a=o.isNode,s=o.changes,l=0;l<r._propertyWatchers.length;++l){var u=(A=r._propertyWatchers[l]).property,d="all"===A.filter;if(A.isNode===a)for(var c=0;c<s.length;++c){var h=s[c],p=Yb(h.property||[],u);if(p){for(var g=h.nodes||h.edges,m=[],b=[],v=0;v<g.size;++v){var y=g.get(v);(d||y.isVisible())&&(m.push(xn(h.newValues[v],p)),b.push(xn(h.previousValues[v],p)))}m.length&&(Mu(A,m),Gl(A,b),Zl(A))}}}l=0;for(var S=r._objectPropertyWatchers.length;l<S;l++){var A,C=(A=r._objectPropertyWatchers[l]).path,O=function(N){var P=s[N],F=P.property,Y=P.nodes||P.edges,X=Y.isNode;(!F||F.length<=C.length+1&&C.every(function(ae,ie){return ae===F[ie]}))&&A.updateSubPropertiesToWatch(X,Y)};for(c=0;c<s.length;++c)O(c)}},r._onElementsAdded=function(o){for(var a=o.nodes||o.edges,s=0;s<r._propertyWatchers.length;++s){var l=r._propertyWatchers[s];if(l.isNode===a.isNode){var u=a.getData(l.property);u.length&&(Mu(l,u),Zl(l))}}for(s=0;s<r._objectPropertyWatchers.length;s++)r._objectPropertyWatchers[s].updateSubPropertiesToWatch(a.isNode,a)},r._onElementsRemoved=function(o){for(var a=o.nodes||o.edges,s=0;s<r._propertyWatchers.length;++s){var l=r._propertyWatchers[s];if(l.isNode===a.isNode&&"all"===l.filter){var d=a.getData(l.property);d.length&&(Gl(l,d),Zl(l))}}},r._onGraphClear=function(){r._propertyWatchers.forEach(function(o){o.numbers=0,o.any=0,o.total=0,o.boundaries=null,o.values.clear()})},r._graph=n,r._propertyWatchers=[],r._objectPropertyWatchers=[],i.on(((t={})[x.EXCLUDED_STATE_CHANGE]=r._onExcludedStateChange,t[x.UPDATE_NODE_DATA+" "+x.UPDATE_EDGE_DATA]=r._onDataChange,t[x.ADD_NODES+" "+x.ADD_EDGES]=r._onElementsAdded,t[x.REMOVE_NODES+" "+x.REMOVE_EDGES]=r._onElementsRemoved,t[x.CLEAR_GRAPH]=r._onGraphClear,t)),r}function p_(e){return null==e?[]:Pr(e)}function Zl(e){for(var t=0;t<e.onChange.length;++t)e.onChange[t](e.info)}function Wb(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}function Yb(e,t){if(e.length>t.length)return null;for(var n=0;n<e.length;++n)if(e[n]!==t[n])return null;return t.slice(n)}function Mu(e,t,n){for(var i=e.values,r=!n&&e.unwindArrays,o=0;o<t.length;++o){var a=t[o];if(n||void 0===a||(e.total+=1),r&&Array.isArray(a))Mu(e,a,!0);else{var s=i.get(a);s?i.set(a,s+1):(i.set(a,1),jl(a)?(e.boundaries?a<e.boundaries.min?e.boundaries.min=a:a>e.boundaries.max&&(e.boundaries.max=a):e.boundaries={min:a,max:a},e.numbers+=1):void 0!==a&&(e.any+=1))}}}function Gl(e,t,n){for(var i=e.values,r=!n&&e.unwindArrays,o=e.boundaries,a=!1,s=0;s<t.length;++s){var l=t[s];if(n||void 0===l||--e.total,r&&Array.isArray(l))a=a||Gl(e,l,!0);else{var u=i.get(l);1<u?i.set(l,u-1):(i.delete(l),jl(l)?(--e.numbers,!o||o.min!==l&&o.max!==l||(a=!0)):void 0!==l&&--e.any)}}return!n&&a&&(e.boundaries=function(d){for(var c=void 0,h=void 0,p=0;p<d.length;++p){var g=d[p];jl(g)&&((void 0===c||g<c)&&(c=g),(void 0===h||h<g)&&(h=g))}return void 0===c?null:{min:c,max:h}}(i.keys())),a}function ql(e){return"object"!=typeof e||null===e||Array.isArray(e)?{path:p_(e),filter:"visible",unwindArrays:!1}:{path:p_(e.path),filter:"all"===e.filter?"all":"visible",unwindArrays:!!e.unwindArrays}}function kc(e,t,n,i){void 0===e&&(e=function(a,s){return a-s}),void 0===t&&(t=[]),void 0===n&&(n={}),void 0===i&&(i=function(a){return a});var r=t.length;function o(a){for(;;){var s=2*a+1,l=1+s,u=a;if(s<r&&e(t[s],t[u])<0&&(u=s),l<r&&e(t[l],t[u])<0&&(u=l),u===a)return a;var d=t[u];t[u]=t[a],t[a]=d,n[i(t[u])]=u,n[i(d)]=a,a=u}}return{get keys(){return n},get size(){return r},heapify:o,pop:function(){if(!(r<=0)){if(1===r)return r--,t[0];var a=t[0];return t[0]=t[r-1],r--,o(0),a}},decreaseKey:function(a,s){for(void 0!==s&&(t[a]=s,n[i(s)]=a);0<a;){var l=a-1>>1;if(!(0<e(t[l],t[a])))break;var u=t[a];t[a]=t[l],t[l]=u,n[i(t[a])]=a,a=n[i(u)]=l}return a},min:function(){return t[0]},remove:function(a){return this.decreaseKey(a,Number.NEGATIVE_INFINITY),this.pop()},push:function(a){var s=++r-1;for(t[s]=a;0<s;){var l=s-1>>1;if(!(0<e(t[l],t[s])))break;var u=t[s];t[s]=t[l],t[l]=u,n[i(t[s])]=s,s=n[i(u)]=l}return s},empty:function(){return r<=0},toArray:function(){return t.slice(0,r)}}}function Hl(e,t,n,i,r,o,a){void 0===i&&(i=e.map(function(L,B){return B+1}));var s=i?i.length:e.length,l=new Float32Array(s),u=new Int32Array(s),d=new Uint32Array(s),c=Number.POSITIVE_INFINITY,h={};if(0===s)return{distances:l,path:null,pathLength:null};if(!r){r={};for(var p=0;p<s;p++)r[i[p]]=p}for(p=0;p<s;p++)l[p]=c,u[p]=-1,d[p]=h[p]=p;var g=kc(function(L,B){return l[L]-l[B]},d,h);for(l[r[t]]=0,g.decreaseKey(h[r[t]]);0!==g.size;){var m=g.pop(),b=l[m],v=e[m];if(b===c)break;p=0;for(var y=v.nodes.length;p<y;p++){var S=v.nodes[p],A=o?1:a?a(i[m],S):v.weights[p],C=r[S];if(void 0!==C){var O=b+A;O<l[C]&&(l[C]=O,u[C]=m,g.decreaseKey(h[C]))}}}var N=null,P=null;if(void 0!==n){var F=r[n];if(l[F]!==c){for(N=[],p=F;-1!==p;p=u[p])N.push(i[p]);N.reverse(),P=l[n]}}return{distances:l,path:N,pathLength:P}}function f_(e,t){var n=e.getPosition(),i=t.getPosition();return vi(n.x,n.y,i.x,i.y)}var g_,Xb={pathLengthFunction:f_,heuristicLengthFunction:f_},Jb={pathLengthFunction:function(){return 1},heuristicLengthFunction:function(){return 0}},Qb=(bt(Iu,g_=E),Iu.prototype.astar=function(e,t,n){return __(this._graph,e,t,this._cachedObjectList,Mt({},Xb,n))},Iu.prototype.dijkstra=function(e,t,n){return __(this._graph,e,t,this._cachedObjectList,Mt({},Jb,n))},Iu.prototype.dijkstraBig=function(e,t,n){var i=this._graph.getNodes(),r=Hl(this._graph.getAdjacencyList({directed:n.directed,weight:1,nodes:i}),this._graph.getNode(e)._index,this._graph.getNode(t)._index,i._indexes,void 0,!1);return r.path&&this._graph.nodeList(new Uint32Array(r.path))},Iu);function Iu(e){var t=e.graph,n=g_.call(this)||this;return n._graph=t,n._cachedObjectList=t.getNodeAttribute("object"),n}function __(e,t,n,i,r){var o=void 0===r?{}:r,a=o.pathLengthFunction,s=o.heuristicLengthFunction,l=o.filter,u=o.directed,d=e.getNode(t)._index,c=e.getNode(n)._index,h=a,p=s,g=u?rr.OUT:rr.BOTH,m=i.get(d),b=i.get(c),v=null;if(d===c)return e.nodeList(new Uint32Array([d]));for(var y=e.getNodeMaxIndex()+1,S=new Sp,A=new Sp,C=new Int32Array(y),O=new Float32Array(y),N=new Float32Array(y),P=0;P<y;++P)C[P]=-1,O[P]=1/0,N[P]=1/0;for(A.add(d),O[d]=0,N[d]=p(m,b);0!==A.length;){var F=A.length,L=A.get(0),B=0,Y=N[L];for(P=1;P<F;++P){var X=A.get(P),ae=N[X];ae<Y&&(Y=ae,L=X,B=P)}if(L===c){v=Kb(C,d,c);break}var ie=i.get(L);A.removeByPosition(B),S.add(L);var U=e.node(L).getAdjacentNodes({direction:g,filter:l})._indexes;for(P=0;P<U.length;++P){var W=U[P],ce=i.get(W);if(!S.has(W)){var he=O[L]+h(ie,ce);!A.add(W)&&he>=O[W]||(C[W]=L,O[W]=he,N[W]=he+p(ce,b))}}}return v&&e.nodeList(v)}function Kb(e,t,n){for(var i=[n],r=n;r!==t;)i.push(r=e[r]);return i.reverse(),i}var m_,$b=(bt(kr,m_=E),Object.defineProperty(kr.prototype,"x",{get:function(){return this._position.x||0},enumerable:!0,configurable:!0}),Object.defineProperty(kr.prototype,"y",{get:function(){return this._position.y||0},enumerable:!0,configurable:!0}),kr.prototype._later=function(){return this._dom.afterNextFrame()},kr.prototype.move=function(e){var t=this,n=e.x,i=e.y;return void 0!==n&&void 0!==i?this._dom.afterNextFrame().then(function(){return t._events.fire(x.VIRTUAL_MOVE,{x:n,y:i,dx:n-t.x,dy:i-t.y}),t._later()}):Promise.resolve()},kr.prototype.down=function(e){var t=this,n=void 0===e?{}:e,o=n.button,a=void 0===o?Yt.LEFT:o;return this.move({x:n.x,y:n.y}).then(function(){return t._events.fire(x.VIRTUAL_DOWN,{x:t.x,y:t.y,button:a}),t._events.fire(x.VIRTUAL_MOVE,{x:t.x,y:t.y,dx:0,dy:0,button:a}),t._later()})},kr.prototype.up=function(e){var t=this,n=void 0===e?{}:e,i=n.x,r=n.y,o=n.button,a=void 0===o?Yt.LEFT:o;return this.move({x:i,y:r}).then(function(){return t._events.fire(x.VIRTUAL_UP,{x:i,y:r,button:a}),t._later()})},kr.prototype.click=function(e){var t=this,n=void 0===e?{}:e,i=n.x,r=n.y,o=n.button,a=void 0===o?Yt.LEFT:o;return this.move({x:i,y:r}).then(function(){return t._events.fire(x.VIRTUAL_CLICK,{x:i,y:r,button:a}),t._later()})},kr.prototype.rightClick=function(e){var t=this,n=void 0===e?{}:e,i=n.x,r=n.y,o=n.button,a=void 0===o?Yt.RIGHT:o;return this.move({x:i,y:r}).then(function(){return t._events.fire(x.VIRTUAL_CLICK,{x:i,y:r,button:a}),t._later()})},kr.prototype.doubleClick=function(e){var t=this,n=void 0===e?{}:e,i=n.x,r=n.y,o=n.button,a=void 0===o?Yt.LEFT:o;return this.move({x:i,y:r}).then(function(){return t._events.fire(x.VIRTUAL_DOUBLE_CLICK,{x:i,y:r,button:a}),t._later()})},kr.prototype.drag=function(e,t){var n=this;return this.down(e).then(function(){return n.move(t)}).then(function(){return n.up(t)})},kr.prototype.wheel=function(e){var t=this,n=e.x,i=e.y,r=e.delta;return this.move({x:n,y:i}).then(function(){return t._events.fire(x.VIRTUAL_WHEEL,{x:n,y:i,delta:r}),t._later()})},kr);function kr(e){var t=e.position,n=e.dom,i=e.events,r=m_.call(this)||this;return r._dom=n,r._events=i,r._position=t,r._events.register([x.VIRTUAL_DOWN,x.VIRTUAL_UP,x.VIRTUAL_MOVE,x.VIRTUAL_CLICK,x.VIRTUAL_DOUBLE_CLICK,x.VIRTUAL_WHEEL]),r}function Gr(e,t,n,i,r,o){var a=Nn(),s=o.graphToScreenCoordinates(e),l=o.graphToScreenCoordinates(t);r.beginPath(),r.moveTo(s.x*a,s.y*a),r.lineTo(l.x*a,l.y*a),r.strokeStyle=i,r.lineWidth=n,r.stroke()}function v_(e,t,n,i){for(var r,o,a=0,s=e.length-1;a<s;)r=(a+s)/2|0,o=Math.abs(t[e[r]]-n),Math.abs(t[e[1+r]]-n)<=o?a=1+r:s=r;return i?s:e[s]}function y_(e,t,n,i,r,o,a){for(var s,l,u,d,c,h,p=!1,g=0,m=e.length;!p&&g<m;g++)for(var b=0;!p&&b<m;b++)if(g!==b){var v=e[g],y=e[b];b<g&&(d=y,y=v,v=d);var S=t[v],A=t[y],C=o.get(v),O=o.get(y);S+C<i-r&&i+r<A-O&&Math.abs(Math.abs(S+C-(i-r))-Math.abs(A-O-(i+r)))<=a?(s=v,l=n,u=y,c=[S+C,(h=S+C+Math.abs(A-O-(S+C))/2)-r,h+r,A-O],p=!0):S+C<i-r&&A+O<i-r&&Math.abs(Math.abs(S+C-(A-O))-Math.abs(Math.max(S+C,A+O)-(i-r)))<=a?(s=v,l=y,u=n,c=[S+C,A-O,A+O,(h=A+C+Math.abs(Math.abs(S+C-(A-O)))+r)-r],p=!0):i+r<S-C&&i+r<A-O&&Math.abs(Math.abs(S+C-(A-O))-Math.abs(Math.min(S-C,A-O)-(i+r)))<=a&&(s=n,l=v,u=y,c=[(h=S-C-Math.abs(Math.abs(S+C-(A-O)))-r)+r,S-C,S+C,A-O],p=!0)}return p?{a:s,b:l,c:u,current:n,target:h,points:c}:null}var $n,qr,Oc={tolerance:5,centerSnapDistance:240,sideSnapDistanceFactor:3,guidelineWidth:1,guidelineColor:"#ff0000",preferredDistance:{enabled:!0,ratio:1.13,tolerance:10,lineColor:"#00C3FF",lineWidth:1},neighbours:{enabled:!0,offset:5,tolerance:3,lineColor:"#00C3FF",lineWidth:1}};(qr=$n=$n||{})[qr.NONE=0]="NONE",qr[qr.CENTER=1]="CENTER",qr[qr.LEFT=2]="LEFT",qr[qr.RIGHT=3]="RIGHT",qr[qr.TOP=4]="TOP",qr[qr.BOTTOM=5]="BOTTOM";var x_,e1=(bt(bo,x_=E),bo.prototype.enable=function(e){var t=this;this._enabled||(this._options=on(e,Oc),this._enabled=!0,this._graphics.addCanvas(this._canvas),this._events.on(x.NODES_DRAG_START,this._onNodeDragStart),this._events.on(x.NODES_DRAG_END,this._onNodeDragEnd),this._settings.update({"interactions.drag.onBeforeDrag":function(n,i,r,o){return t._onBeforeDrag(i,r,o)}}))},bo.prototype.disable=function(){this._enabled&&(this._events.removeListener(this._onNodeDragStart),this._events.removeListener(this._onNodeDragEnd),this._graphics.removeCanvas(this._canvas),this._settings.update({"interactions.drag.onBeforeDrag":null}),this._enabled=!1)},bo.prototype.enabled=function(){return this._enabled},bo.prototype._onBeforeDrag=function(e,t,n){if(this._node){var i=n[0];this._scan(i),this._node.setAttributes(i)}},bo.prototype._cacheViewportData=function(){var e=this._camera,t=e.screenToGraphCoordinates({x:0,y:0}),n=e.screenToGraphCoordinates({x:e.width,y:e.height});this._nodes=this._spatial.getNodesByBoundingBox(t.x,t.y,n.x,n.y);var i=this._node._index,r=Array.from(this._nodes._indexes);r.splice(r.indexOf(i),1);var o=this._graph.getNodeAttribute("radius"),a=this._graph.getNodeAttribute("x"),s=this._graph.getNodeAttribute("y"),l=a.buffer(),u=s.buffer(),d=Xr(r.slice(),a),c=Xr(r.slice(),s),h={},p={};this._gridResolution=this._node.getAttribute("radius");for(var g=this._gridResolution,m=0,b=r.length;m<b;m++){var v=d[m],y=c[m],S=l[v]/g|0,A=u[y]/g|0;h[S]||(h[S]=[]),p[A]||(p[A]=[]),h[S].push(v),p[A].push(y)}this._nodesByX=d,this._nodesByY=c,this._xGrid=h,this._yGrid=p,this._xList=a,this._yList=s,this._X=l,this._Y=u,this._R=o},bo.prototype._scan=function(e){Za(this._canvas,this._ctx);var t,n,i,r,o,a,s,l,u,d=this._node._index,c=e.x,h=e.y,p=this._r,g=this._options,m=this._xList,b=this._yList,v=this._R,y=this._X,S=this._Y,A=this._camera.zoom,C=Math.min(p,this._options.tolerance/A),O=2*p*g.sideSnapDistanceFactor,N=g.guidelineWidth,P=g.guidelineColor,F=d,L=d,B=!1,Y=!1;if(F=v_(this._nodesByX,y,c),L=v_(this._nodesByY,S,h),Math.abs(y[F]-c)>g.centerSnapDistance&&(F=d),Math.abs(S[L]-h)>g.centerSnapDistance&&(L=d),this._xsnap=$n.NONE,F!==d){t=this._vguideline.start,n=this._vguideline.end,i=y[u=F],r=S[u],o=v.get(u),l=Math.abs(c-i);var X=Math.abs(c-p-(i-o)),ae=Math.abs(c+p-(i+o));l<Math.max(p,o)&&(r<h?(t.y=r-o,n.y=h+p):(t.y=r+o,n.y=h-p),(ie=Math.min(X,l,ae))===l?(t.x=n.x=i,n.y=h,t.y=r,this._xsnap=$n.CENTER):Math.abs(h-r)<o+p+O&&(ie===X?(t.x=n.x=i-o,this._xsnap=$n.LEFT):(t.x=n.x=i+o,this._xsnap=$n.RIGHT)),ie<C&&(B=!0)),this._xsnap!==$n.NONE&&Gr(t,n,N,P,this._ctx,this._camera)}if(this._ysnap=$n.NONE,L!==d){t=this._hguideline.start,n=this._hguideline.end,i=y[u=L],r=S[u],o=v.get(u),l=Math.abs(h-r);var ie,U=Math.abs(h-p-(r-o)),W=Math.abs(h+p-(r+o));l<Math.max(p,o)&&(i<c?(t.x=i-o,n.x=c+p):(t.x=i+o,n.x=c-p),(ie=Math.min(U,l,W))===l?(t.y=n.y=r,n.x=c,t.x=i,this._ysnap=$n.CENTER):Math.abs(c-i)<o+p+O&&(ie===U?(t.y=n.y=r-o,this._ysnap=$n.TOP):(t.y=n.y=r+o,this._ysnap=$n.BOTTOM)),ie<C&&(Y=!0)),this._ysnap!==$n.NONE&&Gr(t,n,N,P,this._ctx,this._camera)}if(g.preferredDistance.enabled){var ce=g.preferredDistance.ratio,he=Math.min(g.preferredDistance.tolerance/A,p),Ee=Math.max(p,o);if(F===d||this._xsnap!==$n.NONE&&B)L!==d&&(this._ysnap===$n.NONE||!Y)&&(i=y[u=L],r=S[u],o=v.get(u),(s=Math.abs(h-r)-(p+o)*(1+ce))<=he&&-he<=s)&&(Te=h<r?-1:1,n=this._hguideline.end,(t=this._hguideline.start).x=i-Ee,n.x=i+Ee,t.y=n.y=r,Gr(t,n,N,P,this._ctx,this._camera),t.x=c-Ee,n.x=c+Ee,t.y=n.y=r+Te*(1+ce)*(p+o),Gr(t,n,N,P,this._ctx,this._camera),this._ysnap=$n.CENTER,Y=!0);else if(i=y[u=F],r=S[u],o=v.get(u),(a=Math.abs(c-i)-(p+o)*(1+ce))<=he&&-he<=a){var Te=c<i?-1:1;(t=this._vguideline.start).x=(n=this._vguideline.end).x=i+Te*(1+ce)*(p+o),t.y=r-Ee,n.y=r+Ee,t.x=n.x=i,Gr(t,n,N,P,this._ctx,this._camera),t.y=h-Ee,n.y=h+Ee,t.x=n.x=i+Te*(1+ce)*(p+o),Gr(t,n,N,P,this._ctx,this._camera),this._xsnap=$n.CENTER,B=!0}}if(g.neighbours.enabled){var it=this._gridResolution,rt=c/it|0,We=h/it|0,_t=this._xGrid,wt=this._yGrid,Ue=[],Ze=[].concat(wt[We-1]||Ue,wt[We]||Ue,wt[1+We]||Ue),Ne=[].concat(_t[rt-1]||Ue,_t[rt]||Ue,_t[1+rt]||Ue),Ge=void 0;1<Ze.length&&(Xr(Ze,m),(Ge=y_(Ze,y,d,c,p,v,C))&&(this._drawNeighbourGuidelines(Ge,e,!1),B=!1)),1<Ne.length&&!Ge&&(Xr(Ne,b),(Ge=y_(Ne,S,d,h,p,v,C))&&(this._drawNeighbourGuidelines(Ge,e,!0),Y=!1))}(B||Y)&&this._snap(e,!B,!Y)},bo.prototype._drawNeighbourGuidelines=function(e,t,n){var i,r,o=e.a,a=e.b,s=e.c,l=e.points,u=e.target,d={x:0,y:0},c={x:0,y:0},p=this._X,g=this._Y,m=this._R.getMultiple([o,a,s]),b=m[0],v=m[1],y=m[2],S=this._options.neighbours,A=S.offset,C=S.lineWidth,O=S.lineColor;r=n?(t.y=u,b=-b,v=-v,y=-y,i=c.x=d.x=Math.min(p[o]+b,p[a]+v,p[s]+y)-A,p):(t.x=u,i=c.y=d.y=Math.max(g[o]+b,g[a]+v,g[s]+y)+A,g);var N=n?"y":"x",P=n?"x":"y";d[N]=l[0],c[N]=l[1],Gr(d,c,C,O,this._ctx,this._camera),d[N]=l[2],c[N]=l[3],Gr(d,c,C,O,this._ctx,this._camera),d[N]=l[0],d[P]=i-A/2,c[N]=l[0],d[P]=r[o]+b,Gr(d,c,C,O,this._ctx,this._camera),d[N]=l[1],d[P]=i-A/2,c[N]=l[1],d[P]=r[a]+v,Gr(d,c,C,O,this._ctx,this._camera),d[N]=l[2],d[P]=i-A/2,c[N]=l[2],d[P]=r[a]+v,Gr(d,c,C,O,this._ctx,this._camera),d[N]=l[3],d[P]=i-A/2,c[N]=l[3],d[P]=r[s]+y,Gr(d,c,C,O,this._ctx,this._camera)},bo.prototype._snap=function(e,t,n){var i,r=this._xsnap,o=this._ysnap;t||r===$n.NONE||(i=this._vguideline.end,e.x=r===$n.LEFT?i.x+this._r:r===$n.RIGHT?i.x-this._r:i.x),n||o===$n.NONE||(i=this._hguideline.end,e.y=o===$n.TOP?i.y+this._r:o===$n.BOTTOM?i.y-this._r:i.y)},bo);function bo(e){var t=e.graph,n=e.graphics,i=e.spatial,r=e.camera,o=e.events,a=e.settings,s=x_.call(this)||this;return s._options=rn(Oc),s._enabled=!1,s._ysnap=$n.NONE,s._xsnap=$n.NONE,s._node=null,s._nodes=null,s._r=0,s._vguideline={start:{x:0,y:0},end:{x:0,y:0}},s._hguideline={start:{x:0,y:0},end:{x:0,y:0}},s._gridResolution=0,s._onNodeDragStart=function(l){var u=l.nodes;1===u.size&&(s._node=u.get(0),s._cacheViewportData(),s._r=s._node.getAttribute("radius"))},s._onNodeDragEnd=function(){s._node=null,Za(s._canvas,s._ctx)},s._graph=t,s._graphics=n,s._spatial=i,s._settings=a,s._events=o,s._camera=r,s._options=rn(Oc),s._enabled=!1,s._canvas=di(),s._ctx=s._canvas.getContext("2d"),s}var t1=(Eo.prototype.getId=function(){return this._id},Eo.prototype.whenApplied=function(){return this._whenApplied},Eo.prototype.refresh=function(){return this._module.refreshRule(this._id)},Eo.prototype.getIndex=function(){return this._module.getRuleIndex(this._id)},Eo.prototype.setIndex=function(e){return this._module.setRuleIndex(this._id,e)},Eo.prototype.update=function(e){return this._module.updateRule(this._id,e)},Eo.prototype.getDefinition=function(){return this._module.getRuleDefinition(this._id)},Eo.prototype.destroy=function(){return this._module.destroyRule(this._id)},Eo.prototype.delete=function(){return this.destroy()},Eo);function Eo(e,t,n){var i=this;this._module=e,this._id=t,this._whenApplied=n.then(function(){return i})}var b_,n1=(bt(Or,b_=E),Or.prototype._get=function(e){for(var t=0;t<this._rules.length;++t){var n=this._rules[t];if(n.id===e)return n.index=t,n}throw new Error("calling a method on a destroyed style rule")},Or.prototype._updatePriorities=function(){for(var e=0;e<this._rules.length;++e)this._rules[e].attributeLayer.update({priority:3+.001*e})},Or.prototype.addRule=function(e){void 0===e&&(e={});var t=this._idCounter++,n=this._graphics.addAttributeLayer(Mt({name:"rule("+t+")"},Nc(e))),i=this._dom.afterNextFrame(),r=new t1(this,t,i);return this._rules.push({id:t,attributeLayer:n,wrapper:r}),this._updatePriorities(),r},Or.prototype.getRuleIndex=function(e){return this._get(e).index},Or.prototype.setRuleIndex=function(e,t){var n=this._get(e),i=_e(t,0,this._rules.length-1);return this._rules.splice(n.index,1),this._rules.splice(i,0,n),this._updatePriorities(),this._dom.afterNextFrame()},Or.prototype.updateRule=function(e,t){var n=this._get(e),i=Object.assign({fullOverwrite:t.fullOverwrite},Nc(t));return n.attributeLayer.update(i),this._dom.afterNextFrame()},Or.prototype.getRuleDefinition=function(e){return Nc(this._get(e).attributeLayer.getDefinition())},Or.prototype.destroyRule=function(e){var t=this._get(e);return t.attributeLayer.destroy(),this._rules.splice(t.index,1),this._dom.afterNextFrame()},Or.prototype.refreshRule=function(e){return this._get(e).attributeLayer.updateAll(),this._dom.afterNextFrame()},Or.prototype.refreshAllRules=function(){for(var e=0;e<this._rules.length;e++)this._rules[e].attributeLayer.updateAll();return this._dom.afterNextFrame()},Or.prototype.getRuleList=function(){return this._rules.map(function(e){return e.wrapper})},Or);function Or(e){var t=b_.call(this)||this;return t._idCounter=1,t._rules=[],t._graphics=e.graphics,t._dom=e.dom,t._rules=[],t}function Nc(e){return{nodeAttributes:e.nodeAttributes,edgeAttributes:e.edgeAttributes,nodeSelector:e.nodeSelector,edgeSelector:e.edgeSelector,nodeDependencies:e.nodeDependencies,edgeDependencies:e.edgeDependencies,nodeOutput:e.nodeOutput,edgeOutput:e.edgeOutput}}var E_,S_={strokeColor:"#00C3FF",fillColor:"rgba(0,195,255,0.1)",strokeWidth:1,cursorStyle:"cell",callback:function(e){return e.nodes.setSelected(!0)},bothExtremities:!1},A_=(bt(is,E_=E),is.prototype.enable=function(e){if(!this._enabled)return this._enabled=!0,this._captor.setDetectionEnabled(!1),this._options=on(e,S_),this._graphics.addCanvas(this._canvas),$r(this._canvas,this._options.cursorStyle),this._captor.isLeftPressed()&&this._interaction.start(this._captor.getCursorPosition()),this},is.prototype.disable=function(){if(this._enabled)return this._enabled=!1,this._captor.setDetectionEnabled(!0),this._graphics.removeCanvas(this._canvas),this},is.prototype.enabled=function(){return this._enabled},is.prototype.savePoint=function(e,t,n){var i=Nn(),r=this._ctx,o=this._options,a=this._points;if(this._bbox.addPoint(e,t),r.clearRect(0,0,this._canvas.width,this._canvas.height),a.push({x:e,y:t}),n){var s=a[0];r.lineWidth=o.strokeWidth,r.lineJoin="bevel",r.strokeStyle=o.strokeColor,r.fillStyle=o.fillColor,r.beginPath(),r.moveTo(s.x*i,s.y*i);for(var l=1;l<a.length;++l){var u=a[l];r.lineTo(u.x*i,u.y*i)}r.stroke(),o.fillColor&&r.fill()}},is.prototype.filterByExtremities=function(e,t){var n=this._graph.getEdgeAttribute("source"),i=this._graph.getEdgeAttribute("target");return e.filter(function(r){var o=r._index,a=n.get(o),s=i.get(o);return t[a]&&t[s]})},is);function is(e){var t=e.locate,n=e.graphics,i=e.captor,r=e.graph,o=e.spatial,a=e.interactions,s=E_.call(this)||this;return s._enabled=!1,s._points=[],s._bbox=new Cr,s._onStart=function(l){var u=l.x,d=l.y;s._bbox.reset(),s.savePoint(u,d,!1)},s._onStop=function(){var l=s._bbox,p=s._spatial.queryProjected(l.minX,l.minY,l.maxX,l.maxY),m=p.edges,b={},v=p.nodes.filter(function(S){var A=S.isVisible(),C=S.getAttribute("detectable"),O=A&&C&&s._locate.isNodeInPolygon(S,s._points);return b[S._index]=O}),y=m.filter(function(S){var A=S.isVisible(),C=S.getAttribute("detectable");return A&&C&&s._locate.isEdgeInPolygon(S,s._points)});s._options.bothExtremities&&(y=s.filterByExtremities(y,b)),s._ctx.clearRect(0,0,s._canvas.width,s._canvas.height),s._points=[],s.disable(),s._options.callback({nodes:v,edges:y})},s._locate=t,s._graph=r,s._graphics=n,s._captor=i,s._interactions=a,s._spatial=o,s._options=rn(S_),s._canvas=di(),s._ctx=s._canvas.getContext("2d"),s._interaction=s._interactions.onDrag({priority:"lasso",check:function(){return s._enabled},onStart:s._onStart,onProgress:function(l){return s.savePoint(l.x,l.y,!0)},onStop:s._onStop}),s}var w_,C_={strokeColor:"#00C3FF",fillColor:"rgba(0,195,255,0.1)",strokeWidth:1,cursorStyle:"cell",callback:function(e){var t=e.nodes,n=e.edges;t.size?t.setSelected(!0):n.setSelected(!0)},bothExtremities:!1},i1=(bt(rs,w_=A_),rs.prototype.enable=function(e){this._enabled||(this._enabled=!0,this._options=on(e,C_),this._graphics.addCanvas(this._canvas),$r(this._canvas,this._options.cursorStyle),this._captor.isLeftPressed()&&this._interaction.start(this._captor.getCursorPosition()))},rs.prototype.disable=function(){if(this._enabled)return this._enabled=!1,this._graphics.removeCanvas(this._canvas),this},rs.prototype.enabled=function(){return this._enabled},rs.prototype._formatRectangle=function(e){var t=this._start.x,n=this._start.y,i=e.x,r=e.y,o=Math.abs(t-i),a=Math.abs(n-r),s=t<i?t:i,l=n<r?n:r;return this._rectangle.reset().addPoint(s,l).addPoint(s+o,l+a)},rs.prototype._refreshRectangle=function(e){var t=this._formatRectangle(e),n=t.minX,i=t.minY,r=t.width,o=t.height,a=Nn();Za(this._canvas,this._ctx),this._ctx.strokeRect(n*a,i*a,r*a,o*a),this._options.fillColor&&this._ctx.fillRect(n*a,i*a,r*a,o*a)},rs);function rs(e){var t=w_.call(this,e)||this;return t._options=rn(C_),t._canvas=di(),t._ctx=t._canvas.getContext("2d"),t._enabled=!1,t._start=null,t._rectangle=new Cr,t._interaction=t._interactions.onDrag({priority:"lasso",disableDetection:!0,check:function(){return t._enabled},onStart:function(n){var i=n.x,r=n.y;t._rectangle.reset(),t._start={x:i,y:r},t._ctx.fillStyle=t._options.fillColor,t._ctx.strokeStyle=t._options.strokeColor,t._ctx.lineWidth=t._options.strokeWidth},onProgress:function(n){return t._refreshRectangle({x:n.x,y:n.y})},onStop:function(){var n=t._captor.getCursorPosition(),i=t._formatRectangle(n),r=t._spatial.queryProjected(i.minX,i.minY,i.maxX,i.maxY),a=r.edges,s={},l=r.nodes.filter(function(d){var c=d.isVisible(),h=d.getAttribute("detectable"),p=c&&h&&t._locate.isNodeInRectangle(d,i);return s[d._index]=p}),u=a.filter(function(d){var c=d.isVisible(),h=d.getAttribute("detectable");return c&&h&&t._locate.isEdgeInRectangle(d,i)});t._options.bothExtremities&&(u=t.filterByExtremities(u,s)),Za(t._canvas,t._ctx),t.disable(),t._options.callback({nodes:l,edges:u})}}),t}function Wl(e,t,n,i,r,o,a,s){void 0===r&&(r=0),void 0===o&&(o=Math.sin(r)),void 0===a&&(a=Math.cos(r)),void 0===s&&(s=[0,0,0,0]);var l,u,d,c,h,p,g,m,b=n/2,v=i/2,y=e+b,S=t+v;return 0===r?(s[0]=e,s[1]=t,s[2]=e+n,s[3]=t+i):(h=g=l=y+(d=-b)*a-(c=-v)*o,p=m=u=S+d*o+c*a,(l=y+(d=-b)*a-(c=v)*o)<h?h=l:g<l&&(g=l),(u=S+d*o+c*a)<p?p=u:m<u&&(m=u),(l=y+(d=b)*a-(c=v)*o)<h?h=l:g<l&&(g=l),(u=S+d*o+c*a)<p?p=u:m<u&&(m=u),(l=y+(d=b)*a-(c=-v)*o)<h?h=l:g<l&&(g=l),(u=S+d*o+c*a)<p?p=u:m<u&&(m=u),s[0]=h,s[1]=p,s[2]=g,s[3]=m),s}function zs(e,t,n,i,r){void 0===r&&(r=0);var o=n/2,a=i/2,s=e+o,l=t+a;if(0===r)return[{x:e,y:t},{x:e+n,y:t},{x:e+n,y:t+i},{x:e,y:t+i}];var u,d,c=Math.sin(r),h=Math.cos(r);return[{x:s+(u=-o)*h-(d=-a)*c,y:l+u*c+d*h},{x:s+(u=-o)*h-(d=a)*c,y:l+u*c+d*h},{x:s+(u=o)*h-(d=a)*c,y:l+u*c+d*h},{x:s+(u=o)*h-(d=-a)*c,y:l+u*c+d*h}]}function Lc(e,t,n,i){void 0===t&&(t=0),void 0===n&&(n=1),void 0===i&&(i=af.slice());var r=n*Math.sin(t),o=n*Math.cos(t);return i[0]=e[0]+r,i[1]=e[1]+o,i[2]=e[2]+r,i[3]=e[3]+o,i}function T_(e,t,n,i,r,o,a,s){return r<e&&e<a&&o<t&&t<s||r<n&&n<a&&o<i&&i<s}function Go(e,t,n,i,r,o,a,s){return o<=i&&t<=s&&r<=n&&e<=a}function os(e,t,n,i,r,o){return{minX:e,minY:t,maxX:n,maxY:i,leaf:!0,level:o,parent:r,objects:[],final:!1,children:null}}function M_(e){return[e.minX,e.minY,e.maxX,e.maxY]}function Fc(e,t,n,i,r,o,a,s){var l=(e+n)/2,u=(t+i)/2;return r<=l&&l<=a&&o<=u&&u<=s}function I_(e,t,n,i,r,o,a,s){var l=(o+s)/2,u=(t+i)/2;return(e+n)/2<=(r+a)/2?u<=l?0:1:u<=l?3:2}function u1(e){return e}var k_=(Object.defineProperty(ai.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(ai.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),ai.prototype.clear=function(){return this._root=null,this._objects={},this._size=0,this._idToCell={},this._rootLevel=0,this._maxLevel=this._rootLevel+30,this},ai.prototype.insert=function(e,t,n){if(void 0===n&&(n=this._root),t=t||this._getBBox(e),!this._objects[e]){if(this._objects[e]=!0,this._size++,!this._root){var i=Math.max(Math.abs(t[2]-t[0]),Math.abs(t[3]-t[1]));return this._root=os(t[0],t[1],t[0]+i,t[1]+i,null,this._rootLevel),this._root.objects.push(e),e}for(var r,o=[n],a=!1,s=this._nodeCapacity,l=this._idToCell,u=this._maxLevel;r=o.pop();){var d=r.minX,c=r.minY,h=r.maxX,p=r.maxY;Go(t[0],t[1],t[2],t[3],d,c,h,p)&&(r.leaf?r.objects.length<s||r.final?(r.objects.push(e),l[e]?l[e].push(r):l[e]=[r],a=!0,(r.level>=u||Math.abs(h-d)<=Math.abs(t[2]-t[0])||Math.abs(p-c)<=Math.abs(t[3]-t[1]))&&(r.final=!0)):(this.splitNode(r),o.push(r)):o.push.apply(o,r.children))}if(a)return e;if(!Fc(t[0],t[1],t[2],t[3],(n=this._root).minX,n.minY,n.maxX,n.maxY)){for(var g=this._rootLevel,m=(t[0]+t[2])/2,b=(t[1]+t[3])/2;!Fc(t[0],t[1],t[2],t[3],this._root.minX,this._root.minY,this._root.maxX,this._root.maxY);){var v=d=(n=this._root).minX,y=c=n.minY,S=h=n.maxX,A=p=n.maxY,C=Math.abs(h-d),O=Math.abs(p-c);if(0===O&&0===C)break;var N=Math.max(C,O);m<=d&&(v-=N),b<=c&&(y-=N),d<m&&(S+=N),c<b&&(A+=N);var P=os(v,y,S,A,null,--g);this.splitNode(P),P.children[I_(d,c,h,p,v,y,S,A)]=n,this._root=n.parent=P}for(o=[this._root],this._root.level=this._rootLevel;r=o.shift();)if(!r.leaf)for(var F=0;F<4;F++){var L=r.children[F];L.level=r.level+1,o.push(L)}}return(r=(n=this._root).children[I_(t[0],t[1],t[2],t[3],n.minX,n.minY,n.maxX,n.maxY)]).leaf&&(r.objects.push(e),l[e]?l[e].push(r):l[e]=[r]),e}},ai.prototype.removeById=function(e){if(!this._objects[e])return e;this._size--;for(var t=this._idToCell[e],n=0;n<t.length;n++)for(var i=t[n].objects,r=0,o=i.length;r<o;r++)if(i[r]===e){i.splice(r,1);break}return delete this._objects[e],delete this._idToCell[e],e},ai.prototype.remove=function(e){for(var t,n,i,r=this._getBBox(e),o=r[0],a=r[1],s=r[2],l=r[3],u=[this._root];t=u.pop();)if(Go(o,a,s,l,t.minX,t.minY,t.maxX,t.maxY))if(t.leaf){for(var d=t.objects,c=0,h=d.length;c<h;c++)if(d[c]===e){d.splice(c,1),1===h&&(i=i||[]).push(t);break}}else u.push.apply(u,t.children);if(delete this._idToCell[e],delete this._objects[e],this._size--,i)for(;n=i.pop();)for(var p=n.parent,g=!0;p&&g;){if(!p.leaf){for(c=0;c<4;c++)if(!(t=p.children[c]).leaf||0!==t.objects.length){g=!1;break}g&&(p.leaf=!0,p.children=null,p.objects=[])}p=p.parent}return e},ai.prototype.splitNode=function(e){var t=e.minX,n=e.minY,i=e.maxX,r=e.maxY,o=(t+i)/2,a=(n+r)/2,s=e.level+1,l=this._idToCell,u=this._maxLevel,d=[os(t,n,o,a,e,s),os(t,a,o,r,e,s),os(o,a,i,r,e,s),os(o,n,i,a,e,s)];if(null!==e.objects)for(var c=e.objects,h=this._getBBox,p=0,g=c.length;p<g;p++){for(var m=c[p],b=h(m),v=l[m],y=0;y<4;y++){var S=d[y],A=S.minX,C=S.minY,O=S.maxX,N=S.maxY;Go(b[0],b[1],b[2],b[3],A,C,O,N)&&(S.objects.push(m),(S.level>=u||Math.abs(O-A)<=Math.abs(b[2]-b[0])||Math.abs(N-C)<=Math.abs(b[3]-b[1]))&&(S.final=!0),v?v.push(S):v=[S])}v.splice(v.indexOf(e),1)}e.children=d,e.objects=null,e.leaf=!1},ai.prototype.point=function(e,t,n){for(var i,r,o,a=[],s=[this._root],l=this._getBBox;i=s.pop();)if(e>=i.minX&&e<=i.maxX&&t>=i.minY&&t<=i.maxY){if(i.leaf){n&&(a=i.objects);for(var u=i.objects,d=0,c=u.length;d<c;d++)e>=(r=l(o=u[d]))[0]&&e<=r[2]&&t>=r[1]&&t<=r[3]&&a.push(o);break}s.push.apply(s,i.children)}return a},ai.prototype.neigbours=function(e,t){for(var n,i=[],r=[this._root];n=r.pop();)if(e>=n.minX&&e<=n.maxX&&t>=n.minY&&t<=n.maxY){if(n.leaf){i=n.objects;break}r.push.apply(r,n.children)}return i},ai.prototype.query=function(e,t,n,i){for(var r,o,a,s=[],l=[this._root],u=this._getBBox,d={};r=l.pop();)if(Go(e,t,n,i,r.minX,r.minY,r.maxX,r.maxY))if(r.leaf)for(var c=r.objects,h=0,p=c.length;h<p;h++)d[a=c[h]]||(Go(e,t,n,i,(o=u(a))[0],o[1],o[2],o[3])&&s.push(a),d[a]=!0);else l.push.apply(l,r.children);return s},ai.prototype.getOverlaps=function(){for(var e,t,n,i=[this._root],r=[],o=this._getBBox,a={};e=i.pop();)if(e.leaf){for(var s=e.objects,l=s.length,u=0;u<l;u++)for(var d=0;d<l;d++)if(t=s[u],n=s[d],u!==d&&!a[t+":"+n]&&!a[n+":"+t]){a[t+":"+n]=!0;var c=o(t),h=o(n);Go(c[0],c[1],c[2],c[3],h[0],h[1],h[2],h[3])&&r.push(t,n)}}else i.push.apply(i,e.children);return r},ai.prototype.getAll=function(){return Object.keys(this._objects).map(function(e){return Number(e)})},ai.prototype.forEach=function(e,t){for(var n,i=[this._root];n=i.pop();)if(n.leaf)for(var r=0,o=n.objects.length;r<o;r++)e.call(t,n.objects[r]);else i.push.apply(i,n.children);return this},ai.prototype.getLeafs=function(){for(var e,t=[this._root],n=[];e=t.pop();)e.leaf?n.push(e):t.push.apply(t,e.children);return n},ai.prototype.traverse=function(e,t){for(var n,i=[this._root];n=i.pop();)e.call(t,n,n.objects)||n.leaf||i.push.apply(i,n.children);return this},ai.prototype.update=function(e){return this.remove(e),this.insert(e,this._getBBox(e)),this},ai.prototype.getNodeBounds=function(e){return M_(e)},ai.flatAccessor=function(e,t){return function(n){var i=t*n;return e.slice(i,i+t)}},ai.inside=Fc,ai.intersects=T_,ai.overlaps=Go,ai.getNodeBBox=M_,ai);function ai(e,t,n,i){void 0===e&&(e=u1),void 0===t&&(t=10),void 0===i&&(i=0),this._nodeCapacity=10,this._root=null,this._objects={},this._size=0,this._rootLevel=0,this._maxLevel=30,this._idToCell={},this._nodeCapacity=t,this._root=null,this._getBBox=e,this._rootLevel=i,this._maxLevel=i+30,this._idToCell={},n&&(this._root=os(n[0],n[1],n[2],n[3],null,i))}var l1={left:-1,right:1,top:0,bottom:0,center:0},d1={left:0,right:0,top:-1,bottom:1,center:0},c1={left:-1,right:0,top:-.5,bottom:-.5,center:-.5},h1={left:-.5,right:-.5,top:-1,bottom:0,center:-.5},ku={x1:0,y1:0,x2:0,y2:0},Pc={x:0,y:0},Bs={x:0,y:0},p1=Math.PI/2;function Dc(e,t,n,i){void 0===i&&(i="#ff0000"),t.strokeStyle=i,t.lineWidth=1,t.beginPath();for(var r=Nn(),o=0,a=e.length;o<a;o++){var s=n.graphToScreenCoordinates(e[o]);0===o?t.moveTo(s.x*r,s.y*r):t.lineTo(s.x*r,s.y*r)}t.closePath(),t.stroke()}var O_,g1=["x","y","radius","width","text.content","text.minVisibleSize","text.size","text.scale","text.scaling","text.padding","text.margin","text.position","text.style"],_1=(bt(vr,O_=E),vr.prototype.getTextsBoundingBox=function(){this._updateLabels();for(var e=this._rects,t=this._textBBoxes,n=new Cr,i=this._graphics.getNodeAttributes(),r=this._graphics.getEdgeAttributes(),o=i.excluded,a=r.excluded,s=0;s<e.length;s++){var l=5*s,d=t[6*s+4];if(!(1===t[6*s+4]?o.get(d):a.get(d))){var c=Wl(e[l],e[1+l],e[2+l],e[3+l],e[4+l]),g=c[2],m=c[3];n.addPoint(c[0],c[1]).addPoint(g,m)}}return n},vr.prototype.setRate=function(e){var t=this;this._updateDebounced=this._sync.debounceIdle(function(n){return t._updateLabels(n)},e)},vr.prototype.forceEnable=function(){this._forceEnabled=!0},vr.prototype.update=function(){this._update()},vr.prototype.forceUpdate=function(){this._updateLabels()},vr.prototype._enable=function(){this._enabled=!0,this._update()},vr.prototype._disable=function(){this._textBBoxes=[],this._rects=[],this._intersects=[],this._enabled=!1},vr.prototype._onCameraMove=function(){this._update()},vr.prototype._updateLabels=function(e){if(void 0===e&&(e=this._camera.getZoom()),this._settings.get("texts.preventOverlap")){var t=this._graphics.getNodeAttributes(),n=this._graphics.getEdgeAttributes();this._intersects=[],this._textBBoxes=[],this._rects=[];var i=this._textQuad.clear(),r=this._camera.getAngle(),o=this._camera.getProjectedScreenBounds(.25),a="bottomUp"===this._settings.get("texts.removalStrategy"),s={angle:r,zoom:e,screen:o,sin:Math.sin(r),cos:Math.cos(r)},l={remove:{nodes:[],edges:[]},redraw:{nodes:[],edges:[]},rects:this._rects,bboxes:this._textBBoxes,intersects:this._intersects},u=this._spatial.queryRaw(o[0],o[1],o[2],o[3]),d=u.nodes,c=u.edges;d.length+c.length!==0&&(function(h,p,g,m,b,v,y){var S,A,C=y.remove.nodes,O=y.remove.edges,N=y.redraw.nodes,P=g.angle,F=g.zoom,L=g.sin,B=g.cos,Y=m.x,X=m.y,ae=m.radius,U=m.innerStroke.width,W=m.outerStroke.width,ce=m.scalingMethod,he=m.text.content,Ee=m.text.position,Te=m.text.size,it=m.text.font,rt=m.text.style,We=m.text.maxLineLength,_t=m.text.scaling,wt=m.text.scale,Ue=m.text.minVisibleSize,Ze=m.text.padding,Ne=m.text.margin,Ge=m.animationDuration,Xe=m.textHidden,$e=m.excluded;pr(h,m.layer);for(var we=[0,0,0,0],Pe=[0,0,0,0,0],je=y.bboxes,Je=y.rects,ut=y.intersects,Gt=0,Xt=h.length;Gt<Xt;Gt++){var an=Ge.get(S=h[Gt]),nn=he.get(S);if(null!==nn&&""!==nn&&0===an){var ln=ae.get(S),H=Ue.get(S);if(1!==$e.get(S))if(2*ln*F<H)0===Xe.get(S)&&C.push(S);else{"fixed"===ce.get(S)&&(ln/=F);var Z=Y.get(S),z=X.get(S);"number"==typeof nn&&(nn=nn.toString());var Q=!_t.get(S),de=Ee.get(S),ge=Ze.get(S),xe=wt.get(S),ve=1*(Q?Te.get(S):xe*ln),Ce=rt.get(S),Le=it.get(S),Re=Rp(nn,We.get(S)).lines,Fe=ge+U.get(S)+W.get(S)+Ne.get(S),De=l1[de],Me=d1[de],Oe=b(nn,Le,Ce,ve).width/Re,Se=Re*ve*1,Qe=Oe/2/F,at=Se/2/F,Be=Fe/F,Ve=c1[de]*Oe,ze=h1[de]*Se;Q&&(Ve/=F,ze/=F),Ve=Ve+De*Be+Qe+De*ln,ze=ze+Me*Be+at+Me*ln,Wl(Z-Qe,z-at,Oe/F,Se/F,-P,L,-B,we),Pe[0]=Z-Qe,Pe[1]=z-at,Pe[2]=Oe/F,Pe[3]=Se/F,Pe[4]=P;var Ke=B*Ve-L*ze,Ye=L*Ve+B*ze;we[0]+=Ke,we[1]+=Ye,we[2]+=Ke,we[3]+=Ye,Pe[0]+=Ke,Pe[1]+=Ye;var nt=p.query(we[0],we[1],we[2],we[3]);if(0!==nt.length){for(var yt=!1,xt=zs(Pe[0],Pe[1],Pe[2],Pe[3],Pe[4]),Tt=0;Tt<nt.length;Tt++){var mt=nt[Tt],At=5*mt,tt=zs(Je[At],Je[1+At],Je[2+At],Je[3+At],Je[4+At]);if(fc(xt,tt)){if(ut.push(xt,tt),yt=!0,!v)break;p.remove(mt),1===je[6*mt+4]?C.push(je[6*mt+5]):O.push(je[6*mt+5])}}if(yt&&!v){C.push(S);continue}}N.push(S),A=je.length/6,je.push(we[0],we[1],we[2],we[3],1,S),p.insert(A,we),Je.push(Pe[0],Pe[1],Pe[2],Pe[3],Pe[4])}else C.push(S)}}}(d,i,s,t,this._measureText,a,l),function(h,p,g,m,b,v,y,S){var A,C,O=S.remove.nodes,N=S.remove.edges,P=S.redraw.edges,F=g.angle,L=g.zoom,B=b.x,Y=b.y,X=b.radius,ae=Math.PI,ie=m.source,U=m.target,W=m.scalingMethod,ce=m.width,he=m.curvature,Te=m.text.content,it=m.text.scaling,rt=m.text.size,We=m.text.font,_t=m.text.style,wt=m.text.scale,Ue=m.text.maxLineLength,Ze=m.text.margin,Ne=m.text.minVisibleSize,Ge=m.animationDuration;pr(h,m.layer);for(var Xe=[0,0,0,0],$e=[0,0,0,0,0],we=S.bboxes,Pe=S.rects,je=S.intersects,Je=0,ut=h.length;Je<ut;Je++){var Gt=Ge.get(A=h[Je]),Xt=Te.get(A);if(null!==Xt&&""!==Xt&&!Gt){var an=ie.get(A),nn=U.get(A),ln=ce.get(A),H=he.get(A);if(!(ln*L<Ne.get(A))){"fixed"===W.get(A)&&(ln/=L);var Z=(B.get(an)+B.get(nn))/2,z=(Y.get(an)+Y.get(nn))/2;Xt=Xt.toString();var Q=!it.get(A),de=wt.get(A),ge=We.get(A),xe=1*(Q?rt.get(A):de*ln),ve=_t.get(A),Ce=Ue.get(A),Le=Ze.get(A),Re=B.get(an),Fe=Y.get(an),De=B.get(nn),Me=Y.get(nn),Oe=void 0,Se=an===nn;if(Se)Oe=ae/4-F,Ya(Re,Fe,H,X.get(an),0,ku),vu(.5,Re,Fe,De,Me,ku.x1,ku.y1,ku.x2,ku.y2,Bs),Z=Bs.x,z=Bs.y,Le/=-L;else{if(Re===De&&Fe===Me)continue;Oe=Ms(Re,Fe,De,Me)-F,0!==H&&(Oe=Ms(Re,Fe,De,Me)-F,fa(Re,Fe,De,Me,H,Pc),Qd(.5,Re,Fe,De,Me,Pc.x,Pc.y,Bs),Z=Bs.x,z=Bs.y)}var Qe=Le+4,at=Rp(Xt,Ce).lines,Be=at*xe,Ve=1*v(Xt,ge,ve,xe).width/at/L/2,ze=Be/L/2,Ke=Math.abs(Oe)<p1?1:-1,Ye=Se?Be/L+ln/2:Ke*(Qe/L+ln/2+ze);$e[0]=Z-Ve,$e[1]=z-ze,$e[2]=Z+Ve,$e[3]=z+ze,$e[4]=Oe+F,Lc($e,-(Oe+F),-Ye,$e),$e[2]=$e[2]-$e[0],$e[3]=$e[3]-$e[1],Wl(Z-Ve,z-ze,2*Ve,2*ze,Oe=ae-Oe-F,void 0,void 0,Xe),Lc(Xe,Oe,Ye,Xe);var nt=p.query(Xe[0],Xe[1],Xe[2],Xe[3]);if(nt.length){for(var yt=!1,xt=zs($e[0],$e[1],$e[2],$e[3],$e[4]),Tt=0;Tt<nt.length;Tt++){var mt=nt[Tt],At=5*mt,tt=zs(Pe[At],Pe[1+At],Pe[2+At],Pe[3+At],Pe[4+At]);if(fc(xt,tt)){if(yt=!0,je.push(xt,tt),!y)break;p.remove(mt),1===we[6*mt+4]?O.push(we[6*mt+5]):N.push(we[6*mt+5])}}if(yt&&!y){N.push(A);continue}}P.push(A),C=we.length/6,we.push(Xe[0],Xe[1],Xe[2],Xe[3],0,A),p.insert(C,Xe),Pe.push($e[0],$e[1],$e[2],$e[3],$e[4])}}}}(c,i,s,n,t,this._measureText,a,l),this._clearOverlaps(l),this._settings.get("texts.debug")&&this.drawAll())}},vr.prototype._clearOverlaps=function(e){var t=this._graph.nodeList,n=this._graph.edgeList,i=t(new Uint32Array(e.remove.nodes)),r=n(new Uint32Array(e.remove.edges)),o=t(new Uint32Array(e.redraw.nodes)),a=n(new Uint32Array(e.redraw.edges));this._graphics.setTextHidden(i,!0),this._graphics.setTextHidden(r,!0),this._graphics.setTextHidden(o,!1),this._graphics.setTextHidden(a,!1),this._events.fire("labelCollisionsRemoved",e)},vr.prototype._reset=function(){this._graphics.resetTextHidden()},vr.prototype.drawAll=function(){!function(e,t,n,i,r,o){e.clearRect(0,0,t.width,t.height);for(var a=0,s=i.length;a<s;a+=6)l=i.slice(a,a+4),u=e,d=n,void 0===(c="#aaaaaa")&&(c="#22ff00"),Dc([[l[0],l[1]],[l[2],l[1]],[l[2],l[3]],[l[0],l[3]]].map(function(h){return{x:h[0],y:h[1]}}),u,d,c);var l,u,d,c;for(a=0;a<r.length;a+=5)Dc(zs(r[a],r[a+1],r[a+2],r[a+3],r[a+4]),e,n,"green");o.forEach(function(h){return Dc(h,e,n,"red")})}(this._ctx,this._canvas,this._camera,this._textBBoxes,this._rects,this._intersects)},vr);function vr(e,t){var n,i=e.graph,r=e.graphics,o=e.camera,a=e.events,s=e.settings,l=e.sync,u=e.spatial,d=O_.call(this)||this;return d._textBBoxes=[],d._rects=[],d._enabled=!1,d._intersects=[],d._onZoomStart=Da(function(c){var p=c.endZoom;d._enabled&&p<c.startZoom&&d._updateLabels(p)},80),d._onAttributesChanged=function(c){c.edgeAttributes.concat(c.nodeAttributes).some(function(h){return g1.includes(h)})&&d._update()},d._onItemsAdded=function(c){var h=c.nodes||c.edges;(d._enabled||d._forceEnabled)&&d._settings.get("texts.preventOverlap")&&d._graphics.setTextHidden(h,!0)},d._onToggle=function(c){return c?d._update():d._reset(),d},d._update=function(){(d._enabled||d._forceEnabled)&&d._updateDebounced()},d._toggleDebug=function(c){c?(d._canvas=di(),d._graphics.addCanvas(d._canvas),d._ctx=d._canvas.getContext("2d"),d._update()):d._canvas&&(d._graphics.removeCanvas(d._canvas),d._canvas=d._ctx=null)},d._measureText=function(c,h,p,g){return d._engine.measureText(c,h,p,g)},d._graph=i,d._graphics=r,d._camera=o,d._events=a,d._settings=s,d._sync=l,d._spatial=u,d._engine=r.getGraphicsEngine(),d._textQuad=new k_(function(c){var h=6*c;return d._textBBoxes.slice(h,6+h)},5),t.forceEnableTextOverlapRemoval&&d.forceEnable(),d._events.register(["labelCollisionsRemoved"]),d.setRate(200),s.register("texts.preventOverlap",!0,d._onToggle),s.register("texts.debug",!1,d._toggleDebug),s.register("texts.removalStrategy","topDown"),d._events.on(((n={})[x.ADD_NODES+" "+x.ADD_EDGES]=d._onItemsAdded,n[x.LAYOUT_END]=function(){return d._updateLabels()},n[x.VIEW_CHANGED]=d._update,n[x.UPDATE_ATTRIBUTES]=d._onAttributesChanged,n[x.SET_CONTAINER]=function(c){if(c.element)return d._enable();d._disable()},n[x.START_ZOOM]=d._onZoomStart,n)),d}function Yl(){}function N_(){return!1}var as,L_,m1=(Fi.prototype._startInteraction=function(e,t){e.onStart(t),e.onStop&&(this._current=e).disableDetection&&this._captor.setDetectionEnabled(!1)},Fi.prototype._stopCurrentInteraction=function(e){this._current.disableDetection&&this._captor.setDetectionEnabled(!0),this._current.onStop(e),this._current=null},Fi.prototype._forceStartInteraction=function(e,t){this._current&&this._stopCurrentInteraction(t),this._startInteraction(e,t)},Fi.prototype._createWrapper=function(e){var t=this;return{start:function(n){return t._forceStartInteraction(e,n)}}},Fi.prototype._addInteraction=function(e,t){var n=this._interactionsByStartEvent[e];return n?n.push(t):(this._interactionsByStartEvent[e]=[t],this._events.on(e,this._onStartInteractionEvent)),this._createWrapper(t)},Fi.prototype._createProgressiveInteraction=function(e,t,n,i){var r={priority:F_(i.priority),check:i.check||N_,onStart:i.onStart||Yl,onProgress:i.onProgress||Yl,onStop:i.onStop||Yl,disableDetection:!!i.disableDetection,progressEventName:t,stopEventName:n};return this._boundProgressEvents[t]||(this._boundProgressEvents[t]=!0,this._events.on(t,this._onProgressInteractionEvent)),this._boundStopEvents[n]||(this._boundStopEvents[n]=!0,this._events.on(n,this._onStopInteractionEvent)),this._addInteraction(e,r)},Fi.prototype._createNonProgressiveInteraction=function(e,t){return this._addInteraction(e,{priority:F_(t.priority),check:t.check||N_,onStart:t.handler||Yl,onProgress:null,onStop:null,disableDetection:!1,progressEventName:null,stopEventName:null})},Fi.prototype.onDrag=function(e){return this._createProgressiveInteraction(x.DRAG_START,x.DRAG_PROGRESS,x.DRAG_END,e)},Fi.prototype.onGesture=function(e){return this._createProgressiveInteraction(x.GESTURE_START,x.GESTURE_PROGRESS,x.GESTURE_END,e)},Fi.prototype.onClick=function(e){return this._createNonProgressiveInteraction(x.CLICK,e)},Fi.prototype.onDoubleClick=function(e){return this._createNonProgressiveInteraction(x.DOUBLE_CLICK,e)},Fi.prototype.onHover=function(e){return this._createNonProgressiveInteraction(x.HOVER,e)},Fi.prototype.onUnhover=function(e){return this._createNonProgressiveInteraction(x.UNHOVER,e)},Fi.prototype.onMouseWheel=function(e){return this._createNonProgressiveInteraction(x.WHEEL,e)},Fi.prototype.onMouseDown=function(e){return this._createNonProgressiveInteraction(x.DOWN,e)},Fi.prototype.onMouseUp=function(e){return this._createNonProgressiveInteraction(x.UP,e)},Fi.prototype.onMouseMove=function(e){return this._createNonProgressiveInteraction(x.MOVE,e)},Fi);function Fi(e){var t=e.captor,n=e.events,i=this;this._current=null,this._onStartInteractionEvent=function(r,o){if(!i._current){for(var a=null,s=0,l=i._interactionsByStartEvent[o];s<l.length;s++){var u=l[s];u.check(r)&&(!a||u.priority>=a.priority)&&(a=u)}a&&i._startInteraction(a,r)}},this._onProgressInteractionEvent=function(r,o){i._current&&i._current.progressEventName===o&&i._current.onProgress(r)},this._onStopInteractionEvent=function(r,o){i._current&&i._current.stopEventName===o&&i._stopCurrentInteraction(null)},this._captor=t,this._events=n,this._interactionsByStartEvent={},this._boundProgressEvents={},this._boundStopEvents={}}function F_(e){return"string"==typeof e?cx.indexOf(e):"number"!=typeof e||isNaN(e)?0:e}(L_=as=as||{}).MOUSE="mouse",L_.TOUCH="touch";var P_,v1=[x.VIRTUAL_UP,x.MOUSE_UP,x.TOUCH_UP].join(" "),y1=[x.VIRTUAL_DOWN,x.MOUSE_DOWN,x.TOUCH_DOWN].join(" "),x1=[x.VIRTUAL_MOVE,x.MOUSE_MOVE,x.TOUCH_MOVE].join(" "),b1=[x.VIRTUAL_CLICK,x.MOUSE_CLICK,x.TOUCH_TAP].join(" "),E1=[x.VIRTUAL_DOUBLE_CLICK,x.MOUSE_DOUBLE_CLICK,x.TOUCH_DOUBLE_TAP].join(" "),S1=[x.VIRTUAL_WHEEL,x.MOUSE_WHEEL].join(" "),A1=(bt(kn,P_=E),kn.prototype.triggerUnhover=function(){this._hover=!1,this._hoveredElt=null},kn.prototype.triggerDetection=function(){this._detectElement(this._position.x,this._position.y),this._elt&&(this._hoveredElt=this._elt,this._hover=!0)},kn.prototype.getElementAt=function(e,t){return this._detectElementAt(e.x,e.y,t)},kn.prototype.getPointedElement=function(){return this._hoveredElt},kn.prototype.getDraggedElement=function(){return this._draggedElt},kn.prototype.isAnyButtonPressed=function(){return this._buttons[Yt.LEFT].isPressed||this._buttons[Yt.RIGHT].isPressed||this._buttons[Yt.MIDDLE].isPressed},kn.prototype.isAnyButtonDragging=function(){return this._buttons[Yt.LEFT].isDragging||this._buttons[Yt.RIGHT].isDragging||this._buttons[Yt.MIDDLE].isDragging},kn.prototype.isButtonPressed=function(e){return this._buttons[e].isPressed},kn.prototype.isLeftPressed=function(){return this.isButtonPressed(Yt.LEFT)},kn.prototype.getCursorPosition=function(){return{x:this._position.x,y:this._position.y}},kn.prototype.getCursorInformation=function(){return{x:this._position.x,y:this._position.y,target:this._hoveredElt}},kn.prototype.setDetectionEnabled=function(e){this._disabledCounter=Math.max(0,this._disabledCounter+(e?-1:1))},kn.prototype._resetCurrent=function(e,t){for(var n in this._buttons){var i=this._buttons[n];i.isDragging&&this._events.fire(x.DRAG_END,{domEvent:null,x:e,y:t,button:n,target:this._draggedElt}),i.isPressed=!1,i.isDragging=!1}this._hover&&this._hoveredElt&&this._events.fire(x.UNHOVER,{domEvent:null,x:e,y:t,target:this._hoveredElt}),this._hover=!1,this._hoveredElt=null,this._draggedElt=null},kn.prototype._onMove=function(e){var t=e.domEvent,n=e.x,i=e.y,r=e.source,o=this._setPointerPosition(n,i),a=o.dx,s=o.dy;for(var l in this._events.fire(x.MOVE,{domEvent:t,x:n,y:i,dx:a,dy:s,source:r}),this._buttons){var u=this._buttons[l];if(u.isPressed)if(u.isDragging){var d=this._getStoredDXY();this._events.fire(x.DRAG_PROGRESS,{domEvent:t,x:n,y:i,dx:a+=d.dx,dy:s+=d.dy,button:l,source:r,target:this._draggedElt})}else u.isDragging=!0,this._hoveredElt&&this._hover&&(this._events.fire(x.UNHOVER,{domEvent:t,x:n,y:i,source:r,target:this._hoveredElt}),this._hover=!1),this._draggedElt||(this._draggedElt=this._hoveredElt),this._storeDXY(a,s),this._events.fire(x.DRAG_START,{domEvent:t,x:n,y:i,button:l,source:r,target:this._draggedElt})}t&&!this._graphics.getDomElement().contains(t.target)||this._detectElement(n,i),this._elt!==this._hoveredElt&&(this._hoveredElt&&this._hover&&(this._hover=!0,this._events.fire(x.UNHOVER,{domEvent:t,x:n,y:i,source:r,target:this._hoveredElt})),this._hoveredElt=this._elt,this._elt&&(this._hover=!0,this._events.fire(x.HOVER,{domEvent:t,x:n,y:i,source:r,target:this._hoveredElt})))},kn.prototype._onDocumentMove=function(e){var t=e.domEvent,n=e.x,i=e.y,r=e.source;for(var o in this._buttons)if(this._buttons[o].isDragging){var a=this._setPointerPosition(n,i);this._events.fire(x.DRAG_PROGRESS,{domEvent:t,x:n,y:i,dx:a.dx,dy:a.dy,button:o,source:r,target:this._draggedElt})}},kn.prototype._onDocumentUp=function(e){var o=e.button;if(this._buttons[o].isDragging){this._events.fire(x.DRAG_END,{domEvent:e.domEvent,x:e.x,y:e.y,button:o,source:e.source,target:this._draggedElt});var a=this._buttons[o];a.isDragging=!1,a.isPressed=!1,this.isAnyButtonDragging()||(this._draggedElt=null)}},kn.prototype._onDown=function(e){var t=e.domEvent,n=e.x,i=e.y,r=e.button,o=e.source;this._detectElement(n,i),this._elt!==this._hoveredElt&&this._resetCurrent(n,i);var a=this._buttons[r];this._hoveredElt=this._elt,a.isPressed=!0,this._events.fire(x.DOWN,{domEvent:t,x:n,y:i,button:r,source:o,target:this._hoveredElt})},kn.prototype._onDoubleClick=function(e){var t=e.domEvent,n=e.x,i=e.y,r=e.button,o=e.source;R_(t,"doubleclick")||this._events.fire(x.DOUBLE_CLICK,{domEvent:t,x:n,y:i,button:r,source:o,target:this._hoveredElt})},kn.prototype._onUp=function(e){var t=e.domEvent,n=e.x,i=e.y,r=e.button,o=e.source,a=this._buttons[r];a.isPressed&&(a.isDragging&&(this._events.fire(x.DRAG_END,{domEvent:t,x:n,y:i,button:r,source:o,target:this._draggedElt}),a.isDragging=!1,this.isAnyButtonDragging()||(this._draggedElt=null)),a.isPressed=!1,this._detectElement(n,i),this._events.fire(x.UP,{domEvent:t,x:n,y:i,button:r,source:o,target:this._elt}),this.isAnyButtonPressed()||this._hover||o===as.TOUCH||(this._hoveredElt=this._elt,this._hoveredElt&&(this._events.fire(x.HOVER,{domEvent:t,x:n,y:i,source:o,target:this._hoveredElt}),this._hover=!0)))},kn.prototype._onClick=function(e){var t=e.domEvent,n=e.x,i=e.y,r=e.button,o=e.source;R_(t,"click")||this._events.fire(x.CLICK,{domEvent:t,x:n,y:i,button:r,source:o,target:this._hoveredElt})},kn.prototype._onWheel=function(e){var t=e.domEvent,n=e.x,i=e.y,r=e.delta,o=e.source;this._position.x=n,this._position.y=i,this._events.fire(x.WHEEL,{domEvent:t,x:n,y:i,delta:r,source:o,target:this._hoveredElt})},kn.prototype._storeDXY=function(e,t){this._accDx=e,this._accDy=t},kn.prototype._getStoredDXY=function(){var e=this._accDx,t=this._accDy;return this._accDx=0,this._accDy=0,{dx:e,dy:t}},kn.prototype._setPointerPosition=function(e,t){var n=e-this._prevX,i=t-this._prevY;return this._position.x=e,this._position.y=t,this._prevX=e,this._prevY=t,this._accDx=0,this._accDy=0,{dx:n,dy:i}},kn.prototype._detectElement=function(e,t,n){this._elt=this._detectElementAt(e,t,n)},kn.prototype._detectElementAt=function(e,t,n){if(0!==this._disabledCounter)return null;var i,r,o=this._settings,a=o.get("detect.enableSpatialIndex"),s=o.get("detect.nodeErrorMargin"),l=o.get("detect.edgeErrorMargin"),u=o.get("detect.nodes"),d=o.get("detect.edges"),c=null;if(!n&&a&&(u||d)){var h=o.get("detect.spatialIndexMarginRatio"),p=Math.max(s*h,l*h),g=this._spatial.queryRawProjected(e-p,t-p,e+p,t+p);i=g.nodes,r=g.edges}return u&&(c=this._graphics.detectNode({x:e,y:t,indexes:i,margin:s,texts:o.get("detect.nodeTexts")})),!c&&d&&(c=this._graphics.detectEdge({x:e,y:t,indexes:r,margin:l,texts:o.get("detect.edgeTexts")})),c},kn);function kn(e){var t,n,i=e.dom,r=e.events,o=e.graphics,a=e.spatial,s=e.settings,l=e.position,u=P_.call(this)||this;return u._elt=null,u._hoveredElt=null,u._draggedElt=null,u._hover=!1,u._disabledCounter=0,u._accDx=0,u._accDy=0,u._timeout=null,u._prevX=0,u._prevY=0,u._buttons=((t={})[Yt.LEFT]={isPressed:!1,isDragging:!1},t[Yt.MIDDLE]={isPressed:!1,isDragging:!1},t[Yt.RIGHT]={isPressed:!1,isDragging:!1},t),u._onGraphChanged=function(){u._resetCurrent(u._position.x,u._position.y),u._timeout||(u._timeout=u._dom.setTimeout(function(){u._onMove({x:u._position.x,y:u._position.y,source:null,domEvent:null}),u._timeout=null},0))},u._dom=i,u._graphics=o,u._events=r,u._settings=s,u._spatial=a,u._position=l,r.register([x.MOVE,x.DOWN,x.UP,x.CLICK,x.DOUBLE_CLICK,x.HOVER,x.UNHOVER,x.WHEEL,x.DRAG_START,x.DRAG_PROGRESS,x.DRAG_END,x.GESTURE_START,x.GESTURE_PROGRESS,x.GESTURE_END]),s.register("detect.nodes",!0).register("detect.edges",!0).register("detect.nodeTexts",!0).register("detect.edgeTexts",!0).register("detect.nodeErrorMargin",5).register("detect.edgeErrorMargin",7).register("detect.enableSpatialIndex",!0).register("detect.spatialIndexMarginRatio",3),r.on(((n={})[[x.REMOVE_NODES,x.REMOVE_EDGES,x.CLEAR_GRAPH].join(" ")]=u._onGraphChanged,n[x1]=function(d,c){u._onMove({domEvent:d.domEvent,x:d.x,y:d.y,source:ss(c)})},n[y1]=function(d,c){var m=d.button;u._onDown({domEvent:d.domEvent,x:d.x,y:d.y,button:void 0===m?Yt.LEFT:m,source:ss(c)})},n[v1]=function(d,c){var m=d.button;u._onUp({domEvent:d.domEvent,x:d.x,y:d.y,button:void 0===m?Yt.LEFT:m,source:ss(c)})},n[b1]=function(d,c){var m=d.button;u._onClick({domEvent:d.domEvent,x:d.x,y:d.y,button:void 0===m?Yt.LEFT:m,source:ss(c)})},n[E1]=function(d,c){var m=d.button;u._onDoubleClick({domEvent:d.domEvent,x:d.x,y:d.y,button:void 0===m?Yt.LEFT:m,source:ss(c)})},n[S1]=function(d){u._onWheel({domEvent:d.domEvent,x:d.x,y:d.y,delta:d.delta,source:as.MOUSE})},n.touchStartGesture=function(d){return r.fire(x.GESTURE_START,d)},n.touchProgressGesture=function(d){return r.fire(x.GESTURE_PROGRESS,d)},n.touchEndGesture=function(d){return r.fire(x.GESTURE_END,d)},n.documentMouseMove=function(d,c){u._onDocumentMove({domEvent:d.domEvent,x:d.x,y:d.y,source:ss(c)})},n.documentMouseUp=function(d,c){var m=d.button,b=void 0===m?Yt.LEFT:m;u._onDocumentUp({domEvent:d.domEvent,x:d.x,y:d.y,source:ss(c),button:b})},n)),u}function ss(e){return 0===e.indexOf(as.TOUCH)?as.TOUCH:as.MOUSE}var Rc=!1,D_={down:{trigger:"pointerdown",duplicate:"mousedown"},click:{trigger:"pointerdown",duplicate:"mouseup"},doubleclick:{trigger:"pointerdown",duplicate:"mouseup"}};function R_(e,t){if(e)return e.type===D_[t].trigger&&(Rc=!0),e.type===D_[t].duplicate&&Rc?!(Rc=!1):void 0}var z_,So,Xl,w1=(bt(B_,z_=E),B_);function B_(e){var t=e.graphics,n=e.camera,i=e.selection,r=e.events,o=e.captor,a=e.individualAttributes,s=e.interactions,l=e.classes,u=e.settings,d=z_.call(this)||this;return d._dragged=null,d._start=null,d._end=null,d._startDrag=null,d._shouldDrag=function(c){var h=c.target,p=c.button===Yt.LEFT,g=d._settings.get("interactions.drag.enabled"),m=null!==h&&h.isNode&&!0===h.getAttribute("draggable");return p&&g&&m},d._onDragStart=function(c){var h=c.x,p=c.y,g=c.target;d._dragged=g.isSelected()?d._selection.getSelectedNodes().filter(function(m){return m.getAttribute("draggable")}):g.toList(),d._start=d._dragged.getPosition(),d._end=rn(d._start),d._onBeforeDrag=d._settings.get("interactions.drag.onBeforeDrag"),d._startDrag=d._camera.screenToGraphCoordinates({x:h,y:p}),d._dragged.addClass(xl),d._events.fire(x.NODES_DRAG_START,{nodes:d._dragged}),d._graphics.addCursorStyle(d._settings.get("interactions.drag.cursor"))},d._onDrag=function(){for(var c=d._captor.getCursorInformation(),h=c.x,p=c.y,g=d._dragged._indexes,m=d._camera.screenToGraphCoordinates({x:h,y:p}),b=m.x-d._startDrag.x,v=m.y-d._startDrag.y,y=0;y<g.length;++y){var S=d._start[y],A=d._end[y];A.x=S.x+b,A.y=S.y+v}d._onBeforeDrag&&d._onBeforeDrag(d._dragged,h,p,d._end),d._settings.get("interactions.drag.applyResult")&&d._attributes.setMultipleAttributes(d._dragged,d._end,null,["x","y"]),d._events.fire(x.NODES_DRAG_PROGRESS,{nodes:d._dragged,dx:b,dy:v})},d._onDragEnd=function(){d._dragged.removeClass(xl),d._graphics.removeCursorStyle(d._settings.get("interactions.drag.cursor")),d._events.fire(x.NODES_DRAG_END,{nodes:d._dragged,start:d._start,end:d._end}),d._dragged=null,d._start=null,d._end=null},d._camera=n,d._graphics=t,d._selection=i,d._events=r,d._settings=u,d._captor=o,d._attributes=a,d._interactions=s,l.createClass({name:xl,isBuiltin:!0,nodeAttributes:{layer:3}}),r.register([x.NODES_DRAG_START,x.NODES_DRAG_PROGRESS,x.NODES_DRAG_END]),u.register("interactions.drag.enabled",!0),u.register("interactions.drag.cursor","move"),u.register("interactions.drag.onBeforeDrag",null),u.register("interactions.drag.applyResult",!0),d._interactions.onDrag({priority:"drag",disableDetection:!0,check:d._shouldDrag,onStart:d._onDragStart,onProgress:d._onDrag,onStop:d._onDragEnd}),d}function C1(e){return.2*Math.min(e.viewWidth/e.graphWidth,e.viewHeight/e.graphHeight)}function T1(e){var t=e.smallestNodeSize;return t===1/0?1/0:Math.min(e.viewWidth,e.viewHeight)/t*.5}(Xl=So=So||{}).ROTATION="rotation",Xl.PAN="pan",Xl.ZOOM="zoom",Xl.GESTURE="gesture";var V_,M1=(bt(Vs,V_=E),Vs.prototype._setupInteractions=function(){var e=this;this._interactions.onMouseWheel({priority:"zoom",check:function(){return e._settings.get("interactions.zoom.enabled")},handler:Da(function(t){return e._smoothZoom(t.delta,t.x,t.y)},50)}),this._interactions.onDoubleClick({priority:"zoom",check:function(){var t=e._settings.get("interactions.zoom.enabled"),n=e._settings.get("interactions.zoom.onDoubleClick");return t&&n},handler:function(t){return e._smoothZoom(1,t.x,t.y)}}),this._interactions.onDrag({priority:"panning",disableDetection:!0,check:function(t){var n=t.button,i=e._settings.get("interactions.pan.enabled");return"left"===n&&i},onStart:function(){return e._updateVisibility(So.PAN,!0)},onProgress:function(t){return e._camera.move({x:-t.dx,y:-t.dy})},onStop:function(){return e._updateVisibility(So.PAN,!1)}}),this._interactions.onDrag({priority:"rotation",disableDetection:!0,check:function(t){var i=t.domEvent;return("right"===t.button||i&&2===i.buttons)&&e._settings.get("interactions.rotation.enabled")},onStart:function(t){e._rotationStart={x:t.x,y:t.y},e._updateVisibility(So.ROTATION,!0)},onProgress:function(t){return e._rotate({x:t.x,y:t.y})},onStop:function(){return e._updateVisibility(So.ROTATION,!1)}}),this._interactions.onGesture({priority:"gesture",disableDetection:!0,check:function(){return e._settings.get("interactions.gesture.enabled")},onStart:function(){return e._updateVisibility(So.GESTURE,!0)},onProgress:function(t){var n=t.dx,i=t.dy,r=t.rotation,o=t.scale,a=t.x,s=t.y;e._settings.get("interactions.rotation.enabled")&&e._camera.rotate(-r),e._camera.zoomIn(o,void 0,{refX:a,refY:s}),e._camera.move({x:-n,y:-i})},onStop:function(){return e._updateVisibility(So.GESTURE,!0)}})},Vs.prototype._rotate=function(e){var t=e.x,n=e.y,i=this._camera.getSize(),r=i.width/2,o=i.height/2,l=t-r,u=n-o,d=Math.atan2(this._rotationStart.y-o,this._rotationStart.x-r)-Math.atan2(u,l);this._rotationStart.x=t,this._rotationStart.y=n,this._camera.rotate(d)},Vs.prototype._updateVisibility=function(e,t){var n=!t,i=this._settings,r=i.get("interactions."+e+".hideNodes"),o=i.get("interactions."+e+".hideEdges"),a=i.get("interactions."+e+".hideNodeTexts"),s=i.get("interactions."+e+".hideEdgeTexts");r&&this._graphics.setNodesVisibility(n),a&&this._graphics.setNodeTextsVisibility(n),o&&this._graphics.setEdgesVisibility(n),s&&this._graphics.setEdgeTextsVisibility(n)},Vs.prototype._smoothZoom=function(e,t,n){var i=this,r=this._settings,o=r.get("interactions.zoom.modifier"),a=r.get("interactions.zoom.duration"),s=r.get("interactions.zoom.easing"),l=this._camera.getZoom()*(0<e?o:1/o),u={duration:a,easing:s};this._zooming||(this._zooming=!0,this._updateVisibility(So.ZOOM,!0)),this._camera.setZoom(l,u,{refX:t,refY:n}).then(function(){i._zooming&&(i._zooming=!1,i._updateVisibility(So.ZOOM,!1))})},Vs);function Vs(e,t){var n=e.camera,i=e.graphics,r=e.settings,o=e.interactions,a=V_.call(this)||this;return a._zooming=!1,a._camera=n,a._settings=r,a._interactions=o,a._graphics=i,r.register("interactions.zoom.enabled",!0),r.register("interactions.zoom.onDoubleClick",!1),r.register("interactions.zoom.duration",150),r.register("interactions.zoom.modifier",1.8),r.register("interactions.zoom.easing","quadraticOut"),r.register("interactions.zoom.minValue",t?null:C1),r.register("interactions.zoom.maxValue",t?null:T1),r.register("interactions.zoom.hideNodes",!1),r.register("interactions.zoom.hideEdges",!1),r.register("interactions.zoom.hideNodeTexts",!1),r.register("interactions.zoom.hideEdgeTexts",!1),r.register("interactions.pan.enabled",!0),r.register("interactions.pan.hideNodes",!1),r.register("interactions.pan.hideEdges",!1),r.register("interactions.pan.hideNodeTexts",!1),r.register("interactions.pan.hideEdgeTexts",!1),r.register("interactions.rotation.enabled",!0),r.register("interactions.rotation.hideNodes",!1),r.register("interactions.rotation.hideEdges",!1),r.register("interactions.rotation.hideNodeTexts",!1),r.register("interactions.rotation.hideEdgeTexts",!1),r.register("interactions.gesture.enabled",!0),r.register("interactions.gesture.hideNodes",!1),r.register("interactions.gesture.hideEdges",!1),r.register("interactions.gesture.hideNodeTexts",!1),r.register("interactions.gesture.hideEdgeTexts",!1),a._setupInteractions(),a}var U_,I1={color:"#00C3FF",radius:7,cursorOnHover:"grab",cursorOnDrag:"grabbing"},k1=(bt(so,U_=E),so.prototype.onMounted=function(e){e.events.onEdgesSelected(this._refreshHandles),e.events.onEdgesUnselected(this._refreshHandles)},so.prototype.enable=function(e){this._enabled||(this._options=Mt({},I1,e),this._enabled=!0,this._graphics.addCanvas(this._canvas),this._refreshHandles())},so.prototype.disable=function(){this._enabled&&(this._interaction.stop(),this._graphics.removeCursorStyle(this._options.cursorOnDrag),this._disableCursorOnHover(),this._restoreSettings(),this._graphics.removeCanvas(this._canvas),this._rewirableClass.clearEdges(),this._enabled=!1)},so.prototype.enabled=function(){return this._enabled},so.prototype._restoreSettings=function(){this._prevSettings&&(this._settings.update(this._prevSettings),this._prevSettings=null)},so.prototype._disableCursorOnHover=function(){this._hoverHandle&&!this._grabHandle&&(this._hoverHandle=!1,this._graphics.removeCursorStyle(this._options.cursorOnHover))},so.prototype._enableCursorOnHover=function(){this._hoverHandle||(this._hoverHandle=!0,this._graphics.addCursorStyle(this._options.cursorOnHover))},so.prototype._displayMovedEdges=function(){var e=this;if(this._movedEdges){var t=this._x,n=this._y,i=this._ctx,r=Nn(),o={x:t,y:n},a=this._camera.getZoom();this._movedEdges.forEach(function(s,l){var u=e._edgeColors[l],d=s.getSource(),c=s.getTarget(),h=e._getPointedNode(),p=c===e._startNode?d:c,g=s.getAttribute("width")*a,m=p.getPositionOnScreen(),b=h?h.getPositionOnScreen():o;p.addClass(yl),i.beginPath(),i.moveTo(m.x*r,m.y*r),i.lineTo(b.x*r,b.y*r),i.strokeStyle=u,i.lineWidth=g*r,i.stroke()})}},so.prototype._getPointedNode=function(){var e=this._captor.getPointedElement();return e&&e.isNode?e:null},so);function so(e){var t=e.classes,n=e.graphics,i=e.camera,r=e.captor,o=e.selection,a=e.events,s=e.settings,l=e.interactions,u=U_.call(this)||this;return u._canvas=di(),u._ctx=u._canvas.getContext("2d"),u._nodesToHighlight=null,u._movedEdges=null,u._startNode=null,u._hoverHandle=!1,u._grabHandle=!1,u._prevSettings=null,u._x=0,u._y=0,u._enabled=!1,u._onDragStart=function(){u._nodesToHighlight=u._nodesToHighlight.filter(function(c){return c!==u._startNode}),u._movedEdges.setExcluded(!0);var d=u._options.cursorOnDrag;u._prevSettings=u._settings.update({edgeHover:!1,cursor:{default:d,node:d,edge:d}})},u._onDragEnd=function(){u._restoreSettings();var d=u._getPointedNode();d&&u._movedEdges.forEach(function(c){c.getTarget()===u._startNode?c.setTarget(d):c.setSource(d)}),u._movedEdges.setExcluded(!1),u._movedEdges.setSelected(!0),u._movedEdges=null,u._refreshHandles()},u._refreshHandles=function(){if(u._enabled&&!u._movedEdges){var d=u._selection.getSelectedEdges();u._nodesToHighlight=d.getExtremities().dedupe(),u._rewirableClass.clearEdges(),u._rewirableClass.add(d),u._refreshCanvas()}},u._shouldInteractionStart=function(d){var c=d.target;if(!(u._enabled&&c&&c.isNode&&u._hoverHandle))return!1;var h=c.getAdjacentEdges().filter(function(p){return p.isSelected()});return!!h.size&&(u._movedEdges=h,u._edgeColors=u._movedEdges.getAttribute("color"),u._startNode=c,!0)},u._refreshCanvas=function(){if(u._enabled&&u._nodesToHighlight){var d=u._captor.getCursorPosition(),c=u._getPointedNode(),h=u._camera.zoom,p=u._canvas.getContext("2d"),g=Nn(),m=u._options.color,b=u._options.radius,v=2*b*g;p.clearRect(0,0,u._canvas.width,u._canvas.height),u._displayMovedEdges(),p.fillStyle=m,p.strokeStyle=m;var y=!1;if(u._nodesToHighlight.forEach(function(A){var C=A.getPositionOnScreen(),O=C.x,N=C.y,P=A.getAttribute("radius")*("fixed"===A.getAttribute("scalingMethod")?1:h);b<P&&(p.fillRect((O-b)*g,(N-b)*g,v,v),vi(O,N,d.x,d.y)<b&&(y=!0))}),u._movedEdges){var S=c?c.getPositionOnScreen():d;p.fillRect((S.x-b)*g,(S.y-b)*g,v,v)}y?u._enableCursorOnHover():u._disableCursorOnHover()}},u._captor=r,u._camera=i,u._graphics=n,u._selection=o,u._events=a,u._settings=s,u._interactions=l,u._classes=t,u._rewirableClass=u._classes.createClass({name:kf,isBuiltin:!0,edgeAttributes:{layer:4}}),u._events.on({cameraMove:u._refreshCanvas,move:u._refreshCanvas,progressMoveNodesByDragging:u._refreshCanvas,down:function(){u._hoverHandle&&(u._grabHandle=!0)},up:function(){u._grabHandle=!1}}),u._interaction=u._interactions.onDrag({priority:"rewiring",check:u._shouldInteractionStart,onStart:u._onDragStart,onProgress:function(d){var h=d.y;u._x=d.x,u._y=h},onStop:u._onDragEnd}),u}var j_,O1={cursor:"nesw-resize",color:"#00C3FF",lineWidth:1,handleSize:6,detectionMargin:5,snappingRatio:1.25,nbNodesToSnapTo:5,previewColor:"rgba(0, 0, 0, 0.2)",sizeIndicatorColor:"black",sizeIndicatorOffset:5,sizeIndicatorWidth:3,sizeIndicatorThickness:1},N1=(bt(Ki,j_=E),Ki.prototype.onMounted=function(e){e.events.onNodesSelected(this._onSelectionChange),e.events.onNodesUnselected(this._onSelectionChange)},Ki.prototype._enableCursor=function(){this._cursorEnabled||(this._graphics.addCursorStyle(this._options.cursor),this._cursorEnabled=!0)},Ki.prototype._disableCursor=function(){this._cursorEnabled&&(this._graphics.removeCursorStyle(this._options.cursor),this._cursorEnabled=!1)},Ki.prototype._detectBoundingBoxes=function(e,t){var n=this;if(this._enabled&&!this._nodeBeingResized&&this._nodesToHighlight){var i=this._options.handleSize/2,r=this._options.detectionMargin;return this._pointedNode=null,this._forEachNodeToHighlight(function(o,a,s){a.x+s-i-r<=e&&e<=a.x+s+i+r&&a.y-s-i-r<=t&&t<=a.y-s+i+r&&(n._pointedNode=o)}),this._pointedNode?this._enableCursor():this._disableCursor()}},Ki.prototype._forEachNodeToHighlight=function(e){var t=this;this._nodesToHighlight.forEach(function(n){var i=n.getPositionOnScreen(),r=t._getTotalOnScreenRadius(n);e(n,i,r)})},Ki.prototype._displayHandles=function(){var e=this;if(this._enabled&&this._nodesToHighlight){var t=this._canvas,n=this._ctx,i=t.width,r=t.height,o=Nn(),a=this._options,s=a.color,l=a.lineWidth,u=a.handleSize,d=0;if(n.clearRect(0,0,i,r),this._nodeBeingResized){var c=this._getTotalOnScreenRadius(this._nodeBeingResized),h=this._nodeBeingResized.getPositionOnScreen();d=Math.max(this._x-(h.x+c),-(this._y-(h.y-c)))/2}this._additionalRadiuses=[],this._forEachNodeToHighlight(function(p,g,m){var b=0;if(e._nodeBeingResized){b=d;var v=-m+p.getAttribute("innerStroke.width")+p.getAttribute("outerStroke.width")+l/2+1;b=b<v?v:e._snap(p,b),e._additionalRadiuses.push(b);var y=p.getAttribute("shape"),S=e._engine.getShapePoints(y);e._displayNodePreview(n,o,g.x+b,g.y-b,m+b,S)}n.strokeStyle=s,n.fillStyle=s,n.lineWidth=l,n.strokeRect((g.x-m)*o,(g.y-m-2*b)*o,2*(b+m)*o,2*(b+m)*o),n.fillRect((g.x+m+2*b-u/2)*o,(g.y-m-2*b-u/2)*o,u*o,u*o)})}},Ki.prototype._displayNodePreview=function(e,t,n,i,r,o){if(n*=t,i*=t,r*=t,e.beginPath(),1===o.length)e.arc(n,i,r,0,2*Math.PI);else for(var a=0;a<o.length;++a){var s=o[a],l=n+s.x*r,u=i+s.y*r;0===a?e.moveTo(l,u):e.lineTo(l,u)}e.fillStyle=this._options.previewColor,e.fill()},Ki.prototype._getTotalOnScreenRadius=function(e){return e.getAttribute("radius")*this._camera.zoom+e.getAttribute("innerStroke.width")+e.getAttribute("outerStroke.width")+this._options.lineWidth/2},Ki.prototype._snap=function(e,t){var n=this,i=this._spatial.getNodesInScreenByDistance(e).filter(function(p){return!p.isSelected()}).slice(0,this._options.nbNodesToSnapTo),r=this._ctx,o=this._getTotalOnScreenRadius(e),a=o+t,s=this._options.snappingRatio,u=Math.round(Ar(a/o,s)),d=o*Math.pow(s,u),c=null;if(i.forEach(function(p){var g=n._getTotalOnScreenRadius(p);Math.abs(g-a)<=Math.abs(d-a)&&(d=g,c=p)}),c){r.save(),r.strokeStyle=this._options.sizeIndicatorColor,r.lineWidth=this._options.sizeIndicatorThickness;var h=c.getAttribute("radius");this._displaySizeIndicator(e,d),i.filter(function(p){return p.getAttribute("radius")===h}).forEach(function(p){return n._displaySizeIndicator(p)}),r.restore()}return d-o},Ki.prototype._displaySizeIndicator=function(e,t){var n=this._ctx,i=Nn(),r=e.getPositionOnScreen(),o=this._getTotalOnScreenRadius(e),a=t||o,s=t?t-o:0,l=s-this._options.sizeIndicatorOffset-(t?e.getAttribute("innerStroke.width")+e.getAttribute("outerStroke.width"):0),u=r.x-a+l|0,d=r.y-a-s|0,c=r.y+a-s|0,h=this._options.sizeIndicatorWidth;n.beginPath(),n.moveTo((u-h)*i,d*i),n.lineTo((u+h)*i,d*i),n.moveTo(u*i,d*i),n.lineTo(u*i,c*i),n.moveTo((u-h)*i,c*i),n.lineTo((u+h)*i,c*i),n.stroke()},Ki.prototype.enable=function(e){this._enabled||(this._options=Mt({},O1,e),this._graphics.addCanvas(this._canvas),this._ctx=this._canvas.getContext("2d"),this._events.on({"cameraMove progressMoveNodesByDragging":this._displayHandlesHandler,"move down":this._moveHandler}),this._enabled=!0)},Ki.prototype.disable=function(){this._enabled&&(this._events.removeListener(this._displayHandlesHandler),this._events.removeListener(this._moveHandler),this._graphics.removeCanvas(this._canvas),this._disableCursor(),this._reset())},Ki.prototype._reset=function(){this._enabled=!1,this._nodesToHighlight=null,this._options=null,this._nodeBeingResized=null,this._pointedNode=null,this._cursorEnabled=!1,this._x=0,this._y=0,this._additionalRadiuses=[]},Ki.prototype.enabled=function(){return this._enabled},Ki);function Ki(e){var t=e.dom,n=e.interactions,i=e.camera,r=e.events,o=e.graphics,a=e.spatial,s=e.selection,l=j_.call(this)||this;return l._enabled=!1,l._nodesToHighlight=null,l._options=null,l._nodeBeingResized=null,l._pointedNode=null,l._cursorEnabled=!1,l._x=0,l._y=0,l._additionalRadiuses=[],l._onSelectionChange=function(){l._enabled&&(l._nodesToHighlight=l._selection.getSelectedNodes(),l._displayHandles())},l._displayHandlesHandler=function(){return l._displayHandles()},l._moveHandler=function(u){var d=u.x,c=u.y;l._dom.setTimeout(function(){return l._detectBoundingBoxes(d,c)})},l._dom=t,l._interactions=n,l._events=r,l._camera=i,l._dom=t,l._spatial=a,l._graphics=o,l._selection=s,l._engine=l._graphics.getGraphicsEngine(),l._canvas=di(),l._ctx=l._canvas.getContext("2d"),l._interactions.onDrag({priority:"resizing",disableDetection:!0,check:function(){return!(!l._enabled||!l._pointedNode)},onStart:function(u){var c=u.y;l._x=u.x,l._y=c,l._nodeBeingResized=l._pointedNode},onProgress:function(u){var c=u.y;l._x=u.x,l._y=c,l._displayHandles()},onStop:function(){l._nodesToHighlight.forEach(function(u,d){var c=l._additionalRadiuses[d]/l._camera.zoom;u.setAttributes({radius:u.getAttribute("radius")+c,x:u.getPosition().x+c,y:u.getPosition().y-c})}),l._pointedNode=null,l._nodeBeingResized=null,l._displayHandles()}}),l}var Z_,zc,Bc,L1={strokeColor:"black",strokeWidth:5,dashed:!0,cursorStyle:"cell",createNodes:!0,condition:function(){return!0},onNodeCreated:function(){},onEdgeCreated:function(){},onComplete:function(){}},F1=(bt(qo,Z_=E),qo.prototype._onStart=function(e){e&&(this._cursorEnabled=!0,this._startNode=e,this._startPos=e.getPosition(),this._graphics.addCursorStyle(this._options.cursorStyle),this._blockId=this._graphics.allocateGraphicsEngineBlockId())},qo.prototype._onMove=function(e,t){null!==this._startNode&&(this._endPos=this._camera.screenToGraphCoordinates({x:e,y:t}),this._drawLine())},qo.prototype._onStop=function(){if(null!==this._startNode){var e=this._options,t=e.condition,n=e.onNodeCreated,i=e.onEdgeCreated,r=e.onComplete,o=e.createNodes,a=this._captor.getPointedElement(),s=null,l=null;this._graphics.releaseGraphicsEngineBlockId(this._blockId),!a&&o&&(l=a=this._graph.addNode({attributes:{x:this._endPos.x,y:this._endPos.y}}),n&&n(l)),a&&(l||!t||t(this._startNode,a))&&(s=this._graph.addEdge({source:this._startNode.getId(),target:a.getId()}),i&&i(s)),r&&(this._events.fire(x.CONNECT_NODES,{source:this._startNode,target:a,edge:s}),r(this._startNode,a,s)),this.disable()}},qo.prototype._drawLine=function(){this._block.reset(1,!1,this._depth);var e=this._block.nextAndReset().end;e.pieceId=2,e.shape="line",e.x1=this._startPos.x,e.y1=this._startPos.y,e.x2=this._endPos.x,e.y2=this._endPos.y,e.fillColor=this._options.strokeColor,e.thicknessOrFontSizeFixed=this._options.strokeWidth,this._options.dashed&&(e.dashLength=3,e.gapLength=1),this._engine.storeBlock(this._blockId,this._block),this._dom.refresh()},qo.prototype.enable=function(e){if(void 0===e&&(e={}),!this._enabled)return this._options=Mt({},L1,e),this._enabled=!0,this._cursorEnabled=!1,this._startNode=null,this._prevSettings=this._settings.update({"cursor.node":this._options.cursorStyle,"detect.edges":!1}),this._captor.isLeftPressed()&&this._interaction.start(this._captor.getCursorInformation()),this},qo.prototype.disable=function(){this._enabled&&(this._enabled=!1,this._settings.update(this._prevSettings),this._cursorEnabled&&this._graphics.removeCursorStyle(this._options.cursorStyle))},qo.prototype.enabled=function(){return this._enabled},qo);function qo(e){var t=e.dom,n=e.camera,i=e.captor,r=e.graph,o=e.graphics,a=e.interactions,s=e.events,l=e.settings,u=Z_.call(this)||this;return u._enabled=!1,u._options=null,u._blockId=null,u._startNode=null,u._startPos=null,u._endPos=null,u._cursorEnabled=!1,u._dom=t,u._camera=n,u._captor=i,u._graph=r,u._graphics=o,u._interactions=a,u._events=s,u._settings=l,u._engine=u._graphics.getGraphicsEngine(),u._block=u._engine.createBlock(),u._depth=xu(0).edgeBody,u._events.register([x.CONNECT_NODES]),u._interaction=u._interactions.onDrag({priority:"connectNodes",check:function(d){var c=d.target,h=d.button;return u._enabled&&"left"===(void 0===h?"left":h)&&c&&c.isNode},onStart:function(d){return u._onStart(d.target)},onProgress:function(d){return u._onMove(d.x,d.y)},onStop:function(){return u._onStop()}}),u._events.on({clear:function(){return u.disable()}}),u}var G_,P1=["top","bottom","left","right","cssDefined"],D1={top:{x:0,y:-1},bottom:{x:0,y:1},left:{x:-1,y:0},right:{x:1,y:0}},R1={position:"top",autoAdjust:!0,delay:100,className:null},z1={hover:{node:function(e){var t=e.target;return t&&t.isNode},edge:function(e){var t=e.target;return t&&!t.isNode}},click:((zc={})[Yt.LEFT]={node:function(e){var t=e.target;return e.button===Yt.LEFT&&t&&t.isNode},edge:function(e){var t=e.target;return e.button===Yt.LEFT&&t&&!t.isNode},background:function(e){return e.button===Yt.LEFT&&!e.target}},zc[Yt.RIGHT]={node:function(e){var t=e.target;return e.button===Yt.RIGHT&&t&&t.isNode},edge:function(e){var t=e.target;return e.button===Yt.RIGHT&&t&&!t.isNode},background:function(e){return e.button===Yt.RIGHT&&!e.target}},zc),doubleClick:((Bc={})[Yt.LEFT]={node:function(e){var t=e.target;return e.button===Yt.LEFT&&t&&t.isNode},edge:function(e){var t=e.target;return e.button===Yt.LEFT&&t&&!t.isNode},background:function(e){return e.button===Yt.LEFT&&!e.target}},Bc[Yt.RIGHT]={node:function(e){var t=e.target;return e.button===Yt.RIGHT&&t&&t.isNode},edge:function(e){var t=e.target;return e.button===Yt.RIGHT&&t&&!t.isNode},background:function(e){return e.button===Yt.RIGHT&&!e.target}},Bc)},B1=(bt(Hr,G_=E),Hr.prototype.hide=function(){this._hideTooltip(!0)},Hr.prototype.isShown=function(){return!!this._tooltip},Hr.prototype.refresh=function(){this._refreshTooltip()},Hr.prototype.show=function(e,t){var n=void 0===t?{}:t,i=n.position,o=n.autoAdjust,s=n.className,u=n.x,c=n.y;this._showTooltip(e,{position:void 0===i?"top":i,autoAdjust:void 0===o||o,className:void 0===s?null:s},{x:void 0===u?0:u,y:void 0===c?0:c})},Hr.prototype.setHandler=function(e,t,n){var i=Mt({},R1,n);-1===P1.indexOf(i.position)&&(i.position="top"),this._handlers[e]={handler:t,condition:xn(z1,e),settings:i}},Hr.prototype._hideTooltip=function(e){if(this._timeout&&(this._dom.clearTimeout(this._timeout),this._timeout=null),e&&(this._currentHandlerName=null),this._tooltip){var t=this._tooltip;this._tooltip.parentNode&&this._tooltip.parentNode.removeChild(this._tooltip),this._tooltip=null,this._events.fire(x.TOOLTIP_HIDE,{tooltip:t})}},Hr.prototype._createInteraction=function(e,t){var n=this;return void 0===t&&(t=!1),{priority:"tooltip",check:function(i){var r=q_(e,i),o=n._handlers[r];return!(t&&n._connectNodes.enabled()||(!o||!o.condition(i))&&(t||!n._currentHandlerName||n._isHover||null===n._tooltip))},handler:function(i){var r=i.target,o=i.x,a=i.y;n._hideTooltip(!1),n._isHover=t,n._elt=r,n._x=o,n._y=a,n._currentHandlerName=q_(e,i),n._refreshTooltip()}}},Hr.prototype._refreshTooltip=function(){var e=this;if(this._currentHandlerName){var t=this._handlers[this._currentHandlerName];if(t){var n=t.settings,i=t.handler,r=this._elt;if(r&&-1===this._currentHandlerName.indexOf(r.isNode?"node":"edge"))return;var a=i(r);(a instanceof Promise?a:Promise.resolve(a)).then(function(s){e._schedule(function(){return e._showTooltip(s,n)},n.delay)})}}else this._hideTooltip(!1)},Hr.prototype._schedule=function(e,t){var n=this;this._timeout&&this._dom.clearTimeout(this._timeout),this._timeout=this._dom.setTimeout(function(){n._timeout=null,e()},t)},Hr.prototype._showTooltip=function(e,t,n){this._hideTooltip(!1);var i=t.position,r=t.className,o=t.autoAdjust,a=this._x,s=this._y,l=this._elt,u=this._dom.getDimensions(),d=0,c=0;if(n&&(a=n.x,s=n.y,l=null),"string"==typeof e)this._tooltip=nr?document.createElement("div"):$o(),this._tooltip.innerHTML=e;else{if(!Po(e))throw new Error("invalid tooltip "+e+", expected HTML string or HTML element");this._tooltip=e}var h=this._tooltip;if(r&&this._tooltip.classList.add(r),"cssDefined"!==i&&(h.style.position="absolute"),this._dom.appendElement(h),l&&l.isNode){var p=l,g=p.getPositionOnScreen(),m=p.getAttribute("radius");m="fixed"===p.getAttribute("scalingMethod")?m+p.getAttribute("innerStroke.width")+p.getAttribute("outerStroke.width"):m*this._camera.getZoom()+p.getAttribute("innerStroke.width")+p.getAttribute("outerStroke.width"),a=g.x,s=g.y,c=d=m}var b=h.offsetWidth/2,v=h.offsetHeight/2;if(d+=b,c+=v,"cssDefined"!==i){var y=D1[i],S=y.x,A=y.y;if(o){var C=a+d*y.x,O=s+c*y.y;(C-b<0||C+b>=u.width)&&("left"===i||"right"===i?S*=-1:S=C-b<0?(b-C+1)/d:(u.width-(C+b)-1)/d),(O-v<0||O+v>=u.height)&&("top"===i||"bottom"===i?A*=-1:A=O-v<0?(v-O+1)/c:(u.height-(O+v)-1)/c)}h.style.left=a+d*S-b+"px",h.style.top=s+c*A-v+"px"}this._events.fire(x.TOOLTIP_SHOW,{tooltip:h})},Hr);function Hr(e){var t=e.dom,n=e.connectNodes,i=e.interactions,r=e.camera,o=e.events,a=G_.call(this)||this;return a._x=0,a._y=0,a._dom=t,a._connectNodes=n,a._interactions=i,a._camera=r,a._events=o,a._handlers={},a._currentHandlerName=null,a._tooltip=null,a._isHover=!1,a._events.register(["showTooltip","hideTooltip"]),a._events.on({"up dragStart":function(){a._isHover||a._hideTooltip(!1)},unhover:function(){a._isHover&&a._hideTooltip(!1)},clear:function(){return a._hideTooltip(!1)}}),a._interactions.onHover(a._createInteraction("hover",!0)),a._interactions.onClick(a._createInteraction("click")),a._interactions.onDoubleClick(a._createInteraction("doubleClick")),a}function q_(e,t){var n=t.button,i=t.target;return e+(n?"."+n:"")+"."+(null!==i?i.isNode?"node":"edge":"background")}var H_,Ou={65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",13:"enter",16:"shift",17:"ctrl",18:"alt",27:"esc",46:"del",8:"backspace",32:"space",224:"cmd",91:"cmd",92:"cmd",93:"cmd",187:"+",189:"-"},W_=Object.keys(Ou).reduce(function(e,t){var n=Ou[t];return e[n]||(e[n]=[]),e[n].push(t),e},{}),V1=(bt(Us,H_=E),Us.prototype.setIdleTimeout=function(e){if(!isFinite(e)||e<=1)throw new TypeError("Idle timeout must be a positive number > 1");this._idleTimeout=e},Us.prototype.resetKeys=function(){for(var e=0;e<this._pressed.length;e++)this._pressed[e]&&(this._pressed[e]=!1,this._events.fire("keyUp",{key:Ou[e],code:e}))},Us.prototype.onKeyPress=function(e,t){var n,i=this;if("number"==typeof e&&(n=[e]),"string"==typeof e&&(n=e.split(" ")),Array.isArray(e)&&(n=e),!n)throw new TypeError(e+" is not a number, string or array");if(0===n.length)throw new Error("the array should contain at least one element");var r=n.map(function(s){if("number"==typeof s)return[s];if("string"!=typeof s)throw new TypeError(s+" is not a valid key identifier");var l=W_[s];if(!l)throw new Error(s+" is not a valid key identifier");return l}),o=r.pop(),a={keys:r,handler:t};o.forEach(function(s){i._binds[s]||(i._binds[s]=[]),i._binds[s].push(a)})},Us.prototype.isPressed=function(e){var t=this;if("number"==typeof e)return this._pressed[e];if("string"==typeof e){var n=W_[e];if(n)return n.some(function(i){return t._pressed[i]})}return!1},Us);function Us(e){var t=e.dom,n=e.events,i=H_.call(this)||this;return i._onBlur=function(){return i.resetKeys()},i._onKeyUp=function(r){var o=r.keyCode||r.which;i._pressed[o]=!1,i._events.fire("keyUp",{domEvent:r,key:Ou[o],code:o})},i._onKeyDown=function(r){var o=r.keyCode||r.which,a=i._binds[o];if(!i._pressed[o]){if(i._pressed[o]=!0,a)for(var s=0,l=a;s<l.length;s++){var u=l[s];u.keys.every(function(d){return d.some(function(c){return i._pressed[c]})})&&u.handler({domEvent:r})}i._events.fire("keyDown",{domEvent:r,key:Ou[o],code:o})}},i._dom=t,i._events=n,i._events.register(["keyUp","keyDown"]),i._binds=[],i._pressed=[],i._dom.addWindowEventListener("keydown",i._onKeyDown),i._dom.addWindowEventListener("keyup",i._onKeyUp),i._dom.addWindowEventListener("visibilitychange",i._onBlur),i._dom.addWindowEventListener("blur",i._onBlur,!1),i._idleTimeout=4e3,i._prevEventTimeStamp=R(),i._events.onAnyEvent(function(){var r=R();r-i._prevEventTimeStamp>i._idleTimeout&&i.resetKeys(),i._prevEventTimeStamp=r}),i}var U1=[{name:"color",isNode:!0},{name:"shape",isNode:!0},{name:"radius",isNode:!0},{name:"icon.content",isNode:!0},{name:"image.url",isNode:!0},{name:"image",isNode:!0},{name:"color",isNode:!1},{name:"shape",isNode:!1},{name:"width",isNode:!1}],Ho=Math.PI,Wo=2*Math.PI,Y_=Math.cos(Ho/2-Wo/5),X_=Math.cos(Ho/2-Wo/5*2),J_=Math.cos(Ho/2-Wo/5*3),Q_=Math.cos(Ho/2-Wo/5*4),K_=Math.sin(-Ho/2+Wo/5),$_=Math.sin(-Ho/2+Wo/5*2),em=Math.sin(-Ho/2+Wo/5*3),tm=Math.sin(-Ho/2+Wo/5*4),Vc=1/3,Z1=[8,3],G1=[3,3],im={position:"bottom",widgetWidth:130,fontFamily:"Arial",fontSize:10,fontColor:"black",titleFontSize:12,titleFontColor:"black",titleMaxLength:20,titleTextAlign:"left",shapeColor:"grey",backgroundColor:"white",borderColor:"black",borderRadius:0,borderWidth:1,innerMargin:10,outerMargin:5,circleStrokeWidth:3,titleFunction:function(e){return e[e.length-1]}},q1=["widgetWidth","fontSize","titleFontSize","borderRadius","borderWidth","innerMargin","outerMargin","circleStrokeWidth"];function Yo(e){var t=["K","M","B","T","P","E","Z","Y"];if(9999<e){for(var n=0;n<t.length&&999<e;)e/=1e3,n++;return(rm(e,3)+t[n-1]).toString()}return rm(e,4).toString()}function rm(e,t){void 0===t&&(t=3);var n=4===t?10:1;return e<10?Math.round(100*e*n)/100*n:e<100?Math.round(10*e*n)/10*n:e<1e3?Math.round(e*n)/n:Math.round(e)}function om(e){return e.innerMargin+1.6*(e.titleFontSize+e.fontSize)}function H1(e,t,n){var i,U,W,ce,he,Ee,Te,it,rt,We,o=t.getContext("2d"),a=n.x,s=n.y,u=n.isNode,d=n.styleProperty,c=n.title,h=n.mapping,p=n.iconFont,g=n.iconFontStyle;W=a,ce=s,he=(i=e).widgetWidth,Ee=n.height,Te=i.borderRadius,it=i.backgroundColor,rt=i.borderColor,We=i.borderWidth,(U=o).setLineDash([]),U.beginPath(),U.moveTo(W+Te,ce),U.lineTo(W+he-Te,ce),U.quadraticCurveTo(W+he,ce,W+he,ce+Te),U.lineTo(W+he,ce+Ee-Te),U.quadraticCurveTo(W+he,ce+Ee,W+he-Te,ce+Ee),U.lineTo(W+Te,ce+Ee),U.quadraticCurveTo(W,ce+Ee,W,ce+Ee-Te),U.lineTo(W,ce+Te),U.quadraticCurveTo(W,ce,W+Te,ce),U.closePath(),U.fillStyle=it,U.fill(),U.strokeStyle=rt,U.lineWidth=We,U.stroke(),function(U,W,ce,he,Ee){Nu(U,W.fontFamily,W.titleFontSize,W.titleFontColor,W.titleTextAlign);var Te="center"===W.titleTextAlign,it=W.widgetWidth-2*W.innerMargin,rt=U.measureText(ce).width,We=he+(Te?W.widgetWidth/2:W.innerMargin),_t=Ee+W.titleFontSize/2+W.innerMargin;it<rt&&(ce=ce.substr(0,(ce.length*(it/rt)|0)-2)+"\u2026"),U.fillText(ce,We,_t)}(o,e,c,a,s);var b=1.6*e.fontSize,v=e.fontSize/2*1.6*.9,y=3*e.fontSize,S=e.fontSize,A=e.fontSize*(u?1:3),C=s+om(e),O=a+e.innerMargin+A/2,N=a+2*e.innerMargin+A,P=Ra(h),F=function U(W){return Array.isArray(W)?W.reduce(function(ce,he){return ce&&U(he)},!0):"undefined"===W||!isNaN(Number(W))}(P),L=e.fontColor,B=e.shapeColor,Y=Object.keys(h);if(F&&(Y.sort(function(U,W){return gn(h[W])-gn(h[U])}),"radius"===d||"width"===d)){var X=function U(W){return Array.isArray(W)?W.reduce(function(ce,he){return Math.min(ce,U(he))},1/0):isNaN(W)?1/0:+W}(P),ae=function U(W){return Array.isArray(W)?W.reduce(function(ce,he){return Math.max(ce,U(he))},-1/0):isNaN(W)?-1/0:+W}(P),ie=Math.round((X+ae)/2);return(u?W1:Y1)(e,o,a,C,X,ie,ae,B)}Y.forEach(function(U){var W,ce,he,Ee,Te,rt,We,_t,wt,Ze,Ne,Ge,Xe,$e,we,Pe,je,Je,ut,Gt,Xt,Ue=h[U];"color"===d&&(u?am(o,O,C,v,U):(ce=O,he=C,Ee=y,Te=S,(W=o).fillStyle=U,W.fillRect(ce-Ee/2,he-Te/2,Ee,Te))),"shape"===d&&(u?function(Ze,Ne,Ge,Xe,$e,we){switch(Ze.fillStyle=we,$e){case"square":return Ze.fillRect(Ne-Xe,Ge-Xe,2*Xe,2*Xe);case"circle":return am(Ze,Ne,Ge,Xe,we);case"cross":return(Pe=Ze).fillRect((je=Ne)-(ut=Xe),(Je=Ge)-.31*ut,2*ut,2*ut*.31),void Pe.fillRect(je-.31*ut,Je-ut,2*ut*.31,2*ut);case"diamond":return function(Pe,je,Je,ut){Pe.beginPath(),Pe.moveTo(je-ut,Je),Pe.lineTo(je,Je-ut),Pe.lineTo(je+ut,Je),Pe.lineTo(je,Je+ut),Pe.fill()}(Ze,Ne,Ge,Xe);case"equilateral":return function(Pe,je,Je,ut){Pe.beginPath(),Pe.moveTo(je,Je-ut),Pe.lineTo(je+Y_*ut,Je+K_*ut),Pe.lineTo(je+X_*ut,Je+$_*ut),Pe.lineTo(je+J_*ut,Je+em*ut),Pe.lineTo(je+Q_*ut,Je+tm*ut),Pe.fill()}(Ze,Ne,Ge,Xe);case"star":!function(Pe,je,Je,ut){Pe.beginPath(),Pe.moveTo(je,Je-ut),Pe.lineTo(je+X_*ut,Je+$_*ut),Pe.lineTo(je+Q_*ut,Je+tm*ut),Pe.lineTo(je+Y_*ut,Je+K_*ut),Pe.lineTo(je+J_*ut,Je+em*ut),Pe.fill()}(Ze,Ne,Ge,Xe)}var Pe,je,Je,ut}(o,O,C,v,U,B):(Ne=O,Ge=C,Xe=y,$e=S,we=U,(Ze=o).fillStyle=Pe=B,"line"===we&&Ze.fillRect(Ne-Xe/2,Ge-$e/4,Xe,$e/2),"arrow"===we?((je=Ze).fillRect((Je=Ne)-(Gt=Xe)/2,(ut=Ge)-(Xt=$e)/4,Gt*(1-Vc),Xt/2),je.beginPath(),je.moveTo(Je+Gt*(1-Vc-.5),ut-Xt/2),je.lineTo(Je+Gt*(1-Vc-.5),ut+Xt/2),je.lineTo(Je+Gt/2,ut),je.fill()):"dashed"===we||"dotted"===we?function(je,Je,ut,Gt,Xt,an,nn){je.beginPath(),je.moveTo(Je-Gt/2,ut),je.lineTo(Je+Gt/2,ut),je.strokeStyle=an,je.lineWidth=Xt/2,je.setLineDash("dashed"===nn?Z1:G1),je.stroke()}(Ze,Ne,Ge,Xe,$e,Pe,we):"tapered"===we&&function(je,Je,ut,Gt,Xt){je.beginPath(),je.moveTo(Je-Gt/2,ut-Xt/2),je.lineTo(Je-Gt/2,ut+Xt/2),je.lineTo(Je+Gt/2,ut),je.fill()}(Ze,Ne,Ge,Xe,$e))),"icon.content"===d&&(We=O,_t=C,wt=U,Nu(rt=o,p,2*v,L,"center",g),rt.fillText(wt,We,_t)),"image"!==d&&"image.url"!==d||function(Ze,Ne,Ge,Xe,$e){if("undefined"!=typeof Image){Ze._imgStore||(Ze._imgStore={});var we=Ze._imgStore[$e];if(we)return Ze.drawImage(we,Ne-Xe,Ge-Xe,2*Xe,2*Xe);(we=new Image).src=$e,we.onload=function(){Ze.drawImage(we,Ne-Xe,Ge-Xe,2*Xe,2*Xe)},Ze._imgStore[$e]=we}}(o,O,C,v,U),function(Ze,Ne,Ge,Xe,$e,we){var Pe=$e.join();if(we)if(1===$e.length)Pe=Yo($e[0]);else{var je=gn($e),Je=en($e);Pe=Yo(je)+" - "+Yo(Je)}Nu(Ze,Ne.fontFamily,Ne.fontSize,Ne.fontColor),Ze.fillText(Pe,Ge,Xe)}(o,e,N,C,Ue,F),C+=b})}function Nu(e,t,n,i,r,o){void 0===r&&(r="left"),void 0===o&&(o="normal"),e.textAlign=r,e.textBaseline="middle",e.fillStyle=i,e.font=o+" "+n+'px "'+t+'"'}function am(e,t,n,i,r){e.beginPath(),e.arc(t,n,i,0,2*Ho),e.fillStyle=r,e.fill()}function W1(e,t,n,i,r,o,a,s){for(var l,u,d,c,h,p,g=.7*e.fontSize,m=3*g,b=(g+m)/2,v=n+e.innerMargin+m,y=v+m+e.innerMargin,S=i+2*m-.5*e.innerMargin,A=e.circleStrokeWidth,C=0,O=[g,b,m];C<O.length;C++){var N=O[C];u=v,d=S-N,c=N,h=s,p=A,(l=t).beginPath(),l.arc(u,d,c,0,Wo),l.strokeStyle=h,l.lineWidth=p,l.stroke()}Nu(t,e.fontFamily,e.fontSize,e.fontColor,"left"),t.fillText(Yo(r),y,S+g-2*g),t.fillText(Yo(o),y,S+g-2*b),t.fillText(Yo(a),y,S+g-2*m)}function Y1(e,t,n,i,r,o,a,s){var l=(e.widgetWidth-2*e.innerMargin)/3,u=e.fontSize,d=i-e.innerMargin/2,c=d+2*u,h=n+e.innerMargin;t.fillStyle=s,t.fillRect(h,d-u/2,1+l,u),t.fillRect(h+l,d-u/3,1+l,u/1.5),t.fillRect(h+2*l,d-u/6,l,u/3),Nu(t,e.fontFamily,e.fontSize,e.fontColor,"center"),t.fillText(Yo(a),h+.5*l,c),t.fillText(Yo(o),h+1.5*l,c),t.fillText(Yo(r),h+2.5*l,c)}function J1(e,t,n){for(var i=null,r=0;r<t.length;++r){var o=t[r];o.isNode!==e.isNode&&1!==t.length||!(null===i||o.height<t[i].height)||(i=r)}(o=t[i]).content.push(e),o.height+=e.height+n.outerMargin}function Q1(e){for(var t=0,n=1;n<e.length;++n)e[n].height>e[t].height&&(t=n);return t}function K1(e,t){return e.isNode!==t.isNode?e.isNode?-1:1:e.title<=t.title?-1:1}function $1(e,t){return e.height-t.height}function eE(e,t){return e.isNode!==t.isNode?e.isNode?-1:1:t.height-e.height}function tE(e,t){return e.isNode!==t.isNode?e.isNode?-1:1:e.content[0].title<=t.content[0].title?-1:1}var sm,nE=(bt(Pi,sm=E),Pi.prototype.enable=function(e){var t=this._settings;return this._settings=Mt({},im,e),this._mustRefresh=!this._enabled||!this._sameOptions(t,this._settings),this._enabled?Promise.resolve():(this._enabled=!0,this._graphics.addCanvas(this._canvas),this.refresh())},Pi.prototype._afterNextUpdate=function(){var e=this;return new Promise(function(t){return e._promises.push(t)})},Pi.prototype._formatSettings=function(e,t){var n=Mt({},im,e);return q1.forEach(function(i){return n[i]*=t}),n},Pi.prototype.disable=function(){this._enabled&&(this._enabled=!1,this._graphics.removeCanvas(this._canvas))},Pi.prototype.enabled=function(){return this._enabled},Pi.prototype.refresh=function(){return this._mustRefresh=!0,this._dom.refresh(),this._afterNextUpdate()},Pi.prototype.destroy=function(){this._enabled=!1,this._mustRefresh=!1,this._settings=null,this._promises=[]},Pi.prototype.getOptions=function(){if(this.enabled)return Mt({},this._settings)},Pi.prototype.getCurrentOptions=function(){return this._settings},Pi.prototype._sameOptions=function(e,t){return e===t||Object.keys(e).reduce(function(n,i){return n&&e[i]===t[i]},!0)},Pi.prototype._drawOnCanvas=function(e,t,n){var i=this._formatSettings(e,n);!function(e,t,n){var i={width:t.width,height:t.height},r=!1;!!(i.width&&i.height&&n)&&((r="top"===e.position||"bottom"===e.position?function(o,a,s,l){s=s.slice();for(var u=a.widgetWidth+a.outerMargin,d=Math.floor((o.width-a.outerMargin)/u),c=o.height-a.outerMargin,h=new Array(Math.min(d,s.length)),p=s.length,g=0,m=0,b=0,v=0,y=0;y<p;++y){var S=s[y];S.isNode?(g+=1,m+=S.height):(b+=1,v+=S.height)}var A=m+v,O=v/A,N=Math.round(m/A*d),P=Math.round(O*d);if(g<N?N=g:b<P&&(N=d-b),0===d)return!1;for(y=0;y<h.length;y++)h[y]={content:[],height:0,isNode:y<N};for(y=0;y<p;++y){var F=Q1(s);J1(s[F],h,a),s.splice(F,1)}h.every(function(ie){return 1===ie.content.length})?h.sort(tE):h.sort(eE);var L=a.outerMargin;for(y=0;y<h.length;++y){var B=h[y];if(B.height>c)return!1;B.content.sort($1);for(var Y=0,X=0;X<B.content.length;++X){var ae=B.content[X];ae.x=L,ae.y=l?o.height-Y-ae.height-a.outerMargin:Y+a.outerMargin,Y+=ae.height+a.outerMargin}L+=u}return!0}(i,e,n,"bottom"===e.position):function(o,a,s,l){var u=a.widgetWidth+a.outerMargin,d=Math.floor((o.width-a.outerMargin)/u),c=o.height,h=a.outerMargin,p=l?a.outerMargin:o.width-u,g=1;s=s.slice().sort(K1);for(var m=0;m<s.length;++m){var b=s[m];if(h+b.height>c){if(h===a.outerMargin)return!1;h=a.outerMargin,g+=1,l?p+=u:p-=u}b.x=p,b.y=h,h+=b.height}return g<=d}(i,e,n,"left"===e.position))&&n.forEach(function(o){return H1(e,t,o)}))}(i,t,this._computeWidgetList(i))},Pi.prototype.exportOnCanvas=function(e,t){return this._drawOnCanvas(t,e,1)},Pi.prototype._computeWidgetList=function(e){var t=this,n=[];return U1.forEach(function(i){var a=t._computeWidget(e,i.name,i.isNode);a&&n.push(a)}),n},Pi.prototype._computeWidget=function(e,t,n){var i=this._computePropertyMapping(e,t,n);if(i){if("icon.content"!==t)return i;var r=this._getRulesForAttribute(n,"icon.font"),o=this._getRulesForAttribute(n,"icon.style"),a=null,s=null;if(r.length||(a="Arial",s="normal"),"string"==typeof r[0]&&(a=r[0],s=o[0]),a)return i.iconFont=a,i.iconFontStyle=s,i}return null},Pi.prototype._computePropertyMapping=function(e,t,n){var i,r,o,a,s,l,u,d=this._getRulesForAttribute(n,t)[0],c=d&&d.mapping,h=c&&c.getValues(n);if(c&&h){var p=c.getField(),g={};return ft(h,function(m,b){void 0!==m&&"undefined"!==b&&(g[m]=g[m]||[],g[m].push(b))}),0===Object.keys(g).length?null:{isNode:n,title:e.titleFunction(p),styleProperty:t,dataProperty:p,mapping:g,height:(i=g,r=t,o=n,s=(a=e).outerMargin+om(a),l=1.6*a.fontSize,u=s-.8*a.innerMargin,"radius"===r||"width"===r?u+l*(o?3:2):u+Object.keys(i).length*l)}}return null},Pi.prototype._getRulesForAttribute=function(e,t){return this._styleRules.getRuleList().map(function(n){var i=n.getDefinition();return xn(e?i.nodeAttributes:i.edgeAttributes,t)}).filter(function(n){return n}).sort(function(n,i){return n.mapping&&i.mapping?0:n.mapping?-1:1})},Pi);function Pi(e){var t,n=e.graphics,i=e.dom,r=e.events,o=e.styleRules,a=sm.call(this)||this;return a._enabled=!1,a._mustRefresh=!1,a._settings=null,a._promises=[],a._graphics=n,a._dom=i,a._events=r,a._styleRules=o,a._canvas=di(),a._ctx=a._canvas.getContext("2d"),a._events.on(((t={})[x.NEW_FRAME]=function(){if(a._enabled&&a._mustRefresh){a._ctx.clearRect(0,0,a._canvas.width,a._canvas.height),a._drawOnCanvas(a._settings,a._canvas,Nn());var s=a._promises;a._promises=[],s.forEach(function(l){return l()}),a._mustRefresh=!1}},t[x.RESIZE+" "+x.RELOAD_FONTS]=function(){a._mustRefresh=!0},t)),a}var um,lm={layer:3,outline:!0,outerStroke:{color:"red",width:5},innerStroke:{minVisibleSize:0},text:{backgroundColor:"rgb(220, 220, 220)",minVisibleSize:0}},iE={layer:3,outline:!0,color:"red",text:{backgroundColor:"rgb(220, 220, 220)",minVisibleSize:0}},rE=(bt(Nr,um=E),Nr.prototype.setRate=function(e){this._delay=e},Nr.prototype.updateNodeAttributes=function(e,t){this._hoverClass.update({nodeAttributes:e,fullOverwrite:t}),this._hoverExtremityHighlightedClass.update({nodeAttributes:e,fullOverwrite:t}),this._updateExtremityHighlightLayer()},Nr.prototype.updateEdgeAttributes=function(e,t){this._hoverClass.update({edgeAttributes:e,fullOverwrite:t}),this._updateExtremityHighlightLayer()},Nr.prototype.onMounted=function(e){function t(){n._hoverExtremityHighlightedClass.clearNodes(),n._hoverClass.getEdges().getExtremities().addClass(oc)}var n=this;this._classes.onEdgeClassAdded(Ja,t),this._classes.onEdgeClassRemoved(Ja,t)},Nr.prototype._registerSettings=function(){var e=this;this._settings.register("cursor.node","pointer",function(t,n){e._hovered&&e._hovered.isNode&&(e._graphics.removeCursorStyle(n),e._graphics.addCursorStyle(t))}),this._settings.register("cursor.edge","pointer",function(t,n){e._hovered&&!e._hovered.isNode&&(e._graphics.removeCursorStyle(n),e._graphics.addCursorStyle(t))}),this._settings.register("nodeHover",!0,function(t){!t&&e._hovered&&e._hovered.isNode&&e._unhoverElement(e._hovered)}),this._settings.register("edgeHover",!0,function(t){t||!e._hovered||e._hovered.isNode||e._unhoverElement(e._hovered)})},Nr.prototype._updateExtremityHighlightLayer=function(){var e=this._hoverClass.getDefinition().edgeAttributes;this._hoverExtremityHighlightedClass.update({nodeAttributes:{layer:e?e.layer:void 0},fullOverwrite:!1})},Nr.prototype._removeTimeout=function(){this._timeout&&(this._dom.clearTimeout(this._timeout),this._timeout=null)},Nr.prototype._isAnimating=function(){return this._graphics.isAnimating()},Nr.prototype._hoverElement=function(e){var t=this;this._settings.get(e.isNode?"nodeHover":"edgeHover")&&!this._isAnimating()&&(this._removeTimeout(),this._timeout=this._dom.setTimeout(function(){t._isAnimating()||(t._setElementHighlight(!0,e),t._hovered=e),t._timeout=null},this._delay))},Nr.prototype._unhoverElement=function(e){this._removeTimeout(),this._hovered===e&&(this._setElementHighlight(!1,e),this._hovered=null)},Nr.prototype._setElementHighlight=function(e,t){var n=this._settings.get(t.isNode?"cursor.node":"cursor.edge");e?(this._graphics.addCursorStyle(n),t.addClass(Ja)):(this._graphics.removeCursorStyle(n),t.removeClass(Ja)),t.isNode&&e&&this._graph.getAttribute(t.isNode,"textHidden").set(t._index,!1)},Nr);function Nr(e){var t,n=e.dom,i=e.classes,r=e.captor,o=e.graph,a=e.graphics,s=e.settings,l=e.events,u=um.call(this)||this;return u._delay=100,u._manualTriggerDetection=!1,u._hovered=null,u._timeout=null,u._onAnimate=function(d){d.duration&&(u._manualTriggerDetection=!0,u._resetHover())},u._onBeforeNewFrame=function(){if(u._manualTriggerDetection&&!u._graphics.isAnimating()){u._manualTriggerDetection=!1,u._captor.triggerDetection();var d=u._captor.getPointedElement();d&&u._hoverElement(d)}},u._onClear=function(){u._hovered=null,u._timeout&&u._dom.clearTimeout(u._timeout)},u._resetHover=function(){u._hovered&&(u._unhoverElement(u._hovered),u._captor.triggerUnhover()),u._timeout&&(u._dom.clearTimeout(u._timeout),u._timeout=null)},u._dom=n,u._graph=o,u._graphics=a,u._settings=s,u._captor=r,u._events=l,u._classes=i,u._registerSettings(),u._hoverExtremityHighlightedClass=u._classes.createClass({name:oc,isBuiltin:!0,nodeAttributes:lm}),u._hoverClass=u._classes.createClass({name:Ja,isBuiltin:!0,nodeAttributes:lm,edgeAttributes:iE}),u._events.on(((t={})[x.HOVER]=function(d){return u._hoverElement(d.target)},t[x.UNHOVER]=function(d){return u._unhoverElement(d.target)},t[x.ANIMATE]=u._onAnimate,t[x.BEFORE_NEW_FRAME]=u._onBeforeNewFrame,t[x.MOUSE_LEAVE]=u._resetHover,t[x.CLEAR_GRAPH]=u._onClear,t)),u}var oE=function(){this.x=0,this.y=0},aE=(Lu.prototype.getValue=function(e,t){var n=e.isNode,i=n?this._nodeMapping:this._edgeMapping;i.valid||(i.values=this._computeMapping(n),i.valid=!0);var r=e.getData(this._field);return Array.isArray(r)?"color"===t?r.map(function(o){return i.values[o]}):i.values[r[0]]:i.values[r]},Lu.prototype.markAsInvalid=function(){this._nodeMapping.valid=!1,this._edgeMapping.valid=!1},Lu.prototype.getValues=function(e){return e?this._nodeMapping.values:this._edgeMapping.values},Lu.prototype.getField=function(){return this._field},Lu);function Lu(e,t){this._nodeMapping={valid:!1,values:null},this._edgeMapping={valid:!1,values:null},this._computeMapping=t,this._field=e}function dm(e,t,n){var i=(t?e.getNodes():e.getEdges()).getData(n),r={};return i.forEach(function(o){if(!Array.isArray(o))return r[o]=1;o.forEach(function(a){return r[a]=1})}),"undefined"in r&&delete r[void 0],Object.keys(r).sort()}function sE(e,t,n,i){for(var r=n.values,o=n.fallback,a=dm(e,i,t),s={},l=0,u=0;u<a.length;++u){var d=a[u];d in r?s[d]=r[d]:(s[d]=o[l],l=(l+1)%o.length)}return s}function uE(e,t,n,i){for(var r=n.fallback,o=n.stops,a=n.values,s=n.reverse,l=dm(e,i,t),u=1/0,d=-1/0,c=0;c<l.length;c++)jl(m=+l[c])&&(u=Math.min(u,m),d=Math.max(d,m),l[c]=m);var h={};if(!isFinite(u)){for(c=0;c<l.length;c++)h[l[c]]=r;return h}var p=function(v,y){var S=y.nbSlices,A=y.minValue,C=y.maxValue;if(Array.isArray(v))return v.slice();for(var O=v.min,N=void 0===O?A:O,P=v.max,F=((void 0===P?C:P)-N)/S,L=[],B=1;B<S;++B)L.push(N+F*B);return L}(o,{nbSlices:Array.isArray(a)?a.length:a.nbSlices,minValue:u,maxValue:d}),g=function(v,y){if(Array.isArray(v))return v;for(var S=v.min,C=y.length+1,O=(v.max-S)/y.length,N=[],P=0;P<C;P++)N.push(S+P*O);return N}(a,p);for(s&&g.reverse(),c=0;c<l.length;++c){var m=l[c];if(isFinite(m)){for(var b=0;b<p.length&&p[b]<=m;)b+=1;h[m]=g[b]}else h[m]=r}return h}var cm,lE=(bt(js,cm=E),js.prototype.createMapping=function(e){var t=void 0===e?{field:""}:e,n=t.field,i=t.values,r=void 0===i?{}:i,o=t.fallback,a=void 0===o?void 0:o;if(n=Pr(n),Array.isArray(a)?0===a.length&&(a=[void 0]):a=[a],!Qr(r))throw new Error('"mapping" should be an object');return this._createMappingFunction(sE,n,{values:r,fallback:a})},js.prototype.createSlices=function(e){var t=void 0===e?{field:"",values:[]}:e,n=t.field,i=t.fallback,r=void 0===i?void 0:i,o=t.stops,a=void 0===o?{}:o,s=t.values,l=t.reverse,u=void 0!==l&&l;if(n=Pr(n),Array.isArray(s)||s.nbSlices||(s.nbSlices=7),Array.isArray(a)&&Array.isArray(s)&&a.length!==s.length-1)throw new Error("there should be exactly one more value that stops");return this._createMappingFunction(uE,n,{fallback:r,stops:a,values:s,reverse:u})},js.prototype._createMappingFunction=function(e,t,n){var i=this,r=new aE(t,function(a){return e(i._graph,t,n,a)});function o(a,s,l){return r.getValue(a,l)}return this._mappingList.push(r),o.mapping=r,o},js.prototype.createTemplate=function(e){if("string"!=typeof e)throw new TypeError('"template" should be a string');for(var t=[],n=0,i=!1;!i;){var r=-1,o=e.indexOf("{{",n);-1!==o&&(r=e.indexOf("}}",o+2)),-1!==r?(t.push(e.substring(n,o)),t.push(e.substring(o+2,r)),n=r+2):(t.push(e.slice(n)),i=!0)}return function(a){for(var s=t[0],l=1;l<t.length;l+=2)s+=a.getData(t[l]),s+=t[l+1];return s}},js);function js(e){var t,n=e.graph,i=e.events,r=e.styleRules,o=e.legend,a=cm.call(this)||this;return a._mappingList=[],a._graph=n,a._styleRules=r,a._events=i,a._legend=o,a._events.on(((t={})[[x.ADD_NODES,x.ADD_EDGES,x.UPDATE_NODE_DATA,x.UPDATE_EDGE_DATA,x.REMOVE_NODES,x.BEFORE_REMOVE_EDGES,x.EXCLUDED_STATE_CHANGE,x.CLEAR_GRAPH].join(" ")]=function(){if(a._mappingList.length){for(var s=0;s<a._mappingList.length;++s)a._mappingList[s].markAsInvalid();a._styleRules.refreshAllRules(),a._legend.refresh()}},t)),a}var Ao,Zs,hm=(Uc.prototype.run=function(e){var t=e.ogma,n=e.duration,i=this._getNodesToFilter(t),r=this._getEdgesToFilter(t,i);return Promise.all([i.addClass(ba,n),r.addClass(ba,n)]).then(function(){return i.setExcluded(!0),r.setExcluded(!0),{nodes:i,edges:r}})},Uc.prototype.undo=function(e){var t=e.duration,n=e.context,i=n.nodes,r=n.edges;return i.setExcluded(!1),r.setExcluded(!1),i.addClass(ba),r.addClass(ba),Promise.all([i.removeClass(ba,t),r.removeClass(ba,t)])},Uc);function Uc(e){var n=e.getEdgesToFilter;this._getNodesToFilter=e.getNodesToFilter,this._getEdgesToFilter=n}(Zs=Ao=Ao||{}).NodeFilter="node-filter",Zs.EdgeFilter="edge-filter",Zs.NodeCollapsing="node-collapsing",Zs.VirtualProperties="virtual-properties",Zs.NeighborGeneration="neighbor-generation",Zs.NeighborMerging="neighbor-merging";var pm,dE=(bt(jc,pm=hm),jc.prototype.getName=function(){return Ao.NodeFilter},jc);function jc(e){return pm.call(this,{getNodesToFilter:function(t){return t.getNodes().filter(function(n){return!e(n)})},getEdgesToFilter:function(t,n){return n.getAdjacentEdges()}})||this}var fm,cE=(bt(Zc,fm=hm),Zc.prototype.getName=function(){return Ao.EdgeFilter},Zc);function Zc(e){return fm.call(this,{getNodesToFilter:function(t){return t.createNodeList()},getEdgesToFilter:function(t){return t.getEdges().filter(function(n){return!e(n)})}})||this}function gm(e){return"object"!=typeof e?{criteria:e,enabled:!0,duration:0}:e}var _m,hE=(bt(Kl,_m=E),Kl.prototype.addNodeFilter=function(e){var t=gm(e),n=t.criteria,i=Io(t,["criteria"]);return this._transformations.add(new dE(n),i)},Kl.prototype.addEdgeFilter=function(e){var t=gm(e),n=t.criteria,i=Io(t,["criteria"]);return this._transformations.add(new cE(n),i)},Kl);function Kl(e){var t=e.transformations,n=_m.call(this)||this;return n._transformations=t,n}var pE=(mm.prototype.destroy=function(){var e=this;Object.keys(this).forEach(function(t){var n=e[t];n instanceof E&&n.destroy(e._ogma)})},mm);function mm(e,t){var n=this;this._ogma=e,"webgl"===gg&&_u.cacheInitData(_u.createInitData()),this.settings=new Wx,this.events=new qx,this.dom=new qe(this,t.dimensions),this.animations=new vb(this),this.camera=new jx(this),this.graph=new Py(this,e),this.data=new fn(this),this.graphics=new Gx(this,e),this.individualAttributes=new Hx(this),this.algorithms=new wb(this),this.position=new oE,this.touch=new ab(this),this.mouse=new rb(this),this.virtualMouse=new $b(this),this.spatial=new tb(this),this.captor=new A1(this),this.interactions=new m1(this),this.classes=new Xx(this),this.cameraInteractions=new M1(this,!!t.debug),this.hover=new rE(this),this.keyboard=new V1(this),this.selection=new cb(this),this.styleRules=new n1(this),this.legend=new nE(this),this.sync=new hb(this),this.rules=new lE(this),this.transformations=new lb(this,e),this.filters=new hE(this),this.locate=new nb(this),this.grouping=new sb(this),this.pulses=new _b(this),this.drag=new w1(this),this.curvatureManager=new Cb(this),this.tasks=new Db(this),this.layouts=new Ub(this),this.watcher=new Hb(this),this.pathfinding=new Qb(this),this.rectangleSelect=new i1(this),this.labels=new _1(this,t),this.brand=new Sb(this),this.lasso=new A_(this),this.rewiring=new k1(this),this.resizing=new N1(this),this.snapping=new e1(this),this.connectNodes=new F1(this),this.tooltip=new B1(this),this.geo=new Ab(this),e.onReady(function(){Object.keys(n).forEach(function(i){var r=n[i];r instanceof E&&r.onMounted(n._ogma,t)})})}var vm=(ym.initNamespace=function(e){var t;e.algorithms=(t=e,{shortestPath:function(n){return t.modules.algorithms.shortestPath(n)},hasCycle:function(n){var i=void 0===n?{}:n;return null!==t.algorithms.detectCycle({nodes:i.nodes,edges:i.edges})},getAllSimpleCycles:function(n){var i=void 0===n?{}:n,r=i.nodes,o=i.edges;return r=r||t.getNodes(),o=o||r.getAdjacentEdges({bothExtremities:!0}),t.modules.algorithms.getAllSimpleCycles(r,o)},detectCycle:function(n){var i=void 0===n?{}:n,r=i.nodes,o=i.edges;return r=r||t.getNodes(),o=o||r.getAdjacentEdges({bothExtremities:!0}),t.modules.algorithms.detectCycle(r,o)}})},ym);function ym(){}var fE=(Fu.prototype.createClass=function(e,t){return this.modules.classes.createClass(Object.assign({},t,{name:e}))},Fu.prototype.updateClass=function(e,t){return this.modules.classes.getClassByName(e,!0).update(t)},Fu.prototype.getNodesByClassName=function(e){return this.modules.classes.getClassByName(e,!0).getNodes()},Fu.prototype.getEdgesByClassName=function(e){return this.modules.classes.getClassByName(e,!0).getEdges()},Fu);function Fu(){}var gE=(Gc.prototype.getHoveredElement=function(){return this.modules.captor.getPointedElement()},Gc.prototype.getPointerInformation=function(){return this.modules.captor.getCursorInformation()},Gc);function Gc(){}var xm=(bm.initNamespace=function(e){var t;e.debug=(t=e,{wait:function(n){return new Promise(function(i){return setTimeout(i,n)})},initRandomGraph:function(n){return t.generate.random(n).then(t.setGraph).then(function(){return t.view.locateGraph()}).then(function(){return t.view.afterNextFrame()})},initGrid:function(n){var i=Math.ceil(Math.sqrt(n));return t.generate.grid({rows:i,columns:i}).then(function(r){return t.setGraph(r)}).then(function(){return t.view.locateGraph()})},initLine:function(n){return t.setGraph({nodes:[{id:0,attributes:{x:0,y:0}},{id:1,attributes:n?{x:0,y:50}:{x:50,y:0}}],edges:[{id:0,source:1,target:0}]}),t.view.locateGraph()},initSingleNode:function(){return t.setGraph({nodes:[{id:0,attributes:{x:0,y:0}}],edges:[]}),t.view.locateGraph()},initContinuousRenderLoop:function(n){var i=void 0===n?{}:n,r=i.triggerKey,o=void 0===r?"r":r,a=i.start,s=void 0===a||a,l=function(){s&&t.modules.dom.beforeNextFrame().then(l)};document.addEventListener("keydown",function(u){u.key===o&&(s=!s,l())}),l()},appendToBody:function(){var n=document.createElement("div");n.style.position="absolute",n.style.top="0",n.style.left="0",n.style.bottom="0",n.style.right="0",document.body.appendChild(n),t.setContainer(n)},loadFile:function(n){return(n.endsWith(".gexf")?t.parse.gexfFromUrl(n):t.parse.jsonFromUrl(n)).then(function(i){return t.setGraph(i)}).then(function(){return t.view.locateGraph()}).then(function(){return t.view.afterNextFrame()})},enableLasso:function(n){t.events.onDragStart(function(){t.keyboard.isKeyPressed("ctrl")&&t.tools.lasso.enable(n)})},randomizeGraph:function(n){var i=void 0===n?{}:n,r=i.minX,o=void 0===r?0:r,a=i.minY,s=void 0===a?0:a,l=i.maxX,u=void 0===l?500:l,d=i.maxY,c=void 0===d?500:d;return t.getNodes().setAttributes(t.getNodes().map(function(){return{x:o+Math.random()*(u-o),y:s+Math.random()*(c-s)}}))}})},bm);function bm(){}var _E=(qc.prototype.setContainer=function(e){this.modules.dom.setContainer(e)},qc.prototype.getContainer=function(){return this.modules.dom.getContainer()},qc);function qc(){}var Em=(Sm.initNamespace=function(e){var t;e.events=(t=e,{removeListener:function(n){t.modules.events.removeListener(n)},onNodesAdded:function(n){return t.modules.events.on(x.ADD_NODES,n),t},onBeforeNodesRemoved:function(n){return t.modules.events.on(x.BEFORE_REMOVE_NODES,n),t},onNodesRemoved:function(n){return t.modules.events.on(x.REMOVE_NODES,n),t},onEdgesAdded:function(n){return t.modules.events.on(x.ADD_EDGES,n),t},onBeforeEdgesRemoved:function(n){return t.modules.events.on(x.BEFORE_REMOVE_EDGES,n),t},onEdgesRemoved:function(n){return t.modules.events.on(x.REMOVE_EDGES,n),t},onNodesClassAdded:function(n,i){return t.modules.classes.onNodeClassAdded(n,i),t},onNodesClassRemoved:function(n,i){return t.modules.classes.onNodeClassRemoved(n,i),t},onEdgesClassAdded:function(n,i){return t.modules.classes.onEdgeClassAdded(n,i),t},onEdgesClassRemoved:function(n,i){return t.modules.classes.onEdgeClassRemoved(n,i),t},onNodeDragStart:function(n){return t.modules.events.on(x.NODES_DRAG_START,n),t},onNodeDragProgress:function(n){return t.modules.events.on(x.NODES_DRAG_PROGRESS,n),t},onNodeDragEnd:function(n){return t.modules.events.on(x.NODES_DRAG_END,n),t},onKeyPress:function(n,i){return t.modules.keyboard.onKeyPress(n,i),t},onNodesSelected:function(n){return t.events.onNodesClassAdded(yi,n)},onNodesUnselected:function(n){return t.events.onNodesClassRemoved(yi,n)},onEdgesSelected:function(n){return t.events.onEdgesClassAdded(yi,n)},onEdgesUnselected:function(n){return t.events.onEdgesClassRemoved(yi,n)},onNodeDataChange:function(n){return t.modules.events.on(x.UPDATE_NODE_DATA,n),t},onEdgeDataChange:function(n){return t.modules.events.on(x.UPDATE_EDGE_DATA,n),t},onMouseMove:function(n){return t.modules.events.on(x.MOVE,n),t},onMouseButtonDown:function(n){return t.modules.events.on(x.DOWN,n),t},onMouseButtonUp:function(n){return t.modules.events.on(x.UP,n),t},onClick:function(n){return t.modules.events.on(x.CLICK,n),t},onDoubleClick:function(n){return t.modules.events.on(x.DOUBLE_CLICK,n),t},onMouseWheel:function(n){return t.modules.events.on(x.WHEEL,n),t},onHover:function(n){return t.modules.events.on(x.HOVER,n),t},onUnhover:function(n){return t.modules.events.on(x.UNHOVER,n),t},onDragStart:function(n){return t.modules.events.on(x.DRAG_START,n),t},onDragProgress:function(n){return t.modules.events.on(x.DRAG_PROGRESS,n),t},onDragEnd:function(n){return t.modules.events.on(x.DRAG_END,n),t},onGestureStart:function(n){return t.modules.events.on(x.GESTURE_START,n),t},onGestureProgress:function(n){return t.modules.events.on(x.GESTURE_PROGRESS,n),t},onGestureEnd:function(n){return t.modules.events.on(x.GESTURE_END,n),t},onRendererStateChange:function(n){return t.modules.events.on(x.RENDERER_STATE_CHANGE,n),t},onZoomProgress:function(n){return t.modules.events.on(x.CAMERA_ZOOM,n),t},onViewChanged:function(n){return t.modules.events.on(x.VIEW_CHANGED,n),t},onNodesConnected:function(n){return t.modules.events.on(x.CONNECT_NODES,n),t},onGeoModeEnabled:function(n){return t.modules.events.on(x.GEO_ENABLED,n),t},onGeoModeDisabled:function(n){return t.modules.events.on(x.GEO_DISABLED,n),t},onGeoModeLoaded:function(n){return t.modules.events.on(x.GEO_LOADED,n),t},onLayoutStart:function(n){return t.modules.events.on(x.LAYOUT_START,n),t},onLayoutComplete:function(n){return t.modules.events.on(x.LAYOUT_END,n),t},onLayoutComputed:function(n){return t.modules.events.on(x.LAYOUT_COMPUTED,n),t},onTooltipShown:function(n){return t.modules.events.on(x.TOOLTIP_SHOW,n),t},onTooltipHidden:function(n){return t.modules.events.on(x.TOOLTIP_HIDE,n),t}})},Sm);function Sm(){}function Am(e){return e instanceof _o?e.getId():e}function wm(e){return e instanceof ia?e.getId():e}function Cm(e){return e instanceof or?e.getId():e instanceof _o?[e.getId()]:ui(e)?e.map(Am):[Am(e)]}function Tm(e){return e instanceof vs?e.getId():e instanceof ia?[e.getId()]:ui(e)?e.map(wm):[wm(e)]}function Gs(e,t,n){if(null!=e)return Array.isArray(e)?e[0]:"source"===e?Gs(n.color.get(t.getSource()._index)):"target"===e?Gs(n.color.get(t.getTarget()._index)):e}function Hc(e){return null==e?null:"string"==typeof e||"number"==typeof e?""+e:e&&Hc(e.content)}var mE=["color","radius","shape","text.content","x","y"],vE=["color","width","shape.type","text.content"];function Mm(e,t,n,i){var r,o,a,s,l=(o=i,(r=t)?Cm(r):"object"==typeof o?Cm(o.nodes):o),u=(s=i,(a=n)?Tm(a):"object"==typeof s?Tm(s.edges):s);return{nodes:e.getNodes(l),edges:e.getEdges(u)}}function Im(e,t){var n=t.nodeAttributes,i=t.edgeAttributes,s=t.nodeData,l=t.edgeData,u=Mm(e,t.nodes,t.edges,t.filter);return{nodes:u.nodes.toJSON({attributes:n,data:s}),edges:u.edges.toJSON({attributes:i,data:l})}}function $l(e,t,n){var i,r,o,a,s,l=n.styles,u=n.nodes,d=n.edges,c=n.filter,g="all"!==l?{nodes:["x","y"],edges:[]}:{nodes:mE,edges:vE},m=Im(e,{nodeAttributes:g.nodes,edgeAttributes:g.edges,nodes:u,edges:d,filter:c,nodeData:n.nodeData,edgeData:n.edgeData});if("original"===l){for(var b=(i=t,o=(r=Mm(e,u,d,c)).nodes,a=r.edges,s=i.getOriginalAttributes(),{nodes:o.reduce(function(N,P){return N[P.getId()]={x:s.nodes.x.get(P._index),y:s.nodes.y.get(P._index),color:Gs(s.nodes.color.get(P._index)),radius:s.nodes.radius.get(P._index),shape:s.nodes.shape.get(P._index),text:{content:s.nodes.text.content.get(P._index)}},N},{}),edges:a.reduce(function(N,P){return N[P.getId()]={color:Gs(s.edges.color.get(P._index)),width:s.edges.width.get(P._index),shape:{type:s.edges.shape.type.get(P._index)},text:{content:s.edges.text.content.get(P._index)}},N},{})}),v=0,y=m.nodes;v<y.length;v++){var S=y[v];S.attributes=b[S.id]}for(var A=0,C=m.edges;A<C.length;A++){var O=C[A];O.attributes=b[O.id]}}return"all"===l&&m.edges.forEach(function(N){var F=N.target,L=N.attributes;"source"===L.color&&(L.color=e.getNode(N.source).getAttribute("color")),"target"===L.color&&(L.color=e.getNode(F).getAttribute("color"))}),function(e){return{nodes:e.nodes.map(function(t){var i=t.attributes,r=void 0===i?{}:i,o=t.data,s=r.radius,l=r.shape,u=r.text;return{id:t.id,x:r.x,y:r.y,color:Gs(r.color),size:s,shape:l,text:Hc(u),data:o}}),edges:e.edges.map(function(t){var o=t.attributes,a=void 0===o?{}:o,s=t.data,u=a.width,d=a.text,c=a.shape;return{id:t.id,source:t.source,target:t.target,color:Gs(a.color),size:u,shape:function(h){if(null!=h)return"string"==typeof h?h:h.type}(c),text:Hc(d),data:s}})}}(m)}function km(e,t){return null==e||Array.isArray(e)&&!e.length?t:e}function xE(e){return"string"==typeof e}function bE(e,t,n,i){for(var r="edges"===t,o={},a=function(u){var d=f(km(n(u),t));if(!d.every(xE))throw Error("The tab "+t+" function returned an invalid value.");var c=f(i(u.data,d));d.forEach(function(h,p){var g=km(c[p],{}),m=rl(Mt({},g,{id:u.id},r?{source:u.source,target:u.target}:{})).reduce(function(b,v){var S=v.value;return b[v.path.join(".")]=S,b},{});o[h]=o[h]||[],o[h].push(m)})},s=0,l=e;s<l.length;s++)a(l[s]);return o}function EE(e){if(!e.length)return[];for(var t=function(l){for(var u=Mt({},l[0]),d=0,c=l;d<c.length;d++)for(var p=0,g=Object.keys(c[d]);p<g.length;p++){var m=g[p];m in u||(u[m]=void 0)}return Object.keys(u)}(e),n=-1<t.indexOf("source")?["id","source","target"]:["id"],i=n.concat(t.filter(function(l){return-1===n.indexOf(l)})),r=[i],o=function(l){r.push(i.map(function(u){return l[u]}))},a=0,s=e;a<s.length;a++)o(s[a]);return r}function AE(e){return{csv:function(t){var n=on("string"==typeof t?{what:t}:t,wE),i=n.what,r=n.dataProperties,s=n.separator,l=n.textSeparator,u=n.download,h=n.filename,g=$l(e.modules.graph,e.modules.individualAttributes,{styles:"none",nodes:n.nodes,edges:n.edges,filter:n.filter,nodeData:n.nodeData,edgeData:n.edgeData});try{var m=function(b,v){var y=v.what,S=v.separator,A=v.textSeparator,C=v.dataProperties,O=new RegExp(""+A,"g");if(A&&'"'!==A&&"'"!==A)throw new TypeError('Invalid argument :"textSeparator" is not single-quote or double-quote, was '+A);if("nodes"!==y&&"edges"!==y)throw new TypeError('missing argument: "what": should have value "nodes" or "edges"');var P="nodes"===y;return function(e,t,n){for(var i=new Ap,r=t?1:3,o=[],a=function(u){var d=e[u],c=new Array(r),h=d.data;if(n){var p={};n.forEach(function(S){var A=Pr(S),C=function(O,N){for(var P=0;P<N.length;++P){if(null==O)return;O=O[N[P]]}return O}(h,A);!function(O,N,P){for(var F=0;F<N.length-1;++F){var L=N[F],B=O[L];void 0===B&&(O[L]=B={}),O=B}O[N[N.length-1]]=P}(p,A,C)}),h=p}var g=rl(h);c[0]=d.id,t||(c[1]=d.source,c[2]=d.target);for(var m=0;m<g.length;++m){var b=g[m],v=b.path,y=b.value;v.length&&(i.has(v)?c[i.get(v)]=y:(i.set(v,r),c[r]=y,r++))}o.push(c)},s=0;s<e.length;++s)a(s);var l=[];return l.push("id"),t||(l.push("source"),l.push("target")),i.keys().forEach(function(u){return l.push(u[u.length-1])}),o.unshift(l),o.forEach(function(u){return u.length=r}),o}(P?b.nodes:b.edges,P,C).map(function(F){return F.map(function(L){return function(F){return F=(L=F)instanceof Date?L.toISOString():""+L,A+F.replace(O,"\\$&")+A;var L}(L)})}).map(function(F){return F.join(S)}).join("\n")}(g,{what:i,separator:s,textSeparator:l,dataProperties:r});return u&&cn(m,h,"text"),Promise.resolve(m)}catch(b){return Promise.reject(b)}}}}var wE={what:void 0,dataProperties:void 0,separator:",",textSeparator:'"',download:!0,filename:"graph.csv",filter:"visible",nodes:void 0,edges:void 0,nodeData:function(e){return e},edgeData:function(e){return e},styles:"none"};var TE={creator:void 0,description:void 0,styles:"all",download:!0,filename:"graph.gexf",nodes:void 0,edges:void 0,nodeData:function(e){return e},edgeData:function(e){return e},filter:"visible"};function qs(e){return Math.round(255*e)}function Om(e,t){if("integer"===t&&"number"==typeof e){if(e%1!=0)return"float"}else if("number"!=typeof e)return"boolean"==typeof e?"boolean":"string";return t}function Wc(e){return"object"==typeof e&&null!==e&&e.constructor===Object}function Yc(e,t){return void 0===t&&(t={}),ft(e,function(n,i){Wc(n)?Yc(n,t):t[i]=n}),t}function ME(e){return{graphml:function(t){void 0===t&&(t={});var n=on(t,IE),i=n.styles,a=n.download,s=n.filename,l=n.graphId,u=n.directedEdges,p=function(g,m){var b=new ou,v=Lp();function y(X){return b.toHexa(X)}function A(X,ae,ie,U,W){ie=ie||{};var ce=v.createElement(ae);for(var he in ie)if(ie.hasOwnProperty(he)){var Ee=ie[he];void 0!==Ee&&ce.setAttribute(he,Ee)}return void 0===U&&!W||("[object Object]"===Object.prototype.toString.call(U)&&(U=JSON.stringify(U)),ce.appendChild(v.createTextNode(U))),X.appendChild(ce),ce}var C=["id","source","target"],O=["size","x","y","shape","text","color"],N={size:{for:"all",type:"double"},x:{for:"node",type:"double"},y:{for:"node",type:"double"},shape:{for:"all",type:"string"},color:{for:"all",type:"string"},r:{for:"all",type:"int"},g:{for:"all",type:"int"},b:{for:"all",type:"int"},a:{for:"all",type:"double"},text:{for:"all",type:"string"}};m.noStyles&&(delete N.color,delete N.r,delete N.g,delete N.b,delete N.a,delete N.shape,O.pop());var P=[],F=[];function L(X,ae){var ie={id:X.id};O.forEach(function(U){var W=X[U];"y"===U&&W&&(W=-parseFloat(W)),void 0!==W&&(ie[("edge"===ae?"edge_":"")+U]=W,"color"===U&&function(X,ae){var U=b.parseColor(ae);X.r=U[0],X.g=U[1],X.b=U[2]}(ie,W))}),ft(X.data||{},function(U,W){-1===O.indexOf(W)&&-1===C.indexOf(W)&&(N[W]?N[W].for!==ae&&(N[W].for="all"):N[W]={for:ae,type:"string"},ie[W]=U)}),"edge"===ae?(ie.source=X.source,ie.target=X.target,F.push(ie)):P.push(ie)}g.nodes.forEach(function(X){return L(X,"node")}),g.edges.forEach(function(X){return L(X,"edge")});var B=A(v,"graphml",{xmlns:"http://graphml.graphdrawing.org/xmlns","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xsi:schemaLocation":"http://graphml.graphdrawing.org/xmlns http://www.yworks.com/xml/schema/graphml/1.1/ygraphml.xsd","xmlns:y":"http://www.yworks.com/xml/graphml","xmlns:java":"http://www.yworks.com/xml/yfiles-common/1.0/java","xmlns:sys":"http://www.yworks.com/xml/yfiles-common/markup/primitives/2.0","xmlns:x":"http://ww.yworks.com/xml/yfiles-common/markup/2.0"});ft(N,function(X,ae){"node"!==X.for&&"all"!==X.for||A(B,"key",{"attr.name":ae,"attr.type":X.type,for:"node",id:ae}),"edge"!==X.for&&"all"!==X.for||A(B,"key",{"attr.name":ae,"attr.type":X.type,for:"edge",id:"edge_"+ae})}),A(B,"key",{id:"nodegraphics",for:"node","yfiles.type":"nodegraphics","attr.type":"string"}),A(B,"key",{id:"edgegraphics",for:"edge","yfiles.type":"edgegraphics","attr.type":"string"});var Y=A(B,"graph",{edgedefault:m.directedEdges||void 0===m.directedEdges?"directed":"undirected",id:m.graphId?m.graphId:"G","parse.nodes":g.nodes.length,"parse.edges":g.edges.length,"parse.order":"nodesfirst"});return P.forEach(function(X){var U,W,ce,ae=A(Y,"node",{id:X.id});U=X,W=A(ae,"data",{key:"nodegraphics"}),ce=A(W,"y:ShapeNode"),A(ce,"y:Geometry",{x:U.x,y:U.y,width:U.size,height:U.size}),m.noStyles||A(ce,"y:Fill",{color:y(U.color),transparent:!1}),A(ce,"y:NodeLabel",null,U.text||""),A(ce,"y:Shape",{type:U.shape}),ft(X,function(ie,U){-1===C.indexOf(U)&&A(ae,"data",{key:U},ie,!0)})}),F.forEach(function(X){var ae,ie,U,W=A(Y,"edge",{id:X.id,source:X.source,target:X.target});ae=X,ie=A(W,"data",{key:"edgegraphics"}),U=A(ie,"y:PolyLineEdge"),A(U,"y:LineStyle",{type:ae.edge_type,color:m.noStyles?void 0:y(ae.edge_color),width:ae.edge_size}),A(U,"y:EdgeLabel",null,ae.edge_label),ft(X,function(ce,he){-1===C.indexOf(he)&&A(W,"data",{key:he},ce,!0)})}),'<?xml version="1.0" encoding="UTF-8"?>\n'+Pd(v)}($l(e.modules.graph,e.modules.individualAttributes,{styles:i,nodes:n.nodes,edges:n.edges,filter:n.filter,nodeData:n.nodeData,edgeData:n.edgeData}),{graphId:l,directedEdges:u,noStyles:"none"===i});return a&&cn(p,s,"text"),Promise.resolve(p)}}}var IE={graphId:"G",directedEdges:!0,styles:"all",download:!0,filename:"graph.graphml",nodes:void 0,edges:void 0,nodeData:function(e){return e},edgeData:function(e){return e},filter:"visible"},kE={nodeAttributes:["x","y","color","radius","shape","text"],edgeAttributes:["color","width","text"],nodeData:function(e){return e},edgeData:function(e){return e},filter:"visible",pretty:!1,download:!0,filename:"graph.json"};function Nm(e,t){var n=e.view.get(),i="number"==typeof t.margin?t.margin:0,r={pixelRatio:1,angle:0,backgroundColor:null,zoom:0,x:0,y:0,width:0,height:0,hideImages:!1};if(t.width&&t.height?(r.width=t.width,r.height=t.height):(r.width=n.width,r.height=n.height),t.clip)r.zoom=n.zoom,r.x=n.x,r.y=n.y;else{var o=e.getNodes(t.filter),a=o.getBoundingBox().computeForZoom(n.zoom).extend(Cr.fromValues(o.getAttribute("x"),o.getAttribute("y"),o.map(function(p){return p.getAttribute("radius")+p.getAttribute("innerStroke.width")+p.getAttribute("outerStroke.width")})));if(t.texts){var s=e.modules.labels.getTextsBoundingBox();s.isValid()&&a.extend(s)}if(!isFinite(t.width)||!isFinite(t.height)){var l=e.view.graphToScreenCoordinates(a.bottomLeft()),u=e.view.graphToScreenCoordinates(a.topRight()),d=u.x-l.x,c=u.y-l.y,h=Math.min(r.width/d,r.height/c);r.width=d*h,r.height=c*h}r.x=a.cx,r.y=a.cy,r.width=Math.max(r.width,2*i+1),r.height=Math.max(r.height,2*i+1),r.zoom=Math.min((r.width-2*i)/a.width,(r.height-2*i)/a.height)}return e.modules.geo.isEnabled()?r.backgroundColor=null:void 0!==t.background&&(r.backgroundColor=t.background),r}function Xc(e,t,n,i,r){void 0===r&&(r=!1);var o=Mt({},n,{renderBackground:!1,hideImages:r,angle:n.angle||0,isBufferDisplayable:function(l){return t.texts||!Df(l)}}),a={};if(!1===t.badges){var s={text:null,image:null};a.badges={topLeft:s,topRight:s,bottomRight:s,bottomLeft:s}}return e.styles.getClass(Qa).update({nodeAttributes:a}),e.modules.graphics.export(i,o,t.filter,t)}function ed(e){return{download:!0,filter:"visible",filename:"graph."+e,clip:!1,margin:10,width:void 0,height:void 0,background:null,badges:!0,legend:void 0,texts:!0,images:!0,textWatermark:{content:null,fontFamily:"Arial",fontSize:48,fontStyle:null,fontColor:"red",repeat:!1,angle:0,alpha:.65,space:50,x:void 0,y:void 0},imageWatermark:{url:null,width:void 0,height:void 0,repeat:!1,angle:0,alpha:.65,space:50,x:void 0,y:void 0},imageCrossOrigin:void 0}}var OE={png:ed("png"),jpg:ed("jpg"),tiff:ed("tiff"),gif:ed("gif")};function NE(e){var t=e.canvas,n=e.parameters;return n.textWatermark.content&&Fm(t,n.textWatermark,RE,zE),n.imageWatermark.url?_s(n.imageWatermark.url).then(function(i){return i&&(n.imageWatermark.content=i,Fm(t,n.imageWatermark,VE,BE)),e}):e}function LE(e){var n=e.canvas,i=e.parameters,r=e.ogma.modules.legend,o=null;return void 0===i.legend&&(o=!!r.enabled()&&r.getCurrentOptions()),!0===i.legend&&(o={}),o&&r.exportOnCanvas(n,o),e}function FE(e){var t=e.ogma,n=e.view;return t.modules.geo.isEnabled()?t.modules.geo.exportBackground(n).then(function(i){var r=Lm(e.view),o=r.getContext("2d");return o.drawImage(i,(n.width-i.width)/2,(n.height-i.height)/2),o.drawImage(e.canvas,0,0),e.canvas=r,e}):e}function PE(e){var t=e.ogma,n=e.parameters,r=e.view,o=e.canvas.getContext("2d");return Xc(t,n,r,"canvas",!n.images).then(function(a){try{return a.getContext("2d").getImageData(0,0,1,1),o.drawImage(a,0,0),e}catch(s){return eo(s),Xc(t,n,r,"canvas",!0).then(function(l){return o.drawImage(l,0,0),e})}})}function DE(e){var n=e.parameters,r=e.canvas.toDataURL("image/"+e.type);return n.download&&cn(r,n.filename,"dataURL"),r}function Lm(e){var t=e.width,n=e.height,i=di();return i.width=t,i.height=n,i}function td(e,t,n){null===(t=on(t,OE[n])).background&&(t.background=e.modules.graphics.getTransparentBackgroundColor());var i=Nm(e,t),r={ogma:e,parameters:t,canvas:Lm(i),view:i,type:n};return Promise.resolve(r).then(FE).then(PE).then(NE).then(LE).then(DE)}function RE(e,t,n,i){e.textAlign="center",e.textBaseline="middle",e.fillText(t,n,i)}function zE(e,t,n){return{width:e.measureText(t).width,height:n}}function BE(e,t,n,i,r){return{width:void 0===i?t.width:i,height:void 0===r?t.height:r}}function VE(e,t,n,i,r,o){e.drawImage(t,n-r/2,i-o/2,r,o)}function Fm(e,t,n,i){if(t){if("object"!=typeof t)t={content:t};else if(!t.content)return;var r=t.fontFamily,o=t.fontSize,a=t.fontStyle,s=t.fontColor,l=t.repeat,u=t.angle,d=t.alpha,c=t.space,h=t.content,p=e.getContext("2d"),g=e.width,m=e.height,b=void 0===t.x?g/2:t.x,v=void 0===t.y?m/2:t.y,y=t.height,S=t.width;u=u/180*Math.PI,ca(p,r,o,a),p.fillStyle=s,p.globalAlpha=d;var A=i(p,h,o,S,y);if(l){var C=A.width+c,O=A.height+c,N=Math.sqrt(g*g+m*m);p.save(),p.translate(0,0),p.rotate(u);for(var P=0;P<N;P+=C)for(var F=0;F<N;F+=O)n(p,h,P,F,A.width,A.height),0!==F&&n(p,h,P,-F,A.width,A.height);p.restore()}else p.save(),p.translate(b,v),p.rotate(u),n(p,h,0,0,A.width,A.height),p.restore()}}var jE={download:!0,filename:"graph.svg",width:void 0,height:void 0,background:null,texts:!0,images:!0,badges:!0,embedFonts:!1,clip:!1,margin:10,prefix:"ogma"};var GE={what:void 0,dataProperties:void 0,filter:"visible",nodes:void 0,edges:void 0,download:!0,filename:"graph.xlsx",tab:void 0,nodeData:void 0,edgeData:void 0};function qE(e,t){for(var n,i={},r={s:{c:1e7,r:1e7},e:{c:0,r:0}},o=0;o!==t.length;++o)for(var a=t[o],s=0;s!==a.length;++s){var l=a[s];r.s.r>o&&(r.s.r=o),r.s.c>s&&(r.s.c=s),r.e.r<o&&(r.e.r=o),r.e.c<s&&(r.e.c=s);var u={v:void 0===(n=l)?"":n instanceof Date?n.toISOString():""+n};i[e.utils.encode_cell({c:s,r:o})]=u}return r.s.c<1e7&&(i["!ref"]=e.utils.encode_range(r)),i}var HE=function(){this.SheetNames=[],this.Sheets={}};function WE(e){return e.styles.createClass({name:Qa,isBuiltin:!0}),Mt({},AE(e),function(e){return{gexf:function(t){void 0===t&&(t={});var n=on(t,TE),a=n.download,s=n.filename,l=n.creator,u=n.description,p=function(g,m){var b,v=new ou,y=Np(),S={},A={},C=0,O=0,N=y.createElement("gexf");N.setAttribute("xmlns","http://www.gexf.net/1.2draft"),N.setAttribute("xmlns:viz","http://www.gexf.net/1.2draft/viz"),N.setAttribute("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance"),N.setAttribute("xsi:schemaLocation","http://www.gexf.net/1.2draft http://www.gexf.net/1.2draft/gexf.xsd"),N.setAttribute("version","1.2");var P=y.createElement("meta");if(P.setAttribute("lastmodifieddate",V()),m.creator){var F=y.createElement("creator");b=y.createTextNode(""+m.creator),F.appendChild(b),P.appendChild(F)}if(m.description){var L=y.createElement("description");b=y.createTextNode(""+m.description),L.appendChild(b),P.appendChild(L)}var B=y.createElement("graph");B.setAttribute("mode","static");var Y=y.createElement("nodes");g.nodes.forEach(function(U){var W=y.createElement("node");if(W.setAttribute("id",String(U.id)),U.text&&W.setAttribute("label",Sr(U.text)),Wc(U.data)){var ce=Yc(U.data),he=y.createElement("attvalues");Object.keys(ce).forEach(function(We){We in S||(S[We]={id:C,type:"integer"},C++);var _t=ce[We];S[We].type=Om(_t,S[We].type);var wt=y.createElement("attvalue");wt.setAttribute("for",S[We].id),wt.setAttribute("value",Sr(_t)),he.appendChild(wt)}),W.appendChild(he)}if(U.color){var Ee=v.parseColor(U.color),Te=y.createElement("viz:color");Te.setAttribute("r",qs(Ee[0])),Te.setAttribute("g",qs(Ee[1])),Te.setAttribute("b",qs(Ee[2])),Te.setAttribute("a",Ee[3]),W.appendChild(Te)}var it=y.createElement("viz:position");if(it.setAttribute("x",U.x),it.setAttribute("y",-U.y),W.appendChild(it),U.size){var rt=y.createElement("viz:size");rt.setAttribute("value",U.size),W.appendChild(rt)}Y.appendChild(W)});var X=y.createElement("attributes");X.setAttribute("class","node"),Object.keys(S).forEach(function(U){var W=y.createElement("attribute");W.setAttribute("id",S[U].id),W.setAttribute("title",U),W.setAttribute("type",S[U].type),X.appendChild(W)});var ae=y.createElement("edges");g.edges.forEach(function(U){var W=y.createElement("edge");if(W.setAttribute("id",U.id.toString()),W.setAttribute("source",U.source),W.setAttribute("target",U.target),U.size&&W.setAttribute("weight",U.size),U.text&&W.setAttribute("label",Sr(U.text)),Wc(U.data)){var ce=Yc(U.data),he=y.createElement("attvalues");Object.keys(ce).forEach(function(rt){rt in A||(A[rt]={id:O,type:"integer"},O++);var We=ce[rt];A[rt].type=Om(We,A[rt].type);var _t=y.createElement("attvalue");_t.setAttribute("for",A[rt].id),_t.setAttribute("value",Sr(We)),he.appendChild(_t)}),W.appendChild(he)}if(U.color){var Ee=v.parseColor(U.color),Te=y.createElement("viz:color");Te.setAttribute("r",qs(Ee[0])),Te.setAttribute("g",qs(Ee[1])),Te.setAttribute("b",qs(Ee[2])),Te.setAttribute("a",Ee[3]),W.appendChild(Te)}if(U.size){var it=y.createElement("viz:size");it.setAttribute("value",U.size),W.appendChild(it)}ae.appendChild(W)});var ie=y.createElement("attributes");return ie.setAttribute("class","edge"),Object.keys(A).forEach(function(U){var W=y.createElement("attribute");W.setAttribute("id",A[U].id),W.setAttribute("title",U),W.setAttribute("type",A[U].type),ie.appendChild(W)}),B.appendChild(X),B.appendChild(ie),B.appendChild(Y),B.appendChild(ae),N.appendChild(P),N.appendChild(B),y.appendChild(N),'<?xml version="1.0" encoding="UTF-8"?>'+y.serialize()}($l(e.modules.graph,e.modules.individualAttributes,{styles:n.styles,nodes:n.nodes,edges:n.edges,filter:n.filter,nodeData:n.nodeData,edgeData:n.edgeData}),{creator:l,description:u});return a&&cn(p,s,"text"),Promise.resolve(p)}}}(e),ME(e),{json:function(i){void 0===i&&(i={});var r=on(i,kE),d=r.pretty,c=r.download,h=r.filename,p=Im(n.modules.graph,{nodeAttributes:r.nodeAttributes,edgeAttributes:r.edgeAttributes,filter:r.filter,nodeData:r.nodeData,edgeData:r.edgeData}),g=d?JSON.stringify(p,null," "):JSON.stringify(p);return c&&cn(g,h,"text"),Promise.resolve(g)}},{png:function(i){return void 0===i&&(i={}),td(t,i,"png")},jpg:function(i){return void 0===i&&(i={}),td(t,i,"jpg")},tiff:function(i){return void 0===i&&(i={}),td(t,i,"tiff")},gif:function(i){return void 0===i&&(i={}),td(t,i,"gif")}},function(e){return{svg:function(t){return void 0===t&&(t={}),function(n,i){var r=(i=on(i,jE)).background,o=i.filename,a=i.download;null===r&&(i.background=n.modules.graphics.getTransparentBackgroundColor());var l=Nm(n,i);return Xc(n,i,l,"svg",!i.images).then(function(u){return u.removeAttribute("pointer-events"),u.setAttribute("version","1.1"),u.setAttributeNS(Qn,"xmlns",ea),u.setAttributeNS(Qn,"xmlns:xlink",He),u}).then(function(u){return function(d,c,h){for(var p=c.childNodes[2],g=p.childNodes,m={},b=h.prefix,v=0;v<g.length;v++){var y=(U=g[v]).getAttribute(no);m[y]=m[y]||[],m[y].push(U)}var S=Object.keys(m),A=d.modules.graph,C=A.getNodeAttribute("id"),O=A.getEdgeAttribute("id"),N=hn("g",{class:b+"-edges"}),P=hn("g",{class:b+"-nodes"});for(v=0;v<S.length;v++){var F=S[v],L="n"===F.charAt(0),B=parseInt(F.substring(1)),Y=m[F],X=Sr((L?C:O).get(B).toString()),ae=hn("g");ae.setAttribute("data-"+(L?"node":"edge")+"-id",X),ae.setAttribute("class",b+"-"+(L?"node":"edge"));for(var ie=0;ie<Y.length;ie++){var U=Y[ie];ae.appendChild(U),U.removeAttribute(no)}(L?P:N).appendChild(ae)}return p.appendChild(N),p.appendChild(P),c}(n,u,i)}).then(function(u){return c=i,h=function(p){for(var g=[].concat(Array.prototype.slice.call(p.getElementsByTagName("text")||[]),Array.prototype.slice.call(p.getElementsByTagName("tspan")||[])),m=[],b={},v=0;v<g.length;v++){var y=g[v].getAttribute("font-family");if("string"==typeof y)for(var S=y.split(","),A=0;A<S.length;A++){var C=S[A].replace(/['"]/g,"");""===C||b[C]||(b[C]=!0,m.push(C))}}return{list:m,map:b}}(d=u).map,xp().then(function(p){return p.filter(function(g){return h[g.name]})}).then(function(p){return bp(p,!!c.embedFonts)}).then(function(p){if(0!==p.length){for(var g=hn("style"),m=0;m<p.length;m++)g.appendChild(ta(p[m]));d.childNodes[0].appendChild(g)}return d});var d,c,h}).then(function(u){var d='<?xml version="1.0" encoding="utf-8"?>'+Pd(u);return a&&cn(d,o,"text/xml"),d})}(e,t)}}}(t=n=e),function(e){return{xlsx:function(t){"string"==typeof t&&(t={what:t});var n=on(t,GE),i=n.what,r=n.nodes,o=n.edges,a=n.tab,s=void 0===a?{nodes:void 0,edges:void 0}:a,l=n.download,u=n.filename,d=n.dataProperties,c=n.filter,h=n.nodeData,p=n.edgeData;s.nodes||(s.nodes=function(){return"nodes"}),s.edges||(s.edges=function(){return"edges"});var g=function(m,b){var v=b.what,y=b.tabFunctions,S=b.tabContentFunctions,A=xi("XLSX")||xi("xlsx",{throwOnError:!0}),C=new HE;if(v){if("nodes"!==v&&"edges"!==v)throw new TypeError('Invalid argument: "what" is not "nodes" or "edges", was '+v);"nodes"===v&&(m.edges=[]),"edges"===v&&(m.nodes=[])}for(var O={},N=0,P=["nodes","edges"];N<P.length;N++)for(var F=P[N],L=bE(m[F],F,y[F],S[F]),B=0,Y=Object.keys(L);B<Y.length;B++){var X=Y[B];O[X]=(O[X]||[]).concat(L[X])}for(var ae=0,ie=Object.keys(O);ae<ie.length;ae++)C.SheetNames.push(X=ie[ae]),C.Sheets[X]=qE(A,EE(O[X]));return ir([function(U){for(var W=new ArrayBuffer(U.length),ce=new Uint8Array(W),he=0;he!==U.length;++he)ce[he]=255&U.charCodeAt(he);return W}(A.write(C,{bookType:"xlsx",bookSST:!1,type:"binary"}))])}($l(e.modules.graph,e.modules.individualAttributes,{styles:"none",nodes:r,edges:o,filter:c,nodeData:function(m){return m},edgeData:function(m){return m}}),{what:i,tabFunctions:s,tabContentFunctions:{nodes:h||function(m){return za(Zt(m||{}),d)},edges:p||function(m){return za(Zt(m||{}),d)}}});return l&&cn(g,u,"blob"),Promise.resolve(g)}}}(e));var t,n}var Pm=(Dm.initNamespace=function(e){e.export=WE(e)},Dm);function Dm(){}var Rm_configure=function(e){var t,n=void 0===e?{}:e,i=n.children,r=void 0===i?2:i,o=n.height,a=void 0===o?3:o;if(!("number"==typeof(t=r)&&isFinite(t)&&0<t?t:void 0))throw new TypeError('Invalid argument: "children" is not a positive number, was '+r);if(!Un(a))throw new TypeError('Invalid argument: "height" is not a positive number, was '+a);return{children:r,height:a}},Rm_generate=function(e){var t=e.children,n=e.height;n+=1;for(var i=Math.pow(t,n),r=[],o=[],a=1,s=0,l=0,u=0;u<n;++u){for(var d=i/(a+1)/1.5,c=0;c<a;++c){var h=s++;if(r.push({id:h,attributes:{x:(c+1)*d*10,y:20*u}}),u!==n-1)for(var p=0;p<t;++p)o.push({id:l,source:h,target:h*t+p+1}),l+=1}a*=t}return{nodes:r,edges:o}},zm_configure=function(e){var t=void 0===e?{}:e,n=t.nodes,i=void 0===n?40:n,r=t.m0,o=void 0===r?5:r,a=t.m,s=void 0===a?1:a,l=t.scale,u=void 0===l?100:l;if(!va(i)||i<3)throw new TypeError("Invalid argument: options.nodes is not a number >= 3, was "+i);if(!va(o)||i<=o)throw new TypeError("Invalid argument: options.m0 is not a number < "+i+", was "+o);if(!va(o)||o<=s)throw new TypeError("Invalid argument: options.m is not a number <= "+o+", was "+s);if(!va(u)||u<0)throw new TypeError("Invalid argument: options.scale is not a number or is less than 0");return{nodes:i,m0:o,m:s,scale:u}},zm_generate=function(e){for(var t=e.scale,n=e.nodes,i=e.m0,r=e.m,o={nodes:[],edges:[]},a={},s=[],l=t/10,u=0,d=0;d<i;d++)o.nodes.push({id:d,attributes:{x:Math.random()*l,y:Math.random()*l}}),s[d]=0;for(d=0;d<i;d++)for(var c=d+1;c<i;c++)a[(v={id:u++,source:d,target:c}).source+"-"+v.target]=v,o.edges.push(v),s[d]++,s[c]++;for(d=i;d<n;d++){o.nodes.push({id:d,attributes:{x:Math.random()*t,y:Math.random()*t}});var h=s[d]=0;for(c=0;c<d;c++)h+=s[c];for(var p=0,g=0;g<r;g++){var m=Math.random(),b=0;for(c=0;c<d;c++)if(!a[d+"-"+c]&&!a[c+"-"+d]&&m<=(b=1===d?1:b+s[c]/h+p/(d-g))){var v;p+=s[c]/h,a[(v={id:u++,source:d,target:c}).source+"-"+v.target]=v,o.edges.push(v),s[d]++,s[c]++;break}}}return o},Bm_configure=function(e){var t=void 0===e?{}:e,n=t.nodes,i=void 0===n?20:n,r=t.edges,o=t.p,a=t.scale,s=void 0===a?100:a;if(!va(i)||i<3)throw new TypeError("Invalid argument: options.nodes is not a number >= 3, was "+i);if(void 0!==r&&void 0!==o)throw new TypeError("Invalid argument: choose between options.edges and options.p");return void 0===r&&void 0===o&&(o=.1),{nodes:i,edges:r,p:o,scale:s}},Bm_generate=function(e){var t={nodes:[],edges:[]},n=e.nodes,i=e.p,r=e.scale;if(0<=i)for(var o=0,a=0;a<n;a++){t.nodes.push({id:a,attributes:{x:Math.random()*r,y:Math.random()*r}});for(var s=0;s<a;s++)Math.random()<i&&t.edges.push({id:o++,source:a,target:s})}else{var l=[],u=e.edges;for(a=0;a<n;a++)for(t.nodes.push({id:a,attributes:{x:100*Math.random(),y:100*Math.random()}}),s=a+1;s<n;s++)l.push({source:a,target:s});for(o=l.length-1,a=0;a<u;a++){var d=l.splice(Math.floor(Math.random()*o),1)[0];d.id=a,t.edges.push(d),o--}}return t};function Vm(e){return 10*Math.pow(2.7,e)}function Um(e){return 5+Vm(e)/10}var jm_configure=function(e){var t=e.depth,n=void 0===t?3:t,i=e.breadth,r=void 0===i?3:i,o=e.nbNodes;return void 0!==o&&(r=5,n=Math.ceil(Math.log(o)/Math.log(5))),{depth:n,breadth:r,nbNodes:o}},jm_generate=function(e){var t=e.depth,n=e.breadth,i=e.nbNodes,r={id:0,attributes:{x:0,y:0,radius:Um(t+1)}},o={nodes:[r],edges:[]};return function a(s,l,u,d,c){if(0===u)return c;for(var h=Vm(u),p=Um(u),g=.2*p,m=-Math.PI,b=2*Math.PI/l,v=d.attributes.x,y=d.attributes.y,S=0;S<l;++S){var O={id:c,attributes:{x:v+h*Math.cos(m),y:y+h*Math.sin(m),radius:p}},N={id:c,source:d.id,target:c,attributes:{width:g}};s.nodes.push(O),s.edges.push(N),c=a(s,l,u-1,O,c+1),m+=b}return c}(o,n,t,r,1),void 0!==i&&(o.nodes=o.nodes.slice(0,i),o.edges=o.edges.slice(0,Math.max(i-1,0))),o},Zm_configure=function(e){var t=void 0===e?{}:e,n=t.rows,r=t.columns,a=t.columnDistance,l=t.rowDistance,d=t.xmin,h=t.ymin;return{rows:void 0===n?4:n,columns:void 0===r?4:r,columnDistance:void 0===a?20:a,rowDistance:void 0===l?20:l,xmin:void 0===d?0:d,ymin:void 0===h?0:h}},Zm_generate=function(e){for(var t=e.rows,n=e.columns,i=e.columnDistance,r=e.rowDistance,o=e.xmin,a=e.ymin,s={nodes:[],edges:[]},l=0,u=0;u<t;++u)for(var d=0;d<n;++d){var c=u*n+d;s.nodes.push({id:c,attributes:{x:o+d*i,y:a+u*r}}),d!==n-1&&(s.edges.push({id:l,source:c,target:u*n+d+1}),l++),u!==t-1&&(s.edges.push({id:l,source:c,target:(u+1)*n+d}),l++)}return s},Gm_configure=function(e){var t=void 0===e?{}:e,n=t.nodes,r=t.edges,a=t.texts,l=t.scale;return{nodes:void 0===n?10:n,edges:void 0===r?10:r,texts:void 0!==a&&a,scale:void 0===l?100:l}},Gm_generate=function(e){for(var t=e.nodes,n=e.edges,i=e.texts,r=e.scale,o=[],a=[],s=0;s<t;s++)o.push({id:s,attributes:{x:Math.random()*r,y:Math.random()*r,text:i?"Node "+s:void 0}});for(s=0;s<n;s++)a.push({id:s,source:Math.random()*t|0,target:Math.random()*t|0,attributes:{text:i?"Edge "+s:void 0}});return{nodes:o,edges:a}},qm_configure=function(e){var t=void 0===e?{}:e,n=t.nodes,i=void 0===n?50:n,r=t.width,o=void 0===r?100:r,a=t.height,s=void 0===a?100:a,l=t.x,u=void 0===l?0:l,d=t.y,c=void 0===d?0:d;if(!isFinite(i)||i<1)throw new RangeError("Tree generator: number of nodes must be a positive integer");return{nodes:i,width:o,height:s,x:u,y:c}},qm_generate=function(e){var t=e.nodes,r=e.width,o=e.height,a=e.x-r/2,s=e.y-o/2;return{nodes:new Array(t).fill(0).map(function(l,u){return{id:u,attributes:{x:a+Math.random()*r,y:s+Math.random()*o}}}),edges:new Array(t-1).fill(0).map(function(l,u){return{id:u,source:Math.floor(Math.sqrt(u)),target:u+1}})}},Hm_configure=function(e){var t=void 0===e?{}:e,n=t.length,r=t.scale;return{length:void 0===n?5:n,scale:void 0===r?100:r}},Hm_generate=function(e){var t=e.length,n=e.scale,i={nodes:[],edges:[]};if(t<=0)return i;i.nodes.push({id:0,attributes:{x:Math.random()*n,y:Math.random()*n}});for(var r=1;r<t;++r)i.nodes.push({id:r,attributes:{x:Math.random()*n,y:Math.random()*n}}),i.edges.push({id:r-1,source:r-1,target:r});return i},Wm=(Ym.initNamespace=function(e){e.generate={balancedTree:function(t){return Promise.resolve(Rm_generate(Rm_configure(t)))},barabasiAlbert:function(t){return Promise.resolve(zm_generate(zm_configure(t)))},erdosRenyi:function(t){return Promise.resolve(Bm_generate(Bm_configure(t)))},flower:function(t){return Promise.resolve(jm_generate(jm_configure(t)))},grid:function(t){return Promise.resolve(Zm_generate(Zm_configure(t)))},path:function(t){return Promise.resolve(Hm_generate(Hm_configure(t)))},random:function(t){return Promise.resolve(Gm_generate(Gm_configure(t)))},randomTree:function(t){return Promise.resolve(qm_generate(qm_configure(t)))}}},Ym);function Ym(){}var Xm=(Jm.initNamespace=function(e){var t;e.geo=(t=e,{enable:function(n){return t.modules.geo.enable(n)},disable:function(n){return t.modules.geo.disable(n)},setOptions:function(n){return t.modules.geo.setOptions(n)},getOptions:function(){return t.modules.geo.getOptions()},getMap:function(){return t.modules.geo.getMap()},enabled:function(){return t.modules.geo.isEnabled()},getCenter:function(){return t.modules.geo.getCenter()},getView:function(){return t.modules.geo.getView()},getZoom:function(){return t.modules.geo.getZoom()},setZoom:function(n){return t.modules.geo.setZoom(n)},setView:function(n,i,r){return t.modules.geo.setView(n,i,r)},setCenter:function(n,i){return t.modules.geo.setCenter(n,i)},toggle:function(n){return t.modules.geo.toggle(n)},resetCoordinates:function(){return t.modules.geo.resetCoordinates()},updateCoordinates:function(){return t.modules.geo.updateCoordinates()},getUnprojectedCoordinates:function(n){return t.modules.geo.getUnprojectedCoordinates(t.getNodes(n))}})},Jm);function Jm(){}function Pu(e,t,n,i,r){var o;void 0===i&&(i={}),void 0===r&&(r=!1),Array.isArray(n)||n instanceof(t?or:vs)||(n=[n]);var a=e.getElements(t,n);if(r||(a=a.dedupe()),!a.size)return Promise.resolve();t&&Pu(e,!1,a.getAdjacentEdges({filter:"all"}),i,!0);var s=i.virtual,l=void 0!==s&&s,u=a._indexes,d=e.storage.fetch(t),c=e.getCacheLists(t),h=d.getFlexArray("removed");if(Sn(d.getFlexArray("virtual").getMultiple(u))!==(l?u.length:0))throw new Error("Attempting to remove virtual elements; you should not do that");var p=((o={virtual:l})[t?"nodes":"edges"]=a,o);if(e.fireEvent(t?x.BEFORE_REMOVE_NODES:x.BEFORE_REMOVE_EDGES,p),c.visible.invalidList(),c.all.invalidList(),l||c.raw.invalidList(),e.setExcluded(a,!0),h.setMultiple(u,1),!t)for(var g=0;g<u.length;++g)e.topology.removeFromAdjacencyList(u[g]);return d.removeElements(u),e.setIndexFreeStep(1),e.fireEvent(t?x.REMOVE_NODES:x.REMOVE_EDGES,p),Promise.resolve()}var $E=(Ai.prototype.addNodes=function(e,t){return xs(this.modules.graph,!0,e,t)},Ai.prototype.addEdges=function(e,t){return xs(this.modules.graph,!1,e,t)},Ai.prototype.addNode=function(e,t){return Wu(this.modules.graph,!0,e,t)},Ai.prototype.addEdge=function(e,t){return Wu(this.modules.graph,!1,e,t)},Ai.prototype.removeNodes=function(e,t){return Pu(this.modules.graph,!0,e,t)},Ai.prototype.removeEdges=function(e,t){return Pu(this.modules.graph,!1,e,t)},Ai.prototype.removeNode=function(e,t){return Pu(this.modules.graph,!0,[e],t)},Ai.prototype.removeEdge=function(e,t){return Pu(this.modules.graph,!1,[e],t)},Ai.prototype.getNodes=function(e){return this.modules.graph.getNodes(e)},Ai.prototype.getEdges=function(e){return this.modules.graph.getEdges(e)},Ai.prototype.getNode=function(e){return this.modules.graph.getNode(e)},Ai.prototype.getEdge=function(e){return this.modules.graph.getEdge(e)},Ai.prototype.clearGraph=function(){this.modules.graph.clear()},Ai.prototype.setGraph=function(e,t){return this.modules.graph.clear(),this.addGraph(e,t)},Ai.prototype.addGraph=function(e,t){return n=this.modules.graph,s=void 0===(a=(i=e).nodes)?[]:a,u=void 0===(l=i.edges)?[]:l,void 0===(r=t)&&(r={}),r.batchSize?xs(n,!0,s,r).then(function(d){return o=d,xs(n,!1,u,r)}).then(function(d){return{nodes:o,edges:d}}):Promise.resolve({nodes:iu(n,!0,s,r),edges:iu(n,!1,u,r)});var n,i,r,o,a,s,l,u},Ai.prototype.createNodeList=function(){return this.getNodes([])},Ai.prototype.createEdgeList=function(){return this.getEdges([])},Ai.prototype.getConnectedComponents=function(e){return void 0===e&&(e={}),this.modules.graph.getConnectedComponents(this.getNodes(e.filter),e)},Ai.prototype.getConnectedComponentByNode=function(e,t){var n=this.modules.graph.getNode(e);if(void 0===n)throw new Error("getComponentByNode: cannot find node "+e);return this.modules.graph.getConnectedComponentByNode(n,t)[0]},Ai);function Ai(){}var eS=(Qm.prototype.reloadFonts=function(){this.modules.graphics.reloadFonts()},Qm);function Qm(){}function lr(e){return e.charCodeAt(0)}var tS=lr(" "),Km=lr("<"),nd=lr(">"),$m=lr('"'),nS=lr("\n"),iS=lr("\r"),id=lr("/"),rS=lr("\\"),oS=lr("a"),aS=lr("z"),sS=lr("A"),uS=lr("Z"),lS=lr("0"),dS=lr("9"),cS=lr(":");function hS(e,t,n,i){var r=i.length;if(n-t!==r)return!1;for(var o=0;o<r;++o)if(e[t+o]!==i[o])return!1;return!0}function iv(e,t,n,i){for(var r=e.length,o=0;o<r;++o)if(hS(t,n,i,e[o]))return o;return e.push(t.slice(n,i)),r}function pS(e,t,n){var i=rd(t,n),r=t[i];if(r===nd||r===id)return i;var o=i;i=ov(t,i);for(var u=iv(e.attributes,t,o,i);t[i]!==$m;)++i;for(o=++i;(r=t[i])!==$m;)r===rS&&++i,++i;return e.tokens.push(-3,u,o,i),i+1}function rv(e){return e===tS||e===nS||e===iS}function rd(e,t){for(;rv(e[t]);)++t;return t}function ov(e,t){for(;oS<=(n=e[t])&&n<=aS||sS<=n&&n<=uS||n===cS||lS<=n&&n<=dS;)++t;var n;return t}function av(e,t){var n=["return {","  id: undefined,","  attributes: {","    text: undefined,","    color: undefined,","    "+(e?"radius":"width")+": undefined",e?"  ,x: undefined":"",e?"  ,y: undefined":"","  },"];e||n.push("  source: undefined,","  target: undefined,");var i=Object.keys(t);i.length&&n.push("  data: {");for(var r=0;r<i.length;++r){var o=t[i[r]];n.push('  "'+o.title+'": '+(void 0!==o.default?JSON.stringify(o.default):void 0)+(r===i.length-1?"":","))}return i.length&&n.push("}"),n.push("};"),new Function(n.join("\n"))}function sv(e){return-1===e.indexOf("\\")?e:e=e.replace(/\\"/g,'"')}function uv(e){if(-1===e.indexOf("<gexf"))throw new Error("not a GEXF file");var t=function(ve){for(var Ce=new Int32Array(ve.length),Le=0,Re=ve.length;Le<Re;++Le)Ce[Le]=ve.charCodeAt(Le);return Ce}(e),n=function(ve,Ce){for(var Le,Re,Fe={tags:[],attributes:[],tokens:[]},De=Fe.tokens,Me=rd(ve,Ce);Me<ve.length;){var Oe=ve[Me];if(Oe===Km){if(ve[Me=rd(ve,++Me)]===id)for(De.push(-2);ve[++Me]!==nd;);else{Me=ov(ve,Le=Me);var Se=iv(Fe.tags,ve,Le,Me);for(De.push(-1,Se),Oe=ve[Me];Oe!==nd&&Oe!==id;)Oe=ve[Me=pS(Fe,ve,Me)];if(Oe===id)for(De.push(-2);ve[++Me]!==nd;);}Me+=1}else{for(Le=Me;ve[++Me]!==Km;);for(Re=Me-1;rv(ve[Re]);)--Re;De.push(-4,Le,Re+1)}Me=rd(ve,Me)}return Fe}(t,e.indexOf("<gexf ")),i={},r={};n.tags.forEach(function(ve,Ce){var Le=String.fromCharCode.apply(null,ve);i[Le]=Ce}),n.attributes.forEach(function(ve,Ce){var Le=String.fromCharCode.apply(null,ve);r[Le]=Ce});for(var o=i.attributes,a=i.attribute,s=i.node,l=i.edge,u=i.default,d=i["viz:position"],c=i["viz:size"],h=i["viz:color"],p=i.attvalue,g=r.class,m=r.id,b=r.type,v=r.title,y=r.label,S=r.source,A=r.target,C=r.x,O=r.y,N=r.r,P=r.g,F=r.b,L=r.a,B=r.value,Y=r.for,X=r.weight,ae={float:1,double:1,integer:2,boolean:3,string:4,"list-string":5},ie=0,U=n.tokens,W=U.length,ce=new Array(16),he=0,Ee=0,Te=0,it=!0,rt={},We={},_t=null,wt=null,Ue=null,Ze=void 0,Ne=null,Ge=0,Xe=0,$e=0,we=1,Pe=null,je=void 0,Je=!1,ut=!0,Gt=null,Xt=null,an=[],nn=[],ln=0,H=null;ie<W;){var Z=U[ie];if(-1===Z)Ee=he,ce[Te]=he=U[ie+1],Te+=1,he===s?(Ne=(Gt=Gt||av(!0,rt))(),ut=!0,H=rt):he===l&&(Ne=(Xt=Xt||av(!1,We))(),ut=!1,H=We),ie+=2;else if(-2===Z){if(_t&&he===a){H=it?rt:We;var z=ae[wt];(ge=Ze)&&(1===z?ge=+ge:2===z?ge=0|+ge:3===z?ge="true"===ge:5===z&&(ge=ge.split(" ").filter(function(ve){return ve}))),H[_t]={title:Ue||_t,default:ge,type:z},wt=Ue=_t=null,Ze=void 0}else if(he===s&&4===Te)Je&&(Ne.attributes.color="rgba("+Ge+", "+Xe+", "+$e+", "+we+")",$e=Xe=Ge=0,Je=!(we=1)),Ne.id||(Ne.id=++ln),an.push(Ne);else if(he===l&&4===Te)Ne.id||(Ne.id=++ln),nn.push(Ne);else if(he===p&&6===Te&&Pe){var Q=(ut?rt:We)[Pe];Q&&(void 0===je?je=Q.default:(z=Q.type)&&(1===z?je=+je:2===z?je=0|+je:3===z?je="true"===je:5===z?je=je.split(" ").filter(function(ve){return ve}).map(function(ve){return sv(ve)}):"string"==typeof t&&(je=sv(je))),Ne.data[H[Pe].title]=je),je=Pe=null}he=Ee,Ee=ce[--Te-2],ie+=1}else if(-3===Z){var de=U[ie+1],ge=e.substring(U[ie+2],U[ie+3]);if(he===o)de===g&&(it="edge"!==ge&&"edges"!==ge);else if(he===a)de===m?_t=ge:de===b?wt=ge:de===v&&(Ue=ge);else if(he!==s&&he!==l||4!==Te)if(he===d&&5===Te){if(de===C)Ne.attributes.x=parseFloat(ge);else if(de===O){var xe=parseFloat(ge);Ne.attributes.y=0===xe?xe:-xe}}else he===h&&5===Te?(Je=!0,de===N?Ge=parseInt(ge):de===P?Xe=parseInt(ge):de===F?$e=parseInt(ge):de===L&&(we=parseFloat(ge))):he===c&&5===Te?de===B&&(ut?Ne.attributes.radius=+ge:Ne.attributes.width=+ge):he===p&&6===Te&&(de===Y||de===m?Pe=ge:de===B&&(je=ge));else de===m?Ne.id=ge:de===y?Ne.attributes.text=ge:de===S?Ne.source=ge:de===A?Ne.target=ge:de===X&&(Ne.attributes.width=+ge);ie+=4}else{if(-4!==Z)throw new Error("at index "+ie+": token "+Z);ge=e.substring(U[ie+1],U[ie+2]),he===u&&(Ze=ge),ie+=3}}return{nodes:an,edges:nn}}function od(e){return"string"==typeof e||isFinite(e)?String(e):String(e.id||e._id)}function ka(e,t,n){n=n||t,t in e&&(e.attributes||(e.attributes={}),e.attributes[n]=e[t])}function lv(e){for(var t=JSON.parse(e),n=t.nodes||[],i=t.edges||[],r=0;r<n.length;r++){var o=n[r];"string"==typeof o.size&&(o.size=+o.size),"string"==typeof o.x&&(o.x=+o.x),"string"==typeof o.y&&(o.y=+o.y),ka(o,"x"),ka(o,"y"),ka(o,"size","radius"),ka(o,"color"),ka(o,"text")}for(r=0;r<i.length;r++){var a=i[r];"string"==typeof a.size&&(a.size=+a.size),ka(a,"size","width"),ka(a,"color"),ka(a,"text")}return t}function dv(e,t){for(var n=0,i=0;i<20;++i){var r=n+e[i]+t[i];n=+(10<=r),e[i]=r%10}}function cv(){this._decimalPowerOfTwo=new Uint8Array(20),this._binaryNumber=new Uint8Array(64),this._decimalNumber=new Uint8Array(20)}var gS=new(cv.prototype.int64ToString=function(e){var t=e.low,n=e.high;if(0===t&&0===n)return"0";(function(s,l,u){for(var d=0;d<32;++d)u[d]=+!!(s&1<<d);for(d=0;d<32;++d)u[d+32]=+!!(l&1<<d)})(t,n,this._binaryNumber),this._decimalNumber.fill(0),this._decimalPowerOfTwo.fill(0);var i=(this._decimalPowerOfTwo[0]=1)===this._binaryNumber[63];i&&function(s){for(var l=0;l<64;++l)s[l]^=1;for(l=0;l<64&&!(s[l]^=1);++l);}(this._binaryNumber);for(var r=0;r<64;++r)this._binaryNumber[r]&&dv(this._decimalNumber,this._decimalPowerOfTwo),dv(this._decimalPowerOfTwo,this._decimalPowerOfTwo);var o=[],a=this._decimalNumber.length-1;for(i&&o.push("-");!this._decimalNumber[a];)--a;for(r=a;0<=r;--r)o.push(String(this._decimalNumber[r]));return o.join("")},cv);function ad(e){return gS.int64ToString(e)}function sd(e){return"object"==typeof e&&"high"in e&&"low"in e}function Du(e,t,n,i){var r,o,a;t&&(Array.isArray(t)?t.forEach(function(s){return Du(e,s,n,i)}):function(e){return"segments"in e}(t)?(r=e,o=n,a=i,t.segments.forEach(function(s){Du(r,s.start,o,a),Du(r,s.end,o,a),Du(r,s.relationship,o,a)})):(function(s){if("object"!=typeof s||null===s)throw new Error("Ogma can only retrieve nodes and relationships from Neo4j. Please make sure that your Cypher query returns nodes and edges, not values.");for(var l,u=0,d=Object.keys(s.properties);u<d.length;u++){var c=d[u],h=s.properties[c];sd(h)&&(s.properties[c]=ad(h))}if(void 0!==s.identity&&(sd(s.identity)&&(s.identity=ad(s.identity)),"start"in(l=s)&&"end"in l)){var p=s.start.identity||s.start,g=s.end.identity||s.end;sd(p)&&(s.start=ad(p)),sd(g)&&(s.end=ad(g))}}(t),function(e){return"start"in e&&"end"in e&&"type"in e}(t)?i.has(t.identity)||(i.add(t.identity),e.edges.push({id:t.identity,source:t.start,target:t.end,data:{neo4jType:t.type,neo4jProperties:t.properties}})):n.has(t.identity)||(n.add(t.identity),e.nodes.push({id:t.identity,attributes:{x:100*Math.random(),y:100*Math.random()},data:{neo4jLabels:t.labels,neo4jProperties:t.properties}}))))}function vS(e){return{gexf:function(t){return Promise.resolve(uv(t))},gexfFromUrl:function(t){return _i(t).then(function(n){return uv(n)})},janus:function(t){return Promise.resolve(function(e){var t=[],n=[];return function i(r,o,a){if(r&&"object"==typeof r){if(Array.isArray(r))return r.forEach(function(h){return i(h,o,a)});if("vertex"===(d=r).type||"vertex"===d._type||d.inE||d.outE||d._inE||d._outE){var s={};r.properties&&Object.keys(r.properties).forEach(function(h){s[h]=r.properties[h][0].value});var l=od(r);for(var u in o.push({id:l,data:{id:r.id+"",categories:[r.label],properties:s}}),r)"properties"!==u&&i(r[u],o,a)}else{var d,c;if("edge"===(c=r).type||"edge"===c._type||c.inV||c.outV||c._outV||c._inV)for(var u in l=od(r),a.push({id:l,source:od(r.inV||r._inV),target:od(r.outV||r._outV),data:{id:l,type:r.label,properties:r.properties||{}}}),r)"properties"!==u&&i(r[u],o,a);else Object.keys(r).forEach(function(h){return i(r[h],o,a)})}}}("string"==typeof e?JSON.parse(e):e,t,n),{nodes:t,edges:n}}(t))},json:function(t){return Promise.resolve(lv(t))},jsonFromUrl:function(t){return _i(t).then(function(n){return lv(n)})},neo4j:function(t){return Promise.resolve((i="string"==typeof(n=t)?JSON.parse(n):n,r={nodes:[],edges:[]},o=new Set,a=new Set,i.records.forEach(function(s){s._fields.forEach(function(l){Du(r,l,o,a)})}),r));var n,i,r,o,a}}}var hv=(Qc.initNamespace=function(e){e.parse=vS()},Qc.prototype.fetch=function(e){return _i(e)},Qc);function Qc(){}var pv=(fv.initNamespace=function(e){var t;e.keyboard=(t=e,{isKeyPressed:function(n){return t.modules.keyboard.isPressed(n)},resetKeys:function(){t.modules.keyboard.resetKeys()}})},fv);function fv(){}var yS={configure:function(e,t){var n=t.graph,i=t.data;if(void 0===e.centralNode)throw new Error('concentric layout: missing parameter "centralNode"');var r,o,a,s,l,u=Mt({},e,{centralNode:(s=n,(l=e.centralNode)instanceof _o?l:s.getNode(l)),nodes:(r=n,o=e.nodes,void 0===a&&(a=r.getNodes()),o?o instanceof or?o:r.getNodes(o):a)}),c=u.nodes,h=n.getNode(u.centralNode)._index,p=u.centralNode.getPosition(),g=p.x,m=p.y,b=c.getAttribute("layoutable"),v=n.getNodes(c)._indexes,y=Array.from(v.filter(function(P,F){return b[F]}));-1===y.indexOf(h)&&y.push(h);var S=n.getNodeAttribute("radius").getMultiple(v),A=function(P,F,L,B){if(F)return"random"===F?"random":"radius"===F?B.slice():"degree"===F?L.getDegree():P.getProperty(L,F)}(i,u.sortBy,c,S),C=y.reduce(function(P,F,L){return P[F]=L,P},{}),O=y.map(function(P,F){return F}),N=y.map(function(P){return n.topology.getAdjacentElements(!0,new Uint32Array([P])).map(function(F){return C[F]})});return{sourceNodeIndex:y.indexOf(h),centerX:"number"==typeof u.centerX?u.centerX:g,centerY:"number"==typeof u.centerY?u.centerY:m,list:y,indexes:O,size:y.length,totalSize:y.length,attributes:{adjacentNodes:N,size:S},sortAttr:A,clockwise:void 0===u.clockwise||u.clockwise,circleHopRatio:u.circleHopRatio||5,allowOverlap:!!u.allowOverlap}},context:function(){return{dijkstra:function(e,t,n,i,r){var o,a=Math.pow(2,31)-1,s=new Int32Array(i),l=new Int32Array(i),u=new Int8Array(i);s.fill(a),l.fill(-1);for(var d=0;d<i;++d){var c=t[d];void 0!==c&&(s[c]=a,l[c]=-1)}s[r]=0;for(var h=function(){var p=a;o=-1;for(var g=0;g<n;++g){var m=t[g],b=s[m];!u[m]&&b<p&&(p=b,u[o=m]=1)}if(-1<o){var y=p+1;e[o].forEach(function(S){y<s[S]&&(s[S]=y,l[S]=o)})}};-1!==o;)h();return s},determinePropertyType:function(e,t,n){return t.some(function(i){return"number"!==e[i]})?"string":"number"}}},update:function(e,t){for(var n=e.attributes,i=e.indexes,r=e.size,o=e.sourceNodeIndex,a=e.centerX,s=e.centerY,l=e.sortAttr,u=n.adjacentNodes,d=n.size,c=new Array(e.totalSize),h=new Array(e.totalSize),p=t.dijkstra(u,i,e.size,e.totalSize,o),g=0,m={},b=0;b<r;b++){var v=d[i[b]];g<v&&(g=v)}var y=g*e.circleHopRatio,S=0,A=0,C=Math.PI/9;for(b=0;b<r;b++){var O=i[b],N=p[O],P=m[N];P||(m[N]=P=[]),P.push(O)}var F,L,Y=(L=i,"random"===(F=l)?function(){return Math.random()-.5}:F?"number"===t.determinePropertyType(F,L,L.length)?function(ae,ie){return F[ae]-F[ie]}:function(ae,ie){return F[ae]<F[ie]?-1:1}:void 0),X="random"===l||l;return Object.keys(m).sort(function(ae,ie){return parseInt(ae)-parseInt(ie)}).forEach(function(ae,ie){var Te,U=m[ae],W=U.length,ce=0,he=A,Ee=2*Math.PI/W;0===ie||e.allowOverlap||2*Math.PI*S<(Te=2*(ce+=U.reduce(function(We,_t){return We+d[_t]},0))*Math.SQRT2)&&(S+=Te/(2*Math.PI)-S),X&&(U.sort(Y),e.clockwise||U.reverse());for(var it=0;it<W;it++){var rt=U[it];c[rt]=Math.cos(he)*S+a,h[rt]=Math.sin(he)*S+s,v=d[rt],he+=Ee*(e.allowOverlap?1:v/ce*W)}S+=y,A+=C}),{x:c,y:h,indexes:e.list}},isRunning:function(){return!1},onSync:function(e){return{indexes:e.indexes,x:e.x,y:e.y}}};function Kc(e){var t=e.sources,n=e.targets,i=e.weights,r=e.source,o=e.target,a=e.undirected,s=void 0!==a&&a,l=e.indexes,u=e.N;if(u=l?l.length:u,!isFinite(u)||0===u)throw new Error("Invalid number of nodes "+u);var d,c=new Float32Array(u),h=new Int32Array(u),p={},g=Number.POSITIVE_INFINITY;if(!i){i=[];for(var m=0;m<u;m++)i[m]=1}if(!l)for(l=new Uint32Array(u),m=0;m<u;m++)l[m]=m+1;for(m=0;m<u;m++)c[m]=g,h[m]=-1,p[l[m]]=m;for(c[p[r]]=0,m=1;m<=u;m++){d=!1;for(var b=0;b<i.length;b++){var v=t[b],y=n[b],S=p[v],A=p[y];if(void 0!==S&&void 0!==A){var C=i[b],O=c[S]+C;c[S]!==g&&O<c[A]&&(c[A]=O,h[A]=v,d=!0),s&&(O=c[A]+C,c[A]!==g&&O<c[S]&&(c[S]=O,h[S]=y,d=!0))}}if(!d)break}if(d)for(m=0;m<i.length;m++)if(A=p[y=n[m]],void 0!==(S=p[v=t[m]])&&void 0!==A&&c[S]+(C=i[m])<c[A])return null;var N=null,P=null;if(void 0!==o){var F=p[o];if(void 0!==F&&c[F]!==g){for(N=[],m=o;-1!==m;m=h[p[m]])N.push(m);N=N.reverse(),P=c[F]}}return{distances:c,path:N,pathLength:P}}function $c(e){var t=e.sources,n=e.targets,i=e.weights,r=e.indexes,o=e.adjacency,a=e.undirected,s=e.ignoreWeights,l=Number.POSITIVE_INFINITY,u=r?r.length:o.length;if(!r){r=new Uint32Array(u);for(var d=0;d<u;d++)r[d]=d+1}var c=new Array(u),h={};for(d=0;d<u;d++){c[d]=new Float32Array(u);for(var p=0;p<u;p++)c[d][p]=d===p?0:l;h[r[d]]=d}var g=u,m=i.length;for(t=t.slice(),n=n.slice(),i=i.slice(),d=0;d<u;d++)t[m+d]=g,n[m+d]=r[d],i[m+d]=0,s&&(i[d]=1);var b=Kc({sources:t,targets:n,weights:i,undirected:a,N:u+1,source:g});if(null===b)throw new Error("Graph has negative weight loops");var v=b.distances;for(d=0;d<i.length;d++){var y=h[t[d]],S=h[n[d]];void 0!==y&&void 0!==S&&(i[d]=i[d]+v[y]-v[S])}for(t=t.slice(0,m),n=n.slice(0,m),i=i.slice(0,m),d=0;d<u;d++){var A=Hl(o,r[d],void 0,r,h,s).distances;for(p=0;p<u;p++)c[d][p]=d===p?0:A[p]}return c}function eh(e){var t=e.X,n=e.Y,i=e.sizes,r=e.indexes,o=e.R,a=e.center,s=e.gap,l=void 0===s?0:s,u=e.epsilon,d=void 0===u?.001:u,c=e.maxLoops,h=void 0===c?5:c,p=e.inPlace,m=r.length,b=a[0],v=a[1],y=m;void 0===p||p||(t=t.slice(),n=n.slice());for(var S=sc,A=uc,C=r.slice().sort(function(we,Pe){return A(t[we],n[we],t[Pe],n[Pe],b,v)}),O=C[m-1],N=t[O],P=n[O],F=!1,L=0;L<y-1;L++){var B=L%m,Y=(L+1)%m;-1===L&&(B=m-1,Y=0);var X=t[B=C[B]],ae=n[B],ie=t[Y=C[Y]],U=n[Y],W=i[B]+i[Y]+l,ce=A(X,ae,ie,U,b,v);if(-1===ce&&F&&(ce=1),!(o<W)){if(1===ce||W-vi(X,ae,ie,U)>d){var he=S(b,v,o,X,ae,W);if(he){var Ee=he[0];F=b<ie&&Ee[0]<b,ie=t[Y]=Ee[0],U=n[Y]=Ee[1]}}else F=!1;if(L%m==m-2){var Te=C[m-1],it=C[0];if(n[Te]>v&&n[it]>v&&t[Te]-i[Te]<t[it]+i[Te]){var rt=0;for(y=Math.min(m*h,y+m);n[C[Te]]>v&&n[C[0]]>v&&t[C[Te]]<t[C[0]]&&++rt<m;)C.unshift(C.pop())}}}}var We=N-b,_t=P-v,wt=t[O]-b,Ue=n[O]-v,Ze=We==wt?0:Math.abs(Math.acos((We*wt+_t*Ue)/(Math.sqrt(We*We+_t*_t)*Math.sqrt(wt*wt+Ue*Ue))));if(0!==Ze){var Ne=Math.sin(-Ze),Ge=Math.cos(-Ze),Xe=void 0;for(L=0;L<m;L++){var $e=n[Xe=C[L]]-v;t[Xe]=(rt=t[Xe]-b)*Ge-$e*Ne+b,n[Xe]=rt*Ne+$e*Ge+v}}return{X:t,Y:n}}function gv(e,t,n,i,r,o){var a=Object.create(null),s=n[e],l=s,u=0,d=s;for(var c in t){for(var h=t[c],p=0,g=0,m=0,b=h.length;m<b;m++){var v=n[h[m]];g=Math.max(g,v),p+=2*v+i}var y=p/(2*Math.PI)+g,A=o?u+Math.max(o,g+l):u*r;u=Math.max(u,y,d,A),a[c]=u,l=g}return a[0]=0,a[Number.POSITIVE_INFINITY]=u,a}function _v(e,t,n,i,r,o){for(var a=0,s=0;s<i;s++)for(var l=0;l<i;l++){var u=o[s],d=o[l];if(u!==d){var c=e[u][d]*r,h=1/(c*c);if(h){var p=t[u]-t[d],g=n[u]-n[d];a+=h*Math.pow(c-Math.sqrt(p*p+g*g),2)}}}return a}function mv(e,t,n,i,r,o,a){var s=0;if(-1===r)return 0;for(var l=0;l<i;l++)for(var u=0;u<i;u++){var d=a[l],c=a[u];if(d!==c&&(d===r||c===r)){var h=e[d][c]*o,p=1/(h*h);if(p){var g=t[d]-t[c],m=n[d]-n[c];s+=p*Math.pow(h-Math.sqrt(g*g+m*m),2)}}}return s}function th(e,t,n,i,r,o,a,s){a=a||0;for(var l=0,u=0,d=0;d<i;d++)for(var c=0;c<i;c++){var h=s[d],p=s[c];if(h!==p){var g=e[h][p]*o,m=1/(g*g);if(m){var b=t[h]-t[p],v=n[h]-n[p],y=m*Math.pow(g-Math.sqrt(b*b+v*v),2);l+=y,h!==r&&p!==r||(u+=y)}}}return(1-a)*l+a*u}function nh(e,t,n,i,r,o,a,s,l){a=a||0;var u=t,d=n;-1===(r=void 0===r?-1:r)&&(a=0);for(var c=t[r],h=n[r],p=0;p<i;p++){var g=s[p],m=l(e[r][p]),b=a/(m*m);if(0!==m){for(var v=0,y=0,S=0,A=t[g],C=n[g],O=0;O<i;O++){var N=s[O];if(N!==g){var P=e[g][N]*o,F=1/(P*P),L=t[N],B=n[N];if(0!=F){var Y=(U=(ae=A-L)*ae+(ie=C-B)*ie)<1e-6?0:1/Math.sqrt(U);y+=(1-a)*F*(L+P*(A-L)*Y),S+=(1-a)*F*(B+P*(C-B)*Y)}v+=F}}var X=(1-a)*v+b;if(0!=X){var ae,ie,U;U=(U=(ae=A-c)*ae+(ie=C-h)*ie)<1e-6?0:1/Math.sqrt(U);var W=0===m?0:m*U*b;u[g]=(y+W*t[g])/X,d[g]=(S+W*n[g])/X}}}return{x:u,y:d}}function ih(e,t){return e-t}var xS={imports:{minHeap:kc,bellmanFord:Kc,dijkstra:Hl,johnson:$c,distance:vi,circleCircleIntersection:sc,circleSortCompare:uc,weightedStress:_v,distanceStress:mv,constrainedStress:th,stressMinimizationStep:nh,removeRadialOverlap:eh,quadraticInOut:nc,calculateRadii:gv},configure:function(e,t){void 0===e&&(e={centralNode:null});var n=t.graph,i=n.getNode(e.centralNode),r=i.getPosition(),o=isFinite(e.centerX)?e.centerX:r.x,a=isFinite(e.centerY)?e.centerY:r.y,s=i._index,l=e.nodes;l.includes(i)||(l=l.concat(i.toList()));var u=l._indexes,d=l.getAttribute("layoutable");(u=u.filter(function(C,O){return d[O]||C===s})).sort(ih);var c=u.length,h=function(C,O,N){for(var P=C.slice().sort(ih),F=[],L=0,B=O.length;L<B;L++){for(var Y=[],X=O[L],ae=!1,ie=0,U=X.length;ie<U;ie++){var W=X[ie];-1!==ps(P,W)&&(W===N&&(ae=!0),Y.push(W))}0!==Y.length&&F[ae?"unshift":"push"](Y.sort(ih))}return F}(u,n.getConnectedComponents(l,{internalIndexes:!0}),s),p=n.degrees(u),g=new Float32Array(n.getNodeAttribute("x").getMultiple(u)),m=new Float32Array(n.getNodeAttribute("y").getMultiple(u)),b=n.getNodeAttribute("radius").getMultiple(u),v=n.getEdges()._indexes,y=n.getEdgeAttribute("source").getMultiple(v),S=n.getEdgeAttribute("target").getMultiple(v),A=n.getAdjacencyList({internalIndexes:!0,weight:1,indexes:u});return{centerIndex:s,centerIndexPos:0,cx:o,cy:a,D:null,indexes:u,components:h,normIndexes:null,radii:null,rings:null,x:g,y:m,degree:p,size:c,attributes:{size:b,adjacency:A,weights:S.map(function(){return 1}),sources:y,targets:S},sortAttr:null,allowOverlap:!!e.allowOverlap,nodeGap:e.nodeGap,radiusRatio:e.radiusRatio,radiusDelta:e.radiusDelta,repulsion:e.repulsion,randomize:!("randomize"in e)||!!e.randomize,renderSteps:!!e.renderSteps,epsilon:e.epsilon,maxSteps:e.maxIterations,iterationsPerRender:e.iterationsPerRender,step:-1,stress:Number.POSITIVE_INFINITY,prevStress:0,converged:!1,overlapRemoved:!1,done:!1}},context:function(){return{data:null,gridPlacement:function(e,t,n){void 0===n&&(n=8);for(var i=e.length,r=new Float32Array(i),o=new Float32Array(i),a=0,s=0,l=e.length;s<l;s++){var u=t[e[s]];a<u&&(a=u)}var d=a*n,c=Math.ceil(Math.sqrt(i)),h=Math.ceil(i/c),p=-Math.floor((h-1)*d/2),g=-Math.floor((c-1)*d/2);for(s=0;s<c;s++)for(var m=0;m<h;m++)r[s*h+m]=p+m*d,o[s*h+m]=g+s*d;return{x:r,y:o}},connectComponents:function(e,t,n,i,r,o){var a;function s(d,c){var h=new Uint32Array(d.length+1);return h.set(d),h[d.length]=c,h}for(var l=function(d){var c=e[d],h=0,p=0;c.forEach(function(m,b){r.get(m)>h&&(p=b,h=r.get(m))});var g=t[o.get(a=c[p])];g.nodes=s(g.nodes,n),g.weights.push(i),(g=t[o.get(n)]).nodes=s(g.nodes,a),g.weights.push(i)},u=1;u<e.length;u++)l(u)},correctSubgraphsDistances:function(e,t,n,i,r){for(var o=Array.prototype.reduce.call(e[n],function(h,p,g){return g!==n&&p<i&&h<p&&(h=p),h},0),a=i-o-1,s=1;s<t.length;s++)for(var l=t[s],u=0,d=l.length;u<d;u++){var c=r.get(l[u]);e[n][c]-=a,e[c][n]-=a}},initialize:function(e,t){(e.data=t).step=0;var n=new Map,i=new Map;t.normIndexes=t.indexes.reduce(function(h,p,g){return h[g]=g,n.set(p,g),i.set(p,t.degree[g]),p===t.centerIndex&&(e.data.centerIndexPos=g),h},new Uint32Array(t.indexes.length));var r=t.centerIndexPos,o=t.components[0].length;e.connectComponents(t.components,t.attributes.adjacency,t.centerIndex,o,i,n);var a=$c({sources:t.attributes.sources,targets:t.attributes.targets,weights:t.attributes.weights,indexes:t.indexes,adjacency:t.attributes.adjacency,undirected:!0});e.correctSubgraphsDistances(a,t.components,r,o,n);for(var s=(t.D=a)[r],l=Object.create(null),u=0,d=t.normIndexes.length;u<d;u++)if(u!==r){var c=s[u];l[c]=l[c]||[],l[c].push(t.normIndexes[u])}t.rings=l,t.radii=gv(r,t.rings,t.attributes.size,t.nodeGap,t.radiusRatio,t.radiusDelta)},removeOverlaps:function(e,t){var n=e.data.centerIndexPos,i=t.attributes.size,r=t.rings,o=t.x[n],a=t.y[n];for(var s in r){var l=r[s],u=vi(o,a,t.x[l[0]],t.y[l[0]]);eh({X:t.x,Y:t.y,sizes:i,indexes:l,center:[o,a],R:u,gap:t.nodeGap,inPlace:!0})}}}},update:function(e,t){var n,i=(e=e||t.data).indexes,r=e.centerIndex;function o(y){return e.radii[y]||1}e.x=e.x||new Float32Array(e.size),e.y=e.y||new Float32Array(e.size),-1===e.step?t.initialize(t,e):e.step++;var a=e.repulsion;if(0===e.step)e.randomize&&(n=t.gridPlacement(e.indexes,e.attributes.size),e.x=n.x,e.y=n.y);else if(!e.converged)for(var s=e.maxSteps,u=e.step,d=Math.min(u+e.iterationsPerRender,s+1),c=e.D,h=e.x,p=e.y,g=e.size,m=e.centerIndexPos,b=e.normIndexes;u<=d||!e.converged;){var v=nc(Math.min(u,s)/s);e.step=u++,n=nh(c,h,p,g,m,a,v,b,o),e.x=n.x,e.y=n.y,e.prevStress=e.stress,e.stress=th(c,h,p,g,m,a,v,b),e.converged=e.converged||Math.abs(e.stress-e.prevStress)<=e.epsilon}return e.converged&&(e.overlapRemoved||e.allowOverlap?(e.done=!0,e.rings=Object.keys(e.rings).reduce(function(y,S){return y[S]=e.rings[S].map(function(A){return i[A]}),y},{})):(t.removeOverlaps(t,e,r),e.overlapRemoved=!0)),e},isRunning:function(e){var t=e.data;return!t.converged||!t.allowOverlap&&!t.done},onSync:function(e){if(e.renderSteps||e.done)return vv(e)},onEnd:function(e,t){return vv(e)}};function vv(e){for(var t=e.x,n=e.y,i=e.indexes.length,r=t[e.centerIndexPos]-e.cx,o=n[e.centerIndexPos]-e.cy,a=0;a<i;a++)t[a]-=r,n[a]-=o;return{indexes:e.indexes,x:t,y:n}}function yv(){return function(){var e=function(H){var Z,z=(Z=4022871197,function(Q){Q=Q.toString();for(var de=0;de<Q.length;de++){var ge=.02519603282416938*(Z+=Q.charCodeAt(de));ge-=Z=ge>>>0,Z=(ge*=Z)>>>0,Z+=4294967296*(ge-=Z)}return 2.3283064365386963e-10*(Z>>>0)});this.c=1,this.s0=z(" "),this.s1=z(" "),this.s2=z(" "),this.s0-=z(String(H)),this.s0<0&&(this.s0+=1),this.s1-=z(String(H)),this.s1<0&&(this.s1+=1),this.s2-=z(H),this.s2<0&&(this.s2+=1),z=null};function t(H){return new e(H.toString()).next()}e.prototype.next=function(){var H=this;return function(){var Z=2091639*H.s0+2.3283064365386963e-10*H.c;return H.s0=H.s1,H.s1=H.s2,H.s2=Z-(H.c=0|Z)}},e.prototype.nextDouble=function(){var H=this.next();return function(){return H()+11102230246251565e-32*(2097152*H()|0)}},e.prototype.nextInt32=function(){var H=this.next();return function(){return 4294967296*H()|0}};var n=t(42);function i(H){n=t(H)}function r(){return 1e-6*(n()-.5)}for(var o=[0,1],a=[0,2],s=4;s<65535;s<<=2)for(var l=0,u=o.length;l<u;l++)o.push(o[l]|s),a.push((o[l]|s)<<1);function d(H,Z){return(a[255&Z]|o[255&H])+65536*(a[Z>>8&255]|o[H>>8&255])+4294967296*(a[Z>>16&255]|o[H>>16&255])}function c(H,Z){var z=H^Z,Q=65535^z,de=65535^(H|Z),ge=H&(65535^Z),xe=z|Q>>1,ve=z>>1^z,Ce=de>>1^Q&ge>>1^de,Le=z&de>>1^ge>>1^ge;ve=(z=xe)&(Q=ve)>>2^Q&(z^Q)>>2,Ce^=z&(de=Ce)>>2^Q&(ge=Le)>>2,Le^=Q&de>>2^(z^Q)&ge>>2,ve=(z=xe=z&z>>2^Q&Q>>2)&(Q=ve)>>4^Q&(z^Q)>>4,Ce^=z&(de=Ce)>>4^Q&(ge=Le)>>4,Le^=Q&de>>4^(z^Q)&ge>>4,Ce^=(z=xe=z&z>>4^Q&Q>>4)&(de=Ce)>>8^(Q=ve)&(ge=Le)>>8;var Re=H^Z,Fe=(Q=(Le^=Q&de>>8^(z^Q)&ge>>8)^Le>>1)|65535^(Re|(z=Ce^Ce>>1));return((Fe=1431655765&((Fe=858993459&((Fe=252645135&((Fe=16711935&(Fe|Fe<<8))|Fe<<4))|Fe<<2))|Fe<<1))<<1|(Re=1431655765&((Re=858993459&((Re=252645135&((Re=16711935&(Re|Re<<8))|Re<<4))|Re<<2))|Re<<1)))>>>0}var p,g,m=function(H,Z,z){this.left=null,this.right=null,this.code=H,this.left=Z,this.right=z},b=function(H,Z){this.code=H,this.data=Z},v=function(H,Z){this.code=H,this.data=Z};function y(){this.left=null,this.right=null,this.data=null}function S(H){for(var Z=1<<31,z=0;z<31;z+=1){if(Z&H)return z;Z>>>=1}return 32}function A(H,Z,z){var Q=H[Z],de=H[z];if(Q===de)return Z;for(var ge,xe=S(Q^de),ve=Z,Ce=z-Z;(ge=ve+(Ce=Ce+1>>1))<z&&xe<S(Q^H[ge])&&(ve=ge),1<Ce;);return ve}(g=p=p||{})[g.HILBERT=1]="HILBERT",g[g.MORTON=0]="MORTON";var C=function(H,Z){void 0===Z&&(Z={});var z=Z.getX,Q=Z.getY,de=Z.bucketSize;void 0===de&&(de=0);var ge=Z.sfc;void 0===ge&&(ge=p.HILBERT);var xe=Z.recursive;void 0===xe&&(xe=!0),this._bucketSize=0,this._root=null;var ve,Ce,Le,Re,Fe=H.length,De=new Uint32Array(Fe),Me=1/0,Oe=1/0,Se=-1/0,Qe=-1/0;this._x=z,this._y=Q;var at=ge===p.HILBERT?c:d;this._project=at;var Be=new Uint32Array(Fe);for(Ce=0;Ce<Fe;Ce++)(Le=z(ve=H[Ce]))<Me&&(Me=Le),(Re=Q(ve))<Oe&&(Oe=Re),Se<Le&&(Se=Le),Qe<Re&&(Qe=Re),Be[Ce]=Ce;this._minX=Me,this._minY=Oe,this._maxX=Se,this._maxY=Qe;var Ve=65535/Math.max(Se-Me,1),ze=65535/Math.max(Qe-Oe,1);for(this._hw=Ve,this._hh=ze,Ce=0;Ce<Fe;Ce++)De[Ce]=at(Ve*(z(ve=H[Ce])-Me),ze*(Q(ve)-Oe));(function(H,Z){(function z(Q,de,ge,xe){if(!(xe<=ge)){for(var ve,Ce=de[ge+xe>>1],Le=ge-1,Re=xe+1;;){for(;de[++Le]<Ce;);for(;de[--Re]>Ce;);if(Re<=Le)break;ve=Q[Le],Q[Le]=Q[Re],Q[Re]=ve,ve=de[Le],de[Le]=de[Re],de[Re]=ve}z(Q,de,ge,Re),z(Q,de,Re+1,xe)}})(H,Z,0,H.length-1)})(Be,De),this._root=0===de?xe?function Ke(Ye,nt,yt,xt,Tt){if(Tt-xt==0)return new b(yt[xt],Ye[nt[xt]]);var mt=A(yt,xt,Tt),At=Ke(Ye,nt,yt,xt,mt),tt=Ke(Ye,nt,yt,mt+1,Tt);return new m(mt,At,tt)}(H,Be,De,0,Fe-1):function(Ke,Ye,nt,yt,xt){for(var Tt=new y,mt=[Tt],At=[0,xt];0!==mt.length;){var tt=At.pop(),lt=At.pop(),vt=mt.pop();if(tt-lt==0)vt.code=nt[lt],vt.data=Ke[Ye[lt]];else{var Et=A(nt,lt,tt);lt<=(vt.code=Et)&&(vt.left=new y,mt.push(vt.left),At.push(lt,Et)),Et<tt&&(vt.right=new y,mt.push(vt.right),At.push(Et+1,tt))}}return Tt}(H,Be,De,0,Fe-1):xe?function Ke(Ye,nt,yt,xt,Tt,mt){if(Tt-xt<mt){for(var At=new Array(Tt-xt+1),tt=xt,lt=0;tt<=Tt;tt++,lt++)At[lt]=Ye[nt[tt]];return new v(yt[xt],At)}var vt=A(yt,xt,Tt),Et=Ke(Ye,nt,yt,xt,vt,mt),Bt=Ke(Ye,nt,yt,vt+1,Tt,mt);return new m(vt,Et,Bt)}(H,Be,De,0,Fe-1,de):function(Ke,Ye,nt,yt,xt,Tt){for(var mt=new y,At=[mt],tt=[0,xt];0!==At.length;){var lt=tt.pop(),vt=tt.pop(),Et=At.pop();if(lt-vt<Tt){for(var Bt=new Array(lt-vt+1),Pt=vt,wn=0;Pt<=lt;Pt++,wn++)Bt[wn]=Ke[Ye[Pt]];Et.code=nt[vt],Et.data=Bt}else{var Kt=A(nt,vt,lt);vt<=(Et.code=Kt)&&(Et.left=new y,At.push(Et.left),tt.push(vt,Kt)),Kt<lt&&(Et.right=new y,At.push(Et.right),tt.push(Kt+1,lt))}}return mt}(H,Be,De,0,Fe-1,de),this._bucketSize=de},O={root:{configurable:!0}};O.root.get=function(){return this._root},C.prototype.inOrder=function(H,Z){for(var z=this._root,Q=[],de=!1;!de;)if(z)Q.push(z),z=z.left;else if(0!==Q.length){if(z=Q.pop(),H.call(Z,z))break;z=z.right}else de=!0;return this},C.prototype.preOrder=function(H,Z){for(var z=[this._root];0!==z.length;){var Q=z.pop();H.call(Z,Q)||(Q.right&&z.push(Q.right),Q.left&&z.push(Q.left))}return this},C.prototype.postOrder=function(H,Z){var z,Q=[],de=this._root;do{for(;de;)de.right&&Q.push(de.right),Q.push(de),de=de.left;de=Q.pop(),z=Q.length-1,de=de.right&&Q[z]===de.right?(Q[z]=de).right:(H.call(Z,de),null)}while(0!==Q.length);return this},C.prototype.map=function(H,Z){var z=[];return this.inOrder(function(Q){z.push(H.call(Z,Q))}),z},C.prototype.height=function(){return function H(Z){return Z?1+Math.max(H(Z.left),H(Z.right)):0}(this._root)},C.prototype.toString=function(H){void 0===H&&(H=function(z){return z.code.toString()});var Z=[];return function z(Q,de,ge,xe,ve){if(Q){xe(de+(ge?"^-- ":"|-- ")+ve(Q)+"\n");var Ce=de+(ge?"    ":"|   ");Q.left&&z(Q.left,Ce,!1,xe,ve),Q.right&&z(Q.right,Ce,!0,xe,ve)}}(this._root,"",!0,function(z){return Z.push(z)},H),Z.join("")},C.prototype.size=function(){var H=0;return this.preOrder(function(){H++}),H},Object.defineProperties(C.prototype,O);var N=function(H){return H.x},P=function(H){return H.y},F=function(H){return H.r};function L(H,Z,z,Q){void 0===Z&&(Z=N),void 0===z&&(z=P),void 0===Q&&(Q=F);for(var de,ge=function(Re){for(var Fe=Re.length-1;0<=Fe;Fe--){var De=Math.floor(Math.random()*(Fe+1));De=Math.max(Math.min(De,Fe),0);var Me=Re[Fe];Re[Fe]=Re[De],Re[De]=Me}return Re}(H.slice()),xe=ge.length,ve=[],Ce=0;Ce<xe;){var Le=ge[Ce];de&&X(de,Z(Le),z(Le),Q(Le))?Ce++:(de=ie(ve=B(ve,Le,Z,z,Q),Z,z,Q),Ce=0)}return de}function B(H,Z,z,Q,de){var ge=z(Z),xe=Q(Z),ve=de(Z),Ce={x:ge,y:xe,r:ve};if(ae(Ce,H,z,Q,de))return[Z];for(var Le=0;Le<H.length;++Le){var Re=H[Le],Fe=z(Re),De=Q(Re),Me=de(Re);if(!Y(Ce,Fe,De,Me)&&ae(U(Fe,De,Me,ge,xe,ve),H,z,Q,de))return[H[Le],Z]}for(var Oe=0;Oe<H.length-1;Oe++)for(var Se=Oe+1;Se<H.length;Se++){var Qe=H[Oe],at=H[Se],Be=z(Qe),Ve=Q(Qe),ze=de(Qe),Ke=z(at),Ye=Q(at),nt=de(at);if(!Y(U(Be,Ve,ze,Ke,Ye,nt),ge,xe,ve)&&!Y(U(Be,Ve,ze,ge,xe,ve),Ke,Ye,nt)&&!Y(U(Ke,Ye,nt,ge,xe,ve),Be,Ve,ze)&&ae(W(Be,Ve,ze,Ke,Ye,nt,ge,xe,ve),H,z,Q,de))return[H[Oe],H[Se],Z]}throw new Error}function Y(H,Z,z,Q){var de=H.r-Q,ge=Z-H.x,xe=z-H.y;return 0<=de&&ge*ge+xe*xe<de*de}function X(H,Z,z,Q){var de=H.r-Q+1e-6,ge=Z-H.x,xe=z-H.y;return 0<de&&ge*ge+xe*xe<de*de}function ae(H,Z,z,Q,de){for(var ge=0;ge<Z.length;++ge){var xe=Z[ge];if(!X(H,z(xe),Q(xe),de(xe)))return!1}return!0}function ie(H,Z,z,Q){return 1===H.length?{x:Z(H[0]),y:z(H[0]),r:Q(H[0])}:2===H.length?U(Z(H[0]),z(H[0]),Q(H[0]),Z(H[1]),z(H[1]),Q(H[1])):W(Z(H[0]),z(H[0]),Q(H[0]),Z(H[1]),z(H[1]),Q(H[1]),Z(H[2]),z(H[2]),Q(H[2]))}function U(H,Z,z,Q,de,ge){var xe=Q-H,ve=de-Z,Ce=ge-z,Le=Math.sqrt(xe*xe+ve*ve);return{x:(H+Q+xe/Le*Ce)/2,y:(Z+de+ve/Le*Ce)/2,r:(Le+z+ge)/2}}function W(H,Z,z,Q,de,ge,xe,ve,Ce){var Le=H-Q,Re=H-xe,Fe=Z-de,De=Z-ve,Me=ge-z,Oe=Ce-z,Se=H*H+Z*Z-z*z,Qe=Se-Q*Q-de*de+ge*ge,at=Se-xe*xe-ve*ve+Ce*Ce,Be=Re*Fe-Le*De,Ve=(Fe*at-De*Qe)/(2*Be)-H,ze=(De*Me-Fe*Oe)/Be,Ke=(Re*Qe-Le*at)/(2*Be)-Z,Ye=(Le*Oe-Re*Me)/Be,nt=ze*ze+Ye*Ye-1,yt=2*(z+Ve*ze+Ke*Ye),xt=Ve*Ve+Ke*Ke-z*z,Tt=-(nt?(yt+Math.sqrt(yt*yt-4*nt*xt))/(2*nt):xt/yt);return{x:H+Ve+ze*Tt,y:Z+Ke+Ye*Tt,r:Tt}}function ce(H,Z,z,Q,de){var ge=Q.X,xe=Q.Y,ve=Q.R,Ce=Q.fx,Le=Q.fy,Re=Q.masses,Fe=de.friction,De=de.theta,Me=de.charge,Oe=Math.floor(Math.log(Z.length));null===z&&(z=new C(Z,{getX:function(Be){return ge[Be]},getY:function(Be){return xe[Be]},recursive:!0,bucketSize:Oe})).postOrder(function(Be){var Ve,ze,Ke,Ye,nt,yt=0;if(void 0!==Be.data)if(Be.data.length){var xt=L(Be.data,function(Cn){return ge[Cn]},function(Cn){return xe[Cn]},function(Cn){return ve[Cn]});Ve=xt.x,ze=xt.y,Ke=xt.r;for(var Tt=0;Tt<Be.data.length;Tt++)yt+=Re[Be.data[Tt]]}else Ve=ge[nt=Be.data],ze=xe[nt],Ke=ve[nt],yt=Re[nt];else if(Be.left&&Be.right){var mt=Be.left.cx,At=Be.left.cy,tt=Be.right.cx,lt=Be.right.cy,vt=Be.left.r,Et=Be.right.r,Bt=tt-mt,Pt=lt-At,wn=Et-vt,Kt=Math.sqrt(Bt*Bt+Pt*Pt);Ve=(mt+tt+Bt/Kt*wn)/2,ze=(At+lt+Pt/Kt*wn)/2,Ke=(Kt+vt+Et)/2,yt=Be.left.mass+Be.right.mass}else Ve=(Ye=Be.left||Be.right).cx,ze=Ye.cy,Ke=Ye.r,yt=Ye.mass;Be.cx=Ve,Be.cy=ze,Be.r=Ke,Be.mass=yt});for(var Se=Z.length,Qe=function(Be){var Ve=Z[Be],ze=ge[Ve],Ke=xe[Ve],Ye=ve[Ve];z.preOrder(function(nt){var xt=0,Tt=0,mt=ze-nt.cx||r(),At=Ke-nt.cy||r(),tt=mt*mt+At*At,lt=Ye+nt.r;if(nt.data){if(nt.data===Ve)return!1;if(nt.data.length)for(var vt=0;vt<nt.data.length;vt++){var Et=nt.data[vt];Et!==Ve&&(tt=(mt=ze-ge[Et]||r())*mt+(At=Ke-xe[Et]||r())*At,lt=Ye+ve[Et],tt<1&&(tt=Math.sqrt(1*tt)),Ce[Ve]+=mt*(xt=H*(Me*Re[Et])/tt),Le[Ve]+=At*xt)}else tt<1&&(tt=Math.sqrt(1*tt)),tt<lt*lt&&(tt=Fe*lt*lt),Ce[Ve]+=mt*(xt=H*(Me*nt.mass)/tt),Le[Ve]+=At*xt}else if((Tt=lt/De)*Tt<=tt)return tt<1&&(tt=Math.sqrt(1*tt)),tt<lt*lt&&(tt=Fe*lt*lt),Ce[Ve]+=mt*(xt=H*(Me*nt.mass)/tt),Le[Ve]+=At*xt,!0})},at=0;at<Se;at++)Qe(at);return z}function he(H,Z,z,Q){for(var de=z.sources,ge=z.targets,xe=z.X,ve=z.Y,Ce=z.R,Le=z.fx,Re=z.fy,Fe=z.degrees,De=Q.edgeStrength,Me=Q.edgeLength,Oe=0;Oe<Z.length;Oe++){var Se=Z[Oe],Qe=de[Se],at=ge[Se],Be=Fe[Qe]+1,Ve=Fe[at]+1,ze=xe[at]+Le[at]-xe[Qe]-Le[Qe]||r(),Ke=ve[at]+Re[at]-ve[Qe]-Re[Qe]||r(),Ye=ze*ze+Ke*Ke,nt=Math.sqrt(Ye),yt=Me+Ce[Qe]+Ce[at];if(!(nt<=yt)){var xt=yt-nt,Tt=H*De*xt*xt/Ye/Math.min(Be,Ve);Ke*=Tt;var mt=Ve/(Ve+Be);Le[Qe]+=(ze*=Tt)*mt,Re[Qe]+=Ke*mt,Le[at]-=ze*(1-mt),Re[at]-=Ke*(1-mt)}}}function Ee(H,Z,z,Q){for(var de=z.pinned,ge=z.X,xe=z.Y,ve=z.fx,Ce=z.fy,Le=Q.gravity,Re=Q.cx,Fe=Q.cy,De=0,Me=0,Oe=Z.length,Se=0;Se<Oe;Se++)De+=ge[Se],Me+=xe[Se];De=De/Oe-Re,Me=Me/Oe-Fe;for(var Qe=0;Qe<Oe;Qe++){var at=Z[Qe];de[at]||(ge[at]-=De,xe[at]-=Me)}for(var Be=0;Be<Oe;Be++){var Ve=Z[Be],ze=Re-ge[Ve]||r(),Ke=Fe-xe[Ve]||r(),Ye=Le*H;ve[Ve]+=ze*Ye,Ce[Ve]+=Ke*Ye}}ce.initialize=function(H,Z,z){for(var Q=Z.X,de=Z.Y,ge=Z.R,xe=Z.degrees,ve=Z.layer,Ce=Z.pinned,Le=Z.component,Re=Z.masses,Fe=Z.nodeIds,De=z.scaling,Me=z.defaultRadius,Oe=H.length,Se=1/0,Qe=1/0,at=-1/0,Be=-1/0,Ve=Math.PI*(3-Math.sqrt(5)),ze=0;ze<H.length;ze++){var Ke=H[ze],Ye=Ke.x,nt=Ke.y,yt=Ke.r,xt=Ke.mass;if(isNaN(Ye)||isNaN(nt)){var Tt=10*Math.sqrt(ze),mt=ze*Ve;Ye=Tt*Math.cos(mt),nt=Tt*Math.sin(mt)}Q[ze]=Ye,de[ze]=nt,ge[ze]=yt||Me,Ce[ze]=Ke.pinned?1:0,ve[ze]=Ke.layer,Le[ze]=Ke.component,Re[ze]=void 0===xt?(1+xe[ze])*De:xt,Fe[ze]=ze,Ye<Se&&(Se=Ye),nt<Qe&&(Qe=nt),at<Ye&&(at=Ye),Be<nt&&(Be=nt)}if(1<H.length&&(at-Se==0||Be-Qe==0))for(var At=(Se+at)/2,tt=(Qe+Be)/2,lt=0;lt<Oe;lt++)if(!Ce[lt]){var vt=10*Math.sqrt(lt),Et=lt*Ve,Bt=At+vt*Math.cos(Et),Pt=tt+vt*Math.sin(Et);(Q[lt]=Bt)<Se&&(Se=Bt),(de[lt]=Pt)<Qe&&(Qe=Pt),at<Bt&&(at=Bt),Be<Pt&&(Be=Pt)}},he.initialize=function(H,Z){for(var z=Z.edgeIds,Q=Z.sources,de=Z.targets,ge=Z.degrees,xe=0;xe<H.length;xe++){var ve=H[xe],Ce=ve.source,Le=ve.target;Q[xe]=Ce,de[xe]=Le,ge[Ce]++,ge[Le]++,z[xe]=xe}},Ee.initialize=function(H,Z,z){var Q=Z.X,de=Z.Y,ge=z.cx,xe=z.cy,ve=H.length;if(void 0===ge||void 0===xe){ge=xe=0;for(var Ce=0;Ce<ve;Ce++)ge+=Q[Ce],xe+=de[Ce];ge/=ve,xe/=ve}z.cx=ge,z.cy=xe};var it,rt,We=function(){this.ids=[],this.xmin=1/0,this.ymin=1/0,this.xmax=-1/0,this.ymax=-1/0,this.x=0,this.y=0,this.w=0,this.h=0,this.cx=0,this.cy=0,this.radius=0,this.mx=0,this.my=0,this.m=0,this.maxr=0};function _t(H,Z){return(H+Z)*(H+Z+1)/2+Z}function Ue(H,Z,z,Q){var de=z.X,ge=z.Y,xe=z.R,ve=z.components,Me=Q.update,Oe=Q.onUpdate,Se=Q.placement,Qe=Q.placementOffset;if(Q.alignSiblings&&(function(H,Z,z){var de=H.sources,ge=H.targets,xe=H.pinned,ve=H.degrees,Ce=H.X,Le=H.Y,Re=H.R;void 0===Z&&(Z=0),void 0===z&&(z=.5);for(var Fe={},De={},Me=0,Oe=H.edgeIds;Me<Oe.length;Me+=1){var Se=Oe[Me],Qe=de[Se],at=ge[Se];Qe!==at&&(Fe[Qe]=Fe[Qe]||{},Fe[at]=Fe[at]||{},Fe[Qe][at]=!0,Fe[at][Qe]=!0)}Object.keys(Fe).forEach(function(Be){var Ve,ze,Ke=Number(Be),Ye=Object.keys(Fe[Number(Ke)]);if(2===Ye.length){var nt=Ye[0],yt=Ye[1],xt=(Ve=Number(nt))<(ze=Number(yt))?Ve*ze+Math.pow(ze-Ve-1,2)/4:Ve*ze+Math.pow(Ve-ze-1,2)/4;xt in De||(De[xt]=[Number(yt),Number(nt)]),xe[Ke]||De[xt].push(Ke)}}),Object.keys(De).forEach(function(Be){var Ve=De[Number(Be)],ze=Ve[0],Ke=Ve[1],Ye=Ve.slice(2);if(1!==Ye.length){var nt=Ce[ze],yt=Le[ze],xt=Ce[Ke],Tt=Le[Ke],mt=ve[ze],At=.25+.5*mt/(mt+ve[Ke]),tt=nt+(xt-nt)*At,lt=yt+(Tt-yt)*At,vt=-(Tt-yt),Et=xt-nt,Bt=Math.sqrt(Math.pow(nt-xt,2)+Math.pow(yt-Tt,2));vt=-2*vt/Bt,Et=-2*Et/Bt;var Pt=Math.acos(vt/Math.sqrt(vt*vt+Et*Et));0<Z&&(Pt<Z||Pt>Math.PI-Z&&Pt<=Math.PI?(vt=2*Math.cos(Math.PI-Z),Et=2*Math.sin(Math.PI-Z)):(Pt>2*Math.PI-Z||Pt>=Math.PI&&Pt<Math.PI+Z)&&(vt=2*Math.cos(Z),Et=2*Math.sin(Z)));var wn=0,Kt=1;Ye.sort(function(pi,yn){return Re[yn]-Re[pi]});var Cn=0,Pn=0,Mn=Math.max(Re[Ye[0]],Re[Ye[1]])/2;Ye.length%2==1&&(wn=1,tt-=vt*Mn,lt-=Et*Mn);for(var jn=1+z,$t=0;$t<Ye.length;$t++){var dn=(wn+$t)%2,Dn=Ye[$t],In=2<=$t?Re[Dn]:Mn,On=(dn?Cn:Pn)+In;Ce[Dn]=tt+vt*Kt*On,Le[Dn]=lt+Et*Kt*On,dn?Cn+=In*jn:Pn+=In*jn,Kt=-Kt}}})}({X:de,Y:ge,R:xe,degrees:z.degrees,pinned:z.pinned,sources:z.sources,targets:z.targets,edgeIds:z.edgeIds},Q.siblingsMinAngle,Q.siblingsOffset),Me(H,de,ge)),Se in it){var ze=function(wn,Kt,Cn,Pn){for(var Mn=0,jn=[],$t=0,dn=Pn;$t<dn.length;$t+=1){for(var Dn=dn[$t],In=new We,On=0,pi=Dn;On<pi.length;On+=1){var yn=pi[On];In.add(yn,wn[yn],Kt[yn],Cn[yn])}jn.push(In.measure()),Dn.length>jn[Mn].ids.length&&(Mn=jn.length-1)}return{boxes:jn,biggest:Mn}}(de,ge,xe,ve),Ke=ze.boxes,Ye=ze.biggest;if(Se===it.spiral)!function(wn,Kt,Cn,Pn,Mn){void 0===Kt&&(Kt=20);for(var jn=0,$t=wn;jn<$t.length;jn+=1){var dn=$t[jn],Dn=L(dn.ids,function(Rn){return Cn[Rn]},function(Rn){return Pn[Rn]},function(Rn){return Mn[Rn]}),On=Dn.y,pi=Dn.r;dn.cx=Dn.x,dn.cy=On,dn.radius=pi+Kt}for(var yn=wn.slice().sort(function(Rn,uo){return Rn.radius-uo.radius}),yr=yn.map(function(Rn){return{x:Rn.cx,y:Rn.cy,r:Rn.radius}}),wi=yn.pop(),ti=3*Math.PI/2,$i=wi.radius,Ii=2*Math.PI,ki=wi.cx,Lr=wi.cy,Wr=[wi],Co=function(){var Rn=yn[yn.length-1],uo=$i+Rn.radius,ds=ki+Math.cos(ti)*uo,$s=Lr+Math.sin(ti)*uo;Wr.some(function(Vu){var eu=Vu.cx-ds,Na=Vu.cy-$s;return Math.sqrt(eu*eu+Na*Na)<Vu.radius+Rn.radius})?$i+=1:(Rn.x=ds-Rn.w/2,Rn.y=$s-Rn.h/2,Rn.cx=ds,Rn.cy=$s,yr[yn.length-1].x=ds,yr[yn.length-1].y=$s,Wr.push(yn.pop()),ti+=(2*Rn.radius+1)/uo*1%Ii)};0!==yn.length;)Co()}(Ke,Qe,de,ge,xe);else{if(Se!==it.box)return;!function(H,Z){void 0===Z&&(Z=1),function(z){for(var Q=0,de=0,ge=0,xe=z;ge<xe.length;ge+=1){var ve=xe[ge];Q+=ve.w*ve.h,de=Math.max(de,ve.w)}z.sort(function(at,Be){return Be.h-at.h});for(var Ce=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(Q/.95)),de),h:1/0}],Le=0,Re=0,Fe=0,De=z;Fe<De.length;Fe+=1)for(var Me=De[Fe],Oe=Ce.length-1;0<=Oe;Oe--){var Se=Ce[Oe];if(!(Me.w>Se.w||Me.h>Se.h)){if(Me.x=Se.x,Me.y=Se.y,Re=Math.max(Re,Me.y+Me.h),Le=Math.max(Le,Me.x+Me.w),Me.w===Se.w&&Me.h===Se.h){var Qe=Ce.pop();Oe<Ce.length&&(Ce[Oe]=Qe)}else Me.h===Se.h?(Se.x+=Me.w,Se.w-=Me.w):(Me.w===Se.w||Ce.push({x:Se.x+Me.w,y:Se.y,w:Se.w-Me.w,h:Me.h}),Se.y+=Me.h,Se.h-=Me.h);break}}}(H.map(function(z){return z.w+=z.maxr+Z,z.h+=z.maxr+Z,z}).sort(function(z,Q){return z.w*z.h-Q.w*Q.h}))}(Ke,Qe)}for(var nt=Ke[Ye].xmin-Ke[Ye].x,yt=Ke[Ye].ymin-Ke[Ye].y,xt=0,Tt=Ke;xt<Tt.length;xt+=1)for(var mt=Tt[xt],lt=mt.xmin-mt.x-nt,vt=mt.ymin-mt.y-yt,Et=0,Bt=mt.ids;Et<Bt.length;Et+=1){var Pt=Bt[Et];de[Pt]-=lt,ge[Pt]-=vt}Me(H,de,ge),Oe()}}function Ze(H,Z,z,Q,de,ge){var xe,ve=z.X,Ce=z.Y,Le=z.R,Re=z.degrees,Fe=z.nodeIds,De=z.edgeIds,Me=z.layers,Oe=z.layer,Se=z.cluster,Qe=z.masses,at=z.weights,Be=z.sources,Ve=z.targets,ze=Q.cx,Ke=Q.cy,Ye=Q.nextTick,nt=Q.cancelTick,yt=Q.update,xt=Q.onUpdate,Tt=Q.batch,At=Q.steps,tt=Q.minMovement,lt=Me.slice(),vt=0;function Et(){nt(xe),yt(H,ve,Ce),xt(),ge()}for(var Bt={},Pt=0;Pt<Z.length;Pt++)Bt[Number(Z[Pt].id)||Pt]=Pt;for(var wn=new Map,Kt=0;Kt<De.length;Kt++){var Cn=De[Kt];wn.set(_t(Be[Cn],Ve[Cn]),Cn)}for(var Pn=0;Pn<Me.length;Pn++){for(var Mn=Me[Pn],jn=Pn,$t=0;$t<Mn.length;$t++){var dn=Mn[$t],Dn=Se[dn];-1!==Dn&&(Qe[Dn]+=Qe[dn])}for(var In=0;In<Z.length;In++){var On=Z[In],pi=Number(On.id)||In,yn=On.source,yr=On.target,wi=at[Bt[pi]];if(Oe[yn]===jn&&Oe[yr]===jn){var ti=Se[yn],$i=Se[yr];if(ti!==$i){var Ii=wn.get(_t(ti,$i));void 0!==Ii&&(at[Ii]+=wi)}}}}Fe.length=0,De.length=0;var ki,Lr,Wr=1,Rn=1-Math.pow(.1,1/At/2),uo=(Wr-.1)/At,ds=.5;return xe=setTimeout(function $s(){var Vu=de(Wr+=(0-Wr)*Rn,Fe,De),eu=Wr<=ds||Vu<tt;if(0===vt||eu){var Na=lt.pop();if(Na){ki&&(Lr=ki.reduce(function(cd,hd){return Math.max(cd,ze-ve[hd],Ke-Ce[hd])},0)),Fe.push.apply(Fe,Na);for(var Ch=0;Ch<Na.length;Ch++){var La=Na[Ch],Uu=Se[La];if(-1!==Uu){var My=1<Re[La]?2:1,Iy=Le[Uu]+Le[La];Qe[Uu]-=Qe[La],ve[La]=ve[Uu]+My*Iy*(2*n()-1),Ce[La]=Ce[Uu]+My*Iy*(2*n()-1)}else ki&&(ve[La]=ze+2*Lr*(1-2*n()),Ce[La]=Ke+2*Lr*(1-2*n()))}ki=Na;for(var ky=Fe.reduce(function(cd,hd){return cd[hd]=!0,cd},{}),Th=De.length=0;Th<Z.length;Th++){var Mh=Z[Th];ky[Mh.source]&&ky[Mh.target]&&De.push(Bt[Number(Mh.id)])}eu=!1,Wr=0===lt.length?.2:.1+2*uo,ds=.1}}vt%Tt==0&&(yt(H,ve,Ce),xt()),++vt>=Infinity||eu?Et():xe=Ye($s)}),{done:!1,stop:function(){return Et(),this},get iterations(){return vt}}}function Ne(H,Z,z){for(var Q=z.X,de=z.Y,ge=z.fx,xe=z.fy,ve=z.pinned,Ce=0,Le=H.length,Re=0;Re<Le;Re++){var Fe=H[Re],De=ge[Fe]*=Z,Me=xe[Fe]*=Z;if(ve[Fe])ge[Fe]=xe[Fe]=0;else{var Oe=De,Se=Me;if(1e4<Oe||1e4<Se){var Qe=Math.sqrt(Oe*Oe+Se*Se);Se/=Qe,Oe/=Qe}Q[Fe]+=Oe,de[Fe]+=Se,Ce+=.5*(Oe*Oe+Se*Se)}}return Ce}We.prototype.add=function(H,Z,z,Q){this.ids.push(H),Z-Q<this.xmin&&(this.xmin=Z-Q),z-Q<this.ymin&&(this.ymin=z-Q),Z+Q>this.xmax&&(this.xmax=Z+Q),z+Q>this.ymax&&(this.ymax=z+Q),Q>this.maxr&&(this.maxr=Q),this.mx+=Q*Z,this.my+=Q*z,this.m+=Q},We.prototype.measure=function(H){return void 0===H&&(H=0),this.w=this.xmax-this.xmin+2*H,this.h=this.ymax-this.ymin+2*H,this.cx=this.mx/this.m,this.cy=this.my/this.m,this.x=this.xmin,this.y=this.ymin,this.radius=Math.sqrt(this.w*this.w+this.h*this.h)/2,this},(rt=it=it||{}).none="none",rt.box="box",rt.spiral="spiral";var Ge=0,Xe="undefined"==typeof window,$e="undefined"!=typeof performance&&performance.now?performance:Date,we=Xe?function(H){var Z=$e.now(),z=Math.max(0,16-(Z-Ge)),Q=setTimeout(function(){return H(Z+z)},z);return Ge=Z+z,Q}:window.requestAnimationFrame,Pe=Xe?function(H){return clearTimeout(H)}:window.cancelAnimationFrame;function je(H,Z,z){for(var Q=0;Q<H.length;Q++){var de=H[Q];de.x=Z[Q],de.y=z[Q]}}function Je(){}function ut(H){for(var Z in void 0===H&&(H={}),this.onUpdate=Je,this.update=je,this.nextTick=we,this.cancelTick=Pe,this.onEnd=Je,this.charge=10,this.maxIterations=1e3,this.minMovement=.1,this.edgeLength=30,this.edgeStrength=2,this.friction=.1,this.elasticity=.9,this.margin=1,this.cx=void 0,this.cy=void 0,this.gravity=.01,this.theta=.34,this.batch=1,this.inertia=.9,this.integrator=0,this.multilevel=!1,this.placement=it.none,this.placementOffset=10,this.alignSiblings=!1,this.siblingsMinAngle=0,this.siblingsOffset=.15,this.steps=300,this.scaling=1,this.defaultRadius=1,H)void 0!==H[Z]&&(this[Z]=H[Z])}function Xt(H){var Z=H.nodes.length,z=H.edges.length;i(Z+z),this.X=new Array(Z),this.Y=new Array(Z),this.R=new Array(Z),this.fx=new Float32Array(Z),this.fy=new Float32Array(Z),this.vx=new Float32Array(Z),this.vy=new Float32Array(Z),this.pinned=new Uint8Array(Z),this.masses=new Float32Array(Z),this.weights=new Float32Array(z),this.sources=new Uint16Array(z),this.targets=new Uint16Array(z),this.degrees=new Uint32Array(Z),this.layer=new Uint32Array(Z),this.parent=new Int32Array(Z),this.cluster=new Int32Array(Z),this.component=new Uint16Array(Z),this.components=[],this.layers=[],this.nodeIds=new Array(Z),this.edgeIds=new Array(z),function(H,Z,z){(function(Q,de,ge){for(var xe=ge.sources,ve=ge.targets,Ce=ge.degrees,Le=ge.nodeIds,Re=ge.edgeIds,Fe={},De=0;De<Q.length;De++)Fe[De]=Le[De]=De;for(var Me=0;Me<de.length;Me++){var Oe=de[Me],at=Fe[Oe.source],Be=Fe[Oe.target];Re[Me]=Me,xe[Me]=at,ve[Me]=Be,Ce[at]++,Ce[Be]++}})(H,Z,z),function(Q){for(var de=Q.nodeIds,ge=Q.edgeIds,xe=Q.sources,ve=Q.targets,Ce=Q.degrees,Le=Q.layer,Re=Q.layers,Fe=Q.component,De=Q.components,Me=Q.cluster,Oe=Q.parent,Se=0,Qe=1,at=new Uint32Array(de.length),Be=0;Be<de.length;Be++)at[Be]=Ce[Be];for(var Ve=new Array(de.length),ze=0;ze<ge.length;ze++){var Ke=ge[ze],Ye=xe[Ke],nt=ve[Ke];Ve[Ye]=Ve[Ye]||[],Ve[nt]=Ve[nt]||[],Ve[Ye].push(nt),Ve[nt].push(Ye)}var yt=new Uint8Array(de.length),xt=new Uint8Array(de.length);Oe.fill(-1);for(var Tt=0,mt=0;mt<de.length;mt++)if(0===yt[mt]){for(var At=[mt];0!==At.length;){var tt=At.pop();0===yt[tt]&&(At.push.apply(At,Ve[tt]),yt[tt]=1,Fe[tt]=Tt)}Tt++}for(var lt=new Array(de.length),vt=0;vt<de.length;vt++)Le[vt]=0,lt[vt]=vt;for(;0!==lt.length;){for(var Et=[],Bt=[],Pt=0;Pt<lt.length;Pt++)at[lt[Pt]]<=Se&&(Et.push(Pt),Bt.push(lt[Pt]));for(var wn=0;wn<Bt.length;wn++){var Kt=Bt[wn];xt[Kt]=Se,Le[Kt]=Qe;var Cn=Ve[Kt];if(Cn)for(var Pn=0;Pn<Cn.length;Pn++)at[Cn[Pn]]--}for(var Mn=0;Mn<Bt.length;Mn++){var jn=Bt[Mn],$t=Ve[jn];if($t)for(var dn=0;dn<$t.length;dn++){var Dn=$t[dn],In=Le[Dn];if(void 0===In||Qe<In){Oe[jn]=Dn;break}}}Et.reverse();for(var On=0;On<Et.length;On++)lt.splice(Et[On],1);if(Qe+=1,0<lt.length){for(var pi=1/0,yn=0;yn<lt.length;yn++){var yr=at[lt[yn]];yr<pi&&(pi=yr)}Se+1<=pi&&(Se=pi,Qe=1)}}yt.fill(0);for(var wi=0;wi<de.length;wi++){var ti=de[wi],$i=Le[ti];if(-1===Oe[ti]||Le[Oe[ti]]===$i){var Ii=[ti];for(yt.fill(0);0!==Ii.length;){var ki=Ii.pop();if(!yt[ki]){if(Le[ki]>$i){Oe[ti]=ki;break}var Lr=Ve[ki];yt[ki]=1,Lr&&Ii.push.apply(Ii,Lr)}}}}for(var Wr=0;Wr<de.length;Wr++){var Co=de[Wr],Rn=Fe[Co];De[Rn]=De[Rn]||[],De[Rn].push(Co);var uo=Le[Co]-1;Re[uo]=Re[uo]||[],Re[uo].push(Co),Me[Co]=Oe[Co]}}(z)}(H.nodes,H.edges,this)}function an(H){this.promise=new Promise(H)}an.prototype.then=function(H){return this.promise.then(H)},an.prototype.stop=function(){return this.simulation.stop(),this},an.prototype.iterations=function(){return this.simulation.iterations};var nn={euler:function(H,Z,z){for(var Q=z.X,de=z.Y,ge=z.fx,xe=z.fy,ve=z.vx,Ce=z.vy,Le=z.masses,Re=z.pinned,Fe=0,De=0,Me=H.length,Oe=0;Oe<Me;Oe++){var Se=H[Oe],Qe=Le[Se],at=ge[Se]/Qe,Be=xe[Se]/Qe;ve[Se]+=1/8*at,Ce[Se]+=1/8*Be;var Ve=.2*ve[Se]*(1/8)+.5*at*(1/8)*(1/8),ze=.2*Ce[Se]*(1/8)+.5*Be*(1/8)*(1/8);ge[Se]=xe[Se]=0,Re[Se]||(Q[Se]+=Ve,de[Se]+=ze,Fe+=Math.abs(Ve)*Qe,De+=Math.abs(ze)*Qe)}return(Fe*Fe+De*De)/Me},verlet:Ne,leapfrog:function(H,Z,z){for(var Q=z.X,de=z.Y,ge=z.fx,xe=z.fy,ve=z.vx,Ce=z.vy,Le=z.pinned,Re=z.masses,Fe=H.length,De=0,Me=0;Me<Fe;Me++){var Oe=H[Me],Se=Re[Oe],Be=ve[Oe]+ge[Oe]/Se*1,Ve=Ce[Oe]+xe[Oe]/Se*1,ze=1*Be,Ke=1*Ve;1e4<ze&&(ze=.1),1e4<Ke&&(Ke=.1),ve[Oe]=Z*(Be+ve[Oe])/2,Ce[Oe]=Z*(Ve+Ce[Oe])/2,ge[Oe]=xe[Oe]=0,Le[Oe]||(Q[Oe]+=ze,de[Oe]+=Ke),De+=.5*(ze*ze+Ke*Ke)}return De}};function ln(H,Z){var z,Q;function de(De){return void 0===De&&(De={nodes:[],edges:[]}),i(_t((z=De.nodes).length,(Q=De.edges).length)),new Xt(De)}function ge(De){return void 0===De&&(De={}),new ut(De)}void 0===Z&&(Z={});var xe=de(H),ve=ge(Z);function Ce(De,Me,Oe){return Fe=null,Me.length<=1?0:(Fe=ce(De,Me,Fe,xe,ve),he(De,Oe,xe,ve),0!==ve.elasticity&&function(Se,Qe,at,Be){var Ve=at.X,ze=at.Y,Ke=at.R,Ye=at.fx,nt=at.fy,yt=Be.margin,xt=Be.elasticity;if(0!==xt){if(!Qe){var Tt=Math.floor(Math.log(Se.length));(Qe=new C(Se,{getX:function(tt){return Ve[tt]},getY:function(tt){return ze[tt]},bucketSize:Tt})).postOrder(function(tt){var lt,vt,Et,Bt,Pt;if(tt.data)lt=Ve[Pt=tt.data],vt=ze[Pt],Et=Ke[Pt];else if(tt.left&&tt.right){var wn=tt.left.cx,Kt=tt.left.cy,Cn=tt.right.cx,Pn=tt.right.cy,Mn=tt.left.r,jn=tt.right.r,$t=Cn-wn,dn=Pn-Kt,Dn=jn-Mn,In=Math.sqrt($t*$t+dn*dn);lt=(wn+Cn+$t/In*Dn)/2,vt=(Kt+Pn+dn/In*Dn)/2,Et=(In+Mn+jn)/2}else(Bt=tt.left||tt.right)&&(lt=Bt.cx,vt=Bt.cy,Et=Bt.r);tt.cx=lt,tt.cy=vt,tt.r=Et})}for(var mt=function(tt){var lt=Se[tt],vt=Ve[lt]+Ye[lt],Et=ze[lt]+nt[lt],Bt=Ke[lt];Qe.preOrder(function(Pt){if(!Pt.data){var wn=Pt.cx-vt,Kt=Pt.cy-Et,Cn=Pt.r+Bt;return Cn*Cn<wn*wn+Kt*Kt}if(Pt.data.length)for(var Pn=0;Pn<Pt.data.length;Pn++){var Mn=Pt.data[Pn];if(lt<Mn){var jn=Ke[Mn],$t=vt-Ve[Mn],dn=Et-ze[Mn],Dn=Bt+jn+yt,In=$t*$t+dn*dn;if(In<Dn*Dn){0===$t&&(In+=($t=r())*$t),0===dn&&(In+=(dn=r())*dn);var On=(Dn-(In=Math.sqrt(In)))*xt/In,pi=jn/Dn;Ye[lt]+=$t*On*pi,nt[lt]+=dn*On*pi,Ye[Mn]-=$t*On*(1-pi),nt[Mn]-=dn*On*(1-pi)}}}else{var yn=Pt.data;if(lt<yn){var yr=Ke[yn],wi=vt-Ve[yn],ti=Et-ze[yn],$i=Bt+yr+yt,Ii=wi*wi+ti*ti;if(Ii<$i*$i){0===wi&&(Ii+=(wi=r())*wi),0===ti&&(Ii+=(ti=r())*ti);var ki=($i-(Ii=Math.sqrt(Ii)))*xt/Ii,Lr=yr/$i;Ye[lt]+=wi*ki*Lr,nt[lt]+=ti*ki*Lr,Ye[yn]-=wi*ki*(1-Lr),nt[yn]-=ti*ki*(1-Lr)}}}})},At=0;At<Se.length;At++)mt(At)}}(Me,Fe,xe,ve),Ee(De,Me,xe,ve),Re(Me,ve.inertia,xe))}de(H),ge(Z),he.initialize(Q,xe),ce.initialize(z,xe,ve),Ee.initialize(z,xe,ve);var Le,Re=nn[ve.integrator]||Ne,Fe=null;return{setOptions:ge,setGraph:de,start:function(){return Le=(ve.multilevel?Ze:function(De,Me,Oe,Se,Qe,at){function Be(){wn=!0,xt(Ve),vt(),at()}var Ve,ze=Oe.X,Ke=Oe.Y,Ye=Oe.nodeIds,nt=Oe.edgeIds,yt=Se.nextTick,xt=Se.cancelTick,Tt=Se.batch,mt=Se.maxIterations,tt=Se.minMovement,lt=Se.update,vt=Se.onUpdate,Et=0,Bt=1,Pt=1-Math.pow(.1,1/Se.steps),wn=!1,Kt=function(){var Cn=Qe(Bt+=(0-Bt)*Pt,Ye,nt),Pn=wn||Bt<.1||Cn<=tt;Et%Tt==0&&(lt(De,ze,Ke),vt()),++Et<mt&&!Pn?Ve=yt(Kt):Be()};return Ve=setTimeout(Kt),{done:!1,stop:function(){return Be(),this},get iterations(){return Et}}})(z,Q,xe,ve,Ce,function(){Le.done||Ue(z,0,xe,ve),ve.onEnd(),Le.done=!0}),this},iterations:function(){return Le.iterations},data:function(){return xe},stop:function(){return Le&&Le.stop(),this},step:function(De){return void 0===De&&(De=1),Ce(De,xe.nodeIds,xe.edgeIds),this}}}return ln.run=function(H,Z){var z,Q=new an(function(de){Z.onEnd=de,z=ln(H,Z).start()});return Q.simulation=z,Q.stop=function(){return z.stop(),Q},Q.iterations=function(){return z.iterations},Q},ln}().apply(this,arguments)}var bS={imports:{force:yv},configure:function(e,t){var n=t.graph,i=e.nodes._indexes,r=n.getNodeAttribute("x").getMultiple(i),o=n.getNodeAttribute("y").getMultiple(i),a=n.getNodeAttribute("radius").getMultiple(i),s=n.getNodeAttribute("layoutable").getMultiple(i),l=e.nodes.getAdjacentEdges(),u=[],d=[],c={};e.edgeStrength=void 0!==e.edgeStrength?1.5*e.edgeStrength:.75,null==e.gravity&&(e.gravity=.05),null==e.siblingsOffset&&(e.siblingsOffset=0),e.alignSiblings=!!e.alignSiblings;for(var h=e.radiusRatio||1.25,p=0;p<e.nodes._indexes.length;p++)c[e.nodes._indexes[p]]=p,u.push({id:p,x:r[p],y:o[p],r:a[p]*h,pinned:!s[p]});l.forEach(function(b){var v=c[b.getSource()._index],y=c[b.getTarget()._index];v!==y&&void 0!==v&&void 0!==y&&d.push({source:v,target:y})});var m=qi(Mt({},e));return delete m.nodes,{graph:{nodes:u,edges:d},options:m,indexes:e.nodes._indexes,done:!1,x:r,y:o}},update:function(e,t){if(!t.simulation){t.graph=e.graph,t.options=e.options,t.indexes=e.indexes,e.options.nextTick=function(a){return a()},e.options.update=function(a,s,l){t.x=s,t.y=l},e.options.onEnd=function(){return t.done=!0};var n=yv(e.graph,e.options).start(),i=n.data(),r=i.X,o=i.Y;t.simulation=n,t.x=r,t.y=o}return{graph:t.graph,indexes:t.indexes,x:t.x,y:t.y}},context:function(){return{done:!1,graph:null,x:null,y:null,indexes:null}},isRunning:function(e){return!e.done},onSync:function(e){return{indexes:e.indexes,x:e.x,y:e.y}}};function xv(e,t,n,i){var r;if(i)r=i;else{r=new Uint32Array(e.length);for(var o=0,a=e.length;o<a;o++)r[o]=o}var s=n?function(d,c,h,p,g,m){var b=h-d,v=p-c,y=m-g,S=Math.sqrt(b*b+v*v);return[(d+h+b/S*y)/2,(c+p+v/S*y)/2,(S+g+m)/2]}:function(d,c,h,p){var g=d-h,m=c-p;return[(d+h)/2,(c+p)/2,Math.sqrt(g*g+m*m)/2]},l=n?function(d,c,h,p,g,m,b,v,y){var S=2*(d-h),A=2*(c-p),C=2*(v-b),O=d*d+c*c-b*b-h*h-p*p+v*v,N=2*(d-g),P=2*(c-m),F=2*(y-b),L=d*d+c*c-b*b-g*g-m*m+y*y,B=N*A-S*P,Y=(A*L-P*O)/B-d,X=(P*C-A*F)/B,ae=(N*O-S*L)/B-c,ie=(S*F-N*C)/B,U=X*X+ie*ie-1,W=2*(Y*X+ae*ie+b),he=(-W-Math.sqrt(W*W-4*U*(Y*Y+ae*ae-b*b)))/(2*U);return[Y+X*he+d,ae+ie*he+c,he]}:function(d,c,h,p,g,m){var b=2*(d*(p-m)+h*(m-c)+g*(c-p));if(0==b)return null;var v=((d*d+c*c)*(p-m)+(h*h+p*p)*(m-c)+(g*g+m*m)*(c-p))/b,y=((d*d+c*c)*(g-h)+(h*h+p*p)*(d-g)+(g*g+m*m)*(h-d))/b,S=v-d,A=y-c;return[v,y,Math.sqrt(S*S+A*A)]},u=n?Xf:Yf;return n=n||[],function d(c,h,p,g,m,b,v,y,S){var A,C,O,N,F,L,B,Y,X,ae,ie=null;if(0===p||3===h.length)C=g,O=m,N=b,F=S,X=null,1===(ae=(A=h).length)?X=[C[L=A[0]],O[L],N[L]||0]:2===ae?X=y(C[L=A[0]],O[L],C[B=A[1]],O[B],N[L],N[B]):3===ae&&(X=F(C[L=A[0]],O[L],C[B=A[1]],O[B],C[Y=A[2]],O[Y],N[L],N[B],N[Y])),ie=X;else{var U=c[p-1];null!==(ie=d(c,h,p-1,g,m,b,v,y,S))&&v(ie,g[U],m[U],b[U])||(h.push(U),ie=d(c,h,p-1,g,m,b,v,y,S),h.pop())}return ie}(r=function(d){for(var c=d.length-1;0<=c;c--){var h=Math.floor(Math.random()*(c+1));h=Math.max(Math.min(h,c),0);var p=d[c];d[c]=d[h],d[h]=p}return d}(r),[],r.length,e,t,n,u,s,l)}function bv(e){for(var t,n,i,r=e.length,o=[0,1],a=2,s=2;s<r;s++){for(;1<a&&((n=e[o[a-1]])[0]-(t=e[o[a-2]])[0])*((i=e[s])[1]-t[1])-(n[1]-t[1])*(i[0]-t[0])<=0;)--a;o[a++]=s}return o.slice(0,a)}function rh(e){var t=e.length;if(t<3)return null;for(var n=new Array(t),i=new Array(t),r=0;r<t;r++)n[r]=[+e[r][0],+e[r][1],r];for(n.sort(function(h,p){return h[0]-p[0]||h[1]-p[1]}),r=0;r<t;r++)i[r]=[n[r][0],-n[r][1]];var o=bv(n),a=bv(i),u=a[0]===o[0],d=a[a.length-1]===o[o.length-1]?1:0,c=[];for(r=o.length-1;0<=r;--r)c.push(e[n[o[r]][2]]);for(r=+u;r<a.length-d;r++)c.push(e[n[a[r]][2]]);return c}var oh,Ev=(function(e){function t(h){if(!(this instanceof t))return new t(h);this.points=h||[]}function n(h,p,g){return 0<(p[0]-h[0])*(g[1]-h[1])-(p[1]-h[1])*(g[0]-h[0])}function i(h,p){return n(h,p.dest,p.orig)}function r(h,p){return n(h,p.orig,p.dest)}function o(h,p){return i(h.dest,p)}function a(h,p,g,m){if(h[0]===m[0]&&h[1]===m[1]||p[0]===m[0]&&p[1]===m[1]||g[0]===m[0]&&g[1]===m[1])return!1;var v=p[0]*p[0]+p[1]*p[1],y=g[0]*g[0]+g[1]*g[1],S=m[0]*m[0]+m[1]*m[1],A=y-S,C=g[1]-m[1],O=g[1]*S-y*m[1],N=g[0]-m[0],P=g[0]*S-y*m[0],F=g[0]*m[1]-g[1]*m[0];return 1<h[0]*(p[1]*A-v*C+O)-h[1]*(p[0]*A-v*N+P)+(h[0]*h[0]+h[1]*h[1])*(p[0]*C-p[1]*N+F)-p[0]*O+p[1]*P-v*F}function s(h,p,g){this.onext=h,this.rot=p,this.orig=g,this.mark=!1}function l(h,p){var g=new s(null,null,h),m=new s(null,null,null),b=new s(null,null,p),v=new s(null,null,null);return g.onext=g,b.onext=b,(m.onext=v).onext=m,(((g.rot=m).rot=b).rot=v).rot=g}function u(h,p){var g=h.onext.rot,m=p.onext.rot,b=h.onext,v=m.onext,y=g.onext;h.onext=p.onext,p.onext=b,g.onext=v,m.onext=y}function d(h,p){var g=l(h.dest,p.orig);return u(g,h.lnext),u(g.sym,p),g}function c(h){u(h,h.oprev),u(h.sym,h.sym.oprev)}t.prototype={triangulate:function(){var h=this.points;h.sort(function(A,C){return A[0]===C[0]?A[1]-C[1]:A[0]-C[0]});for(var p=h.length-1;1<=p;p--)h[p][0]===h[p-1][0]&&h[p][1]===h[p-1][1]&&h.splice(p,1);if(h.length<2)return{};for(var g=function A(C){var O,N,P,F;if(2===C.length)return{le:O=l(C[0],C[1]),re:O.sym};if(3===C.length)return O=l(C[0],C[1]),N=l(C[1],C[2]),u(O.sym,N),n(C[0],C[1],C[2])?(P=d(N,O),{le:O,re:N.sym}):n(C[0],C[2],C[1])?{le:(P=d(N,O)).sym,re:P}:{le:O,re:N.sym};for(var L=Math.ceil(C.length/2),B=A(C.slice(0,L)),Y=A(C.slice(L)),X=B.le,ae=B.re,ie=Y.le,U=Y.re;;)if(r(ie.orig,ae))ae=ae.lnext;else{if(!i(ae.orig,ie))break;ie=ie.rprev}var W=d(ie.sym,ae);for(ae.orig===X.orig&&(X=W.sym),ie.orig===U.orig&&(U=W);;){var ce=W.sym.onext;if(o(ce,W))for(;a(W.dest,W.orig,ce.dest,ce.onext.dest);)F=ce.onext,c(ce),ce=F;var he=W.oprev;if(o(he,W))for(;a(W.dest,W.orig,he.dest,he.oprev.dest);)F=he.oprev,c(he),he=F;if(!o(ce,W)&&!o(he,W))break;W=!o(ce,W)||o(he,W)&&a(ce.dest,ce.orig,he.orig,he.dest)?d(he,W.sym):d(W.sym,ce.sym)}return{le:X,re:U}}(h).le,m=[],b=0,v=[g];r(g.onext.dest,g);)g=g.onext;for(var y=g;v.push(y.sym),y.mark=!0,(y=y.lnext)!==g;);do{var S=v[b++];if(!S.mark)for(y=S;m.push(y.orig),y.sym.mark||v.push(y.sym),y.mark=!0,(y=y.lnext)!=S;);}while(b<v.length);return m}},s.prototype={get sym(){return this.rot.rot},get dest(){return this.sym.orig},get rotSym(){return this.rot.sym},get oprev(){return this.rot.onext.rot},get dprev(){return this.rotSym.onext.rotSym},get lnext(){return this.rotSym.onext.rot},get lprev(){return this.onext.sym},get rprev(){return this.sym.onext}},t.prototype.ccw=n,t.prototype.rightOf=i,t.prototype.leftOf=r,t.prototype.inCircle=a,e.exports=t}(oh={exports:{}}),oh.exports);function Sv(e,t,n,i,r){if(void 0===t&&(t=1),void 0===n&&(n=0),!i||!r){var o=e.map(function(F){return[F.x,F.y]});i=new Ev(o.slice()).triangulate(),r=rh(o)}for(var a,u,g,m,b=n*n,v=[],y={},S=0;S<i.length;S+=3)ES(r,ah(i[S],i[S+1],i[S+2]))&&b<(N=(g=(u=ah(a=i[S],i[S+1],i[S+2]))[0]-a[0])*g+(m=u[1]-a[1])*m)&&(v.push(S),y[S]=N);if(0===v.length)return[];v.sort(function(F,L){return y[F]-y[L]});var A=v[0],C=y[A],O=[];for(S=0;S<v.length;S++){var N,P=v[S];C<(N=y[P])&&b<N&&(C=N,O.push(A=P),O.length>t&&O.shift())}return O.map(function(F){return function(L,B,Y){for(var X=arguments,ae=ah(L,B,Y),ie=0,U=0;U<3;U++){var W=X[U],ce=W[0]-ae[0],he=W[1]-ae[1],Ee=Math.sqrt(ce*ce+he*he);ie<Ee&&(ie=Ee)}return[ae[0],ae[1],ie]}(i[F],i[F+1],i[F+2])})}function ES(e,t){for(var n=e.length,i=e[n-1],r=t[0],o=t[1],a=i[0],s=i[1],l=!1,u=0;u<n;u++){var d=e[u],c=d[0],h=d[1];o<h!=o<s&&r<(a-c)*(o-h)/(s-h)+c&&(l=!l),a=c,s=h}return l}function ah(e,t,n){var i=[(e[0]+t[0])/2,(e[1]+t[1])/2],r=[(t[0]+n[0])/2,(t[1]+n[1])/2],o=-1/((t[1]-e[1])/(t[0]-e[0])),a=-1/((n[1]-t[1])/(n[0]-t[0])),s=i[1]-o*i[0],l=(s-(r[1]-a*r[0]))/(a-o);return[l,o*l+s]}function wS(e,t,n){var i=t.duration,r=void 0===i?0:i,o=t.margin,a=void 0===o?5:o,l=t.nodes,u=t.referenceNodes;!u||u instanceof or||(u=e.getNodes(u));var d=u||l.inverse(),c=d.getPosition().map(function(Ue){return[Ue.x,Ue.y]}),h=n,p=l.getBoundingBox(),g=d.getBoundingBox();g.pad(g.maxScaledSize);var m,b,v,y,S,A,N,P=xv(h.map(function(Ue){return Ue.x}),h.map(function(Ue){return Ue.y}),l.getAttribute("radius")),F=P[0],L=P[1],B=P[2]+g.maxScaledSize+a,Y=0,X=0;if(function(Ue,Ze,Ne,Ge){for(var Xe=0;Xe<Ue.length;Xe++){var $e=Ue[Xe],Pe=$e[1],je=Math.abs($e[0]-Ze),Je=Math.abs(Pe-Ne);if(je+Je<=Ge||!(Ge<je||Ge<Je)&&je*je+Je*Je<=Ge*Ge)return!0}return!1}(c,F,L,B))if(d.size<=3){if(lc(F,L,P[2],g.minX,g.minY,g.maxX,g.maxY)){var ae=function(Ue,Ze,Ne){for(var Ge,Xe=ff(Ne.cx,Ne.cy,Ue,Ze,Ne.minX,Ne.minY,Ne.maxX,Ne.maxY),$e=1/0,we={x:Ne.maxX,y:Ze},Pe=0,je=Xe;Pe<je.length;Pe++){var Je=je[Pe];(Ge=vi(Ue,Ze,Je.x,Je.y))<$e&&($e=Ge,we=Je)}return we}(F,L,g);m=vi(g.cx,g.cy,ae.x,ae.y);var ie={x:(S=g.cx)+(N=(m+B)/m)*(ae.x-S),y:(A=g.cy)+N*(ae.y-A)};Y=ie.x-F,X=ie.y-L}}else{var U=new Ev(c.slice()).triangulate(),W=3<c.length?rh(c):(v=(b=g).bottomLeft(),y=b.topRight(),[[v.x,v.y],[v.x,y.y],[y.x,y.y],[y.x,v.y]]),ce=Sv(d.getPosition(),10,B,U,W);if(ae=function(e,t,n){for(var i,r,o=1/0,a=0,s=t.length;a<s;a++){var l=t[a],u=t[(a+1)%s],d=Jd(e[0],e[1],l[0],l[1],u[0],u[1]);d<o&&(o=d,i=l,r=u)}return v=n,y=_f(e[0],e[1],p=i[0],g=i[1],m=r[0],b=r[1]),S=-(g-b),A=p-m,C=Math.sqrt(S*S+A*A),[y.x-v*(S/=C),y.y-v*(A/=C)];var p,g,m,b,v,y,S,A,C}([F,L],W,B),0<ce.length){for(var he=Math.pow(F-ae[0],2)+Math.pow(L-ae[1],2),Ee=0,Te=ce;Ee<Te.length;Ee++){var it=Te[Ee];(m=(Y=F-it[0])*Y+(X=L-it[1])*X)<he&&(he=m,ae=it.slice(0,2))}Y=ae[0]-F,X=ae[1]-L}else Y=ae[0]-p.cx,X=ae[1]-p.cy}var rt={layoutName:"incremental",ids:l.getId(),positions:{before:h,current:h}};if(Y||X){var We=h.map(function(Ue){return Ue.x+=Y,Ue.y+=X,Ue});if(t.locate){"boolean"==typeof t.locate&&(t.locate={});var _t=e.modules.locate.layoutDataBoundingBox({x:c.map(function(Ue){return Ue[0]}).concat(We.map(function(Ue){return Ue.x})),y:c.map(function(Ue){return Ue[1]}).concat(We.map(function(Ue){return Ue.y})),indexes:e.getNodes()._indexes}),wt=e.modules.locate.computeConfigForBounds(_t,t.locate);e.modules.camera.setView(wt,{duration:r,easing:t.locate.easing,ignoreZoomLimits:!0})}return rt.positions.current=We,l.setAttributes(We,r).then(function(){return rt})}return l.setAttributes(h,r).then(function(){return rt})}function Av(e,t,n){var i=rn(t);return i.duration=0,i.dryRun=!0,i.locate=!1,delete i.incremental,n(i).then(function(r){return wS(e,t,r.positions.current)})}function wv(e,t,n){var r=t.duration,o=t.centralNode,a=t.nodes,s=a.reduce(function(d,c){return d[c._index]=!0,d},{}),l=e.getNodes();if(t.focusOnGroupShape)return n({nodes:a,duration:0}).then(function(){var d=a.concat(o),c=d.getAttribute("layoutable");return d.setAttributes({layoutable:!1}),n({nodes:e.getNodes(),duration:r}).then(function(){return d.setAttributes(c)})});var u=rn(t);return delete u.centralNode,u.incremental=!1,u.nodes=l,u.nodeMass=function(d,c){return(c+1)*(s[d._index]?1:2)},n(u)}function Cv(e,t,n){var i=e.nodes,r=e.centralNode;if(!i||0===i.size)throw new Error("Incremental layout: no nodes are selected");if("boolean"!=typeof e.incremental&&"margin"in e.incremental&&!isFinite(e.incremental.margin))throw new Error("Incremental layout: margin has to be a positive number");var o=rn(e);return"boolean"!=typeof e.incremental&&(o.margin=e.incremental.margin,o.referenceNodes=e.incremental.referenceNodes),r&&!r.getAttribute("layoutable")?wv(t,o,n):(o.nodes=o.nodes instanceof or?o.nodes:t.getNodes(o.nodes),Av(t,o,n))}var CS={configure:function(e,t){var n,i,r,o=t.graph,a=t.camera,s=e.nodes,l=s._indexes,u={},d={},c=l.length,h=o.getObjectList(!0),p=o.getObjectList(!1);e.nodes&&delete(e=rn(e)).nodes;var g=o.getNodeAttribute("innerStroke.width").getMultiple(l),m=o.getNodeAttribute("outerStroke.width").getMultiple(l),b=o.degrees(l),v=o.getNodeAttribute("x").getMultiple(l),y=o.getNodeAttribute("y").getMultiple(l),S=o.getNodeAttribute("radius").getMultiple(l),A=o.nodeList(l).getAttribute("layoutable"),C="function"==typeof e.nodeMass?e.nodeMass:function(We,_t,wt){return _t+1};delete e.nodeMass;var O="function"==typeof e.edgeWeight?e.edgeWeight:function(We){return 1};delete e.edgeWeight,isFinite(e.scalingRatio)||delete e.scalingRatio;var N=l.reduce(function(We,_t,wt){return A[wt]||(We[_t]=!0),We},{}),P=0,F=0,L=0,B=a.getZoom();for(r=0;r<l.length;++r){var Y=l[r],ie=S[r]+(g[r]+m[r])/B;u[Y]={id:Y,x:v[r],y:y[r],degree:b[r],size:ie,pinned:!!N[Y],mass:C(h.get(Y),b[r],r)},L=Math.max(ie,L)}if(1<c)for(r=0;r<c;r++){var U=u[l[r]];P+=U.x,F+=U.y}var W={x:P/=c,y:F/=c},ce=s.getAdjacentEdges();i=(n=ce._indexes).length;var he=ce.getSource()._indexes,Ee=ce.getTarget()._indexes;for(r=0;r<i;r++){var Te=n[r],it=he[r],rt=Ee[r];u[it]&&u[rt]&&(d[Te]={source:it,target:rt},d[Te].weight=O(p.get(Te)))}return{nodes:u,edges:d,maxSize:L,config:qi(e),barycentre:W}},context:function(){return{}},update:function(e,t){var n,i,r,o;t.W?n=t.W:(t.W=n={ppn:10,ppe:3,ppr:9,MAX_SUBDIVISION_RETRIES:3,maxForce:10,iterations:0,converged:!1,settings:{linLogMode:!1,outboundAttractionDistribution:!1,adjustSizes:!1,edgeWeightInfluence:0,scalingRatio:100,strongGravityMode:!0,gravity:1,slowDown:1,barnesHutOptimize:!1,barnesHutTheta:.5,startingIterations:10,iterationsPerRender:10,maxIterations:1e3,avgDistanceThreshold:.01,autoStop:!0,alignNodeSiblings:!0,nodeSiblingsScale:5,nodeSiblingsAngleMin:0}},r=(i=e).config,o=function(d,c){var h,p,g,m,b=d.nodes,v=d.edges,y=d.maxSize,S=Object.keys(d.nodes),A=Object.keys(d.edges),C=S.length*n.ppn,O=A.length*n.ppe,N={},P=Math.pow(10,Math.log(Math.max(y,1))-6),F=P/2,L=Math.random,B=c.randomizeFactor||1;m="locally"===c.randomize?function(he){return he+L()*B}:"globally"===c.randomize?function(he){return L()*B}:function(he){return he+L()*P-F};var Y=new Float32Array(C),X=new Float32Array(O);for(h=p=0,g=S.length;h<g;h++){var ae=S[h],ie=b[ae],U=ie.x,W=ie.y;ie.pinned||(U=m(U),W=m(W)),N[ae]=p,Y[p]=U,Y[p+1]=W,Y[p+2]=0,Y[p+3]=0,Y[p+4]=0,Y[p+5]=0,Y[p+6]=ie.mass,Y[p+7]=1,Y[p+8]=ie.size,Y[p+9]=ie.pinned||0,p+=n.ppn}for(h=p=0,g=A.length;h<g;h++){var ce=v[ae=A[h]];X[p]=N[ce.source],X[p+1]=N[ce.target],X[p+2]=ce.weight||0,p+=n.ppe}return{nodes:Y,edges:X}}(i,r),t.NodeMatrix=o.nodes,t.EdgeMatrix=o.edges,n.nodesLength=t.NodeMatrix.length,n.edgesLength=t.EdgeMatrix.length,n.settings=function(d,c){for(var h in d)c[h]=d[h];return c}(e.config,n.settings),t.nodes=e.nodes,t.edges=e.edges,t.barycentre=e.barycentre);var a,s=t.NodeMatrix,l=t.EdgeMatrix;function u(){var d,c,h,p,g,m,b,v,y,S,A,C,O,N,P,F,L;for(h=0;h<n.nodesLength;h+=n.ppn)s[h+4]=s[h+2],s[h+5]=s[h+3],s[h+2]=0,s[h+3]=0;if(n.settings.outboundAttractionDistribution){for(h=y=0;h<n.nodesLength;h+=n.ppn)y+=s[h+6];y/=n.nodesLength}if(n.settings.barnesHutOptimize){var B,Y,X,ae,ie=1/0,U=-1/0,W=1/0,ce=-1/0;for(a=[],h=0;h<n.nodesLength;h+=n.ppn)ie=Math.min(ie,s[h+0]),U=Math.max(U,s[h+0]),W=Math.min(W,s[h+1]),ce=Math.max(ce,s[h+1]);var he=U-ie,Ee=ce-W;for(Ee<he?ce=(W-=(he-Ee)/2)+he:U=(ie-=(Ee-he)/2)+Ee,a[0]=-1,a[1]=(ie+U)/2,a[2]=(W+ce)/2,a[3]=Math.max(U-ie,ce-W),a[4]=-1,a[5]=-1,a[6]=0,a[7]=0,d=1,h=a[8]=0;h<n.nodesLength;h+=n.ppn)for(c=0,X=n.MAX_SUBDIVISION_RETRIES;;){if(!(0<=a[c+5])){if(a[c+0]<0){a[c+0]=h;break}if(a[c+5]=d*n.ppr,b=a[c+3]/2,a[(v=a[c+5])+0]=-1,a[v+1]=a[c+1]-b,a[v+2]=a[c+2]-b,a[v+3]=b,a[v+4]=v+n.ppr,a[v+5]=-1,a[v+6]=0,a[v+7]=0,a[v+8]=0,a[(v+=n.ppr)+0]=-1,a[v+1]=a[c+1]-b,a[v+2]=a[c+2]+b,a[v+3]=b,a[v+4]=v+n.ppr,a[v+5]=-1,a[v+6]=0,a[v+7]=0,a[v+8]=0,a[(v+=n.ppr)+0]=-1,a[v+1]=a[c+1]+b,a[v+2]=a[c+2]-b,a[v+3]=b,a[v+4]=v+n.ppr,a[v+5]=-1,a[v+6]=0,a[v+7]=0,a[v+8]=0,a[(v+=n.ppr)+0]=-1,a[v+1]=a[c+1]+b,a[v+2]=a[c+2]+b,a[v+3]=b,a[v+4]=a[c+4],a[v+5]=-1,a[v+6]=0,a[v+7]=0,a[v+8]=0,d+=4,B=s[a[ae=c+0]+0]<a[c+1]?s[a[ae]+1]<a[c+2]?a[c+5]:a[c+5]+n.ppr:s[a[ae]+1]<a[c+2]?a[c+5]+2*n.ppr:a[c+5]+3*n.ppr,a[c+6]=s[a[ae]+6],a[c+7]=s[a[ae]+0],a[c+8]=s[a[ae]+1],a[B+0]=a[c+0],a[c+0]=-1,B===(Y=s[h+0]<a[c+1]?s[h+1]<a[c+2]?a[c+5]:a[c+5]+n.ppr:s[h+1]<a[c+2]?a[c+5]+2*n.ppr:a[c+5]+3*n.ppr)){if(X--){c=B;continue}X=n.MAX_SUBDIVISION_RETRIES;break}a[Y+0]=h;break}B=s[h+0]<a[c+1]?s[h+1]<a[c+2]?a[c+5]:a[c+5]+n.ppr:s[h+1]<a[c+2]?a[c+5]+2*n.ppr:a[c+5]+3*n.ppr,a[c+7]=(a[c+7]*a[c+6]+s[h+0]*s[h+6])/(a[c+6]+s[h+6]),a[c+8]=(a[c+8]*a[c+6]+s[h+1]*s[h+6])/(a[c+6]+s[h+6]),a[c+6]+=s[h+6],c=B}}if(n.settings.barnesHutOptimize)for(S=n.settings.scalingRatio,h=0;h<n.nodesLength;h+=n.ppn)for(c=0;;)if(0<=a[c+5]){if(F=Math.sqrt((s[h+0]-a[c+7])*(s[h+0]-a[c+7])+(s[h+1]-a[c+8])*(s[h+1]-a[c+8])),2*a[c+3]/F<n.settings.barnesHutTheta){if(A=s[h+0]-a[c+7],C=s[h+1]-a[c+8],n.settings.adjustSizes?0<F?(s[h+2]+=A*(L=S*s[h+6]*a[c+6]/F/F),s[h+3]+=C*L):F<0&&(s[h+2]+=A*(L=-S*s[h+6]*a[c+6]/F),s[h+3]+=C*L):0<F&&(s[h+2]+=A*(L=S*s[h+6]*a[c+6]/F/F),s[h+3]+=C*L),a[c+4]<0)break;c=a[c+4];continue}c=a[c+5]}else{if(0<=a[c+0]&&a[c+0]!==h&&(A=s[h+0]-s[a[c+0]+0],C=s[h+1]-s[a[c+0]+1],F=Math.sqrt(A*A+C*C),n.settings.adjustSizes?0<F?(s[h+2]+=A*(L=S*s[h+6]*s[a[c+0]+6]/F/F),s[h+3]+=C*L):F<0&&(s[h+2]+=A*(L=-S*s[h+6]*s[a[c+0]+6]/F),s[h+3]+=C*L):0<F&&(s[h+2]+=A*(L=S*s[h+6]*s[a[c+0]+6]/F/F),s[h+3]+=C*L)),a[c+4]<0)break;c=a[c+4]}else for(S=n.settings.scalingRatio,p=0;p<n.nodesLength;p+=n.ppn)for(g=0;g<p;g+=n.ppn)A=s[p+0]-s[g+0],C=s[p+1]-s[g+1],n.settings.adjustSizes?0<(F=Math.sqrt(A*A+C*C)-s[p+8]-s[g+8])?(s[p+2]+=A*(L=S*s[p+6]*s[g+6]/F/F),s[p+3]+=C*L,s[g+2]+=A*L,s[g+3]+=C*L):F<0&&(s[p+2]+=A*(L=100*S*s[p+6]*s[g+6]),s[p+3]+=C*L,s[g+2]-=A*L,s[g+3]-=C*L):0<(F=Math.sqrt(A*A+C*C))&&(s[p+2]+=A*(L=S*s[p+6]*s[g+6]/F/F),s[p+3]+=C*L,s[g+2]-=A*L,s[g+3]-=C*L);for(v=n.settings.gravity/n.settings.scalingRatio,S=n.settings.scalingRatio,h=0;h<n.nodesLength;h+=n.ppn)A=s[h+(L=0)],C=s[h+1],F=Math.sqrt(A*A+C*C),n.settings.strongGravityMode?0<F&&(L=S*s[h+6]*v):0<F&&(L=S*s[h+6]*v/F),s[h+2]-=A*L,s[h+3]-=C*L;for(S=1*(n.settings.outboundAttractionDistribution?y:1),m=0;m<n.edgesLength;m+=n.ppe)p=l[m+0],g=l[m+1],b=l[m+2],P=Math.pow(b,n.settings.edgeWeightInfluence),A=s[p+0]-s[g+0],C=s[p+1]-s[g+1],n.settings.adjustSizes?(F=Math.sqrt(A*A+C*C)-s[p+8]-s[g+8],n.settings.linLogMode?n.settings.outboundAttractionDistribution?0<F&&(L=-S*P*Math.log(1+F)/F/s[p+6]):0<F&&(L=-S*P*Math.log(1+F)/F):n.settings.outboundAttractionDistribution?0<F&&(L=-S*P/s[p+6]):0<F&&(L=-S*P)):(F=Math.sqrt(A*A+C*C),n.settings.linLogMode?n.settings.outboundAttractionDistribution?0<F&&(L=-S*P*Math.log(1+F)/F/s[p+6]):0<F&&(L=-S*P*Math.log(1+F)/F):L=n.settings.outboundAttractionDistribution?(F=1,-S*P/s[p+6]):(F=1,-S*P)),0<F&&(s[p+2]+=A*L,s[p+3]+=C*L,s[g+2]-=A*L,s[g+3]-=C*L);var Te,it,rt,We,_t=0;if(n.settings.adjustSizes)for(h=0;h<n.nodesLength;h+=n.ppn)s[h+9]||((Te=Math.sqrt(s[h+2]*s[h+2]+s[h+3]*s[h+3]))>n.maxForce&&(s[h+2]=s[h+2]*n.maxForce/Te,s[h+3]=s[h+3]*n.maxForce/Te),it=s[h+6]*Math.sqrt((s[h+4]-s[h+2])*(s[h+4]-s[h+2])+(s[h+5]-s[h+3])*(s[h+5]-s[h+3])),rt=Math.sqrt((s[h+4]+s[h+2])*(s[h+4]+s[h+2])+(s[h+5]+s[h+3])*(s[h+5]+s[h+3]))/2,We=.1*Math.log(1+rt)/(1+Math.sqrt(it)),O=s[h+0],N=s[h+1],s[h+0]=s[h+0]+s[h+2]*(We/n.settings.slowDown),s[h+1]=s[h+1]+s[h+3]*(We/n.settings.slowDown),A=s[h+0],C=s[h+1],_t+=F=Math.sqrt((A-O)*(A-O)+(C-N)*(C-N)));else for(h=0;h<n.nodesLength;h+=n.ppn)s[h+9]||(it=s[h+6]*Math.sqrt((s[h+4]-s[h+2])*(s[h+4]-s[h+2])+(s[h+5]-s[h+3])*(s[h+5]-s[h+3])),rt=Math.sqrt((s[h+4]+s[h+2])*(s[h+4]+s[h+2])+(s[h+5]+s[h+3])*(s[h+5]+s[h+3]))/2,We=s[h+7]*Math.log(1+rt)/(1+Math.sqrt(it)),s[h+7]=Math.min(1,Math.sqrt(We*(s[h+2]*s[h+2]+s[h+3]*s[h+3])/(1+Math.sqrt(it)))),O=s[h+0],N=s[h+1],s[h+0]=s[h+0]+s[h+2]*(We/n.settings.slowDown),s[h+1]=s[h+1]+s[h+3]*(We/n.settings.slowDown),A=s[h+0],C=s[h+1],_t+=F=Math.sqrt((A-O)*(A-O)+(C-N)*(C-N)));if(n.iterations++,n.settings.autoStop&&(n.converged=n.iterations>n.settings.maxIterations||_t/n.nodesLength<n.settings.avgDistanceThreshold,n.converged&&n.settings.alignNodeSiblings)){var wt,Ue,Ze={},Ne={};for(m=0;m<n.edgesLength;m+=n.ppe)(p=l[m+0])!==(g=l[m+1])&&(Ze[p]=Ze[p]||{},Ze[g]=Ze[g]||{},Ze[p][g]=!0,Ze[g][p]=!0);Object.keys(Ze).forEach(function(z){var Q=~~z;2==(Ue=Object.keys(Ze[Q])).length&&((wt=Ue[0]+";"+Ue[1])in Ne||Ne[wt=Ue[1]+";"+Ue[0]]||(Ne[wt]=[~~Ue[1],~~Ue[0]]),Ne[wt].push(Q))});var Ge,Xe,$e,we,Pe,je,Je,ut,Gt,Xt,an,nn,ln,H,Z=n.settings.nodeSiblingsAngleMin;Object.keys(Ne).forEach(function(z){if(Xe=Ne[z].shift(),$e=Ne[z].shift(),1!=(Ge=Ne[z].filter(function(Ke){return!s[Ke+9]})).length){var ge,xe,ve,Ce,Le,Re,Fe,De,Me,Oe,Se,Qe;if(je=s[Xe+0],Je=s[Xe+1],ut=s[$e+0],Gt=s[$e+1],we=Object.keys(Ze[Xe]).length,Pe=Object.keys(Ze[$e]).length,an={x:(ge=je)+(ut-ge)*(ve=(.75-.25)*(we/(we+Pe)-0)/1+.25),y:(xe=Je)+(Gt-xe)*ve},nn={xi:-((Fe=Gt)-(Le=Je)),yi:(Re=ut)-(Ce=je),xiPrime:Fe-Le,yiPrime:-(Re-Ce)},De=ut-je,Me=Gt-Je,Xt=Math.sqrt(De*De+Me*Me),Qe=ln={x:((Oe=nn).xiPrime-Oe.xi)/(Se=Xt),y:(Oe.yiPrime-Oe.yi)/Se},H=Math.acos(Qe.x/Math.sqrt(Qe.x*Qe.x+Qe.y*Qe.y)),2*Z>Math.PI)throw new Error("ForceLink.Worker - Invalid parameter: angleMin must be smaller than 2 PI.");0<Z&&(H<Z||H>Math.PI-Z&&H<=Math.PI?ln={x:2*Math.cos(Math.PI-Z),y:2*Math.sin(Math.PI-Z)}:(H>2*Math.PI-Z||H>=Math.PI&&H<Math.PI+Z)&&(ln={x:2*Math.cos(Z),y:2*Math.sin(Z)}));var at=0,Be=1,Ve=1;Ge.length%2==1&&(Ve=0,at=1);for(var ze=0;ze<Ge.length;ze++)s[Ge[ze]+0]=an.x+Be*ln.x*Ve*(at||2<=ze?n.settings.nodeSiblingsScale:2*n.settings.nodeSiblingsScale/3),s[Ge[ze]+1]=an.y+Be*ln.y*Ve*(at||2<=ze?n.settings.nodeSiblingsScale:2*n.settings.nodeSiblingsScale/3),Be=-Be,Ve+=(ze+at)%2}})}}return function(){if(n.settings.autoStop)for(;!n.converged;)u();else for(var d=0===n.iterations?n.settings.startingIterations:n.iterations+n.settings.iterationsPerRender;n.iterations!==d;)u();return{nodes:function(c){for(var h=Object.keys(c),p={},g=0;g<s.length;g+=n.ppn){var m=h[g/n.ppn];p[m]={id:m,x:s[g+0],y:s[g+1],pinned:s[g+9]}}return p}(t.nodes),barycentre:t.barycentre}}()},isRunning:function(e){return!e.W.settings.autoStop},onSync:function(e,t){var n,i,r,o,a,s,l,u,d=e.nodes,c=e.barycentre,h=t.graph,p=Object.keys(d),g=p.length,m=0,b=0,v=new Array(g),y=new Array(g),S=new Array(g),A=new Array(g),C=h.getAttributes(!0,["x","y"]),O=C[0],N=C[1];for(n=0;n<g;n++)r=d[i=p[n]],u=parseInt(i),v[n]=u,A[n]=r.pinned,a=r.pinned?(o=O.get(u),N.get(u)):(o=r.x,r.y),m+=y[n]=o,b+=S[n]=a;for(s=m/g-c.x,l=b/g-c.y,n=0;n<g;n++)A[n]||(y[n]-=s,S[n]-=l);return{indexes:v,x:y,y:S}}},Tv=function(e){return e.reduce(function(t,n){return t[n]=!0,t},{})};function TS(e,t){for(var n=[e],i=Tv(n),r=[e];n.length;)for(var o=0,a=t[n.shift()];o<a.length;o+=1){var s=a[o];i[s]||(i[s]=!0,r.push(s),n.push(s))}return r}function Mv(e){return e.reduce(function(t,n){return t[n.source]=t[n.source]||[],t[n.target]=t[n.target]||[],t[n.source].push(""+n.target),t[n.target].push(""+n.source),t},{})}function MS(e){return function(t,n){var i=Math.abs(t.layer-n.layer),r=[n,t].reduce(function(o,a){return o+(Ru(a)?1:.01)},0);return i?2*i*e:r*e}}function Iv(e){return e.reduce(function(t,n){return t+function(i,r){for(var o=[],a=arguments.length-2;0<a--;)o[a]=arguments[a+2];for(var s=r,l=0,u=o;l<u.length;l+=1){var d=u[l];if(!s[d])return i;s=s[d]}return s}(Ru(n)?.5:0,n,"data","radius")},0)/e.length}function kv(e,t,n){var i=n||Mv(t||[]);return e.filter(function(r){return!(r.id in i)})}function IS(e,t){var n=Tv(t);return e.filter(function(i){return!(i in n)})}function us(e,t){e.forEach(function(n,i){n.forEach(function(r,o,a){t(r,o,a,i)})})}function sh(e){return Object.keys(e).map(function(t){return e[t]})}function uh(e,t){return Object.keys(e).reduce(function(n,i){return n[i]=t(e[i],i,e),n},{})}function Ru(e){return!!e.data}function lh(e,t){return{id:e,data:t,children:[]}}function OS(e,t){t.forEach(function(n){return n._median=[]}),e.forEach(function(n,i){n.children.filter(function(r){return r.layer>n.layer}).forEach(function(r){r._median.push(i)})}),t.forEach(function(n,i){n.children.filter(function(r){return r.layer<=n.layer}).forEach(function(){return n._median.push(i)})}),t.forEach(function(n){return n._median=function(i){if(i.sort(function(o,a){return o-a}),0===i.length)return 0;var r=Math.floor(i.length/2);return i.length%2?i[r]:(i[r-1]+i[r])/2}(n._median)||0}),t.sort(function(n,i){return n._median-i._median}),t.forEach(function(n){return delete n._median})}var dh="left",ch="right",hh=Number.POSITIVE_INFINITY;function ph(e){for(var t=0,n=["up","down"];t<n.length;t+=1)e(n[t])}function fh(e){for(var t=0,n=[dh,ch];t<n.length;t+=1)e(n[t])}function Ov(e,t,n,i){this.feasible=n,this.evaluation=t,this.bounded=i,this._tableau=e}var gh=Ov;function ld(e,t,n,i,r){gh.call(this,e,t,n,i),this.iter=r}Ov.prototype.generateSolutionSet=function(){for(var e={},t=this._tableau,n=t.varIndexByRow,i=t.variablesPerIndex,r=t.matrix,o=t.rhsColumn,a=t.height-1,s=Math.round(1/t.precision),l=1;l<=a;l+=1){var u=i[n[l]];void 0!==u&&!0!==u.isSlack&&(e[u.id]=Math.round(r[l][o]*s)/s)}return e};var PS=ld;function wo(e){this.model=null,this.matrix=null,this.width=0,this.height=0,this.costRowIndex=0,this.rhsColumn=0,this.variablesPerIndex=[],this.unrestrictedVars=null,this.feasible=!0,this.evaluation=0,this.varIndexByRow=null,this.varIndexByCol=null,this.rowByVarIndex=null,this.colByVarIndex=null,this.precision=e||1e-8,this.optionalObjectives=[],this.objectivesByPriority={},this.savedState=null,this.availableIndexes=[],this.lastElementIndex=0,this.variables=null,this.nVars=0,this.bounded=!0,this.unboundedVarIndex=null,this.branchAndCutIterations=0}ld.prototype=Object.create(gh.prototype),ld.constructor=ld;var _n=wo;function _h(e,t){this.priority=e,this.reducedCosts=new Array(t);for(var n=0;n<t;n+=1)this.reducedCosts[n]=0}wo.prototype.solve=function(){return 0<this.model.getNumberOfIntegerVariables()?this.branchAndCut():this.simplex(),this.updateVariableValues(),this.getSolution()},_h.prototype.copy=function(){var e=new _h(this.priority,this.reducedCosts.length);return e.reducedCosts=this.reducedCosts.slice(),e},wo.prototype.setOptionalObjective=function(e,t,n){var i=this.objectivesByPriority[e];void 0===i&&(i=new _h(e,Math.max(this.width,t+1)),this.objectivesByPriority[e]=i,this.optionalObjectives.push(i),this.optionalObjectives.sort(function(r,o){return r.priority-o.priority})),i.reducedCosts[t]=n},wo.prototype.initialize=function(e,t,n,i){this.variables=n,this.unrestrictedVars=i,this.width=e,this.height=t;for(var r=new Array(e),o=0;o<e;o++)r[o]=0;this.matrix=new Array(t);for(var a=0;a<t;a++)this.matrix[a]=r.slice();this.varIndexByRow=new Array(this.height),this.varIndexByCol=new Array(this.width),this.varIndexByRow[0]=-1,this.varIndexByCol[0]=-1,this.nVars=e+t-2,this.rowByVarIndex=new Array(this.nVars),this.colByVarIndex=new Array(this.nVars),this.lastElementIndex=this.nVars},wo.prototype._resetMatrix=function(){var e,t,n=this.model.variables,i=this.model.constraints,r=n.length,o=i.length,a=this.matrix[0],s=!0===this.model.isMinimization?-1:1;for(e=0;e<r;e+=1){var l=n[e],u=l.priority,d=s*l.cost;0===u?a[e+1]=d:this.setOptionalObjective(u,e+1,d),this.rowByVarIndex[t=n[e].index]=-1,this.colByVarIndex[t]=e+1,this.varIndexByCol[e+1]=t}for(var c=1,h=0;h<o;h+=1){var p,g,m=i[h],b=m.index;this.rowByVarIndex[b]=c,this.colByVarIndex[b]=-1,this.varIndexByRow[c]=b;var v=m.terms,y=v.length,S=this.matrix[c++];if(m.isUpperBound){for(p=0;p<y;p+=1)S[this.colByVarIndex[(g=v[p]).variable.index]]=g.coefficient;S[0]=m.rhs}else{for(p=0;p<y;p+=1)S[this.colByVarIndex[(g=v[p]).variable.index]]=-g.coefficient;S[0]=-m.rhs}}},wo.prototype.setModel=function(e){var t=(this.model=e).nVariables+1;return this.initialize(t,e.nConstraints+1,e.variables,e.unrestrictedVariables),this._resetMatrix(),this},wo.prototype.getNewElementIndex=function(){if(0<this.availableIndexes.length)return this.availableIndexes.pop();var e=this.lastElementIndex;return this.lastElementIndex+=1,e},wo.prototype.density=function(){for(var e=0,t=this.matrix,n=0;n<this.height;n++)for(var i=t[n],r=0;r<this.width;r++)0!==i[r]&&(e+=1);return e/(this.height*this.width)},wo.prototype.setEvaluation=function(){var e=Math.round(1/this.precision);this.evaluation=Math.round(this.matrix[this.costRowIndex][this.rhsColumn]*e)/e},wo.prototype.getSolution=function(){var e=!0===this.model.isMinimization?this.evaluation:-this.evaluation;return 0<this.model.getNumberOfIntegerVariables()?new PS(this,e,this.feasible,this.bounded,this.branchAndCutIterations):new gh(this,e,this.feasible,this.bounded)},_n.prototype.simplex=function(){return this.bounded=!0,this.phase1(),!0===this.feasible&&this.phase2(),this},_n.prototype.phase1=function(){for(var e=this.model.checkForCycles,t=[],n=this.matrix,i=this.rhsColumn,r=this.width-1,o=this.height-1,a=0;;){for(var s=0,l=-this.precision,u=1;u<=o;u++)if(!0!==this.unrestrictedVars[this.varIndexByRow[u]]){var d=n[u][i];d<l&&(l=d,s=u)}if(0===s)return this.feasible=!0,a;for(var c=0,h=-1/0,p=n[0],g=n[s],m=1;m<=r;m++){var b=g[m];if(!(-this.precision<b&&b<this.precision)&&(!0===this.unrestrictedVars[this.varIndexByCol[m]]||b<-this.precision)){var v=-p[m]/b;h<v&&(h=v,c=m)}}if(0===c)return this.feasible=!1,a;if(e){t.push([this.varIndexByRow[s],this.varIndexByCol[c]]);var y=this.checkForCycles(t);if(0<y.length)throw console.log("Cycle in phase 1"),console.log("Start :",y[0]),console.log("Length :",y[1]),new Error}this.pivot(s,c),a+=1}},_n.prototype.phase2=function(){for(var e,t,n=this.model.checkForCycles,i=[],r=this.matrix,o=this.rhsColumn,a=this.width-1,s=this.height-1,l=this.precision,u=this.optionalObjectives.length,d=null,c=0;;){var h=r[this.costRowIndex];0<u&&(d=[]);for(var p=0,g=l,m=!1,b=1;b<=a;b++)e=h[b],t=!0===this.unrestrictedVars[this.varIndexByCol[b]],0<u&&-l<e&&e<l?d.push(b):t&&e<0?g<-e&&(g=-e,p=b,m=!0):g<e&&(g=e,p=b,m=!1);if(0<u)for(var v=0;0===p&&0<d.length&&v<u;){var y=[],S=this.optionalObjectives[v].reducedCosts;g=l;for(var A=0;A<d.length;A++)e=S[b=d[A]],t=!0===this.unrestrictedVars[this.varIndexByCol[b]],-l<e&&e<l?y.push(b):t&&e<0?g<-e&&(g=-e,p=b,m=!0):g<e&&(g=e,p=b,m=!1);d=y,v+=1}if(0===p)return this.setEvaluation(),c;for(var C=0,O=1/0,N=1;N<=s;N++){var P=r[N],F=P[o],L=P[p];if(!(-l<L&&L<l)){if(0<L&&F<l&&-l<F){O=0,C=N;break}var B=m?-F/L:F/L;l<B&&B<O&&(O=B,C=N)}}if(O===1/0)return this.evaluation=-1/0,this.bounded=!1,this.unboundedVarIndex=this.varIndexByCol[p],c;if(n){i.push([this.varIndexByRow[C],this.varIndexByCol[p]]);var Y=this.checkForCycles(i);if(0<Y.length)throw console.log("Cycle in phase 2"),console.log("Start :",Y[0]),console.log("Length :",Y[1]),new Error}this.pivot(C,p,!0),c+=1}};var mh=[];function vh(e,t,n,i){this.id=e,this.cost=t,this.index=n,this.value=0,this.priority=i}function Nv(e,t,n,i){vh.call(this,e,t,n,i)}function yh(e,t){vh.call(this,e,0,t,0)}function Lv(e,t){this.variable=e,this.coefficient=t}function Fv(e,t,n){return 0===n||"required"===n?null:(t=t||1,n=n||1,!1===e.isMinimization&&(t=-t),e.addVariable(t,"r"+e.relaxationIndex++,!1,!1,n))}function ls(e,t,n,i){this.slack=new yh("s"+n,n),this.index=n,this.model=i,this.rhs=e,this.isUpperBound=t,this.terms=[],this.termsByVarIndex={},this.relaxation=null}function Hs(e,t){this.upperBound=e,this.lowerBound=t,this.model=e.model,this.rhs=e.rhs,this.relaxation=null}_n.prototype.pivot=function(e,t){var n=this.matrix,i=n[e][t],r=this.height-1,o=this.width-1,a=this.varIndexByRow[e],s=this.varIndexByCol[t];this.varIndexByRow[e]=s,this.varIndexByCol[t]=a,this.rowByVarIndex[s]=e,this.rowByVarIndex[a]=-1,this.colByVarIndex[s]=-1,this.colByVarIndex[a]=t;for(var l,u,d,c=n[e],h=0,p=0;p<=o;p++)0!==c[p]&&(c[p]/=i,mh[h]=p,h+=1);c[t]=1/i;for(var g=0;g<=r;g++){var m=n[g];if(g!==e&&0!==(l=m[t])){for(u=0;u<h;u++)0!==(d=c[p=mh[u]])&&(m[p]=m[p]-l*d);m[t]=-l/i}}var b=this.optionalObjectives.length;if(0<b)for(var v=0;v<b;v+=1){var y=this.optionalObjectives[v].reducedCosts;if(0!==(l=y[t])){for(u=0;u<h;u++)0!==(d=c[p=mh[u]])&&(y[p]=y[p]-l*d);y[t]=-l/i}}},_n.prototype.checkForCycles=function(e){for(var t=0;t<e.length-1;t++)for(var n=t+1;n<e.length;n++){var i=e[t],r=e[n];if(i[0]===r[0]&&i[1]===r[1]){if(n-t>e.length-n)break;for(var o=!0,a=1;a<n-t;a++){var s=e[t+a],l=e[n+a];if(s[0]!==l[0]||s[1]!==l[1]){o=!1;break}}if(o)return[t,n-t]}}return[]},yh.prototype.isSlack=Nv.prototype.isInteger=!0,ls.prototype.addTerm=function(e,t){var n=t.index,i=this.termsByVarIndex[n];return void 0===i?(i=new Lv(t,e),this.termsByVarIndex[n]=i,this.terms.push(i),!0===this.isUpperBound&&(e=-e),this.model.updateConstraintCoefficient(this,t,e)):this.setVariableCoefficient(i.coefficient+e,t),this},ls.prototype.removeTerm=function(e){return this},ls.prototype.setRightHandSide=function(e){if(e!==this.rhs){var t=e-this.rhs;!0===this.isUpperBound&&(t=-t),this.rhs=e,this.model.updateRightHandSide(this,t)}return this},ls.prototype.setVariableCoefficient=function(e,t){var n=t.index;if(-1!==n){var i=this.termsByVarIndex[n];if(void 0===i)this.addTerm(e,t);else if(e!==i.coefficient){var r=e-i.coefficient;!0===this.isUpperBound&&(r=-r),i.coefficient=e,this.model.updateConstraintCoefficient(this,t,r)}return this}console.warn("[Constraint.setVariableCoefficient] Trying to change coefficient of inexistant variable.")},ls.prototype.relax=function(e,t){this.relaxation=Fv(this.model,e,t),this._relax(this.relaxation)},ls.prototype._relax=function(e){null!==e&&this.setVariableCoefficient(this.isUpperBound?-1:1,e)},Hs.prototype.isEquality=!0,Hs.prototype.addTerm=function(e,t){return this.upperBound.addTerm(e,t),this.lowerBound.addTerm(e,t),this},Hs.prototype.removeTerm=function(e){return this.upperBound.removeTerm(e),this.lowerBound.removeTerm(e),this},Hs.prototype.setRightHandSide=function(e){this.upperBound.setRightHandSide(e),this.lowerBound.setRightHandSide(e),this.rhs=e},Hs.prototype.relax=function(e,t){this.relaxation=Fv(this.model,e,t),this.upperBound.relaxation=this.relaxation,this.upperBound._relax(this.relaxation),this.lowerBound.relaxation=this.relaxation,this.lowerBound._relax(this.relaxation)};var Xo={Constraint:ls,Variable:vh,IntegerVariable:Nv,SlackVariable:yh,Equality:Hs,Term:Lv},xh=Xo.SlackVariable;function Pv(e,t){this.index=e,this.value=t}_n.prototype.addCutConstraints=function(e){for(var t,n=e.length,i=this.height,r=i+n,o=i;o<r;o+=1)void 0===this.matrix[o]&&(this.matrix[o]=this.matrix[o-1].slice());this.height=r,this.nVars=this.width+this.height-2;for(var a=this.width-1,s=0;s<n;s+=1){var l=e[s],u=i+s,d="min"===l.type?-1:1,c=l.varIndex,h=this.rowByVarIndex[c],p=this.matrix[u];if(-1===h){for(p[this.rhsColumn]=d*l.value,t=1;t<=a;t+=1)p[t]=0;p[this.colByVarIndex[c]]=d}else{var g=this.matrix[h];for(p[this.rhsColumn]=d*(l.value-g[this.rhsColumn]),t=1;t<=a;t+=1)p[t]=-d*g[t]}var b=this.getNewElementIndex();this.varIndexByRow[u]=b,this.rowByVarIndex[b]=u,this.colByVarIndex[b]=-1,this.variablesPerIndex[b]=new xh("s"+b,b),this.nVars+=1}},_n.prototype._addLowerBoundMIRCut=function(e){if(e===this.costRowIndex)return!1;var t=this.matrix;if(!this.variablesPerIndex[this.varIndexByRow[e]].isInteger)return!1;var n=t[e][this.rhsColumn],i=n-Math.floor(n);if(i<this.precision||1-this.precision<i)return!1;var r=this.height;t[r]=t[r-1].slice(),this.height+=1,this.nVars+=1;var o=this.getNewElementIndex();this.varIndexByRow[r]=o,this.rowByVarIndex[o]=r,this.colByVarIndex[o]=-1,this.variablesPerIndex[o]=new xh("s"+o,o),t[r][this.rhsColumn]=Math.floor(n);for(var a=1;a<this.varIndexByCol.length;a+=1)if(this.variablesPerIndex[this.varIndexByCol[a]].isInteger){var s=t[e][a],l=Math.floor(s)+Math.max(0,s-Math.floor(s)-i)/(1-i);t[r][a]=l}else t[r][a]=Math.min(0,t[e][a]/(1-i));for(var u=0;u<this.width;u+=1)t[r][u]-=t[e][u];return!0},_n.prototype._addUpperBoundMIRCut=function(e){if(e===this.costRowIndex)return!1;var t=this.matrix;if(!this.variablesPerIndex[this.varIndexByRow[e]].isInteger)return!1;var n=t[e][this.rhsColumn],i=n-Math.floor(n);if(i<this.precision||1-this.precision<i)return!1;var r=this.height;t[r]=t[r-1].slice(),this.height+=1,this.nVars+=1;var o=this.getNewElementIndex();this.varIndexByRow[r]=o,this.rowByVarIndex[o]=r,this.colByVarIndex[o]=-1,this.variablesPerIndex[o]=new xh("s"+o,o),t[r][this.rhsColumn]=-i;for(var a=1;a<this.varIndexByCol.length;a+=1){var s=this.variablesPerIndex[this.varIndexByCol[a]],l=t[e][a],u=l-Math.floor(l);t[r][a]=s.isInteger?u<=i?-u:-(1-u)*i/u:0<=l?-l:l*i/(1-i)}return!0},_n.prototype.applyMIRCuts=function(){for(var e=this.height,t=0;t<e;t+=1)this._addUpperBoundMIRCut(t);for(t=0;t<e;t+=1)this._addLowerBoundMIRCut(t)},_n.prototype._putInBase=function(e){var t=this.rowByVarIndex[e];if(-1===t){for(var n=this.colByVarIndex[e],i=1;i<this.height;i+=1){var r=this.matrix[i][n];if(r<-this.precision||this.precision<r){t=i;break}}this.pivot(t,n)}return t},_n.prototype._takeOutOfBase=function(e){var t=this.colByVarIndex[e];if(-1===t){for(var n=this.rowByVarIndex[e],i=this.matrix[n],r=1;r<this.height;r+=1){var o=i[r];if(o<-this.precision||this.precision<o){t=r;break}}this.pivot(n,t)}return t},_n.prototype.updateVariableValues=function(){for(var e=this.variables.length,t=Math.round(1/this.precision),n=0;n<e;n+=1){var i=this.variables[n],o=this.rowByVarIndex[i.index];i.value=-1===o?0:Math.round(this.matrix[o][this.rhsColumn]*t)/t}},_n.prototype.updateRightHandSide=function(e,t){var n=this.height-1,i=this.rowByVarIndex[e.index];if(-1===i){for(var r=this.colByVarIndex[e.index],o=0;o<=n;o+=1){var a=this.matrix[o];a[this.rhsColumn]-=t*a[r]}var s=this.optionalObjectives.length;if(0<s)for(var l=0;l<s;l+=1){var u=this.optionalObjectives[l].reducedCosts;u[this.rhsColumn]-=t*u[r]}}else this.matrix[i][this.rhsColumn]-=t},_n.prototype.updateConstraintCoefficient=function(e,t,n){if(e.index===t.index)throw new Error("[Tableau.updateConstraintCoefficient] constraint index should not be equal to variable index !");var i=this._putInBase(e.index),r=this.colByVarIndex[t.index];if(-1===r)for(var o=this.rowByVarIndex[t.index],a=0;a<this.width;a+=1)this.matrix[i][a]+=n*this.matrix[o][a];else this.matrix[i][r]-=n},_n.prototype.updateCost=function(e,t){var n=e.index,i=this.width-1,r=this.colByVarIndex[n];if(-1===r){var o,a=this.matrix[this.rowByVarIndex[n]];if(0===e.priority){var s=this.matrix[0];for(o=0;o<=i;o+=1)s[o]+=t*a[o]}else{var l=this.objectivesByPriority[e.priority].reducedCosts;for(o=0;o<=i;o+=1)l[o]+=t*a[o]}}else this.matrix[0][r]-=t},_n.prototype.addConstraint=function(e){var t=e.isUpperBound?1:-1,n=this.height,i=this.matrix[n];void 0===i&&(i=this.matrix[0].slice(),this.matrix[n]=i);for(var r=this.width-1,o=0;o<=r;o+=1)i[o]=0;i[this.rhsColumn]=t*e.rhs;for(var a=e.terms,s=a.length,l=0;l<s;l+=1){var u=a[l],d=u.coefficient,c=u.variable.index,h=this.rowByVarIndex[c];if(-1===h)i[this.colByVarIndex[c]]+=t*d;else{var p=this.matrix[h];for(o=0;o<=r;o+=1)i[o]-=t*d*p[o]}}var g=e.index;this.varIndexByRow[n]=g,this.rowByVarIndex[g]=n,this.colByVarIndex[g]=-1,this.height+=1},_n.prototype.removeConstraint=function(e){var t=e.index,n=this.height-1,i=this._putInBase(t),r=this.matrix[n];this.matrix[n]=this.matrix[i],this.matrix[i]=r,this.varIndexByRow[i]=this.varIndexByRow[n],this.varIndexByRow[n]=-1,this.rowByVarIndex[t]=-1,this.availableIndexes[this.availableIndexes.length]=t,e.slack.index=-1,--this.height},_n.prototype.addVariable=function(e){var t=this.height-1,n=this.width,i=!0===this.model.isMinimization?-e.cost:e.cost,r=e.priority,o=this.optionalObjectives.length;if(0<o)for(var a=0;a<o;a+=1)this.optionalObjectives[a].reducedCosts[n]=0;0===r?this.matrix[0][n]=i:(this.setOptionalObjective(r,n,i),this.matrix[0][n]=0);for(var s=1;s<=t;s+=1)this.matrix[s][n]=0;var l=e.index;this.varIndexByCol[n]=l,this.rowByVarIndex[l]=-1,this.colByVarIndex[l]=n,this.width+=1},_n.prototype.removeVariable=function(e){var t=e.index,n=this._takeOutOfBase(t),i=this.width-1;if(n!==i){for(var r=this.height-1,o=0;o<=r;o+=1){var a=this.matrix[o];a[n]=a[i]}var s=this.optionalObjectives.length;if(0<s)for(var l=0;l<s;l+=1){var u=this.optionalObjectives[l].reducedCosts;u[n]=u[i]}var d=this.varIndexByCol[i];this.varIndexByCol[n]=d,this.colByVarIndex[d]=n}this.varIndexByCol[i]=-1,this.colByVarIndex[t]=-1,this.availableIndexes[this.availableIndexes.length]=t,e.index=-1,--this.width},_n.prototype.log=function(e,t){console.log("****",e,"****"),console.log("Nb Variables",this.width-1),console.log("Nb Constraints",this.height-1),console.log("Basic Indexes",this.varIndexByRow),console.log("Non Basic Indexes",this.varIndexByCol),console.log("Rows",this.rowByVarIndex),console.log("Cols",this.colByVarIndex);var n,i,r,o,a,s,l,u,d,c,h="",p=[" "];for(i=1;i<this.width;i+=1)l=" ",u="\t",5<(s=void 0===(o=this.variablesPerIndex[a=this.varIndexByCol[i]])?"c"+a:o.id).length?l+=" ":u+="\t",p[i]=l,h+=u+s;console.log(h);var g=this.matrix[this.costRowIndex],m="\t";for(n=1;n<this.width;n+=1)m+="\t",m+=p[n],m+=g[n].toFixed(5);for(m+="\t"+p[0]+g[0].toFixed(5),console.log(m+"\tZ"),r=1;r<this.height;r+=1){for(d=this.matrix[r],c="\t",i=1;i<this.width;i+=1)c+="\t"+p[i]+d[i].toFixed(5);c+="\t"+p[0]+d[0].toFixed(5),s=void 0===(o=this.variablesPerIndex[a=this.varIndexByRow[r]])?"c"+a:o.id,console.log(c+"\t"+s)}console.log("");var b=this.optionalObjectives.length;if(0<b){console.log("    Optional objectives:");for(var v=0;v<b;v+=1){var y=this.optionalObjectives[v].reducedCosts,S="";for(n=1;n<this.width;n+=1)S+=y[n]<0?"":" ",S+=p[n],S+=y[n].toFixed(5);S+=(y[0]<0?"":" ")+p[0]+y[0].toFixed(5),console.log(S+" z"+v)}}return console.log("Feasible?",this.feasible),console.log("evaluation",this.evaluation),this},_n.prototype.copy=function(){var e=new _n(this.precision);e.width=this.width,e.height=this.height,e.nVars=this.nVars,e.model=this.model,e.variables=this.variables,e.variablesPerIndex=this.variablesPerIndex,e.unrestrictedVars=this.unrestrictedVars,e.lastElementIndex=this.lastElementIndex,e.varIndexByRow=this.varIndexByRow.slice(),e.varIndexByCol=this.varIndexByCol.slice(),e.rowByVarIndex=this.rowByVarIndex.slice(),e.colByVarIndex=this.colByVarIndex.slice(),e.availableIndexes=this.availableIndexes.slice();for(var t=[],n=0;n<this.optionalObjectives.length;n++)t[n]=this.optionalObjectives[n].copy();e.optionalObjectives=t;for(var i=this.matrix,r=new Array(this.height),o=0;o<this.height;o++)r[o]=i[o].slice();return e.matrix=r,e},_n.prototype.save=function(){this.savedState=this.copy()},_n.prototype.restore=function(){if(null!==this.savedState){var e,t,n=this.savedState,i=n.matrix;for(this.nVars=n.nVars,this.model=n.model,this.variables=n.variables,this.variablesPerIndex=n.variablesPerIndex,this.unrestrictedVars=n.unrestrictedVars,this.lastElementIndex=n.lastElementIndex,this.width=n.width,this.height=n.height,e=0;e<this.height;e+=1){var r=i[e],o=this.matrix[e];for(t=0;t<this.width;t+=1)o[t]=r[t]}var a=n.varIndexByRow;for(t=0;t<this.height;t+=1)this.varIndexByRow[t]=a[t];for(;this.varIndexByRow.length>this.height;)this.varIndexByRow.pop();var s=n.varIndexByCol;for(e=0;e<this.width;e+=1)this.varIndexByCol[e]=s[e];for(;this.varIndexByCol.length>this.width;)this.varIndexByCol.pop();for(var l=n.rowByVarIndex,u=n.colByVarIndex,d=0;d<this.nVars;d+=1)this.rowByVarIndex[d]=l[d],this.colByVarIndex[d]=u[d];if(0<n.optionalObjectives.length&&0<this.optionalObjectives.length){this.optionalObjectives=[],this.optionalObjectivePerPriority={};for(var c=0;c<n.optionalObjectives.length;c++){var h=n.optionalObjectives[c].copy();this.optionalObjectives[c]=h,this.optionalObjectivePerPriority[h.priority]=h}}}},_n.prototype.getMostFractionalVar=function(){for(var e=0,t=null,n=null,i=this.model.integerVariables,r=i.length,o=0;o<r;o++){var a=i[o].index,s=this.rowByVarIndex[a];if(-1!==s){var l=this.matrix[s][this.rhsColumn],u=Math.abs(l-Math.round(l));e<u&&(e=u,t=a,n=l)}}return new Pv(t,n)},_n.prototype.getFractionalVarWithLowestCost=function(){for(var e=1/0,t=null,n=null,i=this.model.integerVariables,r=i.length,o=0;o<r;o++){var a=i[o],s=a.index,l=this.rowByVarIndex[s];if(-1!==l){var u=this.matrix[l][this.rhsColumn];if(Math.abs(u-Math.round(u))>this.precision){var d=a.cost;d<e&&(e=d,t=s,n=u)}}}return new Pv(t,n)},_n.prototype.countIntegerValues=function(){for(var e=0,t=1;t<this.height;t+=1)if(this.variablesPerIndex[this.varIndexByRow[t]].isInteger){var n=this.matrix[t][this.rhsColumn];(n-=Math.floor(n))<this.precision&&-n<this.precision&&(e+=1)}return e},_n.prototype.isIntegral=function(){for(var e=this.model.integerVariables,t=e.length,n=0;n<t;n++){var i=this.rowByVarIndex[e[n].index];if(-1!==i){var r=this.matrix[i][this.rhsColumn];if(Math.abs(r-Math.round(r))>this.precision)return!1}}return!0},_n.prototype.computeFractionalVolume=function(e){for(var t=-1,n=1;n<this.height;n+=1)if(this.variablesPerIndex[this.varIndexByRow[n]].isInteger){var i=this.matrix[n][this.rhsColumn];if(i=Math.abs(i),Math.min(i-Math.floor(i),Math.floor(i+1))<this.precision){if(!e)return 0}else-1===t?t=i:t*=i}return-1===t?0:t};var DS=_n;function Dv(e,t,n){this.type=e,this.varIndex=t,this.value=n}function bh(e,t){this.relaxedEvaluation=e,this.cuts=t}function RS(e,t){return t.relaxedEvaluation-e.relaxedEvaluation}_n.prototype.applyCuts=function(e){if(this.restore(),this.addCutConstraints(e),this.simplex(),this.model.useMIRCuts)for(var t=!0;t;){var n=this.computeFractionalVolume(!0);this.applyMIRCuts(),this.simplex(),.9*n<=this.computeFractionalVolume(!0)&&(t=!1)}},_n.prototype.branchAndCut=function(){for(var e=[],t=0,n=1/0,i=null,r=[],o=0;o<this.optionalObjectives.length;o+=1)r.push(1/0);var a=new bh(-1/0,[]);for(e.push(a);0<e.length;)if(!((a=e.pop()).relaxedEvaluation>n)){var s=a.cuts;if(this.applyCuts(s),t++,!1!==this.feasible){var l=this.evaluation;if(!(n<l)){if(l===n){for(var u=!0,d=0;d<this.optionalObjectives.length&&!(this.optionalObjectives[d].reducedCosts[0]>r[d]);d+=1)if(this.optionalObjectives[d].reducedCosts[0]<r[d]){u=!1;break}if(u)continue}if(!0===this.isIntegral()){if(1===t)return void(this.branchAndCutIterations=t);i=a,n=l;for(var c=0;c<this.optionalObjectives.length;c+=1)r[c]=this.optionalObjectives[c].reducedCosts[0]}else{1===t&&this.save();for(var h=this.getMostFractionalVar(),p=h.index,g=[],m=[],b=s.length,v=0;v<b;v+=1){var y=s[v];y.varIndex===p?"min"===y.type?m.push(y):g.push(y):(g.push(y),m.push(y))}var S=Math.ceil(h.value),A=Math.floor(h.value),C=new Dv("min",p,S);g.push(C);var O=new Dv("max",p,A);m.push(O),e.push(new bh(l,g)),e.push(new bh(l,m)),e.sort(RS)}}}}null!==i&&this.applyCuts(i.cuts),this.branchAndCutIterations=t};var zS={},dd=Xo.Constraint,Rv=Xo.Equality,BS=Xo.Variable,VS=Xo.IntegerVariable;function ei(e,t){this.tableau=new _n(e),this.name=t,this.variables=[],this.integerVariables=[],this.unrestrictedVariables={},this.constraints=[],this.nConstraints=0,this.nVariables=0,this.isMinimization=!0,this.tableauInitialized=!1,this.relaxationIndex=1,this.useMIRCuts=!0,this.checkForCycles=!1}var Eh=ei;ei.prototype.minimize=function(){return this.isMinimization=!0,this},ei.prototype.maximize=function(){return this.isMinimization=!1,this},ei.prototype._getNewElementIndex=function(){if(0<this.availableIndexes.length)return this.availableIndexes.pop();var e=this.lastElementIndex;return this.lastElementIndex+=1,e},ei.prototype._addConstraint=function(e){var t=e.slack;this.tableau.variablesPerIndex[t.index]=t,this.constraints.push(e),this.nConstraints+=1,!0===this.tableauInitialized&&this.tableau.addConstraint(e)},ei.prototype.smallerThan=function(e){var t=new dd(e,!0,this.tableau.getNewElementIndex(),this);return this._addConstraint(t),t},ei.prototype.greaterThan=function(e){var t=new dd(e,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(t),t},ei.prototype.equal=function(e){var t=new dd(e,!0,this.tableau.getNewElementIndex(),this);this._addConstraint(t);var n=new dd(e,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(n),new Rv(t,n)},ei.prototype.addVariable=function(e,t,n,i,r){if("string"==typeof r)switch(r){case"required":r=0;break;case"strong":r=1;break;case"medium":r=2;break;case"weak":r=3;break;default:r=0}var o,a=this.tableau.getNewElementIndex();return null==t&&(t="v"+a),null==e&&(e=0),null==r&&(r=0),n?(o=new VS(t,e,a,r),this.integerVariables.push(o)):o=new BS(t,e,a,r),this.variables.push(o),this.tableau.variablesPerIndex[a]=o,i&&(this.unrestrictedVariables[a]=!0),this.nVariables+=1,!0===this.tableauInitialized&&this.tableau.addVariable(o),o},ei.prototype._removeConstraint=function(e){var t=this.constraints.indexOf(e);-1!==t?(this.constraints.splice(t,1),--this.nConstraints,!0===this.tableauInitialized&&this.tableau.removeConstraint(e),e.relaxation&&this.removeVariable(e.relaxation)):console.warn("[Model.removeConstraint] Constraint not present in model")},ei.prototype.removeConstraint=function(e){return e.isEquality?(this._removeConstraint(e.upperBound),this._removeConstraint(e.lowerBound)):this._removeConstraint(e),this},ei.prototype.removeVariable=function(e){var t=this.variables.indexOf(e);if(-1!==t)return this.variables.splice(t,1),!0===this.tableauInitialized&&this.tableau.removeVariable(e),this;console.warn("[Model.removeVariable] Variable not present in model")},ei.prototype.updateRightHandSide=function(e,t){return!0===this.tableauInitialized&&this.tableau.updateRightHandSide(e,t),this},ei.prototype.updateConstraintCoefficient=function(e,t,n){return!0===this.tableauInitialized&&this.tableau.updateConstraintCoefficient(e,t,n),this},ei.prototype.setCost=function(e,t){var n=e-t.cost;return!1===this.isMinimization&&(n=-n),t.cost=e,this.tableau.updateCost(t,n),this},ei.prototype.loadJson=function(e){this.isMinimization="max"!==e.opType;for(var t=e.variables,n=e.constraints,i={},r={},o=Object.keys(n),a=o.length,s=0;s<a;s+=1){var l,u,d=o[s],c=n[d],h=c.equal,p=c.weight,g=c.priority,m=void 0!==p||void 0!==g;if(void 0===h){var b=c.min;void 0!==b&&(l=this.greaterThan(b),i[d]=l,m&&l.relax(p,g));var v=c.max;void 0!==v&&(u=this.smallerThan(v),r[d]=u,m&&u.relax(p,g))}else{l=this.greaterThan(h),i[d]=l,u=this.smallerThan(h),r[d]=u;var y=new Rv(l,u);m&&y.relax(p,g)}}for(var S=Object.keys(t),A=S.length,C=e.ints||{},O=e.binaries||{},N=e.unrestricted||{},P=e.optimize,F=0;F<A;F+=1){var L=S[F],B=t[L],X=!!O[L],U=this.addVariable(B[P]||0,L,!!C[L]||X,!!N[L]);X&&this.smallerThan(1).addTerm(1,U);var W=Object.keys(B);for(s=0;s<W.length;s+=1){var ce=W[s];if(ce!==P){var he=B[ce],Ee=i[ce];void 0!==Ee&&Ee.addTerm(he,U);var Te=r[ce];void 0!==Te&&Te.addTerm(he,U)}}}return this},ei.prototype.getNumberOfIntegerVariables=function(){return this.integerVariables.length},ei.prototype.solve=function(){return!1===this.tableauInitialized&&(this.tableau.setModel(this),this.tableauInitialized=!0),this.tableau.solve()},ei.prototype.isFeasible=function(){return this.tableau.feasible},ei.prototype.save=function(){return this.tableau.save()},ei.prototype.restore=function(){return this.tableau.restore()},ei.prototype.activateMIRCuts=function(e){this.useMIRCuts=e},ei.prototype.debug=function(e){this.checkForCycles=e},ei.prototype.log=function(e){return this.tableau.log(e)};var zv={CleanObjectiveAttributes:function(e){var t,n,i;if("string"==typeof e.optimize){if(e.constraints[e.optimize]){for(n in t=Math.random(),e.variables)e.variables[n][e.optimize]&&(e.variables[n][t]=e.variables[n][e.optimize]);return e.constraints[t]=e.constraints[e.optimize],delete e.constraints[e.optimize],e}return e}for(i in e.optimize)if(e.constraints[i])if("equal"===e.constraints[i])delete e.optimize[i];else{for(n in t=Math.random(),e.variables)e.variables[n][i]&&(e.variables[n][t]=e.variables[n][i]);e.constraints[t]=e.constraints[i],delete e.constraints[i]}return e}};function US(e){return e.length?function(t){var n={is_blank:/^\W{0,}$/,is_objective:/(max|min)(imize){0,}\:/i,is_int:/^(?!\/\*)\W{0,}int/i,is_constraint:/(\>|\<){0,}\=/i,is_unrestricted:/^\S{0,}unrestricted/i,parse_lhs:/(\-|\+){0,1}\s{0,1}\d{0,}\.{0,}\d{0,}\s{0,}[A-Za-z]\S{0,}/gi,parse_rhs:/(\-|\+){0,1}\d{1,}\.{0,}\d{0,}\W{0,}\;{0,1}$/i,parse_dir:/(\>|\<){0,}\=/gi,parse_int:/[^\s|^\,]+/gi,get_num:/(\-|\+){0,1}(\W|^)\d+\.{0,1}\d{0,}/g,get_word:/[A-Za-z].*/},i={opType:"",optimize:"_obj",constraints:{},variables:{}},r={">=":"min","<=":"max","=":"equal"},o="",a=null,s="",l="",u="",d=0;"string"==typeof t&&(t=t.split("\n"));for(var c=0;c<t.length;c++)if(u="__"+c,a=null,n.is_objective.test(o=t[c]))i.opType=o.match(/(max|min)/gi)[0],(a=o.match(n.parse_lhs).map(function(p){return p.replace(/\s+/,"")}).slice(1)).forEach(function(p){s=null===(s=p.match(n.get_num))?"-"===p.substr(0,1)?-1:1:s[0],s=parseFloat(s),l=p.match(n.get_word)[0].replace(/\;$/,""),i.variables[l]=i.variables[l]||{},i.variables[l]._obj=s});else if(n.is_int.test(o))a=o.match(n.parse_int).slice(1),i.ints=i.ints||{},a.forEach(function(p){p=p.replace(";",""),i.ints[p]=1});else if(n.is_constraint.test(o)){var h=o.indexOf(":");(a=(-1===h?o:o.slice(h+1)).match(n.parse_lhs).map(function(p){return p.replace(/\s+/,"")})).forEach(function(p){s=null===(s=p.match(n.get_num))?"-"===p.substr(0,1)?-1:1:s[0],s=parseFloat(s),l=p.match(n.get_word)[0],i.variables[l]=i.variables[l]||{},i.variables[l][u]=s}),d=parseFloat(o.match(n.parse_rhs)[0]),o=r[o.match(n.parse_dir)[0]],i.constraints[u]=i.constraints[u]||{},i.constraints[u][o]=d}else n.is_unrestricted.test(o)&&(a=o.match(n.parse_int).slice(1),i.unrestricted=i.unrestricted||{},a.forEach(function(p){p=p.replace(";",""),i.unrestricted[p]=1}));return i}(e):function(t){if(!t)throw new Error("Solver requires a model to operate on");var n="",i={max:"<=",min:">=",equal:"="},r=new RegExp("[^A-Za-z0-9]+","gi");for(var o in n+=t.opType+":",t.variables)t.variables[o][o]=t.variables[o][o]?t.variables[o][o]:1,t.variables[o][t.optimize]&&(n+=" "+t.variables[o][t.optimize]+" "+o.replace(r,"_"));for(o in n+=";\n",t.constraints)for(var a in t.constraints[o]){for(var s in t.variables)t.variables[s][o]&&(n+=" "+t.variables[s][o]+" "+s.replace(r,"_"));n+=" "+i[a]+" "+t.constraints[o][a],n+=";\n"}if(t.ints)for(o in n+="\n\n",t.ints)n+="int "+o.replace(r,"_")+";\n";if(t.unrestricted)for(o in n+="\n\n",t.unrestricted)n+="unrestricted "+o.replace(r,"_")+";\n";return n}(e)}function Bv(){this.Model=Eh,this.branchAndCut=zS,this.Constraint=jS,this.Variable=ZS,this.Numeral=GS,this.Term=qS,this.Tableau=DS,this.lastSolvedModel=null,this.Solve=function(e,t,n,i){if(i)for(var r in zv)e=zv[r](e);if(!e)throw new Error("Solver requires a model to operate on");!(e instanceof Eh)&&(e=new Eh(t).loadJson(e));var o=e.solve();if(this.lastSolvedModel=e,o.solutionSet=o.generateSolutionSet(),n)return o;var a={};return a.feasible=o.feasible,a.result=o.evaluation,a.bounded=o.bounded,Object.keys(o.solutionSet).map(function(s){a[s]=o.solutionSet[s]}),a},this.ReformatLP=US,this.MultiObjective=function(e){return function(t,n){var i,r,o,a,s,l=n.optimize,u=JSON.parse(JSON.stringify(n.optimize)),d=Object.keys(n.optimize),c=0,h={},p="",g={},m=[];for(delete n.optimize,r=0;r<d.length;r++)u[d[r]]=0;for(r=0;r<d.length;r++){for(s in n.optimize=d[r],n.opType=l[d[r]],i=t.Solve(n,void 0,void 0,!0),d)if(!n.variables[d[s]])for(a in i[d[s]]=i[d[s]]?i[d[s]]:0,n.variables)n.variables[a][d[s]]&&i[a]&&(i[d[s]]+=i[a]*n.variables[a][d[s]]);for(p="base",o=0;o<d.length;o++)p+=i[d[o]]?"-"+(1e3*i[d[o]]|0)/1e3:"-0";if(!h[p]){for(h[p]=1,c++,o=0;o<d.length;o++)i[d[o]]&&(u[d[o]]+=i[d[o]]);delete i.feasible,delete i.result,m.push(i)}}for(r=0;r<d.length;r++)n.constraints[d[r]]={equal:u[d[r]]/c};for(r in n.optimize="cheater-"+Math.random(),n.opType="max",n.variables)n.variables[r].cheater=1;for(r in m)for(a in m[r])g[a]=g[a]||{min:1e99,max:-1e99};for(r in g)for(a in m)m[a][r]?(m[a][r]>g[r].max&&(g[r].max=m[a][r]),m[a][r]<g[r].min&&(g[r].min=m[a][r])):(m[a][r]=0,g[r].min=0);return{midpoint:i=t.Solve(n,void 0,void 0,!0),vertices:m,ranges:g}}(this,e)}}var jS=Xo.Constraint,ZS=Xo.Variable,GS=Xo.Numeral,qS=Xo.Term;"object"==typeof window&&(window.solver=new Bv);var HS=new Bv;function WS(e){var t={},n={},i={};e.nodes.forEach(function(o){n[o.id]=1,t[o.id]={opt:o.children.length},o.children.forEach(function(a){var s=o.id+"->"+a.id;i[s]={min:1},t[o.id][s]=-1})}),e.nodes.forEach(function(o){o.children.forEach(function(a){var s=o.id+"->"+a.id;t[a.id].opt--,t[a.id][s]=1})});var r=HS.Solve({optimize:"opt",opType:"max",constraints:i,variables:t,ints:n});return e.nodes.forEach(function(o){o.layer=r[o.id]||0}),e}function Vv(e){return e.nodes.forEach(function(t){t.layer=null!=t.data.layer?t.data.layer:t.layer}),e}function YS(e){var t=Object.assign({},{normalization:!0},e),n=WS;return function(i){if(i.nodes.some(function(c){return"layer"in c.data&&c.data.layer<0}))throw new Error("Some nodes have negative layering information");if(!t.normalization&&i.nodes.every(function(c){return"layer"in c.data&&-1<c.data.layer})){var r=[];i.nodes.forEach(function(c){return r[c.data.layer]=1});for(var o=r.findIndex(function(c){return null!=c}),a=0,s=r.slice(o);a<s.length;a+=1)if(null==s[a])throw new Error("The overall layering contains gaps (two non-consecutive layers)")}i.nodes.some(function(c){return"layer"in c.data&&0===c.data.layer})||Vv(n(i));var l,u,d=function(c){if(c.nodes.every(function(p){return p.layer})){var h=1/0;c.nodes.forEach(function(p){h=Math.min(h,p.layer)}),c.nodes.forEach(function(p){p.layer-=h})}return c}(function(c){if(c.nodes.some(function(p){return p.data.sink})){var h=-1/0;c.nodes.forEach(function(p){h=Math.max(h,p.layer)}),c.nodes.forEach(function(p){p.data.sink&&(p.layer=h+1)})}return c}(function(c){var h={};c.nodes.forEach(function(C){h[C.id]=(h[C.id]||[]).concat(C.children),C.children.forEach(function(O){h[O.id]=(h[O.id]||[]).concat([C])})});var p=[];c.nodes.forEach(function(C){0===C.layer&&p.push(C)});var g={},m={};for(c.nodes.forEach(function(C){null!=C.layer&&(m[C.id]=C.layer)});p.length;)for(var b=p.shift().id,v=0,y=h[b];v<y.length;v+=1){var S=y[v];if(!g[S.id]){if(null==m[S.id]){var A=m[b]+1;m[S.id]=A,S.layer=A}g[S.id]=!0,p.push(S)}}return c}(Vv(i))));return function(c,h){if(h.normalization){var p=[];c.nodes.forEach(function(m){return p[m.layer]=0});var g=Array.from(p).reduce(function(m,b,v){if(0===v)return m.push(0),m;var y=m[v-1];return m.push(null!=b?y:y-1),m},[]);c.nodes.forEach(function(m){m.layer+=g[m.layer]})}}(d,t),(u=(l=d).nodes.reduce(function(c,h){return h.data.fixed&&(null==c||c.layer>h.layer)?h:c},null))&&l.nodes.forEach(function(c){c.ref=u.id}),l}}var Jo=function(){this.root=null};function XS(e){return e.nodes.filter(function(t){return!t.layer})}Jo.prototype.fit=function(e){this.root={x:0,y:0,w:e.length?e[0].w:0,h:e.length?e[0].h:0};for(var i=0,r=e;i<r.length;i+=1){var o=r[i],a=this.findNode(this.root,o.w,o.h);o.fit=a?this.splitNode(a,o.w,o.h):this.growNode(o.w,o.h)}},Jo.prototype.findNode=function(e,t,n){return e.used?this.findNode(e.right,t,n)||this.findNode(e.down,t,n):t<=e.w&&n<=e.h?e:void 0},Jo.prototype.splitNode=function(e,t,n){return e.used=!0,e.down={x:e.x,y:e.y+n,w:e.w,h:e.h-n},e.right={x:e.x+t,y:e.y,w:e.w-t,h:n},e},Jo.prototype.growNode=function(e,t){var n=e<=this.root.w,i=t<=this.root.h;return i&&this.root.h>=this.root.w+e?this.growRight(e,t):n&&this.root.w>=this.root.h+t?this.growDown(e,t):i?this.growRight(e,t):n?this.growDown(e,t):void 0},Jo.prototype.getNewRoot=function(e,t,n,i){return void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=this.root),void 0===i&&(i=this.root),{used:!0,x:0,y:0,w:this.root.w+e,h:this.root.h+t,right:n,down:i}},Jo.prototype.growRight=function(e,t){return this.root=this.getNewRoot(e,0,{x:this.root.w,y:0,w:e,h:this.root.h}),this.grow(e,t)},Jo.prototype.growDown=function(e,t){return this.root=this.getNewRoot(0,t,void 0,{x:0,y:this.root.h,w:this.root.w,h:t}),this.grow(e,t)},Jo.prototype.grow=function(e,t){var n=this.findNode(this.root,e,t);if(n)return this.splitNode(n,e,t)};var Uv={down:function(){},up:function(e,t,n){e.y=-e.y+n},left:function(e,t,n){var i=e.x;e.x=-e.y+n,e.y=i-t},right:function(e,t,n){var i=e.x;e.x=e.y-n,e.y=-i+t}};function jv(e,t,n){for(var i,r,o,a,s=-1/0,l=-1/0,u=[],d=n.nodesSeparation||0,c=(i=t,o=(r=e.reduce(function(Ze,Ne){return Ne.nodes.reduce(function(Ge,Xe){var we=i[Xe.id]||{},Pe=we.x,je=we.y;return null!=Pe&&null!==je&&(Ge.x=Math.min(Pe,Ge.x),Ge.y=Math.min(je,Ge.y)),Ge},Ze)},{x:1/0,y:1/0})).x,a=r.y,{x:isFinite(o)?o:0,y:isFinite(a)?a:0}),h=e.reduce(function(Ze,Ne){return Ne.nodes.filter(function(Ge){return Ge.data&&Ge.data.fixed}).reduce(function(Ge,Xe){var $e=t[Xe.id];return Ge[Xe.id]={x:$e.x,y:$e.y},Ge},Ze)},{}),p=function(){var Ze=m[g],Ne={},Ge=Ze.nodes,Xe=1==Ge.length,$e=2*Iv(Ge)|5,we=null!=n.layerSeparation?n.layerSeparation:50,Pe=Ge.reduce(function(Z,z){return Math.min(Z,z.x)},1/0);s=Ge.reduce(function(Z,z){return Math.max(Z,z.x)},-1/0)-Pe;for(var je=0,Je=Ge;je<Je.length;je+=1){var ut=Je[je],Gt=ut.x,Xt=ut.y,an=ut.id;t[an]&&(Xe?t[an].x=t[an].y=0:(t[an].x=Gt-Pe,t[an].y=Xt,Ne[Xt]=Ne[Xt]||[],Ne[Xt].push(t[an])))}var nn=Math.max($e,we),ln=Object.keys(Ne),H=ln.reduce(function(Z,z){return Math.max(Z,Ne[z].length-1)},1)*(3+Math.max(1,d));l=(ln.length||1)*nn,s=Math.max(s,1),Ze.isFake||ln.sort(function(Z,z){return Z-z}).forEach(function(Z,z){Ne[Z].forEach(function(Q){Q.y=z*nn,Q.x=Q.x/s*H})}),u.push({w:Math.ceil(H),h:Math.ceil(l),dag:Ze}),l=s=-1/0},g=0,m=e;g<m.length;g+=1)p();u.sort(function(Ze,Ne){return Math.max(Ne.w,Ne.h)-Math.max(Ze.w,Ze.h)}),(new Jo).fit(u);for(var v,A=u.reduce(function(Ze,Ne){return Math.max(Ze,Ne.h)},1),C=u.reduce(function(Ze,Ne){var Ge=Ne.fit;return Math.max(Ge&&Ge.x||0,Ze)},1),O=0,N=u;O<N.length;O+=1){for(var P=N[O],L=P.dag,B=P.w,Y=P.h,X=P.fit||{x:0,y:0},ae=X.y/A*50+X.y,ie=X.x/C*100+X.x,U=0,W=L.nodes;U<W.length;U+=1){var ce=W[U].id;t[ce]&&(t[ce].x+=ie,t[ce].y+=ae,(v=n.direction)&&v in Uv&&Uv[v](t[ce],(B+ie)/2,(Y+ae)/2),t[ce].x+=c.x,t[ce].y+=c.y)}var he=L.nodes[0]&&L.nodes[0].ref,Ee=0,Te=0;if(he&&(Ee=t[he].x-h[he].x,Te=t[he].y-h[he].y),Ee||Te)for(var it=0,rt=L.nodes;it<rt.length;it+=1){var We=rt[it].id;t[We]&&(t[We].x-=Ee,t[We].y-=Te)}}for(var _t=0,wt=Object.keys(h);_t<wt.length;_t+=1){var Ue=wt[_t];t[Ue].x=h[Ue].x,t[Ue].y=h[Ue].y}return e}var Zv={rect:jv,hierarchy:function(e,t,n,i){var r=e;if(1<e.length){for(var o={id:"__root__",parentIds:[],virtual:!0},a=0,s=e.map(XS);a<s.length;a+=1)for(var l=0,u=s[a];l<u.length;l+=1)u[l].data.parentIds.push(o.id);r=i([e.reduce(function(d,c){return d.concat(c.nodes.map(function(h){return h.data}))},[o])],n)}return jv(r,t,n)}};function $S(e){if(!e||!e.length)throw Error("Cannot stratify empty data");for(var t=0,n=e;t<n.length;t+=1){var i=n[t];if(null==i)throw Error('Node data is "null"');if(null==i.id)throw Error('Node id contains a "null" value')}for(var r=e.map(function(g){return lh(g.id,g)}),o=r.reduce(function(g,m){if(g[m.id])throw Error("The connected component contains id duplicates: "+m.id);return g[m.id]=m,g},{}),a=lh(),s=0,l=r;s<l.length;s+=1){for(var u=l[s],d=0,c=u.data.parentIds;d<c.length;d+=1){var h=c[d],p=o[h];if(!p)throw Error("The node "+u.id+" has a missing parent id "+h);p.children.push(u)}u.data.parentIds.length||a.children.push(u)}return{nodes:function(g){for(var m={},b=[].concat(g.children),v=[];b.length;){var y=b.pop();m[y.id]||(v.push(y),m[y.id]=1,b.push.apply(b,y.children))}return v}(a)}}function tA(e,t){var n=t.decross,i=t.separation,r=t.coord;(0,t.layering)(e);var o,a,s=e.nodes.reduce(function(l,u){return l[u.layer]=l[u.layer]||[],l[u.layer].push(u),u.children=u.children.map(function(d){if(d.layer===u.layer+1)return d;for(var c=d,h=d.layer-1;h>u.layer;h--){var p=lh(u.id+"->"+d.id+"@"+h);p.children=[c],l[h]=l[h]||[],l[h].push(p),c=p}return c}),l},[]);return a=1===(o=s).length?nA:iA,o.forEach(function(l,u){for(var d=0,c=l;d<c.length;d+=1)c[d].y=a(u,o.length)}),function(l,u){var d=u.coord,c=u.decross,h=u.separation;if(l.every(function(p){return 1===p.length}))return l.forEach(function(p){return p[0].x=.5});c(l),d(l,h)}(s,{decross:n,coord:r,separation:i}),e.nodes.forEach(function(l){l.data&&(l.children=l.children.filter(function(u){return u.data}))}),e}function nA(){return.5}function iA(e,t){return 1*e/(t-1)}function Sh(e){return{id:""+e.id,layer:e.layer,sink:e.sink,radius:e.r,fixed:!1===e.layoutable,parentIds:[],ref:null}}function qv(e,t){void 0===t&&(t={});for(var n=[],i=0,r=e;i<r.length;i+=1){var o=$S(r[i]);n.push(o),tA(o,{decross:function(a){return a.slice(0,a.length-1).forEach(function(s,l){return OS(s,a[l+1])}),a},separation:MS(Iv(o.nodes)),coord:t.evenDistribution?function(e,t){var n=-hh;return e.forEach(function(i){var r=i.filter(Ru);if(1===r.length)r[0].x=.5;else{r.reduce(function(a,s){return s.x=void 0===a?0:a.x+t(a,s),s},void 0);var o=r[r.length-1].x;n=Math.max(n,o),r.forEach(function(a){return a.x/=o})}}),n=Math.max(n,1),us(e,function(i){return i.x*=n}),e}:function(e,t){var n,i,r,o,a,s,l=(n={},us(e,function(P){n[P.id]||(n[P.id]={successors:[],ancestors:[]});for(var F=0,L=P.children;F<L.length;F+=1){var B=L[F];n[B.id]||(n[B.id]={successors:[],ancestors:[]}),B.layer>P.layer&&(n[P.id].successors.push(B),n[B.id].ancestors.push(P)),B.layer<P.layer&&(n[P.id].ancestors.push(B),n[B.id].successors.push(P))}}),{getSuccessors:function(P){return n[P.id].successors},getAncestors:function(P){return n[P.id].ancestors}}),u=l.getSuccessors,d=l.getAncestors,c=(i={},us(e,function(P,F){i[P.id]=F}),i),h=(o=u,a=function(P){return c[P.id]},s=(r=e).length,r.reduce(function(P,F,L){var Y=P.conflicts;if(!L||s-2<L)return{prevLayer:P.prevLayer,conflicts:Y};var X=0,ae=F.length,ie=F[ae-1];return F.forEach(function(U,W){var ce=function(Te){if(Ru(Te))return o(Te).find(Ru)}(U),he=ce?a(ce):ae-1;if(ce||U===ie)for(var Ee=function(){var Te=F[X];o(Te).forEach(function(it){var rt=a(it);(rt<0||he<rt)&&(Y[Te.id]=Y[Te.id]||{},Y[Te.id][it.id]=!0)}),X++};X<=W;)Ee()}),{prevLayer:F,conflicts:Y}},{prevLayer:r[0],conflicts:{}}).conflicts),p={};ph(function(P){var F="up"===P?e:[].concat(e).reverse();fh(function(L){L===ch&&(F=F.map(function(Ee){return[].concat(Ee).reverse()}));var B,Y,X,ae,ie,U,W=t,ce=(Y=h,X="up"===P?d:u,ae={},ie={},U={},us(B=F,function(Ee,Te){ae[Ee.id]=Ee.id,ie[Ee.id]=Ee.id,U[Ee.id]=Te}),B.forEach(function(Ee){var Te=-1;Ee.forEach(function(it){var rt,We,_t=X(it).sort(function(Ge,Xe){return U[Ge.id]-U[Xe.id]});if(_t.length)for(var wt=(_t.length-1)/2,Ue=0,Ze=[Math.floor(wt),Math.ceil(wt)];Ue<Ze.length;Ue+=1){var Ne=_t[Ze[Ue]];ie[it.id]===it.id&&(We=Ne,!(Y[(rt=it).id]&&Y[rt.id][We.id]||Y[We.id]&&Y[We.id][rt.id])&&Te<U[Ne.id]&&(ie[Ne.id]=it.id,ae[it.id]=ae[Ne.id],ie[it.id]=ae[it.id],Te=U[Ne.id]))}})}),{roots:ae,aligns:ie}),he=function(Ee,Te,it,rt){var We={},_t={},wt={},Ue={},Ze={},Ne={},Ge={};us(Ee,function(we,Pe,je){We[we.id]=we,_t[we.id]=hh,wt[we.id]=Pe,Ze[we.id]=je[Pe-1]||we,Ne[we.id]=we,Ge[we.id]=0});var Xe=Math.max(1e4,1+Object.keys(Ge).length/2);function $e(we){if(null==Ue[we.id]){Ue[we.id]=0;for(var Pe=we,je=!1;!je;){if(null!=Ze[Pe.id]){var Je=Ne[Te[Ze[Pe.id].id]];if(Ge[Je.id]>Xe)return;$e(Je),Ge[Je.id]++,We[we.id]===we&&(We[we.id]=We[Je.id]),We[we.id]!==We[Je.id]?_t[We[Je.id].id]=Math.min(_t[We[Je.id].id],Ue[we.id]-Ue[Je.id]-rt(we,Ze[we.id])):Ue[we.id]=Math.max(Ue[we.id],Ue[Je.id]+rt(we,Ze[we.id]))}je=(Pe=Ne[it[Pe.id]])===we}}}return Ee.forEach(function(we){we.filter(function(Pe){return Te[Pe.id]===Pe.id}).forEach($e)}),us(Ee,function(we){Ue[we.id]=Ue[Te[we.id]];var Pe=_t[We[Te[we.id]].id];we.id===Te[we.id]&&isFinite(Pe)&&(Ue[we.id]+=Pe)}),Ue}(F,ce.roots,ce.aligns,W);L===ch&&(he=uh(he,function(Ee){return-Ee})),p[P+L]=he})});var g,m,b,v,y,S,A,C=(g=p,m=Object.keys(g).reduce(function(P,F){var L=P.alignment,B=P.value,Y=sh(g[F]),X=Math.max.apply(Math,Y)-Math.min.apply(Math,Y);return B<=X?{alignment:L,value:B}:{alignment:F,value:X}},{alignment:null,value:hh}).alignment,g[m]);b=p,y=sh(v=C),S=Math.min.apply(Math,y),A=Math.max.apply(Math,y),ph(function(P){fh(function(F){var L=P+F,B=b[L];if(B!==v){var Y=sh(B),X=F===dh?S-Math.min.apply(Math,Y):A-Math.max.apply(Math,Y);X&&(b[L]=uh(B,function(ae){return ae+X}))}})});var O,N=uh((O=p).upleft,function(P,F){var L=[];return ph(function(B){fh(function(Y){L.push(O[B+Y][F])})}),L.sort(function(B,Y){return B-Y}),(L[1]+L[2])/2});return us(e,function(P){P.x=N[P.id]}),e},layering:YS(t)})}return n}function Hv(e,t){if(!e||!e.nodes)return e;var i,a,l=t||{},u=function(e,t){void 0===t&&(t={});for(var n=(e.edges||[]).filter(function(d){return d.source!==d.target}),i={},r=0,o=e.nodes;r<o.length;r+=1){var a=o[r];i[a.id]=a}var s=function(e,t,n){var i=t.reduce(function(o,a){return o[a.source]=o[a.source]||[],o[a.source].push(a),o},{}),r=e.reduce(function o(a,s){var l=a.visited,u=a.stack,d=a.result;if(l[s.id])return a;l[s.id]=u[s.id]=1;for(var c=0,h=i[s.id]||[];c<h.length;c+=1){var p=h[c];u[p.target]?d.push(p):o(a,n[p.target])}return delete u[s.id],a},{visited:{},stack:{},result:[]}).result.reduce(function(o,a){var s=a.source,l=a.target;return o[s]=o[s]||{},o[s][l]=1,o},{});return t.map(function(o){var a=o.source,s=o.target;return r[a]&&r[a][s]?{source:s,target:a}:o})}(e.nodes,n,i),l=function(d,c,h){void 0===h&&(h={});for(var p=Mv(c),g=Object.keys(p),m=[];g.length;){var b=TS(g[0],p);m.push(b),g=IS(g,b)}return h.skipSingletons?m:m.concat(kv(d,c,p).map(function(v){return[v.id+""]}))}(e.nodes,s,{skipSingletons:"singleton"===t.packing}),u=s.reduce(function(d,c){return d[c.source]||(d[c.source]=Sh(i[c.source])),d[c.target]||(d[c.target]=Sh(i[c.target])),d[c.target].parentIds.push(""+c.source),d},{});return{shapes:l.map(function(d){return d.map(function(c){return u[c]||Sh({id:c})})}),nLookup:i}}(e,l),c=u.nLookup,h=qv(u.shapes,l);if("singleton"===l.packing){var p=kv(e.nodes,e.edges),g=function(e,t){void 0===t&&(t={});var n=e.slice().sort(function(d,c){return c.r-d.r}),i=Math.sqrt(n.length),r=Math.floor(i),o=Math.ceil(i);r*o<n.length&&(r<o?r++:o++);var a=1.2*n.reduce(function(d,c){return Math.max(d,2*c.r)},0),s=Math.max(t.nodesGridSeparation||50,1),l=a*o+s*(o-1),u=a*r+s*Math.max(r-1,0);return n.forEach(function(d,c){var h=c%o,p=Math.floor(c/o);d.x=l*h/o,d.y=u*p/r}),{w:l,h:u}}(p,l);h.push((i=g,Object.assign({},{nodes:p.map(function(m){return Object.assign({},m,{data:m})}),isFake:!0},i)))}return void 0===(a=l)&&(a={}),(Zv[a.packing]||Zv.rect)(h,c,a,qv),e}var Wv={direction:"TB",nodeDistance:50,levelDistance:50,arrangeComponents:"fit",gridDistance:50,layer:"layer"},Yv={imports:{sequential:Hv},configure:function(e,t){void 0===e&&(e={});var n=t.graph,i=t.data;function r(S,A,C){return void 0===C&&(C=S.getNodes()),A?A instanceof or?A:S.getNodes(A):C}var o=Mt({},Wv,e,{nodeList:null});o.nodeList=r(n,e.nodes),o.direction=e.direction||o.rankdir||Wv.direction,o.layerSeparation=o.levelDistance,o.nodesSeparation=o.nodeDistance,o.packing=o.arrangeComponents;var a=Mt({},o),s=n.getEdges(),l=n.getNodes(o.nodeList);if(-1===["TB","BT","LR","RL"].indexOf(o.direction))throw new Error('direction should be one of the "TB", "BT", "LR", "RL"');if(-1===["fit","grid","singleLine"].indexOf(o.packing))throw new Error('arrangeComponents should be one of the "fit", "grid", "singleLine"');o.nodesGridSeparation=e.gridDistance;var u=l.getId(),d=l.getAttribute("layoutable").reduce(function(S,A,C){return S[u[C]]=A,S},{}),c=l.getAttributes(["x","y"]).reduce(function(S,A,C){return S[u[C]]=A,S},{}),h=l.getAttribute("radius");if("string"!=typeof a.layer)throw new Error("'layer' should be the valid data field name");for(var p=r(n,o.roots,n.nodeList()),g=i.getProperty(o.nodeList,a.layer),m=0,b=p.map(function(S){var A=-1;return o.nodeList.forEach(function(C,O){C===S&&(A=O)}),A});m<b.length;m++)g[b[m]]=0;var v=r(n,o.sinks,n.nodeList()).toArray().reduce(function(S,A){return S[A.getId()]=!0,S},{}),y=u.map(function(S){return v[S]});return{nodes:u,edges:s.map(function(S){return{id:S.getId(),source:S.getSource().getId(),target:S.getTarget().getId()}}),options:qi(o),layoutable:d,radiuses:h,layers:g,sinks:y,coords:c}},context:function(){},update:function(e){var t=e.nodes,i=e.options,r=e.layoutable,o=e.radiuses,a=e.layers,s=e.sinks,l=e.coords,u=e.edges.filter(function(d){return d.source in r&&d.target in r});return{positions:Hv({nodes:t.map(function(d,c){return{id:d,r:o[c],layer:a[c],sink:s[c],layoutable:r[d],x:l[d].x,y:l[d].y}}),edges:u},{packing:{fit:"rect",singleLine:"hierarchy",grid:"singleton"}[i.arrangeComponents],direction:{TB:"down",BT:"up",RL:"left",LR:"right"}[i.direction],layerSeparation:i.layerSeparation,nodesSeparation:i.nodesSeparation,nodesGridSeparation:i.nodesGridSeparation,evenDistribution:i.evenDistribution}).nodes}},isRunning:function(){return!1},onSync:function(e,t){var n=e.positions,i=t.graph;return{indexes:n.map(function(r){return i.getNode(r.id)._index}),x:n.map(function(r){return r.x}),y:n.map(function(r){return r.y})}}},aA={configure:function(e,t){var n=t.graph,i=t.camera;function r(B){return void 0===B||"number"==typeof B&&isFinite(B)&&0<B}var o=e.sortBy,a=Mt({},e,{nodes:null});e.nodes||(a.nodes=n.getNodes()),e.nodes&&(a.nodes=e.nodes instanceof or?e.nodes:n.getNodes(e.nodes));var s,l,u,d,c,h=a.nodes,p=Array.from(h._indexes),m=function(B,Y,X){if(!r(B))throw new TypeError('"rows" should be a positive integer');if(!r(Y))throw new TypeError('"cols" should be a positive integer');if(B)return{rows:B,cols:Math.ceil(X/B)};if(Y)return{cols:Y,rows:Math.ceil(X/Y)};var ae=Math.ceil(Math.sqrt(X));return{cols:ae,rows:Math.ceil(X/ae)}}(a.rows,a.cols,p.length),b=m.rows,v=m.cols,y=(l=n,u=h,d=p,c=e.sortFallbackValue,"string"!=typeof(s=o)?d.map(function(B,Y){return Y}):"radius"===s?l.getAttribute(!0,"radius").getMultiple(d):"random"===s?d.map(function(){return Math.random()}):u.getData(s).map(function(B){return B||c})),S=h.getAttribute("layoutable"),A=p.reduce(function(B,Y,X){return S[X]&&B.push({id:Y,attr:y[X]}),B},[]),C=h.getBoundingBox(),O=.65*Math.max(C.maxScaledSize,C.maxFixedSize/i.getZoom()),N=C.minX+O,P=C.maxX-O,F=C.minY+O,L=C.maxY-O;return C.width<O*v*2&&(N=C.cx-O*v+O,P=C.cx+O*v-O),C.height<O*b*2&&(F=C.cy-O*b+O,L=C.cy+O*b-O),{sort:!!o,nodes:A,reverse:!!a.reverse,cols:v,rows:b,minX:N,maxX:P,minY:F,maxY:L}},update:function(e){var n=e.nodes,i=e.maxX,r=e.minX,o=e.maxY,a=e.minY,s=e.reverse,l=e.rows,u=e.cols;e.sort&&n.sort(function(b,v){var y=b.attr,S=v.attr;return y<S?-1:S<y?1:0}),s&&n.reverse();var d=(i-r)/(u-1),c=(o-a)/(l-1),h=r,p=a;isFinite(d)||(d=0),isFinite(c)||(c=0);var g=0,m=0;return n.forEach(function(b){b.x=h+g*d,b.y=p+m*c,(g+=1)===u&&(m+=1,g=0)}),n},onSync:function(e){return{indexes:e.map(function(t){return t.id}),x:e.map(function(t){return t.x}),y:e.map(function(t){return t.y})}}},Xv=(Jv.initNamespace=function(e){e.layouts=function(e){return Mt({},((l=e).modules.layouts.register("concentric",yS),{concentric:function(u){return l.modules.layouts.start("concentric",u)}}),((s=e).modules.layouts.register("radial",xS),{radial:function(u){if(void 0===u.centralNode)throw new Error('concentric layout: missing parameter "centralNode"');u.nodes=s.modules.graph.getNodes(u.nodes);var d=u.nodes.size;if(u.radiusRatio=isFinite(u.radiusRatio)?u.radiusRatio:Math.SQRT2,u.radiusDelta=isFinite(u.radiusDelta)?u.radiusDelta:0,u.nodeGap=isFinite(u.nodeGap)?u.nodeGap:10,u.repulsion=d*(isFinite(u.repulsion)?u.repulsion:1),u.maxIterations=isFinite(u.maxIterations)?Math.floor(u.maxIterations):100,u.maxIterations<1)throw new RangeError("maxIterations must be a positive integer");if(u.iterationsPerRender=isFinite(u.iterationsPerRender)?Math.floor(u.iterationsPerRender):20,u.iterationsPerRender<1)throw new RangeError("iterationsPerRender must be a positive integer");if(u.epsilon=isFinite(u.epsilon)?u.epsilon:.001,u.epsilon<=0)throw new RangeError("epsilon has to be a positive number");return s.modules.layouts.start("radial",u)}}),((a=e).modules.layouts.register("force",bS),{force:function(u){if(void 0===u&&(u={}),u.nodes){if(Array.isArray(u.nodes))u.nodes=a.getNodes(u.nodes);else if(!(u.nodes instanceof or))throw new Error("'nodes' must be a NodeList or an Array<NodeId>")}else u.nodes=a.modules.graph.getNodes();if(u.incremental)return Cv(u,a,a.layouts.force);if(void 0!==u.edgeStrength&&(!isFinite(u.edgeStrength)||u.edgeStrength<=0||1<u.edgeStrength))throw new Error("force layout: edgeStrength must be between 0 and 1");if(void 0!==u.steps&&(!isFinite(u.steps)||u.steps<=0))throw new Error("force layout: 'steps' must be a positive integer");if(void 0!==u.edgeLength&&(!isFinite(u.edgeLength)||u.edgeLength<=0))throw new Error("force layout: 'edgeLength' must be positive");if(void 0!==u.gravity&&(!isFinite(u.gravity)||u.gravity<0||1<=u.gravity))throw new Error("force layout: 'gravity' must be between 0 and 1");if(void 0!==u.charge&&!isFinite(u.charge))throw new Error("force layout: 'charge' must be a number");if(void 0!==u.radiusRatio&&(!isFinite(u.radiusRatio)||u.radiusRatio<0))throw new Error("force layout: 'radiusRatio' must be a positive number");if(void 0!==u.theta&&(!isFinite(u.theta)||u.theta<0||1<u.theta))throw new Error("force layout: 'theta' must be between 0 and 1");if(!(void 0===u.cx&&void 0===u.cy||"number"==typeof u.cx&&"number"==typeof u.cy))throw new Error("force layout: both 'cx' and 'cy' must be numbers");if(void 0!==u.siblingsOffset&&!isFinite(u.siblingsOffset))throw new Error("force layout: 'siblingsOffset' must be a number");return a.modules.layouts.start("force",u)}}),((o=e).modules.layouts.register("forceLink",CS),{forceLink:function(u){if(void 0===u&&(u={}),u.nodes){if(Array.isArray(u.nodes))u.nodes=o.getNodes(u.nodes);else if(!(u.nodes instanceof or))throw new Error("'nodes' must be a NodeList or an Array<NodeId>")}else u.nodes=o.modules.graph.getNodes();return u.incremental?Cv(u,o,o.layouts.forceLink):o.modules.layouts.start("forceLink",u)}}),((r=e).modules.layouts.register("hierarchical",Yv),{hierarchical:function(u){return void 0===u&&(u={}),u.useWebWorker=!1,r.modules.layouts.start("hierarchical",u)}}),((i=e).modules.layouts.register("sequential",Yv),{sequential:function(u){void 0===u&&(u={}),u.useWebWorker=!1;var d=Mt({},u,{evenDistribution:!0});return i.modules.layouts.start("sequential",d)}}),((n=e).modules.layouts.register("grid",aA),{grid:function(u){return void 0===u&&(u={}),n.modules.layouts.start("grid",u)}}),(t=e,{incremental:function(u){eo("Incremental ForceLink layout is now deprecated.\n    Please use the incremental option in force and forceLink layouts.");var d=u.nodes,c=u.centralNode;if(d instanceof or&&0===d.size||Array.isArray(d)&&0===d.length)throw new Error("Incremental ForceLink layout: no nodes are selected");if("margin"in u&&!isFinite(u.margin))throw new Error("Incremental ForceLink layout: margin has to be a positive number");if(c&&!c.getAttribute("layoutable"))return wv(t,u,t.layouts.forceLink);var h=Mt({},u,{nodes:u.nodes instanceof or?u.nodes:t.getNodes(u.nodes)});return Av(t,h,t.layouts.forceLink)}}),{stop:function(){return e.modules.layouts.stop()}});var t,n,i,r,o,a,s,l}(e)},Jv);function Jv(){}var Qv=(Kv.initNamespace=function(e){var t;e.mouse=(t=e,{move:function(n){return t.modules.virtualMouse.move(n)},down:function(n){return t.modules.virtualMouse.down(n)},up:function(n){return t.modules.virtualMouse.up(n)},click:function(n){return t.modules.virtualMouse.click(n)},rightClick:function(n){return t.modules.virtualMouse.rightClick(n)},doubleClick:function(n){return t.modules.virtualMouse.doubleClick(n)},drag:function(n,i){return t.modules.virtualMouse.drag(n,i)},wheel:function(n){return t.modules.virtualMouse.wheel(n)}})},Kv);function Kv(){}var $v=(ey.initNamespace=function(e){var t;e.pathfinding=(t=e,{astar:function(n,i,r){return void 0===r&&(r={}),t.modules.pathfinding.astar(n,i,r)},dijkstra:function(n,i,r){return void 0===r&&(r={}),t.modules.pathfinding.dijkstra(n,i,r)},dijkstraBig:function(n,i,r){return void 0===r&&(r={}),t.modules.pathfinding.dijkstraBig(n,i,r)}})},ey);function ey(){}var ty=(ny.initNamespace=function(e){var t;e.rules=(t=e,{map:function(n){return t.modules.rules.createMapping(n)},slices:function(n){return t.modules.rules.createSlices(n)},template:function(n){return t.modules.rules.createTemplate(n)}})},ny);function ny(){}var sA=(Ws.prototype.clearSelection=function(){return this.modules.selection.clear()},Ws.prototype.getSelectedNodes=function(){return this.modules.selection.getSelectedNodes()},Ws.prototype.getNonSelectedNodes=function(){return this.modules.selection.getNonSelectedNodes()},Ws.prototype.getSelectedEdges=function(){return this.modules.selection.getSelectedEdges()},Ws.prototype.getNonSelectedEdges=function(){return this.modules.selection.getNonSelectedEdges()},Ws);function Ws(){}var uA=(Ah.prototype.setOptions=function(e){return this.modules.settings.update(e)},Ah.prototype.getOptions=function(){return this.modules.settings.get()},Ah);function Ah(){}var iy=(ry.initNamespace=function(e){var t;e.styles=(t=e,{setNodesVisibility:function(n){return t.modules.graphics.setNodesVisibility(n)},setEdgesVisibility:function(n){return t.modules.graphics.setEdgesVisibility(n)},setNodeTextsVisibility:function(n){return t.modules.graphics.setNodeTextsVisibility(n)},setEdgeTextsVisibility:function(n){return t.modules.graphics.setEdgeTextsVisibility(n)},addRule:function(n){return t.modules.styleRules.addRule(n)},getRuleList:function(){return t.modules.styleRules.getRuleList()},addNodeRule:function(n,i){var r,o;return o=1===arguments.length?void(r=n):(r=i,n),t.styles.addRule({nodeAttributes:r,nodeSelector:o})},addEdgeRule:function(n,i){var r,o;return o=1===arguments.length?void(r=n):(r=i,n),t.styles.addRule({edgeAttributes:r,edgeSelector:o})},getNodeRules:function(){return t.styles.getRuleList().filter(function(n){return void 0===n.getDefinition().edgeAttributes})},getEdgeRules:function(){return t.styles.getRuleList().filter(function(n){return void 0===n.getDefinition().nodeAttributes})},createClass:function(n){return t.modules.classes.createClass(n)},getClass:function(n){return t.modules.classes.getClassByName(n)},getClassList:function(){return t.modules.classes.getClassList()},setHoveredNodeAttributes:function(n,i){t.modules.hover.updateNodeAttributes(n,i)},setHoveredEdgeAttributes:function(n,i){t.modules.hover.updateEdgeAttributes(n,i)},setSelectedNodeAttributes:function(n,i){return t.modules.selection.setNodeAttributes(n,i)},setSelectedEdgeAttributes:function(n,i){return t.modules.selection.setEdgeAttributes(n,i)}})},ry);function ry(){}var oy=(ay.initNamespace=function(e){var t;e.schema=(t=e,{watchNodeObjectProperty:function(n){return t.modules.watcher.watchNodeObjectProperty(n)},watchEdgeObjectProperty:function(n){return t.modules.watcher.watchEdgeObjectProperty(n)},watchNodeNonObjectProperty:function(n){return t.modules.watcher.watchNodeNonObjectProperty(n)},watchEdgeNonObjectProperty:function(n){return t.modules.watcher.watchEdgeNonObjectProperty(n)}})},ay);function ay(){}var sy=(uy.initNamespace=function(e){e.tools=function(e){return{lasso:{enable:function(d){return u.modules.lasso.enable(d),this},disable:function(){return u.modules.lasso.disable(),this},enabled:function(){return u.modules.lasso.enabled()}},connectNodes:{enable:function(d){return l.modules.connectNodes.enable(d),this},disable:function(){return l.modules.connectNodes.disable(),this},enabled:function(){return l.modules.connectNodes.enabled()}},legend:{enable:function(d){return s.modules.legend.enable(d)},disable:function(){return s.modules.legend.disable()},enabled:function(){return s.modules.legend.enabled()},getOptions:function(){return s.modules.legend.getOptions()}},rectangleSelect:{enable:function(d){a.modules.rectangleSelect.enable(d)},disable:function(){a.modules.rectangleSelect.disable()},enabled:function(){return a.modules.rectangleSelect.enabled()}},resize:{enable:function(d){return o.modules.resizing.enable(d),this},disable:function(){return o.modules.resizing.disable(),this},enabled:function(){return o.modules.resizing.enabled()}},rewire:{enable:function(d){return r.modules.rewiring.enable(d),this},disable:function(){return r.modules.rewiring.disable(),this},enabled:function(){return r.modules.rewiring.enabled()}},snapping:{enable:function(d){return i.modules.snapping.enable(d),this},disable:function(){return i.modules.snapping.disable(),this},enabled:function(){return i.modules.snapping.enabled()}},tooltip:{onNodeHover:function(d,c){n.modules.tooltip.setHandler("hover.node",d,c)},onNodeClick:function(d,c){n.modules.tooltip.setHandler("click.left.node",d,c)},onNodeRightClick:function(d,c){n.modules.tooltip.setHandler("click.right.node",d,c)},onNodeDoubleClick:function(d,c){n.modules.tooltip.setHandler("doubleClick.left.node",d,c)},onEdgeHover:function(d,c){n.modules.tooltip.setHandler("hover.edge",d,c)},onEdgeClick:function(d,c){n.modules.tooltip.setHandler("click.left.edge",d,c)},onEdgeRightClick:function(d,c){n.modules.tooltip.setHandler("click.right.edge",d,c)},onEdgeDoubleClick:function(d,c){n.modules.tooltip.setHandler("doubleClick.left.edge",d,c)},onBackgroundClick:function(d,c){n.modules.tooltip.setHandler("click.left.background",d,c)},onBackgroundRightClick:function(d,c){n.modules.tooltip.setHandler("click.right.background",d,c)},onBackgroundDoubleClick:function(d,c){n.modules.tooltip.setHandler("doubleClick.left.background",d,c)},refresh:function(){return n.modules.tooltip.refresh()},isShown:function(){return n.modules.tooltip.isShown()},hide:function(){n.modules.tooltip.hide()},show:function(d,c){return n.modules.tooltip.show(d,c)}},brand:(t=n=i=r=o=a=s=l=u=e,{set:function(d,c){return t.modules.brand.set(d,c)},remove:function(){t.modules.brand.remove()}})};var t,n,i,r,o,a,s,l,u}(e)},uy);function uy(){}function ly(e){return!0}function dy(e){return""}function wh(e,t,n){return{}}var cy,hy=(bt(Ys,cy=Au),Ys.prototype._computeNodeGroupId=function(e){return this._nodeSelector(e)?this._nodeGroupIdFunction(e):void 0},Ys.prototype._computeEdgeGroupId=function(e){return this._edgeSelector(e)?this._edgeGroupIdFunction(e):void 0},Ys.prototype._addMetaNodes=function(e,t){for(var n=t.getId(),i=e.getNodes(),r=new Map,o=0;o<i.size;++o){var a=i.get(o);if(void 0!==(c=this._computeNodeGroupId(a))){var s=r.get(c);s||r.set(c,s={id:c,nodes:[]}),s.nodes.push(a)}}var l=ws(r),u=l.map(function(g){return e.getNodes(g.nodes)}),d=[];for(o=0;o<l.length;++o){var c=l[o].id,h=u[o],p=this._nodeGenerator(h,c,t);void 0===p.id&&(p.id=py(c,n)),p.position=gc(h.getPosition()),d.push(p)}return e.addNodes(d.map(function(g){return{id:g.id,attributes:g.position}}),{virtual:!0}).then(function(){var g=e.getNodes(d.map(function(S){return S.id}));g.replaceOriginalAttributes(d.map(function(S){return S.attributes}),["x","y"]);for(var m=g.getData(),b=0;b<m.length;b++){var v=m[b],y=d[b];m[b]=void 0===v?y.data:Mt({},v,y.data)}return g.setData(null,m),g.setVisible(!0),e.modules.grouping.setSubElements(g,u),u.forEach(function(S,A){e.modules.grouping.setMetaElement(S,g.get(A))}),g})},Ys.prototype._addMetaEdges=function(e,t){for(var n=t.getId(),i=e.getEdges(),r=new Map,o=e.modules.graphics.getAttributesManager().getUsedEdgeAttributes(),a=0;a<i.size;++a){var s=i.get(a);if(void 0!==(S=this._computeEdgeGroupId(s))){var l=this._edgeSource(s),u=this._edgeTarget(s),d=this._groupEdges?dA(S,l.getId(),u.getId(),this._separateEdgesByDirection):String(s.getId());(y=r.get(d))||r.set(d,y={id:d,source:l,target:u,edges:[]}),y.edges.push(s)}}var p,g,m=ws(r),b=m.map(function(O){return e.getEdges(O.edges)}),v=[];for(a=0;a<m.length;++a){var y,S=(y=m[a]).id,A=b[a],C=this._groupEdges?this._edgeGenerator(A,S,t):(p=o,g=void 0,{data:(g=A.get(0)).getData(),attributes:g.getAttributes(p)});if(null!=C.id&&null!=e.getEdge(C.id))throw Error("The id "+C.id+" returned by the edgeGenerator function is not a unique id.");void 0===C.id&&(C.id=py(S,n)),C.source=y.source.getId(),C.target=y.target.getId(),v.push(C)}return e.addEdges(v.map(function(O){return{id:O.id,source:O.source,target:O.target}}),{virtual:!0}).then(function(){var O=e.getEdges(v.map(function(B){return B.id}));O.replaceOriginalAttributes(v.map(function(B){return B.attributes}));for(var N=O.getData(),P=0;P<N.length;P++){var F=v[P],L=N[P];N[P]=void 0===L?F.data:Mt({},L,F.data)}return O.setData(null,N),O.setVisible(!0),e.modules.grouping.setSubElements(O,b),b.forEach(function(B,Y){e.modules.grouping.setMetaElement(B,O.get(Y))}),O})},Ys);function Ys(e){var t=cy.call(this,e)||this;return t._nodeSelector=e.nodeSelector,t._nodeGroupIdFunction=e.nodeGroupIdFunction,t._nodeGenerator=e.nodeGenerator,t._edgeSelector=e.edgeSelector,t._edgeGroupIdFunction=e.edgeGroupIdFunction,t._edgeGenerator=e.edgeGenerator,t._edgeSource=e.edgeSource,t._edgeTarget=e.edgeTarget,t._separateEdgesByDirection=e.separateEdgesByDirection,t._groupSelfLoopEdges=e.groupSelfLoopEdges,t._groupEdges=e.groupEdges,t}function dA(e,t,n,i){var r=t,o=n;return!i&&r.toString()>o.toString()&&(r=n,o=t),e+"["+r+"-"+o+"]"}function py(e,t){return"gen_grp_"+t+"_"+e}var fy,cA=(bt(Xs,fy=hy),Xs.prototype.getName=function(){return"node-grouping"},Xs.prototype.run=function(e){var t,n,i,r,o,a=this,s=e.ogma,l=e.duration,u=e.wrapper;return this._addMetaNodes(s,u).then(function(d){return(t=d).setVisible(!1),a._addMetaEdges(s,u)}).then(function(d){(n=d).setVisible(!1),i=t.getSubNodes().reduce(function(h,p){return h.concat(p)},s.createNodeList()),r=n.getSubEdges().reduce(function(h,p){return h.concat(p)},s.createEdgeList());var c=s.getNodes(i.getMetaNode()).getPosition();return o=i.getPosition().map(function(h,p){var g=c[p];return{x:h.x-g.x,y:h.y-g.y}}),i.setAttributes(c,l)}).then(function(){return i.setVisible(!1),r.setVisible(!1),t.setVisible(!0),n.filter(function(d){return a._groupSelfLoopEdges||d.getSource()!==d.getTarget()}).setVisible(!0),{metaNodes:t,metaEdges:n,subNodes:i,subEdges:r,offsets:o}})},Xs.prototype.undo=function(e){var t=this,n=e.ogma,i=e.duration,r=e.context,o=r.metaNodes,a=r.metaEdges,s=r.subNodes,l=r.subEdges,u=r.offsets,d=n.getNodes(s.getMetaNode()).getPosition(),c=d.map(function(h,p){return{x:(g=h).x+(m=u[p]).x,y:g.y+m.y};var g,m});return s.setVisible(!0),l.setVisible(!0),n.modules.grouping.setMetaElement(s,null),n.modules.grouping.setMetaElement(l,null),o.setVisible(!1),a.setVisible(!1),s.setAttributes(d).then(function(){if(t._restorePositions)return s.setAttributes(c,i)})},Xs.prototype.cleanup=function(e){var t=e.ogma,n=e.context,r=n.metaEdges,o=n.metaNodes.filter(function(s){return!s.isVisible()}),a=r.filter(function(s){return!s.isVisible()});return Promise.all([t.removeEdges(a,{virtual:!0}),t.removeNodes(o,{virtual:!0})]).then(function(){return Promise.resolve()})},Xs);function Xs(e){var t=e.selector,i=e.groupIdFunction,o=e.nodeGenerator,s=e.edgeGenerator,u=e.separateEdgesByDirection,c=e.groupSelfLoopEdges,h=void 0!==c&&c,p=e.groupEdges,m=e.restorePositions,b=void 0===m||m,v=fy.call(this,{nodeSelector:void 0===t?ly:t,nodeGroupIdFunction:void 0===i?dy:i,nodeGenerator:void 0===o?wh:o,edgeSelector:function(y){return!(!y.getSource().getMetaNode()&&!y.getTarget().getMetaNode())},edgeGroupIdFunction:function(){return""},edgeGenerator:void 0===s?wh:s,edgeSource:function(y){return gy(y.getSource())},edgeTarget:function(y){return gy(y.getTarget())},separateEdgesByDirection:void 0!==u&&u,groupEdges:void 0===p||p})||this;return v._groupSelfLoopEdges=h,v._restorePositions=b,v}function gy(e){return e.getMetaNode()||e}var _y,hA=(bt(Js,_y=hy),Js.prototype.getName=function(){return"edge-grouping"},Js.prototype.run=function(e){var t,n,i=e.ogma;return this._addMetaEdges(i,e.wrapper).then(function(o){return(n=(t=o).getSubEdges().reduce(function(a,s){return a.concat(s)},i.createEdgeList())).setVisible(!1),{metaEdges:t,subEdges:n}})},Js.prototype.undo=function(e){var t=e.context,n=t.metaEdges;return t.subEdges.setVisible(!0),n.setVisible(!1),Promise.resolve()},Js.prototype.cleanup=function(e){return e.ogma.removeEdges(e.context.metaEdges.filter(function(i){return!i.isVisible()}),{virtual:!0})},Js);function Js(e){var t=e.selector,i=e.groupIdFunction,o=e.generator,s=e.separateEdgesByDirection;return _y.call(this,{nodeSelector:null,nodeGroupIdFunction:null,nodeGenerator:null,edgeSelector:void 0===t?ly:t,edgeGroupIdFunction:void 0===i?dy:i,edgeGenerator:void 0===o?wh:o,edgeSource:function(u){return u.getSource()},edgeTarget:function(u){return u.getTarget()},separateEdgesByDirection:void 0!==s&&s,groupEdges:!0})||this}var my,pA=(bt(Qs,my=Au),Qs.prototype.getName=function(){return Ao.NeighborGeneration},Qs.prototype.run=function(e){for(var t,n=this,i=e.ogma,r=e.duration,o=e.wrapper.getId(),a=i.getNodes(),s=new Map,l=0;l<a.size;++l){var u=a.get(l),d=(t=this._generateIds(u),Array.isArray(t)?t:t?[t]:null);if(d)for(var c=0;c<d.length;++c){var h=d[c];(y=s.get(h))||s.set(h,y=[]),y.push(u)}}var p,g,m=new Array(s.size),b=il(s),v=ws(s).map(function(C){return i.getNodes(C)});for(l=0;l<m.length;++l){var y=v[l],S=this._nodeGenerator(h=b[l],y);S.id="_gen_"+o+"_"+h;var A=gc(y.getPosition());S.attributes=S.attributes||{},S.attributes.x=A.x,S.attributes.y=A.y,m[l]=S}return i.addNodes(m.map(function(C){return{id:C.id,attributes:C.attributes}}),{virtual:!0}).then(function(C){(p=C).replaceOriginalAttributes(m.map(function(X){return X.attributes}),["x","y"]),p.setData(null,m.map(function(X){return X.data}));for(var O=[],N=0;N<C.size;++N)for(var P=C.get(N),F=v[N],L=0;L<F.size;++L){var B=F.get(L),Y=n._edgeGenerator(B,P);Y.source||Y.target||(Y.source=B.getId(),Y.target=P.getId()),O.push(Y)}return i.addEdges(O,{virtual:!0})}).then(function(C){return g=C,p.setVisible(!0),g.setVisible(!0),p.addClass(oi),g.addClass(oi),Promise.all([p.removeClass(oi,r),g.removeClass(oi,r)])}).then(function(){return{virtualNodes:p,virtualEdges:g}})},Qs.prototype.undo=function(e){var t=e.context,n=e.duration,i=t.virtualNodes,r=t.virtualEdges;return Promise.all([i.addClass(oi,n),r.addClass(oi,n)]).then(function(){i.setVisible(!1),r.setVisible(!1)})},Qs.prototype.cleanup=function(e){var t=e.ogma,n=e.context,i=n.virtualEdges,r=n.virtualNodes.filter(function(a){return!a.isVisible()}),o=i.filter(function(a){return!a.isVisible()});return t.removeNodes(r,{virtual:!0}),t.removeEdges(o,{virtual:!0}),Promise.resolve()},Qs);function Qs(e){var t=my.call(this)||this,n=e.selector,i=void 0===n?function(){return!0}:n,r=e.neighborIdFunction,o=void 0===r?function(){return null}:r,a=e.nodeGenerator,s=void 0===a?function(){return{}}:a,l=e.edgeGenerator,u=void 0===l?function(){return{source:null,target:null}}:l;return t._generateIds=function(d){return i(d)&&o(d)},t._nodeGenerator=s,t._edgeGenerator=u,t}var vy,fA=(bt(zu,vy=Au),zu.prototype.run=function(e){for(var t=e.ogma,n=e.duration,i=t.getNodes().filter(this._selector),r=[],o=new Map,a=0;a<i.size;++a)for(var s=i.get(a),l=s.getAdjacentEdges(),u=this._dataFunction(s),d=0;d<l.size;++d){var c=l.get(d),h=c.getSource(),p=c.getTarget();if(h!==p&&void 0!==u){var g=h===s?p:h,m=o.get(g);m||o.set(g,m=[]),m.push(u)}r.push(c)}var b=t.getEdges(r),v=t.getNodes(il(o)),y=ws(o),S=v.getData(),A=new Array(v.size);for(a=0;a<A.length;++a){var C=y[a],O=S[a];for(d=0;d<C.length;++d)O=tr(O,C[d]);A[a]=O}return Promise.all([i.addClass(oi,n),b.addClass(oi,n)]).then(function(){return i.setVisible(!1),b.setVisible(!1),v.setData(A),{hiddenNodes:i,hiddenEdges:b,nodesWithDataChange:v,oldDataList:S}})},zu.prototype.getName=function(){return Ao.NeighborMerging},zu.prototype.undo=function(e){var t=e.duration,n=e.context,i=n.hiddenNodes,r=n.hiddenEdges,o=n.nodesWithDataChange,a=n.oldDataList;return i.setVisible(!0),r.setVisible(!0),i.addClass(oi),r.addClass(oi),Promise.all([i.removeClass(oi,t),r.removeClass(oi,t)]).then(function(){o.setData(a)})},zu);function zu(e){var t=e.selector,n=void 0===t?function(){return!1}:t,i=e.dataFunction,r=void 0===i?function(){}:i,o=vy.call(this)||this;return o._selector=n,o._dataFunction=r,o}function gA(e,t){return e.size===t.size&&0<e.filter(function(n){return t.includes(n)}).size}var yy,_A=(bt(Ks,yy=Au),Ks.prototype.getName=function(){return Ao.NodeCollapsing},Ks.prototype.run=function(e){for(var t=this,n=e.ogma,i=e.duration,r=n.getNodes().filter(this._selector),o=r.getAdjacentEdges(),a=[],s=r.map(function(O){return O.getAdjacentNodes().filter(function(N){return!t._selector(N)})}),l=0;l<r.size;l++)for(var u=l;u<r.size;u++){var d=r.get(l),c=r.get(u);if(0<n.modules.graph.getEdgesBetweenTwoNodes(d,c).size&&(s[l].size||s[u].size)&&!gA(s[l],s[u]))throw Error("addNodeCollapsing: invalid connected nodes ["+d.getId()+"] and ["+c.getId()+"] to be collapsed. The addNodeCollapsing function supports only disconnected nodes.")}for(l=0;l<r.size;++l){var h=r.get(l),p=s[l];for(u=0;u<p.size-1;++u){var g=p.get(u),m=n.modules.graph.getEdgesBetweenTwoNodes(h,g);if(g!==h)for(var b=u+1;b<p.size;++b){var v=p.get(b),y=n.modules.graph.getEdgesBetweenTwoNodes(h,v),S=this._edgeGenerator(h,g,v,m,y);if(S)for(var A=f(S),C=0;C<A.length;++C)a.push(mA(n,A[C],C,h,g,v,m,y))}}}return n.addEdges(a,{virtual:!0}).then(function(O){return O.addClass(oi)}).then(function(O){return Promise.all([O.removeClass(oi,i),r.addClass(oi,i),o.addClass(oi,i)])}).then(function(O){var N=O[0];return r.setVisible(!1),o.setVisible(!1),{virtualEdges:N,hiddenNodes:r,hiddenEdges:o}})},Ks.prototype.undo=function(e){var t=e.duration,n=e.context,i=n.virtualEdges,r=n.hiddenNodes,o=n.hiddenEdges;return r.setVisible(!0),o.setVisible(!0),Promise.all([r.addClass(oi),o.addClass(oi)]).then(function(){return Promise.all([r.removeClass(oi,t),o.removeClass(oi,t),i.addClass(oi,t)])}).then(function(){i.setVisible(!1)})},Ks.prototype.cleanup=function(e){return e.ogma.removeEdges(e.context.virtualEdges.filter(function(i){return!i.isVisible()}),{virtual:!0})},Ks);function Ks(e){var t=e.selector,n=void 0===t?function(){return!1}:t,i=e.edgeGenerator,r=void 0===i?function(){return{}}:i,o=yy.call(this)||this;return o._selector=n,o._edgeGenerator=r,o}function mA(e,t,n,i,r,o,a,s){var l=null,u=null;if(void 0!==t.source&&(l=e.getNode(t.source))!==r&&l!==o)throw new Error(["addNodeCollapsing: edge generator produced RawEdge with invalid source ["+t.source+"]","expected to be ["+r.getId()+"] or ["+o.getId()+"]"].join("; "));if(void 0!==t.target&&(u=e.getNode(t.target))!==r&&u!==o)throw new Error(["addNodeCollapsing: edge generator produced RawEdge with invalid target ["+t.target+"]","expected to be ["+r.getId()+"] or ["+o.getId()+"]"].join("; "));if(l&&u&&l===u)throw new Error("addNodeCollapsing: edge generator produced RawEdge with same source and target ["+l.getId()+"]");if(l&&!u)u=l===r?o:r;else if(u&&!l)l=u===r?o:r;else if(!l&&!u){for(var d=!0,c=0;c<a.size;++c)a.get(c).getSource()===r&&(d=!1);for(c=0;c<s.size;++c)s.get(c).getTarget()===o&&(d=!1);u=d?(l=o,r):(l=r,o)}return Mt({},t,{id:"_gen_"+i.getId()+"_"+l.getId()+"_"+u.getId()+"_"+n,source:l.getId(),target:u.getId()})}var xy,vA=(bt(Bu,xy=Au),Bu.prototype.getName=function(){return Ao.VirtualProperties},Bu.prototype.run=function(e){var t=e.ogma,n={nodes:null,oldNodesData:null,edges:null,oldEdgesData:null};return this._nodeDataFunction&&(n.nodes=t.getNodes().filter(this._nodeSelector),n.oldNodesData=by(n.nodes,this._nodeDataFunction)),this._edgeDataFunction&&(n.edges=t.getEdges().filter(this._edgeSelector),n.oldEdgesData=by(n.edges,this._edgeDataFunction)),Promise.resolve(n)},Bu.prototype.undo=function(e){var t=e.context,n=t.nodes,r=t.edges,o=t.oldEdgesData;return n&&n.setData(t.oldNodesData),r&&r.setData(o),Promise.resolve()},Bu);function Bu(e){var t=e.nodeSelector,n=void 0===t?function(){return!0}:t,i=e.edgeSelector,r=void 0===i?function(){return!0}:i,o=e.nodeDataFunction,a=void 0===o?null:o,s=e.edgeDataFunction,l=void 0===s?null:s,u=xy.call(this)||this;return u._nodeSelector=n,u._edgeSelector=r,u._nodeDataFunction=a,u._edgeDataFunction=l,u}function by(e,t){for(var n=[],i=0;i<e.size;++i){var r=e.get(i),o=r.getData(),a=tr(o,t(r));n.push(o),r.setData(a)}return n}var Ey=(Oa.initNamespace=function(e){e.transformations=function(e){return Mt({},{getList:function(){return a.modules.transformations.getList()},clear:function(){return a.modules.transformations.clear()},afterNextUpdate:function(){return a.modules.transformations.whenApplied()}},{addNodeGrouping:function(s){return void 0===s&&(s={}),o.modules.transformations.add(new cA(s),{duration:s.duration,enabled:s.enabled})},addEdgeGrouping:function(s){return void 0===s&&(s={}),o.modules.transformations.add(new hA(s),{duration:s.duration,enabled:s.enabled})}},{addNodeFilter:function(s){return r.modules.filters.addNodeFilter(s)},addEdgeFilter:function(s){return r.modules.filters.addEdgeFilter(s)}},{addNeighborGeneration:function(s){return i.modules.transformations.add(new pA(s),{duration:s.duration,enabled:s.enabled})},addNeighborMerging:function(s){return i.modules.transformations.add(new fA(s),{duration:s.duration,enabled:s.enabled})}},{addNodeCollapsing:function(s){return void 0===s&&(s={}),n.modules.transformations.add(new _A(s),{duration:s.duration,enabled:s.enabled})}},(t=n=i=r=o=a=e,{addVirtualProperties:function(s){return t.modules.transformations.add(new vA(s),{duration:s.duration,enabled:s.enabled})}}));var t,n,i,r,o,a}(e)},Oa.prototype.addNodeFilter=function(e){return this.modules.filters.addNodeFilter(e)},Oa.prototype.addEdgeFilter=function(e){return this.modules.filters.addEdgeFilter(e)},Oa.prototype.getNodeFilters=function(){return this.modules.transformations.getList().filter(function(e){return e.getName()===Ao.NodeFilter})},Oa.prototype.getEdgeFilters=function(){return this.modules.transformations.getList().filter(function(e){return e.getName()===Ao.EdgeFilter})},Oa.prototype.clearNodeFilters=function(){return Promise.all(this.getNodeFilters().map(function(e){return e.destroy()})).then(function(){return Promise.resolve()})},Oa.prototype.clearEdgeFilters=function(){return Promise.all(this.getEdgeFilters().map(function(e){return e.destroy()})).then(function(){return Promise.resolve()})},Oa);function Oa(){}var Sy=(Ay.initNamespace=function(e){var t,n,i,r,o,a;e.view=(n=(t=e.modules).camera,i=t.captor,r=t.dom,o=t.graphics,a=t.locate,{setZoom:function(s,l){return n.setZoom(s,l)},zoomIn:function(s,l){return n.zoomIn(s,l)},zoomOut:function(s,l){return n.zoomOut(s,l)},getZoom:function(){return n.getZoom()},setCenter:function(s,l){return n.setCenter(s,l)},move:function(s,l){return n.move(s,l)},getCenter:function(){return n.getCenter()},setAngle:function(s,l){return n.setAngle(s,l)},rotate:function(s,l){return n.rotate(s,l)},getAngle:function(){return n.getAngle()},set:function(s,l){return n.setView(s,l)},get:function(){return n.getView()},graphToScreenCoordinates:function(s){return n.graphToScreenCoordinates(s)},screenToGraphCoordinates:function(s){return n.screenToGraphCoordinates(s)},getImageData:function(){return o.getImageData()},getElementAt:function(s){return i.getElementAt(s)},beforeNextFrame:function(){return r.beforeNextFrame()},afterNextFrame:function(){return r.afterNextFrame()},setFullScreen:function(s){return r.setFullScreen(s)},isFullScreen:function(){return r.isFullScreen()},forceResize:function(){return r.forceResize()},getSize:function(){return r.getDimensions()},setSize:function(s){if(!s||isNaN(s.width)||isNaN(s.height))throw new Error("Size must follow the format { width: number, height: number }");if(s.width<0)throw new Error("width must be positive");if(s.height<0)throw new Error("height must be positive");return r.setDimensions(s),Promise.resolve()},locateGraph:function(s){return a.locateGraph(s)},locateRawGraph:function(s,l){return a.locateRawGraph(s,l)},getGraphBoundingBox:function(){return a.getGraphBoundingBox()}})},Ay);function Ay(){}function wy(e){return--e*e*e+1}function Cy(e,t,n){var i=e-n[0],r=t-n[1];return i*i+r*r}var xA=Object.freeze({__proto__:null,circleCircleIntersection:sc,circleSortCompare:uc,circleContainsPoint:Yf,circleContainsCircle:Xf,circleIntersectsBox:lc,circleLineIntersection:Jf,isPointInLine:pf,twoSegmentsIntersect:function(e,t,n,i,r){if(void 0===r&&(r=!1),r&&(fl(e,n)||fl(e,i)||fl(t,n)||fl(t,i)))return!1;var o=(e.y-n.y)*(i.x-n.x)-(e.x-n.x)*(i.y-n.y),a=(t.x-e.x)*(i.y-n.y)-(t.y-e.y)*(i.x-n.x);if(0==a)return!1;var s=o/a,l=(o=(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y))/a;return!(s<=0||1<=s||l<=0||1<=l)},lineAngle:Ms,angle:function(e,t,n){var i=Ms(e.x,e.y,t.x,t.y)-Ms(n.x,n.y,t.x,t.y);return i<0?i+2*Math.PI:i},lineIntersection:function(e,t,n,i,r,o,a,s){var l=(s-o)*(n-e)-(a-r)*(i-t);if(0==l)return null;var u=t-o;return{x:e+(u=((a-r)*u-(s-o)*(e-r))/l)*(n-e),y:t+u*(i-t)}},segmentIntersection:mu,segmentRectangleIntersection:ff,lineLine:Is,lineAABB:Xd,distancePointSegment:gf,distToSegmentSquared:Jd,getClosestPointOnSegment:_f,getClosestPointOnLine:function(e,t,n,i,r,o){var a=r-n,s=o-i,l=((e-n)*a+(t-i)*s)/(a*a+s*s);return{x:n+a*l,y:i+s*l}},defaultAABB:af,rotate:Gd,move:function(e,t,n,i){return void 0===n&&(n=0),void 0===i&&(i={x:0,y:0}),i.x=e.x+n*Math.sin(t),i.y=e.y+n*Math.cos(t),i},distance:vi,squaredDistance:ul,radiansToDegrees:sf,degreesToRadians:function(e){return e*Math.PI/180},extendBounds:function(e,t){return e.minX-=t,e.minY-=t,e.maxX+=t,e.maxY+=t,e.width+=2*t,e.height+=2*t,e},isPointInPolygon:bu,polygonsIntersect:fc,computeCentroid:gc,getPointOnQuadraticCurve:Qd,isPointOnQuadraticCurve:xf,getPointOnBezierCurve:vu,isPointOnBezierCurve:bf,getQuadraticCurveBoundingBox:Kd,getBezierCurveBoundingBox:gl,quadBezierAABB:vf,cubicBezierAABB:yf,getSelfLoopControlPoints:Ya,getQuadraticCurveControlPoint:fa,getAABB:Wl,getOBBPoints:zs,moveAABB:Lc,padBounds:function(e,t){return e.minX-=t,e.minY-=t,e.maxX+=t,e.maxY+=t,e.width+=2*t,e.height+=2*t,e},overlapsAABB:function(e,t){return Go(e[0],e[1],e[2],e[3],t[0],t[1],t[2],t[3])},intersects:T_,overlaps:Go}),bA=Object.freeze({__proto__:null,minHeap:kc,bellmanFord:Kc,dijkstra:Hl,johnson:$c,largestEmptyCircle:Sv,minDisk:xv,removeRadialOverlap:eh,convexhull:rh,circlePack:function(e){var t=e.X,n=e.Y,i=e.R,r=e.center,o=e.maxSteps,a=void 0===o?1e3:o,s=e.padding,l=void 0===s?5:s,u=e.epsilon,d=void 0===u?1e-5:u,c=e.damping,h=void 0===c?2:c,p=e.pinned,g=e.indexes,m=e.onUpdate,b=e.pushSmallerOut,v=void 0===b||b,y=g?g.length:t.length,S=g;if(isFinite(p)||(p=-1),void 0===S){S=new Uint32Array(y);for(var A=0;A<y;A++)S[A]=A}else S=g;if(-1!==p)r=[t[p],n[p]];else if(!r){var C=0,O=0;for(A=0;A<y;A++)C+=t[S[A]],O+=n[S[A]];r=[C/y,O/y]}var N=function(ae,ie){for(var U=1/0,W=-1/0,ce=0;ce<ae.length;ce++){var he=ae[ce],Ee=ie?ie[he]:he;U=Math.min(Ee,U),W=Math.max(Ee,W)}return{min:U,max:W}}(S,i),P=N.min,F=N.max;function L(ae,ie){for(var U=0,W=0;W<y-1;W++)for(var ce=W+1;ce<y;ce++)if(W!==ce){var he=S[W],Ee=S[ce],rt=i[he],wt=i[Ee],Ue=t[Ee]-t[he],Ze=n[Ee]-n[he],Ne=Ue*Ue+Ze*Ze;if(Ne<(Je=rt+wt+l)*Je-ae){var Ge=(Je-Math.sqrt(Ne))*ie,Xe=1/Ne,$e=(ut=Ue*Xe*Ge)*ut+(Gt=Ze*Xe*Ge)*Gt;Ee!==p&&(U+=$e*(nn=rt/P),t[Ee]+=ut*nn,n[Ee]+=Gt*nn),he!==p&&(U+=$e*(nn=wt/P),t[he]-=ut*nn,n[he]-=Gt*nn)}}var we=ae*h*(1-ie),Pe=r[0],je=r[1];for(W=0;W<y;W++)if((he=S[W])!==p){var Je,ut,Gt,nn=(Je=i[he])/F,ln=v?we*nn:we;U+=$e=(ut=(t[he]-Pe)*ln)*ut+(Gt=(n[he]-je)*ln)*Gt,t[he]-=ut,n[he]-=Gt}return U}S.sort(function(ae,ie){return i[ie]*Cy(t[ie],n[ie],r)-i[ae]*Cy(t[ae],n[ae],r)});var B=0,Y=0,X=wy(1/y);for(A=0;A<a&&(B=L(X,wy((A+1)/a)),m&&setTimeout(function(){return m(t,n)}),!(Math.abs(B-Y)<d));A++)Y=B;return{X:t,Y:n}},Quadtree:k_,weightedStress:_v,distanceStress:mv,constrainedStress:th,stressMinimizationStep:nh,stressMinimizationStepGeneral:function(e,t,n,i,r,o,a,s){a=a||0;var l,u=t,d=n;-1===(r=void 0===r?-1:r)&&(a=0);for(var c=0;c<i;c++){for(var h=s[c],p=0,g=0,m=0,b=t[h],v=n[h],y=0;y<i;y++){var S=s[y],A=void 0;if(S!==h){var C=0,O=e[h][S]*o,N=1/(O*O);h!==r&&S!==r||(C=N);var P=(1-a)*N+a*C;if(p+=P,0!=N){var F=t[S],L=n[S],B=b-F,Y=v-L,X=B*B+Y*Y;1e-6<X&&(A=1/Math.sqrt(X)),g+=P*(F+O*(b-F)*A),m+=P*(L+O*(v-L)*A)}}}0!==(l=p)&&(u[h]=g/l,d[h]=m/l)}return{x:u,y:d}},detectCyclesUndirected:function(e,t,n,i){void 0===i&&(i=!1);for(var r,o,a,s,l=new Int32Array(e.length),u={},d=0;d<e.length;d++)l[d]=-1,u[e[d]]=d;for(d=0;d<t.length;d++){var c=u[t[d]],h=u[n[d]];if(i&&c===h)return!0;var p=wu(l,c),g=wu(l,h);if(p===g)return!0;o=g,a=wu(r=l,p),s=wu(r,o),r[a]=s}return!1},detectCyclesDirected:Jg,detectCyclesUndirectedDFS:function(e,t,n){for(var i=e.length,r=new Uint8Array(i),o=new Int32Array(i),a={},s=0;s<i;s++)o[a[e[s]]=s]=-1;var l=wc(e,t,n,a,!0);for(s=0;s<t.length;s++){var u=a[t[s]],d=a[n[s]];l[u]=l[u]||[],l[u].push(d)}for(s=0;s<i;s++)if(!r[s]&&Qg(s,r,-1,o,l,[],e))return!0;return!1},CyclesFinder:Kg}),EA=1,Ty=function(){function e(t){void 0===t&&(t={});var n=this;if(this.node=function(i){return new _o(i,n)},this.edge=function(i){return new ia(i,n)},this.nodeList=function(i){return new or(i||new Uint32Array(0),n)},this.edgeList=function(i){return new vs(i||new Uint32Array(0),n)},this._onReady=[],null==this||this.constructor!==e)return new e(t);this._init(t)}return e.prototype._init=function(t){var n=this;this._initParameters=t,this._debug=!!t.debug,this._token=EA++,this.modules=new pE(this,t),iy.initNamespace(this),vm.initNamespace(this),Pm.initNamespace(this),pv.initNamespace(this),Wm.initNamespace(this),Xv.initNamespace(this),hv.initNamespace(this),Ey.initNamespace(this),sy.initNamespace(this),Sy.initNamespace(this),Qv.initNamespace(this),Em.initNamespace(this),oy.initNamespace(this),ty.initNamespace(this),Xm.initNamespace(this),$v.initNamespace(this),xm.initNamespace(this),this._onReady.forEach(function(i){return i(n)}),this.safelyBindToInstance()},e.prototype.safelyBindToInstance=function(){for(var t=0,n=Object.keys(e.prototype);t<n.length;t++){var i=n[t];"function"==typeof e.prototype[i]&&(this[i]=this[i].bind(this))}},e.prototype.onReady=function(t){this._onReady.push(t)},e.prototype._destroy=function(){if(!this._token)throw new Error('"destroy" called twice on the same instance of Ogma');this._onReady=[],this.modules.destroy(),this.modules=null},e.prototype.destroy=function(){this._destroy()},e.prototype.reset=function(){var t=this._initParameters;this._destroy(),this._init(t)},e.prototype.isDebug=function(){return this._debug},e.libraries=Yn,e.build={version:"2.9.3",commit:"673d5e4",date:"Wed Jan 08 2020 19:06:20 GMT+0100 (Central European Standard Time)"},e.geometry=xA,e.algorithms=bA,e.utils=d0,e}();return Object.assign.apply(Object,[Ty.prototype].concat([vm,fE,gE,xm,_E,Em,Pm,Wm,Xm,$E,eS,hv,pv,Xv,$v,sA,uA,iy,sy,Ey,Sy,Qv,oy,ty].map(function(e){return e.prototype}))),Ty}()}}]);