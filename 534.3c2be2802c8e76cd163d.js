(self.webpackChunketl=self.webpackChunketl||[]).push([[534],{4299:Yr=>{Yr.exports=function(dn,wt,tt,vn){var dr=new Blob(void 0!==vn?[vn,dn]:[dn],{type:tt||"application/octet-stream"});if(void 0!==window.navigator.msSaveBlob)window.navigator.msSaveBlob(dr,wt);else{var Er=window.URL&&window.URL.createObjectURL?window.URL.createObjectURL(dr):window.webkitURL.createObjectURL(dr),Zi=document.createElement("a");Zi.style.display="none",Zi.href=Er,Zi.setAttribute("download",wt),void 0===Zi.download&&Zi.setAttribute("target","_blank"),document.body.appendChild(Zi),Zi.click(),setTimeout(function(){document.body.removeChild(Zi),window.URL.revokeObjectURL(Er)},200)}}},70:()=>{!function(){"use strict";var dn,wt,tt,vn,tr,dr,Er,Zi,cr,To,hr,Mo,Ri,ui="leader-line",lo={top:1,right:2,bottom:3,left:4},Io={straight:1,arc:2,fluid:3,magnet:4,grid:5},Jn="behind",Sr={disc:{elmId:"leader-line-disc",noRotate:!0,bBox:{left:-5,top:-5,width:10,height:10,right:5,bottom:5},widthR:2.5,heightR:2.5,bCircle:5,sideLen:5,backLen:5,overhead:0,outlineBase:1,outlineMax:4},square:{elmId:"leader-line-square",noRotate:!0,bBox:{left:-5,top:-5,width:10,height:10,right:5,bottom:5},widthR:2.5,heightR:2.5,bCircle:5,sideLen:5,backLen:5,overhead:0,outlineBase:1,outlineMax:4},arrow1:{elmId:"leader-line-arrow1",bBox:{left:-8,top:-8,width:16,height:16,right:8,bottom:8},widthR:4,heightR:4,bCircle:8,sideLen:8,backLen:8,overhead:8,outlineBase:2,outlineMax:1.5},arrow2:{elmId:"leader-line-arrow2",bBox:{left:-7,top:-8,width:11,height:16,right:4,bottom:8},widthR:2.75,heightR:4,bCircle:8,sideLen:8,backLen:7,overhead:4,outlineBase:1,outlineMax:1.75},arrow3:{elmId:"leader-line-arrow3",bBox:{left:-4,top:-5,width:12,height:10,right:8,bottom:5},widthR:3,heightR:2.5,bCircle:8,sideLen:5,backLen:4,overhead:8,outlineBase:1,outlineMax:2.5},hand:{elmId:"leader-line-hand",bBox:{left:-3,top:-12,width:40,height:24,right:37,bottom:12},widthR:10,heightR:6,bCircle:37,sideLen:12,backLen:3,overhead:37},crosshair:{elmId:"leader-line-crosshair",noRotate:!0,bBox:{left:-96,top:-96,width:192,height:192,right:96,bottom:96},widthR:48,heightR:48,bCircle:96,sideLen:96,backLen:96,overhead:0}},Ko={behind:Jn,disc:"disc",square:"square",arrow1:"arrow1",arrow2:"arrow2",arrow3:"arrow3",hand:"hand",crosshair:"crosshair"},bi={disc:"disc",square:"square",arrow1:"arrow1",arrow2:"arrow2",arrow3:"arrow3",hand:"hand",crosshair:"crosshair"},Xr=[1,2,3,4],pr="auto",li={x:"left",y:"top",width:"width",height:"height"},Jr=.5522847,Qr=.25*Math.PI,Da=/^\s*(\-?[\d\.]+)\s*(\%)?\s*$/,_t="http://www.w3.org/2000/svg",sn="-ms-scroll-limit"in document.documentElement.style&&"-ms-ime-align"in document.documentElement.style&&!window.navigator.msPointerEnabled,Yt=!sn&&!!document.uniqueID,bn="MozAppearance"in document.documentElement.style,qt=!(sn||bn||!window.chrome||!window.CSS),En=!(sn||Yt||bn||qt||window.chrome||!("WebkitAppearance"in document.documentElement.style)),Ei=Yt||sn?.2:.1,Qn={path:3,lineColor:"coral",lineSize:4,plugSE:[Jn,"arrow1"],plugSizeSE:[1,1],lineOutlineEnabled:!1,lineOutlineColor:"indianred",lineOutlineSize:.25,plugOutlineEnabledSE:[!1,!1],plugOutlineSizeSE:[1,1]},Hi=(hr={}.toString,Ri=(Mo={}.hasOwnProperty.toString).call(Object),function(_){var A,C;return _&&"[object Object]"===hr.call(_)&&(!(A=Object.getPrototypeOf(_))||(C=A.hasOwnProperty("constructor")&&A.constructor)&&"function"==typeof C&&Mo.call(C)===Ri)}),un=Number.isFinite||function(_){return"number"==typeof _&&window.isFinite(_)},$t=function(){var _,A={ease:[.25,.1,.25,1],linear:[0,0,1,1],"ease-in":[.42,0,1,1],"ease-out":[0,0,.58,1],"ease-in-out":[.42,0,.58,1]},C=1e3/60/2,T=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(ee){setTimeout(ee,C)},z=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame||function(ee){clearTimeout(ee)},U=Number.isFinite||function(ee){return"number"==typeof ee&&window.isFinite(ee)},de=[],ne=0;function oe(){var ee=Date.now(),ve=!1;_&&(z.call(window,_),_=null),de.forEach(function(q){var Q,$,ue;if(q.framesStart){if((Q=ee-q.framesStart)>=q.duration&&q.count&&q.loopsLeft<=1)return ue=q.frames[q.lastFrame=q.reverse?0:q.frames.length-1],q.frameCallback(ue.value,!0,ue.timeRatio,ue.outputRatio),void(q.framesStart=null);if(Q>q.duration){if($=Math.floor(Q/q.duration),q.count){if($>=q.loopsLeft)return ue=q.frames[q.lastFrame=q.reverse?0:q.frames.length-1],q.frameCallback(ue.value,!0,ue.timeRatio,ue.outputRatio),void(q.framesStart=null);q.loopsLeft-=$}q.framesStart+=q.duration*$,Q=ee-q.framesStart}q.reverse&&(Q=q.duration-Q),ue=q.frames[q.lastFrame=Math.round(Q/C)],!1!==q.frameCallback(ue.value,!1,ue.timeRatio,ue.outputRatio)?ve=!0:q.framesStart=null}}),ve&&(_=T.call(window,oe))}function G(ee,ve){ee.framesStart=Date.now(),null!=ve&&(ee.framesStart-=ee.duration*(ee.reverse?1-ve:ve)),ee.loopsLeft=ee.count,ee.lastFrame=null,oe()}return{add:function(ee,ve,q,Q,$,ue,ge){var Se,Oe,Ce,fe,ie,le,ae,st,ht,it,H,be,I,ye=++ne;function Pe(R,F){return{value:ee(F),timeRatio:R,outputRatio:F}}if("string"==typeof $&&($=A[$]),ee=ee||function(){},q<C)Oe=[Pe(0,0),Pe(1,1)];else{if(Ce=C/q,Oe=[Pe(0,0)],0===$[0]&&0===$[1]&&1===$[2]&&1===$[3])for(ie=Ce;ie<=1;ie+=Ce)Oe.push(Pe(ie,ie));else for(le=fe=(ie=Ce)/10;le<=1;le+=fe)it=(ht=(st=le)*st)*st,I=3*(H=1-st)*ht,ie<=(ae={x:(be=H*H*3*st)*$[0]+I*$[2]+it,y:be*$[1]+I*$[3]+it}).x&&(Oe.push(Pe(ae.x,ae.y)),ie+=Ce);Oe.push(Pe(1,1))}return de.push(Se={animId:ye,frameCallback:ve,duration:q,count:Q,frames:Oe,reverse:!!ue}),!1!==ge&&G(Se,ge),ye},remove:function(ee){var ve;de.some(function(q,Q){return q.animId===ee&&(ve=Q,!(q.framesStart=null))})&&de.splice(ve,1)},start:function(ee,ve,q){de.some(function(Q){return Q.animId===ee&&(Q.reverse=!!ve,G(Q,q),!0)})},stop:function(ee,ve){var q;return de.some(function(Q){return Q.animId===ee&&(ve?null!=Q.lastFrame&&(q=Q.frames[Q.lastFrame].timeRatio):(q=(Date.now()-Q.framesStart)/Q.duration,Q.reverse&&(q=1-q),q<0?q=0:1<q&&(q=1)),!(Q.framesStart=null))}),q},validTiming:function(ee){return"string"==typeof ee?A[ee]:Array.isArray(ee)&&[0,1,2,3].every(function(ve){return U(ee[ve])&&0<=ee[ve]&&ee[ve]<=1})?[ee[0],ee[1],ee[2],ee[3]]:null}}}(),Ra=function(_){var A={};function C(T){if(A[T])return A[T].exports;var z=A[T]={i:T,l:!1,exports:{}};return _[T].call(z.exports,z,z.exports,C),z.l=!0,z.exports}return C.m=_,C.c=A,C.d=function(T,z,U){C.o(T,z)||Object.defineProperty(T,z,{configurable:!1,enumerable:!0,get:U})},C.r=function(T){Object.defineProperty(T,"__esModule",{value:!0})},C.n=function(T){var z=T&&T.__esModule?function(){return T.default}:function(){return T};return C.d(z,"a",z),z},C.o=function(T,z){return Object.prototype.hasOwnProperty.call(T,z)},C.p="",C(C.s=0)}([function(_,A,C){C.r(A);var z=[],U=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(q){return setTimeout(q,1e3/60)},de=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame||function(q){return clearTimeout(q)},ne=void 0,oe=Date.now();function G(){var q=void 0,Q=void 0;ne&&(de.call(window,ne),ne=null),z.forEach(function($){$.event&&($.listener($.event),$.event=null,q=!0)}),q?(oe=Date.now(),Q=!0):Date.now()-oe<500&&(Q=!0),Q&&(ne=U.call(window,G))}function ee(q){var Q=-1;return z.some(function($,ue){return $.listener===q&&(Q=ue,!0)}),Q}A.default={add:function(q){var Q=void 0;return-1===ee(q)?(z.push(Q={listener:q}),function($){Q.event=$,ne||G()}):null},remove:function(q){var Q;-1<(Q=ee(q))&&(z.splice(Q,1),!z.length&&ne&&(de.call(window,ne),ne=null))}}}]).default,ko={line_altColor:{iniValue:!1},line_color:{},line_colorTra:{iniValue:!1},line_strokeWidth:{},plug_enabled:{iniValue:!1},plug_enabledSE:{hasSE:!0,iniValue:!1},plug_plugSE:{hasSE:!0,iniValue:Jn},plug_colorSE:{hasSE:!0},plug_colorTraSE:{hasSE:!0,iniValue:!1},plug_markerWidthSE:{hasSE:!0},plug_markerHeightSE:{hasSE:!0},lineOutline_enabled:{iniValue:!1},lineOutline_color:{},lineOutline_colorTra:{iniValue:!1},lineOutline_strokeWidth:{},lineOutline_inStrokeWidth:{},plugOutline_enabledSE:{hasSE:!0,iniValue:!1},plugOutline_plugSE:{hasSE:!0,iniValue:Jn},plugOutline_colorSE:{hasSE:!0},plugOutline_colorTraSE:{hasSE:!0,iniValue:!1},plugOutline_strokeWidthSE:{hasSE:!0},plugOutline_inStrokeWidthSE:{hasSE:!0},position_socketXYSE:{hasSE:!0,hasProps:!0},position_plugOverheadSE:{hasSE:!0},position_path:{},position_lineStrokeWidth:{},position_socketGravitySE:{hasSE:!0},path_pathData:{},path_edge:{hasProps:!0},viewBox_bBox:{hasProps:!0},viewBox_plugBCircleSE:{hasSE:!0},lineMask_enabled:{iniValue:!1},lineMask_outlineMode:{iniValue:!1},lineMask_x:{},lineMask_y:{},lineOutlineMask_x:{},lineOutlineMask_y:{},maskBGRect_x:{},maskBGRect_y:{},capsMaskAnchor_enabledSE:{hasSE:!0,iniValue:!1},capsMaskAnchor_pathDataSE:{hasSE:!0},capsMaskAnchor_strokeWidthSE:{hasSE:!0},capsMaskMarker_enabled:{iniValue:!1},capsMaskMarker_enabledSE:{hasSE:!0,iniValue:!1},capsMaskMarker_plugSE:{hasSE:!0,iniValue:Jn},capsMaskMarker_markerWidthSE:{hasSE:!0},capsMaskMarker_markerHeightSE:{hasSE:!0},caps_enabled:{iniValue:!1},attach_plugSideLenSE:{hasSE:!0},attach_plugBackLenSE:{hasSE:!0}},fs={show_on:{},show_effect:{},show_animOptions:{},show_animId:{},show_inAnim:{}},gs="fade",Oo=[],di={},za=0,qn={},Ba=0;function Dr(_,A){var C,T;return typeof _!=typeof A||(C=Hi(_)?"obj":Array.isArray(_)?"array":"")!=(Hi(A)?"obj":Array.isArray(A)?"array":"")||("obj"===C?Dr(T=Object.keys(_).sort(),Object.keys(A).sort())||T.some(function(z){return Dr(_[z],A[z])}):"array"===C?_.length!==A.length||_.some(function(z,U){return Dr(z,A[U])}):_!==A)}function Si(_){return _&&(Hi(_)?Object.keys(_).reduce(function(A,C){return A[C]=Si(_[C]),A},{}):Array.isArray(_)?_.map(Si):_)}function ir(_){var A,C,T,z=1,U=_=(_+"").trim();function de(ne){var oe=1,G=Da.exec(ne);return G&&(oe=parseFloat(G[1]),G[2]?oe=0<=oe&&oe<=100?oe/100:1:(oe<0||1<oe)&&(oe=1)),oe}return(A=/^(rgba|hsla|hwb|gray|device\-cmyk)\s*\(([\s\S]+)\)$/i.exec(_))?(C=A[1].toLowerCase(),T=A[2].trim().split(/\s*,\s*/),"rgba"===C&&4===T.length?(z=de(T[3]),U="rgb("+T.slice(0,3).join(", ")+")"):"hsla"===C&&4===T.length?(z=de(T[3]),U="hsl("+T.slice(0,3).join(", ")+")"):"hwb"===C&&4===T.length?(z=de(T[3]),U="hwb("+T.slice(0,3).join(", ")+")"):"gray"===C&&2===T.length?(z=de(T[1]),U="gray("+T[0]+")"):"device-cmyk"===C&&5<=T.length&&(z=de(T[4]),U="device-cmyk("+T.slice(0,4).join(", ")+")")):(A=/^\#(?:([\da-f]{6})([\da-f]{2})|([\da-f]{3})([\da-f]))$/i.exec(_))?A[1]?(z=parseInt(A[2],16)/255,U="#"+A[1]):(z=parseInt(A[4]+A[4],16)/255,U="#"+A[3]):"transparent"===_.toLocaleLowerCase()&&(z=0),[z,U]}function Wi(_){return!(!_||_.nodeType!==Node.ELEMENT_NODE||"function"!=typeof _.getBoundingClientRect)}function Rr(_,A){var C,T,z,U,de={};if(!(z=_.ownerDocument))return console.error("Cannot get document that contains the element."),null;if(_.compareDocumentPosition(z)&Node.DOCUMENT_POSITION_DISCONNECTED)return console.error("A disconnected element was passed."),null;for(T in C=_.getBoundingClientRect())de[T]=C[T];if(!A){if(!(U=z.defaultView))return console.error("Cannot get window that contains the element."),null;de.left+=U.pageXOffset,de.right+=U.pageXOffset,de.top+=U.pageYOffset,de.bottom+=U.pageYOffset}return de}function ho(_,A){var C,T,z=[],U=_;for(A=A||window;;){if(!(C=U.ownerDocument))return console.error("Cannot get document that contains the element."),null;if(!(T=C.defaultView))return console.error("Cannot get window that contains the element."),null;if(T===A)break;if(!(U=T.frameElement))return console.error("`baseWindow` was not found."),null;z.unshift(U)}return z}function No(_,A){var C,T,z=0,U=0;return(T=ho(_,A=A||window))?T.length?(T.forEach(function(de,ne){var oe,G,ee=Rr(de,0<ne);z+=ee.left,U+=ee.top,G=(oe=de).ownerDocument.defaultView.getComputedStyle(oe,""),ee={left:oe.clientLeft+parseFloat(G.paddingLeft),top:oe.clientTop+parseFloat(G.paddingTop)},z+=ee.left,U+=ee.top}),(C=Rr(_,!0)).left+=z,C.right+=z,C.top+=U,C.bottom+=U,C):Rr(_):null}function Kn(_,A){var C=_.x-A.x,T=_.y-A.y;return Math.sqrt(C*C+T*T)}function Lo(_,A,C){var T=A.x-_.x,z=A.y-_.y;return{x:_.x+T*C,y:_.y+z*C,angle:Math.atan2(z,T)/(Math.PI/180)}}function Yi(_,A,C){var T=Math.atan2(_.y-A.y,A.x-_.x);return{x:A.x+Math.cos(T)*C,y:A.y+Math.sin(T)*C*-1}}function Bi(_,A,C,T,z){var U=z*z,de=U*z,ne=1-z,oe=ne*ne,G=oe*ne,ee=G*_.x+3*oe*z*A.x+3*ne*U*C.x+de*T.x,ve=G*_.y+3*oe*z*A.y+3*ne*U*C.y+de*T.y,q=_.x+2*z*(A.x-_.x)+U*(C.x-2*A.x+_.x),Q=_.y+2*z*(A.y-_.y)+U*(C.y-2*A.y+_.y),$=A.x+2*z*(C.x-A.x)+U*(T.x-2*C.x+A.x),ue=A.y+2*z*(C.y-A.y)+U*(T.y-2*C.y+A.y),ge=ne*_.x+z*A.x,Se=ne*_.y+z*A.y,Oe=ne*C.x+z*T.x,Ce=ne*C.y+z*T.y,fe=90-180*Math.atan2(q-$,Q-ue)/Math.PI;return{x:ee,y:ve,fromP2:{x:q,y:Q},toP1:{x:$,y:ue},fromP1:{x:ge,y:Se},toP2:{x:Oe,y:Ce},angle:fe+=180<fe?-180:180}}function po(_,A,C,T,z){function U(Q,$,ue,ge,Se){return Q*(Q*(-3*$+9*ue-9*ge+3*Se)+6*$-12*ue+6*ge)-3*$+3*ue}var de,ne,oe,G,ve=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],q=0;return de=(z=null==z||1<z?1:z<0?0:z)/2,[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816].forEach(function(Q,$){oe=U(ne=de*Q+de,_.x,A.x,C.x,T.x),G=U(ne,_.y,A.y,C.y,T.y),q+=ve[$]*Math.sqrt(oe*oe+G*G)}),de*q}function Vi(_,A,C,T,z){for(var U,de=.5,ne=1-de;U=po(_,A,C,T,ne),!(Math.abs(U-z)<=.01);)ne+=(U<z?1:-1)*(de/=2);return ne}function _i(_,A){var C;return _.forEach(function(T){var z=A?T.map(function(U){var de={x:U.x,y:U.y};return A(de),de}):T;C||(C=[{type:"M",values:[z[0].x,z[0].y]}]),C.push(z.length?2===z.length?{type:"L",values:[z[1].x,z[1].y]}:{type:"C",values:[z[1].x,z[1].y,z[2].x,z[2].y,z[3].x,z[3].y]}:{type:"Z",values:[]})}),C}function $o(_){var A=[],C=0;return _.forEach(function(T){var z=(2===T.length?Kn:po).apply(null,T);A.push(z),C+=z}),{segsLen:A,lenAll:C}}function Ln(_,A){return null==_||null==A||_.length!==A.length||_.some(function(C,T){var z=A[T];return C.type!==z.type||C.values.some(function(U,de){return U!==z.values[de]})})}function Hn(_,A,C){_.events[A]?_.events[A].indexOf(C)<0&&_.events[A].push(C):_.events[A]=[C]}function Wn(_,A,C){var T;_.events[A]&&-1<(T=_.events[A].indexOf(C))&&_.events[A].splice(T,1)}function gr(_){Er&&clearTimeout(Er),Oo.push(_),Er=setTimeout(function(){Oo.forEach(function(A){A()}),Oo=[]},0)}function cn(_,A){_.reflowTargets.indexOf(A)<0&&_.reflowTargets.push(A)}function Fo(_){_.reflowTargets.forEach(function(A){var C;C=A,setTimeout(function(){var T=C.parentNode,z=C.nextSibling;T.insertBefore(T.removeChild(C),z)},0)}),_.reflowTargets=[]}function ea(_,A,C,T,z,U,de){var ne,oe,G;"auto-start-reverse"===C?("boolean"!=typeof Zi&&(A.setAttribute("orient","auto-start-reverse"),Zi=A.orientType.baseVal===SVGMarkerElement.SVG_MARKER_ORIENT_UNKNOWN),Zi?A.setAttribute("orient",C):((ne=z.createSVGTransform()).setRotate(180,0,0),U.transform.baseVal.appendItem(ne),A.setAttribute("orient","auto"),G=!0)):(A.setAttribute("orient",C),!1===Zi&&U.transform.baseVal.clear()),oe=A.viewBox.baseVal,G?(oe.x=-T.right,oe.y=-T.bottom):(oe.x=T.left,oe.y=T.top),oe.width=T.width,oe.height=T.height,Yt&&cn(_,de)}function ta(_,A){return{prop:_?"markerEnd":"markerStart",orient:A?A.noRotate?"0":_?"auto":"auto-start-reverse":null}}function kn(_,A){Object.keys(A).forEach(function(C){var T=A[C];_[C]=null!=T.iniValue?T.hasSE?[T.iniValue,T.iniValue]:T.iniValue:T.hasSE?T.hasProps?[{},{}]:[]:T.hasProps?{}:null})}function lt(_,A,C,T,z){return T!==A[C]&&(A[C]=T,z&&z.forEach(function(U){U(_,T,C)}),!0)}function fn(_){function A(de,ne){return de+parseFloat(ne)}var C=_.document,T=_.getComputedStyle(C.documentElement,""),z=_.getComputedStyle(C.body,""),U={x:0,y:0};return"static"!==z.position?(U.x-=[T.marginLeft,T.borderLeftWidth,T.paddingLeft,z.marginLeft,z.borderLeftWidth].reduce(A,0),U.y-=[T.marginTop,T.borderTopWidth,T.paddingTop,z.marginTop,z.borderTopWidth].reduce(A,0)):"static"!==T.position&&(U.x-=[T.marginLeft,T.borderLeftWidth].reduce(A,0),U.y-=[T.marginTop,T.borderTopWidth].reduce(A,0)),U}function Ti(_){var A,C=_.document;C.getElementById("leader-line-defs")||(A=(new _.DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg" version="1.1" id="leader-line-defs"><style><![CDATA[.leader-line{position:absolute;overflow:visible!important;pointer-events:none!important;font-size:16px}#leader-line-defs{width:0;height:0;position:absolute;left:0;top:0}.leader-line-line-path{fill:none}.leader-line-mask-bg-rect{fill:#fff}.leader-line-caps-mask-anchor,.leader-line-caps-mask-marker-shape{fill:#000}.leader-line-caps-mask-anchor{stroke:#000}.leader-line-caps-mask-line,.leader-line-plugs-face{stroke:transparent}.leader-line-line-mask-shape{stroke:#fff}.leader-line-line-outline-mask-shape{stroke:#000}.leader-line-plug-mask-shape{fill:#fff;stroke:#000}.leader-line-plug-outline-mask-shape{fill:#000;stroke:#fff}.leader-line-areaAnchor{position:absolute;overflow:visible!important}]]></style><defs><circle id="leader-line-disc" cx="0" cy="0" r="5"/><rect id="leader-line-square" x="-5" y="-5" width="10" height="10"/><polygon id="leader-line-arrow1" points="-8,-8 8,0 -8,8 -5,0"/><polygon id="leader-line-arrow2" points="-4,-8 4,0 -4,8 -7,5 -2,0 -7,-5"/><polygon id="leader-line-arrow3" points="-4,-5 8,0 -4,5"/><g id="leader-line-hand"><path style="fill: #fcfcfc" d="M9.19 11.14h4.75c1.38 0 2.49-1.11 2.49-2.49 0-.51-.15-.98-.41-1.37h1.3c1.38 0 2.49-1.11 2.49-2.49s-1.11-2.53-2.49-2.53h1.02c1.38 0 2.49-1.11 2.49-2.49s-1.11-2.49-2.49-2.49h14.96c1.37 0 2.49-1.11 2.49-2.49s-1.11-2.49-2.49-2.49H16.58C16-9.86 14.28-11.14 9.7-11.14c-4.79 0-6.55 3.42-7.87 4.73H-2.14v13.23h3.68C3.29 9.97 5.47 11.14 9.19 11.14L9.19 11.14Z"/><path style="fill: black" d="M13.95 12c1.85 0 3.35-1.5 3.35-3.35 0-.17-.02-.34-.04-.51h.07c1.85 0 3.35-1.5 3.35-3.35 0-.79-.27-1.51-.72-2.08 1.03-.57 1.74-1.67 1.74-2.93 0-.59-.16-1.15-.43-1.63h12.04c1.85 0 3.35-1.5 3.35-3.35 0-1.85-1.5-3.35-3.35-3.35H17.2C16.26-10.93 13.91-12 9.7-12 5.36-12 3.22-9.4 1.94-7.84c0 0-.29.33-.5.57-.63 0-3.58 0-3.58 0C-2.61-7.27-3-6.88-3-6.41v13.23c0 .47.39.86.86.86 0 0 2.48 0 3.2 0C2.9 10.73 5.29 12 9.19 12L13.95 12ZM9.19 10.28c-3.46 0-5.33-1.05-6.9-3.87-.15-.27-.44-.44-.75-.44 0 0-1.81 0-2.82 0V-5.55c1.06 0 3.11 0 3.11 0 .25 0 .44-.06.61-.25l.83-.95c1.23-1.49 2.91-3.53 6.43-3.53 3.45 0 4.9.74 5.57 1.72h-4.3c-.48 0-.86.38-.86.86s.39.86.86.86h22.34c.9 0 1.63.73 1.63 1.63 0 .9-.73 1.63-1.63 1.63H15.83c-.48 0-.86.38-.86.86 0 .47.39.86.86.86h2.52c.9 0 1.63.73 1.63 1.63s-.73 1.63-1.63 1.63h-3.12c-.48 0-.86.38-.86.86 0 .47.39.86.86.86h2.11c.88 0 1.63.76 1.63 1.67 0 .9-.73 1.63-1.63 1.63h-3.2c-.48 0-.86.39-.86.86 0 .47.39.86.86.86h1.36c.05.16.09.34.09.51 0 .9-.73 1.63-1.63 1.63C13.95 10.28 9.19 10.28 9.19 10.28Z"/></g><g id="leader-line-crosshair"><path d="M0-78.97c-43.54 0-78.97 35.43-78.97 78.97 0 43.54 35.43 78.97 78.97 78.97s78.97-35.43 78.97-78.97C78.97-43.54 43.55-78.97 0-78.97ZM76.51-1.21h-9.91v-9.11h-2.43v9.11h-11.45c-.64-28.12-23.38-50.86-51.5-51.5V-64.17h9.11V-66.6h-9.11v-9.91C42.46-75.86 75.86-42.45 76.51-1.21ZM-1.21-30.76h-9.11v2.43h9.11V-4.2c-1.44.42-2.57 1.54-2.98 2.98H-28.33v-9.11h-2.43v9.11H-50.29C-49.65-28-27.99-49.65-1.21-50.29V-30.76ZM-30.76 1.21v9.11h2.43v-9.11H-4.2c.42 1.44 1.54 2.57 2.98 2.98v24.13h-9.11v2.43h9.11v19.53C-27.99 49.65-49.65 28-50.29 1.21H-30.76ZM1.22 30.75h9.11v-2.43h-9.11V4.2c1.44-.42 2.56-1.54 2.98-2.98h24.13v9.11h2.43v-9.11h19.53C49.65 28 28 49.65 1.22 50.29V30.75ZM30.76-1.21v-9.11h-2.43v9.11H4.2c-.42-1.44-1.54-2.56-2.98-2.98V-28.33h9.11v-2.43h-9.11V-50.29C28-49.65 49.65-28 50.29-1.21H30.76ZM-1.21-76.51v9.91h-9.11v2.43h9.11v11.45c-28.12.64-50.86 23.38-51.5 51.5H-64.17v-9.11H-66.6v9.11h-9.91C-75.86-42.45-42.45-75.86-1.21-76.51ZM-76.51 1.21h9.91v9.11h2.43v-9.11h11.45c.64 28.12 23.38 50.86 51.5 51.5v11.45h-9.11v2.43h9.11v9.91C-42.45 75.86-75.86 42.45-76.51 1.21ZM1.22 76.51v-9.91h9.11v-2.43h-9.11v-11.45c28.12-.64 50.86-23.38 51.5-51.5h11.45v9.11h2.43v-9.11h9.91C75.86 42.45 42.45 75.86 1.22 76.51Z"/><path d="M0 83.58-7.1 96 7.1 96Z"/><path d="M0-83.58 7.1-96-7.1-96"/><path d="M83.58 0 96 7.1 96-7.1Z"/><path d="M-83.58 0-96-7.1-96 7.1Z"/></g></defs></svg>',"image/svg+xml"),C.body.appendChild(A.documentElement),function(_){_.SVGPathElement.prototype.getPathData&&_.SVGPathElement.prototype.setPathData||function(){var A={Z:"Z",M:"M",L:"L",C:"C",Q:"Q",A:"A",H:"H",V:"V",S:"S",T:"T",z:"Z",m:"m",l:"l",c:"c",q:"q",a:"a",h:"h",v:"v",s:"s",t:"t"},C=function(q){this._string=q,this._currentIndex=0,this._endIndex=this._string.length,this._prevCommand=null,this._skipOptionalSpaces()},T=-1!==_.navigator.userAgent.indexOf("MSIE ");C.prototype={parseSegment:function(){var q=this._string[this._currentIndex],Q=A[q]?A[q]:null;if(null===Q){if(null===this._prevCommand||null===(Q=("+"===q||"-"===q||"."===q||"0"<=q&&q<="9")&&"Z"!==this._prevCommand?"M"===this._prevCommand?"L":"m"===this._prevCommand?"l":this._prevCommand:null))return null}else this._currentIndex+=1;var $=null,ue=(this._prevCommand=Q).toUpperCase();return"H"===ue||"V"===ue?$=[this._parseNumber()]:"M"===ue||"L"===ue||"T"===ue?$=[this._parseNumber(),this._parseNumber()]:"S"===ue||"Q"===ue?$=[this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber()]:"C"===ue?$=[this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber()]:"A"===ue?$=[this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseArcFlag(),this._parseArcFlag(),this._parseNumber(),this._parseNumber()]:"Z"===ue&&(this._skipOptionalSpaces(),$=[]),null===$||0<=$.indexOf(null)?null:{type:Q,values:$}},hasMoreData:function(){return this._currentIndex<this._endIndex},peekSegmentType:function(){var q=this._string[this._currentIndex];return A[q]?A[q]:null},initialCommandIsMoveTo:function(){if(!this.hasMoreData())return!0;var q=this.peekSegmentType();return"M"===q||"m"===q},_isCurrentSpace:function(){var q=this._string[this._currentIndex];return q<=" "&&(" "===q||"\n"===q||"\t"===q||"\r"===q||"\f"===q)},_skipOptionalSpaces:function(){for(;this._currentIndex<this._endIndex&&this._isCurrentSpace();)this._currentIndex+=1;return this._currentIndex<this._endIndex},_skipOptionalSpacesOrDelimiter:function(){return!(this._currentIndex<this._endIndex&&!this._isCurrentSpace()&&","!==this._string[this._currentIndex])&&(this._skipOptionalSpaces()&&this._currentIndex<this._endIndex&&","===this._string[this._currentIndex]&&(this._currentIndex+=1,this._skipOptionalSpaces()),this._currentIndex<this._endIndex)},_parseNumber:function(){var q=0,Q=0,$=1,ue=0,ge=1,Se=1,Oe=this._currentIndex;if(this._skipOptionalSpaces(),this._currentIndex<this._endIndex&&"+"===this._string[this._currentIndex]?this._currentIndex+=1:this._currentIndex<this._endIndex&&"-"===this._string[this._currentIndex]&&(this._currentIndex+=1,ge=-1),this._currentIndex===this._endIndex||(this._string[this._currentIndex]<"0"||"9"<this._string[this._currentIndex])&&"."!==this._string[this._currentIndex])return null;for(var Ce=this._currentIndex;this._currentIndex<this._endIndex&&"0"<=this._string[this._currentIndex]&&this._string[this._currentIndex]<="9";)this._currentIndex+=1;if(this._currentIndex!==Ce)for(var fe=this._currentIndex-1,ie=1;Ce<=fe;)Q+=ie*(this._string[fe]-"0"),fe-=1,ie*=10;if(this._currentIndex<this._endIndex&&"."===this._string[this._currentIndex]){if(this._currentIndex+=1,this._currentIndex>=this._endIndex||this._string[this._currentIndex]<"0"||"9"<this._string[this._currentIndex])return null;for(;this._currentIndex<this._endIndex&&"0"<=this._string[this._currentIndex]&&this._string[this._currentIndex]<="9";)$*=10,ue+=(this._string.charAt(this._currentIndex)-"0")/$,this._currentIndex+=1}if(this._currentIndex!==Oe&&this._currentIndex+1<this._endIndex&&("e"===this._string[this._currentIndex]||"E"===this._string[this._currentIndex])&&"x"!==this._string[this._currentIndex+1]&&"m"!==this._string[this._currentIndex+1]){if(this._currentIndex+=1,"+"===this._string[this._currentIndex]?this._currentIndex+=1:"-"===this._string[this._currentIndex]&&(this._currentIndex+=1,Se=-1),this._currentIndex>=this._endIndex||this._string[this._currentIndex]<"0"||"9"<this._string[this._currentIndex])return null;for(;this._currentIndex<this._endIndex&&"0"<=this._string[this._currentIndex]&&this._string[this._currentIndex]<="9";)q*=10,q+=this._string[this._currentIndex]-"0",this._currentIndex+=1}var le=Q+ue;return le*=ge,q&&(le*=Math.pow(10,Se*q)),Oe===this._currentIndex?null:(this._skipOptionalSpacesOrDelimiter(),le)},_parseArcFlag:function(){if(this._currentIndex>=this._endIndex)return null;var q=null,Q=this._string[this._currentIndex];if(this._currentIndex+=1,"0"===Q)q=0;else{if("1"!==Q)return null;q=1}return this._skipOptionalSpacesOrDelimiter(),q}};var z=function(q){if(!q||0===q.length)return[];var Q=new C(q),$=[];if(Q.initialCommandIsMoveTo())for(;Q.hasMoreData();){var ue=Q.parseSegment();if(null===ue)break;$.push(ue)}return $},U=_.SVGPathElement.prototype.setAttribute,de=_.SVGPathElement.prototype.removeAttribute,ne=_.Symbol?_.Symbol():"__cachedPathData",oe=_.Symbol?_.Symbol():"__cachedNormalizedPathData",G=function(q,Q,$,ue,ge,Se,Oe,Ce,fe,ie){var ae,st,ht,it,H=function(kt,rn,_n){return{x:kt*Math.cos(_n)-rn*Math.sin(_n),y:kt*Math.sin(_n)+rn*Math.cos(_n)}},be=Math.PI*Oe/180,I=[];if(ie)ae=ie[0],st=ie[1],ht=ie[2],it=ie[3];else{var ye=H(q,Q,-be);q=ye.x,Q=ye.y;var Pe=H($,ue,-be),R=(q-($=Pe.x))/2,F=(Q-(ue=Pe.y))/2,E=R*R/(ge*ge)+F*F/(Se*Se);1<E&&(ge*=E=Math.sqrt(E),Se*=E);var k=ge*ge,O=Se*Se,Rt=(Ce===fe?-1:1)*Math.sqrt(Math.abs((k*O-k*F*F-O*R*R)/(k*F*F+O*R*R)));ht=Rt*ge*F/Se+(q+$)/2,it=Rt*-Se*R/ge+(Q+ue)/2,ae=Math.asin(parseFloat(((Q-it)/Se).toFixed(9))),st=Math.asin(parseFloat(((ue-it)/Se).toFixed(9))),q<ht&&(ae=Math.PI-ae),$<ht&&(st=Math.PI-st),ae<0&&(ae=2*Math.PI+ae),st<0&&(st=2*Math.PI+st),fe&&st<ae&&(ae-=2*Math.PI),!fe&&ae<st&&(st-=2*Math.PI)}var Xt=st-ae;if(Math.abs(Xt)>120*Math.PI/180){var Bn=st,Ro=$,zt=ue;st=fe&&ae<st?ae+120*Math.PI/180*1:ae+120*Math.PI/180*-1,$=ht+ge*Math.cos(st),ue=it+Se*Math.sin(st),I=G($,ue,Ro,zt,ge,Se,Oe,0,fe,[st,Bn,ht,it])}Xt=st-ae;var mt=Math.cos(ae),pt=Math.sin(ae),Gt=Math.cos(st),gt=Math.sin(st),Jt=Math.tan(Xt/4),Fn=4/3*ge*Jt,Vt=4/3*Se*Jt,Xi=[q,Q],Ui=[q+Fn*pt,Q-Vt*mt],Ni=[$+Fn*gt,ue-Vt*Gt],Sn=[$,ue];if(Ui[0]=2*Xi[0]-Ui[0],Ui[1]=2*Xi[1]-Ui[1],ie)return[Ui,Ni,Sn].concat(I);I=[Ui,Ni,Sn].concat(I).join().split(",");var me=[],Lt=[];return I.forEach(function(kt,rn){Lt.push(rn%2?H(I[rn-1],I[rn],be).y:H(I[rn],I[rn+1],be).x),6===Lt.length&&(me.push(Lt),Lt=[])}),me},ee=function(q){return q.map(function(Q){return{type:Q.type,values:Array.prototype.slice.call(Q.values)}})},ve=function(q){var Q=[],$=null,ue=null,ge=null,Se=null,Oe=null,Ce=null,fe=null;return q.forEach(function(ie){if("M"===ie.type){var le=ie.values[0],ae=ie.values[1];Q.push({type:"M",values:[le,ae]}),Se=Ce=le,Oe=fe=ae}else if("C"===ie.type){var st=ie.values[0],ht=ie.values[1],it=ie.values[2],H=ie.values[3];Q.push({type:"C",values:[st,ht,it,H,le=ie.values[4],ae=ie.values[5]]}),ue=it,ge=H,Se=le,Oe=ae}else if("L"===ie.type)Q.push({type:"L",values:[le=ie.values[0],ae=ie.values[1]]}),Se=le,Oe=ae;else if("H"===ie.type)Q.push({type:"L",values:[le=ie.values[0],Oe]}),Se=le;else if("V"===ie.type)Q.push({type:"L",values:[Se,ae=ie.values[0]]}),Oe=ae;else if("S"===ie.type)"C"===$||"S"===$?(be=Se+(Se-ue),I=Oe+(Oe-ge)):(be=Se,I=Oe),Q.push({type:"C",values:[be,I,it=ie.values[0],H=ie.values[1],le=ie.values[2],ae=ie.values[3]]}),ue=it,ge=H,Se=le,Oe=ae;else if("T"===ie.type){"Q"===$||"T"===$?(st=Se+(Se-ue),ht=Oe+(Oe-ge)):(st=Se,ht=Oe);var be=Se+2*(st-Se)/3,I=Oe+2*(ht-Oe)/3,ye=(le=ie.values[0])+2*(st-le)/3,Pe=(ae=ie.values[1])+2*(ht-ae)/3;Q.push({type:"C",values:[be,I,ye,Pe,le,ae]}),ue=st,ge=ht,Se=le,Oe=ae}else if("Q"===ie.type)Q.push({type:"C",values:[be=Se+2*((st=ie.values[0])-Se)/3,I=Oe+2*((ht=ie.values[1])-Oe)/3,ye=(le=ie.values[2])+2*(st-le)/3,Pe=(ae=ie.values[3])+2*(ht-ae)/3,le,ae]}),ue=st,ge=ht,Se=le,Oe=ae;else if("A"===ie.type){var R=ie.values[0],F=ie.values[1],E=ie.values[2],k=ie.values[3],O=ie.values[4];le=ie.values[5],ae=ie.values[6],0===R||0===F?(Q.push({type:"C",values:[Se,Oe,le,ae,le,ae]}),Se=le,Oe=ae):(Se!==le||Oe!==ae)&&G(Se,Oe,le,ae,R,F,E,k,O).forEach(function(te){Q.push({type:"C",values:te}),Se=le,Oe=ae})}else"Z"===ie.type&&(Q.push(ie),Se=Ce,Oe=fe);$=ie.type}),Q};_.SVGPathElement.prototype.setAttribute=function(q,Q){"d"===q&&(this[ne]=null,this[oe]=null),U.call(this,q,Q)},_.SVGPathElement.prototype.removeAttribute=function(q,Q){"d"===q&&(this[ne]=null,this[oe]=null),de.call(this,q)},_.SVGPathElement.prototype.getPathData=function(q){if(q&&q.normalize){if(this[oe])return ee(this[oe]);this[ne]?Ce=ee(this[ne]):(Ce=z(this.getAttribute("d")||""),this[ne]=ee(Ce));var Q=ve(($=[],Oe=Se=ge=ue=null,Ce.forEach(function(fe){var ie=fe.type;if("M"===ie){var le=fe.values[0],ae=fe.values[1];$.push({type:"M",values:[le,ae]}),ue=Se=le,ge=Oe=ae}else if("m"===ie)$.push({type:"M",values:[le=ue+fe.values[0],ae=ge+fe.values[1]]}),ue=Se=le,ge=Oe=ae;else if("L"===ie)$.push({type:"L",values:[le=fe.values[0],ae=fe.values[1]]}),ue=le,ge=ae;else if("l"===ie)$.push({type:"L",values:[le=ue+fe.values[0],ae=ge+fe.values[1]]}),ue=le,ge=ae;else if("C"===ie){var st=fe.values[0],ht=fe.values[1],it=fe.values[2],H=fe.values[3];$.push({type:"C",values:[st,ht,it,H,le=fe.values[4],ae=fe.values[5]]}),ue=le,ge=ae}else"c"===ie?($.push({type:"C",values:[st=ue+fe.values[0],ht=ge+fe.values[1],it=ue+fe.values[2],H=ge+fe.values[3],le=ue+fe.values[4],ae=ge+fe.values[5]]}),ue=le,ge=ae):"Q"===ie?($.push({type:"Q",values:[st=fe.values[0],ht=fe.values[1],le=fe.values[2],ae=fe.values[3]]}),ue=le,ge=ae):"q"===ie?($.push({type:"Q",values:[st=ue+fe.values[0],ht=ge+fe.values[1],le=ue+fe.values[2],ae=ge+fe.values[3]]}),ue=le,ge=ae):"A"===ie?($.push({type:"A",values:[fe.values[0],fe.values[1],fe.values[2],fe.values[3],fe.values[4],le=fe.values[5],ae=fe.values[6]]}),ue=le,ge=ae):"a"===ie?($.push({type:"A",values:[fe.values[0],fe.values[1],fe.values[2],fe.values[3],fe.values[4],le=ue+fe.values[5],ae=ge+fe.values[6]]}),ue=le,ge=ae):"H"===ie?($.push({type:"H",values:[le=fe.values[0]]}),ue=le):"h"===ie?($.push({type:"H",values:[le=ue+fe.values[0]]}),ue=le):"V"===ie?($.push({type:"V",values:[ae=fe.values[0]]}),ge=ae):"v"===ie?($.push({type:"V",values:[ae=ge+fe.values[0]]}),ge=ae):"S"===ie?($.push({type:"S",values:[it=fe.values[0],H=fe.values[1],le=fe.values[2],ae=fe.values[3]]}),ue=le,ge=ae):"s"===ie?($.push({type:"S",values:[it=ue+fe.values[0],H=ge+fe.values[1],le=ue+fe.values[2],ae=ge+fe.values[3]]}),ue=le,ge=ae):"T"===ie?($.push({type:"T",values:[le=fe.values[0],ae=fe.values[1]]}),ue=le,ge=ae):"t"===ie?($.push({type:"T",values:[le=ue+fe.values[0],ae=ge+fe.values[1]]}),ue=le,ge=ae):"Z"!==ie&&"z"!==ie||($.push({type:"Z",values:[]}),ue=Se,ge=Oe)}),$));return this[oe]=ee(Q),Q}if(this[ne])return ee(this[ne]);var $,ue,ge,Se,Oe,Ce=z(this.getAttribute("d")||"");return this[ne]=ee(Ce),Ce},_.SVGPathElement.prototype.setPathData=function(q){if(0===q.length)T?this.setAttribute("d",""):this.removeAttribute("d");else{for(var Q="",$=0,ue=q.length;$<ue;$+=1){var ge=q[$];0<$&&(Q+=" "),Q+=ge.type,ge.values&&0<ge.values.length&&(Q+=" "+ge.values.join(" "))}this.setAttribute("d",Q)}},_.SVGRectElement.prototype.getPathData=function(q){var Q=this.x.baseVal.value,$=this.y.baseVal.value,ue=this.width.baseVal.value,ge=this.height.baseVal.value,Se=this.hasAttribute("rx")?this.rx.baseVal.value:this.ry.baseVal.value,Oe=this.hasAttribute("ry")?this.ry.baseVal.value:this.rx.baseVal.value;ue/2<Se&&(Se=ue/2),ge/2<Oe&&(Oe=ge/2);var Ce=[{type:"M",values:[Q+Se,$]},{type:"H",values:[Q+ue-Se]},{type:"A",values:[Se,Oe,0,0,1,Q+ue,$+Oe]},{type:"V",values:[$+ge-Oe]},{type:"A",values:[Se,Oe,0,0,1,Q+ue-Se,$+ge]},{type:"H",values:[Q+Se]},{type:"A",values:[Se,Oe,0,0,1,Q,$+ge-Oe]},{type:"V",values:[$+Oe]},{type:"A",values:[Se,Oe,0,0,1,Q+Se,$]},{type:"Z",values:[]}];return Ce=Ce.filter(function(fe){return"A"!==fe.type||0!==fe.values[0]&&0!==fe.values[1]}),q&&!0===q.normalize&&(Ce=ve(Ce)),Ce},_.SVGCircleElement.prototype.getPathData=function(q){var Q=this.cx.baseVal.value,$=this.cy.baseVal.value,ue=this.r.baseVal.value,ge=[{type:"M",values:[Q+ue,$]},{type:"A",values:[ue,ue,0,0,1,Q,$+ue]},{type:"A",values:[ue,ue,0,0,1,Q-ue,$]},{type:"A",values:[ue,ue,0,0,1,Q,$-ue]},{type:"A",values:[ue,ue,0,0,1,Q+ue,$]},{type:"Z",values:[]}];return q&&!0===q.normalize&&(ge=ve(ge)),ge},_.SVGEllipseElement.prototype.getPathData=function(q){var Q=this.cx.baseVal.value,$=this.cy.baseVal.value,ue=this.rx.baseVal.value,ge=this.ry.baseVal.value,Se=[{type:"M",values:[Q+ue,$]},{type:"A",values:[ue,ge,0,0,1,Q,$+ge]},{type:"A",values:[ue,ge,0,0,1,Q-ue,$]},{type:"A",values:[ue,ge,0,0,1,Q,$-ge]},{type:"A",values:[ue,ge,0,0,1,Q+ue,$]},{type:"Z",values:[]}];return q&&!0===q.normalize&&(Se=ve(Se)),Se},_.SVGLineElement.prototype.getPathData=function(){return[{type:"M",values:[this.x1.baseVal.value,this.y1.baseVal.value]},{type:"L",values:[this.x2.baseVal.value,this.y2.baseVal.value]}]},_.SVGPolylineElement.prototype.getPathData=function(){for(var q=[],Q=0;Q<this.points.numberOfItems;Q+=1){var $=this.points.getItem(Q);q.push({type:0===Q?"M":"L",values:[$.x,$.y]})}return q},_.SVGPolygonElement.prototype.getPathData=function(){for(var q=[],Q=0;Q<this.points.numberOfItems;Q+=1){var $=this.points.getItem(Q);q.push({type:0===Q?"M":"L",values:[$.x,$.y]})}return q.push({type:"Z",values:[]}),q}}()}(_))}function Kr(_,A){A!==_.isShown&&(!!A!=!!_.isShown&&(_.svg.style.visibility=A?"":"hidden"),_.isShown=A,_.events&&_.events.svgShow&&_.events.svgShow.forEach(function(C){C(_,A)}))}function mi(_,A){var C,T,z,U,de,ne,oe,G,ee,ve,q,Q,$,ue,ge,Se,Oe,Ce,fe,ie,le,ae,st,ht,it,H,be,I,ye,Pe,R,F,E,k,O,te,Rt,Xt,Bn,Ro,zt,mt,pt,Gt,gt,Jt,Fn,Vt,Xi,Ui,Ni,Sn={};A.line&&(Sn.line=(T=(C=_).options,de=!1,de=lt(C,z=C.curStats,"line_color",T.lineColor,(U=C.events).cur_line_color)||de,de=lt(C,z,"line_colorTra",ir(z.line_color)[0]<1)||de,de=lt(C,z,"line_strokeWidth",T.lineSize,U.cur_line_strokeWidth)||de)),(A.plug||Sn.line)&&(Sn.plug=(oe=(ne=_).options,G=ne.curStats,ee=ne.events,ve=!1,[0,1].forEach(function(me){var Lt,kt,rn,_n,Ar,ms,Ii,fo,vi=oe.plugSE[me];ve=lt(ne,G.plug_enabledSE,me,vi!==Jn)||ve,ve=lt(ne,G.plug_plugSE,me,vi)||ve,ve=lt(ne,G.plug_colorSE,me,fo=oe.plugColorSE[me]||G.line_color,ee.cur_plug_colorSE)||ve,ve=lt(ne,G.plug_colorTraSE,me,ir(fo)[0]<1)||ve,vi!==Jn&&(_n=kt=(Lt=Sr[bi[vi]]).widthR*oe.plugSizeSE[me],Ar=rn=Lt.heightR*oe.plugSizeSE[me],En&&(_n*=G.line_strokeWidth,Ar*=G.line_strokeWidth),ve=lt(ne,G.plug_markerWidthSE,me,_n)||ve,ve=lt(ne,G.plug_markerHeightSE,me,Ar)||ve,G.capsMaskMarker_markerWidthSE[me]=kt,G.capsMaskMarker_markerHeightSE[me]=rn),G.plugOutline_plugSE[me]=G.capsMaskMarker_plugSE[me]=vi,G.plug_enabledSE[me]?(G.position_plugOverheadSE[me]=Lt.overhead*(fo=G.line_strokeWidth/Qn.lineSize*oe.plugSizeSE[me]),G.viewBox_plugBCircleSE[me]=Lt.bCircle*fo,ms=Lt.sideLen*fo,Ii=Lt.backLen*fo):(G.position_plugOverheadSE[me]=-G.line_strokeWidth/2,G.viewBox_plugBCircleSE[me]=ms=Ii=0),lt(ne,G.attach_plugSideLenSE,me,ms,ee.cur_attach_plugSideLenSE),lt(ne,G.attach_plugBackLenSE,me,Ii,ee.cur_attach_plugBackLenSE),G.capsMaskAnchor_enabledSE[me]=!G.plug_enabledSE[me]}),ve=lt(ne,G,"plug_enabled",G.plug_enabledSE[0]||G.plug_enabledSE[1])||ve)),(A.lineOutline||Sn.line)&&(Sn.lineOutline=($=(q=_).options,ge=!1,ge=lt(q,ue=q.curStats,"lineOutline_enabled",$.lineOutlineEnabled)||ge,ge=lt(q,ue,"lineOutline_color",$.lineOutlineColor)||ge,ge=lt(q,ue,"lineOutline_colorTra",ir(ue.lineOutline_color)[0]<1)||ge,ge=lt(q,ue,"lineOutline_strokeWidth",ue.line_strokeWidth-2*(Q=ue.line_strokeWidth*$.lineOutlineSize))||ge,ge=lt(q,ue,"lineOutline_inStrokeWidth",ue.lineOutline_colorTra?ue.lineOutline_strokeWidth+2*Ei:ue.line_strokeWidth-Q)||ge)),(A.plugOutline||Sn.line||Sn.plug||Sn.lineOutline)&&(Sn.plugOutline=(Oe=(Se=_).options,Ce=Se.curStats,fe=!1,[0,1].forEach(function(me){var Lt,kt=Ce.plugOutline_plugSE[me],rn=kt!==Jn?Sr[bi[kt]]:null;fe=lt(Se,Ce.plugOutline_enabledSE,me,Oe.plugOutlineEnabledSE[me]&&Ce.plug_enabled&&Ce.plug_enabledSE[me]&&!!rn&&!!rn.outlineBase)||fe,fe=lt(Se,Ce.plugOutline_colorSE,me,Lt=Oe.plugOutlineColorSE[me]||Ce.lineOutline_color)||fe,fe=lt(Se,Ce.plugOutline_colorTraSE,me,ir(Lt)[0]<1)||fe,rn&&rn.outlineBase&&((Lt=Oe.plugOutlineSizeSE[me])>rn.outlineMax&&(Lt=rn.outlineMax),fe=lt(Se,Ce.plugOutline_strokeWidthSE,me,Lt*=2*rn.outlineBase)||fe,fe=lt(Se,Ce.plugOutline_inStrokeWidthSE,me,Ce.plugOutline_colorTraSE[me]?Lt-Ei/(Ce.line_strokeWidth/Qn.lineSize)/Oe.plugSizeSE[me]*2:Lt/2)||fe)}),fe)),(A.faces||Sn.line||Sn.plug||Sn.lineOutline||Sn.plugOutline)&&(Sn.faces=(ae=(ie=_).curStats,st=ie.aplStats,ht=ie.events,it=!1,!ae.line_altColor&&lt(ie,st,"line_color",le=ae.line_color,ht.apl_line_color)&&(ie.lineFace.style.stroke=le,it=!0),lt(ie,st,"line_strokeWidth",le=ae.line_strokeWidth,ht.apl_line_strokeWidth)&&(ie.lineShape.style.strokeWidth=le+"px",it=!0,(bn||Yt)&&(cn(ie,ie.lineShape),Yt&&(cn(ie,ie.lineFace),cn(ie,ie.lineMaskCaps)))),lt(ie,st,"lineOutline_enabled",le=ae.lineOutline_enabled,ht.apl_lineOutline_enabled)&&(ie.lineOutlineFace.style.display=le?"inline":"none",it=!0),ae.lineOutline_enabled&&(lt(ie,st,"lineOutline_color",le=ae.lineOutline_color,ht.apl_lineOutline_color)&&(ie.lineOutlineFace.style.stroke=le,it=!0),lt(ie,st,"lineOutline_strokeWidth",le=ae.lineOutline_strokeWidth,ht.apl_lineOutline_strokeWidth)&&(ie.lineOutlineMaskShape.style.strokeWidth=le+"px",it=!0,Yt&&(cn(ie,ie.lineOutlineMaskCaps),cn(ie,ie.lineOutlineFace))),lt(ie,st,"lineOutline_inStrokeWidth",le=ae.lineOutline_inStrokeWidth,ht.apl_lineOutline_inStrokeWidth)&&(ie.lineMaskShape.style.strokeWidth=le+"px",it=!0,Yt&&(cn(ie,ie.lineOutlineMaskCaps),cn(ie,ie.lineOutlineFace)))),lt(ie,st,"plug_enabled",le=ae.plug_enabled,ht.apl_plug_enabled)&&(ie.plugsFace.style.display=le?"inline":"none",it=!0),ae.plug_enabled&&[0,1].forEach(function(me){var Lt=ae.plug_plugSE[me],kt=Lt!==Jn?Sr[bi[Lt]]:null,rn=ta(me,kt);lt(ie,st.plug_enabledSE,me,le=ae.plug_enabledSE[me],ht.apl_plug_enabledSE)&&(ie.plugsFace.style[rn.prop]=le?"url(#"+ie.plugMarkerIdSE[me]+")":"none",it=!0),ae.plug_enabledSE[me]&&(lt(ie,st.plug_plugSE,me,Lt,ht.apl_plug_plugSE)&&(ie.plugFaceSE[me].href.baseVal="#"+kt.elmId,ea(ie,ie.plugMarkerSE[me],rn.orient,kt.bBox,ie.svg,ie.plugMarkerShapeSE[me],ie.plugsFace),it=!0,bn&&cn(ie,ie.plugsFace)),lt(ie,st.plug_colorSE,me,le=ae.plug_colorSE[me],ht.apl_plug_colorSE)&&(ie.plugFaceSE[me].style.fill=le,it=!0,(qt||En||Yt)&&!ae.line_colorTra&&cn(ie,Yt?ie.lineMaskCaps:ie.capsMaskLine)),["markerWidth","markerHeight"].forEach(function(_n){var Ar="plug_"+_n+"SE";lt(ie,st[Ar],me,le=ae[Ar][me],ht["apl_"+Ar])&&(ie.plugMarkerSE[me][_n].baseVal.value=le,it=!0)}),lt(ie,st.plugOutline_enabledSE,me,le=ae.plugOutline_enabledSE[me],ht.apl_plugOutline_enabledSE)&&(le?(ie.plugFaceSE[me].style.mask="url(#"+ie.plugMaskIdSE[me]+")",ie.plugOutlineFaceSE[me].style.display="inline"):(ie.plugFaceSE[me].style.mask="none",ie.plugOutlineFaceSE[me].style.display="none"),it=!0),ae.plugOutline_enabledSE[me]&&(lt(ie,st.plugOutline_plugSE,me,Lt,ht.apl_plugOutline_plugSE)&&(ie.plugOutlineFaceSE[me].href.baseVal=ie.plugMaskShapeSE[me].href.baseVal=ie.plugOutlineMaskShapeSE[me].href.baseVal="#"+kt.elmId,[ie.plugMaskSE[me],ie.plugOutlineMaskSE[me]].forEach(function(_n){_n.x.baseVal.value=kt.bBox.left,_n.y.baseVal.value=kt.bBox.top,_n.width.baseVal.value=kt.bBox.width,_n.height.baseVal.value=kt.bBox.height}),it=!0),lt(ie,st.plugOutline_colorSE,me,le=ae.plugOutline_colorSE[me],ht.apl_plugOutline_colorSE)&&(ie.plugOutlineFaceSE[me].style.fill=le,it=!0,Yt&&(cn(ie,ie.lineMaskCaps),cn(ie,ie.lineOutlineMaskCaps))),lt(ie,st.plugOutline_strokeWidthSE,me,le=ae.plugOutline_strokeWidthSE[me],ht.apl_plugOutline_strokeWidthSE)&&(ie.plugOutlineMaskShapeSE[me].style.strokeWidth=le+"px",it=!0),lt(ie,st.plugOutline_inStrokeWidthSE,me,le=ae.plugOutline_inStrokeWidthSE[me],ht.apl_plugOutline_inStrokeWidthSE)&&(ie.plugMaskShapeSE[me].style.strokeWidth=le+"px",it=!0)))}),it)),(A.position||Sn.line||Sn.plug)&&(Sn.position=function(_){var A,C,T,z,U,de,ne,oe,G,ee,ve,Q,$,ue,ge,Se,Oe,Ce,fe=_.options,ie=_.curStats,le=_.aplStats,ae=ie.position_socketXYSE,st=!1;function ht(H,be){var I=1===be?{x:H.left+H.width/2,y:H.top}:2===be?{x:H.right,y:H.top+H.height/2}:3===be?{x:H.left+H.width/2,y:H.bottom}:{x:H.left,y:H.top+H.height/2};return I.socketId=be,I}function it(H){return{x:H.x,y:H.y}}if(ie.position_path=fe.path,ie.position_lineStrokeWidth=ie.line_strokeWidth,ie.position_socketGravitySE=A=Si(fe.socketGravitySE),C=[0,1].map(function(H){var be,I,ye,Pe=fe.anchorSE[H],R=_.optionIsAttach.anchorSE[H],F=!1!==R?qn[Pe._id]:null,E=!1!==R&&F.conf.getStrokeWidth?F.conf.getStrokeWidth(F,_):0,k=!1!==R&&F.conf.getBBoxNest?F.conf.getBBoxNest(F,_,E):No(Pe,_.baseWindow);return ie.capsMaskAnchor_pathDataSE[H]=!1!==R&&F.conf.getPathData?F.conf.getPathData(F,_,E):(I=null!=(be=k).right?be.right:be.left+be.width,[{type:"M",values:[be.left,be.top]},{type:"L",values:[I,be.top]},{type:"L",values:[I,ye=null!=be.bottom?be.bottom:be.top+be.height]},{type:"L",values:[be.left,ye]},{type:"Z",values:[]}]),ie.capsMaskAnchor_strokeWidthSE[H]=E,k}),ne=-1,fe.socketSE[0]&&fe.socketSE[1]?(ae[0]=ht(C[0],fe.socketSE[0]),ae[1]=ht(C[1],fe.socketSE[1])):(fe.socketSE[0]||fe.socketSE[1]?(fe.socketSE[0]?(U=0,de=1):(U=1,de=0),ae[U]=ht(C[U],fe.socketSE[U]),(z=Xr.map(function(H){return ht(C[de],H)})).forEach(function(H){var be=Kn(H,ae[U]);(be<ne||-1===ne)&&(ae[de]=H,ne=be)})):(z=Xr.map(function(H){return ht(C[1],H)}),Xr.map(function(H){return ht(C[0],H)}).forEach(function(H){z.forEach(function(be){var I=Kn(H,be);(I<ne||-1===ne)&&(ae[0]=H,ae[1]=be,ne=I)})})),[0,1].forEach(function(H){var be,I;fe.socketSE[H]||(C[H].width||C[H].height?C[H].width||4!==ae[H].socketId&&2!==ae[H].socketId?C[H].height||1!==ae[H].socketId&&3!==ae[H].socketId||(ae[H].socketId=0<=ae[H?0:1].y-C[H].top?3:1):ae[H].socketId=0<=ae[H?0:1].x-C[H].left?2:4:(be=ae[H?0:1].x-C[H].left,I=ae[H?0:1].y-C[H].top,ae[H].socketId=Math.abs(be)>=Math.abs(I)?0<=be?2:4:0<=I?3:1))})),ie.position_path!==le.position_path||ie.position_lineStrokeWidth!==le.position_lineStrokeWidth||[0,1].some(function(H){return ie.position_plugOverheadSE[H]!==le.position_plugOverheadSE[H]||(Pe=ae[H]).x!==(R=le.position_socketXYSE[H]).x||Pe.y!==R.y||Pe.socketId!==R.socketId||(I=le.position_socketGravitySE[H],(ye=null==(be=A[H])?"auto":Array.isArray(be)?"array":"number")!=(null==I?"auto":Array.isArray(I)?"array":"number")||("array"===ye?be[0]!==I[0]||be[1]!==I[1]:be!==I));var be,I,ye,Pe,R})){switch(_.pathList.baseVal=T=[],_.pathList.animVal=null,ie.position_path){case 1:T.push([it(ae[0]),it(ae[1])]);break;case 2:Q=Qr*("number"==typeof A[0]&&0<A[0]||"number"==typeof A[1]&&0<A[1]?-1:1),ue=-($=Math.atan2(ae[1].y-ae[0].y,ae[1].x-ae[0].x))+Q,ge=Math.PI-$-Q,Se=Kn(ae[0],ae[1])/Math.sqrt(2)*Jr,Oe={x:ae[0].x+Math.cos(ue)*Se,y:ae[0].y+Math.sin(ue)*Se*-1},Ce={x:ae[1].x+Math.cos(ge)*Se,y:ae[1].y+Math.sin(ge)*Se*-1},T.push([it(ae[0]),Oe,Ce,it(ae[1])]);break;case 3:case 4:G=[A[0],4===ie.position_path?0:A[1]],ee=[],ve=[],ae.forEach(function(H,be){var I,ye,Pe,R,F,E=G[be];Array.isArray(E)?I={x:E[0],y:E[1]}:"number"==typeof E?I=1===H.socketId?{x:0,y:-E}:2===H.socketId?{x:E,y:0}:3===H.socketId?{x:0,y:E}:{x:-E,y:0}:(ye=ae[be?0:1],R=0<(Pe=ie.position_plugOverheadSE[be])?120+(8<Pe?3.75*(Pe-8):0):80+(ie.position_lineStrokeWidth>4?5*(ie.position_lineStrokeWidth-4):0),1===H.socketId?((F=(H.y-ye.y)/2)<R&&(F=R),I={x:0,y:-F}):2===H.socketId?((F=(ye.x-H.x)/2)<R&&(F=R),I={x:F,y:0}):3===H.socketId?((F=(ye.y-H.y)/2)<R&&(F=R),I={x:0,y:F}):((F=(H.x-ye.x)/2)<R&&(F=R),I={x:-F,y:0})),ee[be]=H.x+I.x,ve[be]=H.y+I.y}),T.push([it(ae[0]),{x:ee[0],y:ve[0]},{x:ee[1],y:ve[1]},it(ae[1])]);break;case 5:!function(){var H,R=[[],[]],F=[];function E(zt){return 1===zt?3:2===zt?4:3===zt?1:2}function k(zt){return 2===zt||4===zt?"x":"y"}function O(zt,mt,pt){var Gt={x:zt.x,y:zt.y};if(pt){if(pt===E(zt.dirId))throw new Error("Invalid dirId: "+pt);Gt.dirId=pt}else Gt.dirId=zt.dirId;return 1===Gt.dirId?Gt.y-=mt:2===Gt.dirId?Gt.x+=mt:3===Gt.dirId?Gt.y+=mt:Gt.x-=mt,Gt}function te(zt,mt){return 1===mt.dirId?zt.y<=mt.y:2===mt.dirId?zt.x>=mt.x:3===mt.dirId?zt.y>=mt.y:zt.x<=mt.x}function Xe(zt,mt){return 1===mt.dirId||3===mt.dirId?zt.x===mt.x:zt.y===mt.y}function Rt(zt){return zt[0]?{contain:0,notContain:1}:{contain:1,notContain:0}}function Xt(zt,mt,pt){return Math.abs(mt[pt]-zt[pt])}function Bn(zt,mt,pt){return"x"===pt?zt.x<mt.x?2:4:zt.y<mt.y?3:1}function Ro(){var zt,mt,pt,Gt,gt=[te(F[1],F[0]),te(F[0],F[1])],Jt=[k(F[0].dirId),k(F[1].dirId)];if(Jt[0]===Jt[1]){if(gt[0]&&gt[1])return Xe(F[1],F[0])||(F[0][Jt[0]]===F[1][Jt[1]]?(R[0].push(F[0]),R[1].push(F[1])):(zt=F[0][Jt[0]]+(F[1][Jt[1]]-F[0][Jt[0]])/2,R[0].push(O(F[0],Math.abs(zt-F[0][Jt[0]]))),R[1].push(O(F[1],Math.abs(zt-F[1][Jt[1]]))))),!1;gt[0]!==gt[1]?(mt=Rt(gt),(pt=Xt(F[mt.notContain],F[mt.contain],Jt[mt.notContain]))<30&&(F[mt.notContain]=O(F[mt.notContain],30-pt)),R[mt.notContain].push(F[mt.notContain]),F[mt.notContain]=O(F[mt.notContain],30,Xe(F[mt.contain],F[mt.notContain])?"x"===Jt[mt.notContain]?3:2:Bn(F[mt.notContain],F[mt.contain],"x"===Jt[mt.notContain]?"y":"x"))):(pt=Xt(F[0],F[1],"x"===Jt[0]?"y":"x"),R.forEach(function(Fn,Vt){var Xi=0===Vt?1:0;Fn.push(F[Vt]),F[Vt]=O(F[Vt],30,60<=pt?Bn(F[Vt],F[Xi],"x"===Jt[Vt]?"y":"x"):"x"===Jt[Vt]?3:2)}))}else{if(gt[0]&&gt[1])return Xe(F[1],F[0])?R[1].push(F[1]):Xe(F[0],F[1])?R[0].push(F[0]):R[0].push("x"===Jt[0]?{x:F[1].x,y:F[0].y}:{x:F[0].x,y:F[1].y}),!1;gt[0]!==gt[1]?(mt=Rt(gt),R[mt.notContain].push(F[mt.notContain]),F[mt.notContain]=O(F[mt.notContain],30,Xt(F[mt.notContain],F[mt.contain],Jt[mt.contain])>=30?Bn(F[mt.notContain],F[mt.contain],Jt[mt.contain]):F[mt.contain].dirId)):(Gt=[{x:F[0].x,y:F[0].y},{x:F[1].x,y:F[1].y}],R.forEach(function(Fn,Vt){var Xi=0===Vt?1:0,Ui=Xt(Gt[Vt],Gt[Xi],Jt[Vt]);Ui<30&&(F[Vt]=O(F[Vt],30-Ui)),Fn.push(F[Vt]),F[Vt]=O(F[Vt],30,Bn(F[Vt],F[Xi],Jt[Xi]))}))}return!0}for(ae.forEach(function(zt,mt){var pt,Gt=it(zt),gt=A[mt];pt=Array.isArray(gt)?gt[0]<0?[4,-gt[0]]:0<gt[0]?[2,gt[0]]:gt[1]<0?[1,-gt[1]]:0<gt[1]?[3,gt[1]]:[zt.socketId,0]:"number"!=typeof gt?[zt.socketId,30]:0<=gt?[zt.socketId,gt]:[E(zt.socketId),-gt],Gt.dirId=pt[0],gt=pt[1],R[mt].push(Gt),F[mt]=O(Gt,gt)});Ro(););R[1].reverse(),R[0].concat(R[1]).forEach(function(zt,mt){var pt={x:zt.x,y:zt.y};0<mt&&T.push([H,pt]),H=pt})}()}oe=[],ie.position_plugOverheadSE.forEach(function(H,be){var I,ye,Pe,R,F,E,k,O,te,Xe,Rt,Xt=!be;0<H?2===(I=T[ye=Xt?0:T.length-1]).length?(oe[ye]=oe[ye]||Kn.apply(null,I),oe[ye]>10&&(oe[ye]-H<10&&(H=oe[ye]-10),Pe=Lo(I[0],I[1],(Xt?H:oe[ye]-H)/oe[ye]),T[ye]=Xt?[Pe,I[1]]:[I[0],Pe],oe[ye]-=H)):(oe[ye]=oe[ye]||po.apply(null,I),oe[ye]>10&&(oe[ye]-H<10&&(H=oe[ye]-10),Pe=Bi(I[0],I[1],I[2],I[3],Vi(I[0],I[1],I[2],I[3],Xt?H:oe[ye]-H)),Xt?(R=I[0],F=Pe.toP1):(R=I[3],F=Pe.fromP2),E=Math.atan2(R.y-Pe.y,Pe.x-R.x),k=Kn(Pe,F),Pe.x=R.x+Math.cos(E)*H,Pe.y=R.y+Math.sin(E)*H*-1,F.x=Pe.x+Math.cos(E)*k,F.y=Pe.y+Math.sin(E)*k*-1,T[ye]=Xt?[Pe,Pe.toP1,Pe.toP2,I[3]]:[I[0],Pe.fromP1,Pe.fromP2,Pe],oe[ye]=null)):H<0&&(I=T[ye=Xt?0:T.length-1],H<(Rt=-C[be]["x"==(te=4===(O=ae[be].socketId)||2===O?"x":"y")?"width":"height"])&&(H=Rt),Xe=H*(4===O||1===O?-1:1),2===I.length?I[Xt?0:I.length-1][te]+=Xe:(Xt?[0,1]:[I.length-2,I.length-1]).forEach(function(Bn){I[Bn][te]+=Xe}),oe[ye]=null)}),le.position_socketXYSE=Si(ae),le.position_plugOverheadSE=Si(ie.position_plugOverheadSE),le.position_path=ie.position_path,le.position_lineStrokeWidth=ie.position_lineStrokeWidth,le.position_socketGravitySE=Si(A),st=!0,_.events.apl_position&&_.events.apl_position.forEach(function(H){H(_,T)})}return st}(_)),(A.path||Sn.position)&&(Sn.path=(I=(H=_).curStats,ye=H.aplStats,R=I.path_edge,F=!1,(Pe=H.pathList.animVal||H.pathList.baseVal)&&(R.x1=R.x2=Pe[0][0].x,R.y1=R.y2=Pe[0][0].y,I.path_pathData=be=_i(Pe,function(me){me.x<R.x1&&(R.x1=me.x),me.y<R.y1&&(R.y1=me.y),me.x>R.x2&&(R.x2=me.x),me.y>R.y2&&(R.y2=me.y)}),Ln(be,ye.path_pathData)&&(H.linePath.setPathData(be),ye.path_pathData=be,F=!0,Yt?(cn(H,H.plugsFace),cn(H,H.lineMaskCaps)):bn&&cn(H,H.linePath),H.events.apl_path&&H.events.apl_path.forEach(function(me){me(H,be)}))),F)),Sn.viewBox=(Rt=(te=(E=_).curStats).path_edge,Xt=te.viewBox_bBox,Bn=E.aplStats.viewBox_bBox,Ro=E.svg.viewBox.baseVal,zt=E.svg.style,mt=!1,k=Math.max(te.line_strokeWidth/2,te.viewBox_plugBCircleSE[0]||0,te.viewBox_plugBCircleSE[1]||0),O={x1:Rt.x1-k,y1:Rt.y1-k,x2:Rt.x2+k,y2:Rt.y2+k},E.events.new_edge4viewBox&&E.events.new_edge4viewBox.forEach(function(me){me(E,O)}),Xt.x=te.lineMask_x=te.lineOutlineMask_x=te.maskBGRect_x=O.x1,Xt.y=te.lineMask_y=te.lineOutlineMask_y=te.maskBGRect_y=O.y1,Xt.width=O.x2-O.x1,Xt.height=O.y2-O.y1,["x","y","width","height"].forEach(function(me){var Lt;(Lt=Xt[me])!==Bn[me]&&(Ro[me]=Bn[me]=Lt,zt[li[me]]=Lt+("x"===me||"y"===me?E.bodyOffset[me]:0)+"px",mt=!0)}),mt),Sn.mask=(gt=(pt=_).curStats,Jt=pt.aplStats,Fn=!1,gt.plug_enabled?[0,1].forEach(function(me){gt.capsMaskMarker_enabledSE[me]=gt.plug_enabledSE[me]&&gt.plug_colorTraSE[me]||gt.plugOutline_enabledSE[me]&&gt.plugOutline_colorTraSE[me]}):gt.capsMaskMarker_enabledSE[0]=gt.capsMaskMarker_enabledSE[1]=!1,gt.capsMaskMarker_enabled=gt.capsMaskMarker_enabledSE[0]||gt.capsMaskMarker_enabledSE[1],gt.lineMask_outlineMode=gt.lineOutline_enabled,gt.caps_enabled=gt.capsMaskMarker_enabled||gt.capsMaskAnchor_enabledSE[0]||gt.capsMaskAnchor_enabledSE[1],gt.lineMask_enabled=gt.caps_enabled||gt.lineMask_outlineMode,(gt.lineMask_enabled&&!gt.lineMask_outlineMode||gt.lineOutline_enabled)&&["x","y"].forEach(function(me){var Lt="maskBGRect_"+me;lt(pt,Jt,Lt,Gt=gt[Lt])&&(pt.maskBGRect[me].baseVal.value=Gt,Fn=!0)}),lt(pt,Jt,"lineMask_enabled",Gt=gt.lineMask_enabled)&&(pt.lineFace.style.mask=Gt?"url(#"+pt.lineMaskId+")":"none",Fn=!0,En&&cn(pt,pt.lineMask)),gt.lineMask_enabled&&(lt(pt,Jt,"lineMask_outlineMode",Gt=gt.lineMask_outlineMode)&&(Gt?(pt.lineMaskBG.style.display="none",pt.lineMaskShape.style.display="inline"):(pt.lineMaskBG.style.display="inline",pt.lineMaskShape.style.display="none"),Fn=!0),["x","y"].forEach(function(me){var Lt="lineMask_"+me;lt(pt,Jt,Lt,Gt=gt[Lt])&&(pt.lineMask[me].baseVal.value=Gt,Fn=!0)}),lt(pt,Jt,"caps_enabled",Gt=gt.caps_enabled)&&(pt.lineMaskCaps.style.display=pt.lineOutlineMaskCaps.style.display=Gt?"inline":"none",Fn=!0,En&&cn(pt,pt.capsMaskLine)),gt.caps_enabled&&([0,1].forEach(function(me){var Lt;lt(pt,Jt.capsMaskAnchor_enabledSE,me,Gt=gt.capsMaskAnchor_enabledSE[me])&&(pt.capsMaskAnchorSE[me].style.display=Gt?"inline":"none",Fn=!0,En&&cn(pt,pt.lineMask)),gt.capsMaskAnchor_enabledSE[me]&&(Ln(Lt=gt.capsMaskAnchor_pathDataSE[me],Jt.capsMaskAnchor_pathDataSE[me])&&(pt.capsMaskAnchorSE[me].setPathData(Lt),Jt.capsMaskAnchor_pathDataSE[me]=Lt,Fn=!0),lt(pt,Jt.capsMaskAnchor_strokeWidthSE,me,Gt=gt.capsMaskAnchor_strokeWidthSE[me])&&(pt.capsMaskAnchorSE[me].style.strokeWidth=Gt+"px",Fn=!0))}),lt(pt,Jt,"capsMaskMarker_enabled",Gt=gt.capsMaskMarker_enabled)&&(pt.capsMaskLine.style.display=Gt?"inline":"none",Fn=!0),gt.capsMaskMarker_enabled&&[0,1].forEach(function(me){var Lt=gt.capsMaskMarker_plugSE[me],kt=Lt!==Jn?Sr[bi[Lt]]:null,rn=ta(me,kt);lt(pt,Jt.capsMaskMarker_enabledSE,me,Gt=gt.capsMaskMarker_enabledSE[me])&&(pt.capsMaskLine.style[rn.prop]=Gt?"url(#"+pt.lineMaskMarkerIdSE[me]+")":"none",Fn=!0),gt.capsMaskMarker_enabledSE[me]&&(lt(pt,Jt.capsMaskMarker_plugSE,me,Lt)&&(pt.capsMaskMarkerShapeSE[me].href.baseVal="#"+kt.elmId,ea(pt,pt.capsMaskMarkerSE[me],rn.orient,kt.bBox,pt.svg,pt.capsMaskMarkerShapeSE[me],pt.capsMaskLine),Fn=!0,bn&&(cn(pt,pt.capsMaskLine),cn(pt,pt.lineFace))),["markerWidth","markerHeight"].forEach(function(_n){var Ar="capsMaskMarker_"+_n+"SE";lt(pt,Jt[Ar],me,Gt=gt[Ar][me])&&(pt.capsMaskMarkerSE[me][_n].baseVal.value=Gt,Fn=!0)}))}))),gt.lineOutline_enabled&&["x","y"].forEach(function(me){var Lt="lineOutlineMask_"+me;lt(pt,Jt,Lt,Gt=gt[Lt])&&(pt.lineOutlineMask[me].baseVal.value=Gt,Fn=!0)}),Fn),A.effect&&(Ui=(Vt=_).curStats,Ni=Vt.aplStats,Object.keys(dn).forEach(function(me){var Lt=dn[me],kt=me+"_enabled",rn=me+"_options",_n=Ui[rn];lt(Vt,Ni,kt,Xi=Ui[kt])?(Xi&&(Ni[rn]=Si(_n)),Lt[Xi?"init":"remove"](Vt)):Xi&&Dr(_n,Ni[rn])&&(Lt.remove(Vt),Ni[kt]=!0,Ni[rn]=Si(_n),Lt.init(Vt))})),(qt||En)&&Sn.line&&!Sn.path&&cn(_,_.lineShape),qt&&Sn.plug&&!Sn.line&&cn(_,_.plugsFace),Fo(_)}function Po(_,A){return{duration:un(_.duration)&&0<_.duration?_.duration:A.duration,timing:$t.validTiming(_.timing)?_.timing:Si(A.timing)}}function $r(_,A,C,T){var z,U=_.curStats,de=_.aplStats,ne={};function oe(){["show_on","show_effect","show_animOptions"].forEach(function(G){de[G]=U[G]})}U.show_on=A,C&&wt[C]&&(U.show_effect=C,U.show_animOptions=Po(Hi(T)?T:{},wt[C].defaultAnimOptions)),ne.show_on=U.show_on!==de.show_on,ne.show_effect=U.show_effect!==de.show_effect,ne.show_animOptions=Dr(U.show_animOptions,de.show_animOptions),ne.show_effect||ne.show_animOptions?U.show_inAnim?(z=ne.show_effect?wt[de.show_effect].stop(_,!0,!0):wt[de.show_effect].stop(_),oe(),wt[de.show_effect].init(_,z)):ne.show_on&&(de.show_effect&&ne.show_effect&&wt[de.show_effect].stop(_,!0,!0),oe(),wt[de.show_effect].init(_)):ne.show_on&&(oe(),wt[de.show_effect].start(_))}function Va(_,A,C){var T={props:_,optionName:C};return!(!(_.attachments.indexOf(A)<0)||A.conf.bind&&!A.conf.bind(A,T)||(_.attachments.push(A),A.boundTargets.push(T),0))}function Do(_,A,C){var T=_.attachments.indexOf(A);-1<T&&_.attachments.splice(T,1),A.boundTargets.some(function(z,U){return z.props===_&&(A.conf.unbind&&A.conf.unbind(A,z),T=U,!0)})&&(A.boundTargets.splice(T,1),C||gr(function(){A.boundTargets.length||dr(A)}))}function _r(_,A){var C,T,z=_.options,U={};function de(G,ee,ve,q,Q){var $={};return ve?null!=q?($.container=G[ve],$.key=q):($.container=G,$.key=ve):($.container=G,$.key=ee),$.default=Q,$.acceptsAuto=null==$.default,$}function ne(G,ee,ve,q,Q,$,ue){var ge,Se,Oe,Ce=de(G,ve,Q,$,ue);return null!=ee[ve]&&(Se=(ee[ve]+"").toLowerCase())&&(Ce.acceptsAuto&&Se===pr||(Oe=q[Se]))&&Oe!==Ce.container[Ce.key]&&(Ce.container[Ce.key]=Oe,ge=!0),null!=Ce.container[Ce.key]||Ce.acceptsAuto||(Ce.container[Ce.key]=Ce.default,ge=!0),ge}function oe(G,ee,ve,q,Q,$,ue,ge,Se){var Oe,Ce,fe,ie,le=de(G,ve,Q,$,ue);if(!q){if(null==le.default)throw new Error("Invalid `type`: "+ve);q=typeof le.default}return null!=ee[ve]&&(le.acceptsAuto&&(ee[ve]+"").toLowerCase()===pr||(fe=Ce=ee[ve],("number"===(ie=q)?un(fe):typeof fe===ie)&&(Ce=Se&&"string"===q&&Ce?Ce.trim():Ce,1)&&(!ge||ge(Ce))))&&Ce!==le.container[le.key]&&(le.container[le.key]=Ce,Oe=!0),null!=le.container[le.key]||le.acceptsAuto||(le.container[le.key]=le.default,Oe=!0),Oe}if(A=A||{},["start","end"].forEach(function(G,ee){var ve=A[G],q=!1;if(ve&&(Wi(ve)||(q=tr(ve,"anchor")))&&ve!==z.anchorSE[ee]){if(!1!==_.optionIsAttach.anchorSE[ee]&&Do(_,qn[z.anchorSE[ee]._id]),q&&!Va(_,qn[ve._id],G))throw new Error("Can't bind attachment");z.anchorSE[ee]=ve,_.optionIsAttach.anchorSE[ee]=q,T=U.position=!0}}),!z.anchorSE[0]||!z.anchorSE[1]||z.anchorSE[0]===z.anchorSE[1])throw new Error("`start` and `end` are required.");T&&(C=function(G,ee){var ve,q,Q;if(!(ve=ho(G))||!(q=ho(ee)))throw new Error("Cannot get frames.");return ve.length&&q.length&&(ve.reverse(),q.reverse(),ve.some(function($){return q.some(function(ue){return ue===$&&(Q=ue.contentWindow,!0)})})),Q||window}(!1!==_.optionIsAttach.anchorSE[0]?qn[z.anchorSE[0]._id].element:z.anchorSE[0],!1!==_.optionIsAttach.anchorSE[1]?qn[z.anchorSE[1]._id].element:z.anchorSE[1]))!==_.baseWindow&&(function(G,ee){var ve,q,Q,$,ue,ge,Se,Oe,Ce,fe,ie=G.aplStats,le=ee.document,ae=ui+"-"+G._id;function st(H){var be=q.appendChild(le.createElementNS(_t,"mask"));return be.id=H,be.maskUnits.baseVal=SVGUnitTypes.SVG_UNIT_TYPE_USERSPACEONUSE,[be.x,be.y,be.width,be.height].forEach(function(I){I.baseVal.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX,0)}),be}function ht(H){var be=q.appendChild(le.createElementNS(_t,"marker"));return be.id=H,be.markerUnits.baseVal=SVGMarkerElement.SVG_MARKERUNITS_STROKEWIDTH,be.viewBox.baseVal||be.setAttribute("viewBox","0 0 0 0"),be}function it(H){return[H.width,H.height].forEach(function(be){be.baseVal.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PERCENTAGE,100)}),H}G.pathList={},kn(ie,ko),Object.keys(dn).forEach(function(H){var be=H+"_enabled";ie[be]&&(dn[H].remove(G),ie[be]=!1)}),G.baseWindow&&G.svg&&G.baseWindow.document.body.removeChild(G.svg),Ti(G.baseWindow=ee),G.bodyOffset=fn(ee),G.svg=ve=le.createElementNS(_t,"svg"),ve.className.baseVal=ui,ve.viewBox.baseVal||ve.setAttribute("viewBox","0 0 0 0"),G.defs=q=ve.appendChild(le.createElementNS(_t,"defs")),G.linePath=$=q.appendChild(le.createElementNS(_t,"path")),$.id=ue=ae+"-line-path",$.className.baseVal=ui+"-line-path",En&&($.style.fill="none"),G.lineShape=$=q.appendChild(le.createElementNS(_t,"use")),$.id=ge=ae+"-line-shape",$.href.baseVal="#"+ue,(Q=q.appendChild(le.createElementNS(_t,"g"))).id=Se=ae+"-caps",G.capsMaskAnchorSE=[0,1].map(function(){var H=Q.appendChild(le.createElementNS(_t,"path"));return H.className.baseVal=ui+"-caps-mask-anchor",H}),G.lineMaskMarkerIdSE=[ae+"-caps-mask-marker-0",ae+"-caps-mask-marker-1"],G.capsMaskMarkerSE=[0,1].map(function(H){return ht(G.lineMaskMarkerIdSE[H])}),G.capsMaskMarkerShapeSE=[0,1].map(function(H){var be=G.capsMaskMarkerSE[H].appendChild(le.createElementNS(_t,"use"));return be.className.baseVal=ui+"-caps-mask-marker-shape",be}),G.capsMaskLine=$=Q.appendChild(le.createElementNS(_t,"use")),$.className.baseVal=ui+"-caps-mask-line",$.href.baseVal="#"+ge,G.maskBGRect=$=it(q.appendChild(le.createElementNS(_t,"rect"))),$.id=Oe=ae+"-mask-bg-rect",$.className.baseVal=ui+"-mask-bg-rect",En&&($.style.fill="white"),G.lineMask=it(st(G.lineMaskId=ae+"-line-mask")),G.lineMaskBG=$=G.lineMask.appendChild(le.createElementNS(_t,"use")),$.href.baseVal="#"+Oe,G.lineMaskShape=$=G.lineMask.appendChild(le.createElementNS(_t,"use")),$.className.baseVal=ui+"-line-mask-shape",$.href.baseVal="#"+ue,$.style.display="none",G.lineMaskCaps=$=G.lineMask.appendChild(le.createElementNS(_t,"use")),$.href.baseVal="#"+Se,G.lineOutlineMask=it(st(Ce=ae+"-line-outline-mask")),($=G.lineOutlineMask.appendChild(le.createElementNS(_t,"use"))).href.baseVal="#"+Oe,G.lineOutlineMaskShape=$=G.lineOutlineMask.appendChild(le.createElementNS(_t,"use")),$.className.baseVal=ui+"-line-outline-mask-shape",$.href.baseVal="#"+ue,G.lineOutlineMaskCaps=$=G.lineOutlineMask.appendChild(le.createElementNS(_t,"use")),$.href.baseVal="#"+Se,G.face=ve.appendChild(le.createElementNS(_t,"g")),G.lineFace=$=G.face.appendChild(le.createElementNS(_t,"use")),$.href.baseVal="#"+ge,G.lineOutlineFace=$=G.face.appendChild(le.createElementNS(_t,"use")),$.href.baseVal="#"+ge,$.style.mask="url(#"+Ce+")",$.style.display="none",G.plugMaskIdSE=[ae+"-plug-mask-0",ae+"-plug-mask-1"],G.plugMaskSE=[0,1].map(function(H){return st(G.plugMaskIdSE[H])}),G.plugMaskShapeSE=[0,1].map(function(H){var be=G.plugMaskSE[H].appendChild(le.createElementNS(_t,"use"));return be.className.baseVal=ui+"-plug-mask-shape",be}),fe=[],G.plugOutlineMaskSE=[0,1].map(function(H){return st(fe[H]=ae+"-plug-outline-mask-"+H)}),G.plugOutlineMaskShapeSE=[0,1].map(function(H){var be=G.plugOutlineMaskSE[H].appendChild(le.createElementNS(_t,"use"));return be.className.baseVal=ui+"-plug-outline-mask-shape",be}),G.plugMarkerIdSE=[ae+"-plug-marker-0",ae+"-plug-marker-1"],G.plugMarkerSE=[0,1].map(function(H){var be=ht(G.plugMarkerIdSE[H]);return En&&(be.markerUnits.baseVal=SVGMarkerElement.SVG_MARKERUNITS_USERSPACEONUSE),be}),G.plugMarkerShapeSE=[0,1].map(function(H){return G.plugMarkerSE[H].appendChild(le.createElementNS(_t,"g"))}),G.plugFaceSE=[0,1].map(function(H){return G.plugMarkerShapeSE[H].appendChild(le.createElementNS(_t,"use"))}),G.plugOutlineFaceSE=[0,1].map(function(H){var be=G.plugMarkerShapeSE[H].appendChild(le.createElementNS(_t,"use"));return be.style.mask="url(#"+fe[H]+")",be.style.display="none",be}),G.plugsFace=$=G.face.appendChild(le.createElementNS(_t,"use")),$.className.baseVal=ui+"-plugs-face",$.href.baseVal="#"+ge,$.style.display="none",G.curStats.show_inAnim?(G.isShown=1,wt[ie.show_effect].stop(G,!0)):G.isShown||(ve.style.visibility="hidden"),le.body.appendChild(ve),[0,1,2].forEach(function(H){var be,I=G.options.labelSEM[H];I&&tr(I,"label")&&(be=qn[I._id]).conf.initSvg&&be.conf.initSvg(be,G)})}(_,C),U.line=U.plug=U.lineOutline=U.plugOutline=U.faces=U.effect=!0),U.position=ne(z,A,"path",Io,null,null,Qn.path)||U.position,U.position=ne(z,A,"startSocket",lo,"socketSE",0)||U.position,U.position=ne(z,A,"endSocket",lo,"socketSE",1)||U.position,[A.startSocketGravity,A.endSocketGravity].forEach(function(G,ee){var ve,q,Q=!1;null!=G&&(Array.isArray(G)?un(G[0])&&un(G[1])&&(Q=[G[0],G[1]],Array.isArray(z.socketGravitySE[ee])&&(ve=Q).length===(q=z.socketGravitySE[ee]).length&&ve.every(function($,ue){return $===q[ue]})&&(Q=!1)):((G+"").toLowerCase()===pr?Q=null:un(G)&&0<=G&&(Q=G),Q===z.socketGravitySE[ee]&&(Q=!1)),!1!==Q&&(z.socketGravitySE[ee]=Q,U.position=!0))}),U.line=oe(z,A,"color",null,"lineColor",null,Qn.lineColor,null,!0)||U.line,U.line=oe(z,A,"size",null,"lineSize",null,Qn.lineSize,function(G){return 0<G})||U.line,["startPlug","endPlug"].forEach(function(G,ee){U.plug=ne(z,A,G,Ko,"plugSE",ee,Qn.plugSE[ee])||U.plug,U.plug=oe(z,A,G+"Color","string","plugColorSE",ee,null,null,!0)||U.plug,U.plug=oe(z,A,G+"Size",null,"plugSizeSE",ee,Qn.plugSizeSE[ee],function(ve){return 0<ve})||U.plug}),U.lineOutline=oe(z,A,"outline",null,"lineOutlineEnabled",null,Qn.lineOutlineEnabled)||U.lineOutline,U.lineOutline=oe(z,A,"outlineColor",null,"lineOutlineColor",null,Qn.lineOutlineColor,null,!0)||U.lineOutline,U.lineOutline=oe(z,A,"outlineSize",null,"lineOutlineSize",null,Qn.lineOutlineSize,function(G){return 0<G&&G<=.48})||U.lineOutline,["startPlugOutline","endPlugOutline"].forEach(function(G,ee){U.plugOutline=oe(z,A,G,null,"plugOutlineEnabledSE",ee,Qn.plugOutlineEnabledSE[ee])||U.plugOutline,U.plugOutline=oe(z,A,G+"Color","string","plugOutlineColorSE",ee,null,null,!0)||U.plugOutline,U.plugOutline=oe(z,A,G+"Size",null,"plugOutlineSizeSE",ee,Qn.plugOutlineSizeSE[ee],function(ve){return 1<=ve})||U.plugOutline}),["startLabel","endLabel","middleLabel"].forEach(function(G,ee){var ve,q,Q,$=A[G],ue=z.labelSEM[ee]&&!_.optionIsAttach.labelSEM[ee]?qn[z.labelSEM[ee]._id].text:z.labelSEM[ee],ge=!1;if((ve="string"==typeof $)&&($=$.trim()),(ve||$&&(ge=tr($,"label")))&&$!==ue){if(z.labelSEM[ee]&&(Do(_,qn[z.labelSEM[ee]._id]),z.labelSEM[ee]=""),$){if(ge?(q=qn[(Q=$)._id]).boundTargets.slice().forEach(function(Se){q.conf.removeOption(q,Se)}):Q=new vn(tt.captionLabel,[$]),!Va(_,qn[Q._id],G))throw new Error("Can't bind attachment");z.labelSEM[ee]=Q}_.optionIsAttach.labelSEM[ee]=ge}}),Object.keys(dn).forEach(function(G){var ee,ve,q=dn[G],Q=G+"_enabled",$=G+"_options";function ue(Se){var Oe={};return q.optionsConf.forEach(function(Ce){var fe=Ce[0],ie=Ce[3];null==Ce[4]||Oe[ie]||(Oe[ie]=[]),("function"==typeof fe?fe:"id"===fe?ne:oe).apply(null,[Oe,Se].concat(Ce.slice(1)))}),Oe}function ge(Se){var Oe,Ce=G+"_animOptions";return Se.hasOwnProperty("animation")?Hi(Se.animation)?Oe=_.curStats[Ce]=Po(Se.animation,q.defaultAnimOptions):_.curStats[Ce]=(Oe=!!Se.animation)?Po({},q.defaultAnimOptions):null:_.curStats[Ce]=(Oe=!!q.defaultEnabled)?Po({},q.defaultAnimOptions):null,Oe}A.hasOwnProperty(G)&&(Hi(ee=A[G])?(_.curStats[Q]=!0,ve=_.curStats[$]=ue(ee),q.anim&&(_.curStats[$].animation=ge(ee))):(ve=_.curStats[Q]=!!ee)&&(_.curStats[$]=ue({}),q.anim&&(_.curStats[$].animation=ge({}))),Dr(ve,z[G])&&(z[G]=ve,U.effect=!0))}),mi(_,U)}function Mi(_,A,C){var T={options:{anchorSE:[],socketSE:[],socketGravitySE:[],plugSE:[],plugColorSE:[],plugSizeSE:[],plugOutlineEnabledSE:[],plugOutlineColorSE:[],plugOutlineSizeSE:[],labelSEM:["","",""]},optionIsAttach:{anchorSE:[!1,!1],labelSEM:[!1,!1,!1]},curStats:{},aplStats:{},attachments:[],events:{},reflowTargets:[]};kn(T.curStats,ko),kn(T.aplStats,ko),Object.keys(dn).forEach(function(z){var U=dn[z].stats;kn(T.curStats,U),kn(T.aplStats,U),T.options[z]=!1}),kn(T.curStats,fs),kn(T.aplStats,fs),T.curStats.show_effect=gs,T.curStats.show_animOptions=Si(wt[gs].defaultAnimOptions),Object.defineProperty(this,"_id",{value:++za}),T._id=this._id,di[this._id]=T,1===arguments.length&&(C=_,_=null),C=C||{},(_||A)&&(C=Si(C),_&&(C.start=_),A&&(C.end=A)),T.isShown=T.aplStats.show_on=!C.hide,this.setOptions(C)}dn={dash:{stats:{dash_len:{},dash_gap:{},dash_maxOffset:{}},anim:!0,defaultAnimOptions:{duration:1e3,timing:"linear"},optionsConf:[["type","len","number",null,null,null,function(_){return 0<_}],["type","gap","number",null,null,null,function(_){return 0<_}]],init:function(_){Hn(_,"apl_line_strokeWidth",dn.dash.update),_.lineFace.style.strokeDashoffset=0,dn.dash.update(_)},remove:function(_){var A=_.curStats;Wn(_,"apl_line_strokeWidth",dn.dash.update),A.dash_animId&&($t.remove(A.dash_animId),A.dash_animId=null),_.lineFace.style.strokeDasharray="none",_.lineFace.style.strokeDashoffset=0,kn(_.aplStats,dn.dash.stats)},update:function(_){var A,C=_.curStats,T=_.aplStats,z=T.dash_options,U=!1;C.dash_len=z.len||2*T.line_strokeWidth,C.dash_gap=z.gap||T.line_strokeWidth,C.dash_maxOffset=C.dash_len+C.dash_gap,U=lt(_,T,"dash_len",C.dash_len)||U,(U=lt(_,T,"dash_gap",C.dash_gap)||U)&&(_.lineFace.style.strokeDasharray=T.dash_len+","+T.dash_gap),C.dash_animOptions?(U=lt(_,T,"dash_maxOffset",C.dash_maxOffset),T.dash_animOptions&&(U||Dr(C.dash_animOptions,T.dash_animOptions))&&(C.dash_animId&&(A=$t.stop(C.dash_animId),$t.remove(C.dash_animId)),T.dash_animOptions=null),T.dash_animOptions||(C.dash_animId=$t.add(function(de){return(1-de)*T.dash_maxOffset+"px"},function(de){_.lineFace.style.strokeDashoffset=de},C.dash_animOptions.duration,0,C.dash_animOptions.timing,!1,A),T.dash_animOptions=Si(C.dash_animOptions))):T.dash_animOptions&&(C.dash_animId&&($t.remove(C.dash_animId),C.dash_animId=null),_.lineFace.style.strokeDashoffset=0,T.dash_animOptions=null)}},gradient:{stats:{gradient_colorSE:{hasSE:!0},gradient_pointSE:{hasSE:!0,hasProps:!0}},optionsConf:[["type","startColor","string","colorSE",0,null,null,!0],["type","endColor","string","colorSE",1,null,null,!0]],init:function(_){var A,C=_.baseWindow.document,z=ui+"-"+_._id+"-gradient";_.efc_gradient_gradient=A=_.defs.appendChild(C.createElementNS(_t,"linearGradient")),A.id=z,A.gradientUnits.baseVal=SVGUnitTypes.SVG_UNIT_TYPE_USERSPACEONUSE,[A.x1,A.y1,A.x2,A.y2].forEach(function(U){U.baseVal.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX,0)}),_.efc_gradient_stopSE=[0,1].map(function(U){var de=_.efc_gradient_gradient.appendChild(C.createElementNS(_t,"stop"));try{de.offset.baseVal=U}catch(ne){if(ne.code!==DOMException.NO_MODIFICATION_ALLOWED_ERR)throw ne;de.setAttribute("offset",U)}return de}),Hn(_,"cur_plug_colorSE",dn.gradient.update),Hn(_,"apl_path",dn.gradient.update),_.curStats.line_altColor=!0,_.lineFace.style.stroke="url(#"+z+")",dn.gradient.update(_)},remove:function(_){_.efc_gradient_gradient&&(_.defs.removeChild(_.efc_gradient_gradient),_.efc_gradient_gradient=_.efc_gradient_stopSE=null),Wn(_,"cur_plug_colorSE",dn.gradient.update),Wn(_,"apl_path",dn.gradient.update),_.curStats.line_altColor=!1,_.lineFace.style.stroke=_.curStats.line_color,kn(_.aplStats,dn.gradient.stats)},update:function(_){var A,C,T=_.curStats,z=_.aplStats,U=z.gradient_options,de=_.pathList.animVal||_.pathList.baseVal;[0,1].forEach(function(ne){T.gradient_colorSE[ne]=U.colorSE[ne]||T.plug_colorSE[ne]}),T.gradient_pointSE[0]={x:(C=de[0][0]).x,y:C.y},C=(A=de[de.length-1])[A.length-1],T.gradient_pointSE[1]={x:C.x,y:C.y},[0,1].forEach(function(ne){var oe;lt(_,z.gradient_colorSE,ne,oe=T.gradient_colorSE[ne])&&(En?(oe=ir(oe),_.efc_gradient_stopSE[ne].style.stopColor=oe[1],_.efc_gradient_stopSE[ne].style.stopOpacity=oe[0]):_.efc_gradient_stopSE[ne].style.stopColor=oe),["x","y"].forEach(function(G){(oe=T.gradient_pointSE[ne][G])!==z.gradient_pointSE[ne][G]&&(_.efc_gradient_gradient[G+(ne+1)].baseVal.value=z.gradient_pointSE[ne][G]=oe)})})}},dropShadow:{stats:{dropShadow_dx:{},dropShadow_dy:{},dropShadow_blur:{},dropShadow_color:{},dropShadow_opacity:{},dropShadow_x:{},dropShadow_y:{}},optionsConf:[["type","dx",null,null,null,2],["type","dy",null,null,null,4],["type","blur",null,null,null,3,function(_){return 0<=_}],["type","color",null,null,null,"#000",null,!0],["type","opacity",null,null,null,.8,function(_){return 0<=_&&_<=1}]],init:function(_){var A,C,T,z,U,ne=_.defs,oe=ui+"-"+_._id+"-dropShadow",G=(A=_.baseWindow.document,C=oe,U={},"boolean"!=typeof To&&(To=!!window.SVGFEDropShadowElement&&!En),U.elmsAppend=[U.elmFilter=T=A.createElementNS(_t,"filter")],T.filterUnits.baseVal=SVGUnitTypes.SVG_UNIT_TYPE_USERSPACEONUSE,T.x.baseVal.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX,0),T.y.baseVal.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX,0),T.width.baseVal.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PERCENTAGE,100),T.height.baseVal.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PERCENTAGE,100),T.id=C,To?(U.elmOffset=U.elmBlur=z=T.appendChild(A.createElementNS(_t,"feDropShadow")),U.styleFlood=z.style):(U.elmBlur=T.appendChild(A.createElementNS(_t,"feGaussianBlur")),U.elmOffset=z=T.appendChild(A.createElementNS(_t,"feOffset")),z.result.baseVal="offsetblur",z=T.appendChild(A.createElementNS(_t,"feFlood")),U.styleFlood=z.style,(z=T.appendChild(A.createElementNS(_t,"feComposite"))).in2.baseVal="offsetblur",z.operator.baseVal=SVGFECompositeElement.SVG_FECOMPOSITE_OPERATOR_IN,(z=T.appendChild(A.createElementNS(_t,"feMerge"))).appendChild(A.createElementNS(_t,"feMergeNode")),z.appendChild(A.createElementNS(_t,"feMergeNode")).in1.baseVal="SourceGraphic"),U);["elmFilter","elmOffset","elmBlur","styleFlood","elmsAppend"].forEach(function(ee){_["efc_dropShadow_"+ee]=G[ee]}),G.elmsAppend.forEach(function(ee){ne.appendChild(ee)}),_.face.setAttribute("filter","url(#"+oe+")"),Hn(_,"new_edge4viewBox",dn.dropShadow.adjustEdge),dn.dropShadow.update(_)},remove:function(_){var A=_.defs;_.efc_dropShadow_elmsAppend&&(_.efc_dropShadow_elmsAppend.forEach(function(C){A.removeChild(C)}),_.efc_dropShadow_elmFilter=_.efc_dropShadow_elmOffset=_.efc_dropShadow_elmBlur=_.efc_dropShadow_styleFlood=_.efc_dropShadow_elmsAppend=null),Wn(_,"new_edge4viewBox",dn.dropShadow.adjustEdge),mi(_,{}),_.face.removeAttribute("filter"),kn(_.aplStats,dn.dropShadow.stats)},update:function(_){var A,C,T=_.curStats,z=_.aplStats,U=z.dropShadow_options;T.dropShadow_dx=A=U.dx,lt(_,z,"dropShadow_dx",A)&&(_.efc_dropShadow_elmOffset.dx.baseVal=A,C=!0),T.dropShadow_dy=A=U.dy,lt(_,z,"dropShadow_dy",A)&&(_.efc_dropShadow_elmOffset.dy.baseVal=A,C=!0),T.dropShadow_blur=A=U.blur,lt(_,z,"dropShadow_blur",A)&&(_.efc_dropShadow_elmBlur.setStdDeviation(A,A),C=!0),C&&mi(_,{}),T.dropShadow_color=A=U.color,lt(_,z,"dropShadow_color",A)&&(_.efc_dropShadow_styleFlood.floodColor=A),T.dropShadow_opacity=A=U.opacity,lt(_,z,"dropShadow_opacity",A)&&(_.efc_dropShadow_styleFlood.floodOpacity=A)},adjustEdge:function(_,A){var C,T,z=_.curStats,U=_.aplStats;null!=z.dropShadow_dx&&((T={x1:A.x1-(C=3*z.dropShadow_blur)+z.dropShadow_dx,y1:A.y1-C+z.dropShadow_dy,x2:A.x2+C+z.dropShadow_dx,y2:A.y2+C+z.dropShadow_dy}).x1<A.x1&&(A.x1=T.x1),T.y1<A.y1&&(A.y1=T.y1),T.x2>A.x2&&(A.x2=T.x2),T.y2>A.y2&&(A.y2=T.y2),["x","y"].forEach(function(de){var ne,oe="dropShadow_"+de;z[oe]=ne=A[de+"1"],lt(_,U,oe,ne)&&(_.efc_dropShadow_elmFilter[de].baseVal.value=ne)}))}}},Object.keys(dn).forEach(function(_){var A=dn[_],C=A.stats;C[_+"_enabled"]={iniValue:!1},C[_+"_options"]={hasProps:!0},A.anim&&(C[_+"_animOptions"]={},C[_+"_animId"]={})}),wt={none:{defaultAnimOptions:{},init:function(_,A){var C=_.curStats;C.show_animId&&($t.remove(C.show_animId),C.show_animId=null),wt.none.start(_,A)},start:function(_,A){wt.none.stop(_,!0)},stop:function(_,A,C){return C=null!=C?C:_.aplStats.show_on,_.curStats.show_inAnim=!1,A&&Kr(_,C),C?1:0}},fade:{defaultAnimOptions:{duration:300,timing:"linear"},init:function(_,A){var C=_.curStats,T=_.aplStats;C.show_animId&&$t.remove(C.show_animId),C.show_animId=$t.add(function(z){return z},function(z,U){U?wt.fade.stop(_,!0):(_.svg.style.opacity=z+"",Yt&&(cn(_,_.svg),Fo(_)))},T.show_animOptions.duration,1,T.show_animOptions.timing,null,!1),wt.fade.start(_,A)},start:function(_,A){var C,T=_.curStats;T.show_inAnim&&(C=$t.stop(T.show_animId)),Kr(_,1),T.show_inAnim=!0,$t.start(T.show_animId,!_.aplStats.show_on,null!=A?A:C)},stop:function(_,A,C){var T,z=_.curStats;return C=null!=C?C:_.aplStats.show_on,T=z.show_inAnim?$t.stop(z.show_animId):C?1:0,z.show_inAnim=!1,A&&(_.svg.style.opacity=C?"":"0",Kr(_,C)),T}},draw:{defaultAnimOptions:{duration:500,timing:[.58,0,.42,1]},init:function(_,A){var C=_.curStats,T=_.aplStats,z=_.pathList.baseVal,U=$o(z),de=U.segsLen,ne=U.lenAll;C.show_animId&&$t.remove(C.show_animId),C.show_animId=$t.add(function(oe){var G,ee,ve,q,Q=-1;if(0===oe)ee=[[z[0][0],z[0][0]]];else if(1===oe)ee=z;else{for(G=ne*oe,ee=[];G>=de[++Q];)ee.push(z[Q]),G-=de[Q];G&&(2===(ve=z[Q]).length?ee.push([ve[0],Lo(ve[0],ve[1],G/de[Q])]):(q=Bi(ve[0],ve[1],ve[2],ve[3],Vi(ve[0],ve[1],ve[2],ve[3],G)),ee.push([ve[0],q.fromP1,q.fromP2,q])))}return ee},function(oe,G){G?wt.draw.stop(_,!0):(_.pathList.animVal=oe,mi(_,{path:!0}))},T.show_animOptions.duration,1,T.show_animOptions.timing,null,!1),wt.draw.start(_,A)},start:function(_,A){var C,T=_.curStats;T.show_inAnim&&(C=$t.stop(T.show_animId)),Kr(_,1),T.show_inAnim=!0,Hn(_,"apl_position",wt.draw.update),$t.start(T.show_animId,!_.aplStats.show_on,null!=A?A:C)},stop:function(_,A,C){var T,z=_.curStats;return C=null!=C?C:_.aplStats.show_on,T=z.show_inAnim?$t.stop(z.show_animId):C?1:0,z.show_inAnim=!1,A&&(_.pathList.animVal=C?null:[[_.pathList.baseVal[0][0],_.pathList.baseVal[0][0]]],mi(_,{path:!0}),Kr(_,C)),T},update:function(_){Wn(_,"apl_position",wt.draw.update),_.curStats.show_inAnim?wt.draw.init(_,wt.draw.stop(_)):_.aplStats.show_animOptions={}}}},function(){function _(A){return function(C){var T={};T[A]=C,this.setOptions(T)}}[["start","anchorSE",0],["end","anchorSE",1],["color","lineColor"],["size","lineSize"],["startSocketGravity","socketGravitySE",0],["endSocketGravity","socketGravitySE",1],["startPlugColor","plugColorSE",0],["endPlugColor","plugColorSE",1],["startPlugSize","plugSizeSE",0],["endPlugSize","plugSizeSE",1],["outline","lineOutlineEnabled"],["outlineColor","lineOutlineColor"],["outlineSize","lineOutlineSize"],["startPlugOutline","plugOutlineEnabledSE",0],["endPlugOutline","plugOutlineEnabledSE",1],["startPlugOutlineColor","plugOutlineColorSE",0],["endPlugOutlineColor","plugOutlineColorSE",1],["startPlugOutlineSize","plugOutlineSizeSE",0],["endPlugOutlineSize","plugOutlineSizeSE",1]].forEach(function(A){var C=A[0],T=A[1],z=A[2];Object.defineProperty(Mi.prototype,C,{get:function(){var U=null!=z?di[this._id].options[T][z]:T?di[this._id].options[T]:di[this._id].options[C];return null==U?pr:Si(U)},set:_(C),enumerable:!0})}),[["path",Io],["startSocket",lo,"socketSE",0],["endSocket",lo,"socketSE",1],["startPlug",Ko,"plugSE",0],["endPlug",Ko,"plugSE",1]].forEach(function(A){var C=A[0],T=A[1],z=A[2],U=A[3];Object.defineProperty(Mi.prototype,C,{get:function(){var de,ne=null!=U?di[this._id].options[z][U]:z?di[this._id].options[z]:di[this._id].options[C];return ne?Object.keys(T).some(function(oe){return T[oe]===ne&&(de=oe,!0)})?de:new Error("It's broken"):pr},set:_(C),enumerable:!0})}),Object.keys(dn).forEach(function(A){var C=dn[A];Object.defineProperty(Mi.prototype,A,{get:function(){var T,z,U=di[this._id].options[A];return Hi(U)?(T=U,z=C.optionsConf.reduce(function(de,ne){var oe,ee=ne[1],ve=ne[2],q=ne[3],Q=ne[4],$=null!=Q?T[q][Q]:q?T[q]:T[ee];return de[ee]="id"===ne[0]?$?Object.keys(ve).some(function(ue){return ve[ue]===$&&(oe=ue,!0)})?oe:new Error("It's broken"):pr:null==$?pr:Si($),de},{}),C.anim&&(z.animation=Si(T.animation)),z):U},set:_(A),enumerable:!0})}),["startLabel","endLabel","middleLabel"].forEach(function(A,C){Object.defineProperty(Mi.prototype,A,{get:function(){var T=di[this._id],z=T.options;return z.labelSEM[C]&&!T.optionIsAttach.labelSEM[C]?qn[z.labelSEM[C]._id].text:z.labelSEM[C]||""},set:_(A),enumerable:!0})})}(),Mi.prototype.setOptions=function(_){return _r(di[this._id],_),this},Mi.prototype.position=function(){return mi(di[this._id],{position:!0}),this},Mi.prototype.remove=function(){var _=di[this._id],A=_.curStats;Object.keys(dn).forEach(function(C){var T=C+"_animId";A[T]&&$t.remove(A[T])}),A.show_animId&&$t.remove(A.show_animId),_.attachments.slice().forEach(function(C){Do(_,C)}),_.baseWindow&&_.svg&&_.baseWindow.document.body.removeChild(_.svg),delete di[this._id]},Mi.prototype.show=function(_,A){return $r(di[this._id],!0,_,A),this},Mi.prototype.hide=function(_,A){return $r(di[this._id],!1,_,A),this},dr=function(_){_&&qn[_._id]&&(_.boundTargets.slice().forEach(function(A){Do(A.props,_,!0)}),_.conf.remove&&_.conf.remove(_),delete qn[_._id])},vn=function(){function _(A,C){var T,z={conf:A,curStats:{},aplStats:{},boundTargets:[]},U={};A.argOptions.every(function(de){return!(!C.length||("string"==typeof de.type?typeof C[0]!==de.type:"function"!=typeof de.type||!de.type(C[0]))||(U[de.optionName]=C.shift(),0))}),T=C.length&&Hi(C[0])?Si(C[0]):{},Object.keys(U).forEach(function(de){T[de]=U[de]}),A.stats&&(kn(z.curStats,A.stats),kn(z.aplStats,A.stats)),Object.defineProperty(this,"_id",{value:++Ba}),Object.defineProperty(this,"isRemoved",{get:function(){return!qn[this._id]}}),z._id=this._id,A.init&&!A.init(z,T)||(qn[this._id]=z)}return _.prototype.remove=function(){var A=this,C=qn[A._id];C&&(C.boundTargets.slice().forEach(function(T){C.conf.removeOption(C,T)}),gr(function(){var T=qn[A._id];T&&(console.error("LeaderLineAttachment was not removed by removeOption"),dr(T))}))},_}(),window.LeaderLineAttachment=vn,tr=function(_,A){return _ instanceof vn&&(!(_.isRemoved||A&&qn[_._id].conf.type!==A)||null)},tt={pointAnchor:{type:"anchor",argOptions:[{optionName:"element",type:Wi}],init:function(_,A){return _.element=tt.pointAnchor.checkElement(A.element),_.x=tt.pointAnchor.parsePercent(A.x,!0)||[.5,!0],_.y=tt.pointAnchor.parsePercent(A.y,!0)||[.5,!0],!0},removeOption:function(_,A){var C=A.props,T={},z=_.element,U=C.options.anchorSE["start"===A.optionName?1:0];z===U&&(z=U===document.body?new vn(tt.pointAnchor,[z]):document.body),T[A.optionName]=z,_r(C,T)},getBBoxNest:function(_,A){var C=No(_.element,A.baseWindow),T=C.width,z=C.height;return C.width=C.height=0,C.left=C.right=C.left+_.x[0]*(_.x[1]?T:1),C.top=C.bottom=C.top+_.y[0]*(_.y[1]?z:1),C},parsePercent:function(_,A){var C,T,z=!1;return un(_)?T=_:"string"==typeof _&&(C=Da.exec(_))&&C[2]&&(z=0!=(T=parseFloat(C[1])/100)),null!=T&&(A||0<=T)?[T,z]:null},checkElement:function(_){if(null==_)_=document.body;else if(!Wi(_))throw new Error("`element` must be Element");return _}},areaAnchor:{type:"anchor",argOptions:[{optionName:"element",type:Wi},{optionName:"shape",type:"string"}],stats:{color:{},strokeWidth:{},elementWidth:{},elementHeight:{},elementLeft:{},elementTop:{},pathListRel:{},bBoxRel:{},pathData:{},viewBoxBBox:{hasProps:!0},dashLen:{},dashGap:{}},init:function(_,A){var C,T,z,U=[];return _.element=tt.pointAnchor.checkElement(A.element),"string"==typeof A.color&&(_.color=A.color.trim()),"string"==typeof A.fillColor&&(_.fill=A.fillColor.trim()),un(A.size)&&0<=A.size&&(_.size=A.size),A.dash&&(_.dash=!0,un(A.dash.len)&&0<A.dash.len&&(_.dashLen=A.dash.len),un(A.dash.gap)&&0<A.dash.gap&&(_.dashGap=A.dash.gap)),"circle"===A.shape?_.shape=A.shape:"polygon"===A.shape&&Array.isArray(A.points)&&3<=A.points.length&&A.points.every(function(de){var ne={};return!(!(ne.x=tt.pointAnchor.parsePercent(de[0],!0))||!(ne.y=tt.pointAnchor.parsePercent(de[1],!0))||(U.push(ne),(ne.x[1]||ne.y[1])&&(_.hasRatio=!0),0))})?(_.shape=A.shape,_.points=U):(_.shape="rect",_.radius=un(A.radius)&&0<=A.radius?A.radius:0),"rect"!==_.shape&&"circle"!==_.shape||(_.x=tt.pointAnchor.parsePercent(A.x,!0)||[-.05,!0],_.y=tt.pointAnchor.parsePercent(A.y,!0)||[-.05,!0],_.width=tt.pointAnchor.parsePercent(A.width)||[1.1,!0],_.height=tt.pointAnchor.parsePercent(A.height)||[1.1,!0],(_.x[1]||_.y[1]||_.width[1]||_.height[1])&&(_.hasRatio=!0)),_.svg=T=(C=_.element.ownerDocument).createElementNS(_t,"svg"),T.className.baseVal=ui+"-areaAnchor",T.viewBox.baseVal||T.setAttribute("viewBox","0 0 0 0"),_.path=T.appendChild(C.createElementNS(_t,"path")),_.path.style.fill=_.fill||"none",_.isShown=!1,T.style.visibility="hidden",C.body.appendChild(T),Ti(z=C.defaultView),_.bodyOffset=fn(z),_.updateColor=function(){var de,oe=_.aplStats,G=_.boundTargets.length?_.boundTargets[0].props.curStats:null;_.curStats.color=de=_.color||(G?G.line_color:Qn.lineColor),lt(_,oe,"color",de)&&(_.path.style.stroke=de)},_.updateShow=function(){Kr(_,_.boundTargets.some(function(de){return!0===de.props.isShown}))},!0},bind:function(_,A){var C=A.props;return _.color||Hn(C,"cur_line_color",_.updateColor),Hn(C,"svgShow",_.updateShow),gr(function(){_.updateColor(),_.updateShow()}),!0},unbind:function(_,A){var C=A.props;_.color||Wn(C,"cur_line_color",_.updateColor),Wn(C,"svgShow",_.updateShow),1<_.boundTargets.length&&gr(function(){_.updateColor(),_.updateShow(),tt.areaAnchor.update(_)&&_.boundTargets.forEach(function(T){mi(T.props,{position:!0})})})},removeOption:function(_,A){tt.pointAnchor.removeOption(_,A)},remove:function(_){_.boundTargets.length&&(console.error("LeaderLineAttachment was not unbound by remove"),_.boundTargets.forEach(function(A){tt.areaAnchor.unbind(_,A)})),_.svg.parentNode.removeChild(_.svg)},getStrokeWidth:function(_,A){return tt.areaAnchor.update(_)&&1<_.boundTargets.length&&gr(function(){_.boundTargets.forEach(function(C){C.props!==A&&mi(C.props,{position:!0})})}),_.curStats.strokeWidth},getPathData:function(_,A){var C=No(_.element,A.baseWindow);return _i(_.curStats.pathListRel,function(T){T.x+=C.left,T.y+=C.top})},getBBoxNest:function(_,A){var C=No(_.element,A.baseWindow),T=_.curStats.bBoxRel;return{left:T.left+C.left,top:T.top+C.top,right:T.right+C.left,bottom:T.bottom+C.top,width:T.width,height:T.height}},update:function(_){var A,C,T,z,U,de,ne,oe,G,ee,ve,q,Q,$,ue,ge,Se,Oe,Ce,fe,ie,le,ae,st,ht,it,H,be,I,ye,Pe,R,F=_.curStats,E=_.aplStats,k=_.boundTargets.length?_.boundTargets[0].props.curStats:null,O={};if(O.strokeWidth=lt(_,F,"strokeWidth",null!=_.size?_.size:k?k.line_strokeWidth:Qn.lineSize),A=Rr(_.element),O.elementWidth=lt(_,F,"elementWidth",A.width),O.elementHeight=lt(_,F,"elementHeight",A.height),O.elementLeft=lt(_,F,"elementLeft",A.left),O.elementTop=lt(_,F,"elementTop",A.top),O.strokeWidth||_.hasRatio&&(O.elementWidth||O.elementHeight)){switch(_.shape){case"rect":(fe={left:_.x[0]*(_.x[1]?A.width:1),top:_.y[0]*(_.y[1]?A.height:1),width:_.width[0]*(_.width[1]?A.width:1),height:_.height[0]*(_.height[1]?A.height:1)}).right=fe.left+fe.width,fe.bottom=fe.top+fe.height,st=F.strokeWidth/2,le=(ae=Math.min(fe.width,fe.height))?ae/2*Math.SQRT2+st:0,(ie=_.radius?_.radius<=le?_.radius:le:0)?(it=ie-(ht=(ie-st)/Math.SQRT2),F.pathListRel=[[(H=[{x:fe.left-it,y:fe.top+ht},{x:fe.left+ht,y:fe.top-it},{x:fe.right-ht,y:fe.top-it},{x:fe.right+it,y:fe.top+ht},{x:fe.right+it,y:fe.bottom-ht},{x:fe.right-ht,y:fe.bottom+it},{x:fe.left+ht,y:fe.bottom+it},{x:fe.left-it,y:fe.bottom-ht}])[0],{x:H[0].x,y:H[0].y-(be=ie*Jr)},{x:H[1].x-be,y:H[1].y},H[1]]],H[1].x!==H[2].x&&F.pathListRel.push([H[1],H[2]]),F.pathListRel.push([H[2],{x:H[2].x+be,y:H[2].y},{x:H[3].x,y:H[3].y-be},H[3]]),H[3].y!==H[4].y&&F.pathListRel.push([H[3],H[4]]),F.pathListRel.push([H[4],{x:H[4].x,y:H[4].y+be},{x:H[5].x+be,y:H[5].y},H[5]]),H[5].x!==H[6].x&&F.pathListRel.push([H[5],H[6]]),F.pathListRel.push([H[6],{x:H[6].x-be,y:H[6].y},{x:H[7].x,y:H[7].y+be},H[7]]),H[7].y!==H[0].y&&F.pathListRel.push([H[7],H[0]]),F.pathListRel.push([]),H=[{x:fe.left-(it=ie-ht+F.strokeWidth/2),y:fe.top-it},{x:fe.right+it,y:fe.bottom+it}]):(F.pathListRel=[[(H=[{x:fe.left-(it=F.strokeWidth/2),y:fe.top-it},{x:fe.right+it,y:fe.bottom+it}])[0],{x:H[1].x,y:H[0].y}],[{x:H[1].x,y:H[0].y},H[1]],[H[1],{x:H[0].x,y:H[1].y}],[]],H=[{x:fe.left-F.strokeWidth,y:fe.top-F.strokeWidth},{x:fe.right+F.strokeWidth,y:fe.bottom+F.strokeWidth}]),F.bBoxRel={left:H[0].x,top:H[0].y,right:H[1].x,bottom:H[1].y,width:H[1].x-H[0].x,height:H[1].y-H[0].y};break;case"circle":(ne={left:_.x[0]*(_.x[1]?A.width:1),top:_.y[0]*(_.y[1]?A.height:1),width:_.width[0]*(_.width[1]?A.width:1),height:_.height[0]*(_.height[1]?A.height:1)}).width||ne.height||(ne.width=ne.height=10),ne.width||(ne.width=ne.height),ne.height||(ne.height=ne.width),ne.right=ne.left+ne.width,ne.bottom=ne.top+ne.height,oe=ne.left+ne.width/2,G=ne.top+ne.height/2,$=F.strokeWidth/2,ge=ne.height/2,ee=(ue=ne.width/2)*Math.SQRT2+$,ve=ge*Math.SQRT2+$,F.pathListRel=[[(Ce=[{x:oe-ee,y:G},{x:oe,y:G-ve},{x:oe+ee,y:G},{x:oe,y:G+ve}])[0],{x:Ce[0].x,y:Ce[0].y-(Q=ve*Jr)},{x:Ce[1].x-(q=ee*Jr),y:Ce[1].y},Ce[1]],[Ce[1],{x:Ce[1].x+q,y:Ce[1].y},{x:Ce[2].x,y:Ce[2].y-Q},Ce[2]],[Ce[2],{x:Ce[2].x,y:Ce[2].y+Q},{x:Ce[3].x+q,y:Ce[3].y},Ce[3]],[Ce[3],{x:Ce[3].x-q,y:Ce[3].y},{x:Ce[0].x,y:Ce[0].y+Q},Ce[0]],[]],F.bBoxRel={left:(Ce=[{x:ne.left-(Se=ee-ue+F.strokeWidth/2),y:ne.top-(Oe=ve-ge+F.strokeWidth/2)},{x:ne.right+Se,y:ne.bottom+Oe}])[0].x,top:Ce[0].y,right:Ce[1].x,bottom:Ce[1].y,width:Ce[1].x-Ce[0].x,height:Ce[1].y-Ce[0].y};break;case"polygon":_.points.forEach(function(te){var Xe=te.x[0]*(te.x[1]?A.width:1),Rt=te.y[0]*(te.y[1]?A.height:1);T?(Xe<T.left&&(T.left=Xe),Xe>T.right&&(T.right=Xe),Rt<T.top&&(T.top=Rt),Rt>T.bottom&&(T.bottom=Rt)):T={left:Xe,right:Xe,top:Rt,bottom:Rt},z?F.pathListRel.push([z,{x:Xe,y:Rt}]):F.pathListRel=[],z={x:Xe,y:Rt}}),F.pathListRel.push([]),F.bBoxRel={left:(de=[{x:T.left-(U=F.strokeWidth/2),y:T.top-U},{x:T.right+U,y:T.bottom+U}])[0].x,top:de[0].y,right:de[1].x,bottom:de[1].y,width:de[1].x-de[0].x,height:de[1].y-de[0].y}}O.pathListRel=O.bBoxRel=!0}return(O.pathListRel||O.elementLeft||O.elementTop)&&(F.pathData=_i(F.pathListRel,function(te){te.x+=A.left,te.y+=A.top})),lt(_,E,"strokeWidth",C=F.strokeWidth)&&(_.path.style.strokeWidth=C+"px"),Ln(C=F.pathData,E.pathData)&&(_.path.setPathData(C),E.pathData=C,O.pathData=!0),_.dash&&(!O.pathData&&(!O.strokeWidth||_.dashLen&&_.dashGap)||(F.dashLen=_.dashLen||2*F.strokeWidth,F.dashGap=_.dashGap||F.strokeWidth),O.dash=lt(_,E,"dashLen",F.dashLen)||O.dash,O.dash=lt(_,E,"dashGap",F.dashGap)||O.dash,O.dash&&(_.path.style.strokeDasharray=E.dashLen+","+E.dashGap)),ye=E.viewBoxBBox,Pe=_.svg.viewBox.baseVal,R=_.svg.style,(I=F.viewBoxBBox).x=F.bBoxRel.left+A.left,I.y=F.bBoxRel.top+A.top,I.width=F.bBoxRel.width,I.height=F.bBoxRel.height,["x","y","width","height"].forEach(function(te){(C=I[te])!==ye[te]&&(Pe[te]=ye[te]=C,R[li[te]]=C+("x"===te||"y"===te?_.bodyOffset[te]:0)+"px")}),O.strokeWidth||O.pathListRel||O.bBoxRel}},mouseHoverAnchor:{type:"anchor",argOptions:[{optionName:"element",type:Wi},{optionName:"showEffectName",type:"string"}],style:{backgroundImage:"url('data:image/svg+xml;charset=utf-8;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0Ij48cG9seWdvbiBwb2ludHM9IjI0LDAgMCw4IDgsMTEgMCwxOSA1LDI0IDEzLDE2IDE2LDI0IiBmaWxsPSJjb3JhbCIvPjwvc3ZnPg==')",backgroundSize:"",backgroundRepeat:"no-repeat",backgroundColor:"#f8f881",cursor:"default"},hoverStyle:{backgroundImage:"none",backgroundColor:"#fadf8f"},padding:{top:1,right:15,bottom:1,left:2},minHeight:15,backgroundPosition:{right:2,top:2},backgroundSize:{width:12,height:12},dirKeys:[["top","Top"],["right","Right"],["bottom","Bottom"],["left","Left"]],init:function(_,A){var C,T,z,U,de,ne,oe,G,ee,ve,q,Q=tt.mouseHoverAnchor,$={};if(_.element=tt.pointAnchor.checkElement(A.element),!((ve=(G=_.element).ownerDocument)&&(ee=ve.defaultView)&&ee.HTMLElement&&G instanceof ee.HTMLElement))throw new Error("`element` must be HTML element");return Q.style.backgroundSize=Q.backgroundSize.width+"px "+Q.backgroundSize.height+"px",["style","hoverStyle"].forEach(function(ue){var ge=Q[ue];_[ue]=Object.keys(ge).reduce(function(Se,Oe){return Se[Oe]=ge[Oe],Se},{})}),"inline"===(C=_.element.ownerDocument.defaultView.getComputedStyle(_.element,"")).display?_.style.display="inline-block":"none"===C.display&&(_.style.display="block"),tt.mouseHoverAnchor.dirKeys.forEach(function(ue){var ge=ue[0],Se="padding"+ue[1];parseFloat(C[Se])<Q.padding[ge]&&(_.style[Se]=Q.padding[ge]+"px")}),_.style.display&&(U=_.element.style.display,_.element.style.display=_.style.display),tt.mouseHoverAnchor.dirKeys.forEach(function(ue){var ge="padding"+ue[1];_.style[ge]&&($[ge]=_.element.style[ge],_.element.style[ge]=_.style[ge])}),(z=_.element.getBoundingClientRect()).height<Q.minHeight&&(Yt?(q=Q.minHeight,"content-box"===C.boxSizing?q-=parseFloat(C.borderTopWidth)+parseFloat(C.borderBottomWidth)+parseFloat(C.paddingTop)+parseFloat(C.paddingBottom):"padding-box"===C.boxSizing&&(q-=parseFloat(C.borderTopWidth)+parseFloat(C.borderBottomWidth)),_.style.height=q+"px"):_.style.height=parseFloat(C.height)+(Q.minHeight-z.height)+"px"),_.style.backgroundPosition=En?z.width-Q.backgroundSize.width-Q.backgroundPosition.right+"px "+Q.backgroundPosition.top+"px":"right "+Q.backgroundPosition.right+"px top "+Q.backgroundPosition.top+"px",_.style.display&&(_.element.style.display=U),tt.mouseHoverAnchor.dirKeys.forEach(function(ue){var ge="padding"+ue[1];_.style[ge]&&(_.element.style[ge]=$[ge])}),["style","hoverStyle"].forEach(function(ue){var ge=_[ue],Se=A[ue];Hi(Se)&&Object.keys(Se).forEach(function(Oe){"string"==typeof Se[Oe]||un(Se[Oe])?ge[Oe]=Se[Oe]:null==Se[Oe]&&delete ge[Oe]})}),"function"==typeof A.onSwitch&&(oe=A.onSwitch),A.showEffectName&&wt[A.showEffectName]&&(_.showEffectName=de=A.showEffectName),ne=A.animOptions,_.elmStyle=T=_.element.style,_.mouseenter=function(ue){_.hoverStyleSave=Q.getStyles(T,Object.keys(_.hoverStyle)),Q.setStyles(T,_.hoverStyle),_.boundTargets.forEach(function(ge){$r(ge.props,!0,de,ne)}),oe&&oe(ue)},_.mouseleave=function(ue){Q.setStyles(T,_.hoverStyleSave),_.boundTargets.forEach(function(ge){$r(ge.props,!1,de,ne)}),oe&&oe(ue)},!0},bind:function(_,A){var C,T,z,U,de;return A.props.svg?tt.mouseHoverAnchor.llShow(A.props,!1,_.showEffectName):gr(function(){tt.mouseHoverAnchor.llShow(A.props,!1,_.showEffectName)}),_.enabled||(_.styleSave=tt.mouseHoverAnchor.getStyles(_.elmStyle,Object.keys(_.style)),tt.mouseHoverAnchor.setStyles(_.elmStyle,_.style),_.removeEventListener=(T=_.mouseenter,z=_.mouseleave,"onmouseenter"in(C=_.element)&&"onmouseleave"in C?(C.addEventListener("mouseenter",T,!1),C.addEventListener("mouseleave",z,!1),function(){C.removeEventListener("mouseenter",T,!1),C.removeEventListener("mouseleave",z,!1)}):(console.warn("mouseenter and mouseleave events polyfill is enabled."),C.addEventListener("mouseover",U=function(ne){ne.relatedTarget&&(ne.relatedTarget===this||this.compareDocumentPosition(ne.relatedTarget)&Node.DOCUMENT_POSITION_CONTAINED_BY)||T.apply(this,arguments)}),C.addEventListener("mouseout",de=function(ne){ne.relatedTarget&&(ne.relatedTarget===this||this.compareDocumentPosition(ne.relatedTarget)&Node.DOCUMENT_POSITION_CONTAINED_BY)||z.apply(this,arguments)}),function(){C.removeEventListener("mouseover",U,!1),C.removeEventListener("mouseout",de,!1)})),_.enabled=!0),!0},unbind:function(_,A){_.enabled&&_.boundTargets.length<=1&&(_.removeEventListener(),tt.mouseHoverAnchor.setStyles(_.elmStyle,_.styleSave),_.enabled=!1),tt.mouseHoverAnchor.llShow(A.props,!0,_.showEffectName)},removeOption:function(_,A){tt.pointAnchor.removeOption(_,A)},remove:function(_){_.boundTargets.length&&(console.error("LeaderLineAttachment was not unbound by remove"),_.boundTargets.forEach(function(A){tt.mouseHoverAnchor.unbind(_,A)}))},getBBoxNest:function(_,A){return No(_.element,A.baseWindow)},llShow:function(_,A,C){wt[C||_.curStats.show_effect].stop(_,!0,A),_.aplStats.show_on=A},getStyles:function(_,A){return A.reduce(function(C,T){return C[T]=_[T],C},{})},setStyles:function(_,A){Object.keys(A).forEach(function(C){_[C]=A[C]})}},captionLabel:{type:"label",argOptions:[{optionName:"text",type:"string"}],stats:{color:{},x:{},y:{}},textStyleProps:["fontFamily","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","kerning","letterSpacing","wordSpacing","textDecoration"],init:function(_,A){return"string"==typeof A.text&&(_.text=A.text.trim()),!!_.text&&("string"==typeof A.color&&(_.color=A.color.trim()),_.outlineColor="string"==typeof A.outlineColor?A.outlineColor.trim():"#fff",Array.isArray(A.offset)&&un(A.offset[0])&&un(A.offset[1])&&(_.offset={x:A.offset[0],y:A.offset[1]}),un(A.lineOffset)&&(_.lineOffset=A.lineOffset),tt.captionLabel.textStyleProps.forEach(function(C){null!=A[C]&&(_[C]=A[C])}),_.updateColor=function(C){tt.captionLabel.updateColor(_,C)},_.updateSocketXY=function(C){var T,z,U,de,ne=_.curStats,oe=_.aplStats,G=C.curStats,ee=G.position_socketXYSE[_.socketIndex];null!=ee.x&&(_.offset?(ne.x=ee.x+_.offset.x,ne.y=ee.y+_.offset.y):(T=_.height/2,z=Math.max(G.attach_plugSideLenSE[_.socketIndex]||0,G.line_strokeWidth/2),U=G.position_socketXYSE[_.socketIndex?0:1],4===ee.socketId||2===ee.socketId?(ne.x=4===ee.socketId?ee.x-T-_.width:ee.x+T,ne.y=U.y<ee.y?ee.y+z+T:ee.y-z-T-_.height):(ne.x=U.x<ee.x?ee.x+z+T:ee.x-z-T-_.width,ne.y=1===ee.socketId?ee.y-T-_.height:ee.y+T)),lt(_,oe,"x",de=ne.x)&&(_.elmPosition.x.baseVal.getItem(0).value=de),lt(_,oe,"y",de=ne.y)&&(_.elmPosition.y.baseVal.getItem(0).value=de+_.height))},_.updatePath=function(C){var T,z,U=_.curStats,de=_.aplStats,ne=C.pathList.animVal||C.pathList.baseVal;ne&&(T=tt.captionLabel.getMidPoint(ne,_.lineOffset),U.x=T.x-_.width/2,U.y=T.y-_.height/2,lt(_,de,"x",z=U.x)&&(_.elmPosition.x.baseVal.getItem(0).value=z),lt(_,de,"y",z=U.y)&&(_.elmPosition.y.baseVal.getItem(0).value=z+_.height))},_.updateShow=function(C){tt.captionLabel.updateShow(_,C)},En&&(_.adjustEdge=function(C,T){var z=_.curStats;null!=z.x&&tt.captionLabel.adjustEdge(T,{x:z.x,y:z.y,width:_.width,height:_.height},_.strokeWidth/2)}),!0)},updateColor:function(_,A){var C,z=_.aplStats;_.curStats.color=C=_.color||A.curStats.line_color,lt(_,z,"color",C)&&(_.styleFill.fill=C)},updateShow:function(_,A){var C=!0===A.isShown;C!==_.isShown&&(_.styleShow.visibility=C?"":"hidden",_.isShown=C)},adjustEdge:function(_,A,C){var T={x1:A.x-C,y1:A.y-C,x2:A.x+A.width+C,y2:A.y+A.height+C};T.x1<_.x1&&(_.x1=T.x1),T.y1<_.y1&&(_.y1=T.y1),T.x2>_.x2&&(_.x2=T.x2),T.y2>_.y2&&(_.y2=T.y2)},newText:function(_,A,C,T,z){var U,de,ne,oe,G,ee;return(U=A.createElementNS(_t,"text")).textContent=_,[U.x,U.y].forEach(function(ve){var q=C.createSVGLength();q.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX,0),ve.baseVal.initialize(q)}),"boolean"!=typeof cr&&(cr="paintOrder"in U.style),z&&!cr?(ne=A.createElementNS(_t,"defs"),U.id=T,ne.appendChild(U),(G=(de=A.createElementNS(_t,"g")).appendChild(A.createElementNS(_t,"use"))).href.baseVal="#"+T,(oe=de.appendChild(A.createElementNS(_t,"use"))).href.baseVal="#"+T,(ee=G.style).strokeLinejoin="round",{elmPosition:U,styleText:U.style,styleFill:oe.style,styleStroke:ee,styleShow:de.style,elmsAppend:[ne,de]}):(ee=U.style,z&&(ee.strokeLinejoin="round",ee.paintOrder="stroke"),{elmPosition:U,styleText:ee,styleFill:ee,styleStroke:z?ee:null,styleShow:ee,elmsAppend:[U]})},getMidPoint:function(_,A){var C,T,z,U=$o(_),de=U.segsLen,ne=U.lenAll,oe=-1;if((C=ne/2+(A||0))<=0)return 2===(T=_[0]).length?Lo(T[0],T[1],0):Bi(T[0],T[1],T[2],T[3],0);if(ne<=C)return 2===(T=_[_.length-1]).length?Lo(T[0],T[1],1):Bi(T[0],T[1],T[2],T[3],1);for(z=[];C>de[++oe];)z.push(_[oe]),C-=de[oe];return 2===(T=_[oe]).length?Lo(T[0],T[1],C/de[oe]):Bi(T[0],T[1],T[2],T[3],Vi(T[0],T[1],T[2],T[3],C))},initSvg:function(_,A){var C,T,z=tt.captionLabel.newText(_.text,A.baseWindow.document,A.svg,ui+"-captionLabel-"+_._id,_.outlineColor);["elmPosition","styleFill","styleShow","elmsAppend"].forEach(function(U){_[U]=z[U]}),_.isShown=!1,_.styleShow.visibility="hidden",tt.captionLabel.textStyleProps.forEach(function(U){null!=_[U]&&(z.styleText[U]=_[U])}),z.elmsAppend.forEach(function(U){A.svg.appendChild(U)}),C=z.elmPosition.getBBox(),_.width=C.width,_.height=C.height,_.outlineColor&&(T=10<(T=C.height/9)?10:T<2?2:T,z.styleStroke.strokeWidth=T+"px",z.styleStroke.stroke=_.outlineColor),_.strokeWidth=T||0,kn(_.aplStats,tt.captionLabel.stats),_.updateColor(A),_.refSocketXY?_.updateSocketXY(A):_.updatePath(A),En&&mi(A,{}),_.updateShow(A)},bind:function(_,A){var C=A.props;return _.color||Hn(C,"cur_line_color",_.updateColor),(_.refSocketXY="startLabel"===A.optionName||"endLabel"===A.optionName)?(_.socketIndex="startLabel"===A.optionName?0:1,Hn(C,"apl_position",_.updateSocketXY),_.offset||(Hn(C,"cur_attach_plugSideLenSE",_.updateSocketXY),Hn(C,"cur_line_strokeWidth",_.updateSocketXY))):Hn(C,"apl_path",_.updatePath),Hn(C,"svgShow",_.updateShow),En&&Hn(C,"new_edge4viewBox",_.adjustEdge),tt.captionLabel.initSvg(_,C),!0},unbind:function(_,A){var C=A.props;_.elmsAppend&&(_.elmsAppend.forEach(function(T){C.svg.removeChild(T)}),_.elmPosition=_.styleFill=_.styleShow=_.elmsAppend=null),kn(_.curStats,tt.captionLabel.stats),kn(_.aplStats,tt.captionLabel.stats),_.color||Wn(C,"cur_line_color",_.updateColor),_.refSocketXY?(Wn(C,"apl_position",_.updateSocketXY),_.offset||(Wn(C,"cur_attach_plugSideLenSE",_.updateSocketXY),Wn(C,"cur_line_strokeWidth",_.updateSocketXY))):Wn(C,"apl_path",_.updatePath),Wn(C,"svgShow",_.updateShow),En&&(Wn(C,"new_edge4viewBox",_.adjustEdge),mi(C,{}))},removeOption:function(_,A){var C=A.props,T={};T[A.optionName]="",_r(C,T)},remove:function(_){_.boundTargets.length&&(console.error("LeaderLineAttachment was not unbound by remove"),_.boundTargets.forEach(function(A){tt.captionLabel.unbind(_,A)}))}},pathLabel:{type:"label",argOptions:[{optionName:"text",type:"string"}],stats:{color:{},startOffset:{},pathData:{}},init:function(_,A){return"string"==typeof A.text&&(_.text=A.text.trim()),!!_.text&&("string"==typeof A.color&&(_.color=A.color.trim()),_.outlineColor="string"==typeof A.outlineColor?A.outlineColor.trim():"#fff",un(A.lineOffset)&&(_.lineOffset=A.lineOffset),tt.captionLabel.textStyleProps.forEach(function(C){null!=A[C]&&(_[C]=A[C])}),_.updateColor=function(C){tt.captionLabel.updateColor(_,C)},_.updatePath=function(C){var T,U=_.aplStats,ne=C.pathList.animVal||C.pathList.baseVal;ne&&(_.curStats.pathData=T=tt.pathLabel.getOffsetPathData(ne,C.curStats.line_strokeWidth/2+_.strokeWidth/2+_.height/4,1.25*_.height),Ln(T,U.pathData)&&(_.elmPath.setPathData(T),U.pathData=T,_.bBox=_.elmPosition.getBBox(),_.updateStartOffset(C)))},_.updateStartOffset=function(C){var T,z,U,de,ne=_.curStats,oe=_.aplStats,G=C.curStats;ne.pathData&&(2!==_.semIndex||_.lineOffset)&&(T=ne.pathData.reduce(function(ee,ve){var q,Q=ve.values;switch(ve.type){case"M":de={x:Q[0],y:Q[1]};break;case"L":q={x:Q[0],y:Q[1]},de&&(ee+=Kn(de,q)),de=q;break;case"C":q={x:Q[4],y:Q[5]},de&&(ee+=po(de,{x:Q[0],y:Q[1]},{x:Q[2],y:Q[3]},q)),de=q}return ee},0),U=0===_.semIndex?0:1===_.semIndex?T:T/2,2!==_.semIndex&&(z=Math.max(G.attach_plugBackLenSE[_.semIndex]||0,G.line_strokeWidth/2)+_.strokeWidth/2+_.height/4,U=(U+=0===_.semIndex?z:-z)<0?0:T<U?T:U),_.lineOffset&&(U=(U+=_.lineOffset)<0?0:T<U?T:U),ne.startOffset=U,lt(_,oe,"startOffset",U)&&(_.elmOffset.startOffset.baseVal.value=U))},_.updateShow=function(C){tt.captionLabel.updateShow(_,C)},En&&(_.adjustEdge=function(C,T){_.bBox&&tt.captionLabel.adjustEdge(T,_.bBox,_.strokeWidth/2)}),!0)},getOffsetPathData:function(_,A,C){var T,z,de=[];function ne(oe,G){return Math.abs(oe.x-G.x)<3&&Math.abs(oe.y-G.y)<3}return _.forEach(function(oe){var G,ee,ve,q,Q,$,ue,ge,Se,Oe,Ce,fe,ie,le,ae,st,ht,it,H,be,I;2===oe.length?(it=oe[0],H=oe[1],be=A,I=Math.atan2(it.y-H.y,H.x-it.x)+.5*Math.PI,G=[{x:it.x+Math.cos(I)*be,y:it.y+Math.sin(I)*be*-1},{x:H.x+Math.cos(I)*be,y:H.y+Math.sin(I)*be*-1}],T?(ve=T.points,0<=(q=Math.atan2(ve[1].y-ve[0].y,ve[0].x-ve[1].x)-Math.atan2(oe[0].y-oe[1].y,oe[1].x-oe[0].x))&&q<=Math.PI?ee={type:"line",points:G,inside:!0}:($=Yi(ve[0],ve[1],A),Q=Yi(G[1],G[0],A),fe=(Se=$).x-(ge=ve[0]).x,ht=((le=(Ce=G[1]).x-(Oe=Q).x)*(ge.y-Oe.y)-(ae=Ce.y-Oe.y)*(ge.x-Oe.x))/(-le*(ie=Se.y-ge.y)+fe*ae),(ue=0<=(st=(-ie*(ge.x-Oe.x)+fe*(ge.y-Oe.y))/(-le*ie+fe*ae))&&st<=1&&0<=ht&&ht<=1?{x:ge.x+ht*fe,y:ge.y+ht*ie}:null)?ee={type:"line",points:[ve[1]=ue,G[1]]}:(ve[1]=ne(Q,$)?Q:$,ee={type:"line",points:[Q,G[1]]}),T.len=Kn(ve[0],ve[1]))):ee={type:"line",points:G},ee.len=Kn(ee.points[0],ee.points[1]),de.push(T=ee)):(de.push({type:"cubic",points:function(ye,Pe,R,F,E,k){for(var O,te,Xe=po(ye,Pe,R,F)/16,Rt=1/(16<E?Xe*(E/16):Xe),Xt=[],Bn=0;te=(90-(O=Bi(ye,Pe,R,F,Bn)).angle)*(Math.PI/180),Xt.push({x:O.x+Math.cos(te)*E,y:O.y+Math.sin(te)*E*-1}),!(1<=Bn);)1<(Bn+=Rt)&&(Bn=1);return Xt}(oe[0],oe[1],oe[2],oe[3],A)}),T=null)}),T=null,de.forEach(function(oe){var G;"line"===oe.type?(oe.inside&&(T.len>A?((G=T.points)[1]=Yi(G[0],G[1],-A),T.len=Kn(G[0],G[1])):(T.points=null,T.len=0),oe.len>A+C?((G=oe.points)[0]=Yi(G[1],G[0],-(A+C)),oe.len=Kn(G[0],G[1])):(oe.points=null,oe.len=0)),T=oe):T=null}),de.reduce(function(oe,G){var ee=G.points;return ee&&(z&&ne(ee[0],z)||oe.push({type:"M",values:[ee[0].x,ee[0].y]}),"line"===G.type?oe.push({type:"L",values:[ee[1].x,ee[1].y]}):(ee.shift(),ee.forEach(function(ve){oe.push({type:"L",values:[ve.x,ve.y]})})),z=ee[ee.length-1]),oe},[])},newText:function(_,A,C,T){var z,U,de,ne,oe,G,ee,ve,q,Q;return(ne=(de=A.createElementNS(_t,"defs")).appendChild(A.createElementNS(_t,"path"))).id=z=C+"-path",(G=(oe=A.createElementNS(_t,"text")).appendChild(A.createElementNS(_t,"textPath"))).href.baseVal="#"+z,G.startOffset.baseVal.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX,0),G.textContent=_,"boolean"!=typeof cr&&(cr="paintOrder"in oe.style),T&&!cr?(oe.id=U=C+"-text",de.appendChild(oe),(q=(ee=A.createElementNS(_t,"g")).appendChild(A.createElementNS(_t,"use"))).href.baseVal="#"+U,(ve=ee.appendChild(A.createElementNS(_t,"use"))).href.baseVal="#"+U,(Q=q.style).strokeLinejoin="round",{elmPosition:oe,elmPath:ne,elmOffset:G,styleText:oe.style,styleFill:ve.style,styleStroke:Q,styleShow:ee.style,elmsAppend:[de,ee]}):(Q=oe.style,T&&(Q.strokeLinejoin="round",Q.paintOrder="stroke"),{elmPosition:oe,elmPath:ne,elmOffset:G,styleText:Q,styleFill:Q,styleStroke:T?Q:null,styleShow:Q,elmsAppend:[de,oe]})},initSvg:function(_,A){var C,T,z=tt.pathLabel.newText(_.text,A.baseWindow.document,ui+"-pathLabel-"+_._id,_.outlineColor);["elmPosition","elmPath","elmOffset","styleFill","styleShow","elmsAppend"].forEach(function(U){_[U]=z[U]}),_.isShown=!1,_.styleShow.visibility="hidden",tt.captionLabel.textStyleProps.forEach(function(U){null!=_[U]&&(z.styleText[U]=_[U])}),z.elmsAppend.forEach(function(U){A.svg.appendChild(U)}),z.elmPath.setPathData([{type:"M",values:[0,100]},{type:"h",values:[100]}]),C=z.elmPosition.getBBox(),z.styleText.textAnchor=["start","end","middle"][_.semIndex],2!==_.semIndex||_.lineOffset||z.elmOffset.startOffset.baseVal.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PERCENTAGE,50),_.height=C.height,_.outlineColor&&(T=10<(T=C.height/9)?10:T<2?2:T,z.styleStroke.strokeWidth=T+"px",z.styleStroke.stroke=_.outlineColor),_.strokeWidth=T||0,kn(_.aplStats,tt.pathLabel.stats),_.updateColor(A),_.updatePath(A),_.updateStartOffset(A),En&&mi(A,{}),_.updateShow(A)},bind:function(_,A){var C=A.props;return _.color||Hn(C,"cur_line_color",_.updateColor),Hn(C,"cur_line_strokeWidth",_.updatePath),Hn(C,"apl_path",_.updatePath),_.semIndex="startLabel"===A.optionName?0:"endLabel"===A.optionName?1:2,(2!==_.semIndex||_.lineOffset)&&Hn(C,"cur_attach_plugBackLenSE",_.updateStartOffset),Hn(C,"svgShow",_.updateShow),En&&Hn(C,"new_edge4viewBox",_.adjustEdge),tt.pathLabel.initSvg(_,C),!0},unbind:function(_,A){var C=A.props;_.elmsAppend&&(_.elmsAppend.forEach(function(T){C.svg.removeChild(T)}),_.elmPosition=_.elmPath=_.elmOffset=_.styleFill=_.styleShow=_.elmsAppend=null),kn(_.curStats,tt.pathLabel.stats),kn(_.aplStats,tt.pathLabel.stats),_.color||Wn(C,"cur_line_color",_.updateColor),Wn(C,"cur_line_strokeWidth",_.updatePath),Wn(C,"apl_path",_.updatePath),(2!==_.semIndex||_.lineOffset)&&Wn(C,"cur_attach_plugBackLenSE",_.updateStartOffset),Wn(C,"svgShow",_.updateShow),En&&(Wn(C,"new_edge4viewBox",_.adjustEdge),mi(C,{}))},removeOption:function(_,A){var C=A.props,T={};T[A.optionName]="",_r(C,T)},remove:function(_){_.boundTargets.length&&(console.error("LeaderLineAttachment was not unbound by remove"),_.boundTargets.forEach(function(A){tt.pathLabel.unbind(_,A)}))}}},Object.keys(tt).forEach(function(_){Mi[_]=function(){return new vn(tt[_],Array.prototype.slice.call(arguments))}}),Mi.positionByWindowResize=!0,window.addEventListener("resize",Ra.add(function(){Mi.positionByWindowResize&&Object.keys(di).forEach(function(_){mi(di[_],{position:!0})})}),!1)}()},534:(Yr,dn,wt)=>{"use strict";wt.r(dn),wt.d(dn,{PipelineModule:()=>Pe});var tt=wt(8583),vn=wt(8239),tr=wt(2298),dr=wt(6215),Er=wt(8049);function cr(R,F){return R.some(E=>E.name===F)}function To(R,F){return R.find(E=>E.name===F)}var hr=(()=>{return(R=hr||(hr={})).inner="inner join",R.left="left outer join",R.right="right outer join",R.full="full outer join",hr;var R})();const Mo={[hr.inner]:{title:"\u0627\u0644\u062d\u0627\u0642 \u062f\u0627\u062e\u0644\u06cc"},[hr.left]:{title:"\u0627\u0644\u062d\u0627\u0642 \u0627\u0632 \u0686\u067e"},[hr.right]:{title:"\u0627\u0644\u062d\u0627\u0642 \u0627\u0632 \u0631\u0627\u0633\u062a"},[hr.full]:{title:"\u0627\u0644\u062d\u0627\u0642 \u06a9\u0627\u0645\u0644"}};var Ri=(()=>{return(R=Ri||(Ri={})).count="count",R.sum="sum",R.average="average",R.min="min",R.max="max",Ri;var R})();const ui={[Ri.count]:{title:"\u0634\u0645\u0627\u0631\u0634"},[Ri.sum]:{title:"\u0645\u062c\u0645\u0648\u0639"},[Ri.average]:{title:"\u0645\u06cc\u0627\u0646\u06af\u06cc\u0646"},[Ri.min]:{title:"\u06a9\u0645\u06cc\u0646\u0647"},[Ri.max]:{title:"\u0628\u06cc\u0634\u06cc\u0646\u0647"}};var ft=(()=>{return(R=ft||(ft={})).datasetInput="dataset_input",R.datasetOutput="dataset_output",R.filter="filter",R.sort="sort",R.join="join",R.aggregate="aggregate",ft;var R})();const gi={[ft.datasetInput]:{type:ft.datasetInput,title:"\u062f\u06cc\u062a\u0627\u0633\u062a \u0648\u0631\u0648\u062f\u06cc",altTitle:"",numInputs:0,hasOutput:!0,iconName:"file_download",iconMirrored:!1},[ft.datasetOutput]:{type:ft.datasetOutput,title:"\u062f\u06cc\u062a\u0627\u0633\u062a \u062e\u0631\u0648\u062c\u06cc",altTitle:"",numInputs:1,hasOutput:!1,iconName:"publish",iconMirrored:!1},[ft.sort]:{type:ft.sort,title:"\u0645\u0631\u062a\u0628\u200c\u0633\u0627\u0632\u06cc",altTitle:"Sort",numInputs:1,hasOutput:!0,iconName:"sort_by_alpha",iconMirrored:!1},[ft.filter]:{type:ft.filter,title:"\u0641\u06cc\u0644\u062a\u0631",altTitle:"Filter",numInputs:1,hasOutput:!0,iconName:"filter_alt",iconMirrored:!1},[ft.join]:{type:ft.join,title:"\u0627\u0644\u062d\u0627\u0642",altTitle:"Join",numInputs:1,hasOutput:!0,iconName:"merge_type",iconMirrored:!1},[ft.aggregate]:{type:ft.aggregate,title:"\u062a\u062c\u0645\u06cc\u0639",altTitle:"Aggregate",numInputs:1,hasOutput:!0,iconName:"stacked_bar_chart",iconMirrored:!0}};class Ci{constructor(F,E,k,O,te){this.id=F,this.name=E,this.type=k,this.position=O,this.inputs=te,this.validations=new tr.t(1),this.inputFields=[],this.outputFields=new dr.X([]),this.typeInfo=gi[k];for(const Xe in te)this.inputFields.push(new dr.X([]))}updateFields(F,E){var k=this;return(0,vn.Z)(function*(){yield k.updateInputFields(F,E),yield k.updateOutputFields(F,E)})()}updateInputFields(F,E){var k=this;return(0,vn.Z)(function*(){for(const O in k.inputs){if(null===k.inputs[O])continue;const te=F.getNode(k.inputs[O]);void 0!==te&&k.inputFields[O].next(te.node.outputFields.value)}})()}validate(F,E){var k=this;return(0,vn.Z)(function*(){let O=Object.assign(Object.assign({},yield k.validateInputs(F)),yield k.validateConfig(F,E));return k.validations.next(O),O})()}validateInputs(F){var E=this;return(0,vn.Z)(function*(){return E.inputs.some(k=>null===k||void 0===F.getNode(k))?{inputs:"\u0648\u0631\u0648\u062f\u06cc \u0627\u06cc\u0646 \u06af\u0631\u0647 \u0628\u0647 \u06af\u0631\u0647 \u062f\u06cc\u06af\u0631\u06cc \u0645\u062a\u0635\u0644 \u0646\u0634\u062f\u0647 \u0627\u0633\u062a"}:{}})()}export(){return{id:this.id,name:this.name,type:this.type,position:this.position,inputs:this.inputs,instruction:this.exportConfig()}}exportConfig(){}}const It={[ft.datasetInput]:class extends Ci{constructor(F,E,k,O,te){super(F,E,ft.datasetInput,k,O),this.id=F,this.name=E,this.position=k,this.inputs=O,this.config=te||{}}updateOutputFields(F,E){var k=this;return(0,vn.Z)(function*(){if(void 0!==k.config.datasetId){const O=yield E.getFields(k.config.datasetId).pipe((0,Er.P)()).toPromise();k.outputFields.next(O.fields)}})()}validateConfig(F,E){var k=this;return(0,vn.Z)(function*(){let O={};return void 0===k.config.datasetId&&(O.datasetId="\u062f\u06cc\u062a\u0627\u0633\u062a \u0648\u0631\u0648\u062f\u06cc \u0627\u0646\u062a\u062e\u0627\u0628 \u0646\u0634\u062f\u0647 \u0627\u0633\u062a"),O})()}exportConfig(){return{datasetId:this.config.datasetId}}static importConfig(F){return{datasetId:F.datasetId}}},[ft.datasetOutput]:class extends Ci{constructor(F,E,k,O,te){super(F,E,ft.datasetOutput,k,O),this.id=F,this.name=E,this.position=k,this.inputs=O,this.config=te||{overwrite:!1}}updateOutputFields(F,E){return(0,vn.Z)(function*(){})()}validateConfig(F,E){var k=this;return(0,vn.Z)(function*(){let O={};return void 0===k.config.datasetId&&(O.datasetId="\u062f\u06cc\u062a\u0627\u0633\u062a \u062e\u0631\u0648\u062c\u06cc \u0627\u0646\u062a\u062e\u0627\u0628 \u0646\u0634\u062f\u0647 \u0627\u0633\u062a"),O})()}exportConfig(){return{datasetId:this.config.datasetId,overwrite:this.config.overwrite}}static importConfig(F){return{datasetId:F.datasetId,overwrite:F.overwrite}}},[ft.sort]:class extends Ci{constructor(F,E,k,O,te){super(F,E,ft.sort,k,O),this.id=F,this.name=E,this.position=k,this.inputs=O,this.config=te||{orders:[]}}updateOutputFields(F,E){var k=this;return(0,vn.Z)(function*(){k.outputFields.next(k.inputFields[0].value)})()}validateConfig(F,E){var k=this;return(0,vn.Z)(function*(){let O={};for(const te in k.config.orders)cr(k.inputFields[0].value,k.config.orders[te].fieldName)||(O[`orders[${te}].fieldName`]="\u0627\u06cc\u0646 \u0641\u06cc\u0644\u062f \u0648\u062c\u0648\u062f \u0646\u062f\u0627\u0631\u062f");return O})()}exportConfig(){return{orders:this.config.orders}}static importConfig(F){return{orders:F.orders}}},[ft.filter]:class extends Ci{constructor(F,E,k,O,te){super(F,E,ft.filter,k,O),this.id=F,this.name=E,this.position=k,this.inputs=O,this.config=te||{Command:"="}}updateOutputFields(F,E){var k=this;return(0,vn.Z)(function*(){k.outputFields.next(k.inputFields[0].value)})()}validateConfig(F,E){return(0,vn.Z)(function*(){return{}})()}exportConfig(){return this.config}static importConfig(F){return F}},[ft.join]:class extends Ci{constructor(F,E,k,O,te){super(F,E,ft.join,k,O),this.id=F,this.name=E,this.position=k,this.inputs=O,this.config=te||{type:hr.inner,joinWith:void 0,leftTableKey:"",rightTableKey:""},this.inputFields.push(new dr.X([]))}updateOutputFields(F,E){var k=this;return(0,vn.Z)(function*(){let O=k.inputFields[0].value;if(void 0!==k.config.joinWith){const te=yield E.getFields(k.config.joinWith).pipe((0,Er.P)()).toPromise();O=O.concat(te.fields)}k.outputFields.next(O)})()}validateConfig(F,E){var k=this;return(0,vn.Z)(function*(){let O={};return void 0===k.config.joinWith&&(O.joinWith="\u062f\u06cc\u062a\u0627\u0633\u062a \u0628\u0631\u0627\u06cc \u0627\u0644\u062d\u0627\u0642 \u0627\u0646\u062a\u062e\u0627\u0628 \u0646\u0634\u062f\u0647 \u0627\u0633\u062a"),cr(k.inputFields[0].value,k.config.leftTableKey)&&(O.leftTableKey="\u0627\u06cc\u0646 \u0641\u06cc\u0644\u062f \u0648\u062c\u0648\u062f \u0646\u062f\u0627\u0631\u062f"),cr(k.inputFields[1].value,k.config.rightTableKey)&&(O.rightTableKey="\u0627\u06cc\u0646 \u0641\u06cc\u0644\u062f \u0648\u062c\u0648\u062f \u0646\u062f\u0627\u0631\u062f"),O})()}exportConfig(){return{type:this.config.type,joinWith:this.config.joinWith,leftTableKey:this.config.leftTableKey,rightTableKey:this.config.rightTableKey}}static importConfig(F){return{type:F.type,joinWith:F.joinWith,leftTableKey:F.leftTableKey,rightTableKey:F.rightTableKey}}},[ft.aggregate]:class extends Ci{constructor(F,E,k,O,te){super(F,E,ft.aggregate,k,O),this.id=F,this.name=E,this.position=k,this.inputs=O,this.config=te||{groupBy:[],operations:[]}}updateOutputFields(F,E){var k=this;return(0,vn.Z)(function*(){const O=k.config.groupBy.reduce((Rt,Xt)=>{const Bn=To(k.inputFields[0].value,Xt);return void 0!==Bn&&Rt.push(Bn),Rt},[]),te=k.config.operations.reduce((Rt,Xt)=>{const Bn=To(k.inputFields[0].value,Xt.fieldName);return void 0!==Bn&&Rt.push({name:Xt.outputFieldName,type:Bn.type}),Rt},[]),Xe=O.concat(te);k.outputFields.next(Xe)})()}validateConfig(F,E){var k=this;return(0,vn.Z)(function*(){let O={};for(const te in k.config.groupBy)cr(k.inputFields[0].value,k.config.groupBy[te])||(O[`groupBy[${te}]`]="\u0627\u06cc\u0646 \u0641\u06cc\u0644\u062f \u0648\u062c\u0648\u062f \u0646\u062f\u0627\u0631\u062f");for(const te in k.config.operations){const Xe=To(k.inputFields[0].value,k.config.operations[te].fieldName);void 0===Xe?O[`operations[${te}].fieldName`]="\u0627\u06cc\u0646 \u0641\u06cc\u0644\u062f \u0648\u062c\u0648\u062f \u0646\u062f\u0627\u0631\u062f":"number"!==Xe.type&&k.config.operations[te].type!==Ri.count&&(O[`operations[${te}].type`]="\u0627\u06cc\u0646 \u0639\u0645\u0644 \u062a\u0646\u0647\u0627 \u0631\u0648\u06cc \u0641\u06cc\u0644\u062f \u0639\u062f\u062f\u06cc \u0642\u0627\u0628\u0644 \u0627\u0633\u062a\u0641\u0627\u062f\u0647 \u0627\u0633\u062a")}return O})()}exportConfig(){return this.config}static importConfig(F){return{groupBy:F.groupBy,operations:F.operations}}}};function Io(R){const F=It[R.type],E=F.importConfig(R.instruction);return new F(R.id,R.name,R.position,R.inputs,E)}var Jn=wt(3461),co=wt(9765),hs=wt(1439);function Sr(R){return Object.keys(R).length>0}function Ko(R){return Object.keys(R).map(F=>({key:F,value:R[F]}))}class bi{constructor(F,E){this.id=F,this.name=E,this.nodes=[],this.nodeAdded=new co.xQ,this.nodeEdited=new co.xQ,this.nodeRemoved=new co.xQ,this.loaded=new tr.t(1),this.validations=new tr.t(1)}getNode(F){const E=this.nodes.findIndex(k=>k.id===F);if(!(E<0))return{index:E,node:this.nodes[E]}}addNode(F){if(void 0!==this.getNode(F.id))throw new Error("A node with the same id already exists in the pipeline");this.nodes.push(F),this.nodeAdded.next(F)}createNode(F,E,k={x:0,y:0},O){if(void 0!==O){if(O.length!==gi[E].numInputs)throw new Error("Invalid number of inputs")}else O=new Array(gi[E].numInputs).fill(null);const te=new It[E](this.nextId,F,k,O);return this.addNode(te),te.id}get nextId(){return Math.max(0,...this.nodes.map(F=>F.id+1))}editNode(F){var E;const k=null===(E=this.getNode(F.id))||void 0===E?void 0:E.index;if(void 0===k)throw new Error("A node with the given id does not exist in the pipeline");this.nodes[k]=F,this.nodeEdited.next(F)}markNodeAsEdited(F){var E;const k=null===(E=this.getNode(F))||void 0===E?void 0:E.node;if(void 0===k)throw new Error("A node with the given id does not exist in the pipeline");this.nodeEdited.next(k)}removeNode(F){const E=this.nodes.findIndex(O=>O.id===F);if(E<0)throw new Error("A node with the given id does not exist in the pipeline");this.nodes.forEach(O=>{let te=!1;for(let Xe=0;Xe<O.inputs.length;Xe++)O.inputs[Xe]===F&&(O.inputs[Xe]=null,te=!0);te&&this.nodeEdited.next(O)});const k=this.nodes.splice(E,1)[0];this.nodeRemoved.next(k)}validate(F){var E=this;return(0,hs.P)((0,vn.Z)(function*(){let k=E.reorder();if(Object.keys(k).length>0)return E.validations.next(k),k;1!==E.nodes.filter(te=>te.type===ft.datasetInput).length&&(k.inputs="\u062a\u0646\u0647\u0627 \u06cc\u06a9 \u06af\u0631\u0647 \u062f\u06cc\u062a\u0627\u0633\u062a \u0648\u0631\u0648\u062f\u06cc \u0628\u0627\u06cc\u062f \u0648\u062c\u0648\u062f \u062f\u0627\u0634\u062a\u0647 \u0628\u0627\u0634\u062f"),E.nodes.filter(te=>te.type===ft.datasetOutput).length>1&&(k.outputs="\u062d\u062f\u0627\u06a9\u062b\u0631 \u06cc\u06a9 \u06af\u0631\u0647 \u062f\u06cc\u062a\u0627\u0633\u062a \u062e\u0631\u0648\u062c\u06cc \u0628\u0627\u06cc\u062f \u0648\u062c\u0648\u062f \u062f\u0627\u0634\u062a\u0647 \u0628\u0627\u0634\u062f");for(const te of E.nodes)yield te.updateOutputFields(E,F);let O=!1;for(const te of E.nodes){const Xe=yield te.validate(E,F);O||(O=Sr(Xe))}return O&&(k.nodes="\u06cc\u06a9\u06cc \u0627\u0632 \u06af\u0631\u0647\u200c\u0647\u0627 \u0646\u0627\u0645\u0639\u062a\u0628\u0631 \u0627\u0633\u062a"),k}))}reorder(){const F=[];for(let E=0;E<this.nodes.length;E++){let k=!1,O=E;for(;O<this.nodes.length;O++)if(this.nodes[O].inputs.every(Xe=>null===Xe||F.includes(Xe))){k=!0;break}if(!k)return{circular:"\u06af\u0631\u0627\u0641 \u0634\u0627\u0645\u0644 \u062f\u0648\u0631 \u0627\u0633\u062a"};F.push(this.nodes[O].id),(0,Jn.bA)(this.nodes,O,E)}return{}}}const Xr=(()=>{const R=new bi(void 0,"\u0633\u0646\u0627\u0631\u06cc\u0648 \u062c\u062f\u06cc\u062f"),F=R.createNode("\u062f\u06cc\u062a\u0627\u0633\u062a \u0648\u0631\u0648\u062f\u06cc",ft.datasetInput,{x:3,y:5});return R.createNode("\u062f\u06cc\u062a\u0627\u0633\u062a \u062e\u0631\u0648\u062c\u06cc",ft.datasetOutput,{x:11,y:5},[F]),R})();function pr(R){const F=R.nodes.filter(te=>te.type===ft.datasetInput);if(F.length>1)throw new Error("\u062d\u062f\u0627\u06a9\u062b\u0631 \u06cc\u06a9 \u06af\u0631\u0647 \u062f\u06cc\u062a\u0627\u0633\u062a \u0648\u0631\u0648\u062f\u06cc \u067e\u0634\u062a\u06cc\u0628\u0627\u062a\u06cc \u0645\u06cc\u200c\u0634\u0648\u062f");const E=R.nodes.filter(te=>te.type===ft.datasetOutput);if(F.length>1)throw new Error("\u062d\u062f\u0627\u06a9\u062b\u0631 \u06cc\u06a9 \u06af\u0631\u0647 \u062f\u06cc\u062a\u0627\u0633\u062a \u062e\u0631\u0648\u062c\u06cc \u067e\u0634\u062a\u06cc\u0628\u0627\u062a\u06cc \u0645\u06cc\u200c\u0634\u0648\u062f");const k=F[0],O=E[0];return{pipelineId:R.id,pipelineName:R.name,inputDatasetId:(null==k?void 0:k.config.datasetId)||0,inputDataset:k?JSON.stringify(k.export()):null,outputDatasetId:(null==O?void 0:O.config.datasetId)||0,outputDataset:O?JSON.stringify(O.export()):null,overwrite:(null==O?void 0:O.config.overwrite)||!1,processes:R.nodes.filter(te=>te.type!==ft.datasetInput&&te.type!==ft.datasetOutput).map(te=>te.export())}}function li(R){const F=new bi(R.pipelineId,R.pipelineName);if(null!==R.inputDataset){const E=JSON.parse(R.inputDataset);F.addNode(Io(E))}for(const E of R.processes)F.addNode(Io(E));if(null!==R.outputDataset){const E=JSON.parse(R.outputDataset);F.addNode(Io(E))}return F}var f=wt(7716),Fr=wt(3423),Fa=wt(2675);let ps=(()=>{class R{constructor(E,k){this.router=E,this.pipelineService=k}ngOnInit(){this.pipelineService.create(pr(Xr)).subscribe(E=>{this.router.navigate(["pipeline",E])})}}return R.\u0275fac=function(E){return new(E||R)(f.Y36(Fr.F0),f.Y36(Fa.n))},R.\u0275cmp=f.Xpm({type:R,selectors:[["app-initial-creator"]],decls:0,vars:0,template:function(E,k){},styles:[""]}),R})();var Pr=wt(4299),Pa=wt.n(Pr),fr=wt(7556),qi=wt(810);let Jr=(()=>{class R{constructor(E){this.datasetService=E,this.datasets=new tr.t(1),this.datasetDetails={}}update(){this.datasetService.getAll().subscribe(E=>{this.datasets.next(E)})}getFields(E){return void 0===this.datasetDetails[E]&&this.updateFields(E),this.datasetDetails[E]}updateFields(E){void 0===this.datasetDetails[E]&&(this.datasetDetails[E]=new tr.t(1)),this.datasetService.get(E).subscribe(k=>{this.datasetDetails[E].next(k)})}}return R.\u0275fac=function(E){return new(E||R)(f.LFG(qi.d))},R.\u0275prov=f.Yz7({token:R,factory:R.\u0275fac}),R})();var Qr=wt(6458),Da=wt(2522),_t=wt(1095),sn=wt(6627),Yt=wt(8295),bn=wt(9983),qt=wt(3679),En=wt(5384),Ei=wt(3017),Qn=wt(3738);let Hi=(()=>{class R{constructor(E){this.hostRef=E,this.onInit=new f.vpe,this.afterViewInit=new f.vpe,this.onDestroy=new f.vpe}ngOnInit(){this.onInit.emit(this.hostRef.nativeElement)}ngAfterViewInit(){this.afterViewInit.emit(this.hostRef.nativeElement)}ngOnDestroy(){this.onDestroy.emit(this.hostRef.nativeElement)}}return R.\u0275fac=function(E){return new(E||R)(f.Y36(f.SBq))},R.\u0275dir=f.lG2({type:R,selectors:[["","spy-element",""]],outputs:{onInit:"onInit",afterViewInit:"afterViewInit",onDestroy:"onDestroy"}}),R})();var un=wt(2458);wt(70);let nr=(()=>{class R{constructor(E){this.document=E}onContainer(E){return(k,O,te)=>{let Xe;Xe=void 0===te?new LeaderLine(k,O):new LeaderLine(k,O,te);const Rt=this.document.querySelector("body > .leader-line:last-of-type");if(!Rt)return console.error("element of line was not found:",Xe),Xe;E.appendChild(Rt);const Xt=Xe.remove;return Xe.remove=()=>{this.document.body.appendChild(Rt),Xt.bind(Xe)()},Xe}}}return R.\u0275fac=function(E){return new(E||R)(f.LFG(tt.K0))},R.\u0275prov=f.Yz7({token:R,factory:R.\u0275fac}),R})();const Ra=["connectionEnd"],ko=["connectionEndPreview"],fs=["*"];let gs=(()=>{class R{constructor(E,k){this.lineService=E,this.document=k,this.connectionRestVisibility=!0}tryToInitializeLine(){var E,k;if(void 0===this.line&&void 0!==this.lineContainer&&void 0!==this.connectionBegin&&void 0!==this.connectionEndRef){const O=this.lineService.onContainer(this.lineContainer);this.line=O(this.connectionBegin,null===(E=this.connectionEndRef)||void 0===E?void 0:E.nativeElement,{color:"var(--arrow-color)",startSocket:"left",endSocket:"right",path:"fluid",hide:!this.connectionRestVisibility,startSocketGravity:100,endSocketGravity:100}),this.subscription=null===(k=this.reposition)||void 0===k?void 0:k.subscribe(()=>{var te;null===(te=this.line)||void 0===te||te.position()}),this.line.position()}}updateLineVisibility(){void 0!==this.line&&(this.connectionRestVisibility?this.line.show():this.line.hide("none"))}ngOnInit(){}ngAfterViewInit(){this.tryToInitializeLine(),this.updateLineVisibility()}ngOnChanges(E){this.tryToInitializeLine(),"visibilityOnRest"in E&&this.updateLineVisibility()}ngOnDestroy(){var E,k;null===(E=this.subscription)||void 0===E||E.unsubscribe(),null===(k=this.line)||void 0===k||k.remove()}previewDragStarted(E){this.line.end=this.document.getElementsByClassName("cdk-drag-preview")[0],this.line.show()}previewDragMoved(E){var k;null===(k=this.line)||void 0===k||k.position()}previewDragEnded(){var E;this.line.end=null===(E=this.connectionEndRef)||void 0===E?void 0:E.nativeElement,this.updateLineVisibility()}}return R.\u0275fac=function(E){return new(E||R)(f.Y36(nr),f.Y36(tt.K0))},R.\u0275cmp=f.Xpm({type:R,selectors:[["app-anchor"]],viewQuery:function(E,k){if(1&E&&(f.Gf(Ra,5),f.Gf(ko,5)),2&E){let O;f.iGM(O=f.CRH())&&(k.connectionEndRef=O.first),f.iGM(O=f.CRH())&&(k.connectionEndPreviewRef=O.first)}},inputs:{lineContainer:"lineContainer",connectionBegin:"connectionBegin",connectionRestVisibility:"connectionRestVisibility",reposition:"reposition",dragData:"dragData"},features:[f.TTD],ngContentSelectors:fs,decls:3,vars:1,consts:[["cdkDrag","",3,"cdkDragData","cdkDragMoved","cdkDragStarted","cdkDragEnded"],["connectionEnd",""]],template:function(E,k){1&E&&(f.F$t(),f.TgZ(0,"div",0,1),f.NdJ("cdkDragMoved",function(te){return k.previewDragMoved(te)})("cdkDragStarted",function(te){return k.previewDragStarted(te)})("cdkDragEnded",function(){return k.previewDragEnded()}),f.Hsn(2),f.qZA()),2&E&&f.Q6J("cdkDragData",k.dragData)},directives:[Jn.Zt],styles:["[_nghost-%COMP%] > *[_ngcontent-%COMP%]{position:absolute}"]}),R})();const Oo=["lineContainer"],di=["cardContainer"];function za(R,F){if(1&R){const E=f.EpF();f.TgZ(0,"div",24),f.TgZ(1,"button",25),f.TgZ(2,"mat-icon"),f._uU(3,"more_vert"),f.qZA(),f.qZA(),f.TgZ(4,"mat-menu",null,26),f.TgZ(6,"button",27),f.NdJ("click",function(){f.CHM(E);const O=f.oxw().$implicit;return f.oxw().removeNode(O.node.id)}),f.TgZ(7,"mat-icon"),f._uU(8,"delete"),f.qZA(),f.TgZ(9,"span"),f._uU(10,"\u062d\u0630\u0641"),f.qZA(),f.qZA(),f.qZA(),f.qZA()}if(2&R){const E=f.MAs(5);f.xp6(1),f.Q6J("matMenuTriggerFor",E)}}function qn(R,F){if(1&R){const E=f.EpF();f.TgZ(0,"app-anchor",30),f.NdJ("shouldReposition",function(){return f.CHM(E),f.oxw(3).shouldReposition=!0}),f._UZ(1,"div",31),f.qZA()}if(2&R){const E=f.oxw().$implicit,k=f.oxw(2),O=f.MAs(9);f.Q6J("lineContainer",O)("connectionBegin",E.outputPlaceholderElement)("reposition",k.reposition)("dragData",E)}}const Ba=function(R,F){return{type:"input",card:R,index:F}};function Dr(R,F){if(1&R){const E=f.EpF();f.TgZ(0,"div",28),f.NdJ("cdkDropListDropped",function(O){return f.CHM(E),f.oxw(2).buttonDrop(O)}),f.YNc(1,qn,2,4,"app-anchor",29),f.qZA()}if(2&R){const E=F.$implicit,k=F.index,O=f.oxw().$implicit,te=f.oxw();f.Q6J("cdkDropListData",f.WLB(3,Ba,O,k))("cdkDropListEnterPredicate",te.inputDropEnterPredicate),f.xp6(1),f.Q6J("ngIf",null!==E)}}const Si=function(R){return{card:R,type:"output"}};function ir(R,F){if(1&R){const E=f.EpF();f.TgZ(0,"div",32),f.NdJ("cdkDropListDropped",function(O){return f.CHM(E),f.oxw(2).buttonDrop(O)}),f.TgZ(1,"app-anchor",33),f._UZ(2,"div",31),f.qZA(),f.qZA()}if(2&R){const E=f.oxw().$implicit,k=f.MAs(14),O=f.oxw(),te=f.MAs(9);f.Q6J("cdkDropListData",f.VKq(6,Si,E)),f.xp6(1),f.Q6J("lineContainer",te)("connectionBegin",k)("connectionRestVisibility",!1)("reposition",O.reposition)("dragData",E)}}const Wi=function(){return{}};function Rr(R,F){if(1&R){const E=f.EpF();f.TgZ(0,"mat-card",17),f.NdJ("click",function(){const te=f.CHM(E).$implicit;return f.oxw().updateSelectedCard(te)})("cdkDragStarted",function(O){return f.CHM(E),f.oxw().cardDragStarted(O)})("cdkDragEnded",function(O){return f.CHM(E),f.oxw().cardDragEnded(O)})("cdkDragMoved",function(){return f.CHM(E),f.oxw().shouldReposition=!0})("transitionend",function(){return f.CHM(E),f.oxw().shouldReposition=!0}),f.ALo(1,"async"),f.TgZ(2,"mat-card-header"),f.TgZ(3,"mat-card-title"),f._uU(4),f.qZA(),f.TgZ(5,"mat-card-subtitle"),f.TgZ(6,"mat-icon"),f._uU(7),f.qZA(),f.TgZ(8,"span"),f._uU(9),f.qZA(),f.qZA(),f.qZA(),f.YNc(10,za,11,1,"div",18),f.TgZ(11,"div",19),f.YNc(12,Dr,2,6,"div",20),f.qZA(),f.TgZ(13,"div",21,22),f.NdJ("onInit",function(){const te=f.CHM(E).$implicit,Xe=f.MAs(14);return te.outputPlaceholderElement=Xe}),f.YNc(15,ir,3,8,"div",23),f.qZA(),f.qZA()}if(2&R){const E=F.$implicit,k=f.oxw();f.ekj("selected",(null==k.selectedCard||null==k.selectedCard.node?null:k.selectedCard.node.id)===E.node.id)("errored",k.hasError(f.lcZ(1,14,null==E.node?null:E.node.validations)||f.DdM(16,Wi))),f.Q6J("cdkDragData",E)("cdkDragFreeDragPosition",E.position),f.xp6(4),f.Oqu(E.title),f.xp6(2),f.ekj("mat-icon-rtl-mirror",E.typeInfo.iconMirrored),f.xp6(1),f.hij(" ",E.typeInfo.iconName," "),f.xp6(2),f.Oqu(E.subtitle),f.xp6(1),f.Q6J("ngIf",E.typeInfo.type!==k.PipelineNodeType.datasetInput&&E.typeInfo.type!==k.PipelineNodeType.datasetOutput),f.xp6(2),f.Q6J("ngForOf",E.inputs),f.xp6(3),f.Q6J("ngIf",E.hasOutput)}}function ho(R,F){1&R&&f._UZ(0,"div",41)}function No(R,F){1&R&&f._UZ(0,"div",42)}const Kn=function(){return[]};function Lo(R,F){if(1&R&&(f.TgZ(0,"div"),f.TgZ(1,"mat-card",37),f.TgZ(2,"mat-card-header"),f.TgZ(3,"mat-card-title"),f._uU(4),f.qZA(),f.TgZ(5,"mat-card-subtitle"),f.TgZ(6,"mat-icon"),f._uU(7),f.qZA(),f.TgZ(8,"span"),f._uU(9),f.qZA(),f.qZA(),f.qZA(),f.TgZ(10,"div",19),f.YNc(11,ho,1,0,"div",38),f.qZA(),f.TgZ(12,"div",39),f.YNc(13,No,1,0,"div",40),f.qZA(),f.qZA(),f.qZA()),2&R){const E=f.oxw().$implicit;f.xp6(4),f.hij(" ",E.title," "),f.xp6(2),f.ekj("mat-icon-rtl-mirror",E.iconMirrored),f.xp6(1),f.hij(" ",E.iconName," "),f.xp6(2),f.Oqu(E.title),f.xp6(2),f.Q6J("ngForOf",f.DdM(7,Kn).constructor(E.numInputs)),f.xp6(2),f.Q6J("ngIf",E.hasOutput)}}function Yi(R,F){if(1&R){const E=f.EpF();f.TgZ(0,"div",34),f.TgZ(1,"mat-card",35),f.NdJ("cdkDragEnded",function(O){return f.CHM(E),f.oxw().addNode(O)}),f.TgZ(2,"mat-icon"),f._uU(3),f.qZA(),f.TgZ(4,"span"),f._uU(5),f.qZA(),f.YNc(6,Lo,14,8,"div",36),f.qZA(),f.qZA()}if(2&R){const E=F.$implicit;f.xp6(1),f.Q6J("cdkDragData",E),f.xp6(1),f.ekj("mat-icon-rtl-mirror",E.iconMirrored),f.xp6(1),f.hij(" ",E.iconName," "),f.xp6(2),f.Oqu(E.title)}}const Bi=function(){return{type:"remove"}},Vi=4*parseFloat(getComputedStyle(document.documentElement).fontSize);class _i{constructor(F){this.node=F,this.inputs=Array(F.inputs.length).fill(null),this.hasOutput=this.typeInfo.hasOutput,this.updatePosition()}get title(){return this.node.name}get subtitle(){return gi[this.node.type].title}get typeInfo(){return gi[this.node.type]}updatePosition(){this.position={x:-this.node.position.x*Vi,y:this.node.position.y*Vi}}}let $o=(()=>{class R{constructor(){this.selectedNodeEvent=new f.vpe,this.baseOffset={x:0,y:0},this.dragOffset={x:0,y:0},this.cards=[],this.reposition=new co.xQ,this.shouldReposition=!1,this.subscriptions=[],this.Card=_i,this.addNodeTypes=Object.values(gi).filter(E=>E.type!==ft.datasetInput&&E.type!==ft.datasetOutput&&E.type!==ft.sort),this.PipelineNodeType=ft,this.hasError=Sr}ngOnInit(){}ngOnChanges(E){void 0!==E.pipeline&&E.pipeline.previousValue!==E.pipeline.currentValue&&(E.pipeline.previousValue&&(this.subscriptions.forEach(k=>k.unsubscribe()),this.subscriptions.splice(0),this.shouldReposition=!1,this.updateSelectedCard(void 0),this.cards.splice(0),this.baseOffset={x:0,y:0},this.dragOffset={x:0,y:0}),this.initPipeline())}ngAfterViewInit(){window.addEventListener("load",()=>{this.reposition.next()})}ngAfterViewChecked(){this.reposition.next(),this.shouldReposition=!1}updateSelectedCard(E){this.selectedCard=E,this.selectedNodeEvent.emit(null==E?void 0:E.node)}initPipeline(){this.pipeline.nodes.forEach(E=>{this.cards.push(new _i(E))}),this.pipeline.nodes.forEach(E=>{this.updateCardInputs(E)}),this.subscriptions.push(this.pipeline.nodeAdded.subscribe(E=>{this.cards.push(new _i(E)),this.updateCardInputs(E)})),this.subscriptions.push(this.pipeline.nodeEdited.subscribe(E=>{this.updateCardInputs(E)})),this.subscriptions.push(this.pipeline.nodeRemoved.subscribe(E=>{const k=this.cards.findIndex(O=>O.node.id===E.id);this.cards.splice(k,1)})),this.subscriptions.push(this.pipeline.loaded.subscribe(()=>{this.autoView()}))}autoView(){if(this.pipeline.nodes.length>0){const E=this.pipeline.nodes.reduce((k,O)=>({x:Math.min(k.x,O.position.x),y:Math.min(k.y,O.position.y)}),{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY});this.baseOffset={x:(E.x-2)*Vi,y:-(E.y-2)*Vi}}}updateCardInputs(E){const k=this.findCard(E.id);for(let O=0;O<k.inputs.length;O++)k.inputs[O]=null===E.inputs[O]?null:this.findCard(E.inputs[O])}findCard(E){return this.cards.find(k=>k.node.id===E)}inputDropEnterPredicate(E,k){return E.data!==k.data.card}buttonDrop(E){if(E.previousContainer===E.container)return;const k=E.previousContainer.data,O=E.container.data;"output"===O.type||"remove"===O.type?"input"===k.type&&(k.card.node.inputs[k.index]=null,this.pipeline.markNodeAsEdited(k.card.node.id)):"input"===O.type&&("input"===k.type?(O.card.node.inputs[O.index]=k.card.node.inputs[k.index],k.card.node.inputs[k.index]=null,this.pipeline.markNodeAsEdited(k.card.node.id),this.pipeline.markNodeAsEdited(O.card.node.id)):"output"===k.type&&(O.card.node.inputs[O.index]=k.card.node.id,this.pipeline.markNodeAsEdited(O.card.node.id)))}updateDragOffset(E){this.dragOffset=E.distance}updateOffset(E){this.baseOffset={x:this.baseOffset.x+E.distance.x,y:this.baseOffset.y+E.distance.y},this.dragOffset={x:0,y:0},E.source.reset()}cardDragStarted(E){E.source.element.nativeElement.classList.remove("snap-animation")}cardDragEnded(E){E.source.element.nativeElement.classList.add("snap-animation"),E.source.data.node.position={x:Math.round(-E.source.getFreeDragPosition().x/Vi),y:Math.round(E.source.getFreeDragPosition().y/Vi)},E.source.data.updatePosition()}addNode(E){const k=this.cardContainer.nativeElement.getBoundingClientRect();if(E.dropPoint.x<k.left||E.dropPoint.x>k.right||E.dropPoint.y<k.top||E.dropPoint.y>k.bottom)return;const O_y=E.dropPoint.y-k.top-Vi-this.baseOffset.y,te={x:Math.round((k.right-E.dropPoint.x-2.5*Vi+this.baseOffset.x)/Vi),y:Math.round(O_y/Vi)};this.pipeline.createNode(E.source.data.title,E.source.data.type,te)}removeNode(E){var k,O;this.pipeline.removeNode(E),(null===(O=null===(k=this.selectedCard)||void 0===k?void 0:k.node)||void 0===O?void 0:O.id)===E&&this.updateSelectedCard(void 0)}}return R.\u0275fac=function(E){return new(E||R)},R.\u0275cmp=f.Xpm({type:R,selectors:[["app-diagram"]],viewQuery:function(E,k){if(1&E&&(f.Gf(Oo,5),f.Gf(di,5)),2&E){let O;f.iGM(O=f.CRH())&&(k.lineContainer=O.first),f.iGM(O=f.CRH())&&(k.cardContainer=O.first)}},inputs:{pipeline:"pipeline"},outputs:{selectedNodeEvent:"selectedNode"},features:[f.TTD],decls:24,vars:10,consts:[["hasBackdrop","false"],[1,"diagram-container"],["cdkDropListGroup","","cdkDrag","",1,"card-container",3,"cdkDragEnded","cdkDragMoved"],["cardContainer",""],["cdkDropList","",1,"remove-connection-container",3,"cdkDropListData","cdkDropListDropped"],[1,"offset-container"],["class","diagram-card","cdkDrag","",3,"selected","errored","cdkDragData","cdkDragFreeDragPosition","click","cdkDragStarted","cdkDragEnded","cdkDragMoved","transitionend",4,"ngFor","ngForOf"],[1,"line-container"],["lineContainer",""],[1,"add-node-button-container"],["mat-raised-button","","color","primary",3,"click"],["position","end","mode","side"],["addSidePane",""],[1,"add-node-pane"],["mat-icon-button","",3,"click"],[1,"add-node-list"],["cdkDropList","",4,"ngFor","ngForOf"],["cdkDrag","",1,"diagram-card",3,"cdkDragData","cdkDragFreeDragPosition","click","cdkDragStarted","cdkDragEnded","cdkDragMoved","transitionend"],["class","more-menu-container",4,"ngIf"],[1,"drop-placeholder","input-drop-placeholder"],["class","empty-button-placeholder","cdkDropList","",3,"cdkDropListData","cdkDropListEnterPredicate","cdkDropListDropped",4,"ngFor","ngForOf"],["spy-element","",1,"drop-placeholder","output-drop-placeholder",3,"onInit"],["connectionBegin",""],["class","full-button-placeholder","cdkDropList","",3,"cdkDropListData","cdkDropListDropped",4,"ngIf"],[1,"more-menu-container"],["mat-icon-button","",3,"matMenuTriggerFor"],["moreMenu","matMenu"],["mat-menu-item","","disableRipple","","matRipple","","matRippleColor","rgba(255, 0, 0, 0.2)",1,"remove-menu-item",3,"click"],["cdkDropList","",1,"empty-button-placeholder",3,"cdkDropListData","cdkDropListEnterPredicate","cdkDropListDropped"],[3,"lineContainer","connectionBegin","reposition","dragData","shouldReposition",4,"ngIf"],[3,"lineContainer","connectionBegin","reposition","dragData","shouldReposition"],[1,"drag-button"],["cdkDropList","",1,"full-button-placeholder",3,"cdkDropListData","cdkDropListDropped"],[3,"lineContainer","connectionBegin","connectionRestVisibility","reposition","dragData"],["cdkDropList",""],["cdkDrag","",1,"add-node-card",3,"cdkDragData","cdkDragEnded"],[4,"cdkDragPreview"],[1,"diagram-card","preview-diagram-card"],["class","empty-button-placeholder",4,"ngFor","ngForOf"],[1,"drop-placeholder","output-drop-placeholder"],["class","full-button-placeholder",4,"ngIf"],[1,"empty-button-placeholder"],[1,"full-button-placeholder"]],template:function(E,k){if(1&E){const O=f.EpF();f.TgZ(0,"mat-sidenav-container",0),f.TgZ(1,"mat-sidenav-content"),f.TgZ(2,"div",1),f.TgZ(3,"div",2,3),f.NdJ("cdkDragEnded",function(Xe){return k.updateOffset(Xe)})("cdkDragMoved",function(Xe){return k.shouldReposition=!0,k.updateDragOffset(Xe)}),f.TgZ(5,"div",4),f.NdJ("cdkDropListDropped",function(Xe){return k.buttonDrop(Xe)}),f.qZA(),f.TgZ(6,"div",5),f.YNc(7,Rr,16,17,"mat-card",6),f.qZA(),f.qZA(),f._UZ(8,"div",7,8),f.TgZ(10,"div",9),f.TgZ(11,"button",10),f.NdJ("click",function(){return f.CHM(O),f.MAs(15).open()}),f.TgZ(12,"mat-icon"),f._uU(13,"add"),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.TgZ(14,"mat-sidenav",11,12),f.TgZ(16,"div",13),f.TgZ(17,"h3"),f._uU(18," \u067e\u0631\u062f\u0627\u0632\u0634 \u062c\u062f\u06cc\u062f "),f.TgZ(19,"button",14),f.NdJ("click",function(){return f.CHM(O),f.MAs(15).close()}),f.TgZ(20,"mat-icon"),f._uU(21,"chevron_left"),f.qZA(),f.qZA(),f.qZA(),f.TgZ(22,"div",15),f.YNc(23,Yi,7,5,"div",16),f.qZA(),f.qZA(),f.qZA(),f.qZA()}if(2&E){const O=f.MAs(15);f.xp6(2),f.Udp("background-position","right "+(-k.baseOffset.x-k.dragOffset.x)+"px top "+(k.baseOffset.y+k.dragOffset.y)+"px"),f.xp6(3),f.Q6J("cdkDropListData",f.DdM(9,Bi)),f.xp6(1),f.Udp("transform","translate("+k.baseOffset.x+"px, "+k.baseOffset.y+"px)"),f.xp6(1),f.Q6J("ngForOf",k.cards),f.xp6(3),f.ekj("invisible",O.opened),f.xp6(13),f.Q6J("ngForOf",k.addNodeTypes)}},directives:[Ei.TM,Ei.Rh,Jn.Fd,Jn.Zt,Jn.Wj,tt.sg,_t.lW,sn.Hw,Ei.JX,Qn.a8,Qn.dk,Qn.n5,Qn.$j,tt.O5,Hi,En.p6,En.VK,En.OP,un.wG,gs,Jn.pV],pipes:[tt.Ov],styles:[":root{--arrow-color: #673ab7}.mat-sidenav-container[_ngcontent-%COMP%]{width:100%;height:100%}.diagram-container[_ngcontent-%COMP%]{width:100%;height:100%;overflow:hidden;background-size:4rem 4rem;background-image:linear-gradient(to right,#eee .1rem,transparent .1rem),linear-gradient(to bottom,#eee .1rem,transparent .1rem)}.card-container[_ngcontent-%COMP%]{width:100%;height:100%}.card-container.cdk-drag-dragging[_ngcontent-%COMP%]{cursor:grab}.card-container[_ngcontent-%COMP%]   .diagram-card[_ngcontent-%COMP%]{position:absolute}.offset-container[_ngcontent-%COMP%]{width:0;height:0;overflow:visible}.diagram-card[_ngcontent-%COMP%]{width:20rem;height:8rem;display:flex;flex-direction:row;justify-content:center;-webkit-user-select:none;user-select:none;cursor:pointer;transition:box-shadow .28s cubic-bezier(.4,0,.2,1);box-shadow:0 3px 1px -2px #0003,0 2px 2px #00000024,0 1px 5px #0000001f}.diagram-card.snap-animation[_ngcontent-%COMP%]{transition:transform .2s ease-in-out,box-shadow .28s cubic-bezier(.4,0,.2,1)}.diagram-card.selected[_ngcontent-%COMP%]{box-shadow:0 2px 4px -1px #673ab799,0 4px 5px #673ab76b,0 1px 10px #673ab75c}.diagram-card.cdk-drag-dragging[_ngcontent-%COMP%]{box-shadow:0 3px 5px -1px #673ab799,0 6px 10px #673ab76b,0 1px 18px #673ab75c;cursor:move}.diagram-card.errored[_ngcontent-%COMP%]{box-shadow:0 3px 1px -2px #f44336cc,0 2px 2px #f443368f,0 1px 5px #f443367a}.diagram-card.errored.selected[_ngcontent-%COMP%]{box-shadow:0 2px 4px -1px #f4433699,0 4px 5px #f443366b,0 1px 10px #f443365c}.diagram-card.errored.cdk-drag-dragging[_ngcontent-%COMP%]{box-shadow:0 3px 5px -1px #f4433699,0 6px 10px #f443366b,0 1px 18px #f443365c}.diagram-card[_ngcontent-%COMP%]   .mat-card-title[_ngcontent-%COMP%], .diagram-card[_ngcontent-%COMP%]   .mat-card-subtitle[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center;grid-gap:var(--density-smaller);gap:var(--density-smaller)}.more-menu-container[_ngcontent-%COMP%]{position:absolute;top:0;left:0;margin:var(--density-small)}.remove-menu-item[_ngcontent-%COMP%]{color:#f44336}.remove-menu-item[_ngcontent-%COMP%] > .mat-icon[_ngcontent-%COMP%]{color:#f44336}.drop-placeholder[_ngcontent-%COMP%]{position:absolute;width:0;height:8rem;display:flex;flex-direction:column;justify-content:space-evenly;align-items:center}.input-drop-placeholder[_ngcontent-%COMP%]{top:0;right:0}.output-drop-placeholder[_ngcontent-%COMP%]{top:0;left:0}.empty-button-placeholder[_ngcontent-%COMP%]{width:2rem;height:2rem;border-radius:100%;background-color:#d1c4e9}.empty-button-placeholder[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{position:absolute}.full-button-placeholder[_ngcontent-%COMP%]{width:2rem;height:2rem;border-radius:100%;background-color:#673ab7}.full-button-placeholder[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{position:absolute}.drag-button[_ngcontent-%COMP%]{width:2rem;height:2rem;border-radius:100%;background-color:#673ab7}.line-container[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:0;height:0}.remove-connection-container[_ngcontent-%COMP%]{position:absolute;top:0;right:0;width:100%;height:100%}.remove-connection-container[_ngcontent-%COMP%]   .drag-button[_ngcontent-%COMP%]{display:none}.add-node-button-container[_ngcontent-%COMP%]{position:absolute;top:0;left:0;margin:var(--density-large);transition:opacity .2s ease-in;opacity:1}.add-node-button-container.invisible[_ngcontent-%COMP%]{visibility:hidden;opacity:0}.mat-sidenav[_ngcontent-%COMP%]{width:20rem}.add-node-pane[_ngcontent-%COMP%]{min-height:100%;padding:var(--density-large);background-color:#fafafa}.add-node-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:var(--density-large);gap:var(--density-large)}.add-node-card[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;grid-gap:var(--density-small);gap:var(--density-small);-webkit-user-select:none;user-select:none;cursor:move}.preview-diagram-card[_ngcontent-%COMP%]{position:absolute;transform:translate(50%,-50%)}"]}),R})();var Ln=wt(7441);function Hn(R,F){if(1&R&&(f.TgZ(0,"mat-option",4),f._uU(1),f.qZA()),2&R){const E=F.$implicit;f.Q6J("value",E.id),f.xp6(1),f.hij(" ",E.name," ")}}function Wn(R,F){if(1&R){const E=f.EpF();f.TgZ(0,"div"),f.TgZ(1,"h3"),f._uU(2,"\u0627\u0637\u0644\u0627\u0639\u0627\u062a \u062f\u06cc\u062a\u0627\u0633\u062a"),f.qZA(),f.TgZ(3,"mat-form-field",1),f.TgZ(4,"mat-label"),f._uU(5,"\u062f\u06cc\u062a\u0627\u0633\u062a"),f.qZA(),f.TgZ(6,"mat-select",2),f.NdJ("ngModelChange",function(O){return f.CHM(E),f.oxw().node.config.datasetId=O}),f._UZ(7,"mat-option"),f.YNc(8,Hn,2,2,"mat-option",3),f.ALo(9,"async"),f.qZA(),f.TgZ(10,"mat-error"),f._uU(11,"\u0644\u0637\u0641\u0627\u064b \u06cc\u06a9 \u062f\u06cc\u062a\u0627\u0633\u062a \u0627\u0646\u062a\u062e\u0627\u0628 \u06a9\u0646\u06cc\u062f"),f.qZA(),f.qZA(),f.qZA()}if(2&R){const E=f.oxw();f.xp6(6),f.Q6J("ngModel",E.node.config.datasetId),f.xp6(2),f.Q6J("ngForOf",f.lcZ(9,2,E.store.datasets))}}let gr=(()=>{class R{constructor(){}ngOnInit(){var E;null===(E=this.store)||void 0===E||E.update()}}return R.\u0275fac=function(E){return new(E||R)},R.\u0275cmp=f.Xpm({type:R,selectors:[["app-input-config"]],inputs:{node:"node",store:"store"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"wide-field"],["required","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(E,k){1&E&&f.YNc(0,Wn,12,4,"div",0),2&E&&f.Q6J("ngIf",void 0!==k.node&&void 0!==k.store)},directives:[tt.O5,Yt.KE,Yt.hX,Ln.gD,qt.Q7,qt.JJ,qt.On,un.ey,tt.sg,Yt.TO],pipes:[tt.Ov],styles:[""]}),R})();var cn=wt(7539);function Fo(R,F){if(1&R&&(f.TgZ(0,"mat-option",5),f._uU(1),f.qZA()),2&R){const E=F.$implicit;f.Q6J("value",E.id),f.xp6(1),f.hij(" ",E.name," ")}}function ea(R,F){if(1&R){const E=f.EpF();f.TgZ(0,"div"),f.TgZ(1,"h3"),f._uU(2,"\u0627\u0637\u0644\u0627\u0639\u0627\u062a \u062f\u06cc\u062a\u0627\u0633\u062a"),f.qZA(),f.TgZ(3,"mat-form-field",1),f.TgZ(4,"mat-label"),f._uU(5,"\u062f\u06cc\u062a\u0627\u0633\u062a"),f.qZA(),f.TgZ(6,"mat-select",2),f.NdJ("ngModelChange",function(O){return f.CHM(E),f.oxw().node.config.datasetId=O}),f._UZ(7,"mat-option"),f.YNc(8,Fo,2,2,"mat-option",3),f.ALo(9,"async"),f.qZA(),f.TgZ(10,"mat-error"),f._uU(11,"\u0644\u0637\u0641\u0627\u064b \u06cc\u06a9 \u062f\u06cc\u062a\u0627\u0633\u062a \u0627\u0646\u062a\u062e\u0627\u0628 \u06a9\u0646\u06cc\u062f"),f.qZA(),f.qZA(),f.TgZ(12,"mat-checkbox",4),f.NdJ("ngModelChange",function(O){return f.CHM(E),f.oxw().node.config.overwrite=O}),f._uU(13," \u0631\u0648\u0646\u0648\u06cc\u0633\u06cc "),f.qZA(),f.qZA()}if(2&R){const E=f.oxw();f.xp6(6),f.Q6J("ngModel",E.node.config.datasetId),f.xp6(2),f.Q6J("ngForOf",f.lcZ(9,3,E.store.datasets)),f.xp6(4),f.Q6J("ngModel",E.node.config.overwrite)}}let ta=(()=>{class R{constructor(){}ngOnInit(){var E;null===(E=this.store)||void 0===E||E.update()}}return R.\u0275fac=function(E){return new(E||R)},R.\u0275cmp=f.Xpm({type:R,selectors:[["app-output-config"]],inputs:{node:"node",store:"store"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"wide-field"],["required","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"ngModel","ngModelChange"],[3,"value"]],template:function(E,k){1&E&&f.YNc(0,ea,14,5,"div",0),2&E&&f.Q6J("ngIf",void 0!==k.node&&void 0!==k.store)},directives:[tt.O5,Yt.KE,Yt.hX,Ln.gD,qt.Q7,qt.JJ,qt.On,un.ey,tt.sg,Yt.TO,cn.oG],pipes:[tt.Ov],styles:[""]}),R})();var kn=wt(2238),lt=wt(7646),fn=wt(1769),Ti=wt(171);function _s(R,F){if(1&R){const E=f.EpF();f.TgZ(0,"button",4),f.NdJ("click",function(){return f.CHM(E),f.oxw().handleAddNode("AND")}),f._uU(1," \u0627\u0641\u0632\u0648\u062f\u0646 AND "),f.qZA()}}function Kr(R,F){if(1&R){const E=f.EpF();f.TgZ(0,"button",26),f.NdJ("click",function(){return f.CHM(E),f.oxw().handleAddNode("OR")}),f._uU(1," \u0627\u0641\u0632\u0648\u062f\u0646 OR "),f.qZA()}}function mi(R,F){if(1&R){const E=f.EpF();f.TgZ(0,"mat-accordion"),f.TgZ(1,"mat-expansion-panel",33),f.TgZ(2,"mat-expansion-panel-header"),f.TgZ(3,"mat-panel-title"),f._uU(4," \u0648\u06cc\u0631\u0627\u06cc\u0634 \u06af\u0631\u0647\u200c\u06cc \u0634\u0631\u0637\u06cc "),f.qZA(),f.qZA(),f.TgZ(5,"mat-form-field",14),f.TgZ(6,"mat-label"),f._uU(7,"\u0646\u0627\u0645 \u0645\u062a\u063a\u06cc\u0631"),f.qZA(),f.TgZ(8,"input",34),f.NdJ("ngModelChange",function(O){return f.CHM(E),f.oxw(2).currentData._field=O}),f.qZA(),f.qZA(),f.TgZ(9,"mat-form-field",14),f.TgZ(10,"mat-label"),f._uU(11,"\u0639\u0645\u0644\u06af\u0631"),f.qZA(),f.TgZ(12,"mat-select",35),f.NdJ("ngModelChange",function(O){return f.CHM(E),f.oxw(2).currentData.Command=O}),f.TgZ(13,"mat-option",17),f._uU(14,">"),f.qZA(),f.TgZ(15,"mat-option",18),f._uU(16,"<"),f.qZA(),f.TgZ(17,"mat-option",19),f._uU(18,"="),f.qZA(),f.qZA(),f.qZA(),f.TgZ(19,"mat-form-field",14),f.TgZ(20,"mat-label"),f._uU(21,"\u0639\u0645\u0644\u0648\u0646\u062f"),f.qZA(),f.TgZ(22,"input",34),f.NdJ("ngModelChange",function(O){return f.CHM(E),f.oxw(2).currentData._value=O}),f.qZA(),f.qZA(),f.qZA(),f.qZA()}if(2&R){const E=f.oxw(2);f.xp6(1),f.Q6J("expanded",!0),f.xp6(7),f.Q6J("ngModel",E.currentData._field),f.xp6(4),f.Q6J("ngModel",E.currentData.Command),f.xp6(10),f.Q6J("ngModel",E.currentData._value)}}function Po(R,F){if(1&R){const E=f.EpF();f.TgZ(0,"mat-sidenav",27,28),f.TgZ(2,"div",10),f.TgZ(3,"mat-form-field",29),f.TgZ(4,"input",30,31),f.NdJ("ngModelChange",function(O){return f.CHM(E),f.oxw().currentData.name=O}),f.qZA(),f.qZA(),f.YNc(6,mi,23,4,"mat-accordion",32),f.qZA(),f.qZA()}if(2&R){const E=f.oxw();f.xp6(4),f.Q6J("ngModel",E.currentData.name),f.xp6(2),f.Q6J("ngIf","child"===E.currentData.type)}}let $r=(()=>{class R{constructor(E,k,O){this.formBuilder=E,this.dialogRef=k,this.data=O,this.nodeSize=0,this.onSaveGraph=new f.vpe,this.panelOpenState=!1,this.errorGraph=!1}ngOnInit(){this.form=this.formBuilder.group({Command:[null,qt.kI.required],_field:[null,[qt.kI.required]],_value:[null,qt.kI.required]}),this.ogma=new lt({container:"graph-container",options:{interactions:{zoom:{onDoubleClick:!0}}}}),this.ogma.styles.addNodeRule({text:{maxLineLength:140,size:12,color:"black",minVisibleSize:2,content:E=>E.getData("name")}}),this.ogma.styles.addEdgeRule({shape:"arrow",width:7}),this.nodeSize=this.ogma.getNodes().size,this.ogma.events.onKeyPress(46,()=>{const E=this.ogma.getSelectedNodes(),k=this.ogma.getSelectedEdges();this.nodeSize-=E.size,this.ogma.removeNodes(E.getId()),this.ogma.removeEdges(k.getId()),this.currentData=null}),this.ogma.events.onClick(E=>{const k=E.button,O=E.target;O?"left"===k?(this.ogma.clearSelection(),O.setSelected(!0),O.isNode&&(this.currentData=this.ogma.getNode(O.getId()).getData())):"right"===k&&O.setSelected(!0):(this.ogma.clearSelection(),this.currentData=null)}),this.ogma.view.locateGraph(),this.ogma.events.onDragStart(()=>{this.ogma.keyboard.isKeyPressed("ctrl")&&this.ogma.tools.connectNodes.enable({strokeColor:"red",condition:(E,k)=>{const O=this.ogma.getEdges();for(let te=0;te<O.size;te++){const Xe=O.get(te).getData();if(Xe.source==E.getId()&&Xe.target==k.getId())return!1}return"child"!=E.getData().type&&E.getId()!=k.getId()},createNodes:!1,createEdge:E=>(E.attributes=Object.assign(Object.assign({},E.attributes),{color:"orange"}),E),onComplete:(E,k,O)=>{k&&O?O.setData({source:E.getId(),target:k.getId()}):this.ogma.tools.connectNodes.disable()}})}),this.ogma.events.onDragEnd(()=>{this.ogma.algorithms.detectCycle()&&this.ogma.removeEdge(this.ogma.getEdges().get(this.ogma.getEdges().size-1).getId())})}handleAddNode(E){switch(E){case"AND":this.ogma.addNode({id:++this.nodeSize,data:{type:"parent",name:"AND",Command:"AND"},attributes:{x:-200*Math.random(),y:200*Math.random(),color:"green",radius:25}});break;case"OR":this.ogma.addNode({id:++this.nodeSize,data:{type:"parent",name:"OR",Command:"OR"},attributes:{x:200*Math.random(),y:100*-Math.random(),color:"magenta",radius:25}});break;case"condition":this.ogma.addNode({id:++this.nodeSize,data:Object.assign({type:"child",name:"condition"},this.form.value),attributes:{x:100*-Math.random(),y:200*-Math.random(),color:"orange",radius:25}}),this.ogma.getNodes().forEach(k=>{})}}handleSavingGraph(){const E=this.ogma.getNodes().filter(k=>0===k.getDegree("in"));if(1!==E.size)alert("\u062e\u0637\u0627 \u062f\u0631 \u0630\u062e\u06cc\u0631\u0647 \u0633\u0627\u0632\u06cc : \u06af\u0631\u0627\u0641 \u0641\u0642\u0637 \u06cc\u06a9 \u0631\u06cc\u0634\u0647 \u0628\u0627\u06cc\u062f \u062f\u0627\u0634\u062a\u0647 \u0628\u0627\u0634\u062f");else{const k=this.applyingDFS(E.get(0));if(this.errorGraph)alert("\u062e\u0637\u0627 \u062f\u0631 \u0630\u062e\u06cc\u0631\u0647 \u0633\u0627\u0632\u06cc : \u06af\u0631\u0647 \u0647\u0627\u06cc \u063a\u06cc\u0631 \u0634\u0631\u0637\u06cc \u062d\u062f\u0627\u0642\u0644 2 \u0641\u0631\u0632\u0646\u062f \u0628\u0627\u06cc\u062f \u062f\u0627\u0634\u062a\u0647 \u0628\u0627\u0634\u0646\u062f"),this.errorGraph=!1;else{const O=JSON.stringify(k,void 0,1);console.log(O),alert("\u0641\u06cc\u0644\u062a\u0631 \u0628\u0627 \u0645\u0648\u0641\u0642\u06cc\u062a \u0630\u062e\u06cc\u0631\u0647 \u0634\u062f"),this.onSaveGraph.emit(),this.dialogRef.close(k)}}}applyingDFS(E){let k={Command:E.getData("Command")};if("child"==E.getData("type"))k=Object.assign(Object.assign({},k),{_field:E.getData("_field"),_value:E.getData("_value")});else{const O=E.getAdjacentNodes({direction:"out"});let te=[];if(O.forEach((Xe,Rt)=>{let Xt=this.applyingDFS(Xe);Xt?te.push(Xt):this.errorGraph=!0}),te.length<2||this.errorGraph)return void(this.errorGraph=!0);k=Object.assign(Object.assign({},k),{_statement:te})}return k}}return R.\u0275fac=function(E){return new(E||R)(f.Y36(qt.qu),f.Y36(kn.so),f.Y36(kn.WI))},R.\u0275cmp=f.Xpm({type:R,selectors:[["app-filtering-tree"]],decls:55,vars:8,consts:[["hasBackdrop","false"],["mat-dialog-content","",2,"width","100%"],["id","graph-container"],[1,"add-node-button-container"],["color","primary","mat-raised-button","",3,"click"],["mat-dialog-actions",""],["color","accent","mat-raised-button","",2,"margin-top","58rem","margin-right","2rem",3,"click"],["color","accent","mat-dialog-close","","mat-raised-button","",2,"margin-top","58rem","margin-right","2rem"],["mode","over","position","end",3,"opened"],["addSidePane",""],[1,"add-side-pane"],["mat-icon-button","",3,"click"],[3,"opened","closed"],[3,"formGroup"],[1,"wide-field"],["formControlName","_field","matInput","","name","_field","required","","type","text",1,"propery-input"],["formControlName","Command"],["value",">"],["value","<"],["value","="],["formControlName","_value","matInput","","name","_value","required","","type","text",1,"propery-input"],["color","primary","mat-raised-button","",3,"disabled","click"],[1,"add-buttons"],["color","primary","mat-raised-button","",3,"click",4,"ngIf"],["color","primary","mat-raised-button","","style","width: 10.3rem",3,"click",4,"ngIf"],["mode","side","opened","",4,"ngIf"],["color","primary","mat-raised-button","",2,"width","10.3rem",3,"click"],["mode","side","opened",""],["editSidePane",""],[1,"node-name-input"],["matInput","","placeholder","\u0646\u0627\u0645 \u06af\u0631\u0647","type","text","readonly","",2,"font-size","70%",3,"ngModel","ngModelChange"],["nodeNameInput","matInput"],[4,"ngIf"],[3,"expanded"],["matInput","","type","text",1,"propery-input",3,"ngModel","ngModelChange"],[3,"ngModel","ngModelChange"]],template:function(E,k){if(1&E){const O=f.EpF();f.TgZ(0,"mat-sidenav-container",0),f.TgZ(1,"mat-sidenav-content"),f.TgZ(2,"mat-sidenav-container",0),f.TgZ(3,"mat-sidenav-content"),f.TgZ(4,"div",1),f.TgZ(5,"div",2),f.TgZ(6,"div",3),f.TgZ(7,"button",4),f.NdJ("click",function(){return f.CHM(O),f.MAs(16).open()}),f.TgZ(8,"mat-icon"),f._uU(9,"add"),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.TgZ(10,"div",5),f.TgZ(11,"button",6),f.NdJ("click",function(){return k.handleSavingGraph()}),f._uU(12," \u0630\u062e\u06cc\u0631\u0647 "),f.qZA(),f.TgZ(13,"button",7),f._uU(14," \u0627\u0646\u0635\u0631\u0627\u0641 "),f.qZA(),f.qZA(),f.qZA(),f.TgZ(15,"mat-sidenav",8,9),f.TgZ(17,"div",10),f.TgZ(18,"h4"),f._uU(19," \u0627\u06cc\u062c\u0627\u062f \u06af\u0631\u0647 \u06cc \u062c\u062f\u06cc\u062f "),f.TgZ(20,"button",11),f.NdJ("click",function(){return f.CHM(O),f.MAs(16).close()}),f.TgZ(21,"mat-icon"),f._uU(22,"chevron_left"),f.qZA(),f.qZA(),f.qZA(),f._UZ(23,"mat-divider"),f.TgZ(24,"mat-accordion"),f.TgZ(25,"mat-expansion-panel",12),f.NdJ("opened",function(){return k.panelOpenState=!0})("closed",function(){return k.panelOpenState=!1}),f.TgZ(26,"mat-expansion-panel-header"),f.TgZ(27,"mat-panel-title"),f._uU(28," \u0637\u0631\u0627\u062d\u06cc \u06af\u0631\u0647 \u0634\u0631\u0637\u06cc "),f.qZA(),f.qZA(),f.TgZ(29,"form",13),f.TgZ(30,"mat-form-field",14),f.TgZ(31,"mat-label"),f._uU(32,"\u0646\u0627\u0645 \u0645\u062a\u063a\u06cc\u0631"),f.qZA(),f._UZ(33,"input",15),f.qZA(),f.TgZ(34,"mat-form-field",14),f.TgZ(35,"mat-label"),f._uU(36,"\u0639\u0645\u0644\u06af\u0631"),f.qZA(),f.TgZ(37,"mat-select",16),f.TgZ(38,"mat-option",17),f._uU(39," > "),f.qZA(),f.TgZ(40,"mat-option",18),f._uU(41," < "),f.qZA(),f.TgZ(42,"mat-option",19),f._uU(43,"="),f.qZA(),f.qZA(),f.qZA(),f.TgZ(44,"mat-form-field",14),f.TgZ(45,"mat-label"),f._uU(46," \u0639\u0645\u0644\u0648\u0646\u062f"),f.qZA(),f._UZ(47,"input",20),f.qZA(),f.TgZ(48,"button",21),f.NdJ("click",function(){return k.handleAddNode("condition")}),f._uU(49," \u0627\u0641\u0632\u0648\u062f\u0646 \u0634\u0631\u0637 "),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.TgZ(50,"div",22),f.YNc(51,_s,2,0,"button",23),f.YNc(52,Kr,2,0,"button",24),f.qZA(),f._UZ(53,"mat-divider"),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.YNc(54,Po,7,2,"mat-sidenav",25),f.qZA()}if(2&E){const O=f.MAs(16);f.xp6(6),f.ekj("invisible",O.opened),f.xp6(9),f.Q6J("opened",!1),f.xp6(14),f.Q6J("formGroup",k.form),f.xp6(19),f.Q6J("disabled",!k.form.valid),f.xp6(3),f.Q6J("ngIf",!k.panelOpenState),f.xp6(1),f.Q6J("ngIf",!k.panelOpenState),f.xp6(2),f.Q6J("ngIf",!!k.currentData)}},directives:[Ei.TM,Ei.Rh,kn.xY,_t.lW,sn.Hw,kn.H8,kn.ZT,Ei.JX,fn.d,Ti.pp,Ti.ib,Ti.yz,Ti.yK,qt._Y,qt.JL,qt.sg,Yt.KE,Yt.hX,qt.Fj,bn.Nt,qt.JJ,qt.u,qt.Q7,Ln.gD,un.ey,tt.O5,qt.On],styles:[".mat-drawer[_ngcontent-%COMP%]{width:100px}.mat-drawer-container[_ngcontent-%COMP%]{height:100%}#graph-container[_ngcontent-%COMP%]{overflow:hidden;display:block;position:absolute;height:64.2rem;width:100%}.add-node-button-container[_ngcontent-%COMP%]{position:absolute;top:0;left:0;margin:var(--density-large);transition:opacity .2s ease-in;opacity:1}.add-node-button-container.invisible[_ngcontent-%COMP%]{visibility:hidden;opacity:0}.mat-sidenav[_ngcontent-%COMP%]{width:31rem}.add-side-pane[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:var(--density-large);gap:var(--density-large);padding:var(--density-large)}.add-buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row;grid-gap:var(--density-large);gap:var(--density-large)}.node-name-input[_ngcontent-%COMP%]{font-size:20px}.node-name-input[_ngcontent-%COMP%]   .mat-form-field-underline[_ngcontent-%COMP%]{background-color:transparent}.wide-field[_ngcontent-%COMP%]{width:100%}.propery-input[_ngcontent-%COMP%]{direction:ltr;text-align:left}"]}),R})();function Va(R,F){if(1&R){const E=f.EpF();f.TgZ(0,"div"),f.TgZ(1,"button",1),f.NdJ("click",function(){return f.CHM(E),f.oxw().designClicked()}),f.TgZ(2,"mat-icon",2),f._uU(3,"launch"),f.qZA(),f._uU(4," \u0637\u0631\u0627\u062d\u06cc \u0641\u06cc\u0644\u062a\u0631 "),f.qZA(),f.qZA()}}let Do=(()=>{class R{constructor(E){this.dialog=E}ngOnInit(){}designClicked(){var E;this.dialog.open($r,{panelClass:"filterDialog",disableClose:!1,closeOnNavigation:!0,data:null===(E=this.node)||void 0===E?void 0:E.config}).afterClosed().subscribe(O=>{console.log(O),this.node.config=O})}}return R.\u0275fac=function(E){return new(E||R)(f.Y36(kn.uw))},R.\u0275cmp=f.Xpm({type:R,selectors:[["app-filter-config"]],inputs:{node:"node"},decls:1,vars:1,consts:[[4,"ngIf"],["mat-raised-button","","color","accent",3,"click"],[1,"mat-icon-rtl-mirror"]],template:function(E,k){1&E&&f.YNc(0,Va,5,0,"div",0),2&E&&f.Q6J("ngIf",void 0!==k.node)},directives:[tt.O5,_t.lW,sn.Hw],styles:[""]}),R})();var _r=wt(946);const Mi=["orderPanel"];function _(R,F){if(1&R){const E=f.EpF();f.TgZ(0,"mat-expansion-panel",5,6),f.TgZ(2,"mat-expansion-panel-header"),f.TgZ(3,"mat-panel-title"),f.TgZ(4,"mat-icon",7),f._uU(5," drag_handle "),f.qZA(),f.TgZ(6,"span"),f.TgZ(7,"bdo",8),f._uU(8),f.qZA(),f.qZA(),f.TgZ(9,"mat-icon",9),f._uU(10),f.qZA(),f.qZA(),f.qZA(),f.TgZ(11,"mat-form-field",10),f.TgZ(12,"mat-label"),f._uU(13,"\u0646\u0627\u0645 \u0645\u062a\u063a\u06cc\u0631"),f.qZA(),f.TgZ(14,"input",11),f.NdJ("ngModelChange",function(O){return f.CHM(E).$implicit.fieldName=O}),f.qZA(),f.qZA(),f.TgZ(15,"div",12),f.TgZ(16,"mat-checkbox",13),f.NdJ("ngModelChange",function(O){return f.CHM(E).$implicit.descending=O}),f._uU(17," \u0646\u0632\u0648\u0644\u06cc "),f.qZA(),f.TgZ(18,"button",14),f.NdJ("click",function(){const te=f.CHM(E).index;return f.oxw(2).removeOrder(te)}),f.TgZ(19,"mat-icon"),f._uU(20,"delete"),f.qZA(),f._uU(21," \u062d\u0630\u0641 "),f.qZA(),f.qZA(),f.qZA()}if(2&R){const E=F.$implicit;f.xp6(8),f.Oqu(E.fieldName),f.xp6(2),f.hij(" ",E.descending?"south":"north"," "),f.xp6(4),f.Q6J("ngModel",E.fieldName),f.xp6(2),f.Q6J("ngModel",E.descending)}}function A(R,F){if(1&R){const E=f.EpF();f.TgZ(0,"div"),f.TgZ(1,"div",1),f.TgZ(2,"h3"),f._uU(3,"\u0645\u0631\u062a\u0628\u200c\u0633\u0627\u0632\u06cc \u0628\u0631\u0627\u0633\u0627\u0633"),f.qZA(),f.TgZ(4,"button",2),f.NdJ("click",function(){return f.CHM(E),f.oxw().addOrder()}),f.TgZ(5,"mat-icon"),f._uU(6,"add"),f.qZA(),f.qZA(),f.qZA(),f.TgZ(7,"mat-accordion",3),f.NdJ("cdkDropListDropped",function(O){return f.CHM(E),f.oxw().dropOrder(O)}),f.YNc(8,_,22,4,"mat-expansion-panel",4),f.qZA(),f.qZA()}if(2&R){const E=f.oxw();f.xp6(8),f.Q6J("ngForOf",E.node.config.orders)}}let C=(()=>{class R{constructor(E){this.cdref=E,this.expandNewOrder=!1}ngOnInit(){}ngAfterViewChecked(){var E;this.expandNewOrder&&(this.expandNewOrder=!1,null===(E=this.firstOrderPanel)||void 0===E||E.open(),this.cdref.detectChanges())}addOrder(){var E;null===(E=this.node)||void 0===E||E.config.orders.unshift({fieldName:"",descending:!1}),this.expandNewOrder=!0}removeOrder(E){var k;null===(k=this.node)||void 0===k||k.config.orders.splice(E,1)}dropOrder(E){(0,Jn.bA)(this.node.config.orders,E.previousIndex,E.currentIndex)}}return R.\u0275fac=function(E){return new(E||R)(f.Y36(f.sBO))},R.\u0275cmp=f.Xpm({type:R,selectors:[["app-sort-config"]],viewQuery:function(E,k){if(1&E&&f.Gf(Mi,5),2&E){let O;f.iGM(O=f.CRH())&&(k.firstOrderPanel=O.first)}},inputs:{node:"node"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"config-title-add"],["mat-icon-button","","color","primary",3,"click"],["cdkDropList","",3,"cdkDropListDropped"],["cdkDrag","",4,"ngFor","ngForOf"],["cdkDrag",""],["orderPanel",""],["cdkDragHandle","",1,"drag-handle"],["dir","ltr"],[1,"sort-icon"],[1,"wide-field"],["matInput","","type","text","required","",1,"propery-input",3,"ngModel","ngModelChange"],[1,"inline-row"],[3,"ngModel","ngModelChange"],["mat-raised-button","","color","warn",3,"click"]],template:function(E,k){1&E&&f.YNc(0,A,9,1,"div",0),2&E&&f.Q6J("ngIf",void 0!==k.node)},directives:[tt.O5,_t.lW,sn.Hw,Ti.pp,Jn.Wj,tt.sg,Ti.ib,Jn.Zt,Ti.yz,Ti.yK,Jn.Bh,_r.Lv,Yt.KE,Yt.hX,bn.Nt,qt.Fj,qt.Q7,qt.JJ,qt.On,cn.oG],styles:["mat-panel-title[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;-webkit-user-select:none;user-select:none}.drag-handle[_ngcontent-%COMP%]{color:#0000008a;margin-left:var(--density-small);cursor:move}.sort-icon[_ngcontent-%COMP%]{transform:scale(.7)}.inline-row[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:space-between}"]}),R})();function T(R,F){if(1&R&&(f.TgZ(0,"mat-option",6),f._uU(1),f.qZA()),2&R){const E=F.$implicit,k=f.oxw(2);f.Q6J("value",E),f.xp6(1),f.hij(" ",k.joinTypeInfo[E].title," ")}}function z(R,F){if(1&R&&(f.TgZ(0,"mat-option",6),f._uU(1),f.qZA()),2&R){const E=F.$implicit;f.Q6J("value",E.id),f.xp6(1),f.hij(" ",E.name," ")}}function U(R,F){if(1&R){const E=f.EpF();f.TgZ(0,"div"),f.TgZ(1,"h3"),f._uU(2,"\u0627\u0637\u0644\u0627\u0639\u0627\u062a \u0627\u0644\u062d\u0627\u0642"),f.qZA(),f.TgZ(3,"mat-form-field",1),f.TgZ(4,"mat-label"),f._uU(5,"\u0646\u0648\u0639"),f.qZA(),f.TgZ(6,"mat-select",2),f.NdJ("ngModelChange",function(O){return f.CHM(E),f.oxw().node.config.type=O}),f.YNc(7,T,2,2,"mat-option",3),f.qZA(),f.qZA(),f.TgZ(8,"mat-form-field",1),f.TgZ(9,"mat-label"),f._uU(10,"\u062f\u06cc\u062a\u0627\u0633\u062a \u0631\u0627\u0633\u062a"),f.qZA(),f.TgZ(11,"mat-select",4),f.NdJ("ngModelChange",function(O){return f.CHM(E),f.oxw().node.config.joinWith=O}),f._UZ(12,"mat-option"),f.YNc(13,z,2,2,"mat-option",3),f.ALo(14,"async"),f.qZA(),f.TgZ(15,"mat-error"),f._uU(16,"\u0644\u0637\u0641\u0627\u064b \u06cc\u06a9 \u062f\u06cc\u062a\u0627\u0633\u062a \u0627\u0646\u062a\u062e\u0627\u0628 \u06a9\u0646\u06cc\u062f"),f.qZA(),f.qZA(),f.TgZ(17,"mat-form-field",1),f.TgZ(18,"mat-label"),f._uU(19,"\u06a9\u0644\u06cc\u062f \u0686\u067e"),f.qZA(),f.TgZ(20,"input",5),f.NdJ("ngModelChange",function(O){return f.CHM(E),f.oxw().node.config.leftTableKey=O}),f.qZA(),f.qZA(),f.TgZ(21,"mat-form-field",1),f.TgZ(22,"mat-label"),f._uU(23,"\u06a9\u0644\u06cc\u062f \u0631\u0627\u0633\u062a"),f.qZA(),f.TgZ(24,"input",5),f.NdJ("ngModelChange",function(O){return f.CHM(E),f.oxw().node.config.rightTableKey=O}),f.qZA(),f.qZA(),f.qZA()}if(2&R){const E=f.oxw();f.xp6(6),f.Q6J("ngModel",E.node.config.type),f.xp6(1),f.Q6J("ngForOf",E.joinType),f.xp6(4),f.Q6J("ngModel",E.node.config.joinWith),f.xp6(2),f.Q6J("ngForOf",f.lcZ(14,6,E.store.datasets)),f.xp6(7),f.Q6J("ngModel",E.node.config.leftTableKey),f.xp6(4),f.Q6J("ngModel",E.node.config.rightTableKey)}}let de=(()=>{class R{constructor(){this.joinTypeInfo=Mo,this.joinType=Object.values(hr)}ngOnInit(){var E;null===(E=this.store)||void 0===E||E.update()}}return R.\u0275fac=function(E){return new(E||R)},R.\u0275cmp=f.Xpm({type:R,selectors:[["app-join-config"]],inputs:{node:"node",store:"store"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"wide-field"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["required","",3,"ngModel","ngModelChange"],["matInput","","type","text","required","",1,"propery-input",3,"ngModel","ngModelChange"],[3,"value"]],template:function(E,k){1&E&&f.YNc(0,U,25,8,"div",0),2&E&&f.Q6J("ngIf",void 0!==k.node&&void 0!==k.store)},directives:[tt.O5,Yt.KE,Yt.hX,Ln.gD,qt.JJ,qt.On,tt.sg,qt.Q7,un.ey,Yt.TO,bn.Nt,qt.Fj],pipes:[tt.Ov],styles:[""]}),R})();const ne=["groupByPanel"],oe=["operationPanel"];function G(R,F){if(1&R){const E=f.EpF();f.TgZ(0,"mat-expansion-panel",null,4),f.TgZ(2,"mat-expansion-panel-header"),f.TgZ(3,"mat-panel-title"),f.TgZ(4,"span"),f.TgZ(5,"bdo",5),f._uU(6),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.TgZ(7,"mat-form-field",6),f.TgZ(8,"mat-label"),f._uU(9,"\u0646\u0627\u0645 \u0645\u062a\u063a\u06cc\u0631"),f.qZA(),f.TgZ(10,"input",7),f.NdJ("ngModelChange",function(O){const Xe=f.CHM(E).index;return f.oxw(3).node.config.groupBy[Xe]=O}),f.qZA(),f.qZA(),f.TgZ(11,"div",8),f._UZ(12,"div"),f.TgZ(13,"button",9),f.NdJ("click",function(){const te=f.CHM(E).index;return f.oxw(3).removeGroupBy(te)}),f.TgZ(14,"mat-icon"),f._uU(15,"delete"),f.qZA(),f._uU(16," \u062d\u0630\u0641 "),f.qZA(),f.qZA(),f.qZA()}if(2&R){const E=F.$implicit,k=F.index,O=f.oxw(3);f.xp6(6),f.Oqu(E),f.xp6(4),f.Q6J("ngModel",O.node.config.groupBy[k])}}function ee(R,F){if(1&R&&(f.TgZ(0,"mat-accordion"),f.YNc(1,G,17,2,"mat-expansion-panel",3),f.qZA()),2&R){const E=f.oxw(2);f.xp6(1),f.Q6J("ngForOf",E.node.config.groupBy)("ngForTrackBy",E.trackByIndex)}}function ve(R,F){if(1&R&&(f.TgZ(0,"mat-option",14),f._uU(1),f.qZA()),2&R){const E=F.$implicit,k=f.oxw(4);f.Q6J("value",E),f.xp6(1),f.hij(" ",k.aggregateOperationTypeInfo[E].title," ")}}function q(R,F){if(1&R){const E=f.EpF();f.TgZ(0,"mat-expansion-panel",null,11),f.TgZ(2,"mat-expansion-panel-header"),f.TgZ(3,"mat-panel-title"),f.TgZ(4,"span"),f.TgZ(5,"span"),f._uU(6),f.TgZ(7,"bdo",5),f._uU(8),f.qZA(),f._uU(9," \u0628\u0647 \u0639\u0646\u0648\u0627\u0646 "),f.TgZ(10,"bdo",5),f._uU(11),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.TgZ(12,"mat-form-field",6),f.TgZ(13,"mat-label"),f._uU(14,"\u0646\u0627\u0645 \u0645\u062a\u063a\u06cc\u0631"),f.qZA(),f.TgZ(15,"input",7),f.NdJ("ngModelChange",function(O){return f.CHM(E).$implicit.fieldName=O}),f.qZA(),f.qZA(),f.TgZ(16,"mat-form-field",6),f.TgZ(17,"mat-label"),f._uU(18,"\u0646\u0648\u0639 \u0639\u0645\u0644\u06cc\u062a"),f.qZA(),f.TgZ(19,"mat-select",12),f.NdJ("ngModelChange",function(O){return f.CHM(E).$implicit.type=O}),f.YNc(20,ve,2,2,"mat-option",13),f.qZA(),f.qZA(),f.TgZ(21,"mat-form-field",6),f.TgZ(22,"mat-label"),f._uU(23,"\u0646\u0627\u0645 \u0645\u062a\u063a\u06cc\u0631 \u062e\u0631\u0648\u062c\u06cc"),f.qZA(),f.TgZ(24,"input",7),f.NdJ("ngModelChange",function(O){return f.CHM(E).$implicit.outputFieldName=O}),f.qZA(),f.qZA(),f.TgZ(25,"div",8),f._UZ(26,"div"),f.TgZ(27,"button",9),f.NdJ("click",function(){const te=f.CHM(E).index;return f.oxw(3).removeOperation(te)}),f.TgZ(28,"mat-icon"),f._uU(29,"delete"),f.qZA(),f._uU(30," \u062d\u0630\u0641 "),f.qZA(),f.qZA(),f.qZA()}if(2&R){const E=F.$implicit,k=f.oxw(3);f.xp6(6),f.hij(" ",k.aggregateOperationTypeInfo[E.type].title," "),f.xp6(2),f.Oqu(E.fieldName),f.xp6(3),f.Oqu(E.outputFieldName),f.xp6(4),f.Q6J("ngModel",E.fieldName),f.xp6(4),f.Q6J("ngModel",E.type),f.xp6(1),f.Q6J("ngForOf",k.aggregateOperationType),f.xp6(4),f.Q6J("ngModel",E.outputFieldName)}}function Q(R,F){if(1&R&&(f.TgZ(0,"mat-accordion"),f.YNc(1,q,31,7,"mat-expansion-panel",10),f.qZA()),2&R){const E=f.oxw(2);f.xp6(1),f.Q6J("ngForOf",E.node.config.operations)}}function $(R,F){if(1&R){const E=f.EpF();f.TgZ(0,"div"),f.TgZ(1,"div",1),f.TgZ(2,"h3"),f._uU(3,"\u06af\u0631\u0648\u0647\u200c\u0628\u0646\u062f\u06cc \u0628\u0631 \u0627\u0633\u0627\u0633"),f.qZA(),f.TgZ(4,"button",2),f.NdJ("click",function(){return f.CHM(E),f.oxw().addGroupBy()}),f.TgZ(5,"mat-icon"),f._uU(6,"add"),f.qZA(),f.qZA(),f.qZA(),f.YNc(7,ee,2,2,"mat-accordion",0),f._UZ(8,"br"),f.TgZ(9,"div",1),f.TgZ(10,"h3"),f._uU(11,"\u0639\u0645\u0644\u06cc\u0627\u062a"),f.qZA(),f.TgZ(12,"button",2),f.NdJ("click",function(){return f.CHM(E),f.oxw().addOperation()}),f.TgZ(13,"mat-icon"),f._uU(14,"add"),f.qZA(),f.qZA(),f.qZA(),f.YNc(15,Q,2,1,"mat-accordion",0),f.qZA()}if(2&R){const E=f.oxw();f.xp6(7),f.Q6J("ngIf",void 0!==E.node.config.groupBy),f.xp6(8),f.Q6J("ngIf",void 0!==E.node.config.operations)}}let ue=(()=>{class R{constructor(E){this.cdref=E,this.expandNewGroupBy=!1,this.expandNewOperation=!1,this.aggregateOperationTypeInfo=ui,this.aggregateOperationType=Object.values(Ri)}ngOnInit(){}ngAfterViewChecked(){var E,k;let O=!1;this.expandNewGroupBy&&(this.expandNewGroupBy=!1,null===(E=this.firstGroupByPanel)||void 0===E||E.open(),O=!0),this.expandNewOperation&&(this.expandNewOperation=!1,null===(k=this.firstOperationPanel)||void 0===k||k.open(),O=!0),O&&this.cdref.detectChanges()}trackByIndex(E,k){return E}addGroupBy(){var E,k;null===(k=null===(E=this.node)||void 0===E?void 0:E.config.groupBy)||void 0===k||k.unshift(""),this.expandNewGroupBy=!0}removeGroupBy(E){var k,O;null===(O=null===(k=this.node)||void 0===k?void 0:k.config.groupBy)||void 0===O||O.splice(E,1)}addOperation(){var E,k;null===(k=null===(E=this.node)||void 0===E?void 0:E.config.operations)||void 0===k||k.unshift({fieldName:"",type:Ri.count,outputFieldName:""}),this.expandNewOperation=!0}removeOperation(E){var k,O;null===(O=null===(k=this.node)||void 0===k?void 0:k.config.operations)||void 0===O||O.splice(E,1)}}return R.\u0275fac=function(E){return new(E||R)(f.Y36(f.sBO))},R.\u0275cmp=f.Xpm({type:R,selectors:[["app-aggregate-config"]],viewQuery:function(E,k){if(1&E&&(f.Gf(ne,5),f.Gf(oe,5)),2&E){let O;f.iGM(O=f.CRH())&&(k.firstGroupByPanel=O.first),f.iGM(O=f.CRH())&&(k.firstOperationPanel=O.first)}},inputs:{node:"node"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"config-title-add"],["mat-icon-button","","color","primary",3,"click"],[4,"ngFor","ngForOf","ngForTrackBy"],["groupByPanel",""],["dir","ltr"],[1,"wide-field"],["matInput","","type","text","required","",1,"propery-input",3,"ngModel","ngModelChange"],[1,"delete-row"],["mat-raised-button","","color","warn",3,"click"],[4,"ngFor","ngForOf"],["operationPanel",""],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(E,k){1&E&&f.YNc(0,$,16,2,"div",0),2&E&&f.Q6J("ngIf",void 0!==k.node)},directives:[tt.O5,_t.lW,sn.Hw,Ti.pp,tt.sg,Ti.ib,Ti.yz,Ti.yK,_r.Lv,Yt.KE,Yt.hX,bn.Nt,qt.Fj,qt.Q7,qt.JJ,qt.On,Ln.gD,un.ey],styles:["mat-panel-title[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;-webkit-user-select:none;user-select:none}.drag-handle[_ngcontent-%COMP%]{color:#0000008a;margin-left:var(--density-small);cursor:move}.delete-row[_ngcontent-%COMP%]{display:flex;flex-direction:row-reverse}"]}),R})();const ge=["diagram"];function Se(R,F){if(1&R){const E=f.EpF();f.TgZ(0,"mat-toolbar",2),f.TgZ(1,"a",3),f.TgZ(2,"mat-icon"),f._uU(3,"call_split"),f.qZA(),f.TgZ(4,"span",4),f._uU(5," \u0633\u0646\u0627\u0631\u06cc\u0648\u0686\u06cc"),f.qZA(),f.qZA(),f.TgZ(6,"span",5),f.TgZ(7,"button",6),f.NdJ("click",function(){return f.CHM(E),f.oxw().runPipeline()}),f.TgZ(8,"mat-icon",7),f._uU(9," play_arrow "),f.qZA(),f.qZA(),f.TgZ(10,"mat-form-field",8),f.TgZ(11,"mat-label"),f._uU(12,"\u0646\u0627\u0645 \u0633\u0646\u0627\u0631\u06cc\u0648"),f.qZA(),f.TgZ(13,"input",9,10),f.NdJ("ngModelChange",function(O){return f.CHM(E),f.oxw().pipeline.name=O}),f.qZA(),f.TgZ(15,"button",11),f.TgZ(16,"mat-icon"),f._uU(17,"edit"),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.TgZ(18,"nav"),f.TgZ(19,"button",12),f.NdJ("click",function(){return f.CHM(E),f.oxw().savePipeline()}),f.TgZ(20,"mat-icon"),f._uU(21,"save"),f.qZA(),f.qZA(),f.TgZ(22,"button",13),f.NdJ("click",function(){return f.CHM(E),f.oxw().downloadPipeline()}),f.TgZ(23,"mat-icon"),f._uU(24,"file_download"),f.qZA(),f.qZA(),f.TgZ(25,"button",14),f.NdJ("click",function(){return f.CHM(E),f.MAs(29).click()}),f.TgZ(26,"mat-icon"),f._uU(27,"file_upload"),f.qZA(),f.qZA(),f.TgZ(28,"input",15,16),f.NdJ("change",function(O){return f.CHM(E),f.oxw().importPipeline(O)}),f.qZA(),f.TgZ(30,"button",17),f.TgZ(31,"mat-icon"),f._uU(32,"person"),f.qZA(),f.qZA(),f.TgZ(33,"mat-menu",null,18),f.TgZ(35,"button",19),f.TgZ(36,"mat-icon"),f._uU(37,"dashboard"),f.qZA(),f._uU(38," \u062f\u0627\u0634\u0628\u0648\u0631\u062f "),f.qZA(),f.TgZ(39,"button",20),f.TgZ(40,"mat-icon"),f._uU(41,"manage_accounts"),f.qZA(),f._uU(42," \u0645\u062f\u06cc\u0631\u06cc\u062a \u062d\u0633\u0627\u0628 "),f.qZA(),f.TgZ(43,"button",21),f.TgZ(44,"mat-icon"),f._uU(45,"exit_to_app"),f.qZA(),f._uU(46," \u062e\u0631\u0648\u062c "),f.qZA(),f.qZA(),f.qZA(),f.qZA()}if(2&R){const E=f.MAs(14),k=f.MAs(34),O=f.oxw();f.xp6(13),f.Q6J("ngModel",O.pipeline.name),f.xp6(2),f.Udp("visibility",E.focused?"":"hidden"),f.xp6(15),f.Q6J("matMenuTriggerFor",k)}}function Oe(R,F){1&R&&(f.TgZ(0,"h2",27),f.TgZ(1,"mat-icon"),f._uU(2,"info"),f.qZA(),f._uU(3," \u067e\u0631\u062f\u0627\u0632\u0634\u06cc \u0627\u0646\u062a\u062e\u0627\u0628 \u0646\u0634\u062f\u0647 "),f.qZA())}function Ce(R,F){if(1&R&&f._UZ(0,"app-input-config",35),2&R){const E=f.oxw(3);f.Q6J("node",E.selectedNode)("store",E.datasetStore)}}function fe(R,F){if(1&R&&f._UZ(0,"app-output-config",35),2&R){const E=f.oxw(3);f.Q6J("node",E.selectedNode)("store",E.datasetStore)}}function ie(R,F){if(1&R&&f._UZ(0,"app-filter-config",36),2&R){const E=f.oxw(3);f.Q6J("node",E.selectedNode)}}function le(R,F){if(1&R&&f._UZ(0,"app-sort-config",36),2&R){const E=f.oxw(3);f.Q6J("node",E.selectedNode)}}function ae(R,F){if(1&R&&f._UZ(0,"app-join-config",35),2&R){const E=f.oxw(3);f.Q6J("node",E.selectedNode)("store",E.datasetStore)}}function st(R,F){if(1&R&&f._UZ(0,"app-aggregate-config",36),2&R){const E=f.oxw(3);f.Q6J("node",E.selectedNode)}}function ht(R,F){if(1&R){const E=f.EpF();f.TgZ(0,"div",28),f.TgZ(1,"mat-form-field",29),f.TgZ(2,"input",9,30),f.NdJ("ngModelChange",function(O){return f.CHM(E),f.oxw(2).selectedNode.name=O}),f.qZA(),f.TgZ(4,"button",11),f.TgZ(5,"mat-icon"),f._uU(6,"edit"),f.qZA(),f.qZA(),f.TgZ(7,"mat-hint",31),f.TgZ(8,"mat-icon"),f._uU(9),f.qZA(),f.TgZ(10,"span"),f._uU(11),f.qZA(),f.qZA(),f.qZA(),f.TgZ(12,"div",32),f.YNc(13,Ce,1,2,"app-input-config",33),f.YNc(14,fe,1,2,"app-output-config",33),f.YNc(15,ie,1,1,"app-filter-config",34),f.YNc(16,le,1,1,"app-sort-config",34),f.YNc(17,ae,1,2,"app-join-config",33),f.YNc(18,st,1,1,"app-aggregate-config",34),f.qZA(),f.qZA()}if(2&R){const E=f.MAs(3),k=f.oxw(2);f.xp6(2),f.Q6J("ngModel",k.selectedNode.name),f.xp6(2),f.Udp("visibility",E.focused?"":"hidden"),f.xp6(4),f.ekj("mat-icon-rtl-mirror",k.pipelineNodeInfo[k.selectedNode.type].iconMirrored),f.xp6(1),f.hij(" ",k.pipelineNodeInfo[k.selectedNode.type].iconName," "),f.xp6(2),f.Oqu(k.pipelineNodeInfo[k.selectedNode.type].title),f.xp6(1),f.Q6J("ngSwitch",k.selectedNode.type),f.xp6(1),f.Q6J("ngSwitchCase",k.PipelineNodeType.datasetInput),f.xp6(1),f.Q6J("ngSwitchCase",k.PipelineNodeType.datasetOutput),f.xp6(1),f.Q6J("ngSwitchCase",k.PipelineNodeType.filter),f.xp6(1),f.Q6J("ngSwitchCase",k.PipelineNodeType.sort),f.xp6(1),f.Q6J("ngSwitchCase",k.PipelineNodeType.join),f.xp6(1),f.Q6J("ngSwitchCase",k.PipelineNodeType.aggregate)}}function it(R,F){if(1&R){const E=f.EpF();f.TgZ(0,"mat-sidenav-container"),f.TgZ(1,"mat-sidenav",22),f.YNc(2,Oe,4,0,"h2",23),f.YNc(3,ht,19,14,"div",24),f.qZA(),f.TgZ(4,"mat-sidenav-content"),f.TgZ(5,"app-diagram",25,26),f.NdJ("selectedNode",function(O){return f.CHM(E),f.oxw().selectedNode=O}),f.qZA(),f.qZA(),f.qZA()}if(2&R){const E=f.oxw();f.xp6(2),f.Q6J("ngIf",void 0===E.selectedNode),f.xp6(1),f.Q6J("ngIf",void 0!==E.selectedNode),f.xp6(2),f.Q6J("pipeline",E.pipeline)}}let H=(()=>{class R{constructor(E,k,O,te,Xe,Rt){this.route=E,this.router=k,this.pipelineService=O,this.auth=te,this.datasetStore=Xe,this.snackBar=Rt,this.pipelineNodeInfo=gi,this.PipelineNodeType=ft}ngOnInit(){this.route.paramMap.subscribe(E=>{const k=parseInt(E.get("id"));this.pipelineService.get(k).subscribe({next:O=>{this.pipeline=li(O)},error:()=>{this.snackBar.open("\u0627\u0634\u06a9\u0627\u0644 \u062f\u0631 \u062f\u0631\u06cc\u0627\u0641\u062a \u0633\u0646\u0627\u0631\u06cc\u0648","",{duration:3e3,verticalPosition:"bottom",horizontalPosition:"center",panelClass:"red-snackbar"})}})})}ngAfterContentInit(){}ngAfterViewInit(){}runPipeline(){var E;null===(E=this.pipeline)||void 0===E||E.validate(this.datasetStore).subscribe(k=>{if(Sr(k)){const te=Ko(k)[0].value;return void this.snackBar.open(te,"",{duration:3e3,verticalPosition:"bottom",horizontalPosition:"center",panelClass:"red-snackbar"})}const O=this.basicValidateAndExportPipeline();!O||this.pipelineService.update(O).subscribe({next:()=>{this.pipelineService.execute(this.pipeline.id).subscribe({next:()=>{this.snackBar.open("\u0633\u0646\u0627\u0631\u06cc\u0648 \u0628\u0627 \u0645\u0648\u0641\u0642\u06cc\u062a \u062f\u0631 \u062d\u0627\u0644 \u0627\u062c\u0631\u0627 \u0627\u0633\u062a\u061f","",{duration:3e3,verticalPosition:"bottom",horizontalPosition:"center",panelClass:"green-snackbar"})},error:te=>{console.error(te),this.snackBar.open("\u0627\u0634\u06a9\u0627\u0644 \u062f\u0631 \u0627\u062c\u0631\u0627\u06cc \u0633\u0646\u0627\u0631\u06cc\u0648","",{duration:3e3,verticalPosition:"bottom",horizontalPosition:"center",panelClass:"red-snackbar"})}})},error:()=>{this.snackBar.open("\u0627\u0634\u06a9\u0627\u0644 \u062f\u0631 \u0630\u062e\u06cc\u0631\u0647 \u0633\u0646\u0627\u0631\u06cc\u0648","",{duration:3e3,verticalPosition:"bottom",horizontalPosition:"center",panelClass:"red-snackbar"})}})})}basicValidateAndExportPipeline(){let k,E=this.pipeline.reorder();if(!Sr(E)){try{k=pr(this.pipeline)}catch(O){return console.error(O),void this.snackBar.open(O.message,"",{duration:3e3,verticalPosition:"bottom",horizontalPosition:"center",panelClass:"red-snackbar"})}return k}{console.error(E);const O=Ko(E)[0].value;this.snackBar.open(O,"",{duration:3e3,verticalPosition:"bottom",horizontalPosition:"center",panelClass:"red-snackbar"})}}savePipeline(){const E=this.basicValidateAndExportPipeline();!E||this.pipelineService.update(E).subscribe({next:()=>{this.snackBar.open("\u0633\u0646\u0627\u0631\u06cc\u0648 \u0628\u0627 \u0645\u0648\u0641\u0642\u06cc\u062a \u0630\u062e\u06cc\u0631\u0647 \u0634\u062f","",{duration:3e3,verticalPosition:"bottom",horizontalPosition:"center",panelClass:"green-snackbar"})},error:()=>{this.snackBar.open("\u0627\u0634\u06a9\u0627\u0644 \u062f\u0631 \u0630\u062e\u06cc\u0631\u0647 \u0633\u0646\u0627\u0631\u06cc\u0648","",{duration:3e3,verticalPosition:"bottom",horizontalPosition:"center",panelClass:"red-snackbar"})}})}downloadPipeline(){const E=this.basicValidateAndExportPipeline();if(!E)return;E.pipelineId=void 0;const k=JSON.stringify(E,null,4);console.log(k),Pa()(k,"pipeline.json")}importPipeline(E){var k=this;return(0,vn.Z)(function*(){var O;const Xe=yield E.target.files.item(0).text(),Rt=li(JSON.parse(Xe));Rt.id=null===(O=k.pipeline)||void 0===O?void 0:O.id,k.pipeline=Rt,E.target.value=""})()}logOut(){this.auth.authToken=null,this.router.navigate(["/"])}}return R.\u0275fac=function(E){return new(E||R)(f.Y36(Fr.gz),f.Y36(Fr.F0),f.Y36(Fa.n),f.Y36(fr.e),f.Y36(Jr),f.Y36(Qr.ux))},R.\u0275cmp=f.Xpm({type:R,selectors:[["app-pipeline"]],viewQuery:function(E,k){if(1&E&&f.Gf(ge,5),2&E){let O;f.iGM(O=f.CRH())&&(k.diagram=O.first)}},decls:2,vars:2,consts:[["color","primary",4,"ngIf"],[4,"ngIf"],["color","primary"],["routerLink","/","mat-flat-button","","disableRipple","","color","primary"],[1,"logo-name"],[1,"pipeline-info"],["title","\u0627\u062c\u0631\u0627","mat-icon-button","","mat-raised-button","","mat-tip","",3,"click"],["color","primary",1,"mat-icon-rtl-mirror"],["floatLabel","never"],["matInput","","type","text",3,"ngModel","ngModelChange"],["pipelineNameInput","matInput"],["matSuffix","","mat-icon-button","","disabled","",2,"color","inherit"],["title","\u0630\u062e\u06cc\u0631\u0647","mat-icon-button","",3,"click"],["title","\u062f\u0627\u0646\u0644\u0648\u062f \u0633\u0646\u0627\u0631\u06cc\u0648","mat-icon-button","",3,"click"],["title","\u0622\u067e\u0644\u0648\u062f \u0633\u0646\u0627\u0631\u06cc\u0648","mat-icon-button","",3,"click"],["type","file","hidden","",3,"change"],["pipelineImport",""],["mat-button","",3,"matMenuTriggerFor"],["accountMenu","matMenu"],["mat-menu-item","","routerLink","/"],["mat-menu-item","","routerLink","/user/edit_profile"],["mat-menu-item","","click","logOut()"],["mode","side","opened","","disableClose",""],["class","no-selected-node",4,"ngIf"],["class","config-pane",4,"ngIf"],[3,"pipeline","selectedNode"],["diagram",""],[1,"no-selected-node"],[1,"config-pane"],[1,"node-name-input"],["nodeNameInput","matInput"],[1,"node-type-info"],[3,"ngSwitch"],[3,"node","store",4,"ngSwitchCase"],[3,"node",4,"ngSwitchCase"],[3,"node","store"],[3,"node"]],template:function(E,k){1&E&&(f.YNc(0,Se,47,4,"mat-toolbar",0),f.YNc(1,it,7,3,"mat-sidenav-container",1)),2&E&&(f.Q6J("ngIf",void 0!==k.pipeline),f.xp6(1),f.Q6J("ngIf",void 0!==k.pipeline))},directives:[tt.O5,Da.Ye,Fr.yS,_t.zs,sn.Hw,_t.lW,Yt.KE,Yt.hX,bn.Nt,qt.Fj,qt.JJ,qt.On,Yt.R9,En.p6,En.VK,En.OP,Fr.rH,Ei.TM,Ei.JX,Ei.Rh,$o,Yt.bx,tt.RF,tt.n9,gr,ta,Do,C,de,ue],styles:["[_nghost-%COMP%]{display:grid;grid-template-rows:auto 1fr;height:100%}.mat-toolbar[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;z-index:2}.logo-name[_ngcontent-%COMP%]{font-size:20px}.pipeline-info[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:baseline;grid-gap:var(--density-large);gap:var(--density-large);font-size:16px}.pipeline-info[_ngcontent-%COMP%]     .mat-form-field-underline{background-color:transparent}nav[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;grid-gap:var(--density-large);gap:var(--density-large)}.mat-sidenav[_ngcontent-%COMP%]{width:30rem}.no-selected-node[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center;grid-gap:var(--density-normal);gap:var(--density-normal);padding:var(--density-larger);color:#0000008a}.config-pane[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100%;padding:var(--density-large);padding-top:0;grid-gap:var(--density-larger);gap:var(--density-larger)}.config-pane[_ngcontent-%COMP%]     .wide-field{width:100%}.config-pane[_ngcontent-%COMP%]     .propery-input{direction:ltr;text-align:left}.config-pane[_ngcontent-%COMP%]     .config-title-add{display:flex;flex-direction:row;align-items:baseline;justify-content:space-between}.node-name-input[_ngcontent-%COMP%]{font-size:20px}.node-name-input[_ngcontent-%COMP%]     .mat-form-field-underline{background-color:transparent}.node-type-info[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;grid-gap:var(--density-small);gap:var(--density-small)}"]}),R})();var be=wt(4473),I=wt(5826);const ye=[{path:":id",canActivate:[I.a],component:H},{path:"",canActivate:[I.a],component:ps},{path:"**",redirectTo:"/"}];let Pe=(()=>{class R{}return R.\u0275fac=function(E){return new(E||R)},R.\u0275mod=f.oAB({type:R}),R.\u0275inj=f.cJS({providers:[nr,fr.e,Jr,I.a],imports:[[tt.ez,Fr.Bz.forChild(ye),be.q,qt.u5,qt.UX]]}),R})()},7646:function(Yr,dn,wt){(Yr=wt.nmd(Yr)).exports=function(){"use strict";function tt(e){return"function"==typeof e||"[object Function]"===tr.call(e)}function vn(e){var i,t=(i=Number(e),isNaN(i)?0:0!==i&&isFinite(i)?(0<i?1:-1)*Math.floor(Math.abs(i)):i);return Math.min(Math.max(t,0),dr)}var tr,dr;Array.prototype.fill||Object.defineProperty(Array.prototype,"fill",{value:function(e){if(null==this)throw new TypeError("this is null or not defined");for(var t=Object(this),n=t.length>>>0,i=arguments[1]>>0,r=i<0?Math.max(n+i,0):Math.min(i,n),o=arguments[2],a=void 0===o?n:o>>0,s=a<0?Math.max(n+a,0):Math.min(a,n);r<s;)t[r]=e,r++;return t}}),Array.prototype.copyWithin||(Array.prototype.copyWithin=function(e,t){if(null==this)throw new TypeError("this is null or not defined");var n=Object(this),i=n.length>>>0,r=e>>0,o=r<0?Math.max(i+r,0):Math.min(r,i),a=t>>0,s=a<0?Math.max(i+a,0):Math.min(a,i),l=arguments[2],u=void 0===l?i:l>>0,d=u<0?Math.max(i+u,0):Math.min(u,i),c=Math.min(d-s,i-o),h=1;for(s<o&&o<s+c&&(h=-1,s+=c-1,o+=c-1);0<c;)s in n?n[o]=n[s]:delete n[o],s+=h,o+=h,c--;return n}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(e){if(null==this)throw new TypeError;var t=Object(this),n=t.length>>>0;if(0==n)return-1;var i=n-1;1<arguments.length&&((i=Number(arguments[1]))!=i?i=0:0!=i&&i!=1/0&&i!=-1/0&&(i=(0<i?1:-1)*Math.floor(Math.abs(i))));for(var r=0<=i?Math.min(i,n-1):n-Math.abs(i);0<=r;r--)if(r in t&&t[r]===e)return r;return-1}),Array.from||(Array.from=(tr=Object.prototype.toString,dr=Math.pow(2,53)-1,function(e,t,n){var i=Object(e);if(null==e)throw new TypeError("Array.from requires an array-like object - not null or undefined");var r,o=1<arguments.length?t:void 0;if(void 0!==o){if(!tt(o))throw new TypeError("Array.from: when provided, the second argument must be a function");2<arguments.length&&(r=n)}for(var a,s=vn(i.length),l=tt(this)?Object(new this(s)):new Array(s),u=0;u<s;)a=i[u],l[u]=o?void 0===r?o(a,u):o.call(r,a,u):a,u+=1;return l.length=s,l})),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),i=n.length>>>0;if(0==i)return!1;for(var r,o,a=0|t,s=Math.max(0<=a?a:i-Math.abs(a),0);s<i;){if((r=n[s])===(o=e)||"number"==typeof r&&"number"==typeof o&&isNaN(r)&&isNaN(o))return!0;s++}return!1}}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var i=arguments[1],r=0;r<n;){var o=t[r];if(e.call(i,o,r,t))return o;r++}},configurable:!0,writable:!0});var Er=[Uint32Array,Uint16Array,Uint8Array,Int32Array,Int16Array,Int8Array,Float32Array,Float64Array],Zi=["join","slice","reverse","forEach","map","includes","copyWithin","reduce","indexOf","sort","filter","every","some","fill"];ArrayBuffer.isView||(ArrayBuffer.isView=function(e){for(var t=0;t<Er.length;++t)if(e instanceof Er[t])return!0;return!1});for(var cr,To=function(e){return function(t,n){return new e(Array.prototype.slice.call(this,t,n))}},hr=function(e){for(var t=0,n=Zi;t<n.length;t++){var i=n[t];if(!e.prototype[i]){var r="slice"===i?To(e):Array.prototype[i];e.prototype[i]=r}}e.from||(e.from=function(o,a,s){var l=e.__proto__;if("function"!=typeof this)throw new TypeError("# is not a constructor");if(this.__proto__!==l)throw new TypeError("this is not a typed array.");if("function"!=typeof(a=a||function(h){return h}))throw new TypeError("specified argument is not a function");if(!(o=Object(o)).length)return new this(0);for(var u=[],d=0;d<o.length;d++)u.push(o[d]);var c=new this((u=u.map(a,s)).length);for(d=0;d<c.length;d++)c[d]=u[d];return c})},Mo=0,Ri=Er;Mo<Ri.length;Mo++)hr(Ri[Mo]);function ui(){}function ft(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],La(e,this)}function gi(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,ft._immediateFn(function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var i;try{i=n(e._value)}catch(r){return void zi(t.promise,r)}Ci(t.promise,i)}else(1===e._state?Ci:zi)(t.promise,e._value)})):e._deferreds.push(t)}function Ci(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof ft)return e._state=3,e._value=t,void lo(e);if("function"==typeof n)return void La((i=n,r=t,function(){i.apply(r,arguments)}),e)}e._state=1,e._value=t,lo(e)}catch(o){zi(e,o)}var i,r}function zi(e,t){e._state=2,e._value=t,lo(e)}function lo(e){2===e._state&&0===e._deferreds.length&&ft._immediateFn(function(){e._handled||ft._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)gi(e,e._deferreds[t]);e._deferreds=null}function cs(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function La(e,t){var n=!1;try{e(function(i){n||(n=!0,Ci(t,i))},function(i){n||(n=!0,zi(t,i))})}catch(i){if(n)return;n=!0,zi(t,i)}}"undefined"==typeof CanvasRenderingContext2D||CanvasRenderingContext2D.prototype.setLineDash||(CanvasRenderingContext2D.prototype.setLineDash=function(e){}),Math.log2||(Math.log2=function(e){return Math.log(e)*Math.LOG2E}),Math.sign||(Math.sign=function(e){return(0<e?1:0)-(e<0?1:0)||+e}),Number.isNaN||(Number.isNaN=function(e){return"number"==typeof e&&isNaN(e)}),Number.MAX_SAFE_INTEGER||Object.defineProperty(Number,"MAX_SAFE_INTEGER",{enumerable:!1,configurable:!1,writable:!1,value:Math.pow(2,53)-1}),cr=setTimeout,ft.prototype.catch=function(e){return this.then(null,e)},ft.prototype.then=function(e,t){var n=new this.constructor(ui);return gi(this,new cs(e,t,n)),n},ft.all=function(e){var t=Array.prototype.slice.call(e);return new ft(function(n,i){if(0===t.length)return n([]);var r=t.length;function o(s,l){try{if(l&&("object"==typeof l||"function"==typeof l)){var u=l.then;if("function"==typeof u)return void u.call(l,function(d){o(s,d)},i)}t[s]=l,0==--r&&n(t)}catch(d){i(d)}}for(var a=0;a<t.length;a++)o(a,t[a])})},ft.resolve=function(e){return e&&"object"==typeof e&&e.constructor===ft?e:new ft(function(t){t(e)})},ft.reject=function(e){return new ft(function(t,n){n(e)})},ft.race=function(e){return new ft(function(t,n){for(var i=0,r=e.length;i<r;i++)e[i].then(t,n)})},ft._immediateFn="object"==typeof global&&"function"==typeof global.setImmediate&&function(e){global.setImmediate(e)}||function(e){cr(e,0)},ft._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},ft._setImmediateFn=function(e){ft._immediateFn=e},ft._setUnhandledRejectionFn=function(e){ft._unhandledRejectionFn=e},"object"!=typeof global||global.Promise||(global.exports=ft),"object"!=typeof window||"Promise"in window||(window.Promise=ft),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var n=this.toString();("number"!=typeof t||!isFinite(t)||Math.floor(t)!==t||t>n.length)&&(t=n.length);var i=n.lastIndexOf(e,t-=e.length);return-1!==i&&i===t}),String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(t||0,e.length)===e}),String.prototype.includes||(String.prototype.includes=function(e,t){return"number"!=typeof t&&(t=0),!(t+e.length>this.length)&&-1!==this.indexOf(e,t)}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e){var t=arguments;if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),i=1;i<arguments.length;i++){var r=t[i];if(null!=r)for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])}return n},writable:!0,configurable:!0});var Qo=function(e,t){return(Qo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var r in i)i.hasOwnProperty(r)&&(n[r]=i[r])})(e,t)};function St(e,t){function n(){this.constructor=e}Qo(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var It=function(){return(It=Object.assign||function(e){for(var t,n=arguments,i=1,r=arguments.length;i<r;i++)for(var o in t=n[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function Io(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}var Jn={},co={},hs={},Sr=function(e){return null};if("object"==typeof global&&(co=global),"object"==typeof window&&(hs=window),"function"==typeof Yr.require){var Ko=Yr.require.bind(Yr);Sr=function(e){try{return Ko(e)}catch(t){return null}}}else"function"==typeof co.require&&(Sr=function(e){var t=Yr.require;try{return t(e)}catch(n){return null}});function bi(e,t){var n=(void 0===t?{}:t).throwOnError,i=null;if(!i&&e&&(i=Jn[e]),!i&&e&&(i=Sr(e)),!i&&e&&(i=hs[e]),!i&&e&&(i=co[e]),i||!n)return i;var r=['unable to find module "'+e+'"; make sure one of these statements is true:',"- Ogma.libraries['"+e+"'] is set to the right library","- require('"+e+"') returns the right library","- window['"+e+"'] is set to the right library"].join("\n");throw new Error(r)}function Xr(e,t){for(var n=1,i=e.length;n<i;n++){for(var r=e[n],o=n;0<o&&t.get(e[o-1])>t.get(r);)e[o]=e[o-1],--o;e[o]=r}return e}function pr(e,t){for(var n=1,i=e.length;n<i;n++){for(var r=e[n],o=n;0<o&&t.get(e[o-1])<t.get(r);)e[o]=e[o-1],--o;e[o]=r}return e}function li(e){return Array.isArray(e)||ArrayBuffer.isView(e)}function f(e){return Array.isArray(e)?e:[e]}function Fr(e){for(var t=[],n=0;n<e.length;++n){var i=e[n];if(Array.isArray(i))for(var r=0;r<i.length;++r)t.push(i[r]);else t.push(i)}return t}function Fa(e,t){var n=e.indexOf(t);return-1!==n&&(e.splice(n,1),!0)}function ps(e,t){for(var n,i,r=0,o=e.length-1;r<=o;)if((i=e[n=(r+o)/2|0])<t)r=1+n;else{if(!(t<i))return n;o=n-1}return-1}function Pr(e){if(!e)return[];if("string"==typeof e)return e.split(".");if(Array.isArray(e)){for(var t=0;t<e.length;++t)if("string"!=typeof e[t])throw new TypeError(e[t]+" is not a string");return e.slice()}throw new TypeError('invalid property path "'+e+'": expected string or array of strings')}function Pa(e,t,n){var i,r,o;if(0===t)return function(){e.apply(n,arguments)};function a(){i=!1,r&&(o.apply(n,r),r=null)}return o=function(){var s;return i?r=arguments:(s=e.apply(n,arguments),setTimeout(a,t),i=!0),s}}function fr(){return 120===new Uint8Array(new Uint32Array([305419896]).buffer)[0]}function qi(e){return e.reduce(function(t,n){return t.then(n)},Promise.resolve())}function Jr(e,t,n,i,r,o,a,s){return e+r+256*(t+o)+65536*(n+a)+16777216*(i+s)}function Qr(e){return!(null===e||"object"!=typeof e||li(e)||e instanceof RegExp||"undefined"!=typeof HTMLElement&&e instanceof HTMLElement)}function Da(e){for(var t=Object.keys(e),n=new Array(t.length),i=0;i<t.length;++i)n[i]=e[t[i]];return n}function _t(e,t,n){if(Array.isArray(e))return e.forEach(t,n);if(!Qr(e))throw new Error("forEach: invalid argument "+JSON.stringify(e));var i=Object.keys(e);if(void 0!==n)for(var r=0;r<i.length;++r){var o=i[r];t.call(n,e[o],o)}else for(r=0;r<i.length;++r)t(e[o=i[r]],o)}function sn(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=sn(e[n]);return t}if(!$t(e))return e;var i={},r=Object.keys(e);for(n=0;n<r.length;++n){var o=r[n];i[o]=sn(e[o])}return i}function Yt(e,t,n){for(var i="string"==typeof t?t.split("."):t,r=0;r<i.length-1;++r){var o=i[r],a=e[o];a||(e[o]=a={}),e=a}e[i[i.length-1]]=n}function bn(e,t){var n=Pr(t);if(!n.length)return e;if(e){for(var i=0;i<n.length-1;++i){var r=e[n[i]];if(!r)return;e=r}return e[n[n.length-1]]}}function qt(e,t,n){void 0===n&&(n="."),t=t||function(h){return!Qr(h)};for(var i={},r=Object.keys(e),o=0;o<r.length;++o){var a=r[o],s=e[a];if(t(s))i[a]=s;else for(var l=qt(s,t),u=Object.keys(l),d=0;d<u.length;d++){var c=u[d];i[""+a+n+c]=l[c]}}return i}function En(e){for(var t={},n=Object.keys(e),i=0;i<n.length;++i){var r=n[i];Yt(t,r,e[r])}return t}function Ei(e,t,n){void 0===n&&(n=[]);for(var i=Object.keys(e),r=0;r<i.length;++r){var o=i[r],a=e[o],s=t?t+o:o;$t(a)?Ei(a,s+".",n):n.push(s)}return n}function Qn(e,t){if(void 0===t&&(t=[]),$t(e))for(var n=0,i=Object.keys(e);n<i.length;n++)Qn(e[i[n]],t);else t.push(e);return t}function Hi(e){for(var t in e)"function"==typeof e[t]&&delete e[t];return e}function un(e,t){if(void 0===e)return sn(t);if(!Qr(e))return e;for(var n={},i=0,r=Object.keys(t);i<r.length;i++){var o=r[i],a=t[o],s=e[o];n[o]=Qr(a)?un(s,a):void 0===s?sn(a):s}return n}function $t(e){return e&&(e.constructor===Object||!e.constructor)}function nr(e,t){if(!$t(t)||!$t(e))return t;for(var n=Object.assign({},e),i=Object.keys(t),r=0;r<i.length;++r){var o=i[r];n[o]=nr(n[o],t[o])}return n}function Ra(e,t){return null==t?e:t.reduce(function(n,i){return n[i]=e[i],n},{})}var ko,fs=(ko=0,"undefined"!=typeof requestAnimationFrame?requestAnimationFrame:function(e){var t=Date.now(),n=Math.min(16,Math.max(0,16-(t-ko))),i=ko=t+n;return setTimeout(function(){return e(i)},n)}),gs="undefined"!=typeof cancelAnimationFrame?cancelAnimationFrame:function(e){return clearTimeout(e)};function Oo(e,t){return fs(function(n){e.call(t,n)})}function di(e){e&&gs(e)}var za,qn,Ba,Dr,Si="object"==typeof global&&null!==global&&void 0!==global.it,ir="undefined"!=typeof document,Wi="undefined"!=typeof window,Rr=Wi&&!window.__OGMA_HEADLESS,ho=Rr&&ir,No=(Kn.prototype.open=function(e,t){this.method=e,this.url=t,Kn.onSend&&Kn.onSend(this)},Kn.prototype.respond=function(e,t,n){this.readyState=4,this.status=e,this.headers=t,this.responseText=n,this.response=n,this.onreadystatechange()},Kn.prototype.send=function(){this.readyState=4},Kn.onCreate=null,Kn.onSend=null,Kn);function Kn(){this.method=null,this.url=null,this.status=0,this.readyState=0,this.headers={},this.responseText=null,this.response=null,Kn.onCreate&&Kn.onCreate(this)}var Lo=(Yi.prototype.readAsDataURL=function(e){this._blob=e,Yi.onRead&&Yi.onRead(this)},Yi.prototype.load=function(e){this.result="function"==typeof e?e(this._blob):e,this.onload&&this.onload()},Yi.onCreate=null,Yi.onRead=null,Yi);function Yi(){this.onload=null,Yi.onCreate&&Yi.onCreate(this)}function Bi(){return qn||{createElementNS:function(){return null},createElement:function(){return null},implementation:{createDocument:function(){throw new Error('unable to create XML document; if you use Node JS install the "xmldom" package')}}}}function po(e,t){var n=e.style[t];if((!n||"auto"===n)&&Bi().defaultView){var i=document.defaultView.getComputedStyle(e,null);n=i?i[t]:null}return"auto"===n?null:n}za=bi("xmldom"),qn=ir?document:za?(new za.DOMImplementation).createDocument():null,Ba="undefined"!=typeof XMLHttpRequest?XMLHttpRequest:No,Dr="undefined"!=typeof FileReader?FileReader:Lo;var Vi=(Object.defineProperty(_i.prototype,"offsetWidth",{get:function(){return parseFloat(this.style.width)},enumerable:!0,configurable:!0}),Object.defineProperty(_i.prototype,"offsetHeight",{get:function(){return parseFloat(this.style.height)},enumerable:!0,configurable:!0}),Object.defineProperty(_i.prototype,"firstChild",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(_i.prototype,"parentNode",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(_i.prototype,"classList",{get:function(){return{length:0,value:"",add:function(){},remove:function(){},contains:function(e){return!1},item:null}},enumerable:!0,configurable:!0}),Object.defineProperty(_i.prototype,"innerHTML",{get:function(){return""},set:function(e){},enumerable:!0,configurable:!0}),_i.prototype.appendChild=function(){},_i.prototype.removeChild=function(){},_i.prototype.addEventListener=function(){},_i.prototype.removeEventListener=function(){},_i.prototype.insertBefore=function(){},_i.prototype.contains=function(e){return!1},_i);function _i(){this.onmousewheel=function(){},this.__dummy=!0,this.style={},this.clientWidth=0,this.clientHeight=0,this.childNodes=[],this.style={width:"0px",height:"0px",top:null,left:null,position:"",backgroundColor:null}}function $o(){return new Vi}function Ln(){return Wi&&window.devicePixelRatio||1}function Hn(e){var t,n,i,r=";base64,";if(-1===e.indexOf(r))return n=(t=e.split(","))[0].split(":")[1],gr(i=decodeURIComponent(t[1]),n);n=(t=e.split(r))[0].split(":")[1];for(var o=(i=window.atob(t[1])).length,a=new Uint8Array(o),s=0;s<o;++s)a[s]=i.charCodeAt(s);return gr([a],n)}var Wn=function(e,t){this.data=e,this.type=t};function gr(e,t){return"undefined"!=typeof Blob?new Blob(e,{type:t}):new Wn(e,t)}function cn(e,t,n){if(!Rr)return e;var i=null,r=null,o=null;if(window.Blob?(i="blob"===n?e:"dataURL"===n?Hn(e):gr([e],"text/xml"),r=window.URL.createObjectURL(i)):o="data:text/xml;charset=UTF-8,"+encodeURIComponent('<?xml version="1.0" encoding="UTF-8"?>')+encodeURIComponent(e),navigator.msSaveBlob)navigator.msSaveBlob(i,t);else if(navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(i,t);else{var a=document.createElement("a");a.setAttribute("href",window.Blob?r:o),a.setAttribute("download",t),document.body.appendChild(a),a.click(),document.body.removeChild(a)}return r&&setTimeout(function(){window.URL.revokeObjectURL(r)},0),e}function Fo(e,t,n,i){if(void 0===i&&(i=Ln()),e.style.width=t+"px",e.style.height=n+"px","IMG"===e.tagName||"CANVAS"===e.tagName){var r=e;r.width=t*i,r.height=n*i}}function ea(e,t){_t(t,function(n,i){void 0!==n&&e.setAttribute(i,n)})}var ta="http://www.w3.org/2000/svg",kn="http://www.w3.org/2000/xmlns/",lt="http://www.w3.org/1999/xlink";function fn(e,t){var n=qn.createElementNS(ta,e);return n.style||(n.style={}),t&&ea(n,t),n}function Ti(e){return qn.createTextNode(e)}function _s(e){return"undefined"==typeof Image?Promise.resolve(null):new Promise(function(t){var n=new Image;n.src=e,n.onload=function(){return t(n)},n.onerror=function(){return t(null)}})}function Kr(e){if(0===e.indexOf("http://")||0===e.indexOf("https://"))return e;var t=window.location.origin,n=window.location.pathname,i=n.lastIndexOf("/");return-1===i?t+"/"+e:t+n.substr(0,i)+"/"+e}function mi(e){return new Promise(function(t,n){var i=new Ba;i.open("GET",Kr(e),!0),i.onreadystatechange=function(){if(4===i.readyState){var r=i.status;200===r?t(i.responseText):n(0!==r?new Error('cannot retrieve file at url "'+e+'"; the server responded with status code '+r+"."):new Error('cannot send XMLHttpRequest to url "'+e+"\"; if you're using the local file protocol this is most likely the cause."))}},i.onerror=function(){n(new Error('cannot retrieve file at url "'+e+'"; the XMLHttpRequest failed.'))},i.send()})}function Po(e){return"undefined"!=typeof HTMLElement&&e instanceof HTMLElement}function $r(e,t){e.style.cursor=t,e.style.cursor!==t&&(e.style.cursor="-webkit-"+t)}function Va(e){return new Promise(function(t,n){var i=new Ba;i.responseType="blob",i.open("GET",Kr(e),!0),i.onreadystatechange=function(){4===i.readyState&&(200===i.status?t(i.response):n(i.status))},i.onerror=function(r){return n(r)},i.send()})}function Do(e){return Va(e).then(function(t){return new Promise(function(n,i){var r=new Dr;r.onerror=i,r.onload=function(){return n(r.result)},r.readAsDataURL(t)})})}function _r(e,t){void 0===t&&(t=!0);var n=t?"&#13;":"\n";return(""+e).replace(/&/g,"&amp;").replace(/'/g,"&apos;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r\n/g,n).replace(/[\r\n]/g,n)}var Mi={0:"left",1:"middle",2:"right"};function _(e){if(e.baseURI)return e.baseURI;var t=e.getElementsByTagName("base");return 0<t.length?t[0].href:e.URL||e.location.href}function A(e,t,n,i){return new Promise(function(r){var o=t,a=Date.now(),s=(n-t)*Math.min(1,1/(i/16));!function l(){Date.now()-a<i?(o=Math.min(1,Math.max(0,o+s)),e.style.opacity=o.toString(),Oo(l)):r()}()})}var C="undefined"!=typeof performance&&performance.now?function(){return 0|performance.now()}:function(){return Date.now()},T=C();function z(){return C()-T}function U(){var e=new Date,t=e.getDate(),n=e.getMonth()+1;return e.getFullYear()+"-"+(n<10?"0"+n:n)+"-"+(t<10?"0"+t:t)}function de(){var e=new Date;return"["+ne((e.getUTCHours()-(e.getTimezoneOffset()/60|0))%24)+":"+ne(e.getUTCMinutes())+":"+ne(e.getUTCSeconds())+":"+ne(e.getUTCMilliseconds(),3)+"]"}function ne(e,t){void 0===t&&(t=2);for(var n=Math.pow(10,t-1),i=String(e);1<n;)e<n&&(i="0"+i),n/=10;return i}var oe,G,ee=Wi&&!window.PointerEvent&&!!window.MSPointerEvent,ve=Wi&&!(!window.PointerEvent&&!ee),q=ee?"MSPointerDown":"pointerdown",Q=ee?"MSPointerMove":"pointermove",$=ee?"MSPointerUp":"pointerup",ue=ee?"MSPointerCancel":"pointercancel",ge={},Se=0;function Oe(e){return"mouse"===e.pointerType||e.MSPOINTER_TYPE_MOUSE&&e.pointerType===e.MSPOINTER_TYPE_MOUSE}function Ce(e){return"mouse"!==e.pointerType&&e.MSPOINTER_TYPE_MOUSE&&e.pointerType!==e.MSPOINTER_TYPE_MOUSE}function fe(e){ge[e.pointerId]=e}function ie(e){ge[e.pointerId]&&(ge[e.pointerId]=e)}function le(e){delete ge[e.pointerId]}function ae(e,t){for(var n in e.touches=[],ge)e.touches.push(ge[n]);e.changedTouches=[e],t(e)}function be(e,t,n,i){return n===oe.START?e(t,q,i,!1):n===oe.MOVE?e(t,Q,i,!1):n===oe.END?(e(t,$,i,!1),e(t,ue,i,!1)):void 0}(G=oe=oe||{}).START="touchstart",G.MOVE="touchmove",G.END="touchend",G.CANCEL="touchcancel";var I,ye,Pe=(R.prototype.onMounted=function(e,t){},R.prototype.destroy=function(e){},R);function R(){}(ye=I=I||{}).MOVE="move",ye.DOWN="down",ye.UP="up",ye.CLICK="click",ye.DOUBLE_CLICK="doubleClick",ye.HOVER="hover",ye.UNHOVER="unhover",ye.WHEEL="wheel",ye.DRAG_START="dragStart",ye.DRAG_PROGRESS="dragProgress",ye.DRAG_END="dragEnd",ye.GESTURE_START="gestureStart",ye.GESTURE_PROGRESS="gestureProgress",ye.GESTURE_END="gestureEnd",ye.RESIZE="resize",ye.ADD_NODES="addNodes",ye.ADD_EDGES="addEdges",ye.REMOVE_NODES="removeNodes",ye.REMOVE_EDGES="removeEdges",ye.BEFORE_REMOVE_NODES="beforeRemoveNodes",ye.BEFORE_REMOVE_EDGES="beforeRemoveEdges",ye.CLEAR_GRAPH="clear",ye.EXCLUDED_STATE_CHANGE="excludedStateChange",ye.UPDATE_ATTRIBUTES="updateAttributes",ye.RENDERER_STATE_CHANGE="rendererStateChange",ye.UPDATE_NODE_DATA="updateNodeData",ye.UPDATE_EDGE_DATA="updateEdgeData",ye.SET_DATA="setData",ye.START_ZOOM="startZoom",ye.VIEW_CHANGED="viewChanged",ye.MOVE_END="moveEnd",ye.CAMERA_MOVE="cameraMove",ye.CAMERA_ROTATE="cameraRotate",ye.CAMERA_PAN="cameraPan",ye.CAMERA_ZOOM="cameraZoom",ye.NODES_DRAG_START="startMoveNodesByDragging",ye.NODES_DRAG_PROGRESS="progressMoveNodesByDragging",ye.NODES_DRAG_END="endMoveNodesByDragging",ye.ANIMATE="animate",ye.NEW_FRAME="newFrame",ye.BEFORE_NEW_FRAME="beforeNewFrame",ye.AFTER_NEW_FRAME="afterNewFrame",ye.SET_CONTAINER="setContainer",ye.RELOAD_FONTS="reloadFonts",ye.MOUSE_LEAVE="mouseLeave",ye.MOUSE_DOWN="mouseDown",ye.MOUSE_UP="mouseUp",ye.MOUSE_MOVE="mouseMove",ye.MOUSE_WHEEL="mouseWheel",ye.MOUSE_CLICK="mouseClick",ye.MOUSE_DOUBLE_CLICK="mouseDoubleClick",ye.DOCUMENT_MOUSE_MOVE="documentMouseMove",ye.DOCUMENT_MOUSE_UP="documentMouseUp",ye.VIRTUAL_DOWN="virtualDown",ye.VIRTUAL_UP="virtualUp",ye.VIRTUAL_MOVE="virtualMove",ye.VIRTUAL_CLICK="virtualClick",ye.VIRTUAL_DOUBLE_CLICK="virtualDoubleClick",ye.VIRTUAL_WHEEL="virtualWheel",ye.TOUCH_DOWN="touchDown",ye.TOUCH_UP="touchUp",ye.TOUCH_TAP="touchTap",ye.TOUCH_DOUBLE_TAP="touchDoubleTap",ye.TOUCH_MOVE="touchMove",ye.TOUCH_START_GESTURE="touchStartGesture",ye.TOUCH_PROGRESS_GESTURE="touchProgressGesture",ye.TOUCH_END_GESTURE="touchEndGesture",ye.DOCUMENT_TOUCH_MOVE="documentTouchMove",ye.DOCUMENT_TOUCH_UP="documentTouchUp",ye.GEO_LOADED="geoLoaded",ye.GEO_ENABLED="geoEnabled",ye.GEO_DISABLED="geoDisabled",ye.GEO_READY="geoReady",ye.TOOLTIP_HIDE="hideTooltip",ye.TOOLTIP_SHOW="showTooltip",ye.CONNECT_NODES="connectNodes",ye.LAYOUT_START="layoutStart",ye.LAYOUT_END="layoutEnd",ye.LAYOUT_COMPUTED="layoutComputed";var F,E=["graphics","legend","brand"],k=(St(O,F=Pe),O.prototype.onMounted=function(e,t){t.container&&e.setContainer(t.container)},O.prototype.addWindowEventListener=function(e,t,n){this._isRealBrowser&&this.addElementEventListener(window,e,t,n)},O.prototype.addDocumentEventListener=function(e,t,n){return this._isDocumentReady&&this.addElementEventListener(document.documentElement,e,t,n),t},O.prototype.removeDocumentEventListener=function(e,t){this._isDocumentReady&&document.documentElement.removeEventListener(e,t)},O.prototype.addMediaListener=function(e,t){if(this._isDocumentReady&&"function"==typeof window.matchMedia){var n=window.matchMedia(e);n.addListener(t),this._onDetachDom.push(function(){return n.removeListener(t)})}},O.prototype.addElementEventListener=function(e,t,n,i){return this._isDestroyed||(e.addEventListener(t,n,i),this._onDetachDom.push(function(){return e.removeEventListener(t,n,i)})),n},O.prototype.detachFromDom=function(){this._onDetachDom.forEach(function(e){return e()}),this._onDetachDom=null,this._emptyContainer()},O.prototype.setTimeout=function(e,t){var n=this;void 0===t&&(t=0);var i=setTimeout(function(){n._timeouts.splice(n._timeouts.indexOf(i),1),e()},t);return this._timeouts.push(i),i},O.prototype.clearTimeout=function(e){return e&&(clearTimeout(e),this._timeouts.splice(this._timeouts.indexOf(e),1)),null},O.prototype.clearAllTimeouts=function(){this._timeouts.forEach(clearTimeout),this._timeouts=[]},O.prototype.stopFrames=function(){this._isDestroyed=!0,this._nextFrame&&(di(this._nextFrame),this._nextFrame=null)},O.prototype.isDestroyed=function(){return this._isDestroyed},O.prototype.getDimensions=function(){return{width:this._width,height:this._height}},O.prototype.setDimensions=function(e){this._resize(e)},O.prototype.setLayer=function(e,t,n){var i=(void 0===n?{}:n).automaticResize,r=void 0!==i&&i;t&&(t._ogmaLayer=e,r&&(t.style.position="absolute",t.style.top="0px",t.style.left="0px",Fo(t,this._width,this._height,Ln()))),this._layers[e]={element:t,automaticResize:r},this._updateContainerContent()},O.prototype.setContainer=function(e){if("string"==typeof e){var t=e;if(!(e=document.getElementById(t)))throw new Error('unable to find DOM element with id "'+t+'"')}if(e!==this._container){var n=this._container;this._isFullScreen=!1,this._container=e,this._resize(),this._updateContainerContent(),this._events.fire(I.SET_CONTAINER,{element:e,prevElement:n})}},O.prototype.getContainer=function(){return this._container},O.prototype.appendElement=function(e){null!==this._container&&this._container.appendChild(e)},O.prototype.focus=function(){this._focus=!0},O.prototype.blur=function(){this._focus=!1},O.prototype.hasFocus=function(){return this._focus},O.prototype.forceResize=function(){this._resize()},O.prototype._beforeOrAfterNextFrame=function(e){var t=e?this._afterNextFramePromises:this._beforeNextFramePromises,n=new Promise(function(i){t.push(function(){return i(),n})});return this._refresh(),n},O.prototype.beforeNextFrame=function(){return this._beforeOrAfterNextFrame(!1)},O.prototype.afterNextFrame=function(){return this._beforeOrAfterNextFrame(!0)},O.prototype.refresh=function(e){e&&(this._refreshUntil=Math.max(this._refreshUntil,e)),this._refresh()},O.prototype._emptyContainer=function(){if(this._container){for(var e=[],t=0;t<this._container.childNodes.length;++t){var n=this._container.childNodes[t];n._ogmaLayer&&e.push(n)}for(t=0;t<e.length;++t)this._container.removeChild(e[t])}},O.prototype._fillContainer=function(){var e=this;if(this._container){var t=po(this._container,"position");"absolute"!==t&&"relative"!==t&&"fixed"!==t&&(this._container.style.position="relative");var n=this._container.firstChild;E.forEach(function(i){var r=e._layers[i];r&&r.element&&e._container.insertBefore(r.element,n)})}},O.prototype._updateContainerContent=function(){this._emptyContainer(),this._fillContainer()},O.prototype._resize=function(e){if(this._container||e){var t,n,i=this._width,r=this._height;if(this._container){var o=this._settings.get("minimumWidth"),a=this._settings.get("minimumHeight"),l=this._container.clientHeight||1;t=Math.max(o,e?e.width:this._container.clientWidth||1),n=Math.max(a,e?e.height:l)}else t=e.width,n=e.height;t===i&&n===r||(this._width=t,this._height=n,_t(this._layers,function(u){u.automaticResize&&Fo(u.element,t,n)}),this._events.fire(I.RESIZE,{prevWidth:i,prevHeight:r,width:t,height:n,difWidth:t-i,difHeight:n-r}))}},O.prototype._refresh=function(){var e=this;this._inFrame?this._mustRefresh=!0:this._nextFrame||this._isDestroyed||(this._nextFrame=Oo(function(){return e._playFrame()}))},O.prototype._playFrame=function(){var e=this,t=z(),n=t-this._currentTime,i=Fr([this._beforeNextFramePromises,function(){return e._events.fire(I.BEFORE_NEW_FRAME,{elapsed:n})},function(){return e._events.fire(I.NEW_FRAME,{elapsed:n})},function(){return e._events.fire(I.AFTER_NEW_FRAME,{elapsed:n})},this._afterNextFramePromises,function(){e._inFrame=!1,(e._mustRefresh||t<e._refreshUntil+17)&&(e._mustRefresh=!1,e._refresh())}]);this._inFrame=!0,this._nextFrame=null,this._mustRefresh=!1,this._currentTime=t,this._beforeNextFramePromises=[],this._afterNextFramePromises=[],i.reduce(function(r,o){return r.then(function(){if(!e._isDestroyed)return o()})},Promise.resolve())},O.prototype.isPlayingFrame=function(){return this._inFrame||!!this._nextFrame},O.prototype.setFullScreen=function(e){var t;this._container&&(e&&!this._isFullScreen?(t=this._container).requestFullScreen?t.requestFullScreen():t.webkitRequestFullScreen?t.webkitRequestFullScreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.msRequestFullscreen&&t.msRequestFullscreen():e||!this._isFullScreen||"undefined"!=typeof document&&(document.cancelFullScreen?document.cancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen())),this._isFullScreen=e},O.prototype.isFullScreen=function(){return this._isFullScreen},O.prototype.debounceBeforeFrame=function(e){function t(){var o=r;i=!1,r=[],e(),o.forEach(function(a){return a()})}var n=this,i=!1,r=[];return function(){return new Promise(function(o){r.push(o),i||(i=!0,n.beforeNextFrame().then(t))})}},O.prototype.destroy=function(){(function(){if(Se--,ir&&0===Se){var e=document.documentElement;e.removeEventListener(q,fe,!0),e.removeEventListener(Q,ie,!0),e.removeEventListener($,le,!0),e.removeEventListener(ue,le,!0)}})(),this.detachFromDom(),this.clearAllTimeouts(),this.stopFrames()},O);function O(e,t){var n=e.events,i=e.settings,r=void 0===t?{}:t,o=r.width,a=void 0===o?300:o,s=r.height,l=void 0===s?300:s,u=F.call(this)||this;return u._layers={},u._focus=!1,u._container=null,u._isFullScreen=!1,u._beforeNextFramePromises=[],u._afterNextFramePromises=[],u._refreshUntil=0,u._currentTime=z(),u._timeouts=[],u._isDestroyed=!1,u._onDetachDom=[],u._isRealBrowser=Rr,u._isDocumentReady=ho,u._inFrame=!1,u._mustRefresh=!1,u._nextFrame=null,u._onWindowResize=function(){return u._resize()},u._onWindowFocus=function(){return u.refresh()},u._events=n,u._settings=i,u._width=a,u._height=l,u._settings.register("minimumWidth",300,function(){return u._resize()},!1),u._settings.register("minimumHeight",300,function(){return u._resize()},!1),u._events.register([I.BEFORE_NEW_FRAME,I.NEW_FRAME,I.AFTER_NEW_FRAME,I.SET_CONTAINER,I.RESIZE]),u._onDetachDom=[],function(){if(ir&&0===Se&&ve){var d=document.documentElement;d.addEventListener(q,fe,!0),d.addEventListener(Q,ie,!0),d.addEventListener($,le,!0),d.addEventListener(ue,le,!0)}Se++}(),u.addWindowEventListener("resize",u._onWindowResize),u.addWindowEventListener("focus",u._onWindowFocus),u}var te,Xe=(St(Rt,te=Pe),Rt.prototype.setProperty=function(e,t,n,i){var r=(void 0===i?{}:i).dispatch;this._setDataProperty(e.isNode,e._indexes,t,n,void 0!==r&&r),this._events.fire(I.SET_DATA,{elements:e})},Rt.prototype.getProperty=function(e,t){return this._getDataProperty(e.isNode,e._indexes,t)},Rt.prototype._setDataProperty=function(e,t,n,i,r){r&&"function"==typeof i&&(r=!1),n=Xt(n);for(var o="function"==typeof i,a=e?this._nodeList:this._edgeList,s=e?this._nodeDataList:this._edgeDataList,l=function(S,w){for(var M=0;M<S.length;++M){var N=S[M],D=N.property;if(null===w&&null===D)return N;if(w&&D&&D.length===w.length){for(var P=!0,L=0;L<D.length;++L)if(D[L]!==w[L]){P=!1;break}if(P)return N}}var V={property:w&&w.slice(),indexes:[],previousValues:[],newValues:[],nodes:null,edges:null};return S.push(V),V}(e?this._nodeChanges:this._edgeChanges,n),u=0;u<t.length;++u){var d=t[u],c=s.get(d),h=a.get(d),p=r?i[u]:i,g=void 0,m=void 0;if(null===n)g=c,m=o?p(h):p,s.set(d,m);else{null==c&&s.set(d,c={});for(var x=n.length,v=0;v<x;v++){var y=n[v],b=c[y];v<x-1?(null==b&&(c[y]=b={}),c=b):(g=b,m=o?p(h):p,c[y]=m)}}l.indexes.push(d),l.previousValues.push(g),l.newValues.push(m)}this._scheduleEvents()},Rt.prototype._getDataProperty=function(e,t,n,i){n=Xt(n),i=i||new Array(t.length);for(var r=e?this._nodeDataList:this._edgeDataList,o=0;o<t.length;++o){var s=r.get(t[o]),l=void 0;if(null!==n&&n.length)if(null==s)l=void 0;else for(var u=n.length,d=0;d<u&&s;++d)l=s=s[n[d]];else l=s;i[o]=l}return i},Rt.prototype._scheduleEvents=function(){this._shouldTriggerEvents=!0,this._dom.refresh()},Rt.prototype._triggerEvents=function(){var e=this._prepareEvtPayload(!0),t=this._prepareEvtPayload(!1);this._events.fire(I.UPDATE_NODE_DATA,e),this._events.fire(I.UPDATE_EDGE_DATA,t)},Rt.prototype._prepareEvtPayload=function(e){var t=e?this._graph.nodeList:this._graph.edgeList,n=e?"_nodeChanges":"_edgeChanges",i=[],r=this[n];this[n]=[];for(var o=[],a=0;a<r.length;++a){var s=r[a],l=s.indexes,u=s.property,d=s.newValues,c=s.previousValues;i=i.concat(l),o.push(e?{property:u,newValues:d,previousValues:c,nodes:t(l)}:{property:u,newValues:d,previousValues:c,edges:t(l)})}return e?{nodes:t(i).dedupe(),isNode:e,changes:o}:{edges:t(i).dedupe(),isNode:e,changes:o}},Rt);function Rt(e){var t,n=te.call(this)||this;return n._nodeChanges=[],n._edgeChanges=[],n._shouldTriggerEvents=!1,n._dom=e.dom,n._graph=e.graph,n._events=e.events,n._nodeDataList=n._graph.createAttribute(!0,{name:"data",storage:"any"}),n._edgeDataList=n._graph.createAttribute(!1,{name:"data",storage:"any"}),n._nodeList=n._graph.getNodeAttribute("object"),n._edgeList=n._graph.getEdgeAttribute("object"),n._events.register([I.SET_DATA,I.UPDATE_NODE_DATA,I.UPDATE_EDGE_DATA]),n._events.on(((t={})[I.ADD_NODES+" "+I.ADD_EDGES]=function(i){for(var a=i.objects,s=i.nodes||i.edges,u=s.size,d=s._indexes,c=n[s.isNode?"_nodeDataList":"_edgeDataList"],h=0;h<u;++h)c.set(d[h],a[h].data)},t[I.BEFORE_NEW_FRAME]=function(){n._shouldTriggerEvents&&(n._shouldTriggerEvents=!1,n._triggerEvents())},t)),n}function Xt(e){return"string"==typeof e?e.split("."):li(e)?e:null==e?null:void 0}var Bn={1:pt(1),2:pt(2),4:pt(4),8:zt(),16:zt(),32:zt(),int8:zt(),int16:zt(),int32:zt(),float:zt(),any:zt()},Ro={1:Gt(1),2:Gt(2),4:Gt(4),8:mt(),16:mt(),32:mt(),int8:mt(),int16:mt(),int32:mt(),float:mt(),any:mt()};function zt(){return new Function("array","index","return array[index];")}function mt(){return new Function("array","index","value","array[index] = value;")}function pt(e){var t=8/e;return new Function("array","index","return (array[index / "+t+" | 0] >> ((index % "+t+") * "+e+")) & "+((1<<e)-1)+";")}function Gt(e){return new Function("array","index","value","\n    var offset = (index % "+8/e+") * "+e+";\n    var finalIndex = index / "+8/e+" | 0;\n    var orMask = value << offset;\n    var andMask = 255 - (("+(Math.pow(2,e)-1)+" - value) << offset);\n\n    array[finalIndex] = (array[finalIndex] & andMask) | orMask;")}var gt={get:function(e){return this._getArrayElt(this._buffer,e)},set:function(e,t){this._setArrayElt(this._buffer,e,t)}},Jt={get:function(e){return this._byIndex[this._getArrayElt(this._buffer,e)]},set:function(e,t){var n=this._byName[t];void 0===n&&(n=this._nextIndex++,this._byIndex.push(t),this._getElementBitSize()>this._elementSize&&this.increaseElementSize(),this._byName[t]=n),this._setArrayElt(this._buffer,e,n)}},Fn=(Vt.prototype.getValues=function(){return Object.keys(this._byName)},Vt.prototype.getName=function(){return this._name},Vt.prototype.get=function(e){return this._get(e)},Vt.prototype.set=function(e,t){this._set(e,t)},Vt.prototype._get=function(e){return this._defaultValue},Vt.prototype._set=function(e,t){t!==this._defaultValue&&(this._initialize(),this._set(e,t))},Vt.prototype.setFallback=function(e){this._fallback=e,this.get=this._getWithFallback},Vt.prototype._getWithFallback=function(e){var t=this._get(e);return void 0===t?this._fallback.get(e):t},Vt.prototype._initialize=function(){this._initialized=!0,this._buffer=Ui(this._nbElements,this._elementSize),this._get=this._methods.get,this._set=this._methods.set,"resource"!==this._storage&&this._defaultValue!==this._BASE_VALUE&&this._reset(0)},Vt.prototype.increaseNbElements=function(e){var t=Xi(e+1);if(!(t<=this._nbElements)){if(this._initialized)if("any"===this._elementSize)for(var n=this._nbElements;n<t;++n)this._buffer.push(this._defaultValue);else{var i=Ui(t,this._elementSize);i.set(this._buffer),this._buffer=i,"resource"!==this._storage&&this._defaultValue!==this._BASE_VALUE&&this._reset(this._nbElements)}this._nbElements=t}},Vt.prototype.increaseElementSize=function(){var e=this._elementSize;if("number"!=typeof e||32===e)throw new Error("FlexArray: cannot increase element size");var t=2*e,n=Bn[t],i=Ro[t];if(this._initialized){var r=this._nbElements,o=this._getArrayElt,a=this._buffer,s=Ui(r,t);if(8<=e)s.set(a);else for(var l=0;l<r;++l)i(s,l,o(a,l));this._buffer=s}this._elementSize=t,this._getArrayElt=n,this._setArrayElt=i},Vt.prototype.buffer=function(){if(!this._buffer)throw new Error("FlexArray: buffer not instantiated");return this._buffer},Vt.prototype.elementBitSize=function(){return this._elementSize},Vt.prototype.capacity=function(){return this._nbElements},Vt.prototype.byteSize=function(){return this._nbElements*this._elementSize/8},Vt.prototype.isInitialized=function(){return this._initialized||this._fallback&&this._fallback.isInitialized()},Vt.prototype.getMultiple=function(e,t){var n=e.length;void 0===t&&(t=new Array(n));for(var i=0,r=n;i<r;++i)t[i]=this.get(e[i]);return t},Vt.prototype.fill=function(e,t){for(var n=0,i=e.length;n<i;++n)this.set(e[n],t)},Vt.prototype.setMultiple=function(e,t,n){if(n||!Array.isArray(t)&&!ArrayBuffer.isView(t))for(i=0,r=e.length;i<r;++i)this.set(e[i],t);else for(var i=0,r=e.length;i<r;++i)this.set(e[i],t[i])},Vt.prototype.reset=function(){return this._initialized&&this._reset(0),this},Vt.prototype._reset=function(e){var t="resource"===this._storage?0:this._defaultValue;if("number"!=typeof this._elementSize||8<=this._elementSize)this._buffer.fill(t,e);else{for(var n=8/this._elementSize,i=0,r=0;r<n;++r)i<<=this._elementSize,i+=t;if(void 0===e)this._buffer.fill(i);else{var o=e+(8-e%8);for(r=e;r<o;++r)this._setArrayElt(this._buffer,r,t);this._buffer.fill(i,o/8)}}},Vt.prototype._getElementBitSize=function(){return Math.pow(2,Math.ceil(Math.log2(Math.log2(this._nextIndex))))},Vt);function Vt(e){this._initialized=!1;var t,n,i=e.name,r=e.storage,a=(n=r,void 0===(t=e.default)&&"any"!==n&&"resource"!==n?0:t),s=Math.max(8,Xi((e.size||0)+1)),l="resource"===r?1:r;this._name=i,this._storage=r,this._getArrayElt=Bn[l],this._setArrayElt=Ro[l],this._elementSize=l,this._nbElements=s,this._fallback=null,this._byName=void 0,this._byIndex=void 0,this._nextIndex=void 0,this._defaultValue=a,this._BASE_VALUE="any"===r?void 0:0,this._methods=gt,this._initialized=!1,this._buffer=null,"resource"===r&&(this._methods=Jt,this._byName={},this._byIndex=[],this._nextIndex=1,this._byName[a]=0,this._byIndex.push(a))}function Xi(e){for(var t=2;t<e;)t*=2;return t}function Ui(e,t){return"any"===t?new Array(e):"float"===t?new Float32Array(e):"int8"===t?new Int8Array(e):"int16"===t?new Int16Array(e):"int32"===t?new Int32Array(e):32===t?new Uint32Array(e):16===t?new Uint16Array(e):new Uint8Array(Math.ceil(e/8*t))}function Ni(e){return Math.pow(2,Math.ceil(Math.log2(e)))}function Sn(e){for(var t=0,n=0;n<e.length;++n)t+=e[n];return t}function me(e,t,n){return Math.max(t,Math.min(n,e))}function Lt(e,t,n){return e+(t-e)*n}function kt(e,t,n){return e*(1-n)+t*n}function rn(e){if(!e.length)return-1/0;for(var t=e[0],n=1,i=e.length;n<i;++n){var r=e[n];t<r&&(t=r)}return t}function _n(e){if(!e.length)return 1/0;for(var t=e[0],n=1,i=e.length;n<i;++n){var r=e[n];r<t&&(t=r)}return t}function Ar(e,t){return Math.log(e)/Math.log(t)}var ms=(Ii.prototype.isBusy=function(){return this._busy},Ii.prototype.markBusy=function(){return this._busy=!0,this},Ii.prototype.sliceAndReset=function(){this._busy=!1;var e=this.slice(0,this._size);return this.reset(),e},Ii.prototype.reset=function(){return this._size=0,this},Ii.prototype.reserve=function(e){return e>this._capacity&&this._setCapacity(Ni(e)),this},Ii.prototype._setCapacity=function(e){var t=new Uint32Array(e);t.set(this._buffer),this._buffer=t,this._capacity=e},Ii.prototype.push=function(e){return this._size===this._capacity&&this._setCapacity(2*this._capacity),this._buffer[this._size++]=e,this},Ii.prototype.pushUnchecked=function(e){return this._buffer[this._size++]=e,this},Ii.prototype.slice=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this._size),this._buffer.slice(e,t)},Ii.prototype.getBuffer=function(){return this._buffer},Ii.prototype.getLength=function(){return this._size},Ii.prototype.getCapacity=function(){return this._capacity},Ii.prototype.setLength=function(e){return this._size=e,this},Ii.prototype.isEmpty=function(){return 0===this._size},Ii);function Ii(){this._buffer=new Uint32Array(4),this._capacity=4,this._size=0,this._busy=!1}var fo=(vi.prototype.addElements=function(e){for(var t=[],n=0,i=e.length;n<i;++n){var r=e[n],o=this._idToIndex[r];void 0===o&&(o=this._getNextIndex(),this._idToIndex[r]=o,this._indexToId[o]=r),t.push(o)}for(var a=0,s=this._flexArrays;a<s.length;a++)s[a].increaseNbElements(this._nextIndex);for(var l=0,u=this._indexLists;l<u.length;l++)u[l].reserve(this._nextIndex);return new Uint32Array(t)},vi.prototype.removeElements=function(e){for(var t=0,n=e.length;t<n;++t){var i=e[t],r=this._indexToId[i];void 0!==r&&(delete this._idToIndex[r],this._removeIndex(i))}},vi.prototype.clear=function(){this._idToIndex=Object.create(null),this._indexToId=[void 0],this._nextIndex=1,this._freeIndexes=[];for(var e=0,t=this._flexArrays;e<t.length;e++)t[e].reset();for(var n=0,i=this._indexLists;n<i.length;n++)i[n].reset()},vi.prototype.has=function(e){return void 0!==this._indexToId[e]},vi.prototype.getIndex=function(e,t){void 0===t&&(t=!1);var n=this._idToIndex[e];if(void 0===n&&t)throw new Error(this._name+' id "'+e+'" not found');return n},vi.prototype.createFlexArray=function(e){var t=e.name;if(t&&this._flexArraysByName[t])throw new Error(this._name+' flexArray "'+t+'" already exists');var i,n=e.default;return void 0===n&&"any"!==e.storage&&"resource"!==e.storage&&(n=0),i=new Fn({storage:e.storage,size:this._nextIndex,name:t,default:n}),this._flexArrays.push(i),this._defaultValues.push(e.default),t&&(this._flexArraysByName[t]=i),i},vi.prototype.getFlexArray=function(e){return this._flexArraysByName[e]||null},vi.prototype.getAllFlexArrays=function(){return this._flexArraysByName},vi.prototype.createIndexList=function(){var e=new ms;return e.reserve(this._nextIndex),this._indexLists.push(e),e},vi.prototype.getId=function(e){return this._indexToId[e]},vi.prototype.getMaxIndex=function(){return this._nextIndex-1},vi.prototype._removeIndex=function(e){this._indexesToBeFreed.push(e)},vi.prototype._getNextIndex=function(){var e=this._freeIndexes.pop();return void 0===e&&(e=this._nextIndex++),e},vi.prototype.freeIndexes=function(){for(var e=0,t=this._indexesToBeFreed;e<t.length;e++){var n=t[e];this._indexToId[n]=void 0,this._freeIndexes.push(n)}for(var i=0;i<this._flexArrays.length;++i)for(var r=this._flexArrays[i],o=this._defaultValues[i],a=0,s=this._indexesToBeFreed;a<s.length;a++)r.set(n=s[a],o);this._indexesToBeFreed=[]},vi);function vi(e){var t=this;this._nextIndex=1,this._freeIndexes=[],this._indexesToBeFreed=[],this._idToIndex=Object.create(null),this._indexToId=[void 0],this._flexArrays=[],this._defaultValues=[],this._flexArraysByName={},this._indexLists=[],this._name=e?"node":"edge",this._nextIndex=1,this._freeIndexes=[],this._indexesToBeFreed=[],this._idToIndex=Object.create(null),this._indexToId=[void 0],this._idFlexArray=new Fn({storage:"int32"}),this._idFlexArray.get=function(n){return t._indexToId[n]},this._idFlexArray.getMultiple=function(n){for(var i=new Array(n.length),r=0;r<n.length;++r)i[r]=t._indexToId[n[r]];return i},this._flexArraysByName.id=this._idFlexArray}var rr,pd,fd=(go.prototype.addEntry=function(e){return void 0===e&&(e=this._nextIndex++),e>=this._capacity&&this._reserve(e+1),this._sizes[e]=0,e},go.prototype.get=function(e){var t=this._sizes[e],n=this._MAX_LIST_SIZE*e;if(t<=this._MAX_LIST_SIZE){for(var i=0,r=this._constList.length=t;i<r;++i)this._constList[i]=this._buffer[n+i];return this._constList}if(t===this._BIG_LIST)return this._bigLists[this._buffer[n]]},go.prototype.size=function(e){var t=this._sizes[e];return t<=this._MAX_LIST_SIZE?t:this._bigLists[this._buffer[e*this._MAX_LIST_SIZE]].length},go.prototype.sizes=function(e){for(var t=this._sizes,n=this._bigLists,i=this._buffer,r=this._MAX_LIST_SIZE,o=e.length,a=new Array(o),s=0;s<o;s++){var l=e[s],u=t[l];a[s]=u<=r?u:n[i[l*r]].length}return a},go.prototype.addTo=function(e,t){var n=this._sizes[e],i=e*this._MAX_LIST_SIZE;if(n<this._MAX_LIST_SIZE)this._buffer[i+n]=t,this._sizes[e]=n+1;else if(n===this._BIG_LIST)this._bigLists[this._buffer[i]].push(t);else{for(var o=new Array(this._MAX_LIST_SIZE),a=0;a<this._MAX_LIST_SIZE;++a)o[a]=this._buffer[i+a];o.push(t),this._bigLists.push(o),this._sizes[e]=this._BIG_LIST,this._buffer[i]=this._bigLists.length-1}return this},go.prototype.removeFrom=function(e,t){return this.removeFromAndGetSize(e,t),this},go.prototype.removeFromAndGetSize=function(e,t){var n=this._MAX_LIST_SIZE*e,i=this._sizes[e];if(i<=this._MAX_LIST_SIZE){for(var r=n,o=n+i;r<o;++r)if(this._buffer[r]===t)return--i,this._buffer[r]=this._buffer[o-1],this._sizes[e]=i}else if(i===this._BIG_LIST){var s=this._bigLists[this._buffer[n]];if(-1!==(r=s.indexOf(t)))return s.splice(r,1),s.length}throw new Error('topology: Table: "removeFrom" failed, should not happen')},go.prototype.reserve=function(e){return this._capacity<e&&this._reserve(e),this},go.prototype._reserve=function(e){this._capacity=Math.pow(2,Math.ceil(Math.log2(e))),this._buffer=Ih(this._buffer,this._capacity*this._MAX_LIST_SIZE),this._sizes=Ih(this._sizes,this._capacity)},go);function go(){this._BIG_LIST=255,this._MAX_LIST_SIZE=8,this._capacity=8,this._buffer=new Uint32Array(this._capacity*this._MAX_LIST_SIZE),this._sizes=new Uint8Array(this._capacity),this._bigLists=[],this._nextIndex=0,this._constList=new Array(this._MAX_LIST_SIZE)}function Ih(e,t){var n=new e.constructor(t);return n.set(e),n}(pd=rr=rr||{}).BOTH="both",pd.IN="in",pd.OUT="out";var Oy=(ii.prototype.getAdjacentDirections=function(e){return this._neighborTable.get(e)},ii.prototype.getEdgeIndexesInDirection=function(e){return this._parallelTable.get(e)},ii.prototype.allocateNodes=function(e){this._neighborTable.reserve(e.length);for(var t=0;t<e.length;++t)this._neighborTable.addEntry(e[t])},ii.prototype.allocateEdges=function(e,t,n){this._parallelTable.reserve(Math.floor(e.length/2));for(var i=0;i<e.length;i++){var r=e[i],a=n[i];this._sourceList.set(r,t[i]),this._targetList.set(r,a),this.addToAdjacencyList(r)}},ii.prototype.getExtremity=function(e,t){var n=e?this._sourceList:this._targetList;if(t.isList){for(var i=this._graph.acquireIndexList(!0),r=0;r<t._indexes.length;r++)i.push(n.get(t._indexes[r]));return this._graph.nodeList(i.sliceAndReset())}return this._graph.getObjectList(!0).get(n.get(t._index))},ii.prototype.setExtremities=function(e,t,n){for(var i=0;i<e.length;++i)this.removeFromAdjacencyList(e[i]);for(null!==t&&this._sourceList.setMultiple(e,t),null!==n&&this._targetList.setMultiple(e,n),i=0;i<e.length;++i)this.addToAdjacencyList(e[i])},ii.prototype.addToAdjacencyList=function(e){var t=this._sourceList.get(e),n=this._targetList.get(e),i=tu(t,n),r=this._parallelEdgesIndex[i];void 0===r&&(r=this._parallelTable.addEntry(),this._parallelEdgesIndex[i]=r,this._neighborTable.addTo(t,r),t!==n&&this._neighborTable.addTo(n,r)),this._parallelTable.addTo(r,e)},ii.prototype.removeFromAdjacencyList=function(e){var t=this._sourceList.get(e),n=this._targetList.get(e),i=tu(t,n),r=this._parallelEdgesIndex[i];0===this._parallelTable.removeFromAndGetSize(r,e)&&(this._neighborTable.removeFrom(t,r),t!==n&&this._neighborTable.removeFrom(n,r),this._parallelEdgesIndex[i]=void 0)},ii.prototype.getParallelEdges=function(e,t){void 0===t&&(t={});for(var n=t.filter||"visible",i=this._graph.acquireIndexList(!1),r=this._graph.getFilter(!1,n),o=0;o<e._indexes.length;o++){var a=e._indexes[o],s=tu(this._sourceList.get(a),this._targetList.get(a)),u=this._parallelTable.get(+this._parallelEdgesIndex[s]);if(u)for(var d=0,c=u;d<c.length;d++){var h=c[d];r(h)&&i.push(h)}}return this._graph.edgeList(i.sliceAndReset())},ii.prototype.fastGetNodesAdjacentElements=function(e){for(var t=this._graph.acquireIndexList(!0),n=this._graph.acquireIndexList(!1),i=this._sourceList,r=this._targetList,o=0;o<e.length;o++)for(var a=e[o],s=0,l=this._neighborTable.get(a);s<l.length;s++){var d=this._parallelTable.get(l[s]),c=d[0],h=i.get(c),p=r.get(c);t.push(h+p-a);for(var g=0,m=d;g<m.length;g++)n.push(m[g])}return{nodes:this._graph.nodeList(t.sliceAndReset()),edges:this._graph.edgeList(n.sliceAndReset())}},ii.prototype.fastGetEdgesAdjacentElements=function(e){for(var t=this._graph.acquireIndexList(!0),n=this._graph.acquireIndexList(!1),i=this._sourceList,r=this._targetList,o=0;o<e.length;o++){var a=e[o],s=i.get(a),l=r.get(a),u=tu(s,l),c=this._parallelTable.get(+this._parallelEdgesIndex[u]);if(c)for(var h=0,p=c;h<p.length;h++)n.push(p[h]);t.push(s),t.push(l)}return{nodes:this._graph.nodeList(t.sliceAndReset()),edges:this._graph.edgeList(n.sliceAndReset())}},ii.prototype.getDeduper=function(e){return(e?this.nodeDeduper:this.edgeDeduper).reset()},ii.prototype.collectAdjacentEdges=function(e,t,n,i,r){void 0===i&&(i=!1),void 0===r&&(r=!1);var a=t===rr.IN,s=!(t===rr.OUT||a||r),l=this._graph.acquireIndexList(!1),u=this._graph.getFilter(!1,n),d=i?this.getDeduper(!1):this._fakeDeduper,c=this._fakeInvertedDeduper,h=this._sourceList,p=this._targetList;if(r){c=this.getDeduper(!0);for(var g=0;g<e.length;g++)c.set(e[g],1)}for(g=0;g<e.length;g++)for(var m=e[g],x=0,v=this._neighborTable.get(m);x<v.length;x++){var b=this._parallelTable.get(v[x]);if(s)for(var S=0,w=b;S<w.length;S++)u(D=w[S])&&0===d.get(D)&&(l.push(D),d.set(D,1));else for(var M=0,N=b;M<N.length;M++){var D=N[M],P=h.get(D),L=p.get(D),V=P+L-m;a!=(L===m)&&P!==L||!u(D)||0!==d.get(D)||1!==c.get(V)||(l.push(D),d.set(D,1))}}return l.sliceAndReset()},ii.prototype.collectAdjacentNodes=function(e,t,n,i,r,o){void 0===i&&(i=!1);var a=t!==rr.IN,s=t!==rr.OUT,l=this._graph.acquireIndexList(!0),u=this._graph.getFilter(!1,n),d=i?this.getDeduper(!0):this._fakeDeduper,c=this._sourceList,h=this._targetList;if(r)for(var p=0;p<r.length;p++){var g=r[p];l.push(g),d.set(g,1)}if(o)for(p=0;p<o.length;p++)d.set(g=o[p],1);for(p=0;p<e.length;p++)for(var m=e[p],x=0,v=this._neighborTable.get(m);x<v.length;x++)for(var b=0,S=this._parallelTable.get(v[x]);b<S.length;b++){var w=S[b];if(u(w)){var M=c.get(w),N=h.get(w);if(g=M+N-m,(s&&m===N||a&&m===M)&&0===d.get(g)){l.push(g),d.set(g,1);break}}}return l.sliceAndReset()},ii.prototype.getAdjacentElements=function(e,t,n){void 0===n&&(n={});var i=n.direction||rr.BOTH,r=n.filter||"visible",o=n.policy||"union",a=!!n.bothExtremities,s=n.includeSources;return!0===s?o="include-sources":!1===s&&(o="exclude-sources"),e?this.collectAdjacentNodes(t,i,r,!0,"include-sources"===o?t:null,"exclude-sources"===o?t:null):this.collectAdjacentEdges(t,i,r,!0,a)},ii.prototype.getEdgesBetweenTwoNodes=function(e,t){var n=tu(e,t),r=this._parallelTable.get(+this._parallelEdgesIndex[n]);return new Uint32Array(r||0)},ii.prototype.getConnectedComponents=function(e,t){for(var n=void 0===t?{}:t,i=n.filter,r=void 0===i?"visible":i,o=n.returnIds,a=void 0!==o&&o,s=n.internalIndexes,l=void 0!==s&&s,u=this._graph,d=[],c={},h=u.acquireIndexList(!0),p=u.getFilter(!0,r),g=0;g<e.length;g++)p(v=e[g])&&h.push(v);var m=h.sliceAndReset(),x={filter:r};for(g=0;g<m.length;g++){var v;if(!c[v=m[g]]){for(var y=[v],b=[];0!==y.length;){var S=y.pop();c[S]||(y.push.apply(y,this.getAdjacentElements(!0,new Uint32Array([S]),x)),c[S]=!0,b.push(S))}0<b.length&&d.push(b)}}if(a){var w=u.getNodeAttribute("id");for(g=0;g<d.length;g++)d[g]=w.getMultiple(d[g])}else if(!l)for(g=0;g<d.length;g++)d[g]=u.nodeList(new Uint32Array(d[g]));return d},ii.prototype.getAdjacencyList=function(e){for(var t=e.directed,n=e.ids,i=e.weight,r=e.nodes,o=t?rr.OUT:rr.BOTH,a=new Array(r.length),s=this._graph,l=0;l<r.length;++l)a[l]=this.collectAdjacentEdges(new Uint32Array([r[l]]),o,"all");var u=s.getEdgeAttribute("source"),d=s.getEdgeAttribute("target"),c=s.getEdgeAttribute("width"),h=s.getNodeAttribute("id"),p=[],g="number"==typeof i,m=!("function"==typeof i||g||!i);for(l=0;l<a.length;l++){for(var x=a[l],v=r[l],y=x.length,b=n?new Array(y):new Uint32Array(y),S=new Array(y),w=0;w<y;w++){var M=x[w],N=u.get(M),D=d.get(M),P=t||v===N?D:N;n&&(P=h.get(P)),b[w]=P,i&&(g&&(S[w]=i),"function"==typeof i&&(S[w]=i(s.getNode(N),s.getNode(D))),m&&(S[w]=c.get(M)||1))}var L=It({nodes:b,id:n?h.get(v):v},i&&{weights:S});p.push(L)}return p},ii.prototype.degrees=function(e,t){if(t!==rr.IN&&t!==rr.OUT)return this._neighborTable.sizes(e);for(var n=new Array(e.length),i=t===rr.IN,r=0,o=e.length;r<o;r++)n[r]=this._degree(e[r],i);return n},ii.prototype._degree=function(e,t){for(var n=this._neighborTable.get(e),i=this._sourceList,r=this._targetList,o=0,a=0;a<n.length;++a)for(var s=this._parallelTable.get(n[a]),l=0;l<s.length;++l){var u=s[l],d=i.get(u),c=r.get(u);if(t&&c===e||!t&&d===e){o+=1;break}}return o},ii.prototype.getDegree=function(e,t){for(var n=this._getDegreeOptions(t),i=n.direction,r=n.filter,o=new Array(e.length),a=new Uint32Array(1),s=0;s<e.length;++s)a[0]=e[s],o[s]=this.collectAdjacentNodes(a,i,r).length;return o},ii.prototype._getDegreeOptions=function(e){var t={direction:rr.BOTH,filter:"visible"};return"string"==typeof e?t.direction=e:e&&("string"==typeof e.direction&&(t.direction=e.direction),"string"==typeof e.filter&&(t.filter=e.filter)),t},ii);function ii(e){this._parallelEdgesIndex=[],this._fakeDeduper={get:function(){return 0},set:function(){},reset:function(){return this}},this._fakeInvertedDeduper={get:function(){return 1},set:function(){},reset:function(){return this}},this._sourceList=null,this._targetList=null,this._graph=e,this._neighborTable=new fd,this._parallelTable=new fd,this._parallelEdgesIndex=[],this.nodeDeduper=e.createNodeAttribute({storage:1}),this.edgeDeduper=e.createEdgeAttribute({storage:1}),this._sourceList=e.getEdgeAttribute("source"),this._targetList=e.getEdgeAttribute("target")}function tu(e,t){var n=e<t?e:t;return 67108864*n+(e+t-n)}function eo(e){Si||console.warn(de()+" "+e)}function kh(e){"object"==typeof e&&null!==e||(e={});var t="function"==typeof e.data?e.data:function(n){return n};return{attributes:Array.isArray(e.attributes)?e.attributes:void 0,data:t}}function ju(e){1<e&&eo("getData: more than one argument were specified, you probably want to use a single array argument instead of multiple arguments")}function Gu(e,t){for(var n=function(o){var a=t;Object.keys(a).forEach(function(s){var l=a[s];o.prototype[s]=function(u,d){return eo('Deprecated method "'+s+'"; please use "'+l+'" instead.'),this[l](u,d)}})},i=0,r=e;i<r.length;i++)n(r[i])}function Oh(e){var t=e.getFlexArray("removed"),n=e.getFlexArray("excluded"),i=e.getFlexArray("virtual");return{all:function(r){return 0===t.get(r)},visible:function(r){return 0===n.get(r)},raw:function(r){return 0===i.get(r)&&0===t.get(r)},_all:function(r){return!0}}}function Nh(e,t,n){return{all:Zu(n.all,e,t),visible:Zu(n.visible,e,t),raw:Zu(n.raw,e,t),_all:Zu(n._all,e,t)}}function Zu(e,t,n){var i=null;return{getList:function(){if(!i){var r=t(),o=n();o.reset();for(var a=1;a<=r;++a)e(a)&&o.push(a);i=o.sliceAndReset()}return i},invalidList:function(){i=null}}}function Ny(e){if(void 0===e)return Math.round(Math.random()*Number.MAX_SAFE_INTEGER);if("string"!=typeof e&&("number"!=typeof e||!isFinite(e)))throw new Error(e+" is not a valid id, expected string or number");return e}function Lh(e,t,n){for(var i=e.getObjectList(t.isNode),r=0;r<t._indexes.length;++r)n(i.get(t._indexes[r]),r)}function Fh(e,t,n){for(var i=new Array(t.size),r=e.getObjectList(t.isNode),o=0;o<t._indexes.length;++o){var s=r.get(t._indexes[o]);i[o]=n(s,o)}return i}function Ph(e,t,n){n=n||function(){return!0};for(var i=t.isNode,r=e.acquireIndexList(i),o=e.getObjectList(i),a=e.getListFactory(i),s=0;s<t._indexes.length;++s){var l=t._indexes[s],u=o.get(l);u&&n(u,s)&&r.push(l)}return a(r.sliceAndReset())}function Dh(e,t,n,i){var r=e.getListFactory(t.isNode);if(!n)return{valid:t,invalid:r()};for(var o=e.acquireIndexList(t.isNode),a=e.acquireIndexList(t.isNode),s=e.getObjectList(t.isNode),l=0;l<t._indexes.length;l++){var u=t._indexes[l],d=s.get(u);void 0!==d&&(n(d,i)?o:a).pushUnchecked(u)}return{valid:r(o.sliceAndReset()),invalid:r(a.sliceAndReset())}}function Rh(e,t,n,i){for(var r=e.getObjectList(t.isNode),o=i,a=0;a<t._indexes.length;++a)o=n(o,r.get(t._indexes[a]),a);return o}function zh(e,t){for(var n=t.isNode,i=e.topology.getDeduper(n),r=e.acquireIndexList(n),o=e.getListFactory(n),a=0;a<t._indexes.length;a++){var s=t._indexes[a];0===i.get(s)&&(i.set(s,1),r.push(s))}return o(r.sliceAndReset())}function Bh(e,t){for(var n=t.isNode,i=e.storage.fetch(n),r=i.getFlexArray("excluded"),o=i.getMaxIndex(),a=e.topology.getDeduper(n),s=e.acquireIndexList(n),l=e.getListFactory(n),u=0;u<t._indexes.length;u++)a.set(t._indexes[u],1);for(var d=1;d<=o;++d)0===a.get(d)&&0===r.get(d)&&s.push(d);return l(s.sliceAndReset())}function Vh(e,t,n){var i=e.getListFactory(t.isNode),r=new Uint32Array(t._indexes.length+n._indexes.length);return r.set(t._indexes),r.set(n._indexes,t._indexes.length),i(r)}function Uh(e,t){return e.getObjectList(t.isNode).getMultiple(t._indexes)}function qu(e,t){var n=e.getStorage(t.isNode);if(t.isList){for(var i=new Array(t.size),r=0;r<t._indexes.length;++r)i[r]=n.getId(t._indexes[r]);return i}return n.getId(t._index)}function jh(e,t){return e.topology.getExtremity(!0,t)}function Gh(e,t){return e.topology.getExtremity(!1,t)}function Zh(e,t,n){return e.getObjectList(t.isNode).get(t._indexes[n])}function qh(e,t,n){var i=e.getListFactory(t.isNode),r=e.getObjectList(t.isNode),o=t._indexes.slice();return o.sort(function(a,s){var l=r.get(a),u=r.get(s);return n(l,u)}),i(o)}var Hh=new Uint32Array(1),na=(Object.defineProperty(Wt.prototype,"_indexes",{get:function(){return Hh[0]=this._index,Hh},enumerable:!0,configurable:!0}),Wt.prototype.setAttributes=function(e,t,n){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,e,t,n)},Wt.prototype.setAttribute=function(e,t,n){return this._ogma.modules.individualAttributes.setSingleAttribute(this,e,t,n)},Wt.prototype.getAttributes=function(e){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,e)[0]},Wt.prototype.getAttribute=function(e){return this._ogma.modules.individualAttributes.getSingleAttribute(this,e)[0]},Wt.prototype.resetAttributes=function(e,t){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,e,t)},Wt.prototype.replaceOriginalAttributes=function(e,t){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,e,t)},Wt.prototype.getPreviousAttributes=function(e){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,e)[0]},Wt.prototype.isInView=function(e){return this._ogma.modules.locate.isElementInView(this,e)},Wt.prototype.getParallelEdges=function(e){return this._ogma.modules.graph.getParallelEdges(this,e)},Wt.prototype.fastGetAdjacentElements=function(){return this._ogma.modules.graph.fastGetEdgesAdjacentElements(this)},Wt.prototype.isVisible=function(){return!this.isExcluded()},Wt.prototype.isExcluded=function(){return this._ogma.modules.graph.isExcluded(this)[0]},Wt.prototype.setExcluded=function(e){return this._ogma.modules.graph.setExcluded(this,e)},Wt.prototype.setVisible=function(e){return this.setExcluded(!e)},Wt.prototype.toList=function(){return this._ogma.modules.graph.edgeList(new Uint32Array([this._index]))},Wt.prototype.getId=function(){return qu(this._ogma.modules.graph,this)},Wt.prototype.getSource=function(){return jh(this._ogma.modules.graph,this)},Wt.prototype.getTarget=function(){return Gh(this._ogma.modules.graph,this)},Wt.prototype.getExtremities=function(){return this._ogma.modules.graph.nodeList(new Uint32Array([this.getSource()._index,this.getTarget()._index]))},Wt.prototype.setSource=function(e){this._ogma.modules.graph.setSource(this,e)},Wt.prototype.setTarget=function(e){this._ogma.modules.graph.setTarget(this,e)},Wt.prototype.slice=function(){return this.toList()},Wt.prototype.toJSON=function(e){void 0===e&&(e={});var t=kh(e),n=t.attributes,i=t.data;return{id:this.getId(),source:this.getSource().getId(),target:this.getTarget().getId(),attributes:this.getAttributes(n),data:i(sn(this.getData()))}},Wt.prototype.get=function(e){return 0===e?this:void 0},Wt.prototype.setSelected=function(e){this._ogma.modules.selection.setActive(this,e)},Wt.prototype.isSelected=function(){return this._ogma.modules.selection.areActive(this)},Wt.prototype.locate=function(e){return this._ogma.modules.locate.locateElements(this,e)},Wt.prototype.getBoundingBox=function(e){return this._ogma.modules.locate.getBoundingBox(this,e)},Wt.prototype.setData=function(e,t){return arguments.length<2&&(t=e,e=null),this._ogma.modules.data.setProperty(this,e,t),this},Wt.prototype.getData=function(e){return ju(arguments.length),this._ogma.modules.data.getProperty(this,e)[0]},Wt.prototype.addClass=function(e,t){return this._ogma.modules.classes.addClassesToElements([e],this,t)},Wt.prototype.addClasses=function(e,t){return this._ogma.modules.classes.addClassesToElements(e,this,t)},Wt.prototype.removeClass=function(e,t){return this._ogma.modules.classes.removeClassesFromElements([e],this,t)},Wt.prototype.removeClasses=function(e,t){return this._ogma.modules.classes.removeClassesFromElements(e,this,t)},Wt.prototype.hasClass=function(e){return this._ogma.modules.classes.hasSingleElementClass(e,this)},Wt.prototype.getClassList=function(){return this._ogma.modules.classes.getElementsClassList(this)[0]},Wt.prototype.getAnimationInformation=function(){return this._ogma.modules.graphics.getAnimationInformation(this)[0]},Wt.prototype.isVirtual=function(){return this._ogma.modules.transformations.isElementVirtual(this)},Wt.prototype.getTransformation=function(){return this._ogma.modules.transformations.getElementTransformation(this)},Wt.prototype.getMetaEdge=function(){return this._ogma.modules.grouping.getMetaElement(this)[0]},Wt.prototype.getSubEdges=function(){return this._ogma.modules.grouping.getSubElements(this)[0]},Wt.prototype.pulse=function(e){this._ogma.modules.pulses.pulse(this,e)},Wt);function Wt(e,t){this.size=1,this.isNode=!1,this.isList=!1,this._index=e,this._ogma=t}Gu([na],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute"});var vs=(Object.defineProperty(Bt.prototype,"size",{get:function(){return this._indexes.length},enumerable:!0,configurable:!0}),Bt.prototype.setAttributes=function(e,t){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,e,t)},Bt.prototype.setAttribute=function(e,t,n){return this._ogma.modules.individualAttributes.setSingleAttribute(this,e,t,n)},Bt.prototype.getAttributes=function(e){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,e)},Bt.prototype.getAttribute=function(e){return this._ogma.modules.individualAttributes.getSingleAttribute(this,e)},Bt.prototype.resetAttributes=function(e,t){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,e,t)},Bt.prototype.replaceOriginalAttributes=function(e,t){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,e,t)},Bt.prototype.getPreviousAttributes=function(e){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,e)},Bt.prototype.getPreviousAttribute=function(e){return this._ogma.modules.individualAttributes.getSinglePreviousAttribute(this,e)},Bt.prototype.getParallelEdges=function(e){return this._ogma.modules.graph.getParallelEdges(this,e)},Bt.prototype.fastGetAdjacentElements=function(){return this._ogma.modules.graph.fastGetEdgesAdjacentElements(this)},Bt.prototype.isVisible=function(){return this.isExcluded().map(function(e){return!e})},Bt.prototype.isExcluded=function(){return this._ogma.modules.graph.isExcluded(this)},Bt.prototype.setExcluded=function(e){return this._ogma.modules.graph.setExcluded(this,e)},Bt.prototype.setVisible=function(e){return this.setExcluded(!e)},Bt.prototype.toList=function(){return this},Bt.prototype.toArray=function(){return Uh(this._ogma.modules.graph,this)},Bt.prototype.clone=function(){return this._ogma.modules.graph.edgeList(this._indexes.slice())},Bt.prototype.getId=function(){return qu(this._ogma.modules.graph,this)},Bt.prototype.getSource=function(){return jh(this._ogma.modules.graph,this)},Bt.prototype.getTarget=function(){return Gh(this._ogma.modules.graph,this)},Bt.prototype.getExtremities=function(){return this.getSource().concat(this.getTarget())},Bt.prototype.get=function(e){return Zh(this._ogma.modules.graph,this,e)},Bt.prototype.forEach=function(e){Lh(this._ogma.modules.graph,this,e)},Bt.prototype.map=function(e){return Fh(this._ogma.modules.graph,this,e)},Bt.prototype.filter=function(e){return Ph(this._ogma.modules.graph,this,e)},Bt.prototype.reduce=function(e,t){return Rh(this._ogma.modules.graph,this,e,t)},Bt.prototype.concat=function(e){return Vh(this._ogma.modules.graph,this,e)},Bt.prototype.dedupe=function(){return zh(this._ogma.modules.graph,this)},Bt.prototype.slice=function(e,t){return this._ogma.modules.graph.edgeList(this._indexes.slice(e,t))},Bt.prototype.indexOf=function(e){return e instanceof na?this._indexes.indexOf(e._index):-1},Bt.prototype.includes=function(e){return-1!==this.indexOf(e)},Bt.prototype.sort=function(e){return qh(this._ogma.modules.graph,this,e)},Bt.prototype.inverse=function(){return Bh(this._ogma.modules.graph,this)},Bt.prototype.toJSON=function(e){return void 0===e&&(e={}),this.map(function(t){return t.toJSON(e)})},Bt.prototype.setSelected=function(e){this._ogma.modules.selection.setActive(this,e)},Bt.prototype.isSelected=function(){return this._ogma.modules.selection.areActive(this)},Bt.prototype.locate=function(e){return this._ogma.modules.locate.locateElements(this,e)},Bt.prototype.getBoundingBox=function(e){return this._ogma.modules.locate.getBoundingBox(this,e)},Bt.prototype.setData=function(e,t){if(arguments.length<2&&(t=e,e=null),"function"!=typeof t&&!li(t))throw new Error("invalid argument "+t+"; expected array or function");return this._ogma.modules.data.setProperty(this,e,t,{dispatch:!0}),this},Bt.prototype.fillData=function(e,t){return arguments.length<2&&(t=e,e=null),this._ogma.modules.data.setProperty(this,e,t,{dispatch:!1}),this},Bt.prototype.getData=function(e){return ju(arguments.length),this._ogma.modules.data.getProperty(this,e)},Bt.prototype.addClass=function(e,t){return this._ogma.modules.classes.addClassesToElements([e],this,t)},Bt.prototype.addClasses=function(e,t){return this._ogma.modules.classes.addClassesToElements(e,this,t)},Bt.prototype.removeClass=function(e,t){return this._ogma.modules.classes.removeClassesFromElements([e],this,t)},Bt.prototype.removeClasses=function(e,t){return this._ogma.modules.classes.removeClassesFromElements(e,this,t)},Bt.prototype.hasClass=function(e){var t=this;return this.map(function(n){return t._ogma.modules.classes.hasSingleElementClass(e,n)})},Bt.prototype.getClassList=function(){return this._ogma.modules.classes.getElementsClassList(this)},Bt.prototype.getAnimationInformation=function(){return this._ogma.modules.graphics.getAnimationInformation(this)},Bt.prototype.getMetaEdge=function(){return this._ogma.modules.grouping.getMetaElement(this)},Bt.prototype.getSubEdges=function(){return this._ogma.modules.grouping.getSubElements(this)},Bt.prototype.pulse=function(e){this._ogma.modules.pulses.pulse(this,e)},Bt);function Bt(e,t){this.isList=!0,this.isNode=!1,this._indexes=e,this._ogma=t}Gu([vs],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute"});var ia="geo.latitude",ra="geo.longitude",nu=85.0511287798,ys={latitudePath:"latitude",longitudePath:"longitude",maxZoomLevel:22,minZoomLevel:0,wrapCoordinates:!0,tileUrlTemplate:"https://maps.wikimedia.org/osm-intl/{z}/{x}/{y}{r}.png",tileUrlSubdomains:"abc",attribution:null,attributionOptions:void 0,backgroundColor:"silver",opacity:1,duration:0,detectRetina:!1,disableNodeDragging:!0,tileBuffer:1,sizeRatio:1,tiles:{url:"https://maps.wikimedia.org/osm-intl/{z}/{x}/{y}{r}.png",subdomains:"abc",tms:!1,wms:!1},crs:null},Ly={maxBoundsViscosity:1,worldCopyJump:!0,zoomControl:!1,attributionControl:!1};function Wh(){return Wi||"undefined"!=typeof global&&!global.process}function gd(e){return Math.log2(e)+1}function Yh(e){return null!=e&&!isNaN(e)}function Xh(e,t){return Qh(e,t,"longitude")}function Jh(e,t){return Qh(e,t,"latitude")}function Qh(e,t,n){if(isNaN(t))throw new TypeError("node "+e+": "+t+" is not a valid "+n)}var Fy=Bi().createElement("div");function Hu(e,t,n,i){var r,a,l,u,c;a=t,l=i,u=(r=e).getAttribute(!0,n),r.getAttribute(true,l).setMultiple(c=a._indexes,u.getMultiple(c))}var Kh=new Uint32Array(1),_o=(Object.defineProperty(Zt.prototype,"_indexes",{get:function(){return Kh[0]=this._index,Kh},enumerable:!0,configurable:!0}),Zt.prototype.setAttributes=function(e,t){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,e,t)},Zt.prototype.setAttribute=function(e,t,n){return this._ogma.modules.individualAttributes.setSingleAttribute(this,e,t,n)},Zt.prototype.resetAttributes=function(e,t){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,e,t)},Zt.prototype.getAttributes=function(e){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,e)[0]},Zt.prototype.getAttribute=function(e){return this._ogma.modules.individualAttributes.getSingleAttribute(this,e)[0]},Zt.prototype.getPosition=function(){return this.getAttributes(["x","y"])},Zt.prototype.getPositionOnScreen=function(){return this._ogma.modules.camera.graphToScreenCoordinates(this.getPosition())},Zt.prototype.isInScreen=function(){var e=this.getPositionOnScreen(),t=this._ogma.modules.camera;return 0<=e.x&&e.x<=t.width&&0<=e.y&&e.y<=t.height},Zt.prototype.replaceOriginalAttributes=function(e,t){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,e,t)},Zt.prototype.getPreviousAttributes=function(e){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,e)[0]},Zt.prototype.isInView=function(e){return this._ogma.modules.locate.isElementInView(this,e)},Zt.prototype.getAdjacentNodes=function(e){return this._ogma.modules.graph.getAdjacentNodes(this,e)},Zt.prototype.getAdjacentEdges=function(e){return this._ogma.modules.graph.getAdjacentEdges(this,e)},Zt.prototype.getDegree=function(e){return this._ogma.modules.graph.getDegree(this,e)[0]},Zt.prototype.fastGetAdjacentElements=function(){return this._ogma.modules.graph.fastGetNodesAdjacentElements(this)},Zt.prototype.getConnectedComponent=function(e){return this._ogma.modules.graph.getConnectedComponentByNode(this,e)[0]},Zt.prototype.isVisible=function(){return!this.isExcluded()},Zt.prototype.isExcluded=function(){return this._ogma.modules.graph.isExcluded(this)[0]},Zt.prototype.setExcluded=function(e){return this._ogma.modules.graph.setExcluded(this,e)},Zt.prototype.setVisible=function(e){return this.setExcluded(!e)},Zt.prototype.toList=function(){return this._ogma.nodeList(new Uint32Array([+this._index]))},Zt.prototype.getId=function(){return qu(this._ogma.modules.graph,this)},Zt.prototype.slice=function(){return this.toList()},Zt.prototype.toJSON=function(e){void 0===e&&(e={});var t=kh(e),n=t.attributes,i=t.data;return{id:this.getId(),attributes:this.getAttributes(n),data:i(sn(this.getData()))}},Zt.prototype.get=function(e){return 0===e?this:void 0},Zt.prototype.setSelected=function(e){this._ogma.modules.selection.setActive(this,e)},Zt.prototype.isSelected=function(){return this._ogma.modules.selection.areActive(this)},Zt.prototype.locate=function(e){return this._ogma.modules.locate.locateElements(this,e)},Zt.prototype.getBoundingBox=function(){return this._ogma.modules.locate.getBoundingBox(this)},Zt.prototype.setData=function(e,t){return arguments.length<2&&(t=e,e=null),this._ogma.modules.data.setProperty(this,e,t),this},Zt.prototype.getData=function(e){return ju(arguments.length),this._ogma.modules.data.getProperty(this,e)[0]},Zt.prototype.addClass=function(e,t){return this._ogma.modules.classes.addClassesToElements([e],this,t)},Zt.prototype.addClasses=function(e,t){return this._ogma.modules.classes.addClassesToElements(e,this,t)},Zt.prototype.removeClass=function(e,t){return this._ogma.modules.classes.removeClassesFromElements([e],this,t)},Zt.prototype.removeClasses=function(e,t){return this._ogma.modules.classes.removeClassesFromElements(e,this,t)},Zt.prototype.hasClass=function(e){return this._ogma.modules.classes.hasSingleElementClass(e,this)},Zt.prototype.getClassList=function(){return this._ogma.modules.classes.getElementsClassList(this)[0]},Zt.prototype.getGeoCoordinates=function(){var e=this._ogma.modules.graph,t=e.getNodeAttribute(ia).get(this._index),n=e.getNodeAttribute(ra).get(this._index);return{latitude:Yh(t)?t:void 0,longitude:Yh(n)?n:void 0}},Zt.prototype.setGeoCoordinates=function(e){var t=this;return this.toList().setGeoCoordinates([e]).then(function(){return t})},Zt.prototype.getAnimationInformation=function(){return this._ogma.modules.graphics.getAnimationInformation(this)[0]},Zt.prototype.isVirtual=function(){return this._ogma.modules.transformations.isElementVirtual(this)},Zt.prototype.getTransformation=function(){return this._ogma.modules.transformations.getElementTransformation(this)},Zt.prototype.getMetaNode=function(){return this._ogma.modules.grouping.getMetaElement(this)[0]},Zt.prototype.getSubNodes=function(){return this._ogma.modules.grouping.getSubElements(this)[0]},Zt.prototype.pulse=function(e){this._ogma.modules.pulses.pulse(this,e)},Zt);function Zt(e,t){this.size=1,this.isNode=!0,this.isList=!1,this._index=e,this._ogma=t}Gu([_o],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute",setPosition:"setAttributes"});var or=(Object.defineProperty(Ot.prototype,"size",{get:function(){return this._indexes.length},enumerable:!0,configurable:!0}),Ot.prototype.setAttributes=function(e,t){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,e,t)},Ot.prototype.setAttribute=function(e,t,n){return this._ogma.modules.individualAttributes.setSingleAttribute(this,e,t,n)},Ot.prototype.getAttributes=function(e){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,e)},Ot.prototype.getAttribute=function(e){return this._ogma.modules.individualAttributes.getSingleAttribute(this,e)},Ot.prototype.resetAttributes=function(e,t){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,e,t)},Ot.prototype.getPosition=function(){return this.getAttributes(["x","y"])},Ot.prototype.getPositionOnScreen=function(){var e=this;return this.getPosition().map(function(t){return e._ogma.modules.camera.graphToScreenCoordinates(t)})},Ot.prototype.replaceOriginalAttributes=function(e,t){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,e,t)},Ot.prototype.getPreviousAttributes=function(e){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,e)},Ot.prototype.getPreviousAttribute=function(e){return this._ogma.modules.individualAttributes.getSinglePreviousAttribute(this,e)},Ot.prototype.getAdjacentNodes=function(e){return this._ogma.modules.graph.getAdjacentNodes(this,e)},Ot.prototype.getAdjacentEdges=function(e){return this._ogma.modules.graph.getAdjacentEdges(this,e)},Ot.prototype.getDegree=function(e){return this._ogma.modules.graph.getDegree(this,e)},Ot.prototype.getConnectedComponents=function(e){return this._ogma.modules.graph.getConnectedComponents(this,e)},Ot.prototype.fastGetAdjacentElements=function(){return this._ogma.modules.graph.fastGetNodesAdjacentElements(this)},Ot.prototype.isVisible=function(){return this.isExcluded().map(function(e){return!e})},Ot.prototype.isExcluded=function(){return this._ogma.modules.graph.isExcluded(this)},Ot.prototype.setExcluded=function(e){return this._ogma.modules.graph.setExcluded(this,e)},Ot.prototype.setVisible=function(e){return this.setExcluded(!e)},Ot.prototype.toList=function(){return this},Ot.prototype.toArray=function(){return Uh(this._ogma.modules.graph,this)},Ot.prototype.clone=function(){return this._ogma.modules.graph.nodeList(this._indexes.slice())},Ot.prototype.getId=function(){return qu(this._ogma.modules.graph,this)},Ot.prototype.get=function(e){return Zh(this._ogma.modules.graph,this,e)},Ot.prototype.forEach=function(e){Lh(this._ogma.modules.graph,this,e)},Ot.prototype.map=function(e){return Fh(this._ogma.modules.graph,this,e)},Ot.prototype.filter=function(e){return Ph(this._ogma.modules.graph,this,e)},Ot.prototype.reduce=function(e,t){return Rh(this._ogma.modules.graph,this,e,t)},Ot.prototype.concat=function(e){return Vh(this._ogma.modules.graph,this,e)},Ot.prototype.dedupe=function(){return zh(this._ogma.modules.graph,this)},Ot.prototype.slice=function(e,t){return this._ogma.modules.graph.nodeList(this._indexes.slice(e,t))},Ot.prototype.indexOf=function(e){return e instanceof _o?this._indexes.indexOf(e._index):-1},Ot.prototype.includes=function(e){return-1!==this.indexOf(e)},Ot.prototype.inverse=function(){return Bh(this._ogma.modules.graph,this)},Ot.prototype.sort=function(e){return qh(this._ogma.modules.graph,this,e)},Ot.prototype.toJSON=function(e){return void 0===e&&(e={}),this.map(function(t){return t.toJSON(e)})},Ot.prototype.setSelected=function(e){this._ogma.modules.selection.setActive(this,e)},Ot.prototype.isSelected=function(){return this._ogma.modules.selection.areActive(this)},Ot.prototype.locate=function(e){return this._ogma.modules.locate.locateElements(this,e)},Ot.prototype.getBoundingBox=function(){return this._ogma.modules.locate.getBoundingBox(this)},Ot.prototype.setData=function(e,t){if(arguments.length<2&&(t=e,e=null),"function"!=typeof t&&!li(t))throw new Error("invalid argument "+t+"; expected array or function");return this._ogma.modules.data.setProperty(this,e,t,{dispatch:!0}),this},Ot.prototype.fillData=function(e,t){return arguments.length<2&&(t=e,e=null),this._ogma.modules.data.setProperty(this,e,t,{dispatch:!1}),this},Ot.prototype.getData=function(e){return ju(arguments.length),this._ogma.modules.data.getProperty(this,e)},Ot.prototype.addClass=function(e,t){return this._ogma.modules.classes.addClassesToElements([e],this,t)},Ot.prototype.addClasses=function(e,t){return this._ogma.modules.classes.addClassesToElements(e,this,t)},Ot.prototype.removeClass=function(e,t){return this._ogma.modules.classes.removeClassesFromElements([e],this,t)},Ot.prototype.removeClasses=function(e,t){return this._ogma.modules.classes.removeClassesFromElements(e,this,t)},Ot.prototype.hasClass=function(e){var t=this;return this.map(function(n){return t._ogma.modules.classes.hasSingleElementClass(e,n)})},Ot.prototype.getClassList=function(){return this._ogma.modules.classes.getElementsClassList(this)},Ot.prototype.getGeoCoordinates=function(){for(var e=this._ogma.modules.graph,t=new Array(this._indexes.length),n=e.getNodeAttribute(ia).getMultiple(this._indexes),i=e.getNodeAttribute(ra).getMultiple(this._indexes),r=0,o=this._indexes.length;r<o;r++)t[r]={latitude:n[r],longitude:i[r]};return t},Ot.prototype.setGeoCoordinates=function(e){var t=this,n=this._ogma.modules.geo,i=this._ogma.modules.graph,r=this.getId(),o=this._indexes,a=new Array(o.length),s=new Array(o.length);if(null===e&&(e=new Array(o.length).fill(null)),e.length!==o.length)throw new RangeError("You must provide coordinates for each node in the NodeList");for(var l=0,u=o.length;l<u;l++){var d=e[l]||{latitude:null,longitude:null},c=d.latitude,h=d.longitude,p=r[l];null==c&&null==h?c=h=void 0:(Jh(p,c),Xh(p,h)),a[l]=c,s[l]=h}return this.setData(n.latitudePath,a),this.setData(n.longitudePath,s),i.getNodeAttribute(ia).setMultiple(o,a),i.getNodeAttribute(ra).setMultiple(o,s),this._ogma.modules.transformations.refresh().then(function(){return t})},Ot.prototype.getAnimationInformation=function(){return this._ogma.modules.graphics.getAnimationInformation(this)},Ot.prototype.getMetaNode=function(){return this._ogma.modules.grouping.getMetaElement(this)},Ot.prototype.getSubNodes=function(){return this._ogma.modules.grouping.getSubElements(this)},Ot.prototype.pulse=function(e){this._ogma.modules.pulses.pulse(this,e)},Ot);function Ot(e,t){this.isList=!0,this.isNode=!0,this._indexes=e,this._ogma=t}function Wu(e,t,n,i){return void 0===n&&(n={}),void 0===i&&(i={}),iu(e,t,[n],i).get(0)}function xs(e,t,n,i){if(void 0===i&&(i={}),i.batchSize){for(var r=[],o=0;o<n.length;o+=i.batchSize)r.push(n.slice(o,o+i.batchSize));return r.reduce(function(a,s){var l=null;return a.then(function(u){return l=u,e.getDom().afterNextFrame()}).then(function(){return iu(e,t,s,i)}).then(function(u){return l.concat(u)})},Promise.resolve(t?e.nodeList():e.edgeList()))}return Promise.resolve(iu(e,t,n,i))}function iu(e,t,n,i){for(var r=e.storage.fetch(t),o=[],a=[],s=[],l=[],u=new Set,d=i.virtual,c=void 0!==d&&d,h=0,p=n;h<p.length;h++){var g=p[h];if("object"!=typeof g||null===g||Array.isArray(g))throw new Error(g+" is not a valid "+(t?"node":"edge"));var m=Ny(g.id);if(!r.getIndex(m,!1)&&!u.has(m)&&(a.push(m),o.push(g),u.add(m),!t)){var x=g,v=e.getExtremityIndex(m,x.source,"source"),y=e.getExtremityIndex(m,x.target,"target");s.push(v),l.push(y)}}var b=r.addElements(a);t?e.topology.allocateNodes(b):e.topology.allocateEdges(b,s,l);for(var S=r.getFlexArray("object"),w=r.getFlexArray("excluded"),M=r.getFlexArray("removed"),N=r.getFlexArray("virtual"),D=t?e.node:e.edge,P=t?e.nodeList:e.edgeList,L=e.getCacheLists(t),V=P(b),X=0;X<b.length;X++){var J=b[X];S.set(J,D(J))}return w.setMultiple(b,0),M.setMultiple(b,0),N.setMultiple(b,c?1:0),L.visible.invalidList(),L.all.invalidList(),L._all.invalidList(),c||L.raw.invalidList(),0!==V.size&&(t?e.fireEvent(I.ADD_NODES,{virtual:c,objects:o,nodes:V}):e.fireEvent(I.ADD_EDGES,{virtual:c,objects:o,edges:V})),V}Gu([or],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute",setPosition:"setAttributes"});var $h,Py=(St(Nt,$h=Pe),Nt.prototype.onMounted=function(e,t){if(t.graph){var n=t.graph,i=n.nodes,r=n.edges;i&&this.addNodes(i),r&&this.addEdges(r)}},Nt.prototype.createIndexList=function(e){return this.storage.fetch(e).createIndexList()},Nt.prototype.setIndexFreeStep=function(e){this._indexFreeStep=e},Nt.prototype.getDom=function(){return this._dom},Nt.prototype.acquireIndexList=function(e){var t=e?this._nodeIndexLists:this._edgeIndexLists,n=t.find(function(i){return!i.isBusy()});return n||(n=this.createIndexList(e),t.push(n)),n.markBusy(),n},Nt.prototype.getObjectList=function(e){return e?this._nodes:this._edges},Nt.prototype.getListFactory=function(e){return e?this.nodeList:this.edgeList},Nt.prototype.getStorage=function(e){return e?this.storage.nodes:this.storage.edges},Nt.prototype.getFilter=function(e,t){var n=e?this._nodeFilters:this._edgeFilters;return n[t]||n.visible},Nt.prototype.fireEvent=function(e,t){this._events.fire(e,t)},Nt.prototype.getCacheLists=function(e){return e?this._nodeCacheLists:this._edgeCacheLists},Nt.prototype._resolvePromises=function(){var e=this._promisesToResolve;this._promisesToResolve=[],e.forEach(function(t){return t()})},Nt.prototype._initialize=function(){var e=this;this._nodeCacheLists=Nh(function(){return e.getNodeMaxIndex()},function(){return e.acquireIndexList(!0)},this._nodeFilters),this._edgeCacheLists=Nh(function(){return e.getEdgeMaxIndex()},function(){return e.acquireIndexList(!1)},this._edgeFilters),this.topology=new Oy(this),this._resolvePromises()},Nt.prototype.getNodeMaxIndex=function(){return this.storage.nodes.getMaxIndex()},Nt.prototype.getEdgeMaxIndex=function(){return this.storage.edges.getMaxIndex()},Nt.prototype.isExcluded=function(e){return this.storage.fetch(e.isNode).getFlexArray("excluded").getMultiple(e._indexes)},Nt.prototype.setExcluded=function(e,t){for(var n=t?1:0,i=e.isNode,r=this.storage.fetch(i),o=r.getFlexArray("excluded"),a=r.getFlexArray("removed"),s=this.acquireIndexList(i),l=this.getListFactory(i),u=0;u<e._indexes.length;u++){var d=e._indexes[u],c=o.get(d),h=a.get(d);n!==c&&0===h&&s.push(d)}var p=s.sliceAndReset();if(p.length){this.getCacheLists(e.isNode).visible.invalidList();var g=l(p);o.setMultiple(p,n),this._events.fire(I.EXCLUDED_STATE_CHANGE,{elements:g,value:t})}},Nt.prototype.addNode=function(e,t){return Wu(this,!0,e,t)},Nt.prototype.addEdge=function(e,t){return Wu(this,!1,e,t)},Nt.prototype.addNodes=function(e,t){return xs(this,!0,e,t)},Nt.prototype.addEdges=function(e,t){return xs(this,!1,e,t)},Nt.prototype.getExtremityIndex=function(e,t,n){if(t instanceof _o)return t._index;var i=this.storage.nodes.getIndex(t);if(!i)throw new Error("addEdge(s): invalid "+n+' for edge "'+e+'"; node "'+t+'" does not exist');return i},Nt.prototype.getNodes=function(e){return this.getElements(!0,e)},Nt.prototype.getEdges=function(e){return this.getElements(!1,e)},Nt.prototype.getElements=function(e,t){var n=e?this.nodeList:this.edgeList,i=e?or:vs,r=e?_o:na;if(t&&"string"!=typeof t){var o=this.acquireIndexList(e),a=this.storage.fetch(e);if(t instanceof r)o.push(t._index);else if(li(t))for(var s=0,l=t;s<l.length;s++){var u=l[s];u instanceof r?o.push(u._index):(p=a.getIndex(u))&&o.push(p)}else if(t instanceof i)for(var d=this.getFilter(e,"all"),c=t,h=0;h<c._indexes.length;h++){var p;d(p=c._indexes[h])&&o.push(p)}return n(o.sliceAndReset())}var g=t||"visible",m=this.getCacheLists(e)[g];if(!m)throw new Error('getNodes/getEdges: unexpected argument "'+g+'"');return n(m.getList())},Nt.prototype.getNode=function(e){return this._getElement(!0,e)},Nt.prototype.getEdge=function(e){return this._getElement(!1,e)},Nt.prototype._getElement=function(e,t){if(t instanceof(e?_o:na))return t;var n=this.getStorage(e),i=this.getObjectList(e),r=n.getIndex(t);return r?i.get(r):void 0},Nt.prototype.clear=function(){this._events.fire(I.CLEAR_GRAPH),this.storage.nodes.clear(),this.storage.edges.clear(),this._initialize()},Nt.prototype.createAttribute=function(e,t){return this.storage.fetch(e).createFlexArray(t)},Nt.prototype.createNodeAttribute=function(e){return this.createAttribute(!0,e)},Nt.prototype.createEdgeAttribute=function(e){return this.createAttribute(!1,e)},Nt.prototype.getAttribute=function(e,t){return this.storage.fetch(e).getFlexArray(t)},Nt.prototype.getAttributes=function(e,t){var n=this;return t.map(function(i){return n.getAttribute(e,i)})},Nt.prototype.getNodeAttribute=function(e){return this.storage.nodes.getFlexArray(e)},Nt.prototype.getNodeAttributes=function(e){return this.getAttributes(!0,e)},Nt.prototype.getEdgeAttribute=function(e){return this.storage.edges.getFlexArray(e)},Nt.prototype.getEdgeAttributes=function(e){return this.getAttributes(!1,e)},Nt.prototype.getAllNodeAttributes=function(){return this.storage.nodes.getAllFlexArrays()},Nt.prototype.getAllEdgeAttributes=function(){return this.storage.edges.getAllFlexArrays()},Nt.prototype.setSource=function(e,t){var n=this.getNode(t);this.topology.setExtremities(e._indexes,n._indexes,null)},Nt.prototype.setTarget=function(e,t){var n=this.getNode(t);this.topology.setExtremities(e._indexes,null,n._indexes)},Nt.prototype.getParallelEdges=function(e,t){return void 0===t&&(t={}),this.topology.getParallelEdges(e,t)},Nt.prototype.getEdgesBetweenTwoNodes=function(e,t){return this.edgeList(this.topology.getEdgesBetweenTwoNodes(e._index,t._index))},Nt.prototype.getAdjacentDirections=function(e){return this.topology.getAdjacentDirections(e)},Nt.prototype.getEdgeIndexesInDirection=function(e){return this.topology.getEdgeIndexesInDirection(e)},Nt.prototype.fastGetNodesAdjacentElements=function(e){return this.topology.fastGetNodesAdjacentElements(e._indexes)},Nt.prototype.fastGetEdgesAdjacentElements=function(e){return this.topology.fastGetEdgesAdjacentElements(e._indexes)},Nt.prototype.getAdjacentNodes=function(e,t){return this.nodeList(this.topology.getAdjacentElements(!0,e._indexes,t))},Nt.prototype.getAdjacentEdges=function(e,t){return this.edgeList(this.topology.getAdjacentElements(!1,e._indexes,t))},Nt.prototype.getDegree=function(e,t){return this.topology.getDegree(e._indexes,t)},Nt.prototype.degrees=function(e,t){return this.topology.degrees(e,t)},Nt.prototype.getAdjacencyList=function(e){var t=void 0===e?{}:e,n=t.directed,r=t.internalIndexes,a=t.weight;return this.topology.getAdjacencyList({directed:void 0!==n&&n,weight:void 0===a?1:a,ids:!(void 0!==r&&r),nodes:t.indexes||this.getNodes(t.nodes)._indexes})},Nt.prototype.getConnectedComponents=function(e,t){return this.topology.getConnectedComponents(e._indexes,t)},Nt.prototype.getConnectedComponentByNode=function(e,t){return this.topology.getConnectedComponents(e._indexes,t)},Nt);function Nt(e,t){var n=e.dom,i=e.events,r=$h.call(this)||this;return r.storage={nodes:new fo(!0),edges:new fo(!1),fetch:function(o){return o?this.nodes:this.edges}},r._promisesToResolve=[],r._indexFreeStep=0,r._nodeIndexLists=[],r._edgeIndexLists=[],r._events=i,r._dom=n,r._events.register([I.ADD_NODES,I.ADD_EDGES,I.EXCLUDED_STATE_CHANGE],[I.CLEAR_GRAPH,I.BEFORE_REMOVE_NODES,I.REMOVE_NODES,I.BEFORE_REMOVE_EDGES,I.REMOVE_EDGES]),[{name:"excluded",storage:1,default:1},{name:"removed",storage:1,default:1},{name:"virtual",storage:1,default:0}].forEach(function(o){r.createNodeAttribute(o),r.createEdgeAttribute(o)}),r.node=t.node,r.edge=t.edge,r.nodeList=t.nodeList,r.edgeList=t.edgeList,r._nodes=r.createAttribute(!0,{name:"object",storage:"any"}),r._edges=r.createAttribute(!1,{name:"object",storage:"any"}),r.createAttribute(!1,{name:"source",storage:32}),r.createAttribute(!1,{name:"target",storage:32}),r._nodeFilters=Oh(r.storage.nodes),r._edgeFilters=Oh(r.storage.edges),r._initialize(),r._events.on({newFrame:function(){1===r._indexFreeStep?r._indexFreeStep=2:2===r._indexFreeStep&&(r.storage.nodes.freeIndexes(),r.storage.edges.freeIndexes(),r._indexFreeStep=0)}}),r}var _d=["AliceBlue","#F0F8FF","AntiqueWhite","#FAEBD7","Aqua","#00FFFF","Aquamarine","#7FFFD4","Azure","#F0FFFF","Beige","#F5F5DC","Bisque","#FFE4C4","Black","#000000","BlanchedAlmond","#FFEBCD","Blue","#0000FF","BlueViolet","#8A2BE2","Brown","#A52A2A","BurlyWood","#DEB887","CadetBlue","#5F9EA0","Chartreuse","#7FFF00","Chocolate","#D2691E","Coral","#FF7F50","CornflowerBlue","#6495ED","Cornsilk","#FFF8DC","Crimson","#DC143C","Cyan","#00FFFF","DarkBlue","#00008B","DarkCyan","#008B8B","DarkGoldenRod","#B8860B","DarkGray","#A9A9A9","DarkGrey","#A9A9A9","DarkGreen","#006400","DarkKhaki","#BDB76B","DarkMagenta","#8B008B","DarkOliveGreen","#556B2F","DarkOrange","#FF8C00","DarkOrchid","#9932CC","DarkRed","#8B0000","DarkSalmon","#E9967A","DarkSeaGreen","#8FBC8F","DarkSlateBlue","#483D8B","DarkSlateGray","#2F4F4F","DarkSlateGrey","#2F4F4F","DarkTurquoise","#00CED1","DarkViolet","#9400D3","DeepPink","#FF1493","DeepSkyBlue","#00BFFF","DimGray","#696969","DimGrey","#696969","DodgerBlue","#1E90FF","FireBrick","#B22222","FloralWhite","#FFFAF0","ForestGreen","#228B22","Fuchsia","#FF00FF","Gainsboro","#DCDCDC","GhostWhite","#F8F8FF","Gold","#FFD700","GoldenRod","#DAA520","Gray","#808080","Grey","#808080","Green","#008000","GreenYellow","#ADFF2F","HoneyDew","#F0FFF0","HotPink","#FF69B4","IndianRed","#CD5C5C","Indigo","#4B0082","Ivory","#FFFFF0","Khaki","#F0E68C","Lavender","#E6E6FA","LavenderBlush","#FFF0F5","LawnGreen","#7CFC00","LemonChiffon","#FFFACD","LightBlue","#ADD8E6","LightCoral","#F08080","LightCyan","#E0FFFF","LightGoldenRodYellow","#FAFAD2","LightGray","#D3D3D3","LightGrey","#D3D3D3","LightGreen","#90EE90","LightPink","#FFB6C1","LightSalmon","#FFA07A","LightSeaGreen","#20B2AA","LightSkyBlue","#87CEFA","LightSlateGray","#778899","LightSlateGrey","#778899","LightSteelBlue","#B0C4DE","LightYellow","#FFFFE0","Lime","#00FF00","LimeGreen","#32CD32","Linen","#FAF0E6","Magenta","#FF00FF","Maroon","#800000","MediumAquaMarine","#66CDAA","MediumBlue","#0000CD","MediumOrchid","#BA55D3","MediumPurple","#9370DB","MediumSeaGreen","#3CB371","MediumSlateBlue","#7B68EE","MediumSpringGreen","#00FA9A","MediumTurquoise","#48D1CC","MediumVioletRed","#C71585","MidnightBlue","#191970","MintCream","#F5FFFA","MistyRose","#FFE4E1","Moccasin","#FFE4B5","NavajoWhite","#FFDEAD","Navy","#000080","OldLace","#FDF5E6","Olive","#808000","OliveDrab","#6B8E23","Orange","#FFA500","OrangeRed","#FF4500","Orchid","#DA70D6","PaleGoldenRod","#EEE8AA","PaleGreen","#98FB98","PaleTurquoise","#AFEEEE","PaleVioletRed","#DB7093","PapayaWhip","#FFEFD5","PeachPuff","#FFDAB9","Peru","#CD853F","Pink","#FFC0CB","Plum","#DDA0DD","PowderBlue","#B0E0E6","Purple","#800080","RebeccaPurple","#663399","Red","#FF0000","RosyBrown","#BC8F8F","RoyalBlue","#4169E1","SaddleBrown","#8B4513","Salmon","#FA8072","SandyBrown","#F4A460","SeaGreen","#2E8B57","SeaShell","#FFF5EE","Sienna","#A0522D","Silver","#C0C0C0","SkyBlue","#87CEEB","SlateBlue","#6A5ACD","SlateGray","#708090","SlateGrey","#708090","Snow","#FFFAFA","SpringGreen","#00FF7F","SteelBlue","#4682B4","Tan","#D2B48C","Teal","#008080","Thistle","#D8BFD8","Tomato","#FF6347","Turquoise","#40E0D0","Violet","#EE82EE","Wheat","#F5DEB3","White","#FFFFFF","WhiteSmoke","#F5F5F5","Yellow","#FFFF00","YellowGreen","#9ACD32"],Dy=/^rgba?\((\d+),?\s*(\d+),?\s*(\d+),?\s*((\d+)?\.?\d+)*\)$/;function md(e,t){void 0===t&&(t=[0,0,0,0]);var n=Dy.exec(e);return n?(t[0]=parseInt(n[1])/255,t[1]=parseInt(n[2])/255,t[2]=parseInt(n[3])/255,t[3]=void 0===n[4]?1:parseFloat(n[4]),t):null}function Yu(e){return e<16?"0"+e.toString(16):e.toString(16)}function ep(e){var r=e[3];return"rgba("+(256*e[0]|0)+","+(256*e[1]|0)+","+(256*e[2]|0)+","+(void 0===r?1:r)+")"}function vd(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(n,i,r,o){return i+i+r+r+o+o});var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?[parseInt(t[1],16)/255,parseInt(t[2],16)/255,parseInt(t[3],16)/255,1]:null}var ru=[0,0,0,0],ou=(Xu.prototype.parseColor=function(e){var t=this._colorByName[e];if(void 0===t){var n=e+"";t="#"===n.charAt(0)?vd(n):md(n),this._colorByName[e]=t}return t},Xu.prototype.toHexa=function(e){var t=this.parseColor(e),i=t[1],r=t[2];return"#"+Yu(255*t[0])+Yu(255*i)+Yu(255*r)},Xu.prototype.rgbaToRgb=function(e){var t=1,n=e;return n&&md(e,ru)&&(n="rgb("+255*ru[0]+","+255*ru[1]+","+255*ru[2]+")",t=parseFloat(ru[3].toString())),{color:n,opacity:t}},Xu);function Xu(){this._colorByName={},this._colorByName.null=[0,0,0,0],this._colorByName.transparent=[0,0,0,0];for(var e=0;e<_d.length;e+=2){var t=_d[e].toLowerCase();this._colorByName[t]=vd(_d[e+1])}}var bs,Ry=((bs={})[2]="image",bs[4]="piechart",bs[3]="text",bs[5]="icon",bs[6]="badge",bs),zy=(Ji.prototype.reset=function(){this._init_()},Ji.prototype._init_=function(){this._mustUpdate=!0,this._nextPatternId=1,this._patterns=[null],this._patternsByHash={},this._pixelRatio=1,this._nullPattern={id:-1,type:1,attributes:{}}},Ji.prototype._increaseNextId=function(){var e=this._nextPatternId++;for(e%256==255&&(e=this._nextPatternId++);this._patterns.length<=e;)this._patterns.push(void 0);return e},Ji.prototype._createPattern=function(e){var t=e.type,n=e.attributes,i={id:this._increaseNextId(),type:t,attributes:this._cloneAttributes(t,n)};return this._patterns[i.id]=i,this._mustUpdate=!0,i},Ji.prototype._cloneAttributes=function(e,t){return 2===e?{image:t.image,scaled:t.scaled,duplicated:t.duplicated}:3===e||5===e||6===e?{font:t.font,size:t.size,style:t.style,text:t.text,align:t.align||"center",offset:t.offset||0}:4===e?{colors:t.colors,colorArray:t.colors.split(";").map(function(n){return n.trim()})}:void 0},Ji.prototype.getPatternList=function(){return this._patterns.filter(function(e){return e})},Ji.prototype.update=function(){this._mustUpdate&&(this._version+=1,this._mustUpdate=!1)},Ji.prototype.setPixelRatio=function(e){e!==this._pixelRatio&&(this._pixelRatio=e,this._mustUpdate=!0)},Ji.prototype.getPixelRatio=function(){return this._pixelRatio},Ji.prototype.notifyUpdate=function(){this._mustUpdate=!0},Ji.prototype.getIdFromDefinition=function(e){var t=e.type,n=e.attributes,r=0;return t&&1!==t&&7!==t&&(2!==t||n.image)&&(!(3===t||5===t||6===t)||n.text&&n.font)&&(r=this._addPattern(e),3===t&&"normal"===n.style&&(n.style="bold",this._addPattern(e))),r},Ji.prototype._addPattern=function(e){var t=this._getPatternHash(e),n=this._patternsByHash[t];return n||(65500<this._nextPatternId?eo("maximum number of pattern exceeded"):(n=this._createPattern(e).id,this._patternsByHash[t]=n)),n},Ji.prototype._getPatternHash=function(e){var t=e.type,n=e.attributes,i=[Ry[t]];return 2===t?i.push(n.scaled?"scaled":"non-scaled",n.duplicated?"duplicated":"non-duplicated",n.image.src||n.image.toDataURL()):3===t?i.push(n.text,n.font,n.style,n.size,n.align||"center",n.offset||0):5===t||6===t?i.push(n.text,n.font,n.style,n.size):i.push(n.colors),i.join("+")},Ji.prototype.getDefinitionFromId=function(e){return e?this._patterns[e]:this._nullPattern},Ji.prototype.getVersion=function(){return this._version},Ji);function Ji(){this._pixelRatio=1,this._nextPatternId=1,this._version=0,this._init_()}var tp=Math.round(Math.log2(512)),bd=Math.round(Math.log2(128)),By=tp+bd,Ed=Math.round(Math.sqrt(16)),Sd=128*Ed,wr=256;function np(e){return e.map(function(t){var r=t.r;return{x:t.x,y:t.y,r:void 0===r?0:r}})}var Vy=(ua.prototype.register=function(e,t){var n=t.getDistanceFromStrokeVertically,i=t.getDistanceFromStrokeHorizontally,r=t.points,o=t.hole,a=t.isSimple;if(!this._byName[e]){for(var s=a?1:8,l=a?7:15;this._byId[s];)s+=1;if(l<s)throw new Error("max number of shape exceeded");var u={id:s,name:e,getDistanceFromStrokeVertically:n,getDistanceFromStrokeHorizontally:i,points:np(r.slice()),hole:o?np(o.slice()):null,isSimple:!!a};return this._mustUpdate=!0,this._byId[s]=u,this._byName[e]=u}},ua.prototype.getIdFromName=function(e){return this._byName[e].id},ua.prototype.getNameFromId=function(e){var t=this._byId[e];return t?t.name:null},ua.prototype.getDefinitionFromName=function(e){return this._byName[e]||null},ua.prototype.update=function(){this._mustUpdate&&(this._version+=1,this._mustUpdate=!1)},ua.prototype.getVersion=function(){return this._version},ua.prototype.getShapeList=function(){return this._byId.filter(function(e){return e})},ua);function ua(){this._version=0,this._mustUpdate=!0,this._byName={},this._byId=new Array(16)}var Uy=(ri.prototype.update=function(){this._mustUpdate&&(this._version+=1,this._mustUpdate=!1,this._isFullyAllocated&&this._nbCellsFreed===this._nbCellsAllocated&&(this._isFullyFreed=!0))},ri.prototype.allocate=function(e){var t=-1;return!this._isFullyAllocated&&this._nbCellsAllocated+e<=this._capacity?(t=this._nbCellsAllocated,this._nbCellsAllocated+=e,this._mustUpdate=!0):this._isFullyAllocated=!0,t},ri.prototype.free=function(e,t){for(var n=0;n<t;n++){var i=(e+n)*this._elementSize;if(0===this._dataView.getUint16(i))throw new Error('"free": invalid address provided');this._dataView.setUint16(i,0)}this._mustUpdate=!0,this._nbCellsFreed+=t},ri.prototype.triggerUpdate=function(){this._mustUpdate=!0},ri.prototype.isEmpty=function(){return this._nbCellsFreed===this._nbCellsAllocated},ri.prototype.isFullyFreed=function(){return this._isFullyFreed},ri.prototype.getId=function(){return this._id},ri.prototype.getDepth=function(){return this._depth},ri.prototype.getElementType=function(){return this._elementType},ri.prototype.getDataView=function(){return this._dataView},ri.prototype.getByteArray=function(){return this._byteArray},ri.prototype.getElementSize=function(){return this._elementSize},ri.prototype.isAnimated=function(){return this._animated},ri.prototype.getCapacity=function(){return this._capacity},ri.prototype.getSize=function(){return this._nbCellsAllocated},ri.prototype.getNbSideElementsPerMainElement=function(){return this._nbSideElementsPerMainElement},ri.prototype.hasSideData=function(){return 0<this._nbSideElementsPerMainElement},ri.prototype.getSideDataView=function(){return this._sideDataView},ri.prototype.getSideByteArray=function(){return this._sideByteArray},ri.prototype.getTotalSideElementsSize=function(){return this._totalSideElementsSize},ri.prototype.getVersion=function(){return this._version},ri.prototype.getStencilUsage=function(){return this._stencilUsage},ri);function ri(e){var t=e.elementSize,n=e.sideElementSize,i=e.nbSideElementsPerMainElement,r=e.id,o=e.depth,a=e.elementType,s=e.animated,l=e.stencilUsage;this._version=0,this._nbCellsAllocated=0,this._nbCellsFreed=0,this._isFullyAllocated=!1,this._isFullyFreed=!1,this._mustUpdate=!0,this._capacity=512,this._id=r,this._depth=o,this._elementType=a,this._animated=s,this._stencilUsage=l,this._elementSize=t,this._sideElementSize=n,this._nbSideElementsPerMainElement=i,this._totalSideElementsSize=i*n,this._byteCapacity=this._capacity*this._elementSize,this._byteArray=new Uint8Array(this._byteCapacity),this._dataView=new DataView(this._byteArray.buffer),this._sideByteCapacity=this._capacity*this._totalSideElementsSize,this._sideByteArray=new Uint8Array(this._sideByteCapacity),this._sideDataView=new DataView(this._sideByteArray.buffer)}var jy=(ar.prototype.reset=function(){this._init_()},ar.prototype._init_=function(){this._buffersByDepth=new Array(100),this._buffersById=[],this._buffersByAscendingDepth=[],this._buffersByDescendingDepth=[],this._mustUpdate=!0},ar.prototype._fillBlockInfo=function(e,t,n,i){return this._blockInfo.buffer=e,this._blockInfo.offset=t,this._blockInfo.size=n,this._blockInfo.address=i,this._blockInfo},ar.prototype._createBuffer=function(e,t,n,i,r){var s=new Uy({elementSize:t?120:52,sideElementSize:4,nbSideElementsPerMainElement:i,id:this._buffersById.length,depth:n,elementType:e,animated:t,stencilUsage:r});return this._buffersById.push(s),s},ar.prototype.getBlockInfo=function(e){return this._getBlockInfo(e)},ar.prototype._getBlockInfo=function(e){return this._fillBlockInfo(this._buffersById[e>>By],(e>>bd)%512,e%128,e)},ar.prototype.allocateBlock=function(e,t,n,i,r,o,a){var s=function(J,se){for(var re=0;re<J;)re+=8;return re}(o);this._mustUpdate=!0;var l=null,u=-1;if(e){var d=this._getBlockInfo(e),c=d.buffer,h=d.offset,p=d.size,g=d.size===r,m=c.getDepth()===i,x=c.getElementType()===t,v=c.isAnimated()===n,y=c.getNbSideElementsPerMainElement()===s,b=c.getStencilUsage()===a;g&&m&&x&&v&&y&&b?(c.triggerUpdate(),l=c,u=h):c.free(h,p)}if(-1===u){var S=+n,w=s/8,M=this._buffersByDepth[i]||Array(2),N=(this._buffersByDepth[i]=M)[S]||[],D=(M[S]=N)[t]||Array(16),P=(N[t]=D)[w]||Array(4),L=(D[w]=P)[a]||[],V=(P[a]=L)[L.length-1];V&&(u=(l=V).allocate(r)),-1===u&&(u=(l=this._createBuffer(t,n,i,s,a)).allocate(r),L.push(l))}var X=((l.getId()<<tp)+u<<bd)+r;return this._fillBlockInfo(l,u,r,X)},ar.prototype.freeBlock=function(e){if(e){this._mustUpdate=!0;var t=this._getBlockInfo(e);t.buffer.free(t.offset,t.size)}return 0},ar.prototype._sortBuffersByDepth=function(){for(var e=[],t=0;t<this._buffersByDepth.length;t++){var n=this._buffersByDepth[t];if(n)for(var i=0;i<n.length;i++){var r=n[i];if(r)for(var o=0;o<r.length;o++){var a=r[o];if(a)for(var s=0;s<a.length;s++){var l=a[s];if(l)for(var u=0;u<l.length;u++){var d=l[u];if(d)for(var c=0;c<d.length;c++){var h=d[c];h.update(),h.isFullyFreed()?(this._buffersById[h.getId()]=void 0,d.splice(c,1),--c):e.push(h)}}}}}}this._buffersByAscendingDepth=e,this._buffersByDescendingDepth=e.slice().reverse()},ar.prototype.update=function(){this._mustUpdate&&(this._sortBuffersByDepth(),this._version+=1,this._mustUpdate=!1)},ar.prototype.getBuffers=function(){return this._buffersById},ar.prototype.getBuffersByAscendingDepth=function(){return this._buffersByAscendingDepth},ar.prototype.getBuffersByDescendingDepth=function(){return this._buffersByDescendingDepth},ar.prototype.getVersion=function(){return this._version},ar);function ar(){this._version=0,this._version=0,this._blockInfo={buffer:null,offset:0,size:0,address:0},this._init_()}var ip=(Object.defineProperty(la.prototype,"__dummy",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(la.prototype,"parentNode",{get:function(){return null},enumerable:!0,configurable:!0}),la.prototype.getContext=function(e){return"2d"===e?this.__context:null},la.prototype.toDataURL=function(e){return void 0===e&&(e="png"),"data:image/"+e+";base64,"},la.prototype.addEventListener=function(){},la.prototype.removeEventListener=function(){},la.prototype.getBoundingClientRect=function(){return{left:0,top:0,bottom:0,right:0,width:this.width,height:this.height}},la);function la(){this.style={},this.width=300,this.height=150,this.__context=new rp,this.style={},this.width=300,this.height=150}var rp=(Object.defineProperty(Tn.prototype,"font",{set:function(e){var t=e.match(/\d+/);t&&(this._fontSize=parseFloat(t[0]))},enumerable:!0,configurable:!0}),Object.defineProperty(Tn.prototype,"fillStyle",{set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(Tn.prototype,"textBaseline",{set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(Tn.prototype,"textAlign",{set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(Tn.prototype,"strokeStyle",{set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(Tn.prototype,"lineWidth",{set:function(e){},enumerable:!0,configurable:!0}),Tn.prototype.fill=function(){},Tn.prototype.stroke=function(){},Tn.prototype.clearRect=function(){},Tn.prototype.fillRect=function(){},Tn.prototype.strokeRect=function(){},Tn.prototype.beginPath=function(){},Tn.prototype.closePath=function(){},Tn.prototype.moveTo=function(){},Tn.prototype.lineTo=function(){},Tn.prototype.rect=function(){},Tn.prototype.arc=function(){},Tn.prototype.save=function(){},Tn.prototype.restore=function(){},Tn.prototype.clip=function(){},Tn.prototype.translate=function(){},Tn.prototype.rotate=function(){},Tn.prototype.fillText=function(){},Tn.prototype.setLineDash=function(){},Tn.prototype.quadraticCurveTo=function(){},Tn.prototype.bezierCurveTo=function(){},Tn.prototype.drawImage=function(){},Tn.prototype.measureText=function(e){return{width:e.length*Math.ceil(.625*this._fontSize)}},Tn.prototype.getImageData=function(){return{width:0,height:0,data:new Uint8ClampedArray(0)}},Tn);function Tn(){this._fontSize=10}var nl=bi("canvas")||bi("canvas-prebuilt");function ci(){var e=null;return ir?e=document.createElement("canvas"):nl?(e=nl.createCanvas?nl.createCanvas(300,150):new nl(300,150)).style={}:e=new ip,e}function Ga(e,t,n,i){void 0===n&&(n=e.width),void 0===i&&(i=e.height),t.clearRect(0,0,n,i)}function da(e,t,n,i){void 0===i&&(i=""),e.font=i+" "+n+"px "+t}function op(){return null!==Ad(ci(),{})}function Ad(e,t){var n=e.getContext("webgl",t);return(n=n||e.getContext("experimental-webgl",t))||null}function sp(e){return e.pieceId=0,e.shape="",e.x1=0,e.y1=0,e.x2=0,e.y2=0,e.rectWidthOrSourceRadiusScaled=0,e.rectWidthOrSourceRadiusFixed=0,e.rectHeightOrTargetRadiusScaled=0,e.rectHeightOrTargetRadiusFixed=0,e.thicknessOrFontSizeScaled=0,e.thicknessOrFontSizeFixed=0,e.strokeWidthScaled=0,e.strokeWidthFixed=0,e.offsetScaled=0,e.offsetFixed=0,e.pattern.type=0,e.opacity=1,e.fillColor=null,e.strokeColor=null,e.patternColor=null,e.globalMinVisibleSize=0,e.strokeMinVisibleSize=0,e.patternMinVisibleSize=0,e.offsetAngle=0,e.patternScale=0,e.symbolicSize=0,e.curvature=0,e.dashLength=0,e.gapLength=0,e.hasHead=!1,e.hasTail=!1,e.isBodyTriangle=!1,e.isSelfLoop=!1,e.isText=!1,e.adjustTextAngle=!1,e.unusedFlag1=!1,e.unusedFlag2=!1,e.unusedFlag3=!1,e}function up(e,t,n,i){e.width=t*i,e.height=n*i,e.style.width=t+"px",e.style.height=n+"px"}var Cd=(Vn.createInitData=function(){return null},Vn.getName=function(){return null},Vn.isAvailable=function(){return!0},Vn.prototype.getDomElement=function(){return null},Vn.prototype._initCanvas=function(e){e.style.touchAction="none"},Vn.prototype.export=function(e){return Promise.resolve()},Vn.prototype.extractElement=function(e,t){return this._memoryManager.extractGenericElement(e,t,this._scales)},Vn.prototype._compareDimensions=function(e,t,n){return(e!==this._width||t!==this._height||n!==this._pixelRatio)&&(this._width=e,this._height=t,this._pixelRatio=n,!0)},Vn.prototype._compareView=function(e,t,n,i){return(e!==this._viewX||t!==this._viewY||n!==this._viewZoom||i!==this._viewAngle)&&(this._viewX=e,this._viewY=t,this._viewZoom=n,this._viewAngle=i,this._viewAngleCos=Math.cos(i),this._viewAngleSin=Math.sin(i),!0)},Vn.prototype._compareCurrentTime=function(e){return e!==this._currentTime&&(this._currentTime=e,!0)},Vn.prototype._compareBackgroundColor=function(e,t){return(e!==this._backgroundColor||t!==this._renderBackground)&&(this._renderBackground=t,this._backgroundColor=e,this._backgroundRgba=this._colorManager.parseColor(this._backgroundColor),!0)},Vn.prototype._compareShapes=function(){return this._shapesVersion!==this._shapeManager.getVersion()&&(this._shapesVersion=this._shapeManager.getVersion(),!0)},Vn.prototype._comparePatterns=function(){return this._patternsVersion!==this._patternManager.getVersion()&&(this._patternsVersion=this._patternManager.getVersion(),!0)},Vn.prototype._compareBoundaries=function(){return this._boundariesVersion!==this._boundariesManager.getVersion()&&(this._boundariesVersion=this._boundariesManager.getVersion(),!0)},Vn.prototype._compareTexts=function(){return this._textsVersion!==this._textManager.getVersion()&&(this._textsVersion=this._textManager.getVersion(),!0)},Vn.prototype._compareIsDisplayableBuffer=function(e){return this._isBufferDisplayable!==e&&(this._isBufferDisplayable=e,!0)},Vn.prototype._compareHideImages=function(e){return this._hideImages!==e&&(this._hideImages=e,!0)},Vn.prototype.renderFrame=function(e){var t=e.x,n=e.y,i=e.zoom,r=e.angle,o=e.width,a=e.height,s=e.pixelRatio,l=e.backgroundColor,u=e.currentTime,d=e.isBufferDisplayable,c=e.hideImages,h=e.renderBackground,p=this._compareShapes(),g=this._comparePatterns(),m=this._compareBoundaries(),x=this._compareTexts(),v=this._compareDimensions(o,a,s),y=this._compareView(t,n,i,r),b=this._compareCurrentTime(u),S=this._compareBackgroundColor(l,h),w=this._compareIsDisplayableBuffer(d),M=this._compareHideImages(c);if(m){var N=this._boundariesManager,D=this._scales;D.bytesToActualCoord=1,D.bytesToActualScaledSize=N.maxScaledSize/65535,D.bytesToActualMinVisibleSize=N.maxMinVisibleSize/15,D.bytesToActualSymbolicSize=N.maxSymbolicSize/255,D.bytesToActualDashLength=N.maxDashLength/3,D.bytesToActualGapLength=N.maxGapLength/3,D.bytesToActualPatternScale=N.maxPatternScale/255}this._firstFrame&&this._beforeFirstFrame(),this._render({shapesChanged:p,patternsChanged:g,boundariesChanged:m,textsChanged:x,dimensionsChanged:v,viewChanged:y,currentTimeChanged:b,backgroundColorChanged:S,isBufferDisplayableChanged:w,isHideImagesChanged:M}),this._firstFrame&&(this._afterFirstFrame(),this._firstFrame=!1)},Vn.prototype._render=function(e){},Vn.prototype._beforeFirstFrame=function(){},Vn.prototype._afterFirstFrame=function(){},Vn.prototype.destroy=function(){},Vn.prototype.ensureAnimationsReady=function(){},Vn.prototype.getImageData=function(){return null},Vn.prototype.setViewportClipping=function(e){},Vn);function Vn(e){var t=e.bufferList,n=e.patternManager,i=e.boundariesManager,r=e.colorManager,o=e.shapeManager,a=e.textManager,s=e.easingManager,l=e.memoryManager;this._firstFrame=!0,this._width=0,this._height=0,this._pixelRatio=0,this._viewX=0,this._viewY=0,this._viewZoom=0,this._viewAngle=0,this._viewAngleCos=0,this._viewAngleSin=0,this._currentTime=0,this._scales={bytesToActualCoord:0,bytesToActualScaledSize:0,bytesToActualMinVisibleSize:0,bytesToActualSymbolicSize:0,bytesToActualDashLength:0,bytesToActualGapLength:0,bytesToActualPatternScale:0},this._shapesVersion=0,this._patternsVersion=0,this._boundariesVersion=0,this._textsVersion=0,this._backgroundColor=null,this._backgroundRgba=[1,1,1,0],this._renderBackground=!1,this._isBufferDisplayable=null,this._hideImages=!1,this._genericObject={valid:!1,id:void 0,end:{pieceId:0,shape:"circle",x1:0,y1:0,x2:0,y2:0,rectWidthOrSourceRadiusScaled:0,rectWidthOrSourceRadiusFixed:0,rectHeightOrTargetRadiusScaled:0,rectHeightOrTargetRadiusFixed:0,thicknessOrFontSizeScaled:0,thicknessOrFontSizeFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,offsetScaled:0,offsetFixed:0,pattern:{id:void 0,type:0,attributes:{}},opacity:1,fillColor:null,strokeColor:null,patternColor:null,globalMinVisibleSize:0,strokeMinVisibleSize:0,patternMinVisibleSize:0,offsetAngle:0,patternScale:0,symbolicSize:-1,curvature:0,dashLength:0,gapLength:0,hasHead:!1,hasTail:!1,isBodyTriangle:!1,isSelfLoop:!1,isText:!1,adjustTextAngle:!1,unusedFlag1:!1,unusedFlag2:!1,unusedFlag3:!1},start:{pieceId:0,shape:"circle",x1:0,y1:0,x2:0,y2:0,rectWidthOrSourceRadiusScaled:0,rectWidthOrSourceRadiusFixed:0,rectHeightOrTargetRadiusScaled:0,rectHeightOrTargetRadiusFixed:0,thicknessOrFontSizeScaled:0,thicknessOrFontSizeFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,offsetScaled:0,offsetFixed:0,pattern:{id:void 0,type:0,attributes:{}},opacity:1,fillColor:null,strokeColor:null,patternColor:null,globalMinVisibleSize:0,strokeMinVisibleSize:0,patternMinVisibleSize:0,offsetAngle:0,patternScale:0,symbolicSize:-1,curvature:0,dashLength:0,gapLength:0,hasHead:!1,hasTail:!1,isBodyTriangle:!1,isSelfLoop:!1,isText:!1,adjustTextAngle:!1,unusedFlag1:!1,unusedFlag2:!1,unusedFlag3:!1},animation:{duration:0,beginTime:-1,easing:"linear"}},this._littleEndian=fr(),this._bufferList=t,this._shapeManager=o,this._patternManager=n,this._boundariesManager=i,this._textManager=a,this._colorManager=r,this._easingManager=s,this._memoryManager=l}var ca,Ss,Td="#define D3D9_FIX 0\n#define ANIMATED 0\nprecision highp float;\nprecision mediump int;\nattribute /*ushort*/ vec4 a_final_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature;\nattribute /*ushort*/ vec4 a_final_patternId_fillRGBA_strokeRGBA_patternRGBA;\nattribute /*float*/ vec4 a_final_x1_y1_x2_y2;\nattribute /*ushort*/ vec4 a_final_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed;\nattribute /*ushort*/ vec4 a_final_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed;\nattribute /*ushort*/ vec2 a_final_offsetScaled_offsetFixed;\nattribute /*ushort*/ vec4 a_prev_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature;\nattribute /*ushort*/ vec4 a_prev_patternId_fillRGBA_strokeRGBA_patternRGBA;\nattribute /*float*/ vec4 a_prev_x1_y1_x2_y2;\nattribute /*ushort*/ vec4 a_prev_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed;\nattribute /*ushort*/ vec4 a_prev_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed;\nattribute /*ushort*/ vec2 a_prev_offsetScaled_offsetFixed;\nattribute /*float*/ vec2 a_animationBeginTime_animationDuration; \nattribute /*ushort*/ vec4 a_animationEasing; \nattribute /*ushort*/ vec2 a_text_charId_charOffsetXY; \nattribute vec3 a_vertexInfo;\nuniform float u_viewWidth;\nuniform float u_viewHeight;\nuniform float u_viewX;\nuniform float u_viewY;\nuniform float u_viewAngle;\nuniform float u_viewZoom;\nuniform float u_currentTime;\nuniform float u_pixelRatio;\nuniform sampler2D u_patternInfoTexture;\nvarying vec4 a;\nvarying vec4 b;\nvarying vec4 c;\nvarying vec2 d;\nvarying vec2 e;\n#if D3D9_FIX\nvarying vec4 f;\nvarying vec3 g;\nvarying vec4 h;\nvarying vec4 i;\n#else\nvarying float j;\nvarying vec2 k;\nvarying vec2 l;\nvarying vec2 m;\nvarying float n;\nvarying float o;\nvarying vec2 p;\nvarying vec2 q;\nvarying float r;\nvarying float s;\n#endif\nconst float EPSILON = 0.000001;\nconst float INFINITY = 10000000.0;\nconst float PI = 3.14159265359;\nconst float P2_12 = 4096.0;\nconst float P2_8 = 256.0;\nconst float P2_7 = 128.0;\nconst float P2_6 = 64.0;\nconst float P2_5 = 32.0;\nconst float P2_4 = 16.0;\nconst float P2_3 = 8.0;\nconst float P2_2 = 4.0;\nconst float P2_1 = 2.0;\nuniform float BYTES_TO_COORD;\nuniform float BYTES_TO_SCALED_SIZE;\nuniform float BYTES_TO_MIN_VISIBLE_SIZE;\nuniform float BYTES_TO_SYMBOLIC_SIZE;\nuniform float BYTES_TO_CURVATURE;\nuniform float BYTES_TO_DASH_LENGTH;\nuniform float BYTES_TO_GAP_LENGTH;\nuniform float BYTES_TO_PATTERN_SCALE;\nuniform float PATTERN_POSITION_GRANULARITY;\nuniform float PATTERN_INFO_TEXTURE_SIZE;\nuniform float PATTERN_NEAREST_TEXTURE_SIZE;\nuniform float PATTERN_LINEAR_TEXTURE_SIZE;\nuniform float PATTERN_LINEAR_SDF_TEXTURE_SIZE;\nuniform float PATTERN_MIPMAP_TEXTURE_SIZE;\nconst float BYTES_TO_OFFSET_ANGLE = 0.0;\nconst float BYTES_TO_COLOR = 0.0;\nconst float SDF_FONT_SIZE = 0.0;\nconst float CURVATURE_RATIO = 0.0;\nconst float PATTERN_MARGIN = 0.0;\nconst float TEXT_WIDTH_MULTIPLIER = 0.0;\nconst float TEXT_HEIGHT_MULTIPLIER = 0.0;\nconst float SELF_LOOP_CURVATURE_MULTIPLIER = 0.0;\nconst float EDGE_ARROW_SIZE_RATIO = 0.0;\nconst float NB_PIECES_PER_CURVE = 0.0;\nconst float PIECE_NODE_COMPONENT = 0.0;\nconst float PIECE_EDGE_BODY = 0.0;\nconst float PIECE_EDGE_HEAD = 0.0;\nconst float PIECE_EDGE_TAIL = 0.0;\nconst float PIECE_EDGE_TEXT = 0.0;\nconst float MAX_TEXT_SIZE = 0.0;\nconst float BYTES_TO_TEXT_OFFSET = 0.0;\nconst float FILTER_NEAREST = 0.0;\nconst float FILTER_LINEAR = 0.0;\nconst float FILTER_LINEAR_SDF = 0.0;\nconst float FILTER_MIPMAP = 0.0;\nconst float SHAPE_TEXTURE_SIZE = 0.0;\nconst float SIMPLE_SHAPE_SAMPLING_SIZE = 0.0;\nconst float COMPLEX_SHAPE_SAMPLING_SIZE = 0.0;\nconst float SHAPE_SAMPLING_BUFFER_RATIO = 0.0;\nconst float MAX_NB_SHAPES = 0.0;\nconst float FIRST_COMPLEX_SHAPE_ID = 0.0;\nconst float SELF_LOOP_TO_CIRCLE_APPROX = 0.0;\nconst float NB_SHAPES_BY_SIDE = SHAPE_TEXTURE_SIZE / COMPLEX_SHAPE_SAMPLING_SIZE;\nconst float SHAPE_FILL_PERCENT = 1.0 - SHAPE_SAMPLING_BUFFER_RATIO;\nconst float T_STEP_PER_CURVE_PIECE = 1.0 / NB_PIECES_PER_CURVE;\nconst float HEAD_TAIL_PX_ADJUST = 1.5;\nstruct ne {\nfloat nf;\nfloat ng;\nfloat nh;\nfloat ni;\nfloat nj;\nfloat nk;\nfloat nl;\nfloat nm;\n};\nstruct nn {\nfloat no;\nfloat np;\nfloat nq;\nfloat nr;\nfloat ns;\nfloat nt;\nfloat nu;\n};\nstruct nv {\nfloat nf;\nfloat ng;\nfloat nh;\nfloat ni;\nfloat nj;\nfloat nk;\nfloat nl;\nfloat nm;\nfloat no;\nfloat np;\nfloat nq;\nfloat nr;\nfloat ns;\nfloat nt;\nfloat nu;\nfloat bu;\nfloat nw;\nfloat nx;\nfloat ny;\nfloat nz;\nfloat oa;\nfloat ob;\nvec4 az;\nvec4 ba;\nvec4 bl;\nfloat oc;\nfloat od;\nfloat oe;\nfloat of;\nfloat og;\nfloat oh;\nfloat oi;\nfloat oj;\nfloat ok;\nfloat ol;\nfloat om;\nfloat on;\nfloat oo;\nfloat op;\nfloat oq;\nfloat or;\nfloat os;\n};\nstruct ot {\nfloat ou;\nvec2 ov;\nvec4 az;\nvec4 ba;\nfloat bu;\nfloat ow;\nfloat ox;\nfloat nh;\nfloat oy;\nvec2 oz;\nfloat pa;\nvec2 bb;\nvec2 pb;\nvec2 pc;\nfloat pd;\nfloat pe;\nvec4 bl;\nvec2 pf;\nfloat pg;\nfloat ph;\nvec2 pi;\nvec2 pj;\nvec2 pk;\n};\nfloat pl(float lh, float pm, float pn) {\nfloat po = mod(lh, pow(2.0, pn));\nreturn floor(po / pow(2.0, pm));\n}\nne pp(float lh) {\nne pq;\npq.nf = pl(lh, 0.0, 4.0);\npq.ng = pl(lh, 4.0, 8.0);\npq.nh = pl(lh, 8.0, 10.0);\npq.ni = pl(lh, 10.0, 12.0);\npq.nj = pl(lh, 12.0, 13.0);\npq.nk = pl(lh, 13.0, 14.0);\npq.nl = pl(lh, 14.0, 15.0);\npq.nm = pl(lh, 15.0, 16.0);\nreturn pq;\n}\nnn pr(float lh) {\nnn pq;\npq.no = pl(lh, 0.0, 8.0);\npq.np = pl(lh, 8.0, 11.0);\npq.nq = pl(lh, 11.0, 12.0);\npq.nr = pl(lh, 12.0, 13.0);\npq.ns = pl(lh, 13.0, 14.0);\npq.nt = pl(lh, 14.0, 15.0);\npq.nu = pl(lh, 15.0, 16.0);\nreturn pq;\n}\nvec4 ps(in float lh) {\nreturn vec4(\npl(lh, 0.0, 4.0),\npl(lh, 4.0, 8.0),\npl(lh, 8.0, 12.0),\npl(lh, 12.0, 16.0)\n);\n}\nvec2 pt(in float lh) {\nreturn vec2(mod(lh, 256.0), floor(lh / 256.0));\n}\nvec2 pu(in float lh) {\nfloat pv = floor(lh / P2_6);\nfloat pw = lh - (pv * P2_6);\nreturn vec2(pv, pw);\n}\nvec2 px(in float lh) {\nfloat py = floor(lh / P2_7);\nfloat pz = lh - (py * P2_7);\nreturn vec2(py, pz);\n}\nvec2 qa(in vec2 qb, in float qc) {\nfloat qd = cos(qc);\nfloat qe = sin(qc);\nreturn vec2(qd * qb.x + qe * qb.y, -qe * qb.x + qd * qb.y);\n}\nvec4 qf(in vec4 qg) {\nreturn floor(qg / 256.0) - 128.0;\n}\nvec4 qh(in vec4 qg) {\nreturn mod(qg, 256.0) - 128.0;\n}\nfloat qi(float lh) {\nreturn lh - 128.0;\n}\nvec2 qi(vec2 lh) {\nreturn lh - 128.0;\n}\nvec2 qj(vec2 qk) {\nreturn vec2(-qk.y, qk.x);\n}\nvec2 ql(vec2 qm, vec2 fn, vec2 qn, float t) {\nfloat qo = 1.0 - t;\nreturn (qo * qo * qm) + (2.0 * qo * t * fn) + (t * t * qn);\n}\nvec2 qp(vec2 qm, vec2 qq, vec2 qr, vec2 qn, float t) {\nfloat qo = 1.0 - t;\nfloat qs = qo * qo;\nfloat qt = qs * qo;\nfloat qu = t * t;\nfloat qv = qu * t;\nreturn (qt * qm) + (3.0 * qs * t * qq) + (3.0 * qo * qu * qr) + (qv * qn);\n}\nvec2 qw(vec2 qm, vec2 fn, vec2 qn, float t) {\nfloat qo = (1.0 - t);\nvec2 qb = (qo * fn + t * qn) - (qo * qm + t * fn);\nreturn normalize(qb);\n}\nvec2 qx(vec2 qm, vec2 fn, vec2 qn, float t) {\nreturn qj(qw(qm, fn, qn, t));\n}\nvec2 qy(vec2 qm, vec2 qq, vec2 qr, vec2 qn, float t) {\nfloat qo = 1.0 - t;\nfloat qs = qo * qo;\nfloat qu = t * t;\nvec2 qb = qs * (qq - qm) + 2.0 * qo * t * (qr - qq) + qu * (qn - qr);\nreturn normalize(qb);\n}\nvec2 qz(vec2 qm, vec2 qq, vec2 qr, vec2 qn, float t) {\nreturn qj(qy(qm, qq, qr, qn, t));\n}\nfloat rk(float oa, float rl, float t) {\nfloat y = abs(oa) / CURVATURE_RATIO + EPSILON;\nfloat of = y * y;\nfloat qo = t - 0.5;\nfloat qs = qo * qo;\nfloat rm = 1.0 / (16.0 * of);\nfloat rn = sqrt(qs + rm);\nfloat ro = (0.5 / y) * sqrt(of + 0.25);\nfloat rp = (abs(2.0 * y)) * ((qo * rn) + (0.5 * ro) + (rm * log(abs((qo + rn) / (-0.5 + ro)))));\nreturn rp * rl;\n}\nfloat rq(vec2 qm, vec2 rr, vec2 rs, vec2 qn, float rt) {\nvec2 pf = (qm + rr + rs) / 3.0;\nvec2 ru = pf - rr;\nvec2 rv = rr - rs;\nfloat rw = dot(ru, ru);\nfloat rx = dot(rv, rv) / 4.0;\nfloat sf = sqrt(rw - rx) * SELF_LOOP_TO_CIRCLE_APPROX * 1.55;\nreturn 2.0 * PI * sf * rt;\n}\nfloat sg(float lh) {\nreturn lh - 32.0;\n}\nfloat sh(float lh) {\nreturn lh - 512.0;\n}\nfloat si(float lh) {\nreturn lh - 32768.0;\n}\nvoid sj() {\ngl_Position = vec4(-10.0, -10.0, 1.0, 1.0);\n}\nvec4 sk(vec2 sl) {\nreturn vec4(((vec2(sl.x, u_viewHeight - sl.y) / vec2(u_viewWidth, u_viewHeight)) * 2.0 - 1.0), 0.5, 1.0);\n}\nfloat sp(float ap, float aq) {\nreturn step(ap - EPSILON, aq) * step(aq, ap + EPSILON);\n}\nbool ao(float ap, float aq) {\nreturn abs(ap - aq) < EPSILON;\n}\nbool sq(float lh) {\nreturn lh > 0.5;\n}\nvec2 sr(vec2 ss) {\nreturn qa((ss - vec2(u_viewX, u_viewY)) * u_viewZoom, u_viewAngle) + vec2(u_viewWidth, u_viewHeight) / 2.0;\n}\nfloat st(float ph) {\nreturn ph * EDGE_ARROW_SIZE_RATIO;\n}\nfloat su(float sv, float sw) {\nreturn sv * BYTES_TO_SCALED_SIZE * u_viewZoom + sw;\n}\nfloat tc(float ow, float ta, float tb) {\nfloat td = tb - ta;\nfloat a = 1.0 / td;\nfloat b = -ta / td;\nreturn ow * a + b;\n}\nstruct te {\nvec2 tf;\nvec2 tg;\n};\nte th(vec2 ti, float sf, float oa) {\nte lj;\nfloat tj = (sf + sf / SELF_LOOP_CURVATURE_MULTIPLIER * oa) * SELF_LOOP_CURVATURE_MULTIPLIER;\nfloat tk = -u_viewAngle + PI;\nfloat tl = -u_viewAngle + PI / 2.0;\nlj.tf = ti + vec2(cos(tk), sin(tk)) * tj;\nlj.tg = ti + vec2(cos(tl), sin(tl)) * tj;\nreturn lj;\n}\nfloat tq(vec2 tr, vec2 rr, vec2 rs, vec2 ts, float tt) {\nvec2 tu = tr;\nfloat t = 0.0;\nfloat tv = 0.0;\nfloat tw = rq(tr, rr, rs, ts, 1.0);\nreturn tt / tw;\n}\nnv tx(\nvec4 ty,\nvec4 tz,\nvec4 ua,\nvec4 ub,\nvec4 uc,\nvec2 ud,\nvec2 ue\n) {\nnv a;\nne av = pp(ty.x);\nnn uf = pr(ty.y);\nvec4 ug = ps(ty.z);\nvec2 uh = pt(ty.w);\nvec2 ui = pu(ue.y);\na.nf = av.nf;\na.ng = av.ng;\na.nh = av.nh;\na.ni = av.ni;\na.nj = av.nj;\na.nk = av.nk;\na.nl = av.nl;\na.nm = av.nm;\na.no = uf.no;\na.np = uf.np;\na.nq = uf.nq;\na.nr = uf.nr;\na.ns = uf.ns;\na.nt = uf.nt;\na.nu = uf.nu;\na.bu = ug.x;\na.nw = ug.y;\na.nx = ug.z;\na.ny = ug.w;\na.nz = uh.x;\na.oa = uh.y;\na.ob = tz.x;\na.az = ps(tz.y);\na.ba = ps(tz.z);\na.bl = ps(tz.w);\na.oc = ua.x;\na.od = ua.y;\na.oe = ua.z;\na.of = ua.w;\na.og = ub.x;\na.oh = ub.y;\na.oi = ub.z;\na.oj = ub.w;\na.ok = uc.x;\na.ol = uc.y;\na.om = uc.z;\na.on = uc.w;\na.oo = ud.x;\na.op = ud.y;\na.oq = ue.x;\na.or = sh(ui.x);\na.os = sg(ui.y);\nreturn a;\n}\nbool uu(const in nv a, out ot lj) {\nfloat nf = a.nf;\nfloat ng = a.ng;\nfloat nh = a.nh * BYTES_TO_DASH_LENGTH;\nfloat ni = a.ni * BYTES_TO_GAP_LENGTH;\nfloat nj = a.nj;\nfloat nk = a.nk;\nfloat nl = a.nl;\nfloat nm = a.nm;\nfloat no = a.no * BYTES_TO_PATTERN_SCALE;\nfloat np = a.np * BYTES_TO_OFFSET_ANGLE;\nfloat nq = a.nq;\nfloat nr = a.nr;\nfloat ns = a.ns;\nfloat nt = a.nt;\nfloat nu = a.nu;\nfloat bu = a.bu * BYTES_TO_COLOR;\nfloat nw = a.nw * BYTES_TO_MIN_VISIBLE_SIZE - EPSILON;\nfloat nx = a.nx * BYTES_TO_MIN_VISIBLE_SIZE - EPSILON;\nfloat ny = a.ny * BYTES_TO_MIN_VISIBLE_SIZE - EPSILON;\nfloat nz = a.nz * BYTES_TO_SYMBOLIC_SIZE * u_viewZoom + step(a.nz, EPSILON) * INFINITY;\nfloat oa = qi(a.oa);\nfloat ob = a.ob;\nvec4 az = a.az * BYTES_TO_COLOR;\nvec4 ba = a.ba * BYTES_TO_COLOR;\nvec4 bl = a.bl * BYTES_TO_COLOR;\nvec2 uv = vec2(a.oc, a.od) * BYTES_TO_COORD;\nvec2 uw = vec2(a.oe, a.of) * BYTES_TO_COORD;\nvec2 tr = sr(uv);\nvec2 ts = sr(uw);\nfloat ux = su(a.og, a.oh);\nfloat uy = su(a.oi, a.oj);\nfloat uz = su(a.ok, a.ol);\nfloat ou = su(a.om, a.on);\nfloat va = su(a.oo, a.op);\nvec2 vb = a_vertexInfo.xy;\nvec2 vc = vec2(0.0, 0.0);\nfloat vd = ux;\nfloat ve = uy;\nfloat vf = uy * no;\nif (nq > EPSILON) {\nif (a.oq < EPSILON) {\nreturn false;\n}\nvf = uz;\nob = a.oq;\nux = vf * TEXT_WIDTH_MULTIPLIER * u_pixelRatio;\nuy = vf * TEXT_HEIGHT_MULTIPLIER * u_pixelRatio;\n}\nbool vz = abs(oa) > EPSILON && sp(ng, PIECE_EDGE_BODY) < EPSILON;\nbool wa = vz && a_vertexInfo.z > EPSILON;\nif (nf < EPSILON || ng < EPSILON || nz < nw || wa) {\nreturn false;\n}\nou *= step(nx, nz);\nfloat wo = 0.0;\nfloat wp = 1.0;\nfloat wl = 0.0;\nfloat wn = 1.0;\nfloat wq = 0.0;\nfloat xa = 1.0;\nfloat xc = 1.0;\nfloat xn = 0.0;\nfloat xo = 0.0;\nvec2 pf;\nvec2 pi;\nvec2 pj;\nvec2 pk;\nfloat ph;\nfloat pg;\nfloat yh = 0.0;\nfloat yi = 1.0;\nif (sp(ng, PIECE_NODE_COMPONENT) > EPSILON) {\npf = ceil((tr + ts) / 2.0);\npi = normalize(vec2(uw.x - uv.x + 0.001, uv.y - uw.y));\npj = qj(pi);\npk = pj;\nph = ux;\npg = uy;\n} else {\nxc = 0.0;\nfloat yy = distance(tr, ts);\nvec2 yz = normalize(ts - tr);\nvec2 za = (tr + ts) / 2.0;\nvec2 zb = qj(yz);\nvec2 zc = za + (zb * yy * -oa / CURVATURE_RATIO);\nif (sp(ng, PIECE_EDGE_TEXT) > 0.0) {\nfloat zd;\nfloat ze = ou;\nou = 0.0;\nif (nm > EPSILON) {\nte fn = th(tr, ze / 2.0, oa);\npf = qp(tr, fn.tf, fn.tg, ts, 0.5);\npi = qy(tr, fn.tf, fn.tg, ts, 0.5);\npj = qj(pi);\npk = pj;\nzd = rq(tr, fn.tf, fn.tg, ts, 0.5);\n} else if (abs(oa) > EPSILON) {\npf = ql(tr, zc, ts, 0.5);\npi = qw(tr, zc, ts, 0.5);\npj = qj(pi);\npk = pj;\nzd = rk(oa, yy, 1.0);\n} else {\npf = za;\npi = yz;\npj = zb;\npk = zb;\nzd = yy;\n}\nph = ux;\npg = uy;\nif (nr > EPSILON && nm < EPSILON && vd > zd - ze) {\npi = vec2(1.0, 0.0);\npj = vec2(0.0, 1.0);\npk = vec2(0.0, 1.0);\n} else {\nfloat qc = -atan(pi.y, pi.x);\nyh = qc;\nnp -= qc;\nif ((qc > PI / 2.0 || qc < -PI / 2.0)) {\nnp += (1.0 - nm) * PI;\nyi = -1.0;\npi *= -1.0;\npj *= -1.0;\npk *= -1.0;\n}\n}\n} else {\nfloat xg = uz;\nfloat zm = ux;\nfloat zn = uy;\nfloat zo = nj + nk;\nfloat zp = st(xg);\nfloat zq = nj * zp;\nfloat zr = nk * zp;\nfloat zs = sp(ng, PIECE_EDGE_HEAD);\nfloat zt = sp(ng, PIECE_EDGE_TAIL);\nfloat zu = INFINITY * nm + yy - zm - zn;\nfloat zv = min(zu / zo, zp);\nfloat aae =\nnk * (zp + max(zm + zv - zr, 0.0))\n+ (1.0 - nk) * nl * zm;\nfloat aaf =\nnj * (zp + max(zn + zv - zq, 0.0))\n+ (1.0 - nj) * nl * zn;\nif (zs > EPSILON || zt > EPSILON) {\nvec2 aai = zs * ts + zt * tr;\nfloat va = zs * aaf + zt * aae + (HEAD_TAIL_PX_ADJUST - 0.5);\nfloat aaj = zs * zq + zt * zr;\nvec2 aak;\nif (nm > EPSILON) {\nte fn = th(tr, zm, oa);\nfloat zd = rq(tr, fn.tf, fn.tg, ts, 1.0);\nfloat tt = zs * (zd - aaf) + zt * aae;\nfloat t = tq(tr, fn.tf, fn.tg, ts, tt);\naak = qp(tr, fn.tf, fn.tg, ts, t);\n} else {\nfloat zd = rk(oa, yy, 1.0);\nfloat t = (zs * (zd - aaf) + zt * aae) / zd;\naak = ql(tr, zc, ts, t);\n}\npi = normalize(aai - aak);\npj = qj(pi);\npk = pj;\npf = aai - pi * (va - aaj / 2.0);\nph = aaj;\npg = aaj;\nnh = 0.0;\nni = 0.0;\n} else {\nfloat aao;\nfloat aap;\nfloat aaq;\nif (abs(oa) < EPSILON) {\npf = za;\npi = yz;\npj = zb;\npk = pj;\nph = yy;\naao = yy;\naap = 0.0;\naaq = yy;\n} else {\nfloat aas = a_vertexInfo.z;\nfloat aat = aas * T_STEP_PER_CURVE_PIECE;\nfloat qu = aat + T_STEP_PER_CURVE_PIECE;\nif (nm < EPSILON) {\nvec2 aau = ql(tr, zc, ts, aat);\nvec2 aav = ql(tr, zc, ts, qu);\npf = (aau + aav) / 2.0;\npi = normalize(aav - aau);\npj = qx(tr, zc, ts, aat);\npk = qx(tr, zc, ts, qu);\nph = distance(aau, aav);\naao = rk(oa, yy, 1.0);\naap = rk(oa, yy, aat);\naaq = rk(oa, yy, qu);\n} else {\nte fn = th(tr, zm, oa);\nvec2 rr = fn.tf;\nvec2 rs = fn.tg;\nvec2 aau = qp(tr, rr, rs, ts, aat);\nvec2 aav = qp(tr, rr, rs, ts, qu);\npf = (aau + aav) / 2.0;\npi = normalize(aav - aau);\npj = qz(tr, rr, rs, ts, aat);\npk = qz(tr, rr, rs, ts, qu);\nph = distance(aau, aav);\naao = rq(tr, rr, rs, ts, 1.0);\naap = rq(tr, rr, rs, ts, aat);\naaq = rq(tr, rr, rs, ts, qu);\n}\n}\npg = uz;\nwl = (aae - 1.0) / aao;\nwn = 1.0 - (aaf - HEAD_TAIL_PX_ADJUST) / aao;\nwo = aap / aao;\nwp = aaq / aao;\nwq = aao;\nif (nl > 0.0 && zu > 5.0) {\nfloat abb = (aao * pg) / (aao - aae);\nfloat tw = aao;\nfloat oc = aae;\nfloat oe = aao - aaf;\nfloat a = -abb / tw;\nfloat b = abb;\nfloat od = a * oc + b;\nfloat of = a * oe + b;\nfloat abc = od / (oc - oe);\nfloat abd = -abc * oe;\npg = abd;\nxo = abc * tw + abd + 1.0;\n}\n}\n}\n}\nvec2 bb = vec2(0.0, 0.0);\nvec2 pb = vec2(EPSILON, EPSILON);\nvec2 pc = vec2(-EPSILON, -EPSILON);\nfloat pd = -1.0;\nfloat pe = 0.0;\nbool abe = false;\nif (ob > EPSILON && nz > ny) {\nfloat abf = floor(ob / PATTERN_INFO_TEXTURE_SIZE);\nfloat abg = ob - (abf * PATTERN_INFO_TEXTURE_SIZE);\nvec4 abh = texture2D(u_patternInfoTexture, vec2(abg, abf) / 255.0) * 255.0;\nvec2 abi = px(abh.z);\nvec2 abj = px(abh.w);\npd = abi.x * 2.0 + abj.x;\nfloat abk = 0.0;\nif (ao(pd, FILTER_NEAREST)) {\nabk = PATTERN_NEAREST_TEXTURE_SIZE;\n} else if (ao(pd, FILTER_LINEAR)) {\nabk = PATTERN_LINEAR_TEXTURE_SIZE;\n} else if (ao(pd, FILTER_LINEAR_SDF)) {\nabk = PATTERN_LINEAR_SDF_TEXTURE_SIZE;\nabe = true;\n} else if (ao(pd, FILTER_MIPMAP)) {\nabk = PATTERN_MIPMAP_TEXTURE_SIZE;\n}\nfloat abl = 1.0 / abk;\nvec2 abm = (vec2(abi.y, abj.y) * PATTERN_POSITION_GRANULARITY) * abl / 2.0;\nvec2 abn = (abh.xy * PATTERN_POSITION_GRANULARITY * abl) + abm;\nabn += PATTERN_MARGIN * abl;\nabm -= PATTERN_MARGIN * abl * 2.0;\nvec2 abo = vec2(ph / 2.0, pg / 2.0) * abl;\nvec2 abp = vec2(ou, ou) * abl;\nfloat abq = 1.0 * u_pixelRatio;\nif (no > EPSILON) {\nif (abe) {\npe = 2.0 / vf;\nabq = SDF_FONT_SIZE / vf;\n} else {\nabq = (abm.y / abo.y) / no;\n}\n}\nvec2 abr = (abo + abp) * abq;\nabm += PATTERN_MARGIN * abl;\nbb = abn + abr * vb;\npb = abn - abm;\npc = abn + abm;\n}\nif (nq > EPSILON) {\nvc.y = a.os * vf / 2.0 - 1.0;\nxa = 0.0;\nxc = 0.0;\nif (abe) {\nvc.x = ceil(a.or * BYTES_TO_TEXT_OFFSET * vf);\n} else {\nvc.x = floor(a.or);\n}\nvc += vec2(1.0, 1.0);\nvc = qa(vc, yh);\nvc *= yi;\n}\nvec2 abu = vec2(cos(np), sin(np)) * va;\nvec2 abv = pf + abu + vc;\nif (nq > EPSILON && sp(ng, PIECE_NODE_COMPONENT) > EPSILON) {\nabv = ceil(abv);\n}\nfloat abw = ou * 2.0;\nfloat abx = ph + xc * (abw + 1.0);\nfloat aby = pg + xa * (abw + 1.0);\nvec2 abz = pi * abx / 2.0;\nvec2 aca = pj * aby / 2.0;\nvec2 acb = pk * aby / 2.0;\nfloat acc = (wp - wo);\nfloat acd = vb.x / 2.0 + 0.5;\nfloat ow = wo + acc * acd;\nfloat pa = xn + (xo - xn) * ow / 2.0;\nfloat ace = step(nf, FIRST_COMPLEX_SHAPE_ID - EPSILON);\nfloat acf = ace * SIMPLE_SHAPE_SAMPLING_SIZE + (1.0 - ace) * COMPLEX_SHAPE_SAMPLING_SIZE;\nfloat acg = acf / COMPLEX_SHAPE_SAMPLING_SIZE;\nfloat ach = acg * SHAPE_SAMPLING_BUFFER_RATIO / 2.0;\nfloat aci = acg * (1.0 - SHAPE_SAMPLING_BUFFER_RATIO);\nvec2 acr = vec2(mod(nf, NB_SHAPES_BY_SIDE), floor(nf / NB_SHAPES_BY_SIDE));\nvec2 acs = acr + vec2(ach) + vec2(wo * aci, 0.0);\nvec2 acv = vec2(acc, 1.0) * aci;\nvec2 ov = (acs + acv * (vb / 2.0 + 0.5)) / NB_SHAPES_BY_SIDE;\nvec2 oz = vec2(abx / acc, aby) / 2.0;\nfloat adc = nh * uz;\nfloat add = ni * uz;\nfloat ox = adc + add;\nfloat oy = (ow * wq) / ox;\nlj.ov = ov;\nlj.oz = oz;\nlj.ou = ou;\nlj.az = az;\nlj.ba = ba;\nlj.bu = bu;\nlj.ow = tc(ow, wl, wn);\nlj.ox = ox;\nlj.nh = adc;\nlj.oy = oy;\nlj.pa = pa;\nlj.bb = bb;\nlj.pb = pb;\nlj.pc = pc;\nlj.pd = pd;\nlj.pe = pe;\nlj.bl = bl;\nlj.pf = abv;\nlj.ph = abx;\nlj.pg = aby;\nlj.pi = pi;\nlj.pj = pj;\nlj.pk = pk;\nreturn true;\n}\nfloat ade(float adf, float adg, vec4 adh) {\nfloat adi = clamp(((u_currentTime - adf) / adg), 0.0, 1.0);\nfloat r = adi;\nfloat adj = r * r;\nfloat adk = adj * r;\nvec4 adl = adi < 0.5 ? qf(adh) : qh(adh);\nfloat adm = adl.x;\nfloat adn = adl.y;\nfloat ado = adl.z;\nfloat adp = adl.w;\nfloat adq = adm + adn * r + ado * adj + adp * adk;\nreturn adq;\n}\nvoid main() {\nnv a_final = tx(\na_final_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature,\na_final_patternId_fillRGBA_strokeRGBA_patternRGBA,\na_final_x1_y1_x2_y2,\na_final_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed,\na_final_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed,\na_final_offsetScaled_offsetFixed,\na_text_charId_charOffsetXY\n);\n#if ANIMATED\nfloat adf = a_animationBeginTime_animationDuration.x;\nfloat adg = a_animationBeginTime_animationDuration.y;\nvec4 adh = a_animationEasing;\nfloat ut = ade(adf, adg, adh);\nnv a_prev = tx(\na_prev_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature,\na_prev_patternId_fillRGBA_strokeRGBA_patternRGBA,\na_prev_x1_y1_x2_y2,\na_prev_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed,\na_prev_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed,\na_prev_offsetScaled_offsetFixed,\na_text_charId_charOffsetXY\n);\nconst float ONE = 1.0;\na_final.nf = mix(a_prev.nf, a_final.nf, ONE);\na_final.nh = mix(a_prev.nh, a_final.nh, ut);\na_final.ni = mix(a_prev.ni, a_final.ni, ut);\na_final.nj = mix(a_prev.nj, a_final.nj, ONE);\na_final.nk = mix(a_prev.nk, a_final.nk, ONE);\na_final.ng = mix(a_prev.ng, a_final.ng, ONE);\na_final.no = mix(a_prev.no, a_final.no, ONE);\na_final.nq = mix(a_prev.nq, a_final.nq, ONE);\na_final.nr = mix(a_prev.nr, a_final.nr, ONE);\na_final.ns = mix(a_prev.ns, a_final.ns, ONE);\na_final.nt = mix(a_prev.nt, a_final.nt, ONE);\na_final.nm = mix(a_prev.nm, a_final.nm, ONE);\na_final.np = mix(a_prev.np, a_final.np, ut);\na_final.bu = mix(a_prev.bu, a_final.bu, ut);\na_final.nw = mix(a_prev.nw, a_final.nw, ut);\na_final.nx = mix(a_prev.nx, a_final.nx, ut);\na_final.ny = mix(a_prev.ny, a_final.ny, ut);\na_final.nz = mix(a_prev.nz, a_final.nz, ut);\na_final.oa = mix(a_prev.oa, a_final.oa, ut);\na_final.ob = mix(a_prev.ob, a_final.ob, ONE);\na_final.az = mix(a_prev.az, a_final.az, ut);\na_final.ba = mix(a_prev.ba, a_final.ba, ut);\na_final.bl = mix(a_prev.bl, a_final.bl, ut);\na_final.oc = mix(a_prev.oc, a_final.oc, ut);\na_final.od = mix(a_prev.od, a_final.od, ut);\na_final.oe = mix(a_prev.oe, a_final.oe, ut);\na_final.of = mix(a_prev.of, a_final.of, ut);\na_final.og = mix(a_prev.og, a_final.og, ut);\na_final.oh = mix(a_prev.oh, a_final.oh, ut);\na_final.oi = mix(a_prev.oi, a_final.oi, ut);\na_final.oj = mix(a_prev.oj, a_final.oj, ut);\na_final.ok = mix(a_prev.ok, a_final.ok, ut);\na_final.ol = mix(a_prev.ol, a_final.ol, ut);\na_final.om = mix(a_prev.om, a_final.om, ut);\na_final.on = mix(a_prev.on, a_final.on, ut);\na_final.oo = mix(a_prev.oo, a_final.oo, ut);\na_final.op = mix(a_prev.op, a_final.op, ut);\na_final.oq = mix(a_prev.oq, a_final.oq, ONE);\na_final.or = mix(a_prev.or, a_final.or, ONE);\na_final.os = mix(a_prev.os, a_final.os, ONE);\n#endif\not lj;\nbool adr = uu(a_final, lj);\nif (!adr) {\nsj();\nreturn;\n}\nvec2 vb = a_vertexInfo.xy;\na = lj.az;\nb = lj.ba;\nc = lj.bl;\nd = lj.ov;\ne = lj.bb;\n#if D3D9_FIX\nf = vec4(lj.pb, lj.pc);\ng = vec3(lj.ou, lj.bu, lj.pa);\nh = vec4(lj.ow, lj.ox, lj.nh, lj.oy);\ni = vec4(lj.oz, lj.pe, lj.pd);\n#else\nj = lj.ou;\nk = lj.pb;\nl = lj.pc;\nm = vec2(lj.bu, lj.pa);\nn = lj.ow;\no = lj.ox;\np = vec2(lj.nh, lj.oy);\nq = lj.oz;\nr = lj.pe;\ns = lj.pd;\n#endif\nfloat ads = step(vb.x, 0.0);\nfloat adt = 1.0 - ads;\nvec2 sl = lj.pf\n+ (lj.pi * (lj.ph / 2.0) * vb.x)\n+ ((ads * lj.pj + adt * lj.pk) * (lj.pg / 2.0) * vb.y);\ngl_Position = sk(sl);\n}\n",Md="#define D3D9_FIX 0\nprecision highp float;\nprecision mediump int;\nuniform vec3 u_backgroundColor;\nuniform sampler2D u_patternNearestTexture;\nuniform sampler2D u_patternLinearTexture;\nuniform sampler2D u_patternLinearSdfTexture;\nuniform sampler2D u_patternMipmapTexture;\nuniform sampler2D u_shapeTexture;\nvarying vec4 a;\nvarying vec4 b;\nvarying vec4 c;\nvarying vec2 d;\nvarying vec2 e;\n#if D3D9_FIX\nvarying vec4 f;\nvarying vec3 g;\nvarying vec4 h;\nvarying vec4 i;\n#else\nvarying float j;\nvarying vec2 k;\nvarying vec2 l;\nvarying vec2 m;\nvarying float n;\nvarying float o;\nvarying vec2 p;\nvarying vec2 q;\nvarying float r;\nvarying float s;\n#endif\nconst float FILTER_NEAREST = 0.0;\nconst float FILTER_LINEAR = 0.0;\nconst float FILTER_LINEAR_SDF = 0.0;\nconst float FILTER_MIPMAP = 0.0;\nconst float EPSILON = 0.000000001;\nconst float SDF_BUFFER = (256.0 - 64.0) / 256.0; \nvec4 ad(in vec4 ae, in vec4 af) {\nfloat ag = af.a;\nfloat ah = ae.a + EPSILON;\nfloat ai = min(ag + ah, 1.0);\nfloat r = ag / ai;\nreturn vec4(mix(ae.rgb, af.rgb, r), ai);\n}\nfloat aj(in float ak, in float al) {\nfloat am = (ak * 256.0 + al) * 256.0;\nfloat an = am / 32768.0;\nreturn an * 2.0 - 1.0;\n}\nbool ao(float ap, float aq) {\nreturn abs(ap - aq) < EPSILON;\n}\nvoid main() {\n#if D3D9_FIX\nfloat j = g.x;\nfloat ar = g.y;\nfloat as = g.z;\nvec2 k = f.xy;\nvec2 l = f.zw;\nfloat n = h.x;\nfloat o = h.y;\nfloat at = h.z;\nfloat au = h.w;\nvec2 q = i.xy;\nfloat r = i.z;\nfloat s = i.w;\n#else\nfloat ar = m.x;\nfloat as = m.y;\nfloat at = p.x;\nfloat au = p.y;\n#endif\nvec4 av = texture2D(u_shapeTexture, d);\nfloat aw = aj(av.b, av.a) * q.x;\nfloat ax = aj(av.r, av.g) * q.y;\nax += as;\nfloat ay = min(aw, ax);\nvec4 az = a;\nvec4 ba = b;\nif (s > -EPSILON) {\nvec2 bb = e;\nfloat bj =\nstep(k.x, bb.x) *\nstep(bb.x, l.x) *\nstep(k.y, bb.y) *\nstep(bb.y, l.y);\nfloat bk = bj;\nvec4 bl;\nif (ao(s, FILTER_NEAREST)) {\nbl = texture2D(u_patternNearestTexture, bb);\n} else if (ao(s, FILTER_LINEAR)) {\nbl = texture2D(u_patternLinearTexture, bb);\n} else if (ao(s, FILTER_LINEAR_SDF)) {\nbl = texture2D(u_patternLinearSdfTexture, bb);\nbl.a = smoothstep(SDF_BUFFER - r, SDF_BUFFER + r, bl.a);\n} else if (ao(s, FILTER_MIPMAP)) {\nbl = texture2D(u_patternMipmapTexture, bb);\n}\nbl.rgb += c.rgb;\nbl.a *= bk;\naz = ad(az, bl);\n}\nfloat bm = clamp(ay, 0.0, 1.0);\nfloat bn = clamp(ay - j, 0.0, 1.0);\nfloat bo = bm - bn;\nbo = 1.0 - clamp(ay - j, 0.0, 1.0);\naz.a *= bn;\nba.a *= bo;\nvec4 bp = ad(az, ba);\nfloat bq = bm;\nbp.rgb = mix(u_backgroundColor, bp.rgb, ar);\nif (o > EPSILON) {\nfloat ch = fract(au) * o;\nfloat ci = clamp(min(ch, at - ch), 0.0, 1.0);\nbq *= ci;\n}\nif (n < 0.0 || n > 1.0 || bq < EPSILON) {\ndiscard;\n}\nbp.a *= bq;\nbp.rgb *= bp.a;\ngl_FragColor = bp;\n}\n";(Ss=ca=ca||{})[Ss.INIT=0]="INIT",Ss[Ss.COMPILING=1]="COMPILING",Ss[Ss.DONE=2]="DONE";var lp=(Za.prototype.setConstant=function(e,t){this._constants[e]=t},Za.prototype.setMacro=function(e,t){this._macros[e]=t},Za.prototype.getState=function(){return this._state},Za.prototype.getProgram=function(){return this._program},Za.prototype.compile=function(){var e=this._gl,t=dp(this._vertexSource,this._macros,this._constants),n=dp(this._fragmentSource,this._macros,this._constants);this._program&&(e.deleteProgram(this._program),e.deleteShader(this._vertexShader),e.deleteShader(this._fragmentShader)),this._program=e.createProgram(),this._vertexShader=e.createShader(e.VERTEX_SHADER),this._fragmentShader=e.createShader(e.FRAGMENT_SHADER),e.shaderSource(this._vertexShader,t),e.compileShader(this._vertexShader),e.attachShader(this._program,this._vertexShader),e.shaderSource(this._fragmentShader,n),e.compileShader(this._fragmentShader),e.attachShader(this._program,this._fragmentShader),e.linkProgram(this._program),this._state=ca.COMPILING},Za.prototype.getError=function(){var e=this._gl;return e.getShaderParameter(this._vertexShader,e.COMPILE_STATUS)?e.getShaderParameter(this._fragmentShader,e.COMPILE_STATUS)?e.getProgramParameter(this._program,e.LINK_STATUS)?(this._state=ca.DONE,null):{step:"link",message:e.getProgramInfoLog(this._program)}:{step:"fragment",message:e.getShaderInfoLog(this._fragmentShader)}:{step:"vertex",message:e.getShaderInfoLog(this._vertexShader)}},Za);function Za(e,t){var n=t.vertex,i=t.fragment,r=t.constants,o=t.macros;this._program=null,this._vertexShader=null,this._fragmentShader=null,this._state=ca.INIT,this._gl=e,this._vertexSource=n,this._fragmentSource=i,this._constants=sn(r||{}),this._macros=sn(o||{})}function dp(e,t,n){for(var i=Object.keys(t),r=Object.keys(n),o=0;o<i.length;++o){var a=i[o];e=e.replace("#define "+a+" 0","#define "+a+" "+t[a])}for(o=0;o<r.length;++o){var l=r[o],u=n[l];e=e.replace("const float "+l+" = 0.0;","const float "+l+" = "+u+(u%1==0?".0":"")+";")}return e}var su,Id,Gy=((su={})[0]={min:"NEAREST",mag:"NEAREST",mipmap:!1},su[1]={min:"LINEAR",mag:"LINEAR",mipmap:!1},su[2]={min:"LINEAR",mag:"LINEAR",mipmap:!1},su[3]={min:"LINEAR_MIPMAP_LINEAR",mag:"LINEAR",mipmap:!0},su),Zy=((Id={})[0]="ALPHA",Id[1]="RGBA",Id);function As(e){return 16*Math.ceil((e+2)/16)}function qy(e,t,n,i,r){for(var o=0,a=e.length;o<a;++o){var s=e[o],l=s.x,u=s.y,d=l+i,c=u+r,h=d<n&&c<n;if(h)for(var p=l;p<d;++p)if(1===t[p+u*n]){h=!1;break}if(h)for(p=u;p<c;++p)if(1===t[l+p*n]){h=!1;break}if(h){for(p=l;p<d;++p)for(var g=u;g<c;++g)t[p+g*n]=1;return e.splice(o,1),e.push({x:l,y:c},{x:d,y:u}),s}}return null}function cp(e,t,n,i,r,o,a){var s=4*e,l=t>>1<<7,u=t%2<<7;a[s]=n/16,a[1+s]=i/16,a[2+s]=l+r/16,a[3+s]=u+o/16}function Hy(e,t,n,i,r,o,a){i|=0,r|=0,o|=0,a|=0,t|=0;for(var s=0;s<o;++s)for(var l=0;l<a;++l){var u=4*(i+s+(r+l)*t),d=4*(s+l*o);e[u]=n[d],e[1+u]=n[1+d],e[2+u]=n[2+d],e[3+u]=n[3+d]}}function Wy(e,t){for(var n=0,i=4,r=0;r<e.length;++r){var o=e[r],s=o.height,l=As(o.width),u=As(s);n+=l*u,i=Math.max(i,Math.max(l,u))}var d=Ni(Math.max(i,Math.sqrt(n)));return Math.min(d,t)}function hp(e,t){return Math.floor((t-e)/2)}function pp(e,t,n,i,r,o,a){var s=Gy[o],l=s.min,u=s.mag,d=s.mipmap,c=e[Zy[a]];if(0===a){for(var h=new Uint8Array(r*r),p=0;p<h.length;++p)h[p]=i[4*p+3];i=h}e.activeTexture(e.TEXTURE0+n),e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,c,r,r,0,c,e.UNSIGNED_BYTE,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e[u]),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e[l]),d&&e.generateMipmap(e.TEXTURE_2D)}function fp(e,t,n,i,r){for(var o=new Uint8Array(n*n*4),a=Math.ceil(n/16),s=new Uint8Array(a*a),l=[{x:0,y:0}],u=0;u<t.length;++u){var d=t[u],c=d.id,h=As(d.width)/16,p=As(d.height)/16,g=qy(l,s,a,h,p);if(g){var m=d.width,x=d.height,v=d.pixels,y=16*h,b=16*p,S=16*g.x+hp(m,y),w=16*g.y+hp(x,b);Hy(o,n,v,S,w,m,x),cp(c,e,S,w,y,b,r)}else{if(n<i)return fp(e,t,2*n,i,r);eo("exceeded max WebGL texture size of "+i+"; some texts/icons/images won't be displayed"),cp(c,e,0,0,0,0,r)}}return{texture:o,size:n}}function Yy(e,t,n,i){for(var r=e.getDistanceFromStrokeVertically,o=e.getDistanceFromStrokeHorizontally,a=t*(1-n)/2,s=(t-1)/2,l=0;l<t;++l)for(var u=0;u<t;++u){var d=4*(u*t+l),c=(l-s)/a,h=(u-s)/a,p=me(r(c,h),-1,1),g=me(o(c,h),-1,1);Xy(i,d,gp(p),gp(g))}}function gp(e){return(e+1)/2*32768}function Xy(e,t,n,i){e[t]=n>>8,e[t+1]=n%256,e[t+2]=i>>8,e[t+3]=i%256}function _p(e,t){for(var n=-Math.PI/2,i=2*Math.PI/e.length,r=0,o=e;r<o.length;r++){var a=n+i;t(o[r],n,a),n=a}}function mp(e,t,n,i,r){_p(t,function(o,a,s){e.beginPath(),e.moveTo(n,i),e.arc(n,i,r,a,s),e.fillStyle=o,e.fill()})}var Jy=(qa.prototype.refresh=function(e){for(var t=0,n=e.getShapeList();t<n.length;t++){var i=n[t];if(!this._shapesWritten.includes(i.id)){var r=i.isSimple?32:128,o=i.isSimple?this._simpleShapePixels:this._complexShapePixels;Yy(i,r,1/16,o),this._loadShapeInGpu(i.id,r,o),this._shapesWritten.push(i.id)}}},qa.prototype._loadShapeInGpu=function(e,t,n){var i=this._gl,r=Sd,o=e%Ed*128,a=128*Math.floor(e/Ed);if(this._texture)i.bindTexture(i.TEXTURE_2D,this._texture);else{var s=new Uint8Array(r*r*4);this._texture=i.createTexture(),i.activeTexture(i.TEXTURE0+this._glTextureUnit),i.bindTexture(i.TEXTURE_2D,this._texture),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,r,r,0,i.RGBA,i.UNSIGNED_BYTE,s)}i.texSubImage2D(i.TEXTURE_2D,0,o,a,t,t,i.RGBA,i.UNSIGNED_BYTE,n)},qa.prototype.getTextureSize=function(){return Sd},qa.prototype.getSamplingSize=function(){return 128},qa.prototype.getBufferRatio=function(){return 1/16},qa.prototype.getTextureUnit=function(){return this._glTextureUnit},qa);function qa(e,t){this._gl=e,this._glTextureUnit=t,this._simpleShapePixels=new Uint8Array(4096),this._complexShapePixels=new Uint8Array(65536),this._texture=null,this._shapesWritten=[]}var uu=1e20,Qy=(Od.prototype.getFontToImageSizeRatio=function(){return 1+2*this._buffer/this._fontSize},Od.prototype.draw=function(e,t,n){da(this._ctx,t,this._fontSize,n);var r=this._ctx.measureText(e).width+2*this._buffer,o=16*Math.ceil((r+2)/16)-2,a=this._height,s=o*a,l=Math.max(o,a);this._canvas.width<o&&(this._canvas.width=o,da(this._ctx,t,this._fontSize,n),this._ctx.textAlign="center",this._ctx.textBaseline="middle",this._ctx.fillStyle="black"),s>this._gridSize&&(this._gridOuter=new Float64Array(s),this._gridInner=new Float64Array(s),this._gridSize=s),l>this._maxDimension&&(this._f=new Float64Array(l),this._d=new Float64Array(l),this._z=new Float64Array(l+1),this._v=new Int16Array(l),this._maxDimension=l),this._ctx.clearRect(0,0,o,a),this._ctx.fillText(e,o/2,a/2);for(var u=this._ctx.getImageData(0,0,o,a),d=new Uint8ClampedArray(s),c=0;c<s;c++){var h=u.data[4*c+3]/255;this._gridOuter[c]=1==h?0:0==h?uu:Math.pow(Math.max(0,.5-h),2),this._gridInner[c]=1==h?uu:0==h?0:Math.pow(Math.max(0,h-.5),2)}for(vp(this._gridOuter,o,a,this._f,this._d,this._v,this._z),vp(this._gridInner,o,a,this._f,this._d,this._v,this._z),c=0;c<s;c++)d[c]=Math.max(0,Math.min(255,Math.round(255-255*((this._gridOuter[c]-this._gridInner[c])/this._radius+this._cutoff))));return{height:a,width:o,distance:d}},Od);function Od(e){var t=void 0===e?{}:e,n=t.fontSize,i=void 0===n?24:n,r=t.buffer,o=void 0===r?6:r,a=t.radius,s=void 0===a?8:a,l=t.cutoff,u=void 0===l?.25:l;this._maxDimension=1,this._gridSize=1,this._gridOuter=null,this._gridInner=null,this._f=null,this._d=null,this._z=null,this._v=null,this._fontSize=i,this._buffer=o,this._radius=s,this._cutoff=u,this._height=Math.ceil(this._fontSize+2*this._buffer*1.5),this._canvas=ci(),this._canvas.height=this._height,this._canvas.width=1,this._ctx=this._canvas.getContext("2d"),this._ctx.textBaseline="middle",this._ctx.textAlign="center",this._ctx.fillStyle="black"}function vp(e,t,n,i,r,o,a){for(var s=0;s<t;s++){for(var l=0;l<n;l++)i[l]=e[l*t+s];for(yp(i,r,o,a,n),l=0;l<n;l++)e[l*t+s]=r[l]}for(l=0;l<n;l++){for(s=0;s<t;s++)i[s]=e[l*t+s];for(yp(i,r,o,a,t),s=0;s<t;s++)e[l*t+s]=Math.sqrt(r[s])}}function yp(e,t,n,i,r){i[n[0]=0]=-uu,i[1]=+uu;for(var o=1,a=0;o<r;o++){for(var s=(e[o]+o*o-(e[n[a]]+n[a]*n[a]))/(2*o-2*n[a]);s<=i[a];)a--,s=(e[o]+o*o-(e[n[a]]+n[a]*n[a]))/(2*o-2*n[a]);n[++a]=o,i[a]=s,i[a+1]=+uu}for(o=0,a=0;o<r;o++){for(;i[a+1]<o;)a++;t[o]=(o-n[a])*(o-n[a])+e[n[a]]}}var e0=(Un.prototype.refresh=function(e){this._pixelRatio=e.getPixelRatio();for(var t=this._gl,n=this._getPatternsByFilter(e.getPatternList()),i=0;i<n.length;++i){var r=i,o=n[i],a=fp(r,o,Wy(o,this._maxTextureSize),this._maxTextureSize,this._patternIdToInfoTexture),s=a.texture,l=a.size,u=this._glTextures[r]||(this._glTextures[r]=t.createTexture());pp(t,u,this._glUnit+1+r,s,l,r,0===r?0:1),this._textureSizes[r]=l}var c=this._glTextureInfo||(this._glTextureInfo=t.createTexture());pp(t,c,this._glUnit,this._patternIdToInfoTexture,256,0,1)},Un.prototype.bindMetDataTexture=function(){var e=this._gl;e.activeTexture(e.TEXTURE0+this._glUnit),e.bindTexture(e.TEXTURE_2D,this._glTextureInfo)},Un.prototype.getGranularity=function(){return 16},Un.prototype.getInfoTextureUnit=function(){return this._glUnit},Un.prototype.getNearestTextureUnit=function(){return this._glUnit+1+0},Un.prototype.getLinearTextureUnit=function(){return this._glUnit+1+1},Un.prototype.getLinearSdfTextureUnit=function(){return this._glUnit+1+2},Un.prototype.getMipmapTextureUnit=function(){return this._glUnit+1+3},Un.prototype.getInfoTextureSize=function(){return 256},Un.prototype.getNearestTextureSize=function(){return this._textureSizes[0]},Un.prototype.getLinearTextureSize=function(){return this._textureSizes[1]},Un.prototype.getLinearSdfTextureSize=function(){return this._textureSizes[2]},Un.prototype.getMipmapTextureSize=function(){return this._textureSizes[3]},Un.prototype._getPatternsByFilter=function(e){for(var t=new Array(4),n=0;n<4;++n)t[n]=[];for(n=0;n<e.length;++n){var i=this._getPatternPixels(e[n]);t[i.filter].push(i)}return t},Un.prototype._getPatternPixels=function(e){var t=e.id,n=e.type,i=e.attributes,r=null;switch(n){case 2:r=i.duplicated?this._getDuplicatedImagePixels(i.image):i.scaled?this._getScaledImagePixels(i.image):this._getNonScaledImagePixels(i.image);break;case 3:var o=i.text,a=i.font,s=i.style,l=i.size,u=i.offset;r="sdf"===i.size?this._getSdfTextPixels(o,a,s):this._getRegularTextPixels(o,a,s,l,u);break;case 5:r=this._getIconPixels(i.text,i.font,i.style);break;case 6:r=this._getBadgeIconPixels(i.text,i.font,i.style);break;case 4:r=this._getPieChartPixels(i.colorArray);break;default:throw new Error('pattern type "'+n+'" does not exist')}return r.id=t,r},Un.prototype._getScaledImagePixels=function(e){var t=e.width,n=e.height;if(wr<t||wr<n){var i=wr/Math.max(e.width,e.height);t*=i,n*=i}return t&&n&&(t=As(t),n=As(n)),this._getImagePixels(e,t-=2,n-=2)},Un.prototype._getNonScaledImagePixels=function(e){return this._getImagePixels(e,e.width,e.height)},Un.prototype._getDuplicatedImagePixels=function(e){if(0===e.width||0===e.height)return this._getImagePixels(e,0,0);this._canvasForDuplicatedImage||(this._canvasForDuplicatedImage=ci(),this._canvasForDuplicatedImage.width=wr,this._canvasForDuplicatedImage.height=wr);for(var t=this._canvasForDuplicatedImage,n=t.getContext("2d"),i=e.width,r=e.height,o=(wr-i)/2,a=(wr-r)/2;0<o;)o-=i;for(;0<a;)a-=r;for(var s=o;s<wr;s+=i)for(var l=a;l<wr;l+=r)n.drawImage(e,s,l);return this._getImagePixels(t,wr,wr)},Un.prototype._getImagePixels=function(e,t,n){var i;if(0===t||0===n)i=new Uint8Array(0);else{(this._imageCanvas.width<t||this._imageCanvas.height<n)&&(this._imageCanvas.width=t,this._imageCanvas.height=n);var r=this._imageCanvasContext;Ga(this._imageCanvas,r,t,n);try{r.drawImage(e,0,0,t,n)}catch(o){}i=r.getImageData(0,0,t,n).data}return{width:t,height:n,pixels:i,filter:3}},Un.prototype._getPieChartPixels=function(e){var t=126,n=this._imageCanvasContext;return Ga(this._imageCanvas,n,t,t),n.save(),n.rect(0,0,t,t),n.clip(),mp(n,e,63,63,t),n.restore(),{width:t,height:t,pixels:n.getImageData(0,0,t,t).data,filter:1}},Un.prototype._getTextPixels=function(e,t,n,i,r,o){var a=this._imageCanvasContext,s=r*this._pixelRatio;da(a,n,s,i);var l=a.measureText(t).width;0===l&&(l=s);var u=0,d=0;3===e||(u=2*Math.ceil(1.5*s/2),d=2*Math.ceil(1.2*l/2));var c=Math.ceil(l+d),h=Math.ceil(s+u),p=this._imageCanvas.height<h||this._imageCanvas.width<c;return this._imageCanvas.height<h&&(this._imageCanvas.height=h),this._imageCanvas.width<c&&(this._imageCanvas.width=c),p&&da(a,n,s,i),a.clearRect(0,0,c,h),a.fillStyle="black",a.textBaseline="middle",a.textAlign="left",a.fillText(t,o+d/2,h/2),{width:c,height:h,pixels:a.getImageData(0,0,c,h).data,filter:e}},Un.prototype._getRegularTextPixels=function(e,t,n,i,r){return this._getTextPixels(0,e,t,n,i,r)},Un.prototype._getIconPixels=function(e,t,n){return this._getTextPixels(3,e,t,n,126,0)},Un.prototype._getBadgeIconPixels=function(e,t,n){return this._getSdfTextPixels(e,t,n)},Un.prototype._getSdfTextPixels=function(e,t,n){for(var i=this._sdfGenerator.draw(e,t,n),r=i.width,o=i.height,a=i.distance,s=new Uint8Array(r*o*4),l=0;l<a.length;++l)s[4*l+3]=a[l];return{width:r,height:o,pixels:s,filter:2}},Un);function Un(e,t){this._patternIdToInfoTexture=new Uint8Array(262144),this._glTextureInfo=null,this._glTextures=[],this._textureSizes=[],this._pixelRatio=1,this._gl=e,this._glUnit=t,this._imageCanvas=ci(),this._imageCanvas.width=wr,this._imageCanvas.height=wr,this._imageCanvasContext=this._imageCanvas.getContext("2d"),this._canvasForDuplicatedImage=null,this._sdfGenerator=new Qy({fontSize:24}),this._maxTextureSize=Math.min(4096,e.getParameter(e.MAX_TEXTURE_SIZE))}function xp(){var e=Bi(),t=e.styleSheets;if(!t||!e.location)return Promise.resolve([]);for(var n=_(e),i=[],r=[],o=0;o<t.length;o++){var a=t[o];null===a.href?i.push({href:n,content:a.ownerNode.textContent}):r.push(a.href)}var s=/@font-face\s*\{[^}]+\}/g;return Promise.all(r.map(function(l){return mi(l).then(function(u){return{href:l,content:u}}).catch(function(){return null})})).then(function(l){return l.concat(i)}).then(function(l){for(var u=[],d=0;d<l.length;d++){var c=l[d];if(null!==c){var h=c.href,p=c.content.match(s);if(p){var g=n0(p,h);u.push.apply(u,g)}}}return u})}function bp(e,t){return Promise.all(e.map(function(n){var r=n.originalRule;return Promise.all(n.formats.map(function(o){var a=o.format,s=o.url;return t?Do(s).then(function(l){return{format:a,src:l}}).catch(function(){return null}):{format:a,src:s}})).then(function(o){for(var a=[],s=0;s<o.length;s++){var l=o[s];null!==l&&a.push("url('"+l.src+"') format('"+l.format+"')")}if(0===a.length)return r;var u="src: "+a.join(",")+";";return r.replace(/src\s*:[^;]+;/g,u)})}))}var t0={"embedded-opentype":!0,svg:!0};function n0(e,t){for(var n=/url\(['"]?([^'")]+)['"]?\)\s+format\(['"]?([^'")]+)['"]?\)/g,i=/font-family\s*:\s*['"]?([^;'"]+)['"]?;/,r=[],o=0;o<e.length;o++){for(var a=e[o],s=a.match(i)[1],l=[],u=void 0;u=n.exec(a);){var d=u[1],c=u[2];t0[c.toLowerCase()]||l.push({format:c,url:Ep(d,t)})}r.push({name:s,formats:l,originalRule:a})}return r}function Ep(e,t){if(/^http(s)?:/.test(e))return e;if("/"===e[0]){var n=t.match(/((\w+:\/\/)([^/]+))/);return n?n[1]+e:e}var i=e.split("/"),r=t.split("/");for("/"!==t[t.length-1]&&r.pop();".."===i[0];)i.shift(),r.pop();return r.concat(i).join("/").replace(/[\w](\/{2,})/g,function(o){return o[0]+"/"})}function il(e){if(e.keys)return Array.from(e.keys());var t=[];return e.forEach(function(n,i){return t.push(i)}),t}function ws(e){if(e.values)return Array.from(e.values());var t=[];return e.forEach(function(n){return t.push(n)}),t}var Sp=(zo.prototype.reserve=function(e){if(this._capacity<e){e=Math.pow(2,Math.ceil(Math.log2(e+1)));var t=new Uint32Array(e);t.set(this._array),this._capacity=e,this._array=t}},zo.prototype.has=function(e){var t=lu(this._array,e,0,this.length);return t<this.length&&this._array[t]===e},zo.prototype.add=function(e){var t=lu(this._array,e,0,this.length),n=t<this.length&&this._array[t]===e;return n||(this.length===this._capacity&&this.reserve(this.length+1),this._array.copyWithin(t+1,t,this.length),this._array[t]=e,this.length+=1),!n},zo.prototype.remove=function(e){var t=lu(this._array,e,0,this.length),n=t<this.length&&this._array[t]===e;return n&&(this._array.copyWithin(t,t+1,this.length),--this.length),n},zo.prototype.removeByPosition=function(e){return!(e>=this.length||(this._array.copyWithin(e,e+1,this.length),--this.length,0))},zo.prototype.get=function(e){return this._array[e]},zo.prototype.clear=function(){this.length=0},zo.prototype.slice=function(){return this._array.slice(0,this.length)},zo);function zo(){this._array=new Uint32Array(8),this._capacity=8,this.length=0,this._array=new Uint32Array(8),this._capacity=8,this.length=0}function lu(e,t,n,i){if(n===i)return n;var r=n+((i-n)/2|0),o=t-e[r];return 0==o?r:o<0?lu(e,t,n,r):lu(e,t,r+1,i)}var i0="undefined"==typeof HTMLElement?function(e){return!1}:function(e){return e instanceof HTMLElement};function rl(e,t,n){if(void 0===t&&(t=[]),void 0===n&&(n=[]),!i0(e)){if(function(e){return"object"!=typeof e||null===e||li(e)||(t=e)instanceof RegExp||t instanceof Date;var t}(e))t.push({path:n.slice(),value:e});else for(var i=Object.keys(e),r=0;r<i.length;++r){var o=i[r],a=n.slice();a.push(o),rl(e[o],t,a)}return t}}var Ap=(Object.defineProperty(Ha.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Ha.prototype.set=function(e,t){var n=this._getIndex(e);-1!==n?this._values[n]=t:(Nd(this._cachedPath,e)&&(this._cachedIndex=this._keys.length),this._keys.push(e),this._values.push(t),this._size+=1)},Ha.prototype.get=function(e){var t=this._getIndex(e);if(-1!==t)return this._values[t]},Ha.prototype.has=function(e){return-1!==this._getIndex(e)},Ha.prototype.keys=function(){return this._keys.slice()},Ha.prototype._getIndex=function(e){if(Nd(e,this._cachedPath))return this._cachedIndex;this._cachedPath=e.slice();for(var t=this._keys,n=0;n<t.length;++n)if(Nd(t[n],e))return this._cachedIndex=n;return this._cachedIndex=-1},Ha);function Ha(){this._keys=[],this._values=[],this._size=0,this._cachedPath=[],this._cachedIndex=-1}function Nd(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}var o0=Set.prototype.keys?function(e){return Array.from(e.keys())}:function(e){var t=[];return e.forEach(function(n){return t.push(n)}),t},du=Set.prototype.values?function(e){return Array.from(e.values())}:function(e){var t=[];return e.forEach(function(n,i){return t.push(i)}),t},wp=bi("webworker-threads"),Ld=wp?wp.Worker:null;function Cp(e){return Ld?function t(n){if(ArrayBuffer.isView(n))return Array.from(n);if(Array.isArray(n)){for(var i=0;i<n.length;++i)n[i]=t(n[i]);return n}if($t(n)){for(var o=0,a=Object.keys(n);o<a.length;o++){var s=a[o];n[s]=t(n[s])}return n}return n}(e):e}function Tp(e){return Ld?new Ld(new Function(e)):"undefined"==typeof URL||-1!==navigator.appVersion.indexOf("MSIE 10")?new Mp(e):function(t){try{var n=new Blob([t],{type:"application/javascript"}),i=URL.createObjectURL(n);return new Worker(i)}catch(r){return new Mp(t)}}(e)}var Mp=(ol.prototype.terminate=function(){this._terminated=!1,this._otherSide._terminated=!0},ol.prototype.addEventListener=function(e,t){this._listeners.push(t)},ol.prototype.postMessage=function(e){setTimeout(kp,0,this._otherSide,{data:e})},ol);function ol(e){this._main=!0,this._listeners=[],this._terminated=!1,this._f=new Function("self",e),this._otherSide=new a0(this),this._f(this._otherSide)}var Ip,a0=(Fd.prototype.addEventListener=function(e,t){this._listeners.push(t)},Fd.prototype.postMessage=function(e){setTimeout(kp,0,this._otherSide,{data:e})},Fd);function Fd(e){this._listeners=[],this._main=!1,this._terminated=!1,this._otherSide=e}function kp(e,t){if(!e._terminated)for(var n=0;n<e._listeners.length;++n)e._listeners[n](t)}var Op=bi("xmldom");Ip="undefined"!=typeof XMLSerializer?XMLSerializer:Op?Op.XMLSerializer:null;var s0=(mo.prototype.setAttribute=function(e,t){this._attributes[e]=t},mo.prototype.appendChild=function(e){this._children.push(e)},Object.defineProperty(mo.prototype,"tagName",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(mo.prototype,"children",{get:function(){return this._children},enumerable:!0,configurable:!0}),Object.defineProperty(mo.prototype,"childNodes",{get:function(){return this._children},enumerable:!0,configurable:!0}),Object.defineProperty(mo.prototype,"firstChild",{get:function(){return this._children[0]||null},enumerable:!0,configurable:!0}),mo.prototype.serialize=function(){var e=this._name,t=this._attributes,n=this._children,i=Object.keys(t).filter(function(o){return void 0!==t[o]}).map(function(o){return" "+o+'="'+t[o]+'"'}).join(""),r=n.map(function(o){return o.serialize()}).join("");return r.length?"<"+e+i+">"+r+"</"+e+">":"<"+e+i+"/>"},mo.prototype.cloneNode=function(e){for(var t=new mo(this._name),n=0,i=Object.keys(this._attributes);n<i.length;n++){var r=i[n];t.setAttribute(r,this._attributes[r])}if(e)for(var o=0;o<this._children.length;o++)t.appendChild(this._children[o].cloneNode(e));return t},mo);function mo(e){this._attributes={},this._children=[],this._name=e}var u0=(al.prototype.serialize=function(){return this._text},al.prototype.cloneNode=function(){return new al(this._text)},al);function al(e){this._text=e}var l0=(cu.prototype.appendChild=function(e){this._children.push(e)},cu.prototype.serialize=function(){return this._meta.concat(this._children.map(function(e){return e.serialize()})).join("")},cu.prototype.createElement=function(e){return new s0(e)},cu.prototype.createTextNode=function(e){return new u0(e)},cu);function cu(){this._children=[],this._meta=[],this._children=[],this._meta=[]}function Np(){return new l0}function Pd(e){return(new Ip).serializeToString(e)}function Lp(){return Bi().implementation.createDocument("","",null)}var Fp=(to.prototype.add=function(e){var t=this._keyToIndex[e];-1===t&&(t=this._size++,this._heap[t]=e),this._keyToIndex[e]=this._bubble(t)},to.prototype.removeMin=function(){if(0===this._size)return NaN;var e=this._heap[0];return this._heap[0]=this._heap[--this._size],this._bubble(0),e},to.prototype.isEmpty=function(){return 0===this._size},to.prototype.has=function(e){return-1!==this._keyToIndex[e]},to.prototype._bubble=function(e){var t=this._indexToValue(e),n=this._getParentIndex(e),i=this._indexToValue(n),r=e;if(0!==e&&t<i)r=this._swap(e,n);else{var o=this._getLeftChildIndex(e),a=this._getRightChildIndex(e),s=this._indexToValue(o),l=this._indexToValue(a),u=Math.min(t,s,l);u===t||(r=this._swap(e,u===s?o:a))}return r===e?e:this._bubble(r)},to.prototype._indexToValue=function(e){return e>=this._size?1/0:this._keyToValue[this._heap[e]]},to.prototype._getParentIndex=function(e){return(e-1)/2|0},to.prototype._getLeftChildIndex=function(e){return 2*e+1},to.prototype._getRightChildIndex=function(e){return 2*e+2},to.prototype._swap=function(e,t){var n=this._heap[e],i=this._heap[t];return this._heap[e]=i,this._heap[t]=n,this._keyToIndex[n]=t,this._keyToIndex[i]=e,t},to);function to(e){this._heap=[],this._size=0,this._keyToValue=e,this._keyToIndex=new Int32Array(e.length),this._keyToIndex.fill(-1)}var hu=(Bo.prototype._get=function(e){return e.isNode?this._nodes:this._edges},Bo.prototype.addOrRemoveElements=function(e,t){return t?this.addElements(e):this.removeElements(e)},Bo.prototype.addElements=function(e){for(var t=this._get(e),n=t.elementList,i=t.flexArray,r=t.indexList,o=r.getLength(),a=0;a<e._indexes.length;a++){var s=e._indexes[a];1!==i.get(s)&&(i.set(s,1),r.pushUnchecked(s))}return n(r.slice(o))},Bo.prototype.removeElements=function(e){for(var t=this._get(e),n=t.elementList,i=t.flexArray,r=t.indexList,o=r.getLength(),a=r.getBuffer(),s=0,l=0;l<e._indexes.length;l++){var u=e._indexes[l];0!==i.get(u)&&(i.set(u,0),s+=1)}if(s===o)return n(r.sliceAndReset());if(0===s)return n();var d=this._graph.acquireIndexList(e.isNode),c=0;for(l=0;l<o;++l)0===i.get(u=a[l])?(c+=1,d.pushUnchecked(u)):a[l-c]=u;return r.setLength(o-s),n(d.sliceAndReset())},Bo.prototype.hasElement=function(e){return!!this._get(e).flexArray.get(e._index)},Bo.prototype.clear=function(){this._nodes.indexList.isEmpty()||(this._nodes.indexList.reset(),this._nodes.flexArray.reset()),this._edges.indexList.isEmpty()||(this._edges.indexList.reset(),this._edges.flexArray.reset())},Bo.prototype.isEmpty=function(){return this._nodes.indexList.isEmpty()&&this._edges.indexList.isEmpty()},Bo.prototype.getElements=function(){return{nodes:this._nodes.elementList(this._nodes.indexList.slice()),edges:this._edges.elementList(this._edges.indexList.slice())}},Bo);function Bo(e,t){this._graph=e,this._nodes={elementList:e.nodeList,flexArray:e.createNodeAttribute({storage:1,name:t}),indexList:e.createIndexList(!0)},this._edges={elementList:e.edgeList,flexArray:e.createEdgeAttribute({storage:1,name:t}),indexList:e.createIndexList(!1)}}var Cr=(mr.prototype.reset=function(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.minScaledSize=1/0,this.maxScaledSize=-1/0,this.minFixedSize=1/0,this.maxFixedSize=-1/0,this.width=0,this.height=0,this.cx=0,this.cy=0,this},mr.prototype.addPoint=function(e,t,n,i){return this.minX=Math.min(this.minX,e),this.minY=Math.min(this.minY,t),this.maxX=Math.max(this.maxX,e),this.maxY=Math.max(this.maxY,t),void 0!==n&&void 0!==i&&("scaled"===i?(this.minScaledSize=Math.min(this.minScaledSize,n),this.maxScaledSize=Math.max(this.maxScaledSize,n)):(this.minFixedSize=Math.min(this.minFixedSize,n),this.maxFixedSize=Math.max(this.maxFixedSize,n))),this.cx=this.minX+(this.maxX-this.minX)/2,this.cy=this.minY+(this.maxY-this.minY)/2,this.width=this.maxX-this.minX,this.height=this.maxY-this.minY,this},mr.prototype.computeForZoom=function(e){var t=Math.max(this.maxScaledSize,this.maxFixedSize/e);return mr.from({minX:this.minX-t/2,minY:this.minY-t/2,maxX:this.maxX+t/2,maxY:this.maxY+t/2,width:this.width+t,height:this.height+t})},mr.from=function(e){var t=void 0===e?{}:e,n=t.minX,i=t.minY,r=t.maxX,o=t.maxY,a=t.width,s=t.height,l=new mr;return l.minX=n,l.minY=i,l.maxX=r,l.maxY=o,l.width=a||(r-n)/2,l.height=s||(o-i)/2,l.cx=(n+r)/2,l.cy=(i+o)/2,l},mr.fromValues=function(e,t,n){for(var i=1/0,r=1/0,o=-1/0,a=-1/0,s=-1/0,l=0;l<e.length;l++){var u=e[l],d=t[l],c=n[l];u-c<i&&(i=u-c),d-c<r&&(r=d-c),o<u+c&&(o=u+c),a<d+c&&(a=d+c),s<c&&(s=c)}var h=mr.from({minX:i,minY:r,maxX:o,maxY:a});return h.maxScaledSize=s,h},mr.prototype.pad=function(e){return this.minX-=e,this.minY-=e,this.maxX+=e,this.maxY+=e,this.width+=2*e,this.height+=2*e,this},mr.prototype.isValid=function(){return isFinite(this.width)&&isFinite(this.height)},mr.prototype.extend=function(e){return this.addPoint(e.minX,e.minY),this.addPoint(e.maxX,e.maxY),this},mr.prototype.bottomLeft=function(){return{x:this.minX,y:this.minY}},mr.prototype.topRight=function(){return{x:this.maxX,y:this.maxY}},mr);function mr(e){void 0===e&&(e={});var t=e.xValues,n=void 0===t?[]:t,i=e.yValues,r=void 0===i?[]:i,o=e.scaledSizeValues,a=void 0===o?[]:o,s=e.fixedSizeValues,l=void 0===s?[]:s;this.minX=_n(n),this.minY=_n(r),this.maxX=rn(n),this.maxY=rn(r),this.minScaledSize=_n(a),this.maxScaledSize=rn(a),this.minFixedSize=_n(l),this.maxFixedSize=rn(l),this.cx=this.minX+(this.maxX-this.minX)/2,this.cy=this.minY+(this.maxY-this.minY)/2,this.width=this.maxX-this.minX,this.height=this.maxY-this.minY}var Rd=(Wa.prototype.on=function(e,t){if("string"!=typeof e)throw new TypeError("Event name must be string");if("function"!=typeof t)throw new TypeError("Event handler must be function");var n=this._events=this._events||{};return(n[e]=n[e]||[]).push(t),this},Wa.prototype.off=function(e,t){if("string"!=typeof e)throw new TypeError("Event name must be string");var n=this._events=this._events||{},i=n[e];if(li(i))if("function"!=typeof t)n[e]=null;else{var r=i.indexOf(t);-1!==r&&i.splice(r,1),0===i.length&&(n[e]=null)}return this},Wa.prototype.fire=function(e){for(var t=arguments,n=[],i=1;i<arguments.length;i++)n[i-1]=t[i];if("string"!=typeof e)throw new TypeError("Event name must be string");var r=(this._events=this._events||{})[e];if(li(r))for(var o=n,a=0;a<r.length;a++){var s=r[a];s&&s.apply(this,o)}return this},Wa.prototype.once=function(e,t){var n=this,i=function(){for(var r=arguments,o=[],a=0;a<arguments.length;a++)o[a]=r[a];t.apply(n,o),n.off(e,i)};return i.handler=t,this.on(e,i)},Wa.prototype.hasListener=function(e,t){if(!e||!t)return!1;var n=(this._events=this._events||{})[e];if(li(n))for(var i=0,r=n.length;i<r;i++){var o=n[i];if(o===t||o.handler===t)return!0}return!1},Wa.prototype.getListeners=function(e){return(this._events=this._events||{})[e]},Wa);function Wa(){}var d0=Object.freeze({__proto__:null,BoundingBox:Cr,FlexArray:Fn,EventTarget:Rd,ColorManager:ou,Table:fd,setKeys:o0,setValues:du,requestAnimFrame:Oo,cancelAnimFrame:di,DummyCanvas:ip,DummyCanvasRenderingContext2D:rp,createCanvas:ci,clearCanvas:Ga,setCtxFont:da,isWebGLSupported:op,getWebglContext:Ad,getDocumentFontRules:xp,getEmbeddedFontRules:bp,resolvePath:Ep,IndexList:ms,mapKeys:il,mapValues:ws,isInteger:function(e){return"number"==typeof e&&e%1==0},toPropertyPath:Pr,throttle:Pa,debounce:function(e,t,n){var i,r,o,a,s;function l(){var d=Date.now()-a;d<t&&0<=d?i=setTimeout(l,t-d):(i=null,n||(s=e.apply(o,r),o=r=null))}function u(){o=this,r=arguments,a=Date.now();var d=n&&!i;return i=i||setTimeout(l,t),d&&(s=e.apply(o,r),o=r=null),s}return 0!==t&&void 0!==t||(t=100),u.clear=function(){i&&(clearTimeout(i),i=null)},u.flush=function(){i&&(s=e.apply(o,r),o=r=null,clearTimeout(i),i=null)},u},processQueue:function(e,t){return new Promise(function(n,i){return function r(o,a,s,l,u){s(o[a],a,o,l,u).then(function(d){a===o.length-1?l(d):r(o,a+1,s,l,u)}).catch(u)}(e,0,t,n,i)})},isLittleEndian:fr,promiseQueue:qi,hash8:Jr,isRawObject:Qr,getValues:Da,forEach:_t,deepCopy:sn,updateObject:function e(t,n){_t(n,function(i,r){"object"==typeof r&&null!==r?("object"==typeof t[i]&&null!==t[i]||(t[i]={}),e(t[i],r)):t[i]=r})},extendList:function(e,t){t.forEach(function(n){-1===e.indexOf(n)&&e.push(n)})},setProperty:Yt,getProperty:bn,flatten:qt,unflatten:En,getFlattenedKeys:Ei,getLeafValues:Qn,ensureTransferable:Hi,getOptions:un,isObject:$t,mergeValues:nr,pick:Ra,objToValueList:rl,PathMap:Ap,smartRequire:bi,getDocument:Bi,getStyle:po,DummyDomElement:Vi,createDummyDomElement:$o,getPixelRatio:Ln,dataUrlToBlob:Hn,createBlob:gr,isBlob:function(e){return"undefined"!=typeof Blob&&e instanceof Blob||e instanceof Wn},promptDownload:cn,resizeElement:Fo,setAttributes:ea,SVG_NS:ta,XML_NS:kn,XLINK:lt,createSvgElement:fn,createTextNode:Ti,getImage:_s,fetch:mi,isHTMLElement:Po,applyCursorStyle:$r,fetchBinary:Va,fetchBinaryAsBase64:Do,escapeDOMAttribute:_r,BUTTON_MAPPING:Mi,baseURI:_,fadeElement:A,getCurrentTime:z,getDate:U,getTime:de,formatWorkerMessage:Cp,createWorker:Tp,insertSortAsc:Xr,insertSortDesc:pr,isArray:li,toArray:f,flattenArray:Fr,concatenateArrays:function(){for(var e=arguments,t=[],n=0;n<arguments.length;n++)t[n]=e[n];if(0===t.length)return[];for(var i=t[0].constructor,r=0,o=0,a=t;o<a.length;o++)r+=(c=a[o]).length;for(var s=new i(r),l=0,u=0,d=t;u<d.length;u++){for(var c=d[u],h=0;h<c.length;h++)s[l+h]=c[h];l+=c.length}return s},removeFromArray:Fa,binaryIndexOf:ps,parseColorRgba:md,toHexa:Yu,componentsToRGBA:ep,parseColorHex:vd,createDummyXmlDocument:Np,serializeXMLDocument:Pd,createXmlDocument:Lp,PrioritySet:Fp,nextPowerOfTwo:Ni,computeSum:Sn,clamp:me,mix:Lt,lerp:kt,computeMax:rn,computeMin:_n,getBaseLog:Ar,ElementSet:hu,displayPixelsOnScreen:function(e,t,n,i){void 0===i&&(i=0),void 0===t&&(t=n=Math.sqrt(e.length/4)),void 0===n&&(n=t);var r=document.createElement("canvas"),o=r.getContext("2d"),a=o.createImageData(t,n);r.style.imageRendering="pixelated",r.style.border="1px solid black",r.style.margin="2px",r.style.position="absolute",r.style.top=r.style.left="0px",r.width=t,r.height=n,a.data.set(e),o.putImageData(a,0,0);var s=document.getElementById("graph-container");s&&(s.style.position="static"),setTimeout(function(){return document.body.appendChild(r)},i)}}),c0={byte:1,ubyte:1,short:2,ushort:2,float:4},h0={byte:"BYTE",ubyte:"UNSIGNED_BYTE",short:"SHORT",ushort:"UNSIGNED_SHORT",float:"FLOAT"},Pp=(vo.prototype._finishInit=function(){var e=this,t=this._gl,n=this._ext,i=this._programWrapper.getError();if(i)throw new Error('WebGL compilation at step "'+i.step+":\n"+i.message+'"');var r=this._programWrapper.getProgram();this._program=r,t.useProgram(r),this._metaData.attributes.forEach(function(d){d.location=t.getAttribLocation(e._program,d.name),d.byteSize=d.size*c0[d.type],d.glType=h0[d.type]}),this._specialAttributes=this._createSpecialAttributesFunctions();for(var o=[],a=[],s=0,l=this._metaData.attributes;s<l.length;s++){var u=l[s];-1!==u.location&&(u.name.startsWith("a_text")?a.push(u):o.push(u))}this._baseAttributes=zd(o,t,n),this._textAttributes=zd(a,t,n),this._setupUniforms=function(d,c,h){for(var p={},g=[],m=0;m<d.length;++m){var x=d[m],v=x.id,b=x.type,S=c.getUniformLocation(h,x.name),w=p0[b](v);p[v]=S,g.push(w)}var M=new Function("gl","l","u",g.join("\n"));return function(N){return M(c,p,N)}}(this._metaData.uniforms,t,r)},vo.prototype._createSpecialAttributesFunctions=function(){return zd([{location:this._gl.getAttribLocation(this._program,this._metaData.vertexInfoAttribute),size:3,glType:"BYTE",byteSize:3,type:"byte",name:"special"}],this._gl,this._ext)},vo.prototype.startPass=function(e){this._program||this._finishInit(),this._gl.useProgram(this._program),this._resetStencil(),this._setupUniforms(e),this._specialAttributes.enable(),this._specialAttributes.setup(this._specialGlBuffers.vertexInfo,null,0)},vo.prototype._setupAttributes=function(e,t){var n=t.glBuffer,i=t.dataBuffer,r=t.divisor;e.enabled&&!n?e.disable():!e.enabled&&n&&e.enable(),n&&e.setup(n,i,r)},vo.prototype.setupBaseAttributes=function(e){this._setupAttributes(this._baseAttributes,e)},vo.prototype.setupTextAttributes=function(e){this._setupAttributes(this._textAttributes,e)},vo.prototype._resetStencil=function(){var e=this._gl;this._stencilUsage=1,e.disable(e.STENCIL_TEST)},vo.prototype.setupStencil=function(e){if(e!==this._stencilUsage){var t=this._gl;1!==e?(t.enable(t.STENCIL_TEST),2===e?(t.stencilOp(t.KEEP,t.KEEP,t.REPLACE),t.stencilFunc(t.ALWAYS,1,1)):3===e&&(t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.stencilFunc(t.EQUAL,0,1))):t.disable(t.STENCIL_TEST),this._stencilUsage=e}},vo.prototype.endPass=function(){this._specialAttributes.disable(),this._baseAttributes.disable(),this._textAttributes.disable()},vo);function vo(e){var t=e.gl,n=e.ext,i=e.specialGlBuffers,r=e.metaData,o=e.programWrapper;this._setupUniforms=null,this._specialAttributes=null,this._baseAttributes=null,this._textAttributes=null,this._stencilUsage=1,this._gl=t,this._ext=n,this._specialGlBuffers=i,this._metaData=sn(r),this._programWrapper=o}var p0={int:function(e){return"gl.uniform1i(l."+e+", u."+e+");"},sampler2D:function(e){return"gl.uniform1i(l."+e+", u."+e+");"},float:function(e){return"gl.uniform1f(l."+e+", u."+e+");"},vec2:function(e){return"gl.uniform2f(l."+e+", u."+e+"[0], u."+e+"[1]);"},vec3:function(e){return"gl.uniform3f(l."+e+", u."+e+"[0], u."+e+"[1], u."+e+"[2]);"},vec4:function(e){return"gl.uniform4f(l."+e+", u."+e+"[0], u."+e+"[1], u."+e+"[2], u."+e+"[3]);"}};function zd(e,t,n){var i,r,o,a,s,l,u,d,c,h,p,g,m,x=(i=t,r=e.map(function(y){return"gl.enableVertexAttribArray("+y.location+");"}).join("\n"),o=new Function("gl",r),function(){return o(i)}),v=(a=t,s=e.map(function(y){return"gl.disableVertexAttribArray("+y.location+");"}).join("\n"),l=new Function("gl",s),function(){return l(a)});return{enable:function(){x(),this.enabled=!0},disable:function(){v(),this.enabled=!1},setup:(d=t,c=n,h=(u=e).reduce(function(y,b){return y+b.byteSize},0),p=0,g=["gl.bindBuffer(gl.ARRAY_BUFFER, glBuffer);","if (dataBuffer) gl.bufferData(gl.ARRAY_BUFFER, dataBuffer, gl.STATIC_DRAW);"].concat(u.map(function(y){var N="gl.vertexAttribPointer(\n        "+y.location+", "+y.size+", gl."+y.glType+",\n        false, "+h+", "+p+"\n      );";return p+=y.byteSize,N}),u.map(function(y){return"ext.vertexAttribDivisorANGLE("+y.location+", divisor);"})).join("\n"),m=new Function("gl","ext","glBuffer","dataBuffer","divisor",g),function(y,b,S){return m(d,c,y,b,S)}),enabled:!1}}var f0=(ha.prototype.setDataBuffer=function(e){this._dataBuffer!==e&&(this._program=e.isAnimated()?this._animationProgram:this._staticProgram,this._dataBuffer=e,this._dataBufferChanged=!0,e.hasSideData()&&!this._sideGlBuffer?this._sideGlBuffer=this._gl.createBuffer():!e.hasSideData()&&this._sideGlBuffer&&(this._gl.deleteBuffer(this._sideGlBuffer),this._sideGlBuffer=null))},ha.prototype.markAsUnused=function(){return this._used=!1,this},ha.prototype.getProgram=function(){return this._program},ha.prototype.markAsUsed=function(){return this._used=!0,this},ha.prototype.isUsed=function(){return this._used},ha.prototype.draw=function(){var e=this._gl,t=this._dataBuffer.getElementType(),n=2===t,i=n?this._dataBuffer.getNbSideElementsPerMainElement():1,r=3===t?41:1,o=this._dataBuffer.getSize(),a=this._dataBuffer.getStencilUsage(),s=this._dataBuffer.getVersion(),l=this._version!==s||this._dataBufferChanged;this._program.setupBaseAttributes({glBuffer:this._glBuffer,dataBuffer:l?this._dataBuffer.getByteArray():null,divisor:i}),this._program.setupTextAttributes({glBuffer:this._sideGlBuffer,dataBuffer:l&&n?this._dataBuffer.getSideByteArray():null,divisor:1}),this._program.setupStencil(a),l&&(this._version=s,this._dataBufferChanged=!1),this._ext.drawArraysInstancedANGLE(e.TRIANGLES,0,6*r,o*i)},ha.prototype.destroy=function(){this._gl.deleteBuffer(this._glBuffer),this._sideGlBuffer&&this._gl.deleteBuffer(this._sideGlBuffer)},ha);function ha(e){var t=e.gl,n=e.ext,i=e.staticProgram,r=e.animationProgram;this._program=null,this._dataBuffer=null,this._version=0,this._used=!1,this._dataBufferChanged=!1,this._glBuffer=null,this._sideGlBuffer=null,this._gl=t,this._ext=n,this._staticProgram=i,this._animationProgram=r,this._glBuffer=this._gl.createBuffer()}function Bd(e,t){if(t<2)return e;for(var n=e.split("\n"),i=[],r=0;r<n.length;++r){var o=n[r];if(o.length<t)i.push(o);else for(var a=Dp(n[r],t),s=0;s<a.length;++s)i.push(a[s])}return i.join("\n")}function Dp(e,t){for(var n=e.split(" "),i=[],r=0,o=-1,a=[],s=!0,l=0;l<n.length;++l)if(s){if(n[l].length>t){for(var u=g0(n[l],t),d=0;d<u.length;++d)i.push([u[d]]),++o;r=u[u.length-1].length}else i.push([n[l]]),++o,r=n[l].length+1;s=!1}else r+n[l].length<=t?(i[o].push(n[l]),r+=n[l].length+1):(s=!0,--l);for(l=0;l<i.length;++l)a.push(i[l].join(" "));return a}function g0(e,t){for(var n=[],i=0;i<e.length;i+=t-1)n.push(e.substr(i,t-1)+"-");return n[n.length-1]=n[n.length-1].substr(0,n[n.length-1].length-1)+" ",n}function Rp(e,t){if(null===e)return null;for(var n=(e=e.toString()).split("\n"),i=[],r=0,o=0;o<n.length;o++){var a=n[o];if(!t||t<=1||a.length<t)i.push(a),r=Math.max(r,a.length);else for(var s=Dp(n[o],t),l=0;l<s.length;l++)i.push(a=s[l]),r=Math.max(r,a.length)}return{data:i,maxLength:r,lines:i.length}}function zp(){var e=bi("@mapbox/mapbox-gl-rtl-text")||bi("mapbox-gl-rtl-text"),t=e?e.processBidirectionalText:Wi?window.processBidirectionalText:null,n=e?e.applyArabicShaping:Wi?window.applyArabicShaping:null;return{processBidirectionalText:t?function(i){return t(i,[]).join("")}:function(i){return i},applyArabicShaping:n?function(i){return null===i?null:"number"==typeof i?i.toString():n(i)}:function(i){return null===i?null:i.toString()}}}var pu=fr(),fu="\n".charCodeAt(0),_0=(sr.prototype._init_=function(){this._mustClear=!1,this._byFont={},this._widthAtlases={normal:{},bold:{},italic:{}}},sr.prototype.reset=function(){this._init_()},sr.prototype.clear=function(){this._mustClear=!0},sr.prototype._measureChar=function(e,t,n){return da(this._ctx,t,12,n),this._ctx.measureText(e).width/12},sr.prototype._getAtlas=function(e,t,n){var i="sdf"===n?0:n,r=this._byFont[e]||(this._byFont[e]={}),o=r[t]||(r[t]=new Array(50));return o[i]||(o[i]=new Array(256))},sr.prototype._getMeasurementAtlas=function(e,t){var n=this._widthAtlases[t];return n[e]||(n[e]=new Array(256))},sr.prototype.measureText=function(e,t,n,i){if(void 0===i&&(i=1),!t)return this._textDimensions.width=0,this._textDimensions.height=0,this._textDimensions;for(var r=this._getMeasurementAtlas(t,n),o=0,a=0,s=1,l=0;l<e.length;++l){var u=e.charCodeAt(l);if(u===fu)o<a&&(o=a),a=0,s+=1;else{var d=r[u];void 0===d&&(d=this._measureChar(e[l],t,n),r[u]=d),a+=d}}return o<a&&(o=a),this._textDimensions.width=o*i,this._textDimensions.height=s*i,this._textDimensions},sr.prototype._getCharInfo=function(e,t,n,i,r,o){var a=e[t];if(!a){var s=String.fromCharCode(t),l="sdf"===r?1:3;a={ratio:this._measureChar(s,n,i),patternId:new Array(l)};for(var u=0;u<l;++u)a.patternId[u]=this._patternManager.getIdFromDefinition({id:0,type:3,attributes:{text:s,font:n,style:i,size:r,align:o,offset:u/l}});e[t]=a}return a},sr.prototype.storeTextInDataView=function(e,t,n,i){var r=t;if(i&&7===i.type){var o=i.attributes,a=o.text,s=o.font,l=o.style,u=o.size,d=o.align,c="center"===d,h=this._getAtlas(s,l,u),p=0,g=1,m=0,x=0,v=this._lineWidthList;a=this._processBidirectionalText(a);for(var y=0;y<a.length;++y)(J=a.charCodeAt(y))===fu?(p<m&&(p=m),v[x]=m,x+=1,m=0,g+=1):m+=(N=this._getCharInfo(h,J,s,l,u,d)).ratio;if(p<(v[x]=m)&&(p=m),"sdf"===u){var b=0,S=-(c?v[b]:p)/2,w=(1-g)/2,M=0;for(y=0;y<a.length;++y){var N=h[J=a.charCodeAt(y)];if(J===fu)b+=1,S=-(c?v[b]:p)/2,w+=1,M=0;else{var D=N.ratio,P=N.patternId[0];S+=(D+M)/2,M=D;var L=Vp(20.44*S),V=Bp(2*w);e.setUint16(r,P,pu),e.setUint16(r+2,(L<<6)+V,pu),r+=4}}}else{var X=0;for(S=Math.ceil(-(c?v[X]:p)*u/2),w=(1-g)/2,y=0;y<a.length;++y){var J;if(N=h[J=a.charCodeAt(y)],J===fu)X+=1,S=Math.ceil(-(c?v[X]:p)*u/2),w+=1;else{var se=N.ratio*u,re=Math.floor(S),Y=Math.round(3*(S-re));3===Y&&(Y=0,re+=1),re+=Math.ceil(se/2),S+=se,P=N.patternId[Y],L=Vp(re),V=Bp(2*w),e.setUint16(r,P,pu),e.setUint16(r+2,(L<<6)+V,pu),r+=4}}}}this._fillWithZeros(e,r,n)},sr.prototype.extractTextFromDataView=function(e,t,n){for(var i=e,r=pu,o=i.getUint16(t,r),a=this._textPattern,s=this._patternManager.getDefinitionFromId(o).attributes,l=s.font,u=s.style,d=s.size,c=s.align,h=this._getAtlas(l,u,d),p=[],g=0,m=0,x=0,v=null,y=t;y<n;y+=4){var b=i.getUint16(y,r);if(!b)break;var S=i.getUint16(y+2,r)%64-32,w=this._patternManager.getDefinitionFromId(b);if(!w)break;var M=w.attributes.text.charCodeAt(0),N=h[M];null===v?v=S:v<S&&(m<g&&(m=g),g=0,x+=1,p.push(fu),v=S),p.push(M),N&&(g+=N.ratio)}m<g&&(m=g);var D=String.fromCharCode.apply(null,p);return a.attributes.style=u,a.attributes.font=l,a.attributes.size=d,a.attributes.align=c,a.attributes.text=this._processBidirectionalText(D),a.dimensions.width=m,a.dimensions.height=x,a},sr.prototype._fillWithZeros=function(e,t,n){for(var i=t;i<n;i+=4)e.setUint16(i,0)},sr.prototype._clear=function(){this._byFont={},this._widthAtlases={normal:{},bold:{},italic:{}}},sr.prototype.update=function(){this._mustClear&&(this._clear(),this._mustClear=!1)},sr.prototype.getVersion=function(){return 0},sr);function sr(e){this._patternManager=e,this._canvas=ci(),this._ctx=this._canvas.getContext("2d"),this._processBidirectionalText=zp().processBidirectionalText,this._textPattern={id:0,type:7,attributes:{text:"",font:"",size:0,style:"normal",align:"center"},dimensions:{width:0,height:0}},this._textDimensions={width:0,height:0},this._lineWidthList=new Array(64),this._init_()}function Bp(e){return me(e+32,0,63)}function Vp(e){return me(e+512,0,1023)}var Vd,m0=op(),v0={stencil:!0,antialias:!1,alpha:!0,premultipliedAlpha:!0,failIfMajorPerformanceCaveat:!("undefined"!=typeof window&&window.FORCE_WEBGL)},y0={NO_WEBGL:'Unable to create a WebGL context: `canvas.getContext("webgl")` and `canvas.getContext("experimental-webgl")` returned `null`',NO_ANGLE_INSTANCED_ARRAYS:'WebGL extension "ANGLE_instanced_arrays" unavailable: `gl.getExtension("ANGLE_instanced_arrays")` returned `null`'},x0=(St(Up,Vd=Error),Up);function Up(){return null!==Vd&&Vd.apply(this,arguments)||this}function jp(e,t){if(!e){var n=new x0(y0[t]);throw n.code=t,n}}var Gp,b0=(St(hi,Gp=Cd),hi.isAvailable=function(){return m0},hi.createInitData=function(){var e=ci(),t=Ad(e,v0),n=t&&"function"==typeof t.getExtension?t.getExtension("ANGLE_instanced_arrays"):null,i={BYTES_TO_OFFSET_ANGLE:2*Math.PI/8,BYTES_TO_COLOR:1/15,SDF_FONT_SIZE:24,CURVATURE_RATIO:5,PATTERN_MARGIN:1,TEXT_WIDTH_MULTIPLIER:1.2,TEXT_HEIGHT_MULTIPLIER:1.5,SELF_LOOP_CURVATURE_MULTIPLIER:5,EDGE_ARROW_SIZE_RATIO:3,NB_PIECES_PER_CURVE:41,PIECE_NODE_COMPONENT:1,PIECE_EDGE_BODY:2,PIECE_EDGE_HEAD:3,PIECE_EDGE_TAIL:4,PIECE_EDGE_TEXT:5,MAX_TEXT_SIZE:25,BYTES_TO_TEXT_OFFSET:1/20.44,FILTER_NEAREST:0,FILTER_LINEAR:1,FILTER_LINEAR_SDF:2,FILTER_MIPMAP:3,SHAPE_TEXTURE_SIZE:Sd,SIMPLE_SHAPE_SAMPLING_SIZE:32,COMPLEX_SHAPE_SAMPLING_SIZE:128,SHAPE_SAMPLING_BUFFER_RATIO:1/16,MAX_NB_SHAPES:15..toString(),FIRST_COMPLEX_SHAPE_ID:8,SELF_LOOP_TO_CIRCLE_APPROX:.9721},r=new lp(t,{vertex:Td,fragment:Md,constants:i,macros:{ANIMATED:0}}),o=new lp(t,{vertex:Td,fragment:Md,constants:i,macros:{ANIMATED:1}});return t&&n&&(r.compile(),t.flush()),{canvas:e,gl:t,ext:n,staticProgramWrapper:r,animationProgramWrapper:o}},hi.getName=function(){return"WebGL"},hi.prototype._afterFirstFrame=function(){this._animationProgramWrapper.getState()===ca.INIT&&this._animationProgramWrapper.compile()},hi.prototype.ensureAnimationsReady=function(){var e=this._animationProgramWrapper.getState();e!==ca.DONE&&(e===ca.INIT&&this._animationProgramWrapper.compile(),this._animationProgramWrapper.getError())},hi.prototype.getDomElement=function(){return this._glCanvas},hi.prototype._initGl=function(){var e=this._gl;e.clearColor(0,0,0,0),e.enable(e.BLEND),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA)},hi.prototype._computeShaderInfo=function(){var t;this._shaderMetadata=(Md,Zp(t={vertexInfoAttribute:"a_vertexInfo",attributes:[],uniforms:[]},Td),Zp(t,"#define D3D9_FIX 0\nprecision highp float;\nprecision mediump int;\nuniform vec3 u_backgroundColor;\nuniform sampler2D u_patternNearestTexture;\nuniform sampler2D u_patternLinearTexture;\nuniform sampler2D u_patternLinearSdfTexture;\nuniform sampler2D u_patternMipmapTexture;\nuniform sampler2D u_shapeTexture;\nvarying vec4 a;\nvarying vec4 b;\nvarying vec4 c;\nvarying vec2 d;\nvarying vec2 e;\n#if D3D9_FIX\nvarying vec4 f;\nvarying vec3 g;\nvarying vec4 h;\nvarying vec4 i;\n#else\nvarying float j;\nvarying vec2 k;\nvarying vec2 l;\nvarying vec2 m;\nvarying float n;\nvarying float o;\nvarying vec2 p;\nvarying vec2 q;\nvarying float r;\nvarying float s;\n#endif\nconst float FILTER_NEAREST = 0.0;\nconst float FILTER_LINEAR = 0.0;\nconst float FILTER_LINEAR_SDF = 0.0;\nconst float FILTER_MIPMAP = 0.0;\nconst float EPSILON = 0.000000001;\nconst float SDF_BUFFER = (256.0 - 64.0) / 256.0; \nvec4 ad(in vec4 ae, in vec4 af) {\nfloat ag = af.a;\nfloat ah = ae.a + EPSILON;\nfloat ai = min(ag + ah, 1.0);\nfloat r = ag / ai;\nreturn vec4(mix(ae.rgb, af.rgb, r), ai);\n}\nfloat aj(in float ak, in float al) {\nfloat am = (ak * 256.0 + al) * 256.0;\nfloat an = am / 32768.0;\nreturn an * 2.0 - 1.0;\n}\nbool ao(float ap, float aq) {\nreturn abs(ap - aq) < EPSILON;\n}\nvoid main() {\n#if D3D9_FIX\nfloat j = g.x;\nfloat ar = g.y;\nfloat as = g.z;\nvec2 k = f.xy;\nvec2 l = f.zw;\nfloat n = h.x;\nfloat o = h.y;\nfloat at = h.z;\nfloat au = h.w;\nvec2 q = i.xy;\nfloat r = i.z;\nfloat s = i.w;\n#else\nfloat ar = m.x;\nfloat as = m.y;\nfloat at = p.x;\nfloat au = p.y;\n#endif\nvec4 av = texture2D(u_shapeTexture, d);\nfloat aw = aj(av.b, av.a) * q.x;\nfloat ax = aj(av.r, av.g) * q.y;\nax += as;\nfloat ay = min(aw, ax);\nvec4 az = a;\nvec4 ba = b;\nif (s > -EPSILON) {\nvec2 bb = e;\nfloat bj =\nstep(k.x, bb.x) *\nstep(bb.x, l.x) *\nstep(k.y, bb.y) *\nstep(bb.y, l.y);\nfloat bk = bj;\nvec4 bl;\nif (ao(s, FILTER_NEAREST)) {\nbl = texture2D(u_patternNearestTexture, bb);\n} else if (ao(s, FILTER_LINEAR)) {\nbl = texture2D(u_patternLinearTexture, bb);\n} else if (ao(s, FILTER_LINEAR_SDF)) {\nbl = texture2D(u_patternLinearSdfTexture, bb);\nbl.a = smoothstep(SDF_BUFFER - r, SDF_BUFFER + r, bl.a);\n} else if (ao(s, FILTER_MIPMAP)) {\nbl = texture2D(u_patternMipmapTexture, bb);\n}\nbl.rgb += c.rgb;\nbl.a *= bk;\naz = ad(az, bl);\n}\nfloat bm = clamp(ay, 0.0, 1.0);\nfloat bn = clamp(ay - j, 0.0, 1.0);\nfloat bo = bm - bn;\nbo = 1.0 - clamp(ay - j, 0.0, 1.0);\naz.a *= bn;\nba.a *= bo;\nvec4 bp = ad(az, ba);\nfloat bq = bm;\nbp.rgb = mix(u_backgroundColor, bp.rgb, ar);\nif (o > EPSILON) {\nfloat ch = fract(au) * o;\nfloat ci = clamp(min(ch, at - ch), 0.0, 1.0);\nbq *= ci;\n}\nif (n < 0.0 || n > 1.0 || bq < EPSILON) {\ndiscard;\n}\nbp.a *= bq;\nbp.rgb *= bp.a;\ngl_FragColor = bp;\n}\n"),t)},hi.prototype._initGlPrograms=function(){this._staticProgram=new Pp({gl:this._gl,ext:this._ext,specialGlBuffers:this._specialGlBuffers,metaData:this._shaderMetadata,programWrapper:this._staticProgramWrapper}),this._animationProgram=new Pp({gl:this._gl,ext:this._ext,specialGlBuffers:this._specialGlBuffers,metaData:this._shaderMetadata,programWrapper:this._animationProgramWrapper})},hi.prototype._initSpecialGlBuffers=function(){for(var e=this._gl,t=e.createBuffer(),n=new Int8Array(738),i=0;i<41;++i)for(var r=[-1,-1,i,1,-1,i,1,1,i,-1,-1,i,-1,1,i,1,1,i],o=i*r.length,a=0;a<r.length;a++)n[a+o]=r[a];e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW),this._specialGlBuffers={vertexInfo:t}},hi.prototype._computeUniforms=function(){return{viewWidth:this._width,viewHeight:this._height,viewX:this._viewX,viewY:this._viewY,viewZoom:this._viewZoom,viewAngle:this._viewAngle,currentTime:this._currentTime,pixelRatio:this._pixelRatio,backgroundColor:this._backgroundRgba,patternInfoTexture:this._patternTexture.getInfoTextureUnit(),patternNearestTexture:this._patternTexture.getNearestTextureUnit(),patternLinearTexture:this._patternTexture.getLinearTextureUnit(),patternLinearSdfTexture:this._patternTexture.getLinearSdfTextureUnit(),patternMipmapTexture:this._patternTexture.getMipmapTextureUnit(),shapeTexture:this._shapeTexture.getTextureUnit(),BYTES_TO_COORD:this._scales.bytesToActualCoord,BYTES_TO_SCALED_SIZE:this._scales.bytesToActualScaledSize,BYTES_TO_MIN_VISIBLE_SIZE:this._scales.bytesToActualMinVisibleSize,BYTES_TO_SYMBOLIC_SIZE:this._scales.bytesToActualSymbolicSize,BYTES_TO_DASH_LENGTH:this._scales.bytesToActualDashLength,BYTES_TO_GAP_LENGTH:this._scales.bytesToActualGapLength,BYTES_TO_PATTERN_SCALE:this._scales.bytesToActualPatternScale,PATTERN_INFO_TEXTURE_SIZE:this._patternTexture.getInfoTextureSize(),PATTERN_NEAREST_TEXTURE_SIZE:this._patternTexture.getNearestTextureSize(),PATTERN_LINEAR_TEXTURE_SIZE:this._patternTexture.getLinearTextureSize(),PATTERN_LINEAR_SDF_TEXTURE_SIZE:this._patternTexture.getLinearSdfTextureSize(),PATTERN_MIPMAP_TEXTURE_SIZE:this._patternTexture.getMipmapTextureSize(),PATTERN_POSITION_GRANULARITY:this._patternTexture.getGranularity(),SHAPE_TEXTURE_SIZE:this._shapeTexture.getTextureSize(),SHAPE_SAMPLING_SIZE:this._shapeTexture.getSamplingSize(),SHAPE_SAMPLING_BUFFER_RATIO:this._shapeTexture.getBufferRatio(),NB_SHAPES_BY_SIDE:this._shapeTexture.getTextureSize()/this._shapeTexture.getSamplingSize(),SHAPE_DIMENSIONS:this._shapeTexture.getSamplingSize()/this._shapeTexture.getTextureSize(),SHAPE_ACTUAL_RATIO:1-this._shapeTexture.getBufferRatio()}},hi.prototype._render=function(e){var n=e.patternsChanged,i=e.dimensionsChanged,r=e.backgroundColorChanged,o=this._gl;if(e.shapesChanged&&(this._shapeTexture.refresh(this._shapeManager),this._patternTexture.bindMetDataTexture()),n&&this._patternTexture.refresh(this._patternManager),i&&(this._mustResize=!0),r){var a=this._renderBackground?this._backgroundRgba:[0,0,0,0],d=a[3];o.clearColor(a[0]*d,a[1]*d,a[2]*d,d)}var c=this._computeUniforms(),h=this._startFrame();this._mustResize&&h.length&&(Fo(this._glCanvas,this._width,this._height,this._pixelRatio),o.viewport(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio),this._mustResize=!1),o.clear(o.COLOR_BUFFER_BIT|o.STENCIL_BUFFER_BIT);for(var p=0;p<h.length;++p)this._displayBuffer(h[p],c);this._endFrame()},hi.prototype._displayBuffer=function(e,t){var n=e.getProgram();n!==this._currentProgram&&(this._currentProgram&&this._currentProgram.endPass(),this._currentProgram=n,this._currentProgram.startPass(t)),e.markAsUsed(),e.draw()},hi.prototype._startFrame=function(){for(var e=this._bufferList.getBuffersByAscendingDepth(),t=[],n=0;n<this._glBuffers.length;++n)(r=this._glBuffers[n])&&r.markAsUnused();for(n=0;n<e.length;++n){var i=e[n];(r=this._getAssociatedGlBuffer(i)).markAsUsed(),!i.isEmpty()&&this._isBufferDisplayable(i)&&t.push(r)}for(n=0;n<this._glBuffers.length;++n){var r;(r=this._glBuffers[n])&&!r.isUsed()&&(r.destroy(),this._glBuffers[n]=void 0)}return t},hi.prototype._endFrame=function(){this._currentProgram&&(this._currentProgram.endPass(),this._currentProgram=null)},hi.prototype._getAssociatedGlBuffer=function(e){var t=e.getId(),n=this._glBuffers[t];if(!n){for(;this._glBuffers.length<=t;)this._glBuffers.push(void 0);n=new f0({gl:this._gl,ext:this._ext,staticProgram:this._staticProgram,animationProgram:this._animationProgram}),this._glBuffers[t]=n}return n.setDataBuffer(e),n},hi.prototype.destroy=function(){var e=this._gl.getExtension("WEBGL_lose_context");e&&e.loseContext()},hi.prototype.getImageData=function(){var e=this._glCanvas.width,t=this._glCanvas.height;return(this._2dcanvas.width<e||this._2dcanvas.height<t)&&(this._2dcanvas.width=e,this._2dcanvas.height=t),this._ctx.drawImage(this._glCanvas,0,0),this._ctx.getImageData(0,0,e,t)},hi.prototype._getImageDataFlippedYAxis=function(){var e=this._gl,t=this._glCanvas.width,n=this._glCanvas.height,i=this._ctx.createImageData(t,n),r=new Uint8Array(i.data.buffer);return e.readPixels(0,0,t,n,e.RGBA,e.UNSIGNED_BYTE,r),i},hi);function hi(e){var t=Gp.call(this,e)||this;t._2dcanvas=ci(),t._ctx=t._2dcanvas.getContext("2d"),t._glBuffers=[],t._staticProgram=null,t._animationProgram=null,t._currentProgram=null,t._specialGlBuffers=null,t._shaderMetadata=null,t._mustResize=!1;var n=e.initData||hi.createInitData(),i=n.canvas,r=n.gl,o=n.ext,a=n.staticProgramWrapper,s=n.animationProgramWrapper;return jp(r,"NO_WEBGL"),jp(o,"NO_ANGLE_INSTANCED_ARRAYS"),t._glCanvas=i,t._gl=r,t._ext=o,t._staticProgramWrapper=a,t._animationProgramWrapper=s,t._shapeTexture=new Jy(t._gl,0),t._patternTexture=new e0(t._gl,1),t._initCanvas(t._glCanvas),t._computeShaderInfo(),t._initSpecialGlBuffers(),t._initGlPrograms(),t._initGl(),t}var E0={float:1,vec2:2,vec3:3,vec4:4};function Zp(e,t){for(var n=/(?:attribute\s+\/\*\s*(byte|ubyte|short|ushort|float)\s*\*\/\s*(float|vec2|vec3|vec4)\s+(\w+)\s*;)|(?:#if\s*(\w+))|(?:#endif)/g,i=/uniform\s+(float|vec2|vec3|vec4|sampler2D|int)\s+(\w+)\s*;/g,r=[],o=n.exec(t);o;){var a=o[0];"#endif"===a?r.pop():a.startsWith("#if")?r.push(o[4]):e.attributes.push({name:o[3],size:E0[o[2]],type:o[1],tags:r.slice(),location:null,byteSize:null,glType:null}),o=n.exec(t)}for(o=i.exec(t);o;){if(!e.uniforms.some(function(d){return d.id===o[1]})){var s=o[1],l=o[2],u=l.replace("u_","");e.uniforms.push({id:u,name:l,type:s})}o=i.exec(t)}}var Br=Math.PI,gu=2*Math.PI,Yp=Br*(5/4),Xp=Br*(7/4),Jp=.75*Br,Qp=.25*Br,k0=-Br/2,O0=Br/2,L0={plain:{dash:0,gap:0},dashed:{dash:3,gap:1},dotted:{dash:1,gap:3}},F0={right:0,top:-Math.PI/2,left:Math.PI,bottom:Math.PI/2,center:0},P0={right:Math.PI,top:-Math.PI/2,left:0,bottom:Math.PI/2,center:0};function sl(e,t,n,i,r){var o=1-r;return o*o*o*e+3*r*o*o*t+3*r*r*o*n+r*r*r*i}function Cs(e,t,n,i){var r=1-i;return r*r*e+2*r*i*t+i*i*n}function pa(e,t,n,i,r,o){var a=o||{x:0,y:0},s=(e+n)/2,l=(t+i)/2,u=e-n,d=t-i,c=Math.sqrt(u*u+d*d);if(0===c)return a.x=s,a.y=l,a;var p=-u/c,g=-c*r/5;return a.x=s+d/c*g,a.y=l+p*g,a}function Ya(e,t,n,i,r,o){var a=o||{x1:0,y1:0,x2:0,y2:0},s=5*(i+i/5*n),l=-r+Br,u=Br/2-r;return a.x1=e+Math.cos(l)*s,a.y1=t+Math.sin(l)*s,a.x2=e+Math.cos(u)*s,a.y2=t+Math.sin(u)*s,a}var nf,rf=(St(en,nf=Cd),en.prototype._resetCachePoints=function(){this._nextCachePoint=0},en.prototype._point=function(e,t){var n=this._cachePoints[this._nextCachePoint++];return n||this._cachePoints.push(n={x:0,y:0}),n.x=e,n.y=t,n},en.prototype.setViewportClipping=function(e){this._clipViewport=e},en.prototype._formatAngle=function(e){return e<-Math.PI?e+2*Math.PI:e>Math.PI?e-2*Math.PI:e},en.prototype._computeAnimationRatio=function(e){var r=(this._currentTime-e.beginTime)/e.duration,o=r*r,a=o*r,s=this._easingManager.getCoefficients(e.easing),l=r<.5?0:4;return me(s[l]+s[1+l]*r+s[2+l]*o+s[3+l]*a,0,1)},en.prototype._mixColor=function(e,t,n,i){if(e===t)return e;var r=this._colorManager.parseColor(e),o=r[0],a=r[1],s=r[2],l=r[3],u=this._colorManager.parseColor(t),c=u[1],h=u[2],p=u[3];return"rgba("+Math.round(255*kt(o,u[0],n))+","+Math.round(255*kt(a,c,n))+","+Math.round(255*kt(s,h,n))+","+kt(l,p,i)+")"},en.prototype._displayBuffer=function(e){for(var t=e.getSize(),n=e.isAnimated(),i=0;i<t;++i){var r=this.extractElement(e,i);r.valid&&this._displayElement(r,n)}},en.prototype._mixAttributes=function(e,t,n){var i=this._computeAnimationRatio(n);return e.dashLength=kt(t.dashLength,e.dashLength,i),e.gapLength=kt(t.gapLength,e.gapLength,i),e.offsetAngle=kt(t.offsetAngle,e.offsetAngle,i),e.opacity=kt(t.opacity,e.opacity,i),e.globalMinVisibleSize=kt(t.globalMinVisibleSize,e.globalMinVisibleSize,i),e.strokeMinVisibleSize=kt(t.strokeMinVisibleSize,e.strokeMinVisibleSize,i),e.patternMinVisibleSize=kt(t.patternMinVisibleSize,e.patternMinVisibleSize,i),e.symbolicSize=kt(t.symbolicSize,e.symbolicSize,i),e.curvature=kt(t.curvature,e.curvature,i),e.fillColor=this._mixColor(t.fillColor,e.fillColor,i,i),e.strokeColor=this._mixColor(t.strokeColor,e.strokeColor,i,i),e.patternColor=this._mixColor(t.patternColor,e.patternColor,i,i),e.x1=kt(t.x1,e.x1,i),e.y1=kt(t.y1,e.y1,i),e.x2=kt(t.x2,e.x2,i),e.y2=kt(t.y2,e.y2,i),e.rectWidthOrSourceRadiusScaled=kt(t.rectWidthOrSourceRadiusScaled,e.rectWidthOrSourceRadiusScaled,i),e.rectWidthOrSourceRadiusFixed=kt(t.rectWidthOrSourceRadiusFixed,e.rectWidthOrSourceRadiusFixed,i),e.rectHeightOrTargetRadiusScaled=kt(t.rectHeightOrTargetRadiusScaled,e.rectHeightOrTargetRadiusScaled,i),e.rectHeightOrTargetRadiusFixed=kt(t.rectHeightOrTargetRadiusFixed,e.rectHeightOrTargetRadiusFixed,i),e.thicknessOrFontSizeScaled=kt(t.thicknessOrFontSizeScaled,e.thicknessOrFontSizeScaled,i),e.thicknessOrFontSizeFixed=kt(t.thicknessOrFontSizeFixed,e.thicknessOrFontSizeFixed,i),e.strokeWidthScaled=kt(t.strokeWidthScaled,e.strokeWidthScaled,i),e.strokeWidthFixed=kt(t.strokeWidthFixed,e.strokeWidthFixed,i),e.offsetScaled=kt(t.offsetScaled,e.offsetScaled,i),e.offsetFixed=kt(t.offsetFixed,e.offsetFixed,i),e},en.prototype._computeRenderInfo=function(e){var t=this._viewZoom,n=this._point(e.x1,e.y1),i=this._point(e.x2,e.y2);return{shape:this._shapeManager.getDefinitionFromName(e.shape),pieceId:e.pieceId,dashLength:e.dashLength,gapLength:e.gapLength,hasHead:e.hasHead,hasTail:e.hasTail,isBodyTriangle:e.isBodyTriangle,isSelfLoop:e.isSelfLoop,patternScale:e.patternScale,offsetAngle:this._formatAngle(e.offsetAngle),isText:e.isText,adjustTextAngle:e.adjustTextAngle,unusedFlag1:e.unusedFlag1,unusedFlag2:e.unusedFlag2,unusedFlag3:e.unusedFlag3,opacity:e.opacity,globalMinVisibleSize:e.globalMinVisibleSize,strokeMinVisibleSize:e.strokeMinVisibleSize,patternMinVisibleSize:e.patternMinVisibleSize,symbolicSize:0===e.symbolicSize?1/0:e.symbolicSize*t,curvature:e.curvature,pattern:e.pattern,fillColor:e.fillColor,strokeColor:e.strokeColor,patternColor:e.patternColor,pos1OnGraph:n,pos2OnGraph:i,pos1:this._graphToScreenCoordinates(n),pos2:this._graphToScreenCoordinates(i),rectWidthOrSourceRadius:e.rectWidthOrSourceRadiusScaled*t+e.rectWidthOrSourceRadiusFixed,rectHeightOrTargetRadius:e.rectHeightOrTargetRadiusScaled*t+e.rectHeightOrTargetRadiusFixed,thicknessOrFontSize:e.thicknessOrFontSizeScaled*t+e.thicknessOrFontSizeFixed,strokeWidth:e.strokeWidthScaled*t+e.strokeWidthFixed,offset:e.offsetScaled*t+e.offsetFixed}},en.prototype._applyBackgroundBlending=function(e){1!==e.opacity&&(e.fillColor=this._blendColor(e.fillColor,e.opacity),e.strokeColor=this._blendColor(e.strokeColor,e.opacity),e.textColor=this._blendColor(e.textColor,e.opacity))},en.prototype._pointArray=function(e){var t=this._pointCopies[e];if(!t){t=new Array(e),this._pointCopies[e]=t;for(var n=0;n<e;++n)t[n]={x:0,y:0,r:0}}return t},en.prototype._scalePoints=function(e,t,n,i){for(var r=e.shape.points.length,o=this._pointArray(r),a=0;a<r;++a){var s=e.shape.points[a],l=o[a];l.x=t.x+s.x*n,l.y=t.y+s.y*i,l.r=s.r*n}var u=e.pos2OnGraph.x-e.pos1OnGraph.x,d=e.pos2OnGraph.y-e.pos1OnGraph.y;if(0!=u||0!=d)for(var c=Math.sqrt(u*u+d*d),h=u/c,p=d/c,g=0,m=o;g<m.length;g++){var x=m[g],v=x.x-t.x,y=x.y-t.y;x.x=t.x+h*v+p*y,x.y=t.y-p*v+h*y}return o},en.prototype._drawPoints=function(e){1===e.length?this._drawCircle(e[0],e[0].r):this._drawPolygon(e)},en.prototype._computeCenter=function(e){var t=Math.cos(e.offsetAngle),n=Math.sin(e.offsetAngle);return this._point((e.pos1.x+e.pos2.x)/2+t*e.offset,(e.pos1.y+e.pos2.y)/2+n*e.offset)},en.prototype._displayNodeComponent=function(e,t,n,i){var r=this,o=this._computeCenter(e);if(7!==e.pattern.type){var a=e.rectWidthOrSourceRadius/2,s=e.rectHeightOrTargetRadius/2,l=this._scalePoints(e,o,a,s);if((t||i)&&this._drawPoints(l),t&&this._fill(e.fillColor),i){if(this._startClip(),4===e.pattern.type){var u=e.pattern.attributes.colorArray;1!==e.opacity&&(u=u.map(function(V){return r._blendColor(V,e.opacity)})),this._displayPieChart(o,a,u)}else if(5===e.pattern.type||6===e.pattern.type){var d=0,c=Math.round(e.rectHeightOrTargetRadius*e.patternScale),h=e.pattern.attributes.text,p=e.patternColor,g=e.pattern.attributes.font,m=e.pattern.attributes.style,x=e.pattern.attributes.align,v=e.rectWidthOrSourceRadius;this._displayText(o,d,h,p,g,c,m,x,v)}else if(2===e.pattern.type){var y=e.pattern.attributes.image;if(y.isDummy||y.width&&y.height){var b=e.pattern.attributes.duplicated,S=b?1:e.patternScale;this._displayImage(o,e.rectWidthOrSourceRadius*S,e.rectHeightOrTargetRadius*S,y,e.pattern.attributes.scaled,b,e.opacity)}}this._endClip()}if(n){var P=e.strokeWidth/2,L=this._scalePoints(e,o,a+P,s+P);this._drawPoints(L),this._stroke(e.strokeColor,e.strokeWidth)}}else i&&this._displayText(o,d=0,h=e.pattern.attributes.text,p=e.patternColor,g=e.pattern.attributes.font,c=e.thicknessOrFontSize,m=e.pattern.attributes.style,x=e.pattern.attributes.align,v=e.rectWidthOrSourceRadius)},en.prototype._displayElement=function(e,t){if(e.end.shape&&e.end.pieceId){this._resetCachePoints();var n=t?this._mixAttributes(e.end,e.start,e.animation):e.end,i=this._computeRenderInfo(n);if(!(i.symbolicSize<i.globalMinVisibleSize||0===i.opacity)){this._applyBackgroundBlending(i);var o,s,l,d,c,h,p,g,m,x,S,w,M,N,L=i.strokeColor&&0<i.strokeWidth&&i.symbolicSize>=i.strokeMinVisibleSize,X=!!i.fillColor;if(1===i.pieceId)this._displayNodeComponent(i,X,L,1!==i.pattern.type&&i.symbolicSize>=i.patternMinVisibleSize);else{var J=i.pos2.x-i.pos1.x,se=i.pos2.y-i.pos1.y,re=Math.sqrt(J*J+se*se),j=null,Y=null,he=null;if(i.isSelfLoop){var Ae=this._getSelfLoopControlPoints(i.pos1,i.curvature,5===i.pieceId?i.strokeWidth/2:i.rectWidthOrSourceRadius),at=Ae.x2,We=Ae.y2;j=this._point(Ae.x1,Ae.y1),Y=this._point(at,We),1,S=((g=i.pos1).x+(m=j).x+(x=Y).x)/3-m.x,w=(g.y+m.y+x.y)/3-m.y,M=m.x-x.x,N=m.y-x.y,he=1.9442*Math.sqrt(S*S+w*w-(M*M+N*N)/4)*3.14159265359*1}else he=i.curvature?(j=this._getQuadraticCurveControlPoint(i),o=re,d=.5*.5,c=1/(16*(l=(s=Math.abs(i.curvature)/5+1e-6)*s)),h=Math.sqrt(d+c),p=.5/s*Math.sqrt(.25+l),Math.abs(2*s)*(.5*h+.5*p+c*Math.log(Math.abs((.5+h)/(p-.5))))*o):re;if(5===i.pieceId){var vt=i.strokeWidth,Tt=this._getPointOnLine(i.pos1,j,Y,i.pos2,.5),Ge=this._getTangentOnLine(i.pos1,j,Y,i.pos2,.5);i.adjustTextAngle&&!i.isSelfLoop&&i.rectWidthOrSourceRadius>=he-vt&&(Ge.x=1,Ge.y=0,i.offset=0);var qe=-Math.atan2(Ge.y,Ge.x),Le=this._formatAngle(i.offsetAngle-qe);(!i.isSelfLoop&&Le<0||i.isSelfLoop&&i.offsetAngle<0)&&(Ge.x*=-1,Ge.y*=-1),(qe>Math.PI/2||qe<-Math.PI/2)&&(qe+=Math.PI);var He=this._getOrthogonal(Ge),Je=Tt.x+He.x*i.offset,et=Tt.y+He.y*i.offset;if(i.fillColor){var Te=this._pointArray(4),Re=i.rectWidthOrSourceRadius/2,Ze=i.rectHeightOrTargetRadius/2,Qe=Ge.x*Re,dt=Ge.y*Re,Ht=He.x*Ze,Kt=He.y*Ze,ln=Te[0],an=Te[1],hn=Te[2],W=Te[3];ln.x=Je+Qe+Ht,ln.y=et+dt+Kt,an.x=Je+Qe-Ht,an.y=et+dt-Kt,hn.x=Je-Qe-Ht,hn.y=et-dt-Kt,W.x=Je-Qe+Ht,W.y=et-dt+Kt,this._drawPoints(Te),this._fill(i.fillColor)}else{var Z=this._point(Je,et);this._displayText(Z,qe,i.pattern.attributes.text,i.patternColor,i.pattern.attributes.font,i.thicknessOrFontSize,i.pattern.attributes.style,i.pattern.attributes.align,i.rectWidthOrSourceRadius)}}else{var Be=3===i.pieceId,De=4===i.pieceId,ze=Math.cos(i.offsetAngle),ke=Math.sin(i.offsetAngle);i.pos1.x+=ze*i.offset,i.pos1.y+=ke*i.offset,i.pos2.x+=ze*i.offset,i.pos2.y+=ke*i.offset;var Ne="line"===i.shape.name,we=i.thicknessOrFontSize,Ke=i.rectWidthOrSourceRadius,ut=i.rectHeightOrTargetRadius,Ue=+i.hasHead,je=+i.hasTail,Ve=+i.isBodyTriangle,Ye=3*we,rt=Ue*Ye,bt=je*Ye,Mt=Math.min((i.isSelfLoop?1/0:re-Ke-ut)/(Ue+je),Ye),yt=je*(Ye+Math.max(Ke+Mt-bt,0))+(1-je)*Ve*Ke,Ct=Ue*(Ye+Math.max(ut+Mt-rt,0))+(1-Ue)*Ve*ut;if(Be||De){var nt=De?-1:1,ct=(Be?he-Ct:yt)-nt,xt=null,At=null;if(i.isSelfLoop){var Ut=this._getTFromLengthOnCubicCurve(i.pos1,j,Y,i.pos2,ct-i.strokeWidth/2*nt);xt=this._getPointOnCubicCurve(i.pos1,j,Y,i.pos2,Ut),At=this._getTangentOnCubicCurve(i.pos1,j,Y,i.pos2,Ut)}else At=i.curvature?(Ut=this._getTFromLengthOnQuadraticCurve(i.pos1,j,i.pos2,ct-i.strokeWidth/2*nt),xt=this._getPointOnQuadraticCurve(i.pos1,j,i.pos2,Ut),this._getTangentOnQuadraticCurve(i.pos1,j,i.pos2,Ut)):(xt=this._mixPoints(i.pos1,i.pos2,Ut=ct/he),this._point(J/re,se/re));if(At.x*=nt,At.y*=nt,X){if(i.shape.hole){var Dt=this._makeEdgeExtremityPoints(xt,At,Ye,i.shape.hole);this._drawPoints(Dt),this._startReverseClip()}Te=this._makeEdgeExtremityPoints(xt,At,Ye,i.shape.points),this._drawPoints(Te),this._fill(i.fillColor),i.shape.hole&&this._endReverseClip()}L&&(i.shape.hole&&(Dt=this._makeEdgeExtremityPoints(xt,At,Ye,i.shape.hole),this._drawPoints(Dt),this._stroke(i.strokeColor,i.strokeWidth)),Te=this._makeEdgeExtremityPoints(xt,At,Ye+i.strokeWidth/2,i.shape.points),this._drawPoints(Te),this._stroke(i.strokeColor,i.strokeWidth))}else{if(he-yt-Ct<=0)return;if(Ne){var tn=function(Mn,Zn,nn,pn,Rn,In){var Nn=[];if(nn&&Nn.push(0,nn),Rn&&In){for(var fi=Rn*Zn,xn=In*Zn,br=fi+xn,wi=Mn-pn-nn-br,ni=0;ni<wi;)Nn.push(fi,xn),ni+=br;var er=Mn-pn-nn-ni,ki=Math.min(fi,er),Oi=Math.max(er-ki,0);Nn.push(ki,Oi)}else Nn.push(Mn-pn-nn,0);return pn&&Nn.push(0,pn),Nn}(he,we,yt,Ct,i.dashLength,i.gapLength);L&&(this._drawLine(i.pos1,j,Y,i.pos2),this._stroke(i.strokeColor,we+2*i.strokeWidth,tn)),X&&(this._drawLine(i.pos1,j,Y,i.pos2),this._stroke(i.fillColor,we,tn))}else{var Cn=yt,Dn=he-Ct;L&&(Te=this._makeTriangleEdgeBody(i.pos1,j,Y,i.pos2,Cn,Dn,we+i.strokeWidth/2,i.strokeWidth/2),this._drawPoints(Te),this._stroke(i.strokeColor,i.strokeWidth)),X&&(Te=this._makeTriangleEdgeBody(i.pos1,j,Y,i.pos2,Cn,Dn,we,0),this._drawPoints(Te),this._fill(i.fillColor))}}}}}}},en.prototype._makeTriangleEdgeBody=function(e,t,n,i,r,o,a,s){return t?n?this._makeSelfLoopTriangleEdge(e,t,n,i,r,o,a,s):this._makeCurveTriangleEdge(e,t,i,r,o,a,s):this._makeStraightTriangleEdge(e,i,r,o,a,s)},en.prototype._makeCurveTriangleEdge=function(e,t,n,i,r,o,a){for(var s=this._pointArray(84),l=this._getTFromLengthOnQuadraticCurve(e,t,n,i),u=(this._getTFromLengthOnQuadraticCurve(e,t,n,r)-l)/41,d=(a-o)/41/2,c=o/2,h=l,p=0;p<=41;++p){var g=this._getPointOnQuadraticCurve(e,t,n,h),m=this._getTangentOnQuadraticCurve(e,t,n,h),x=this._getOrthogonal(m),v=x.x*c,y=x.y*c,b=s[p],S=s[83-p];b.x=g.x+v,b.y=g.y+y,S.x=g.x-v,S.y=g.y-y,h+=u,c+=d}return s},en.prototype._makeSelfLoopTriangleEdge=function(e,t,n,i,r,o,a,s){for(var l=this._pointArray(84),u=this._getTFromLengthOnCubicCurve(e,t,n,i,r),d=(this._getTFromLengthOnCubicCurve(e,t,n,i,o)-u)/41,c=(s-a)/41/2,h=a/2,p=u,g=0;g<=41;++g){var m=this._getPointOnCubicCurve(e,t,n,i,p),x=this._getTangentOnCubicCurve(e,t,n,i,p),v=this._getOrthogonal(x),y=v.x*h,b=v.y*h,S=l[g],w=l[83-g];S.x=m.x+y,S.y=m.y+b,w.x=m.x-y,w.y=m.y-b,p+=d,h+=c}return l},en.prototype._makeStraightTriangleEdge=function(e,t,n,i,r,o){var a=t.x-e.x,s=t.y-e.y,l=Math.sqrt(a*a+s*s),u=this._point(a/l,s/l),d=this._getOrthogonal(u),c=r/2,h=o/2,p=this._pointArray(4),g=p[0],m=p[1],x=p[2],v=p[3],y=e.x+u.x*n,b=e.y+u.y*n,S=e.x+u.x*i,w=e.y+u.y*i,M=d.x*c,N=d.y*c,D=d.x*h,P=d.y*h;return g.x=y+M,g.y=b+N,m.x=y-M,m.y=b-N,x.x=S-D,x.y=w-P,v.x=S+D,v.y=w+P,p},en.prototype._makeEdgeExtremityPoints=function(e,t,n,i){for(var r=this._pointArray(i.length),o=n/2,a=e.x+t.x*o,s=e.y+t.y*o,l=t.x,u=t.y,d=0;d<i.length;++d){var c=i[d],h=r[d],g=(u*c.x+l*c.y)*o;h.x=a+(l*c.x-u*c.y)*o,h.y=s+g,h.r=c.r*o}return r},en.prototype._drawLine=function(e,t,n,i){t?n?this._drawCubicCurve(e,t,n,i):this._drawQuadraticCurve(e,t,i):this._drawStraightLine(e,i)},en.prototype._getSelfLoopControlPoints=function(e,t,n){return Ya(e.x,e.y,t,n,this._viewAngle,this._tmp)},en.prototype._getQuadraticCurveControlPoint=function(e){return pa(e.pos1.x,e.pos1.y,e.pos2.x,e.pos2.y,e.curvature,this._point(0,0))},en.prototype._graphToScreenCoordinates=function(e){var i=(e.x-this._viewX)*this._viewZoom,r=(e.y-this._viewY)*this._viewZoom,o=this._viewAngleCos,a=this._viewAngleSin;return this._point(o*i+a*r+this._width/2,-a*i+o*r+this._height/2)},en.prototype._blendColor=function(e,t){return e?this._mixColor(this._backgroundColor,e,t,1):null},en.prototype._getTangentOnLine=function(e,t,n,i,r){return t?n?this._getTangentOnCubicCurve(e,t,n,i,r):this._getTangentOnQuadraticCurve(e,t,i,r):this._getTangentOnStraightLine(e,i)},en.prototype._getTangentOnStraightLine=function(e,t){var n=t.x-e.x,i=t.y-e.y,r=Math.sqrt(n*n+i*i);return this._point(n/r,i/r)},en.prototype._getTangentOnQuadraticCurve=function(e,t,n,i){var r=1-i,o=r*t.x+i*n.x-(r*e.x+i*t.x),a=r*t.y+i*n.y-(r*e.y+i*t.y),s=Math.sqrt(o*o+a*a);return this._point(o/s,a/s)},en.prototype._getTangentOnCubicCurve=function(e,t,n,i,r){var o=1-r,a=o*o,s=r*r,l=a*(t.x-e.x)+2*o*r*(n.x-t.x)+s*(i.x-n.x),u=a*(t.y-e.y)+2*o*r*(n.y-t.y)+s*(i.y-n.y),d=Math.sqrt(l*l+u*u);return this._point(l/d,u/d)},en.prototype._mixPoints=function(e,t,n){var i=kt(e.x,t.x,n),r=kt(e.y,t.y,n);return this._point(i,r)},en.prototype._getOrthogonal=function(e){return this._point(-e.y,e.x)},en.prototype._getPointOnLine=function(e,t,n,i,r){return t?n?this._getPointOnCubicCurve(e,t,n,i,r):this._getPointOnQuadraticCurve(e,t,i,r):this._mixPoints(e,i,r)},en.prototype._getPointOnQuadraticCurve=function(e,t,n,i){var r=Cs(e.x,t.x,n.x,i),o=Cs(e.y,t.y,n.y,i);return this._point(r,o)},en.prototype._getPointOnCubicCurve=function(e,t,n,i,r){var o=sl(e.x,t.x,n.x,i.x,r),a=sl(e.y,t.y,n.y,i.y,r);return this._point(o,a)},en.prototype._getTFromLengthOnCubicCurve=function(e,t,n,i,r){for(var o=e.x,a=e.y,s=0,l=0,u=0;u<41;++u){var d=sl(e.x,t.x,n.x,i.x,s+=1/41),c=sl(e.y,t.y,n.y,i.y,s),h=d-o,p=c-a,g=Math.sqrt(h*h+p*p),m=l+g;if(r<m)return s-1/41*((m-r)/g);l=m,o=d,a=c}return 1},en.prototype._getTFromLengthOnQuadraticCurve=function(e,t,n,i){for(var r=e.x,o=e.y,a=0,s=0,l=0;l<41;++l){var u=Cs(e.x,t.x,n.x,a+=1/41),d=Cs(e.y,t.y,n.y,a),c=u-r,h=d-o,p=Math.sqrt(c*c+h*h),g=s+p;if(i<g)return a-1/41*((g-i)/p);s=g,r=u,o=d}return 1},en);function en(e){var t=nf.call(this,e)||this;return t._cachePoints=[],t._nextCachePoint=0,t._tmp={x1:0,y1:0,x2:0,y2:0},t._pointCopies=Array(128),t._clipViewport=!0,t}var of,D0=!ci().__dummy,R0=(St(pi,of=rf),pi.getName=function(){return"Canvas"},pi.isAvailable=function(){return D0},pi.prototype.getDomElement=function(){return this._canvas},pi.prototype._render=function(e){e.dimensionsChanged&&up(this._canvas,this._width,this._height,this._pixelRatio);var t=this._ctx,n=this._width*this._pixelRatio,i=this._height*this._pixelRatio;t.clearRect(0,0,n,i),this._backgroundColor&&this._renderBackground&&(t.fillStyle=this._backgroundColor,t.fillRect(0,0,n,i));for(var r=this._bufferList.getBuffersByAscendingDepth(),o=0;o<r.length;++o){var a=r[o];this._isBufferDisplayable(a)&&this._displayBuffer(a)}},pi.prototype._drawCircle=function(e,t){var n=this._ctx,i=this._pixelRatio,r=e.x*i,o=e.y*i,a=t*i;n.beginPath(),n.arc(r,o,a,0,2*Math.PI)},pi.prototype._drawPolygon=function(e){var t=this._ctx,n=this._pixelRatio;t.beginPath();var i=e[0];t.moveTo(i.x*n,i.y*n);for(var r=1;r<e.length;++r){var o=e[r];t.lineTo(o.x*n,o.y*n)}t.closePath()},pi.prototype._drawStraightLine=function(e,t){var n=this._ctx,i=this._pixelRatio;n.beginPath(),n.moveTo(e.x*i,e.y*i),n.lineTo(t.x*i,t.y*i)},pi.prototype._drawQuadraticCurve=function(e,t,n){var i=this._ctx,r=this._pixelRatio;i.beginPath(),i.moveTo(e.x*r,e.y*r),i.quadraticCurveTo(t.x*r,t.y*r,n.x*r,n.y*r)},pi.prototype._drawCubicCurve=function(e,t,n,i){var r=this._ctx,o=this._pixelRatio;r.beginPath(),r.moveTo(e.x*o,e.y*o),r.bezierCurveTo(t.x*o,t.y*o,n.x*o,n.y*o,i.x*o,i.y*o)},pi.prototype._fill=function(e){var t=this._ctx;t.fillStyle=e,t.fill()},pi.prototype._stroke=function(e,t,n){var i=this;void 0===n&&(n=[]);var r=this._ctx;r.setLineDash(n.map(function(o){return o*i._pixelRatio})),r.lineWidth=t,r.strokeStyle=e,r.stroke()},pi.prototype._startClip=function(){this._ctx.save(),this._ctx.clip()},pi.prototype._endClip=function(){this._ctx.restore()},pi.prototype._startReverseClip=function(){this._ctx.save(),this._ctx.rect(0,0,this._canvas.width,this._canvas.height),this._ctx.clip("evenodd")},pi.prototype._endReverseClip=function(){this._ctx.restore()},pi.prototype._displayText=function(e,t,n,i,r,o,a,s,l){var u=this._ctx,d=this._pixelRatio,c=e.x*d,h=e.y*d,p=o*d,g="center"===s?0:-l/2;if(u.save(),u.translate(c,h),u.rotate(-t),u.textAlign=s,u.textBaseline="middle",da(u,r,p,a),u.fillStyle=i,-1!==n.indexOf("\n"))for(var m=n.split("\n"),x=m.length,v=(1-x)/2*p,y=0;y<x;++y)u.fillText(m[y],g,v),v+=p;else u.fillText(n,g,-1);u.restore()},pi.prototype._displayImage=function(e,t,n,i,r,o,a){if(!this._hideImages&&!("isDummy"in i)){var s=i;1!==a&&(s=this._blendImageOnBackground(i,a));var l=this._ctx,u=this._pixelRatio,d=e.x*u,c=e.y*u,h=t*u,p=n*u,g=s.width*u,m=s.height*u;if(r)l.drawImage(s,d-h/2,c-p/2,h,p);else if(o){for(var x=d-h/2,v=c-p/2,y=d+h/2,b=c+p/2,S=d-g/2,w=c-m/2;x<S;)S-=g;for(;v<w;)w-=m;for(var M=w;S<y;){for(;w<b;)l.drawImage(s,S,w,g,m),w+=m;S+=g,w=M}}else l.drawImage(s,d-g/2,c-m/2,g,m)}},pi.prototype._displayPieChart=function(e,t,n){var i=this._ctx,r=this._pixelRatio,o=e.x*r,a=e.y*r,s=t*r*2,l=2*s;1===n.length?(i.fillStyle=n[0],i.fillRect(o-s,a-s,l,l)):2===n.length?(i.fillStyle=n[0],i.fillRect(o-s,a,l,s),i.fillStyle=n[1],i.fillRect(o-s,a-s,l,s)):mp(i,n,o,a,s)},pi.prototype._blendImageOnBackground=function(e,t){var n=this._backgroundRgba,i="rgb("+Math.round(255*n[0])+","+Math.round(255*n[1])+","+Math.round(255*n[2])+")";return this._imgCanvas.width=e.width,this._imgCanvas.height=e.height,this._imgCtx.clearRect(0,0,e.width,e.height),this._imgCtx.globalAlpha=1,this._imgCtx.fillStyle=i,this._imgCtx.fillRect(0,0,e.width,e.height),this._imgCtx.globalAlpha=t,this._imgCtx.drawImage(e,0,0),this._imgCanvas},pi.prototype.getImageData=function(){return this._ctx.getImageData(0,0,this._canvas.width,this._canvas.height)},pi);function pi(e){var t=of.call(this,e)||this;return t._canvas=ci(),t._imgCanvas=ci(),t._initCanvas(t._canvas),t._ctx=t._canvas.getContext("2d"),t._imgCtx=t._imgCanvas.getContext("2d"),t}var af=[1/0,1/0,-1/0,-1/0];function Zd(e,t,n,i,r,o){void 0===o&&(o={x:0,y:0});var a=Math.cos(r),s=Math.sin(r),l=e-n,u=t-i;return o.x=a*l-s*u+n,o.y=s*l+a*u+i,o}function yi(e,t,n,i){return Math.sqrt((e-n)*(e-n)+(t-i)*(t-i))}function ul(e,t,n,i){var r=e-n,o=t-i;return r*r+o*o}function sf(e){return 180*e/Math.PI}var uf=!1;try{uf=!!fn("svg")}catch(e){}var ll="none",z0={left:"start",center:"middle",right:"end"},no="data-element-id";function Xa(e){return Math.round(1e3*e)/1e3}function lf(e,t,n,i,r,o){var a=fn("image");return a.setAttribute("width",Xa(i)),a.setAttribute("height",Xa(r)),a.setAttribute("x",Xa(t)),a.setAttribute("y",Xa(n)),a.setAttribute("href",e),o&&o.appendChild(a),a}function qd(e,t,n,i,r,o,a){void 0===o&&(o=1);var s=fn("rect");return s.setAttribute("x",e),s.setAttribute("y",t),s.setAttribute("width",n),s.setAttribute("height",i),s.setAttribute("fill",r),s.setAttribute("fill-opacity",o),a&&a.appendChild(s),s}var Hd,B0=(St(oi,Hd=rf),oi.getName=function(){return"SVG"},oi.isAvailable=function(){return uf},oi.prototype.getDomElement=function(){return this._svg},oi.prototype._render=function(e){if(e.dimensionsChanged&&ea(this._svg,{width:this._width,height:this._height}),this._backgroundColor&&this._renderBackground){var t=this._colorManager.rgbaToRgb(this._backgroundColor);this._background.setAttribute("fill",t.color),this._background.setAttribute("fill-opacity",t.opacity)}var n=this._bufferList.getBuffersByAscendingDepth();this._clear(),this._svg.removeChild(this._container);for(var i=0;i<n.length;++i){var r=n[i];this._isBufferDisplayable(r)&&this._displayBuffer(r)}this._svg.appendChild(this._container)},oi.prototype._clear=function(){this._container&&this._svg.removeChild(this._container),this._container=fn("g"),this._svg.appendChild(this._container),this._clipPaths&&this._defs.removeChild(this._clipPaths),this._clipPaths=fn("g"),this._defs.appendChild(this._clipPaths),this._filters&&this._defs.removeChild(this._filters),this._filters=fn("g"),this._defs.appendChild(this._filters)},oi.prototype._displayElement=function(e,t){this._currentElementId=0<=e.id?"n"+e.id:"e"+-e.id,Hd.prototype._displayElement.call(this,e,t)},oi.prototype._addBackgroundBlendingFilter=function(e){var t=this._colorManager.parseColor(this._backgroundColor),n=1-e,i=[e,0,0,0,t[0]*n,0,e,0,0,t[1]*n,0,0,e,0,t[2]*n,0,0,0,1,0].join(" "),r="filter-"+this._currentElementId,o=fn("filter",{id:r}),a=fn("feColorMatrix",{in:"SourceGraphic",type:"matrix",values:i});return o.appendChild(a),this._filters.appendChild(o),r},oi.prototype._drawCircle=function(e,t){var n="M "+(e.x-t)+", "+e.y+" a "+t+","+t+" 0 1,0 "+2*t+",0 a "+t+","+t+" 0 1,0 -"+2*t+",0",i=fn("path");i.setAttribute("d",n),i.setAttribute("fill",ll),i.setAttribute(no,this._currentElementId),this._container.appendChild(i),this._element=i},oi.prototype._drawPolygon=function(e){for(var t=fn("path"),n="",i=0;i<e.length;i++){var r=e[i];n+=(0===i?"M":"L")+r.x+","+r.y+" "}t.setAttribute("d",n+="Z"),t.setAttribute(no,this._currentElementId),t.setAttribute("fill",ll),this._container.appendChild(t),this._element=t},oi.prototype._drawStraightLine=function(e,t){var n=fn("path");n.setAttribute("d","M "+e.x+","+e.y+" L"+t.x+","+t.y),n.setAttribute(no,this._currentElementId),this._container.appendChild(n),this._element=n},oi.prototype._drawQuadraticCurve=function(e,t,n){var i=fn("path");i.setAttribute("d","M "+e.x+","+e.y+" Q"+t.x+","+t.y+" "+n.x+","+n.y),i.setAttribute("fill",ll),i.setAttribute(no,this._currentElementId),this._container.appendChild(i),this._element=i},oi.prototype._drawCubicCurve=function(e,t,n,i){var r=fn("path");r.setAttribute("d","M "+e.x+","+e.y+" C"+t.x+","+t.y+" "+n.x+","+n.y+" "+i.x+","+i.y),r.setAttribute("fill",ll),r.setAttribute(no,this._currentElementId),this._container.appendChild(r),this._element=r},oi.prototype._fill=function(e){var t=this._colorManager.rgbaToRgb(e);this._element.setAttribute("fill",t.color),this._element.setAttribute("fill-opacity",t.opacity),this._currentClipPathId&&this._element.setAttribute("clip-path","url(#"+this._currentClipPathId+")")},oi.prototype._stroke=function(e,t,n){void 0===n&&(n=[]);var i=this._element;i.setAttribute("stroke-width",t);var r=this._colorManager.rgbaToRgb(e);i.setAttribute("stroke",r.color),i.setAttribute("stroke-opacity",r.opacity),0<n.length&&i.setAttribute("stroke-dasharray",n.map(Xa).toString())},oi.prototype._startClip=function(){var e=fn("clipPath"),t=this._element.cloneNode(!1);this._currentClipPathId="clip-path-"+this._clipPathCounter++,e.appendChild(t),this._clipPaths.appendChild(e),e.setAttribute("id",this._currentClipPathId)},oi.prototype._endClip=function(){this._currentClipPathId=null},oi.prototype._startReverseClip=function(){var e=fn("clipPath"),t=this._element.cloneNode(!1),n=t.getAttribute("d");t.setAttribute("clip-rule","evenodd"),t.setAttribute("d",n+" M 0 0 L "+this._width+" 0 L "+this._width+" "+this._height+" L 0 "+this._height),this._currentClipPathId="clip-path-"+this._clipPathCounter++,e.appendChild(t),this._clipPaths.appendChild(e),e.setAttribute("id",this._currentClipPathId)},oi.prototype._endReverseClip=function(){this._currentClipPathId=null},oi.prototype._displayText=function(e,t,n,i,r,o,a,s,l){var u=fn("text");u.setAttribute(no,this._currentElementId);var d=this._colorManager.rgbaToRgb(i),c=d.opacity,h=this._colorManager.rgbaToRgb(d.color),p=e.x,g=e.y;a=a||"normal";var m=Xa(p);u.setAttribute("x",m),u.setAttribute("font-family",r),u.setAttribute("font-size",o),u.setAttribute("bold"===a?"font-weight":"font-style",a),u.setAttribute("fill",h.color),u.setAttribute("fill-opacity",c),t&&u.setAttribute("transform","rotate("+sf(-t)+" "+p+", "+g+")"),u.setAttribute("text-anchor",z0[s]||"middle");var x=n.split("\n"),v=x.length;u.setAttribute("y",Xa(g-((v+1)/2-1/3)*o));for(var b=0;b<v;b++){var S=fn("tspan");S.appendChild(Ti(x[b])),S.setAttribute("x",m),S.setAttribute("dy",o),u.appendChild(S)}this._currentClipPathId&&u.setAttribute("clip-path","url(#"+this._currentClipPathId+")"),this._container.appendChild(u)},oi.prototype._displayImage=function(e,t,n,i,r,o,a){var s=e.x,l=e.y;if(!this._hideImages&&("isDummy"in i||i.width&&i.height)){var u,d=i.width,c=i.height;if(r&&(d=t,c=n),o){var h=s-t/2,p=l-n/2,g=s+t/2,m=l+n/2,x=s-d/2,v=l-c/2;for((u=fn("g")).setAttribute(no,this._currentElementId);h<x;)x-=d;for(;p<v;)v-=c;for(var y=v;x<g;){for(;v<m;)lf(i.src,x,v,d,c,u),v+=c;v=y,x+=d}}else(u=lf(i.src,s-d/2,l-c/2,d,c)).setAttribute(no,this._currentElementId);if(this._currentClipPathId&&u.setAttribute("clip-path","url(#"+this._currentClipPathId+")"),1!==a){var b=this._addBackgroundBlendingFilter(a);u.setAttribute("filter","url(#"+b+")")}this._container.appendChild(u)}},oi.prototype._displayPieChart=function(e,t,n){var i,r=2*t,o=2*r,a=e.x,s=e.y,l=fn("g");l.setAttribute(no,this._currentElementId),1===n.length?i=qd(a-r,s-r,o,o,n[0],1,l):2===n.length?(i=qd(a-r,s,o,r,n[0],1,l),i=qd(a-r,s-r,o,r,n[1],1,l)):_p(n,function(u,d,c){var h=a+t*Math.cos(c),p=s+t*Math.sin(c),g=a+t*Math.cos(d),m=s+t*Math.sin(d),x=c-d<=Math.PI?0:1,v="M "+h+","+p+" A "+t+","+t+" 0 "+x+" 0 "+g+","+m+" L "+a+","+s+" L "+h+","+p;(i=fn("path")).setAttribute("d",v),i.setAttribute("fill",u),i.setAttribute("stroke-width",0),l.appendChild(i)}),this._currentClipPathId&&l.setAttribute("clip-path","url(#"+this._currentClipPathId+")"),this._container.appendChild(l)},oi);function oi(e){var t=Hd.call(this,e)||this;return t._svg=fn("svg"),t._defs=fn("defs"),t._styles=fn("g",{class:"styles"}),t._background=fn("rect",{width:"100%",height:"100%",fill:"none",class:"ogma-svg-background"}),t._currentElementId="0",t._currentClipPathId=null,t._clipPathCounter=1,t._defs.appendChild(t._styles),t._svg.setAttribute("pointer-events","none"),t._svg.style.userSelect="none",t._svg.appendChild(t._defs),t._svg.appendChild(t._background),t._clear(),t}var V0=(Ts.prototype.reset=function(){this._initialize()},Ts.prototype._initialize=function(){this._mustUpdate=!0,this.maxCoord=0,this.maxScaledSize=0,this.maxMinVisibleSize=0,this.maxSymbolicSize=0,this.maxDashLength=0,this.maxGapLength=0,this.maxPatternScale=0},Ts.prototype.set=function(e){var t=e.maxCoord,n=e.maxScaledSize,i=e.maxMinVisibleSize,r=e.maxSymbolicSize,o=e.maxDashLength,a=e.maxGapLength,s=e.maxPatternScale,l=this.maxCoord<t||this.maxScaledSize<n||this.maxMinVisibleSize<i||this.maxSymbolicSize<r||this.maxDashLength<o||this.maxGapLength<a||this.maxPatternScale<s;return l&&(this.maxCoord=t,this.maxScaledSize=n,this.maxMinVisibleSize=i,this.maxSymbolicSize=r,this.maxDashLength=o,this.maxGapLength=a,this.maxPatternScale=s,this._mustUpdate=!0),l},Ts.prototype.update=function(){return this._mustUpdate&&(this._version+=1,this._mustUpdate=!1),this},Ts.prototype.getVersion=function(){return this._version},Ts);function Ts(){this._version=0,this._initialize()}var U0={linear:[0,1,0,0],quadraticIn:[0,0,1,0],quadraticOut:[0,2,-1,0],quadraticInOut:[0,0,2,0,-1,4,-2,0],cubicIn:[0,0,0,1],cubicOut:[0,3,-3,1],cubicInOut:[0,0,0,4,-3,12,-12,4]},j0=(dl.prototype.add=function(e){var t=this;Object.keys(e).forEach(function(n){var i=e[n].slice();i.length<8&&(i[4]=i[0],i[5]=i[1],i[6]=i[2],i[7]=i[3]);var r=Jr(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]);t._nameToPolygon[n]=i,t._polygonToName[r]=n})},dl.prototype.getCoefficients=function(e){return this._nameToPolygon[e]||this._linearEasing},dl.prototype.getName=function(e,t,n,i,r,o,a,s){var l=Jr(e,t,n,i,r,o,a,s);return this._polygonToName[l]||"linear"},dl);function dl(){this._linearEasing=[0,1,0,0,0,1,0,0],this._nameToPolygon={},this._polygonToName={},this.add(U0)}var G0=(jn.prototype.resizeBoundaries=function(e,t,n,i,r,o){this._maxScaledSize=e,this._maxMinVisibleSize=t,this._maxSymbolicSize=n,this._maxDashLength=i,this._maxGapLength=r,this._maxPatternScale=o,this._actualScaledSizeToBytes=65535/e,this._actualMinVisibleSizeToBytes=15/t,this._actualSymbolicSizeToBytes=255/n,this._actualDashLengthToBytes=3/i,this._actualGapLengthToBytes=3/r,this._actualPatternScaleToBytes=255/o},jn.prototype.storeGenericObject=function(e,t,n){var i=this._shapeManager.getIdFromName(n.shape),r=n.pieceId,o=this._dashLengthToBytes(n.dashLength),a=this._gapLengthToBytes(n.gapLength),s=+n.hasHead,l=+n.hasTail,u=+n.isBodyTriangle,d=+n.isSelfLoop,c=this._patternScaleToBytes(n.patternScale),h=this._offsetAngleToBytes(n.offsetAngle),p=+n.isText,g=+n.adjustTextAngle,m=+n.unusedFlag1,x=+n.unusedFlag2,v=+n.unusedFlag3,y=this._opacityToBytes(n.opacity),b=this._minVisibleSizeToBytes(n.globalMinVisibleSize),S=this._minVisibleSizeToBytes(n.strokeMinVisibleSize),w=this._minVisibleSizeToBytes(n.patternMinVisibleSize),M=this._symbolicSizeToBytes(n.symbolicSize),N=this._curvatureToBytes(n.curvature),D=this._patternManager.getIdFromDefinition(n.pattern),P=this._colorToBytes(n.fillColor),L=this._colorToBytes(n.strokeColor),V=this._colorToBytes(n.patternColor),X=this._coordToBytes(n.x1),J=this._coordToBytes(n.y1),se=this._coordToBytes(n.x2),re=this._coordToBytes(n.y2),j=this._scaledSizeToBytes(n.rectWidthOrSourceRadiusScaled),Y=this._fixedSizeToBytes(n.rectWidthOrSourceRadiusFixed),he=this._scaledSizeToBytes(n.rectHeightOrTargetRadiusScaled),pe=this._fixedSizeToBytes(n.rectHeightOrTargetRadiusFixed),Ae=this._scaledSizeToBytes(n.thicknessOrFontSizeScaled),Ie=this._fixedSizeToBytes(n.thicknessOrFontSizeFixed),ot=this._scaledSizeToBytes(n.strokeWidthScaled),at=this._fixedSizeToBytes(n.strokeWidthFixed),We=this._scaledSizeToBytes(n.offsetScaled),vt=this._fixedSizeToBytes(n.offsetFixed),Ge=c+(h<<8)+(p<<11)+(g<<12)+(m<<13)+(x<<14)+(v<<15),qe=y+(b<<4)+(S<<8)+(w<<12),Le=M+(N<<8);this._setUint16(e,t+0,i+(r<<4)+(o<<8)+(a<<10)+(s<<12)+(l<<13)+(u<<14)+(d<<15)),this._setUint16(e,t+2,Ge),this._setUint16(e,t+4,qe),this._setUint16(e,t+6,Le),this._setUint16(e,t+8,D),this._setUint16(e,t+10,P),this._setUint16(e,t+12,L),this._setUint16(e,t+14,V),this._setFloat32(e,t+16,X),this._setFloat32(e,t+20,J),this._setFloat32(e,t+24,se),this._setFloat32(e,t+28,re),this._setUint16(e,t+32,j),this._setUint16(e,t+34,Y),this._setUint16(e,t+36,he),this._setUint16(e,t+38,pe),this._setUint16(e,t+40,Ae),this._setUint16(e,t+42,Ie),this._setUint16(e,t+44,ot),this._setUint16(e,t+46,at),this._setUint16(e,t+48,We),this._setUint16(e,t+50,vt)},jn.prototype._setUint16=function(e,t,n){e.setUint16(t,n,this._littleEndian)},jn.prototype._setFloat32=function(e,t,n){e.setFloat32(t,n,this._littleEndian)},jn.prototype._colorToBytes=function(e){var t=this._colorParser(e);return Math.round(15*t[0])+(Math.round(15*t[1])<<4)+(Math.round(15*t[2])<<8)+(Math.round(15*t[3])<<12)},jn.prototype._coordToBytes=function(e){return e},jn.prototype._scaledSizeToBytes=function(e){return Math.ceil(Math.min(e,this._maxScaledSize)*this._actualScaledSizeToBytes)},jn.prototype._fixedSizeToBytes=function(e){return e},jn.prototype._minVisibleSizeToBytes=function(e){return Math.round(Math.min(e,this._maxMinVisibleSize)*this._actualMinVisibleSizeToBytes)},jn.prototype._symbolicSizeToBytes=function(e){return Math.round(Math.min(e,this._maxSymbolicSize)*this._actualSymbolicSizeToBytes)},jn.prototype._dashLengthToBytes=function(e){return Math.round(Math.min(e,this._maxDashLength)*this._actualDashLengthToBytes)},jn.prototype._gapLengthToBytes=function(e){return Math.round(Math.min(e,this._maxGapLength)*this._actualGapLengthToBytes)},jn.prototype._patternScaleToBytes=function(e){return Math.round(Math.min(e,this._maxPatternScale)*this._actualPatternScaleToBytes)},jn.prototype._offsetAngleToBytes=function(e){return Math.round((e+gu)%gu*(8/gu))},jn.prototype._opacityToBytes=function(e){return Math.round(15*Math.min(e,1))},jn.prototype._curvatureToBytes=function(e){return this._signedToUnsignedByte(e)},jn.prototype._signedToUnsignedByte=function(e){return me(e,-128,127)+128},jn.prototype.storeAnimationInformation=function(e,t,n,i){var o=n.duration;this._setAnimationBeginTime(e,t,n.beginTime),this._setAnimationDuration(e,t,o),this._setAnimationEasing(e,t,i)},jn.prototype._setAnimationBeginTime=function(e,t,n){this._setFloat32(e,t,n)},jn.prototype._setAnimationDuration=function(e,t,n){this._setFloat32(e,t+4,n)},jn.prototype._setAnimationEasing=function(e,t,n){this._setUint16(e,t+8,(n[0]+128<<8)+(n[4]+128)),this._setUint16(e,t+10,(n[1]+128<<8)+(n[5]+128)),this._setUint16(e,t+12,(n[2]+128<<8)+(n[6]+128)),this._setUint16(e,t+14,(n[3]+128<<8)+(n[7]+128))},jn.prototype.extractGenericElement=function(e,t,n){var i=e.getElementType(),r=e.isAnimated(),o=e.getDataView(),a=t*e.getElementSize(),s=this._genericObject;if(s.valid=!1,o.getUint16(a)&&(s.valid=!0,this._extractGenericObject(s.end,o,a,n),r&&(this._extractGenericObject(s.start,o,52+a,n),this._extractAnimationInformation(s.animation,o,104+a)),s.id=this._idRecorder.get(e,t),2===i)){var l=e.getSideDataView(),u=t*e.getTotalSideElementsSize(),d=u+e.getTotalSideElementsSize();this._extractTextCharacters(s.end,l,u,d)}return s},jn.prototype._extractGenericObject=function(e,t,n,i){var r=i.bytesToActualCoord,o=i.bytesToActualScaledSize,a=i.bytesToActualMinVisibleSize,s=i.bytesToActualPatternScale,l=i.bytesToActualSymbolicSize,u=i.bytesToActualDashLength,d=i.bytesToActualGapLength,c=t,h=n,p=this._littleEndian,g=c.getUint16(h,p),m=Yn(g,0,4),x=Yn(g,4,8),v=Yn(g,8,10),y=Yn(g,10,12),b=Yn(g,12,13),S=Yn(g,13,14),w=Yn(g,14,15),M=Yn(g,15,16),N=c.getUint16(h+2,p),D=Yn(N,0,8),P=Yn(N,8,11),L=Yn(N,11,12),V=Yn(N,12,13),X=Yn(N,13,14),J=Yn(N,14,15),se=Yn(N,15,16),re=c.getUint16(h+4,p),j=Yn(re,0,4),Y=Yn(re,4,8),he=Yn(re,8,12),pe=Yn(re,12,16),Ae=c.getUint16(h+6,p),Ie=Yn(Ae,0,8),ot=Yn(Ae,8,16),at=c.getUint16(h+8,p),We=c.getUint16(h+10,p),vt=c.getUint16(h+12,p),Tt=c.getUint16(h+14,p),Ge=c.getFloat32(h+16,p),qe=c.getFloat32(h+20,p),Le=c.getFloat32(h+24,p),He=c.getFloat32(h+28,p),Je=c.getUint16(h+32,p),et=c.getUint16(h+34,p),Te=c.getUint16(h+36,p),Re=c.getUint16(h+38,p),Ze=c.getUint16(h+40,p),Qe=c.getUint16(h+42,p),dt=c.getUint16(h+44,p),Ht=c.getUint16(h+46,p),Kt=c.getUint16(h+48,p),ln=c.getUint16(h+50,p);e.pieceId=x,e.shape=this._shapeManager.getNameFromId(m),e.x1=Vr(Ge,r),e.y1=Vr(qe,r),e.x2=Vr(Le,r),e.y2=Vr(He,r),e.rectWidthOrSourceRadiusScaled=Vr(Je,o),e.rectWidthOrSourceRadiusFixed=et,e.rectHeightOrTargetRadiusScaled=Vr(Te,o),e.rectHeightOrTargetRadiusFixed=Re,e.thicknessOrFontSizeScaled=Vr(Ze,o),e.thicknessOrFontSizeFixed=Qe,e.strokeWidthScaled=Vr(dt,o),e.strokeWidthFixed=Ht,e.offsetScaled=Vr(Kt,o),e.offsetFixed=ln,e.pattern=this._patternManager.getDefinitionFromId(at),e.opacity=j/15,e.fillColor=Wd(We),e.strokeColor=Wd(vt),e.patternColor=Wd(Tt),e.globalMinVisibleSize=Vr(Y,a),e.strokeMinVisibleSize=Vr(he,a),e.patternMinVisibleSize=Vr(pe,a),e.offsetAngle=P*(2*Math.PI/8),e.patternScale=D*s,e.symbolicSize=Ie*l,e.curvature=ot-128,e.dashLength=v*u,e.gapLength=y*d,e.hasHead=!!b,e.hasTail=!!S,e.isBodyTriangle=!!w,e.isSelfLoop=!!M,e.isText=!!L,e.adjustTextAngle=!!V,e.unusedFlag1=!!X,e.unusedFlag2=!!J,e.unusedFlag3=!!se},jn.prototype._extractAnimationInformation=function(e,t,n){var i=t,r=n,o=this._littleEndian,a=i.getFloat32(r,o),s=i.getFloat32(r+4,o),l=i.getUint16(r+8,o),u=i.getUint16(r+10,o),d=i.getUint16(r+12,o),c=i.getUint16(r+14,o),h=(l>>8)-128,p=(u>>8)-128,g=(d>>8)-128,m=(c>>8)-128,x=l%256-128,v=u%256-128,y=d%256-128,b=c%256-128;e.beginTime=a,e.duration=s,e.easing=this._easingManager.getName(h,p,g,m,x,v,y,b)},jn.prototype._extractTextCharacters=function(e,t,n,i){e.pattern=this._textManager.extractTextFromDataView(t,n,i)},jn);function jn(e,t,n,i,r,o){this._littleEndian=fr(),this._maxScaledSize=0,this._maxMinVisibleSize=0,this._maxSymbolicSize=0,this._maxDashLength=0,this._maxGapLength=0,this._maxPatternScale=0,this._actualScaledSizeToBytes=32767,this._actualMinVisibleSizeToBytes=15,this._actualSymbolicSizeToBytes=255,this._actualDashLengthToBytes=3,this._actualGapLengthToBytes=3,this._actualPatternScaleToBytes=255,this._genericObject={valid:!1,id:void 0,end:{pieceId:0,shape:"circle",x1:0,y1:0,x2:0,y2:0,rectWidthOrSourceRadiusScaled:0,rectWidthOrSourceRadiusFixed:0,rectHeightOrTargetRadiusScaled:0,rectHeightOrTargetRadiusFixed:0,thicknessOrFontSizeScaled:0,thicknessOrFontSizeFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,offsetScaled:0,offsetFixed:0,pattern:{id:void 0,type:0,attributes:{}},opacity:1,fillColor:null,strokeColor:null,patternColor:null,globalMinVisibleSize:0,strokeMinVisibleSize:0,patternMinVisibleSize:0,offsetAngle:0,patternScale:0,symbolicSize:-1,curvature:0,dashLength:0,gapLength:0,hasHead:!1,hasTail:!1,isBodyTriangle:!1,isSelfLoop:!1,isText:!1,adjustTextAngle:!1,unusedFlag1:!1,unusedFlag2:!1,unusedFlag3:!1},start:{pieceId:0,shape:"circle",x1:0,y1:0,x2:0,y2:0,rectWidthOrSourceRadiusScaled:0,rectWidthOrSourceRadiusFixed:0,rectHeightOrTargetRadiusScaled:0,rectHeightOrTargetRadiusFixed:0,thicknessOrFontSizeScaled:0,thicknessOrFontSizeFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,offsetScaled:0,offsetFixed:0,pattern:{id:void 0,type:0,attributes:{}},opacity:1,fillColor:null,strokeColor:null,patternColor:null,globalMinVisibleSize:0,strokeMinVisibleSize:0,patternMinVisibleSize:0,offsetAngle:0,patternScale:0,symbolicSize:-1,curvature:0,dashLength:0,gapLength:0,hasHead:!1,hasTail:!1,isBodyTriangle:!1,isSelfLoop:!1,isText:!1,adjustTextAngle:!1,unusedFlag1:!1,unusedFlag2:!1,unusedFlag3:!1},animation:{duration:0,beginTime:-1,easing:"linear"}},this._shapeManager=t,this._patternManager=e,this._textManager=n,this._idRecorder=i,this._easingManager=r,this._colorParser=o}function Yn(e,t,n){return e%(1<<n)>>t}function Vr(e,t){return e*t}var df=new Array(65535);function Wd(e){var t=df[e];if(!t){var n=Yn(e,0,4)/15,i=Yn(e,4,8)/15,r=Yn(e,8,12)/15,o=Yn(e,12,16)/15;t="rgba("+(255*n|0)+", "+(255*i|0)+", "+(255*r|0)+", "+o+")",n+i+r+o==0&&(t=null),df[e]=t}return t}var Z0=(ji.prototype.setDepth=function(e){return this._depth=e,this},ji.prototype.reset=function(e,t,n,i){return this._elementType=e,this._animated=t,this._depth=n,this._id=i,this._stencilUsage=1,this._size=0,this},ji.prototype.setStencilUsage=function(e){this._stencilUsage=e},ji.prototype.next=function(){if(this._size>=this._capacity)throw new Error("internal error: block.next() was called on a full block");return this._list[this._size++]},ji.prototype.nextAndReset=function(){var e,t=this.next();return sp(t.end),sp(t.start),(e=t.animation).duration=0,e.beginTime=-1,e.easing="linear",t},ji.prototype.forEach=function(e){this._list.forEach(e)},ji.prototype.getElement=function(e){return this._list[e]},ji.prototype.getCurrentElement=function(){return this._list[this._size-1]},ji.prototype.getSize=function(){return this._size},ji.prototype.getDepth=function(){return this._depth},ji.prototype.getElements=function(){return this._list},ji.prototype.getType=function(){return this._elementType},ji.prototype.getId=function(){return this._id},ji.prototype.isAnimated=function(){return this._animated},ji.prototype.getStencilUsage=function(){return this._stencilUsage},ji.prototype.setGlobalAnimation=function(e,t,n){for(var i=0;i<this._size;++i){var r=this._list[i].animation;r.duration=e,r.beginTime=t,r.easing=n}},ji);function ji(){this._elementType=1,this._animated=!1,this._size=0,this._capacity=128,this._depth=0,this._id=0,this._stencilUsage=1,this._list=Array(this._capacity);for(var e=0;e<this._capacity;++e)this._list[e]={valid:!1,id:void 0,end:{pieceId:0,shape:"circle",x1:0,y1:0,x2:0,y2:0,rectWidthOrSourceRadiusScaled:0,rectWidthOrSourceRadiusFixed:0,rectHeightOrTargetRadiusScaled:0,rectHeightOrTargetRadiusFixed:0,thicknessOrFontSizeScaled:0,thicknessOrFontSizeFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,offsetScaled:0,offsetFixed:0,pattern:{id:void 0,type:0,attributes:{}},opacity:1,fillColor:null,strokeColor:null,patternColor:null,globalMinVisibleSize:0,strokeMinVisibleSize:0,patternMinVisibleSize:0,offsetAngle:0,patternScale:0,symbolicSize:-1,curvature:0,dashLength:0,gapLength:0,hasHead:!1,hasTail:!1,isBodyTriangle:!1,isSelfLoop:!1,isText:!1,adjustTextAngle:!1,unusedFlag1:!1,unusedFlag2:!1,unusedFlag3:!1},start:{pieceId:0,shape:"circle",x1:0,y1:0,x2:0,y2:0,rectWidthOrSourceRadiusScaled:0,rectWidthOrSourceRadiusFixed:0,rectHeightOrTargetRadiusScaled:0,rectHeightOrTargetRadiusFixed:0,thicknessOrFontSizeScaled:0,thicknessOrFontSizeFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,offsetScaled:0,offsetFixed:0,pattern:{id:void 0,type:0,attributes:{}},opacity:1,fillColor:null,strokeColor:null,patternColor:null,globalMinVisibleSize:0,strokeMinVisibleSize:0,patternMinVisibleSize:0,offsetAngle:0,patternScale:0,symbolicSize:-1,curvature:0,dashLength:0,gapLength:0,hasHead:!1,hasTail:!1,isBodyTriangle:!1,isSelfLoop:!1,isText:!1,adjustTextAngle:!1,unusedFlag1:!1,unusedFlag2:!1,unusedFlag3:!1},animation:{duration:0,beginTime:-1,easing:"linear"}}}var q0=(cl.prototype.reset=function(){this._maps=[]},cl.prototype.set=function(e,t,n){for(var i=e.getId();this._maps.length<=i;)this._maps.push(new Array(512));this._maps[i][t]=n},cl.prototype.get=function(e,t){return this._maps[e.getId()][t]},cl);function cl(){this._maps=[]}var H0={x:0,y:0,zoom:1,angle:0,width:80,height:60,pixelRatio:1,backgroundColor:null,currentTime:0,isBufferDisplayable:function(){return!0},hideImages:!1,renderBackground:!1},hl={webgl:b0,canvas:R0,svg:B0},cf=[0,0,0,0],Yd={webgl:null,svg:null,canvas:null},_u=(jt.createInitData=function(){var e={};for(var t in hl)e[t]=hl[t].createInitData();return e},jt.cacheInitData=function(e){Yd=e},jt.getCachedInitData=function(){return Yd},jt.clearCachedInitData=function(){Yd={webgl:null,svg:null,canvas:null}},jt.prototype.addCanvas=function(e){e.style.touchAction="none",e.style.msContentZooming="none",this._resizeCanvas(e),this._additionalCanvases.push(e),this._updateDomElement()},jt.prototype.removeCanvas=function(e){e.style.touchAction="",e.style.msContentZooming="",Fa(this._additionalCanvases,e),this._updateDomElement()},jt.prototype._ensureDomElementsFitParent=function(){if(this._domElement.offsetWidth!==this._view.width||this._domElement.offsetHeight!==this._view.height){this._domElement.style.width=this._view.width+"px",this._domElement.style.height=this._view.height+"px";for(var e=0;e<this._additionalCanvases.length;++e)this._resizeCanvas(this._additionalCanvases[e])}},jt.prototype._ensureCorrectBackgroundColor=function(){this._backgroundColor!==this._view.backgroundColor&&(this._domElement.style.backgroundColor=this._view.backgroundColor,this._backgroundColor=this._view.backgroundColor)},jt.prototype.createBlock=function(){return new Z0},jt.prototype.parseColor=function(e){return this._colorManager.parseColor(e)},jt.prototype.clear=function(){this._blockIdToAddress.fill(0),this._patternManager.reset(),this._boundariesManager.reset(),this._textManager.reset(),this._bufferList.reset(),this._idRecorder.reset()},jt.prototype.notifyFontsReloaded=function(){this._patternManager.notifyUpdate(),this._textManager.clear(),this._refreshTexts=!0},jt.prototype.notifyPatternUpdate=function(){this._patternManager.notifyUpdate()},jt.prototype.getShapePoints=function(e){return this._shapeManager.getDefinitionFromName(e).points},jt.prototype.checkShapeHit=function(e,t,n){var i=this._shapeManager.getDefinitionFromName(e),o=i.getDistanceFromStrokeHorizontally;return 0<=Math.min((0,i.getDistanceFromStrokeVertically)(t,n),o(t,n))},jt.prototype.setGlobalBoundaries=function(e){var t=e.maxBlockId,n=void 0===t?0:t,i=e.maxScaledSize,r=e.maxMinVisibleSize,o=e.maxSymbolicSize,a=e.maxDashLength,s=e.maxGapLength,l=e.maxPatternScale;return n>this._blockIdToAddress.length&&this._resizeBlockArray(n),!!this._boundariesManager.set(e)&&(this._memoryManager.resizeBoundaries(i,r,o,a,s,l),!0)},jt.prototype._resizeBlockArray=function(e){var t=new Uint32Array(e);t.set(this._blockIdToAddress),this._blockIdToAddress=t},jt.prototype.registerShape=function(e,t){this._shapeManager.register(e,t)},jt.prototype._bindBlock=function(e,t,n,i,r,o,a){this._checkBlockId(e);var l=this._bufferList.allocateBlock(this._blockIdToAddress[e],t,n,i,r,o,a);return this._blockIdToAddress[e]=l.address,this._currentDataView=l.buffer.getDataView(),this._currentElementSize=l.buffer.getElementSize(),this._currentBlockOffset=l.offset,this._currentByteOffset=this._currentBlockOffset*this._currentElementSize,this._currentSideDataView=l.buffer.getSideDataView(),this._currentSideElementSize=l.buffer.getTotalSideElementsSize(),this._currentSideByteOffset=this._currentBlockOffset*this._currentSideElementSize,l},jt.prototype._setItemIndex=function(e){var t=this._currentBlockOffset+e;this._currentByteOffset=t*this._currentElementSize,this._currentSideByteOffset=t*this._currentSideElementSize},jt.prototype._freeBlock=function(e){this._checkBlockId(e);var n=this._bufferList.freeBlock(this._blockIdToAddress[e]);return this._blockIdToAddress[e]=n},jt.prototype._checkBlockId=function(e){e>=this._blockIdToAddress.length&&this._resizeBlockArray(Ni(e+1))},jt.prototype._setTextCharacters=function(e){this._textManager.storeTextInDataView(this._currentSideDataView,this._currentSideByteOffset,this._currentSideByteOffset+this._currentSideElementSize,e)},jt.prototype._storeElement=function(e,t){this._memoryManager.storeGenericObject(this._currentDataView,this._currentByteOffset,e.end),t&&(this._memoryManager.storeGenericObject(this._currentDataView,this._currentByteOffset+52,e.start),this._memoryManager.storeAnimationInformation(this._currentDataView,this._currentByteOffset+104,e.animation,this._easingManager.getCoefficients(e.animation.easing)))},jt.prototype.storeBlock=function(e,t){if(!t||!t.getSize())return this._freeBlock(e);var n=t.getType(),i=t.getDepth(),r=t.getSize(),o=t.getElements(),a=t.isAnimated(),s=t.getStencilUsage(),l=t.getId(),u=0;if(2===n)for(var d=0;d<r;++d)7===(p=o[d]).end.pattern.type&&(u=Math.max(u,p.end.pattern.attributes.text.length)),a&&7===p.start.pattern.type&&(u=Math.max(u,p.start.pattern.attributes.text.length));var c=this._bindBlock(e,n,a,i,r,u,s);for(d=0;d<r;++d){var h=o[d];this._setItemIndex(d),this._storeElement(h,a),this._idRecorder.set(c.buffer,c.offset+d,l)}if(2===n)for(d=0;d<r;++d){var p=o[d];this._setItemIndex(d),this._setTextCharacters(p.end.pattern)}return c.address},jt.prototype.freeBlock=function(e){return this._freeBlock(e)},jt.prototype._refreshTextElements=function(){for(var e=0,t=this._bufferList.getBuffers();e<t.length;e++){var n=t[e];if(n&&2===n.getElementType()){for(var i=n.getSideDataView(),r=n.getTotalSideElementsSize(),o=n.getSize(),a=0,s=r,l=0;l<o;++l){var u=this._textManager.extractTextFromDataView(i,a,s);this._textManager.storeTextInDataView(i,a,s,u),a=s,s+=r}n.triggerUpdate()}}},jt.prototype._extractElement=function(e,t){if(!e)return null;var n=this._bufferList.getBlockInfo(e);return this._renderer.extractElement(n.buffer,n.offset+t)},jt.prototype.extractElement=function(e,t){return void 0===t&&(t=0),this._extractElement(e,t)},jt.prototype.getDomElement=function(){return this._domElement},jt.prototype.measureText=function(e,t,n,i){return void 0===i&&(i=1),this._textManager.measureText(e,t,n,i)},jt.prototype.setRenderType=function(e){this._renderType!==e&&(this._renderType=e,this._switchMainRenderer=!0)},jt.prototype._ensureMainRendererReady=function(){if(this._switchMainRenderer){var e=hl[this._renderType];e&&e.isAvailable()||(this._renderType="canvas"),this._renderer=this._renderersByType[this._renderType],this._renderer||(this._renderer=this._instanciateRenderer(this._renderType),this._renderersByType[this._renderType]=this._renderer),this._updateDomElement()}},jt.prototype._updateDomElement=function(){for(var e=this._renderer&&this._renderer.getDomElement();this._domElement.firstChild;)this._domElement.removeChild(this._domElement.firstChild);e&&this._appendDomChild(e);for(var t=0;t<this._additionalCanvases.length;++t)this._appendDomChild(this._additionalCanvases[t])},jt.prototype._appendDomChild=function(e){e.style.position="absolute",e.style.left="0",e.style.top="0",this._domElement.appendChild(e)},jt.prototype._instanciateRenderer=function(e){return new(hl[e]||Cd)({initData:this._initData[e],bufferList:this._bufferList,shapeManager:this._shapeManager,patternManager:this._patternManager,boundariesManager:this._boundariesManager,textManager:this._textManager,colorManager:this._colorManager,easingManager:this._easingManager,memoryManager:this._memoryManager})},jt.prototype.setView=function(e){this._view=It({},this._view,e)},jt.prototype._updateManagers=function(){this._patternManager.setPixelRatio(this._view.pixelRatio),this._shapeManager.update(),this._patternManager.update(),this._textManager.update(),this._boundariesManager.update(),this._bufferList.update(),this._refreshTexts&&(this._refreshTexts=!1,this._refreshTextElements())},jt.prototype._resizeCanvas=function(e){up(e,this._view.width,this._view.height,this._view.pixelRatio)},jt.prototype.render=function(){this._ensureMainRendererReady(),this._ensureDomElementsFitParent(),this._ensureCorrectBackgroundColor(),this._updateManagers(),this._renderer.renderFrame(this._view)},jt.prototype.ensureAnimationsReady=function(){this._ensureMainRendererReady(),this._renderer.ensureAnimationsReady()},jt.prototype.export=function(e,t,n){var i=this._instanciateRenderer(e),r=It({},this._view,t);return"setViewportClipping"in i&&i.setViewportClipping(!1),r.renderBackground=!0,this._updateManagers(),i.renderFrame(r),i.export(n).then(function(){return i.getDomElement()})},jt.prototype.getCurrentTime=function(){return z()},jt.prototype.getImageData=function(){return this._renderer&&this._renderer.getImageData()},jt.prototype.destroy=function(){for(var e=0,t=Object.keys(this._renderersByType);e<t.length;e++){var i=this._renderersByType[t[e]];i&&i.destroy()}},jt.prototype.transparentify=function(e){var t=this.parseColor(e)||cf;return"rgba("+Math.round(255*t[0])+","+Math.round(255*t[1])+","+Math.round(255*t[2])+",0)"},jt.prototype.initDebugRenderingLoop=function(e){var t=this,n=void 0===e?{}:e,i=n.triggerKey,r=void 0===i?"r":i,o=n.start,a=void 0===o||o;document.addEventListener("keydown",function(l){l.key===r&&(a=!a)});var s=function(l){(a||l)&&(t.setView({currentTime:z()}),t.render()),window.requestAnimationFrame(function(){s()})};window.requestAnimationFrame(function(){document.body.appendChild(t.getDomElement()),s(!0)})},jt);function jt(e){var t=this;this._view=sn(H0),this._domElement=ir?document.createElement("div"):$o(),this._currentDataView=null,this._currentElementSize=0,this._currentBlockOffset=0,this._currentByteOffset=0,this._blockIdToAddress=new Uint32Array(0),this._renderersByType={},this._switchMainRenderer=!0,this._renderer=null,this._additionalCanvases=[],this._refreshTexts=!1,this._backgroundColor=null,this._initData=e||{},this._colorManager=new ou,this._easingManager=new j0,this._patternManager=new zy,this._shapeManager=new Vy,this._boundariesManager=new V0,this._textManager=new _0(this._patternManager),this._idRecorder=new q0,this._memoryManager=new G0(this._patternManager,this._shapeManager,this._textManager,this._idRecorder,this._easingManager,function(n){return t.parseColor(n)||cf}),this._bufferList=new jy}var hf,W0=(St(pl,hf=Rd),Object.defineProperty(pl.prototype,"src",{get:function(){return this._src},set:function(e){var t=this;e&&(this._src=e,setTimeout(function(){t.onload&&t.onload.call(t),t.width=1,t.height=1,t.fire("load")},10))},enumerable:!0,configurable:!0}),pl.prototype.addEventListener=function(e,t){this.on(e,t)},pl);function pl(e,t){var n=hf.call(this)||this;return n.isDummy=!0,n.width=0,n.height=0,n}var Y0=(fa.prototype.setImgCrossOrigin=function(e){this._crossOrigin=e},fa.prototype.clear=function(){this._images={},this._nbLoaded=0,this._nbToLoad=0},fa.prototype.getImage=function(e){var i=this,r=this._images[e];return void 0===r&&(this._nbToLoad+=1,(r=new("undefined"!=typeof Image?Image:W0)(undefined,undefined)).crossOrigin=this._crossOrigin,r.onload=function(){return i._onImgLoad(e)},r.onerror=function(){i._onImgLoad(e),i._images[e]=null},r.src=e,this._images[e]=r),r},fa.prototype._onImgLoad=function(e){this._nbLoaded+=1,this._onFetch.forEach(function(t){return t(e)}),this._nbLoaded===this._nbToLoad&&(this._whenReady.forEach(function(t){return t()}),this._whenReady=[])},fa.prototype.onFetch=function(e){this._onFetch.push(e)},fa.prototype.whenReady=function(){var e=this;return this._nbLoaded===this._nbToLoad?Promise.resolve():new Promise(function(t){return e._whenReady.push(t)})},fa.prototype.destroy=function(){this._whenReady=[],this._onFetch=[]},fa);function fa(){this._images={},this._crossOrigin="anonymous",this._whenReady=[],this._onFetch=[],this._nbLoaded=0,this._nbToLoad=0}function pf(e,t,n,i,r,o,a,s,l){void 0===s&&(s=0),void 0===l&&(l=!1);var u=yi(n,i,r,o),d=(a/2*(l?yi(e,t,r,o)/u:1)+s)/u,c=(r-n)*d,h=(o-i)*d,p=n+h,g=i-c,m=e-p,x=t-g,v=n-h-p,y=i+c-g,b=r+h-p,S=o-c-g,w=m*v+x*y,M=m*b+x*S;return 0<w&&w<v*v+y*y&&0<M&&M<b*b+S*S}function fl(e,t){return e.x===t.x&&e.y===t.y}function Ms(e,t,n,i){return Math.atan2(i-t,n-e)}function mu(e,t,n,i,r,o,a,s){var l=e-n,u=t-i,d=r-a,c=o-s,h=l*c-d*u,p=(u*(e-r)-l*(t-o))/h;if(p<0||1<p)return null;var g=(d*(o-t)+c*(e-r))/h;return 0<=g&&g<=1?{x:e-g*l,y:t-g*u}:null}function ff(e,t,n,i,r,o,a,s){var l,u=[];return(l=mu(e,t,n,i,r,o,r,s))&&u.push(l),(l=mu(e,t,n,i,r,s,a,s))&&u.push(l),(l=mu(e,t,n,i,a,s,a,o))&&u.push(l),(l=mu(e,t,n,i,a,o,r,o))&&u.push(l),u}function Is(e,t,n,i,r,o,a,s){var l=((a-r)*(t-o)-(s-o)*(e-r))/((s-o)*(n-e)-(a-r)*(i-t)),u=((n-e)*(t-o)-(i-t)*(e-r))/((s-o)*(n-e)-(a-r)*(i-t));return 0<=l&&l<=1&&0<=u&&u<=1}function Xd(e,t,n,i,r,o,a,s){return r<=e&&o<=t&&e<=a&&t<=s||r<=n&&o<=i&&n<=a&&i<=s||!!Is(e,t,n,i,r,o,r,s)||!!Is(e,t,n,i,a,o,a,s)||!!Is(e,t,n,i,r,o,a,o)||!!Is(e,t,n,i,r,s,a,s)}function gf(e,t,n){return Math.sqrt(Jd(e.x,e.y,t.x,t.y,n.x,n.y))}function Jd(e,t,n,i,r,o){var a=ul(n,i,r,o);if(0===a)return ul(e,t,n,i);var s=((e-n)*(r-n)+(t-i)*(o-i))/a;return ul(e,t,n+(s=Math.max(0,Math.min(1,s)))*(r-n),i+s*(o-i))}function _f(e,t,n,i,r,o){var a=r-n,s=o-i;if(0==a&&0==s)return{x:n,y:i};var l=((e-n)*a+(t-i)*s)/(a*a+s*s);return l<0?{x:n,y:i}:1<l?{x:r,y:o}:{x:n+l*a,y:i+l*s}}function mf(){for(var e=arguments,t=e.length-1,n=t,i=[],r=0;r<=t&&Math.abs(e[r])<=1e-12;r++)t--;switch(t){case 1:o=e[n],void 0===(s=i)&&(s=[]),0!==(a=e[n-1])&&s.push(-o/a);break;case 2:!function(o,a,s,l){void 0===l&&(l=[]);var u=a/s,d=u*u-o/s*4;if(0<d){var c=Math.sqrt(d);l.push(.5*(-u+c)),l.push(.5*(-u-c))}else 0==d&&l.push(.5*-u)}(e[n],e[n-1],e[n-2],i);break;case 3:!function(o,a,s,l,u){void 0===u&&(u=[]);var d,c,h=s/l,p=a/l,g=(3*p-h*h)/3,m=(2*h*h*h-9*p*h+o/l*27)/27,x=h/3,v=m*m/4+g*g*g/27,y=m/2;if(Math.abs(v)<=1e-6&&(v=0),0<v){var b=Math.sqrt(v);c=0<=(d=-y+b)?Math.pow(d,1/3):-Math.pow(-d,1/3),0<=(d=-y-b)?c+=Math.pow(d,1/3):c-=Math.pow(-d,1/3),u.push(c-x)}else if(v<0){var S=Math.sqrt(-g/3),w=Math.atan2(Math.sqrt(-v),-y)/3,M=Math.cos(w),N=Math.sin(w),D=Math.sqrt(3);u.push(2*S*M-x),u.push(-S*(M+D*N)-x),u.push(-S*(M-D*N)-x)}else d=0<=y?-Math.pow(y,1/3):Math.pow(-y,1/3),u.push(2*d-x),u.push(-d-x)}(e[n],e[n-1],e[n-2],e[n-3],i)}var o,a,s;return i}function ga(e,t,n,i,r,o,a,s,l,u,d){for(var c,h,p=Math.min(a,l),g=Math.min(s,u),m=Math.max(a,l),x=Math.max(s,u),v=mf((c=s-u)*(e+-2*n+r)+(h=l-a)*(t+-2*i+o),c*(-2*e+2*n)+h*(-2*t+2*i),c*e+h*t+(a*u-l*s)),y=0;y<v.length;y++){var b=v[y];if(0<=b&&b<=1){var S=e+(n-e)*b,w=t+(i-t)*b,M=S+(n+(r-n)*b-S)*b,N=w+(i+(o-i)*b-w)*b;if(a===l){if(g<=N&&N<=x){if(!d)return 1;d.push(M,N)}}else if(s===u){if(p<=M&&M<=m){if(!d)return 1;d.push(M,N)}}else if(p<=M&&g<=N&&M<=m&&N<=x){if(!d)return 1;d.push(M,N)}}}return d?d.length/2:0}function vf(e,t,n,i,r,o,a,s,l,u,d){return d?(ga(e,t,n,i,r,o,a,s,l,s,d),ga(e,t,n,i,r,o,l,s,l,u,d),ga(e,t,n,i,r,o,a,u,l,u,d),ga(e,t,n,i,r,o,a,s,a,u,d),d.length/2):a<=e&&e<=l&&s<=t&&t<=u||a<=r&&r<=l&&s<=o&&o<=u||ga(e,t,n,i,r,o,a,s,l,s)||ga(e,t,n,i,r,o,l,s,l,u)||ga(e,t,n,i,r,o,a,u,l,u)||ga(e,t,n,i,r,o,a,s,a,u)?1:0}function _a(e,t,n,i,r,o,a,s,l,u,d,c,h){for(var p,g,m=Math.min(l,d),x=Math.min(u,c),v=Math.max(l,d),y=Math.max(u,c),b=mf((p=u-c)*(-1*e+3*n+-3*r+a)+(g=d-l)*(-1*t+3*i+-3*o+s),p*(3*e+-6*n+3*r)+g*(3*t+-6*i+3*o),p*(-3*e+3*n)+g*(-3*t+3*i),p*e+g*t+(l*c-d*u)),S=0;S<b.length;S++){var w=b[S];if(0<=w&&w<=1){var M=e+(n-e)*w,N=t+(i-t)*w,D=n+(r-n)*w,P=i+(o-i)*w,L=M+(D-M)*w,V=N+(P-N)*w,X=L+(D+(r+(a-r)*w-D)*w-L)*w,J=V+(P+(o+(s-o)*w-P)*w-V)*w;if(l===d){if(x<=J&&J<=y){if(!h)return 1;h.push(X,J)}}else if(u===c){if(m<=X&&X<=v){if(!h)return 1;h.push(X,J)}}else if(m<=X&&x<=J&&X<=v&&J<=y){if(!h)return 1;h.push(X,J)}}}return h?h.length/2:0}function yf(e,t,n,i,r,o,a,s,l,u,d,c,h){return h?(_a(e,t,n,i,r,o,a,s,l,u,d,u,h),_a(e,t,n,i,r,o,a,s,d,u,d,c,h),_a(e,t,n,i,r,o,a,s,l,c,d,c,h),_a(e,t,n,i,r,o,a,s,l,u,l,c,h),h.length/2):l<=e&&e<=d&&u<=t&&t<=c||l<=a&&a<=d&&u<=s&&s<=c||_a(e,t,n,i,r,o,a,s,l,u,d,u)||_a(e,t,n,i,r,o,a,s,d,u,d,c)||_a(e,t,n,i,r,o,a,s,l,c,d,c)||_a(e,t,n,i,r,o,a,s,l,u,l,c)?1:0}function Qd(e,t,n,i,r,o,a,s){return void 0===s&&(s={x:0,y:0}),s.x=(1-e)*(1-e)*t+2*(1-e)*e*o+e*e*i,s.y=(1-e)*(1-e)*n+2*(1-e)*e*a+e*e*r,s}function xf(e,t,n,i,r,o,a,s,l,u,d){void 0===u&&(u=0),void 0===d&&(d=!1);var c=n-2*a+r,h=i-2*s+o,p=-((n-e)*h-(i-t)*c)/((2*a-2*n)*h-(2*s-2*i)*c);if(p<0||1<p)return!1;var g=l/2;return d&&(g*=1-p),g+=u,yi(Cs(n,a,r,p),Cs(i,s,o,p),e,t)<=g}function vu(e,t,n,i,r,o,a,s,l,u){void 0===u&&(u={x:0,y:0});var d=(1-e)*(1-e)*(1-e),c=3*e*(1-e)*(1-e),h=3*e*e*(1-e),p=e*e*e;return u.x=d*t+c*o+h*s+p*i,u.y=d*n+c*a+h*l+p*r,u}function bf(e,t,n,i,r,o,a,s,l,u,d,c){var h=yi(n,i,a,s);if(Math.abs(e-n)>h||Math.abs(t-i)>h)return!1;for(var p,g=.5,m=yi(e,t,n,i)<yi(e,t,r,o)?-.01:.01,x=100,v=vu(g,n,i,r,o,a,s,l,u),y=yi(e,t,v.x,v.y),b=d/2+c;0<x--&&0<=g&&g<=1&&b<y&&(.001<m||m<-.001);)p=y,vu(g,n,i,r,o,a,s,l,u,v),p<(y=yi(e,t,v.x,v.y))?g+=m=-m/2:g+m<0||1<g+m?(m/=2,y=p):g+=m;return y<b}function Kd(e,t,n,i,r,o,a){void 0===a&&(a={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0});var s=e+2/3*(n-e),l=t+2/3*(i-t);return gl(e,t,s,l,s+1/3*(r-e),l+1/3*(o-t),r,o,a)}function gl(e,t,n,i,r,o,a,s,l){void 0===l&&(l={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0});var u,d,c,h,p,g=Math.min,m=Math.max,x=Math.sqrt;l.minX=g(e,a),l.maxX=m(e,a),l.minY=g(t,s),l.maxY=m(t,s);for(var v=void 0,y=void 0,b=void 0,S=void 0,w=void 0,M=void 0,N=void 0,D=0;D<2;++D)if(p=0===D?(d=e,c=n,h=r,a):(d=t,c=i,h=o,s),y=6*d-12*c+6*h,v=-3*d+9*c-9*h+3*p,b=3*c-3*d,y|=0,b|=0,0!=(v|=0))(w=y*y-4*b*v)<0||(0<(M=(-y+x(w))/(2*v))&&M<1&&(u=$d(M,d,c,h,p),0===D?(l.minX=g(l.minX,u),l.maxX=m(l.maxX,u)):(l.minY=g(l.minY,u),l.maxY=m(l.maxY,u))),0<(N=(-y-x(w))/(2*v))&&N<1&&(u=$d(N,d,c,h,p),0===D?(l.minX=g(l.minX,u),l.maxX=m(l.maxX,u)):(l.minY=g(l.minY,u),l.maxY=m(l.maxY,u))));else{if(0===y)continue;0<(S=-b/y)&&S<1&&(u=$d(S,d,c,h,p),0===D?(l.minX=g(l.minX,u),l.maxX=m(l.maxX,u)):(l.minY=g(l.minY,u),l.maxY=m(l.maxY,u)))}return l}function $d(e,t,n,i,r){return Math.pow(1-e,3)*t+3*Math.pow(1-e,2)*e*n+3*(1-e)*Math.pow(e,2)*i+Math.pow(e,3)*r}var Q0={left:{x:-1,y:0},right:{x:1,y:0},top:{x:0,y:-1},bottom:{x:0,y:1},center:{x:0,y:0}},K0=(Vo.prototype.getDefinition=function(){return this._attributesManager.getAttributeLayerDefinition(this._id)},Vo.prototype.update=function(e){this._attributesManager.updateAttributeLayer(this._id,e)},Vo.prototype.destroy=function(){this._attributesManager.destroyAttributeLayer(this._id)},Vo.prototype.updateElements=function(e){this._attributesManager.updateElementsForAttributeLayer(this._id,e)},Vo.prototype.updateAll=function(){this._attributesManager.updateAllForAttributeLayer(this._id)},Vo.prototype.setAttributeValues=function(e,t,n){this._attributesManager.setAttributeLayerValues(this._id,e,t,n)},Vo.prototype.getUsedAttributeNames=function(e){return this._attributesManager.getUsedAttributeLayerAttributes(this._id,e)},Vo.prototype.getFlexArrays=function(){return this._attributesManager.getAttributeLayerFlexArrays(this._id)},Vo);function Vo(e,t){this._attributesManager=e,this._id=t}var Ef={storage:1,default:0},_l=(io.prototype._getAllIndexes=function(){for(var e=this._isNode?this._graph.getNodeMaxIndex():this._graph.getEdgeMaxIndex(),t=new Uint32Array(e),n=1;n<=e;++n)t[n-1]=n;return t},io.prototype.addAll=function(){this._all=!0},io.prototype.add=function(e){if(!this._all)for(var t=0;t<e._indexes.length;t++)this._addIndex(e._indexes[t])},io.prototype._addIndex=function(e){0===this._flexArray.get(e)&&(this._flexArray.set(e,1),this._indexList.push(e))},io.prototype.isEmpty=function(){return!this._all&&this._indexList.isEmpty()},io.prototype.isFull=function(){return this._all},io.prototype.getListAndClear=function(){var e=this.getList();return this.clear(),e},io.prototype.getList=function(){var e=null;if(this._all&&!this._includeRemovedElements)e=this._isNode?this._graph.getNodes("all"):this._graph.getEdges("all");else{var t=this._all?this._getAllIndexes():this._indexList.slice();e=this._eltList(t)}return e},io.prototype.clear=function(){this._all=!1,this._indexList.isEmpty()||(this._indexList.reset(),this._flexArray.reset())},io.prototype.addSet=function(e){if(e._all)this.addAll();else for(var t=e._indexList.getBuffer(),n=e._indexList.getLength(),i=0;i<n;++i)this._addIndex(t[i])},io);function io(e){var t=e.graph,n=e.isNode,i=e.includeRemovedElements;this._all=!1,this._isNode=n,this._graph=t,this._includeRemovedElements=i,this._eltList=n?this._graph.nodeList:this._graph.edgeList,this._flexArray=n?this._graph.createNodeAttribute(Ef):this._graph.createEdgeAttribute(Ef),this._all=!1,this._indexList=this._graph.createIndexList(n)}function yu(e){return"string"==typeof e}function ec(e,t){return e?e+"."+t:t}function Li(e){return"boolean"==typeof e||0===e||1===e?e:void 0}function ma(e){return"number"==typeof e&&isFinite(e)?e:void 0}function Gn(e){return"number"==typeof e&&isFinite(e)&&0<=e?e:void 0}var Af=new Function("x","return (typeof x === 'number' && isFinite(x) && x % 1 === 0 && x >= -1 && x <= 4) ? x : undefined;");function Uo(e){return null===e||"string"==typeof e||"number"==typeof e?e:void 0}function va(e){return"fixed"===e||"scaled"===e?e:void 0}function ya(e,t){return t.parseColor(e)?e:void 0}function Ki(e,t){return"inherit"===e||t.parseColor(e)?e:void 0}function ks(e){return null===e?null:"string"==typeof e?e.split(",").map(function(t){var n=t.trim(),i=-1!==n.indexOf(" "),r=n[0];return i&&'"'!==r&&"'"!==r?'"'+n+'"':n}).join(","):void 0}function Os(e){return"none"===e?"normal":"normal"===e||"italic"===e||"bold"===e||"italic bold"===e?e:void 0}function ml(e){return"left"===e||"center"===e?e:void 0}function wf(e){return[null,"arrow","circle-hole-arrow","triangle-hole-arrow","short-arrow","sharp-arrow","circle","square"].includes(e)?e:void 0}function gn(e){return new Function("x",["if (typeof x === 'number') { return (typeof x === 'number' && isFinite(x) && x >= 0) ? x : undefined; }","else if (typeof x !== 'string' || x.charAt(x.length - 1) !== '%') { return undefined; }","else { var p = parseFloat(x); return isNaN(p) ? undefined : ("+e+" * p / 100); }"].join("\n"))}function vl(e){return{_check:Uo,_set:new Function("flexArrays","index","value",["flexArrays.badges."+e+".text.content.set(index, value);","if (value === null || value === undefined) flexArrays.badges."+e+".image.url.set(index, value);"].join("\n")),_get:new Function("flexArrays","index","return flexArrays.badges."+e+".text.content.get(index);"),color:{_flexArray:"white",_check:Ki},scale:{_flexArray:.45,_check:gn(.45)},positionScale:{_flexArray:1,_check:Gn},minVisibleSize:{_flexArray:12,_check:gn(12)},image:{_alias:"badges."+e+".image.url",url:{_flexArray:null,_check:Uo},scale:{_flexArray:1,_check:gn(1)}},stroke:{color:{_flexArray:"black",_check:Ki},width:{_flexArray:2,_check:gn(2)},scalingMethod:{_flexArray:"fixed",_check:va}},text:{_alias:"badges."+e+".text.content",content:{_flexArray:null,_check:Uo},color:{_flexArray:"black",_check:Ki},font:{_flexArray:"Arial",_check:ks},style:{_flexArray:"normal",_check:Os},scale:{_flexArray:.5,_check:gn(.5)}},threshold:"badges."+e+".minVisibleSize"}}var Cf={_check:Li,_get:function(e,t){return 0===e.opacity.get(t)},_set:function(e,t,n){e.opacity.set(t,void 0===n?void 0:+!n)}},$0={x:{_flexArray:0,_check:ma,_disableMemoryOptimization:!0},y:{_flexArray:0,_check:ma,_disableMemoryOptimization:!0},radius:{_flexArray:5,_check:gn(5)},scalingMethod:{_flexArray:"scaled",_check:va},color:{_flexArray:"grey",_check:function(e,t){if(t.parseColor(e))return e;if(Array.isArray(e)){if(e.length<1)return;for(var n=0;n<e.length;++n)if(!t.parseColor(e[n]))return;return e}}},opacity:{_flexArray:1,_check:Gn},hidden:Cf,shape:{_flexArray:"circle",_check:function(e){return"equilateral"===e?"pentagon":"circle"===e||"square"===e||"cross"===e||"diamond"===e||"pentagon"===e||"star"===e?e:void 0}},layer:{_flexArray:0,_check:Af},detectable:{_flexArray:!0,_check:Li},draggable:{_flexArray:!0,_check:Li},layoutable:{_flexArray:!0,_check:Li},innerStroke:{_alias:"innerStroke.color",width:{_flexArray:2,_check:gn(2)},scalingMethod:{_flexArray:"fixed",_check:va},color:{_flexArray:"white",_check:Ki},minVisibleSize:{_flexArray:12,_check:gn(12)},threshold:"innerStroke.minVisibleSize"},outerStroke:{_alias:"outerStroke.color",width:{_flexArray:5,_check:gn(5)},scalingMethod:{_flexArray:"fixed",_check:va},color:{_flexArray:null,_check:Ki},minVisibleSize:{_flexArray:0,_check:gn(0)},threshold:"outerStroke.minVisibleSize"},badges:{_check:function(e){return null===e?e:void 0},_set:function(e,t,n){e.badges.topLeft.text.content.set(t,n),e.badges.topLeft.image.url.set(t,n),e.badges.topRight.text.content.set(t,n),e.badges.topRight.image.url.set(t,n),e.badges.bottomLeft.text.content.set(t,n),e.badges.bottomLeft.image.url.set(t,n),e.badges.bottomRight.text.content.set(t,n),e.badges.bottomRight.image.url.set(t,n)},topLeft:vl("topLeft"),topRight:vl("topRight"),bottomLeft:vl("bottomLeft"),bottomRight:vl("bottomRight")},halo:{_alias:"halo.color",color:{_flexArray:null,_check:ya},width:{_flexArray:50,_check:gn(50)},scalingMethod:{_flexArray:"fixed",_check:va},strokeColor:{_flexArray:null,_check:ya},strokeWidth:{_flexArray:1,_check:gn(1)},clustering:{_flexArray:!1,_check:Li},hideNonAdjacentEdges:{_flexArray:!1,_check:Li},size:"halo.width"},pulse:{enabled:{_flexArray:!1,_check:Li},duration:{_flexArray:1e3,_check:Gn},interval:{_flexArray:800,_check:Gn},startColor:{_flexArray:"rgba(0, 0, 0, 0.6)",_check:Ki},endColor:{_flexArray:"rgba(0, 0, 0, 0)",_check:Ki},width:{_flexArray:50,_check:Gn},startRatio:{_flexArray:1,_check:Gn},endRatio:{_flexArray:2,_check:Gn}},icon:{_alias:"icon.content",content:{_flexArray:null,_check:Uo},font:{_flexArray:"Arial",_check:ks},color:{_flexArray:"black",_check:ya},scale:{_flexArray:.7,_check:gn(.7)},style:{_flexArray:"normal",_check:Os},minVisibleSize:{_flexArray:12,_check:gn(12)},threshold:"icon.minVisibleSize"},image:{_alias:"image.url",url:{_flexArray:null,_check:Uo},scale:{_flexArray:1,_check:gn(1)},fit:{_flexArray:!0,_check:Li},tile:{_flexArray:!1,_check:Li},minVisibleSize:{_flexArray:12,_check:gn(12)},rescale:"image.fit",duplicate:"image.tile",threshold:"image.minVisibleSize"},outline:{_alias:"outline.enabled",enabled:{_flexArray:!1,_check:Li},color:{_flexArray:"rgba(0, 0, 0, 0.36)",_check:ya},minVisibleSize:{_flexArray:12,_check:gn(12)}},text:{_alias:"text.content",content:{_flexArray:null,_check:Uo},font:{_flexArray:"Arial",_check:ks},color:{_flexArray:"black",_check:Ki},size:{_flexArray:12,_check:gn(12)},scale:{_flexArray:.1,_check:Gn},style:{_flexArray:"normal",_check:Os},align:{_flexArray:"center",_check:ml},margin:{_flexArray:10,_check:gn(10)},padding:{_flexArray:2,_check:gn(2)},backgroundColor:{_flexArray:null,_check:Ki},tip:{_flexArray:!0,_check:Li},minVisibleSize:{_flexArray:24,_check:gn(24)},scaling:{_flexArray:!1,_check:Li},position:{_flexArray:"bottom",_check:function(e){return"top"===e||"bottom"===e||"left"===e||"right"===e||"center"===e?e:void 0}},maxLineLength:{_flexArray:0,_check:Gn},truncateLength:{_flexArray:0,_check:Gn},backgroundArrowBaseSize:"text.margin",backgroundMargin:"text.padding",threshold:"text.minVisibleSize",secondary:{_alias:"text.secondary.content",content:{_flexArray:null,_check:Uo},font:{_flexArray:"Arial",_check:ks},color:{_flexArray:"black",_check:Ki},size:{_flexArray:10,_check:gn(10)},scale:{_flexArray:.08,_check:Gn},style:{_flexArray:"normal",_check:Os},align:{_flexArray:"center",_check:ml},margin:{_flexArray:5,_check:gn(5)},padding:{_flexArray:2,_check:gn(2)},backgroundColor:{_flexArray:null,_check:Ki},minVisibleSize:{_flexArray:24,_check:gn(24)},backgroundArrowBaseSize:"text.secondary.margin",backgroundMargin:"text.secondary.padding",threshold:"text.secondary.minVisibleSize"}}},ex={width:{_flexArray:1,_check:gn(1)},scalingMethod:{_flexArray:"scaled",_check:va},color:{_flexArray:"grey",_check:function(e,t){return"source"===e||"target"===e||t.parseColor(e)?e:void 0}},opacity:{_flexArray:1,_check:Gn},hidden:Cf,minVisibleSize:{_flexArray:0,_check:Gn},threshold:"minVisibleSize",layer:{_flexArray:0,_check:Af},detectable:{_flexArray:!0,_check:Li},curvature:{_flexArray:0,_check:ma},adjustAnchors:{_flexArray:!0,_check:Li},shape:{_check:function(e){return["line","tapered","arrow","dashed","dotted"].includes(e)?e:void 0},_set:function(e,t,n){var i=void 0,r=void 0,o=void 0,a=void 0;"line"===n?(i="line",r="plain",a=o=null):"arrow"===n?(i="line",r="plain",o="arrow",a=null):"tapered"===n?(i="triangle",r="plain",a=o=null):"dashed"===n?(i="line",r="dashed",a=o=null):"dotted"===n&&(i="line",r="dotted",a=o=null),e.shape.type.set(t,i),e.shape.style.set(t,r),e.shape.head.set(t,o),e.shape.tail.set(t,a)},type:{_flexArray:"line",_check:function(e){return"line"===e||"triangle"===e?e:void 0}},head:{_flexArray:null,_check:wf},tail:{_flexArray:null,_check:wf},style:{_flexArray:"plain",_check:function(e){return"plain"===e||"dashed"===e||"dotted"===e?e:void 0}}},stroke:{color:{_flexArray:"inherit",_check:Ki},width:{_flexArray:0,_check:gn(0)},scalingMethod:{_flexArray:"fixed",_check:va},minVisibleSize:{_flexArray:0,_check:Gn}},strokeWidth:"stroke.width",halo:{_alias:"halo.color",color:{_flexArray:null,_check:ya},width:{_flexArray:10,_check:gn(10)},scalingMethod:{_flexArray:"fixed",_check:va},size:"halo.width"},pulse:{enabled:{_flexArray:!1,_check:Li},duration:{_flexArray:1e3,_check:Gn},interval:{_flexArray:800,_check:Gn},startColor:{_flexArray:"rgba(0, 0, 0, 0.6)",_check:Ki},endColor:{_flexArray:"rgba(0, 0, 0, 0)",_check:Ki},width:{_flexArray:10,_check:Gn},startRatio:{_flexArray:1,_check:Gn},endRatio:{_flexArray:2,_check:Gn}},outline:{_alias:"outline.enabled",enabled:{_flexArray:!1,_check:Li},color:{_flexArray:"rgba(0, 0, 0, 0.36)",_check:ya},minVisibleSize:{_flexArray:0,_check:Gn}},text:{_alias:"text.content",content:{_flexArray:null,_check:Uo},font:{_flexArray:"Arial",_check:ks},color:{_flexArray:"black",_check:ya},size:{_flexArray:12,_check:gn(12)},scale:{_flexArray:1,_check:Gn},style:{_flexArray:"normal",_check:Os},align:{_flexArray:"center",_check:ml},margin:{_flexArray:2,_check:gn(2)},padding:{_flexArray:2,_check:gn(2)},backgroundColor:{_flexArray:null,_check:Ki},minVisibleSize:{_flexArray:4,_check:Gn},threshold:"text.minVisibleSize",adjustAngle:{_flexArray:!0,_check:Li},scaling:{_flexArray:!1,_check:Li},maxLineLength:{_flexArray:0,_check:Gn},secondary:{_alias:"text.secondary.content",content:{_flexArray:null,_check:Uo},font:{_flexArray:"Arial",_check:ks},color:{_flexArray:"black",_check:ya},size:{_flexArray:12,_check:gn(12)},scale:{_flexArray:.8,_check:Gn},style:{_flexArray:"normal",_check:Os},align:{_flexArray:"center",_check:ml},margin:{_flexArray:2,_check:gn(2)},padding:{_flexArray:2,_check:gn(2)},backgroundColor:{_flexArray:null,_check:Ki},minVisibleSize:{_flexArray:4,_check:Gn},threshold:"text.secondary.minVisibleSize"}}};function tx(){}function nx(){}function Tf(e,t){if(!e._check)throw new Error("error somewhere for "+t);return{check:e._check,set:new Function("flexArrays","index","value","flexArrays."+t+".set(index, value);"),get:new Function("flexArrays","index","return flexArrays."+t+".get(index);"),nested:{}}}function tc(e,t,n){if(void 0!==(t=t||e)._flexArray)return Tf(t,n);var i={check:null,get:null,set:null,nested:null};if(yu(t)||t._alias){var r=yu(t)?t:t._alias;i=Tf(u=bn(e,r),r)}else{if(t._set?(i.set=t._set,i.check=t._check):(i.set=tx,i.check=nx),t._get)i.get=t._get;else{var o="return "+function d(c,h){if(void 0!==c._flexArray)return"flexArrays."+h+".get(index)";for(var p=[],g=0,m=Object.keys(c);g<m.length;g++){var x=m[g],v=c[x];if(!x.startsWith("_")&&$t(v)){var y=d(c[x],ec(h,x));y&&p.push(x+": "+y)}}return p.length?"{\n"+p.join(",\n").split("\n").map(function(b){return"  "+b}).join("\n")+"\n}":""}(t,n)+";";i.get=new Function("flexArrays","index",o)}i.nested={}}if(!yu(t))for(var a=0,s=Object.keys(t);a<s.length;a++){var l=s[a],u=t[l];l.startsWith("_")||(i.nested[l]=tc(e,u,ec(n,l)))}return i}function Mf(e){return e}function nc(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}var ix=tc($0),rx=tc(ex),ox={name:"animationStart",storage:32,default:0},ax={name:"animationDuration",storage:16,default:0},sx={name:"animationEasing",storage:"resource",default:"linear"},ux={self:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},adjacentNodes:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},adjacentEdges:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},allNodes:null,allEdges:null},lx={self:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},extremities:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},parallelEdges:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},allNodes:null,allEdges:null},dx={x:1,y:1,radius:1,"halo.hideNonAdjacentEdges":1},If=Object.freeze({__proto__:null,linear:Mf,quadraticIn:function(e){return e*e},quadraticOut:function(e){return e*(2-e)},quadraticInOut:nc,cubicIn:function(e){return e*e*e},cubicOut:function(e){return--e*e*e+1},cubicInOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}}),ic="_visible",rc="_data",Ja="_hovered",oc="_hoverExtremityHighlighted",xi="_selected",yl="_selectionExtremityHighlighted",xl="_dragged",kf="_rewirable",Qa="_export",ai="_faded",xa="_transparent",Of=[xi,xl,yl,Ja,oc,kf,Qa,ai,xa],cx=["hover","zoom","panning","rotation","gesture","drag","selection","tooltip","user","interactions","resizing","rewiring","connectNodes","lasso"];function Nf(e,t){return{attributes:Lf(e),tags:t?[t]:[]}}function Lf(e){var i=null;return void 0===e.output?("function"==typeof e.attributes&&(i="all"),$t(e.attributes)&&(i=Ei(e.attributes))):i=e.output.attributes,bl(i,e.allAttributePaths)}function yo(e,t,n,i,r,o){!function(a,s,l,u){if(l<u)for(var d=0,c=s.attributes;d<c.length;d++)for(var h=c[d],p=0,g=a.attributes;p<g.length;p++)if(g[p]===h)return!0;for(var m=0,x=s.tags;m<x.length;m++)for(var v=x[m],y=0,b=a.tags;y<b.length;y++)if(v===b[y])return!0;return!1}(n,i,r,o)||e.push(t)}function hx(e){var t=e.dependencies;void 0===t?t=ux:$t(t)||(t={});var r=Qn(e.attributes).some(function(a){return"function"==typeof a})||e.selector&&!e.standaloneSelector,o=t.adjacentEdges;return!o&&t.adjacentNodes&&(o=!0),{self:xo(t.self,r,e.allAttributePaths),adjacentNodes:xo(t.adjacentNodes,r,e.allAttributePaths),adjacentEdges:xo(o,r,e.allAttributePaths),allNodes:xo(t.allNodes,r,e.allAttributePaths),allEdges:xo(t.allEdges,r,e.allAttributePaths)}}function px(e){var t=e.dependencies;void 0===t?t=lx:$t(t)||(t={});var r=Qn(e.attributes).some(function(o){return"function"==typeof o})||e.selector&&!e.standaloneSelector;return{self:xo(t.self,r,e.allAttributePaths),extremities:xo(t.extremities,r,e.allAttributePaths),parallelEdges:xo(t.parallelEdges,r,e.allAttributePaths),allNodes:xo(t.allNodes,r,e.allAttributePaths),allEdges:xo(t.allEdges,r,e.allAttributePaths)}}function xo(e,t,n){if(!t)return{attributes:[],tags:[]};if(!0===e)return{attributes:[],tags:[ic]};var i,r={attributes:bl((e=e||{}).attributes,n),tags:(i=e.tags,Array.isArray(i)?i.filter(yu):[])};return e.data&&r.tags.push(rc),e.selection&&r.tags.push(xi),e.hover&&r.tags.push(Ja),r}function fx(e){return Array.isArray(e)?e.join("."):e}function bl(e,t){if("all"===e)return t.slice();if(!Array.isArray(e))return[];var n=e.map(fx).filter(yu);return t?t.filter(function(i){return n.some(function(r){return i.startsWith(r)})}):n}var Ff=(An.prototype.clear=function(){this._elementsToRedraw.clear(),this._elementsUpdated.clear(),this._updatedAttributes.clear(),this._updatedAttributesTmp.clear()},An.prototype.getAttributeFlexArrays=function(){return this._finalFlexArraysWrapped},An.prototype.getPrevAttributeFlexArrays=function(){return this._prevFlexArrays},An.prototype.getAnimationInformation=function(e){for(var t=e._indexes,n=Array(t.length),i=0;i<t.length;i++){var r=t[i];n[i]={duration:this._finalFlexArraysWrapped.animationDuration.get(r),start:this._finalFlexArraysWrapped.animationStart.get(r),easing:this._finalFlexArraysWrapped.animationEasing.get(r)}}return n},An.prototype.startUpdate=function(){},An.prototype.prepareFlexArraysUpdate=function(e){this._currentFlexArrays=e.inputFlexArrays},An.prototype.setLastFlexArrays=function(e){this._lastFlexArrays=e},An.prototype.updateFlexArrays=function(e){var t=e.attributes,n=e.selector,i=e.context,r=e.outputFlexArrays,o=e.toUpdate,a=e.formattedOutput;this._elementsUpdated.addSet(o),this._elementsToRedraw.addSet(o);var s=o.getListAndClear();if(t&&s.size){for(var l=Dh(this._graph,s,n,i),u=l.valid,d=l.invalid,c=0,h=a.attributes;c<h.length;c++)for(var p=bn(r,h[c]),g=0;g<d._indexes.length;g++)p.set(d._indexes[g],void 0);this._assignAttributesToFlexArrays(this._accessors,r,u,t,i),this._addUpdatedAttributes(e)}},An.prototype.endUpdate=function(){for(var e=this._elementsUpdated.getList(),t=0,n=du(this._updatedAttributesTmp);t<n.length;t++)for(var i=n[t],r=bn(this._lastFlexArrays,i),o=bn(this._finalFlexArrays,i),a=0;a<e._indexes.length;a++){var s=e._indexes[a];o.set(s,r.get(s))}this._updatedAttributesTmp.clear(),this._currentFlexArrays=this._finalFlexArrays},An.prototype.setAttributeValues=function(e,t,n,i){this._assignAttributesToFlexArrays(this._accessors,e.outputFlexArrays,t,n,null),this._addUpdatedAttributes(e,i),this._elementsUpdated.add(t),this._elementsToRedraw.add(t)},An.prototype.notifyLayerDestroyed=function(e){this._addUpdatedAttributes(e)},An.prototype._addUpdatedAttributes=function(e,t){for(var n=e.outputFlexArrays,i=e.formattedOutput,r=0,o=Array.isArray(t)?bl(t):i.attributes;r<o.length;r++){var a=o[r];bn(n,a).isInitialized()&&(this._updatedAttributes.add(a),this._updatedAttributesTmp.add(a),this._allUsedAttributes.add(a))}},An.prototype.getUsedAttributeNames=function(e){return function t(n,i,r){return void 0===i&&(i=[]),void 0===r&&(r=""),n.constructor===Fn?n.isInitialized()&&i.push(r):n.constructor===Object&&Object.keys(n).forEach(function(o){t(n[o],i,ec(r,o))}),i}(e.outputFlexArrays)},An.prototype.redrawElements=function(e){this._elementsToRedraw.add(e)},An.prototype.redrawAll=function(){this._elementsToRedraw.addAll()},An.prototype.getAndResetElementsToRedraw=function(){return this._elementsToRedraw.getListAndClear()},An.prototype.getAndResetElementsUpdated=function(){return this._elementsUpdated.getListAndClear()},An.prototype.getAndResetAttributesUpdated=function(){var e=du(this._updatedAttributes);return this._updatedAttributes.clear(),e},An.prototype.createFlexArrays=function(){return this._createFlexArrays(this._graph,{named:!1,useDefaultValues:!1})},An.prototype.getAttributeValues=function(e,t,n,i){var r=i?this._prevFlexArrays:this._currentFlexArrays;return n?this._getMultipleAttributeValues(e,t,r):this._getSingleAttributeValues(e,t,r)},An.prototype._getAccessor=function(e){void 0===e&&(e="");for(var t=this._accessors,n=Pr(e),i=0,r=n;i<r.length;i++)if(!(t=t.nested[r[i]]))throw new Error(this._eltName+' attribute "'+n.join("")+'" does not exist');return t},An.prototype._getSingleAttributeValues=function(e,t,n){for(var i=this._getAccessor(t),r=e._indexes,o=Array(r.length),a=0;a<r.length;a++)o[a]=i.get(n,r[a]);return o},An.prototype._getMultipleAttributeValues=function(e,t,n){if(!t||"all"===t)return this._getSingleAttributeValues(e,"",n);for(var i=Array(e.size),r=0;r<i.length;++r)i[r]={};for(r=0;r<t.length;r++)for(var o=t[r],a=this._getSingleAttributeValues(e,o,n),s=0;s<i.length;++s)Yt(i[s],o,a[s]);return i},An.prototype.setAnimationAttributes=function(e,t){var n=t.duration,i=t.startTime,r=t.easing,o=e._indexes,a=this._finalFlexArraysWrapped.animationDuration,s=this._finalFlexArraysWrapped.animationStart,l=this._finalFlexArraysWrapped.animationEasing,u=du(this._allUsedAttributes);if(n){for(var d=!1,c=0,h=u;c<h.length;c++){var p=h[c];if("x"!==p&&"y"!==p)for(var g=bn(this._finalFlexArrays,p),m=bn(this._prevFlexArrays,p),x=0;x<o.length;x++){var v=o[x];m.set(v,g.get(v))}else d=!0}if(d){var y=z(),b=this._finalFlexArrays.x,S=this._finalFlexArrays.y,w=this._prevFlexArrays.x,M=this._prevFlexArrays.y;for(x=0;x<o.length;x++){var N=a.get(v=o[x]);if(N){var D=s.get(v),P=l.get(v),L=(If[P]||Mf)(Math.min((y-D)/N,1)),V=Lt(w.get(v),b.get(v),L),X=Lt(M.get(v),S.get(v),L);w.set(v,V),M.set(v,X)}else w.set(v,b.get(v)),M.set(v,S.get(v))}}}a.fill(o,n),s.fill(o,i),l.fill(o,r)},An.prototype.resetAnimationAttributes=function(e){this._finalFlexArraysWrapped.animationDuration.fill(e._indexes,0)},An.prototype.getUsedAttributes=function(){return du(this._allUsedAttributes)},An.prototype.getDefaultFlexArrays=function(){return this._defaultFlexArrays},An.prototype._assignAttributesToFlexArrays=function(e,t,n,i,r,o){if(void 0===o&&(o=[]),"function"==typeof i)for(var a=o.join("."),s=0;s<n.size;++s){var l=i(m=n.get(s),r,a);this._assignSingleValueToFlexArray(t,m,e,l,o)}else if($t(i)){var u=Object.keys(i);for(s=0;s<u.length;++s){var d=u[s];o.push(d);var c=this._getNestedAccessor(e,d,o);this._assignAttributesToFlexArrays(c,t,n,i[d],r,o),o.pop()}}else if((Array.isArray(i)||ArrayBuffer.isView(i))&&"color"!==o[0])if(o.length)for(s=0;s<n.size;++s){var p=n._indexes[s],g=e.check(i[s],this._colorManager);e.set(t,p,g)}else for(s=0;s<n.size;++s)this._assignSingleValueToFlexArray(t,n.get(s),e,i[s],o);else for(g=e.check(i,this._colorManager),s=0;s<n.size;++s){var m=n.get(s);e.set(t,m._index,g)}},An.prototype._getNestedAccessor=function(e,t,n){var i=e.nested[t];if(!i)throw new Error(this._eltName+' attribute "'+n.join(".")+'" does not exist');return i},An.prototype._assignSingleValueToFlexArray=function(e,t,n,i,r){if($t(i))for(var o=0,a=Object.keys(i);o<a.length;o++){var s=a[o];r.push(s);var l=i[s],u=this._getNestedAccessor(n,s,r);this._assignSingleValueToFlexArray(e,t,u,l,r),r.pop()}else{var d=n.check(i,this._colorManager);n.set(e,t._index,d)}},An);function An(e,t,n,i){this._lastFlexArrays=null,this._updatedAttributes=new Set,this._updatedAttributesTmp=new Set,this._allUsedAttributes=new Set,this._colorManager=t,this._graph=e,this._eltName=n?"node":"edge",this._accessors=n?ix:rx,this._createFlexArrays=i,this._finalFlexArrays=this._createFlexArrays(this._graph,{named:!0,useDefaultValues:!0}),this._prevFlexArrays=this._createFlexArrays(this._graph,{named:!1,useDefaultValues:!0}),this._defaultFlexArrays=this._createFlexArrays(this._graph,{named:!1,useDefaultValues:!0}),this._currentFlexArrays=this._defaultFlexArrays,this.setLastFlexArrays(this._defaultFlexArrays),this._elementsToRedraw=new _l({graph:this._graph,isNode:n,includeRemovedElements:!0}),this._elementsUpdated=new _l({graph:this._graph,isNode:n,includeRemovedElements:!1}),this._finalFlexArraysWrapped=It({},this._finalFlexArrays,{excluded:this._graph.getAttribute(n,"excluded"),textHidden:this._graph.getAttribute(n,"textHidden"),animationStart:this._graph.createAttribute(n,ox),animationDuration:this._graph.createAttribute(n,ax),animationEasing:this._graph.createAttribute(n,sx),id:this._graph.getAttribute(n,"id")},!n&&{source:this._graph.getEdgeAttribute("source"),target:this._graph.getEdgeAttribute("target")})}function gx(e,t){var n=t.named,i=t.useDefaultValues,r="resource";return{x:e.createAttribute(!0,{storage:"any",default:i?0:void 0,name:n?"x":void 0}),y:e.createAttribute(!0,{storage:"any",default:i?0:void 0,name:n?"y":void 0}),radius:e.createAttribute(!0,{storage:r,default:i?5:void 0,name:n?"radius":void 0}),scalingMethod:e.createAttribute(!0,{storage:r,default:i?"scaled":void 0,name:n?"scalingMethod":void 0}),color:e.createAttribute(!0,{storage:r,default:i?"grey":void 0,name:n?"color":void 0}),opacity:e.createAttribute(!0,{storage:r,default:i?1:void 0,name:n?"opacity":void 0}),shape:e.createAttribute(!0,{storage:r,default:i?"circle":void 0,name:n?"shape":void 0}),layer:e.createAttribute(!0,{storage:r,default:i?0:void 0,name:n?"layer":void 0}),detectable:e.createAttribute(!0,{storage:r,default:!!i||void 0,name:n?"detectable":void 0}),draggable:e.createAttribute(!0,{storage:r,default:!!i||void 0,name:n?"draggable":void 0}),layoutable:e.createAttribute(!0,{storage:r,default:!!i||void 0,name:n?"layoutable":void 0}),innerStroke:{width:e.createAttribute(!0,{storage:r,default:i?2:void 0,name:n?"innerStroke.width":void 0}),scalingMethod:e.createAttribute(!0,{storage:r,default:i?"fixed":void 0,name:n?"innerStroke.scalingMethod":void 0}),color:e.createAttribute(!0,{storage:r,default:i?"white":void 0,name:n?"innerStroke.color":void 0}),minVisibleSize:e.createAttribute(!0,{storage:r,default:i?12:void 0,name:n?"innerStroke.minVisibleSize":void 0})},outerStroke:{width:e.createAttribute(!0,{storage:r,default:i?5:void 0,name:n?"outerStroke.width":void 0}),scalingMethod:e.createAttribute(!0,{storage:r,default:i?"fixed":void 0,name:n?"outerStroke.scalingMethod":void 0}),color:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"outerStroke.color":void 0}),minVisibleSize:e.createAttribute(!0,{storage:r,default:i?0:void 0,name:n?"outerStroke.minVisibleSize":void 0})},badges:{topLeft:{color:e.createAttribute(!0,{storage:r,default:i?"white":void 0,name:n?"badges.topLeft.color":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?.45:void 0,name:n?"badges.topLeft.scale":void 0}),positionScale:e.createAttribute(!0,{storage:r,default:i?1:void 0,name:n?"badges.topLeft.positionScale":void 0}),minVisibleSize:e.createAttribute(!0,{storage:r,default:i?12:void 0,name:n?"badges.topLeft.minVisibleSize":void 0}),image:{url:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"badges.topLeft.image.url":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?1:void 0,name:n?"badges.topLeft.image.scale":void 0})},stroke:{color:e.createAttribute(!0,{storage:r,default:i?"black":void 0,name:n?"badges.topLeft.stroke.color":void 0}),width:e.createAttribute(!0,{storage:r,default:i?2:void 0,name:n?"badges.topLeft.stroke.width":void 0}),scalingMethod:e.createAttribute(!0,{storage:r,default:i?"fixed":void 0,name:n?"badges.topLeft.stroke.scalingMethod":void 0})},text:{content:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"badges.topLeft.text.content":void 0}),color:e.createAttribute(!0,{storage:r,default:i?"black":void 0,name:n?"badges.topLeft.text.color":void 0}),font:e.createAttribute(!0,{storage:r,default:i?"Arial":void 0,name:n?"badges.topLeft.text.font":void 0}),style:e.createAttribute(!0,{storage:r,default:i?"normal":void 0,name:n?"badges.topLeft.text.style":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?.5:void 0,name:n?"badges.topLeft.text.scale":void 0})}},topRight:{color:e.createAttribute(!0,{storage:r,default:i?"white":void 0,name:n?"badges.topRight.color":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?.45:void 0,name:n?"badges.topRight.scale":void 0}),positionScale:e.createAttribute(!0,{storage:r,default:i?1:void 0,name:n?"badges.topRight.positionScale":void 0}),minVisibleSize:e.createAttribute(!0,{storage:r,default:i?12:void 0,name:n?"badges.topRight.minVisibleSize":void 0}),image:{url:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"badges.topRight.image.url":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?1:void 0,name:n?"badges.topRight.image.scale":void 0})},stroke:{color:e.createAttribute(!0,{storage:r,default:i?"black":void 0,name:n?"badges.topRight.stroke.color":void 0}),width:e.createAttribute(!0,{storage:r,default:i?2:void 0,name:n?"badges.topRight.stroke.width":void 0}),scalingMethod:e.createAttribute(!0,{storage:r,default:i?"fixed":void 0,name:n?"badges.topRight.stroke.scalingMethod":void 0})},text:{content:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"badges.topRight.text.content":void 0}),color:e.createAttribute(!0,{storage:r,default:i?"black":void 0,name:n?"badges.topRight.text.color":void 0}),font:e.createAttribute(!0,{storage:r,default:i?"Arial":void 0,name:n?"badges.topRight.text.font":void 0}),style:e.createAttribute(!0,{storage:r,default:i?"normal":void 0,name:n?"badges.topRight.text.style":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?.5:void 0,name:n?"badges.topRight.text.scale":void 0})}},bottomLeft:{color:e.createAttribute(!0,{storage:r,default:i?"white":void 0,name:n?"badges.bottomLeft.color":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?.45:void 0,name:n?"badges.bottomLeft.scale":void 0}),positionScale:e.createAttribute(!0,{storage:r,default:i?1:void 0,name:n?"badges.bottomLeft.positionScale":void 0}),minVisibleSize:e.createAttribute(!0,{storage:r,default:i?12:void 0,name:n?"badges.bottomLeft.minVisibleSize":void 0}),image:{url:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"badges.bottomLeft.image.url":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?1:void 0,name:n?"badges.bottomLeft.image.scale":void 0})},stroke:{color:e.createAttribute(!0,{storage:r,default:i?"black":void 0,name:n?"badges.bottomLeft.stroke.color":void 0}),width:e.createAttribute(!0,{storage:r,default:i?2:void 0,name:n?"badges.bottomLeft.stroke.width":void 0}),scalingMethod:e.createAttribute(!0,{storage:r,default:i?"fixed":void 0,name:n?"badges.bottomLeft.stroke.scalingMethod":void 0})},text:{content:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"badges.bottomLeft.text.content":void 0}),color:e.createAttribute(!0,{storage:r,default:i?"black":void 0,name:n?"badges.bottomLeft.text.color":void 0}),font:e.createAttribute(!0,{storage:r,default:i?"Arial":void 0,name:n?"badges.bottomLeft.text.font":void 0}),style:e.createAttribute(!0,{storage:r,default:i?"normal":void 0,name:n?"badges.bottomLeft.text.style":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?.5:void 0,name:n?"badges.bottomLeft.text.scale":void 0})}},bottomRight:{color:e.createAttribute(!0,{storage:r,default:i?"white":void 0,name:n?"badges.bottomRight.color":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?.45:void 0,name:n?"badges.bottomRight.scale":void 0}),positionScale:e.createAttribute(!0,{storage:r,default:i?1:void 0,name:n?"badges.bottomRight.positionScale":void 0}),minVisibleSize:e.createAttribute(!0,{storage:r,default:i?12:void 0,name:n?"badges.bottomRight.minVisibleSize":void 0}),image:{url:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"badges.bottomRight.image.url":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?1:void 0,name:n?"badges.bottomRight.image.scale":void 0})},stroke:{color:e.createAttribute(!0,{storage:r,default:i?"black":void 0,name:n?"badges.bottomRight.stroke.color":void 0}),width:e.createAttribute(!0,{storage:r,default:i?2:void 0,name:n?"badges.bottomRight.stroke.width":void 0}),scalingMethod:e.createAttribute(!0,{storage:r,default:i?"fixed":void 0,name:n?"badges.bottomRight.stroke.scalingMethod":void 0})},text:{content:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"badges.bottomRight.text.content":void 0}),color:e.createAttribute(!0,{storage:r,default:i?"black":void 0,name:n?"badges.bottomRight.text.color":void 0}),font:e.createAttribute(!0,{storage:r,default:i?"Arial":void 0,name:n?"badges.bottomRight.text.font":void 0}),style:e.createAttribute(!0,{storage:r,default:i?"normal":void 0,name:n?"badges.bottomRight.text.style":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?.5:void 0,name:n?"badges.bottomRight.text.scale":void 0})}}},halo:{color:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"halo.color":void 0}),width:e.createAttribute(!0,{storage:r,default:i?50:void 0,name:n?"halo.width":void 0}),scalingMethod:e.createAttribute(!0,{storage:r,default:i?"fixed":void 0,name:n?"halo.scalingMethod":void 0}),strokeColor:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"halo.strokeColor":void 0}),strokeWidth:e.createAttribute(!0,{storage:r,default:i?1:void 0,name:n?"halo.strokeWidth":void 0}),clustering:e.createAttribute(!0,{storage:r,default:!i&&void 0,name:n?"halo.clustering":void 0}),hideNonAdjacentEdges:e.createAttribute(!0,{storage:r,default:!i&&void 0,name:n?"halo.hideNonAdjacentEdges":void 0})},pulse:{enabled:e.createAttribute(!0,{storage:r,default:!i&&void 0,name:n?"pulse.enabled":void 0}),duration:e.createAttribute(!0,{storage:r,default:i?1e3:void 0,name:n?"pulse.duration":void 0}),interval:e.createAttribute(!0,{storage:r,default:i?800:void 0,name:n?"pulse.interval":void 0}),startColor:e.createAttribute(!0,{storage:r,default:i?"rgba(0, 0, 0, 0.6)":void 0,name:n?"pulse.startColor":void 0}),endColor:e.createAttribute(!0,{storage:r,default:i?"rgba(0, 0, 0, 0)":void 0,name:n?"pulse.endColor":void 0}),width:e.createAttribute(!0,{storage:r,default:i?50:void 0,name:n?"pulse.width":void 0}),startRatio:e.createAttribute(!0,{storage:r,default:i?1:void 0,name:n?"pulse.startRatio":void 0}),endRatio:e.createAttribute(!0,{storage:r,default:i?2:void 0,name:n?"pulse.endRatio":void 0})},icon:{content:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"icon.content":void 0}),font:e.createAttribute(!0,{storage:r,default:i?"Arial":void 0,name:n?"icon.font":void 0}),color:e.createAttribute(!0,{storage:r,default:i?"black":void 0,name:n?"icon.color":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?.7:void 0,name:n?"icon.scale":void 0}),style:e.createAttribute(!0,{storage:r,default:i?"normal":void 0,name:n?"icon.style":void 0}),minVisibleSize:e.createAttribute(!0,{storage:r,default:i?12:void 0,name:n?"icon.minVisibleSize":void 0})},image:{url:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"image.url":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?1:void 0,name:n?"image.scale":void 0}),fit:e.createAttribute(!0,{storage:r,default:!!i||void 0,name:n?"image.fit":void 0}),tile:e.createAttribute(!0,{storage:r,default:!i&&void 0,name:n?"image.tile":void 0}),minVisibleSize:e.createAttribute(!0,{storage:r,default:i?12:void 0,name:n?"image.minVisibleSize":void 0})},outline:{enabled:e.createAttribute(!0,{storage:r,default:!i&&void 0,name:n?"outline.enabled":void 0}),color:e.createAttribute(!0,{storage:r,default:i?"rgba(0, 0, 0, 0.36)":void 0,name:n?"outline.color":void 0}),minVisibleSize:e.createAttribute(!0,{storage:r,default:i?12:void 0,name:n?"outline.minVisibleSize":void 0})},text:{content:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"text.content":void 0}),font:e.createAttribute(!0,{storage:r,default:i?"Arial":void 0,name:n?"text.font":void 0}),color:e.createAttribute(!0,{storage:r,default:i?"black":void 0,name:n?"text.color":void 0}),size:e.createAttribute(!0,{storage:r,default:i?12:void 0,name:n?"text.size":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?.1:void 0,name:n?"text.scale":void 0}),style:e.createAttribute(!0,{storage:r,default:i?"normal":void 0,name:n?"text.style":void 0}),align:e.createAttribute(!0,{storage:r,default:i?"center":void 0,name:n?"text.align":void 0}),margin:e.createAttribute(!0,{storage:r,default:i?10:void 0,name:n?"text.margin":void 0}),padding:e.createAttribute(!0,{storage:r,default:i?2:void 0,name:n?"text.padding":void 0}),backgroundColor:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"text.backgroundColor":void 0}),tip:e.createAttribute(!0,{storage:r,default:!!i||void 0,name:n?"text.tip":void 0}),minVisibleSize:e.createAttribute(!0,{storage:r,default:i?24:void 0,name:n?"text.minVisibleSize":void 0}),scaling:e.createAttribute(!0,{storage:r,default:!i&&void 0,name:n?"text.scaling":void 0}),position:e.createAttribute(!0,{storage:r,default:i?"bottom":void 0,name:n?"text.position":void 0}),maxLineLength:e.createAttribute(!0,{storage:r,default:i?0:void 0,name:n?"text.maxLineLength":void 0}),truncateLength:e.createAttribute(!0,{storage:r,default:i?0:void 0,name:n?"text.truncateLength":void 0}),secondary:{content:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"text.secondary.content":void 0}),font:e.createAttribute(!0,{storage:r,default:i?"Arial":void 0,name:n?"text.secondary.font":void 0}),color:e.createAttribute(!0,{storage:r,default:i?"black":void 0,name:n?"text.secondary.color":void 0}),size:e.createAttribute(!0,{storage:r,default:i?10:void 0,name:n?"text.secondary.size":void 0}),scale:e.createAttribute(!0,{storage:r,default:i?.08:void 0,name:n?"text.secondary.scale":void 0}),style:e.createAttribute(!0,{storage:r,default:i?"normal":void 0,name:n?"text.secondary.style":void 0}),align:e.createAttribute(!0,{storage:r,default:i?"center":void 0,name:n?"text.secondary.align":void 0}),margin:e.createAttribute(!0,{storage:r,default:i?5:void 0,name:n?"text.secondary.margin":void 0}),padding:e.createAttribute(!0,{storage:r,default:i?2:void 0,name:n?"text.secondary.padding":void 0}),backgroundColor:e.createAttribute(!0,{storage:r,default:i?null:void 0,name:n?"text.secondary.backgroundColor":void 0}),minVisibleSize:e.createAttribute(!0,{storage:r,default:i?24:void 0,name:n?"text.secondary.minVisibleSize":void 0})}}}}function _x(e,t){var n=t.named,i=t.useDefaultValues,r="resource";return{width:e.createAttribute(!1,{storage:r,default:i?1:void 0,name:n?"width":void 0}),scalingMethod:e.createAttribute(!1,{storage:r,default:i?"scaled":void 0,name:n?"scalingMethod":void 0}),color:e.createAttribute(!1,{storage:r,default:i?"grey":void 0,name:n?"color":void 0}),opacity:e.createAttribute(!1,{storage:r,default:i?1:void 0,name:n?"opacity":void 0}),minVisibleSize:e.createAttribute(!1,{storage:r,default:i?0:void 0,name:n?"minVisibleSize":void 0}),layer:e.createAttribute(!1,{storage:r,default:i?0:void 0,name:n?"layer":void 0}),detectable:e.createAttribute(!1,{storage:r,default:!!i||void 0,name:n?"detectable":void 0}),curvature:e.createAttribute(!1,{storage:r,default:i?0:void 0,name:n?"curvature":void 0}),adjustAnchors:e.createAttribute(!1,{storage:r,default:!!i||void 0,name:n?"adjustAnchors":void 0}),shape:{type:e.createAttribute(!1,{storage:r,default:i?"line":void 0,name:n?"shape.type":void 0}),head:e.createAttribute(!1,{storage:r,default:i?null:void 0,name:n?"shape.head":void 0}),tail:e.createAttribute(!1,{storage:r,default:i?null:void 0,name:n?"shape.tail":void 0}),style:e.createAttribute(!1,{storage:r,default:i?"plain":void 0,name:n?"shape.style":void 0})},stroke:{color:e.createAttribute(!1,{storage:r,default:i?"inherit":void 0,name:n?"stroke.color":void 0}),width:e.createAttribute(!1,{storage:r,default:i?0:void 0,name:n?"stroke.width":void 0}),scalingMethod:e.createAttribute(!1,{storage:r,default:i?"fixed":void 0,name:n?"stroke.scalingMethod":void 0}),minVisibleSize:e.createAttribute(!1,{storage:r,default:i?0:void 0,name:n?"stroke.minVisibleSize":void 0})},halo:{color:e.createAttribute(!1,{storage:r,default:i?null:void 0,name:n?"halo.color":void 0}),width:e.createAttribute(!1,{storage:r,default:i?10:void 0,name:n?"halo.width":void 0}),scalingMethod:e.createAttribute(!1,{storage:r,default:i?"fixed":void 0,name:n?"halo.scalingMethod":void 0})},pulse:{enabled:e.createAttribute(!1,{storage:r,default:!i&&void 0,name:n?"pulse.enabled":void 0}),duration:e.createAttribute(!1,{storage:r,default:i?1e3:void 0,name:n?"pulse.duration":void 0}),interval:e.createAttribute(!1,{storage:r,default:i?800:void 0,name:n?"pulse.interval":void 0}),startColor:e.createAttribute(!1,{storage:r,default:i?"rgba(0, 0, 0, 0.6)":void 0,name:n?"pulse.startColor":void 0}),endColor:e.createAttribute(!1,{storage:r,default:i?"rgba(0, 0, 0, 0)":void 0,name:n?"pulse.endColor":void 0}),width:e.createAttribute(!1,{storage:r,default:i?10:void 0,name:n?"pulse.width":void 0}),startRatio:e.createAttribute(!1,{storage:r,default:i?1:void 0,name:n?"pulse.startRatio":void 0}),endRatio:e.createAttribute(!1,{storage:r,default:i?2:void 0,name:n?"pulse.endRatio":void 0})},outline:{enabled:e.createAttribute(!1,{storage:r,default:!i&&void 0,name:n?"outline.enabled":void 0}),color:e.createAttribute(!1,{storage:r,default:i?"rgba(0, 0, 0, 0.36)":void 0,name:n?"outline.color":void 0}),minVisibleSize:e.createAttribute(!1,{storage:r,default:i?0:void 0,name:n?"outline.minVisibleSize":void 0})},text:{content:e.createAttribute(!1,{storage:r,default:i?null:void 0,name:n?"text.content":void 0}),font:e.createAttribute(!1,{storage:r,default:i?"Arial":void 0,name:n?"text.font":void 0}),color:e.createAttribute(!1,{storage:r,default:i?"black":void 0,name:n?"text.color":void 0}),size:e.createAttribute(!1,{storage:r,default:i?12:void 0,name:n?"text.size":void 0}),scale:e.createAttribute(!1,{storage:r,default:i?1:void 0,name:n?"text.scale":void 0}),style:e.createAttribute(!1,{storage:r,default:i?"normal":void 0,name:n?"text.style":void 0}),align:e.createAttribute(!1,{storage:r,default:i?"center":void 0,name:n?"text.align":void 0}),margin:e.createAttribute(!1,{storage:r,default:i?2:void 0,name:n?"text.margin":void 0}),padding:e.createAttribute(!1,{storage:r,default:i?2:void 0,name:n?"text.padding":void 0}),backgroundColor:e.createAttribute(!1,{storage:r,default:i?null:void 0,name:n?"text.backgroundColor":void 0}),minVisibleSize:e.createAttribute(!1,{storage:r,default:i?4:void 0,name:n?"text.minVisibleSize":void 0}),adjustAngle:e.createAttribute(!1,{storage:r,default:!!i||void 0,name:n?"text.adjustAngle":void 0}),scaling:e.createAttribute(!1,{storage:r,default:!i&&void 0,name:n?"text.scaling":void 0}),maxLineLength:e.createAttribute(!1,{storage:r,default:i?0:void 0,name:n?"text.maxLineLength":void 0}),secondary:{content:e.createAttribute(!1,{storage:r,default:i?null:void 0,name:n?"text.secondary.content":void 0}),font:e.createAttribute(!1,{storage:r,default:i?"Arial":void 0,name:n?"text.secondary.font":void 0}),color:e.createAttribute(!1,{storage:r,default:i?"black":void 0,name:n?"text.secondary.color":void 0}),size:e.createAttribute(!1,{storage:r,default:i?12:void 0,name:n?"text.secondary.size":void 0}),scale:e.createAttribute(!1,{storage:r,default:i?.8:void 0,name:n?"text.secondary.scale":void 0}),style:e.createAttribute(!1,{storage:r,default:i?"normal":void 0,name:n?"text.secondary.style":void 0}),align:e.createAttribute(!1,{storage:r,default:i?"center":void 0,name:n?"text.secondary.align":void 0}),margin:e.createAttribute(!1,{storage:r,default:i?2:void 0,name:n?"text.secondary.margin":void 0}),padding:e.createAttribute(!1,{storage:r,default:i?2:void 0,name:n?"text.secondary.padding":void 0}),backgroundColor:e.createAttribute(!1,{storage:r,default:i?null:void 0,name:n?"text.secondary.backgroundColor":void 0}),minVisibleSize:e.createAttribute(!1,{storage:r,default:i?4:void 0,name:n?"text.secondary.minVisibleSize":void 0})}}}}var mx=(on.prototype._getLayerById=function(e){for(var t=0;t<this._layers.length;++t){var n=this._layers[t];if(n.id===e)return n.index=t,n}throw new Error("usage of a destroyed style rule or class")},on.prototype._fetch=function(e){return e.isNode?this._nodes:this._edges},on.prototype.getFlexArrays=function(){return{nodes:{current:this._nodes.getAttributeFlexArrays(),previous:this._nodes.getPrevAttributeFlexArrays()},edges:{current:this._edges.getAttributeFlexArrays(),previous:this._edges.getPrevAttributeFlexArrays()}}},on.prototype.createFlexArrays=function(){return{nodes:this._nodes.createFlexArrays(),edges:this._edges.createFlexArrays()}},on.prototype.clear=function(){this._updateOngoing=!1,this._needUpdate=!1,this._destroyedLayers=[],this._nodes.clear(),this._edges.clear(),this.updateAllForAllAttributeLayers()},on.prototype.redrawElements=function(e){e.size&&(this._fetch(e).redrawElements(e),this._dom.refresh())},on.prototype.redrawAll=function(){this._nodes.redrawAll(),this._edges.redrawAll(),this._dom.refresh()},on.prototype._triggerUpdate=function(){this._needUpdate=!0,this._dom.refresh()},on.prototype._reconstructAttributeLayersIfNecessary=function(){return!!this._layersNeedUpdate&&(this._reconstructAttributeLayers(),this._layersNeedUpdate=!1,this._dom.refresh(),!0)},on.prototype.getAnimationInformation=function(e){return this._fetch(e).getAnimationInformation(e)},on.prototype.update=function(){if(!this._needUpdate||this._updateOngoing||!this._ogma._token)return!1;this._reconstructAttributeLayersIfNecessary(),this._updateOngoing=!0,this._nodes.startUpdate(),this._edges.startUpdate();for(var e=0,t=this._destroyedLayers;e<t.length;e++)(r=t[e]).initialized&&(this._nodes.notifyLayerDestroyed(r.nodes),this._edges.notifyLayerDestroyed(r.edges));for(var n=0,i=this._layers;n<i.length;n++){var r,o=(r=i[n]).nodes,a=r.edges;this._nodes.prepareFlexArraysUpdate(o),this._edges.prepareFlexArraysUpdate(a),this._nodes.updateFlexArrays(o),this._edges.updateFlexArrays(a)}return this._nodes.endUpdate(),this._edges.endUpdate(),this._updateOngoing=!1,!(this._needUpdate=!1)},on.prototype.setAttributeLayerValues=function(e,t,n,i){var r=this._getLayerById(e),o=t.isNode?r.nodes:r.edges;this._reconstructAttributeLayersIfNecessary(),this._fetch(t).setAttributeValues(o,t,n,i),this._updateElementsForAttributeLayers([r],t)},on.prototype.getAttributeLayerFlexArrays=function(e){var t=this._getLayerById(e);return{nodes:t.nodes.outputFlexArrays,edges:t.edges.outputFlexArrays}},on.prototype.getUsedAttributeLayerAttributes=function(e,t){var n=this._getLayerById(e);return this._fetch(t).getUsedAttributeNames(t.isNode?n.nodes:n.edges)},on.prototype.getAndResetElementsUpdated=function(){return{nodes:this._nodes.getAndResetElementsUpdated(),edges:this._edges.getAndResetElementsUpdated(),nodeAttributes:this._nodes.getAndResetAttributesUpdated(),edgeAttributes:this._edges.getAndResetAttributesUpdated()}},on.prototype.getAndResetElementsToRedraw=function(){return{nodes:this._nodes.getAndResetElementsToRedraw(),edges:this._edges.getAndResetElementsToRedraw()}},on.prototype.addAttributeLayer=function(e){if(void 0===e&&(e={}),e.name&&this._layers.find(function(n){return n.name===e.name}))throw new Error('attribute layer with name "'+e.name+'" already exists');var t={id:++this._layerIdCounter,name:e.name,tag:e.tag,priority:0,depsNodeSelf:[],depsNodeAdjacentNodes:[],depsNodeAdjacentEdges:[],depsNodeAllNodes:[],depsNodeAllEdges:[],depsEdgeSelf:[],depsEdgeExtremities:[],depsEdgeParallelEdges:[],depsEdgeAllNodes:[],depsEdgeAllEdges:[],initialized:!1,nodes:{type:"node",name:e.name,standaloneSelector:!!e.standaloneSelectors,toUpdate:new _l({graph:this._graph,isNode:!0,includeRemovedElements:!1}),outputFlexArrays:this._nodes.createFlexArrays(),inputFlexArrays:null,formattedDependencies:null,formattedOutput:null},edges:{type:"edge",name:e.name,standaloneSelector:!!e.standaloneSelectors,toUpdate:new _l({graph:this._graph,isNode:!1,includeRemovedElements:!1}),outputFlexArrays:this._edges.createFlexArrays(),inputFlexArrays:null,formattedDependencies:null,formattedOutput:null}};return this._layers.push(t),this._updateLayer(t,e),new K0(this,this._layerIdCounter)},on.prototype._reconstructAttributeLayers=function(){this._layers.sort(function(V,X){return V.priority-X.priority});for(var e=sn(this._nodes.getDefaultFlexArrays()),t=sn(this._edges.getDefaultFlexArrays()),n=Ei(e),i=Ei(t),r=0,o=this._layers;r<o.length;r++)(L=o[r]).nodes.allAttributePaths=n,L.edges.allAttributePaths=i,L.nodes.formattedDependencies=hx(L.nodes),L.edges.formattedDependencies=px(L.edges),L.nodes.formattedOutput=Nf(L.nodes,L.tag),L.edges.formattedOutput=Nf(L.edges,L.tag),L.nodes.redrawAdjacentEdges=L.nodes.formattedOutput.attributes.some(function(V){return dx[V]}),L.initialized=!0;for(var a=0,s=this._layers;a<s.length;a++){(L=s[a]).nodes.inputFlexArrays=sn(e),L.edges.inputFlexArrays=sn(t),L.depsNodeSelf=[],L.depsNodeAdjacentNodes=[],L.depsNodeAdjacentEdges=[],L.depsNodeAllNodes=[],L.depsNodeAllEdges=[],L.depsEdgeSelf=[],L.depsEdgeExtremities=[],L.depsEdgeParallelEdges=[],L.depsEdgeAllNodes=[],L.depsEdgeAllEdges=[],L.nodes.toUpdate.addAll(),L.edges.toUpdate.addAll();for(var l=0,u=L.nodes.formattedOutput.attributes;l<u.length;l++){var d=bn(e,p=u[l]);(g=bn(L.nodes.outputFlexArrays,p)).setFallback(d),Yt(e,p,g)}for(var c=0,h=L.edges.formattedOutput.attributes;c<h.length;c++){var p,g;d=bn(t,p=h[c]),(g=bn(L.edges.outputFlexArrays,p)).setFallback(d),Yt(t,p,g)}for(var m=0,x=this._layers;m<x.length;m++){var v=x[m];if(L!==v){var y=L.priority,b=v.priority,S=L.nodes.formattedOutput,w=L.edges.formattedOutput,M=v.nodes.formattedDependencies,N=v.edges.formattedDependencies;yo(L.depsNodeSelf,v,S,M.self,y,b),yo(L.depsNodeAdjacentNodes,v,S,M.adjacentNodes,y,b),yo(L.depsNodeAdjacentEdges,v,w,N.extremities,y,b),yo(L.depsNodeAllNodes,v,S,M.allNodes,y,b),yo(L.depsNodeAllEdges,v,w,N.allNodes,y,b),yo(L.depsEdgeSelf,v,w,N.self,y,b),yo(L.depsEdgeExtremities,v,S,M.adjacentEdges,y,b),yo(L.depsEdgeParallelEdges,v,w,N.parallelEdges,y,b),yo(L.depsEdgeAllNodes,v,S,M.allEdges,y,b),yo(L.depsEdgeAllEdges,v,w,N.allEdges,y,b)}}}this._nodes.setLastFlexArrays(e),this._edges.setLastFlexArrays(t);for(var D=0,P=this._layers;D<P.length;D++){var L;(L=P[D]).nodes.needAdjacentElements=L.nodes.redrawAdjacentEdges||0<L.depsNodeAdjacentNodes.length||0<L.depsNodeAdjacentEdges.length,L.edges.needAdjacentElements=0<L.depsEdgeExtremities.length||0<L.depsEdgeParallelEdges.length}},on.prototype._updateLayer=function(e,t){void 0===t&&(t={});var n=t.priority,i=t.fullOverwrite,r=t.nodeAttributes,o=t.nodeSelector,a=t.nodeContext,s=t.nodeDependencies,l=t.nodeOutput,u=t.edgeAttributes,d=t.edgeSelector,c=t.edgeContext,h=t.edgeDependencies,p=t.edgeOutput;void 0!==r&&(e.nodes.attributes=i?r:nr(e.nodes.attributes,r)),void 0!==o&&(e.nodes.selector=o),void 0!==a&&(e.nodes.context=a),void 0!==s&&(e.nodes.dependencies=s),void 0!==l&&(e.nodes.output=l),void 0!==u&&(e.edges.attributes=i?u:nr(e.edges.attributes,u)),void 0!==d&&(e.edges.selector=d),void 0!==c&&(e.edges.context=c),void 0!==h&&(e.edges.dependencies=h),void 0!==p&&(e.edges.output=p),void 0!==n&&(e.priority=n),this._triggerLayerUpdate()},on.prototype._triggerLayerUpdate=function(){this._layersNeedUpdate=!0,this._triggerUpdate()},on.prototype.updateAllForAttributeLayer=function(e){var t=this._getLayerById(e);this._updateAllForAttributeLayer(t)},on.prototype.updateAllForAllAttributeLayers=function(){for(var e=0,t=this._layers;e<t.length;e++)this._updateAllForAttributeLayer(t[e])},on.prototype._updateAllForAttributeLayer=function(e,t,n){if(void 0===t&&(t=!0),void 0===n&&(n=!0),t&&!e.nodes.toUpdate.isFull()){e.nodes.toUpdate.addAll();for(var i=0,r=e.depsNodeSelf;i<r.length;i++){var o=r[i];this._updateAllForAttributeLayer(o,!0,!1)}for(var a=0,s=e.depsNodeAdjacentNodes;a<s.length;a++)this._updateAllForAttributeLayer(o=s[a],!0,!1);for(var l=0,u=e.depsNodeAdjacentEdges;l<u.length;l++)this._updateAllForAttributeLayer(o=u[l],!1,!0);for(var d=0,c=e.depsNodeAllNodes;d<c.length;d++)this._updateAllForAttributeLayer(o=c[d],!0,!1);for(var h=0,p=e.depsNodeAllEdges;h<p.length;h++)this._updateAllForAttributeLayer(o=p[h],!1,!0)}if(n&&!e.edges.toUpdate.isFull()){e.edges.toUpdate.addAll();for(var g=0,m=e.depsEdgeSelf;g<m.length;g++)this._updateAllForAttributeLayer(o=m[g],!1,!0);for(var x=0,v=e.depsEdgeExtremities;x<v.length;x++)this._updateAllForAttributeLayer(o=v[x],!0,!1);for(var y=0,b=e.depsEdgeParallelEdges;y<b.length;y++)this._updateAllForAttributeLayer(o=b[y],!1,!0);for(var S=0,w=e.depsEdgeAllNodes;S<w.length;S++)this._updateAllForAttributeLayer(o=w[S],!0,!1);for(var M=0,N=e.depsEdgeAllEdges;M<N.length;M++)this._updateAllForAttributeLayer(o=N[M],!1,!0)}this._triggerUpdate()},on.prototype.updateElementsForAttributeLayer=function(e,t){var n=this._getLayerById(e);this._updateElementsForAttributeLayers([n],t)},on.prototype.updateForAllAttributeLayers=function(e){this._updateElementsForAttributeLayers(this._layers,e)},on.prototype._updateElementsForAttributeLayers=function(e,t){var n=null;if(t.isNode){for(var i=0,r=e;i<r.length;i++)if(!(y=r[i]).nodes.toUpdate.isFull()){y.nodes.needAdjacentElements&&(n=n||t.fastGetAdjacentElements()),y.nodes.toUpdate.add(t);for(var o=0,a=y.depsNodeSelf;o<a.length;o++)(p=a[o]).nodes.toUpdate.add(t);for(var s=0,l=y.depsNodeAdjacentNodes;s<l.length;s++)(p=l[s]).nodes.toUpdate.add(n.nodes);for(var u=0,d=y.depsNodeAdjacentEdges;u<d.length;u++)(p=d[u]).edges.toUpdate.add(n.edges);for(var c=0,h=y.depsNodeAllNodes;c<h.length;c++){var p=h[c];this._updateAllForAttributeLayer(p,!0,!1)}for(var g=0,m=y.depsNodeAllEdges;g<m.length;g++)this._updateAllForAttributeLayer(p=m[g],!1,!0);y.nodes.redrawAdjacentEdges&&this._edges.redrawElements(n.edges)}}else for(var x=0,v=e;x<v.length;x++){var y;if(!(y=v[x]).edges.toUpdate.isFull()){y.edges.needAdjacentElements&&(n=n||t.fastGetAdjacentElements()),y.edges.toUpdate.add(t);for(var b=0,S=y.depsEdgeSelf;b<S.length;b++)(p=S[b]).edges.toUpdate.add(t);for(var w=0,M=y.depsEdgeExtremities;w<M.length;w++)(p=M[w]).nodes.toUpdate.add(n.nodes);for(var N=0,D=y.depsEdgeParallelEdges;N<D.length;N++)(p=D[N]).edges.toUpdate.add(n.edges);for(var P=0,L=y.depsEdgeAllNodes;P<L.length;P++)this._updateAllForAttributeLayer(p=L[P],!0,!1);for(var V=0,X=y.depsEdgeAllEdges;V<X.length;V++)this._updateAllForAttributeLayer(p=X[V],!1,!0)}}this._triggerUpdate()},on.prototype.destroyAttributeLayer=function(e){var t=this._getLayerById(e);this._destroyedLayers.push(t),this._layers.splice(t.index,1),this._triggerLayerUpdate()},on.prototype.updateAttributeLayer=function(e,t){var n=this._getLayerById(e);this._updateLayer(n,t)},on.prototype.getAttributeLayerDefinition=function(e){var t=this._getLayerById(e),i=t.nodes,r=t.edges;return{priority:t.priority,nodeAttributes:i.attributes,nodeSelector:i.selector,nodeContext:i.context,nodeDependencies:i.dependencies,nodeOutput:i.output,edgeAttributes:r.attributes,edgeSelector:r.selector,edgeContext:r.context,edgeDependencies:r.dependencies,edgeOutput:r.output}},on.prototype.getAttributeValues=function(e,t,n,i){return this.update(),this._fetch(e).getAttributeValues(e,t,n,i)},on.prototype.setAnimationAttributes=function(e,t){var i=e.edges;this._nodes.setAnimationAttributes(e.nodes,t),this._edges.setAnimationAttributes(i,t)},on.prototype.resetAnimationAttributes=function(e){var n=e.edges;this._nodes.resetAnimationAttributes(e.nodes),this._edges.resetAnimationAttributes(n)},on.prototype.setTextHidden=function(e,t){var n=this._textHiddenSet.addOrRemoveElements(e,t);this.redrawElements(n)},on.prototype.resetTextHidden=function(){var e=this._textHiddenSet.getElements(),t=e.nodes,n=e.edges;this._textHiddenSet.clear(),this._nodes.redrawElements(t),this._edges.redrawElements(n)},on.prototype.getUsedNodeAttributes=function(){return this._nodes.getUsedAttributes()},on.prototype.getUsedEdgeAttributes=function(){return this._edges.getUsedAttributes()},on);function on(e,t,n){this._colorManager=new ou,this._layerIdCounter=0,this._layers=[],this._destroyedLayers=[],this._layersNeedUpdate=!1,this._updateOngoing=!1,this._needUpdate=!1,this._ogma=n,this._graph=e,this._dom=t,this._textHiddenSet=new hu(this._graph,"textHidden"),this._nodes=new Ff(e,this._colorManager,!0,gx),this._edges=new Ff(e,this._colorManager,!1,_x)}function ro(e,t,n){return void 0===n&&(n=0),"inherit"===e?Array.isArray(t)?t[n/(2*Math.PI)*t.length|0]:t:e}function El(e,t){var n=e(),i=Ei(n).map(function(r){var o=bn(n,r);return Array.isArray(o)?"for (var i = 0; i < "+o.length+"; ++i) {\n        target."+r+"[i] = source."+r+"[i]."+t+";\n      }\n      return target;":"target."+r+" = source."+r+"."+t+";"}).join("\n");return new Function("source, target",i)}function Pf(e){var t=e(),n=Ei(t).map(function(i){var r=bn(t,i);return Array.isArray(r)?"for (var i = 0; i < "+r.length+"; ++i) {\n        target."+i+"[i] = target."+i+"[i] || source."+i+"[i];\n      }":"target."+i+" = target."+i+" || source."+i+";"}).join("\n");return new Function("target","source",n)}function Df(e){var t=(e.getDepth()-3)%6;return 0<=t&&0!==t&&3!==t}function Rf(e,t,n,i){var r,o,a,s,l,u,d,c,h,p;r=e,o=t,l=+("scaled"===(a=n).scalingMethod.get(s=i)),u=2*a.radius.get(s),d=a.innerStroke.width.get(s),c=+("scaled"===a.innerStroke.scalingMethod.get(s)),h=a.outerStroke.width.get(s),p=+("scaled"===a.outerStroke.scalingMethod.get(s)),o.x=a.x.get(s),o.y=a.y.get(s),o.shape=a.shape.get(s),o.color=a.color.get(s),o.opacity=a.opacity.get(s),o.diameterScaled=u*l,o.diameterFixed=u*(1-l),o.innerStroke.color=ro(a.innerStroke.color.get(s),o.color),o.innerStroke.widthScaled=d*c,o.innerStroke.widthFixed=d*(1-c),o.innerStroke.minVisibleSize=a.innerStroke.minVisibleSize.get(s),o.outerStroke.color=ro(a.outerStroke.color.get(s),o.color),o.outerStroke.widthScaled=h*p,o.outerStroke.widthFixed=h*(1-p),o.halo.color=a.halo.color.get(s),o.halo.strokeColor=a.halo.strokeColor.get(s),o.icon.content=r.formatText(a.icon.content.get(s)),o.image.url=a.image.url.get(s),o.outline.enabled=a.outline.enabled.get(s),o.textHidden=!!a.textHidden.get(s),zf(e,t.texts.primary,n.text,i,t),zf(e,t.texts.secondary,n.text.secondary,i,t),Sl(e,t.badges.topLeft,n.badges.topLeft,i),Sl(e,t.badges.topRight,n.badges.topRight,i),Sl(e,t.badges.bottomLeft,n.badges.bottomLeft,i),Sl(e,t.badges.bottomRight,n.badges.bottomRight,i)}function zf(e,t,n,i,r){if(t.hidden=r.textHidden,t.content=e.formatText(n.content.get(i)),t.backgroundColor=ro(n.backgroundColor.get(i),r.color),t===r.texts.primary){var o=n;t.tip=o.tip.get(i),t.position=o.position.get(i)}else t.position="bottom"}function Sl(e,t,n,i){t.textContent=e.formatText(n.text.content.get(i)),t.imageUrl=n.image.url.get(i)}function Bf(){return{x:0,y:0,shape:"",color:"",opacity:0,diameterScaled:0,diameterFixed:0,innerStroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},outerStroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},icon:{content:"",font:"",color:"",scale:0,size:0,style:"none",minVisibleSize:0},image:{url:"",content:null,scale:0,rescale:!1,duplicate:!1,minVisibleSize:0},halo:{widthScaled:0,widthFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,color:"",strokeColor:""},outline:{enabled:!1,color:"",minVisibleSize:0},badges:{topLeft:Al(Yp),topRight:Al(Xp),bottomLeft:Al(Jp),bottomRight:Al(Qp)},textHidden:!1,texts:{primary:{hidden:!1,content:"",position:"",backgroundColor:"",tip:!1,font:"",color:"",sizeScaled:0,sizeFixed:0,style:"none",align:"left",minVisibleSize:0,margin:0,padding:0,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,isPositionCenter:!1,isPositionVertical:!1,isPositionHorizontal:!1},secondary:{hidden:!1,content:"",position:"",backgroundColor:"",tip:!1,font:"",color:"",sizeScaled:0,sizeFixed:0,style:"none",align:"left",minVisibleSize:0,margin:0,padding:0,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,isPositionCenter:!1,isPositionVertical:!1,isPositionHorizontal:!1}}}}function Al(e){return{angle:e,color:"",scale:0,positionScale:0,minVisibleSize:0,strokeColor:"",strokeWidthScaled:0,strokeWidthFixed:0,textContent:"",textFont:"",textColor:"",textScale:0,textStyle:"none",imageUrl:"",imageContent:null,imageScale:0}}function xu(e,t){var n=t||{edgeHalo:0,nodeHaloStroke:0,nodeHalo:0,edgeBody:0,edgeTextBackground:0,edgeText:0,nodeBody:0,nodeTextBackground:0,nodeText:0},i=6*(e- -1)+3;return n.edgeHalo=0,n.nodeHaloStroke=1,n.nodeHalo=2,n.edgeBody=i+0,n.edgeTextBackground=i+1,n.edgeText=i+2,n.nodeBody=i+3,n.nodeTextBackground=i+4,n.nodeText=i+5,n}function Uf(e,t){var n,i;i=t,(n=e).body=!0,n.icon=!!i.icon.content,n.image=!!i.image.url,n.pieChart=Array.isArray(i.color),n.outerStroke=!!i.outerStroke.color,n.outline=!!i.outline.enabled,n.halo=!!i.halo.color,n.haloStroke=n.halo&&!!i.halo.strokeColor,jf(e.texts.primary,t.texts.primary),jf(e.texts.secondary,t.texts.secondary),wl(e.badges.topLeft,t.badges.topLeft),wl(e.badges.topRight,t.badges.topRight),wl(e.badges.bottomLeft,t.badges.bottomLeft),wl(e.badges.bottomRight,t.badges.bottomRight)}function jf(e,t){e.text=!t.hidden&&!!t.content,e.background=e.text&&!!t.backgroundColor,e.tip=e.background&&t.tip&&"center"!==t.position}function wl(e,t){e.text=!!t.textContent,e.image=!!t.imageUrl}function Cl(e,t){e.pieceId=1,e.x1=t.x,e.y1=t.y,e.x2=t.x,e.y2=t.y,e.rectWidthOrSourceRadiusScaled=t.diameterScaled,e.rectWidthOrSourceRadiusFixed=t.diameterFixed,e.rectHeightOrTargetRadiusScaled=t.diameterScaled,e.rectHeightOrTargetRadiusFixed=t.diameterFixed,e.shape=t.shape,e.opacity=t.opacity,e.symbolicSize=t.diameterScaled,e.thicknessOrFontSizeScaled=0,e.thicknessOrFontSizeFixed=0,e.strokeWidthScaled=0,e.strokeWidthFixed=0,e.offsetScaled=0,e.offsetFixed=0,e.fillColor=null,e.strokeColor=null,e.globalMinVisibleSize=0,e.strokeMinVisibleSize=0,e.offsetAngle=0,e.curvature=0,e.dashLength=0,e.gapLength=0,e.hasHead=!1,e.hasTail=!1,e.isSelfLoop=!1,e.isText=!1}function Gf(e,t,n){var i=n.diameterScaled*t.scale,r=n.diameterFixed*t.scale,o=n.diameterScaled*t.positionScale/2,a=n.diameterFixed*t.positionScale/2;e.pieceId=1,e.shape="circle",e.x1=n.x,e.y1=n.y,e.x2=n.x,e.y2=n.y,e.rectWidthOrSourceRadiusScaled=i,e.rectWidthOrSourceRadiusFixed=r,e.rectHeightOrTargetRadiusScaled=i,e.rectHeightOrTargetRadiusFixed=r,e.thicknessOrFontSizeScaled=0,e.thicknessOrFontSizeFixed=0,e.strokeWidthScaled=t.strokeWidthScaled,e.strokeWidthFixed=t.strokeWidthFixed,e.offsetScaled=o,e.offsetFixed=a,e.pattern.type=0,e.opacity=n.opacity,e.fillColor=t.color,e.strokeColor=t.strokeColor,e.patternColor=null,e.globalMinVisibleSize=t.minVisibleSize,e.strokeMinVisibleSize=0,e.patternMinVisibleSize=0,e.offsetAngle=t.angle,e.patternScale=0,e.symbolicSize=n.diameterScaled,e.curvature=0,e.dashLength=0,e.gapLength=0,e.hasHead=!1,e.hasTail=!1,e.isSelfLoop=!1,e.isText=!1}function Zf(e,t,n){var i,r,o=0,a=0;if(t.isPositionCenter||(o+=n.innerStroke.widthScaled+n.outerStroke.widthScaled+n.diameterScaled/2,a+=n.innerStroke.widthFixed+n.outerStroke.widthFixed+n.diameterFixed/2+t.margin+t.padding),t.isPositionVertical){if(o+=t.heightScaled/2,a+=t.heightFixed/2,t===n.texts.secondary&&"bottom"===n.texts.primary.position){var s=n.texts.primary;o+=s.heightScaled,a+=s.heightFixed+s.margin+2*s.padding}}else t.isPositionHorizontal&&(o+=t.widthScaled/2,a+=t.widthFixed/2);r=0<t.sizeScaled?(i="sdf",1):(i=t.sizeFixed,0),e.pieceId=1,e.shape="square",e.x1=n.x,e.y1=n.y,e.x2=n.x,e.y2=n.y,e.rectWidthOrSourceRadiusScaled=t.widthScaled,e.rectWidthOrSourceRadiusFixed=t.widthFixed+2*t.padding,e.rectHeightOrTargetRadiusScaled=t.heightScaled,e.rectHeightOrTargetRadiusFixed=t.heightFixed+2*t.padding,e.thicknessOrFontSizeScaled=0,e.thicknessOrFontSizeFixed=0,e.strokeWidthScaled=0,e.strokeWidthFixed=0,e.offsetScaled=o,e.offsetFixed=a,e.pattern.type=0,e.pattern.attributes.size=i,e.opacity=n.opacity,e.fillColor=null,e.strokeColor=null,e.patternColor=null,e.globalMinVisibleSize=t.minVisibleSize,e.strokeMinVisibleSize=0,e.patternMinVisibleSize=0,e.offsetAngle=t.positionAngle,e.patternScale=r,e.symbolicSize=n.diameterScaled,e.curvature=0,e.dashLength=0,e.gapLength=0,e.hasHead=!1,e.hasTail=!1,e.isSelfLoop=!1,e.isText=!1}function qf(e,t,n,i,r,o){var a=r.badges,s=i.badges,l=o.badges;(function(u,d,c,h,p){if(h.halo){var g=c.halo.width.get(d),m=+("scaled"===c.halo.scalingMethod.get(d));p.halo.widthScaled=g*m,p.halo.widthFixed=g*(1-m),b=(y=p).diameterScaled+2*y.halo.widthScaled,S=y.diameterFixed+2*y.halo.widthFixed,(v=h.halo).pieceId=1,v.shape="circle",v.x1=y.x,v.y1=y.y,v.x2=y.x,v.y2=y.y,v.rectWidthOrSourceRadiusScaled=b,v.rectWidthOrSourceRadiusFixed=S,v.rectHeightOrTargetRadiusScaled=b,v.rectHeightOrTargetRadiusFixed=S,v.thicknessOrFontSizeScaled=0,v.thicknessOrFontSizeFixed=0,v.strokeWidthScaled=0,v.strokeWidthFixed=0,v.offsetScaled=0,v.offsetFixed=0,v.pattern.type=0,v.opacity=y.opacity,v.fillColor=y.halo.color,v.strokeColor=null,v.patternColor=null,v.globalMinVisibleSize=0,v.strokeMinVisibleSize=0,v.patternMinVisibleSize=0,v.offsetAngle=0,v.patternScale=0,v.symbolicSize=y.diameterScaled,v.curvature=0,v.dashLength=0,v.gapLength=0,v.hasHead=!1,v.hasTail=!1,v.isSelfLoop=!1,v.isText=!1,h.haloStroke&&(p.halo.strokeWidthScaled=0,p.halo.strokeWidthFixed=c.halo.strokeWidth.get(d),function(v,y){var b=y.diameterScaled+2*y.halo.widthScaled,S=y.diameterFixed+2*y.halo.widthFixed;v.pieceId=1,v.shape="circle",v.x1=y.x,v.y1=y.y,v.x2=y.x,v.y2=y.y,v.rectWidthOrSourceRadiusScaled=b,v.rectWidthOrSourceRadiusFixed=S,v.rectHeightOrTargetRadiusScaled=b,v.rectHeightOrTargetRadiusFixed=S,v.thicknessOrFontSizeScaled=0,v.thicknessOrFontSizeFixed=0,v.strokeWidthScaled=y.halo.strokeWidthScaled,v.strokeWidthFixed=y.halo.strokeWidthFixed,v.offsetScaled=0,v.offsetFixed=0,v.pattern.type=0,v.opacity=y.opacity,v.fillColor=null,v.strokeColor=y.halo.strokeColor,v.patternColor=null,v.globalMinVisibleSize=0,v.strokeMinVisibleSize=0,v.patternMinVisibleSize=0,v.offsetAngle=0,v.patternScale=0,v.symbolicSize=y.diameterScaled,v.curvature=0,v.dashLength=0,v.gapLength=0,v.hasHead=!1,v.hasTail=!1,v.isSelfLoop=!1,v.isText=!1}(h.haloStroke,p))}var v,y,b,S;h.outline&&(p.outline.color=c.outline.color.get(d),p.outline.minVisibleSize=c.outline.minVisibleSize.get(d),function(v,y){var b=1.1*y.diameterScaled,S=1.1*y.diameterFixed,w=.07*y.diameterScaled,M=.07*y.diameterFixed+1;y.outerStroke.color&&(w+=y.outerStroke.widthScaled/2,M+=y.outerStroke.widthFixed/2),v.pieceId=1,v.shape=y.shape,v.x1=y.x,v.y1=y.y,v.x2=y.x,v.y2=y.y,v.rectWidthOrSourceRadiusScaled=b,v.rectWidthOrSourceRadiusFixed=S,v.rectHeightOrTargetRadiusScaled=b,v.rectHeightOrTargetRadiusFixed=S,v.thicknessOrFontSizeScaled=0,v.thicknessOrFontSizeFixed=0,v.strokeWidthScaled=0,v.strokeWidthFixed=0,v.offsetScaled=w,v.offsetFixed=M,v.pattern.type=0,v.opacity=y.opacity,v.fillColor=y.outline.color,v.strokeColor=null,v.patternColor=null,v.globalMinVisibleSize=y.outline.minVisibleSize,v.strokeMinVisibleSize=0,v.patternMinVisibleSize=0,v.offsetAngle=1.5707963267948966,v.patternScale=0,v.symbolicSize=y.diameterScaled,v.curvature=0,v.dashLength=0,v.gapLength=0,v.hasHead=!1,v.hasTail=!1,v.isSelfLoop=!1,v.isText=!1}(h.outline,p)),h.outerStroke&&(p.outerStroke.minVisibleSize=c.outerStroke.minVisibleSize.get(d),function(v,y){var b=y.diameterScaled+2*y.innerStroke.widthScaled,S=y.diameterFixed+2*y.innerStroke.widthFixed;v.pieceId=1,v.shape=y.shape,v.x1=y.x,v.y1=y.y,v.x2=y.x,v.y2=y.y,v.rectWidthOrSourceRadiusScaled=b,v.rectWidthOrSourceRadiusFixed=S,v.rectHeightOrTargetRadiusScaled=b,v.rectHeightOrTargetRadiusFixed=S,v.thicknessOrFontSizeScaled=0,v.thicknessOrFontSizeFixed=0,v.strokeWidthScaled=y.outerStroke.widthScaled,v.strokeWidthFixed=y.outerStroke.widthFixed,v.offsetScaled=0,v.offsetFixed=0,v.pattern.type=0,v.opacity=y.opacity,v.fillColor=null,v.strokeColor=y.outerStroke.color,v.patternColor=null,v.globalMinVisibleSize=y.outerStroke.minVisibleSize,v.strokeMinVisibleSize=0,v.patternMinVisibleSize=0,v.offsetAngle=0,v.patternScale=0,v.symbolicSize=y.diameterScaled,v.curvature=0,v.dashLength=0,v.gapLength=0,v.hasHead=!1,v.hasTail=!1,v.isSelfLoop=!1,v.isText=!1}(h.outerStroke,p)),h.pieChart&&function(v,y){Cl(v,y),Array.isArray(y.color)&&(v.pattern.type=4,v.pattern.attributes.colors=y.color.join(";"),v.patternScale=1,v.patternMinVisibleSize=0,v.patternColor=null)}(h.pieChart,p),h.image&&(p.image.content=u.imageManager.getImage(p.image.url),p.image.fit=c.image.fit.get(d),p.image.tile=c.image.tile.get(d),p.image.scale=c.image.scale.get(d),p.image.minVisibleSize=c.image.minVisibleSize.get(d),function(v,y){var b=y.image.fit&&!y.image.tile;Cl(v,y),v.pattern.type=2,v.pattern.attributes.image=y.image.content,v.pattern.attributes.scaled=b,v.pattern.attributes.duplicated=y.image.tile,v.patternScale=b?y.image.scale:0,v.patternMinVisibleSize=y.image.minVisibleSize,v.patternColor=null}(h.image,p)),h.icon&&(p.icon.font=u.fontManager.getFont(c.icon.font.get(d)),p.icon.style=c.icon.style.get(d),p.icon.color=c.icon.color.get(d),p.icon.scale=c.icon.scale.get(d),p.icon.minVisibleSize=c.icon.minVisibleSize.get(d),function(v,y){Cl(v,y),v.pattern.type=5,v.pattern.attributes.text=y.icon.content,v.pattern.attributes.font=y.icon.font,v.pattern.attributes.style=y.icon.style,v.pattern.attributes.size="sdf",v.patternMinVisibleSize=y.icon.minVisibleSize,v.patternColor=y.icon.color,v.patternScale=y.icon.scale}(h.icon,p)),h.body&&function(v,y,b){Cl(v,y),v.fillColor=Array.isArray(y.color)?null:y.color,v.strokeColor=y.innerStroke.color,v.strokeMinVisibleSize=y.innerStroke.minVisibleSize,v.strokeWidthScaled=y.innerStroke.widthScaled,v.strokeWidthFixed=y.innerStroke.widthFixed,b&&(v.pattern.type=0)}(h.body,p,!h.pieChart&&!h.image&&!h.icon)})(t,n,i,r,o),Hf(e,t,n,i.text,r.texts.primary,o.texts.primary,o),Hf(e,t,n,i.text.secondary,r.texts.secondary,o.texts.secondary,o),Tl(e,t,n,s.topLeft,a.topLeft,l.topLeft,o),Tl(e,t,n,s.topRight,a.topRight,l.topRight,o),Tl(e,t,n,s.bottomLeft,a.bottomLeft,l.bottomLeft,o),Tl(e,t,n,s.bottomRight,a.bottomRight,l.bottomRight,o)}function Tl(e,t,n,i,r,o,a){if(r.image||r.text){var s=i.stroke.width.get(n),l=+("scaled"===i.stroke.scalingMethod.get(n));o.color=ro(i.color.get(n),a.color,o.angle),o.strokeColor=i.stroke.color.get(n),o.strokeWidthScaled=s*l,o.strokeWidthFixed=s*(1-l),o.minVisibleSize=i.minVisibleSize.get(n),o.positionScale=i.positionScale.get(n),o.scale=i.scale.get(n)}var u,d,c,h;if(r.image&&(o.imageContent=t.imageManager.getImage(o.imageUrl),o.imageScale=i.image.scale.get(n),Gf(u=r.image,d=o,a),d.imageContent?(u.pattern.type=2,u.pattern.attributes.image=d.imageContent,u.pattern.attributes.scaled=!0,u.pattern.attributes.duplicated=!1,u.patternScale=d.imageScale,u.patternMinVisibleSize=0,u.patternColor=null):(u.fillColor=null,u.strokeColor=null)),r.text){if(o.textFont=t.fontManager.getFont(i.text.font.get(n)),o.textStyle=i.text.style.get(n),o.textColor=ro(i.text.color.get(n),a.color),o.textScale=i.text.scale.get(n),1<e.measureText(o.textContent,o.textFont,o.textStyle,o.textScale).width){for(var p=0,g=0;g<o.textContent.length&&p<1;)p+=e.measureText(o.textContent[g],o.textFont,o.textStyle,o.textScale).width,g+=1;g!==o.textContent.length&&(o.textContent=o.textContent.substring(0,g-1)+"\u2025")}Gf(c=r.text,h=o,a),h.textContent&&(c.pattern.type=6,c.pattern.attributes.text=h.textContent,c.pattern.attributes.font=h.textFont,c.pattern.attributes.style=h.textStyle,c.pattern.attributes.size="sdf",c.patternMinVisibleSize=0,c.patternColor=h.textColor,c.patternScale=h.textScale),!h.imageUrl&&h.textContent||(c.fillColor=null,c.strokeColor=null)}}function Hf(e,t,n,i,r,o,a){if(r.text){var s=i,l=s.scaling.get(n);if(o.font=t.fontManager.getFont(s.font.get(n)),o.color=ro(s.color.get(n),a.color),o.style=s.style.get(n),o.align=s.align.get(n),o.minVisibleSize=s.minVisibleSize.get(n),o.margin=s.margin.get(n),o.padding=s.padding.get(n),o.maxLineLength=s.maxLineLength.get(n),o.content=Bd(o.content,o.maxLineLength),l){var u=s.scale.get(n);o.sizeScaled=a.diameterScaled*u,o.sizeFixed=a.diameterFixed*u}else o.sizeFixed=s.size.get(n),o.sizeScaled=0;var d=e.measureText(o.content,o.font,o.style);o.widthScaled=d.width*o.sizeScaled,o.widthFixed=d.width*o.sizeFixed,o.heightScaled=d.height*o.sizeScaled,o.heightFixed=d.height*o.sizeFixed,o.positionAngle=F0[o.position],o.isPositionCenter="center"===o.position,o.isPositionVertical="top"===o.position||"bottom"===o.position,o.isPositionHorizontal="left"===o.position||"right"===o.position,Zf(M=r.text,N=o,a),M.pattern.type=7,M.pattern.attributes.text=N.content,M.pattern.attributes.font=N.font,M.pattern.attributes.style=N.style,M.pattern.attributes.align=N.align,M.patternMinVisibleSize=0,M.patternColor=N.color,M.thicknessOrFontSizeScaled=N.sizeScaled,M.thicknessOrFontSizeFixed=N.sizeFixed,M.isText=!0,r.background&&(Zf(S=r.background,w=o,a),S.fillColor=w.backgroundColor,r.tip&&(c=r.tip,h=o,p=a,g=Math.ceil(h.margin/2)+1,m=p.diameterScaled/2+p.innerStroke.widthScaled+p.outerStroke.widthScaled,x=p.diameterFixed/2+p.innerStroke.widthFixed+p.outerStroke.widthFixed+g,v=P0[h.position],y=Math.cos(v),b=Math.sin(v),c.pieceId=1,c.shape="triangle",c.x1=p.x-y,c.y1=p.y-b,c.x2=p.x+y,c.y2=p.y+b,c.rectWidthOrSourceRadiusScaled=0,c.rectWidthOrSourceRadiusFixed=h.margin,c.rectHeightOrTargetRadiusScaled=0,c.rectHeightOrTargetRadiusFixed=.6666666666666666*h.margin,c.thicknessOrFontSizeScaled=0,c.thicknessOrFontSizeFixed=0,c.strokeWidthScaled=0,c.strokeWidthFixed=0,c.offsetScaled=m,c.offsetFixed=x,c.pattern.type=0,c.opacity=p.opacity,c.fillColor=h.backgroundColor,c.strokeColor=null,c.patternColor=null,c.globalMinVisibleSize=h.minVisibleSize,c.strokeMinVisibleSize=0,c.patternMinVisibleSize=0,c.offsetAngle=h.positionAngle,c.patternScale=0,c.symbolicSize=p.diameterScaled,c.curvature=0,c.dashLength=0,c.gapLength=0,c.hasHead=!1,c.hasTail=!1,c.isSelfLoop=!1))}var c,h,p,g,m,x,v,y,b,S,w,M,N}var vx=El(ba,"start"),yx=El(ba,"end"),xx=Pf(ba),bx=(Tr.prototype.drawNode=function(e){if(this._computeBlockIds(e),this._attributes.excluded.get(e))return this._freeBlocks();var t=this._engine,n=this._helper,i=e,r=xu(this._attributes.layer.get(e),this._depthInfo),o=this._attributes.animationDuration.get(e),a=0<o;if(this._prepareBlocks(a,r,i),Rf(n,this._endInput,this._attributes,e),Uf(this._endFlags,this._endInput),a&&(Rf(n,this._startInput,this._attributesPrev,e),Uf(this._startFlags,this._startInput),xx(this._endFlags,this._startFlags)),this._initComponents(this._fullComponents,this._endFlags,this._blocks),yx(this._fullComponents,this._endComponents),qf(t,n,e,this._attributes,this._endComponents,this._endInput),a&&(vx(this._fullComponents,this._startComponents),qf(t,n,e,this._attributesPrev,this._startComponents,this._startInput)),a){var s=this._attributes.animationStart.get(e),l=this._attributes.animationEasing.get(e);this._setBlocksAnimation(o,s,l)}this._endFlags.halo&&this._attributes.halo.hideNonAdjacentEdges.get(e)&&(this._blocks.halo.setStencilUsage(2),this._blocks.haloStroke.setStencilUsage(2)),this._storeBlocks()},Tr.prototype._computeBlockIds=function(e){var t=10*e,n=this._blockIds;n.body=0+t,n.text=1+t,n.textBg=2+t,n.halo=3+t,n.haloStroke=4+t},Tr.prototype._prepareBlocks=function(e,t,n){var i=this._blocks;i.body.reset(1,e,t.nodeBody,n),i.text.reset(2,e,t.nodeText,n),i.textBg.reset(1,e,t.nodeTextBackground,n),i.halo.reset(1,e,t.nodeHalo,n),i.haloStroke.reset(1,e,t.nodeHaloStroke,n)},Tr.prototype._storeBlocks=function(){var e=this._engine,t=this._blocks,n=this._blockIds;e.storeBlock(n.body,t.body),e.storeBlock(n.text,t.text),e.storeBlock(n.textBg,t.textBg),e.storeBlock(n.halo,t.halo),e.storeBlock(n.haloStroke,t.haloStroke)},Tr.prototype._freeBlocks=function(){var e=this._engine,t=this._blockIds;e.freeBlock(t.body),e.freeBlock(t.text),e.freeBlock(t.textBg),e.freeBlock(t.halo),e.freeBlock(t.haloStroke)},Tr.prototype._setBlocksAnimation=function(e,t,n){var i=this._blocks;i.body.setGlobalAnimation(e,t,n),i.text.setGlobalAnimation(e,t,n),i.textBg.setGlobalAnimation(e,t,n),i.halo.setGlobalAnimation(e,t,n),i.haloStroke.setGlobalAnimation(e,t,n)},Tr.prototype._initComponents=function(e,t,n){this._nodePatternAssigned=!1,this._initBaseComponents(e,t,n),this._initBadgeComponents(e.badges.topLeft,t.badges.topLeft,n),this._initBadgeComponents(e.badges.topRight,t.badges.topRight,n),this._initBadgeComponents(e.badges.bottomLeft,t.badges.bottomLeft,n),this._initBadgeComponents(e.badges.bottomRight,t.badges.bottomRight,n),this._initTextComponents(e.texts.primary,t.texts.primary,n),this._initTextComponents(e.texts.secondary,t.texts.secondary,n)},Tr.prototype._initBaseComponents=function(e,t,n){e.haloStroke=this._nextElement(t.haloStroke,n.haloStroke),e.halo=this._nextElement(t.halo,n.halo),e.outline=this._nextElement(t.outline,n.body),e.outerStroke=this._nextElement(t.outerStroke,n.body),e.body=this._nextElement(t.body,n.body),e.pieChart=this._getNodePatternElement(t.pieChart,n),e.image=this._getNodePatternElement(t.image,n),e.icon=this._getNodePatternElement(t.icon,n)},Tr.prototype._initBadgeComponents=function(e,t,n){e.image=this._nextElement(t.image,n.body),e.text=this._nextElement(t.text,n.body)},Tr.prototype._initTextComponents=function(e,t,n){e.background=this._nextElement(t.background,n.textBg),e.tip=this._nextElement(t.tip,n.textBg),e.text=this._nextElement(t.text,n.text)},Tr.prototype._nextElement=function(e,t){return e?t.next():this._nullElt},Tr.prototype._getNodePatternElement=function(e,t){return e?this._nodePatternAssigned?t.body.next():(this._nodePatternAssigned=!0,t.body.getCurrentElement()):this._nullElt},Tr);function Tr(e){var t=e.engine,n=e.imageManager,i=e.fontManager,r=e.formatText,o=e.attributes,a=e.attributesPrev;this._fullComponents={haloStroke:void 0,halo:void 0,outline:void 0,outerStroke:void 0,body:void 0,pieChart:void 0,image:void 0,icon:void 0,badges:{topLeft:{text:void 0,image:void 0},topRight:{text:void 0,image:void 0},bottomLeft:{text:void 0,image:void 0},bottomRight:{text:void 0,image:void 0}},texts:{primary:{text:void 0,background:void 0,tip:void 0},secondary:{text:void 0,background:void 0,tip:void 0}}},this._startComponents={haloStroke:void 0,halo:void 0,outline:void 0,outerStroke:void 0,body:void 0,pieChart:void 0,image:void 0,icon:void 0,badges:{topLeft:{text:void 0,image:void 0},topRight:{text:void 0,image:void 0},bottomLeft:{text:void 0,image:void 0},bottomRight:{text:void 0,image:void 0}},texts:{primary:{text:void 0,background:void 0,tip:void 0},secondary:{text:void 0,background:void 0,tip:void 0}}},this._endComponents={haloStroke:void 0,halo:void 0,outline:void 0,outerStroke:void 0,body:void 0,pieChart:void 0,image:void 0,icon:void 0,badges:{topLeft:{text:void 0,image:void 0},topRight:{text:void 0,image:void 0},bottomLeft:{text:void 0,image:void 0},bottomRight:{text:void 0,image:void 0}},texts:{primary:{text:void 0,background:void 0,tip:void 0},secondary:{text:void 0,background:void 0,tip:void 0}}},this._startFlags={haloStroke:void 0,halo:void 0,outline:void 0,outerStroke:void 0,body:void 0,pieChart:void 0,image:void 0,icon:void 0,badges:{topLeft:{text:void 0,image:void 0},topRight:{text:void 0,image:void 0},bottomLeft:{text:void 0,image:void 0},bottomRight:{text:void 0,image:void 0}},texts:{primary:{text:void 0,background:void 0,tip:void 0},secondary:{text:void 0,background:void 0,tip:void 0}}},this._endFlags={haloStroke:void 0,halo:void 0,outline:void 0,outerStroke:void 0,body:void 0,pieChart:void 0,image:void 0,icon:void 0,badges:{topLeft:{text:void 0,image:void 0},topRight:{text:void 0,image:void 0},bottomLeft:{text:void 0,image:void 0},bottomRight:{text:void 0,image:void 0}},texts:{primary:{text:void 0,background:void 0,tip:void 0},secondary:{text:void 0,background:void 0,tip:void 0}}},this._startInput=Bf(),this._endInput=Bf(),this._depthInfo={edgeHalo:0,nodeHaloStroke:0,nodeHalo:0,edgeBody:0,edgeTextBackground:0,edgeText:0,nodeBody:0,nodeTextBackground:0,nodeText:0},this._nodePatternAssigned=!1,this._nullElt={id:-1,valid:!0,animation:null,start:null,end:null},this._engine=t,this._attributes=o,this._attributesPrev=a,this._helper={imageManager:n,fontManager:i,formatText:r},this._blocks=Wf(function(){return t.createBlock()}),this._blockIds=Wf(function(){return 0})}function Wf(e){return{body:e(),text:e(),textBg:e(),halo:e(),haloStroke:e()}}function ba(){return{haloStroke:void 0,halo:void 0,outline:void 0,outerStroke:void 0,body:void 0,pieChart:void 0,image:void 0,icon:void 0,badges:{topLeft:{text:void 0,image:void 0},topRight:{text:void 0,image:void 0},bottomLeft:{text:void 0,image:void 0},bottomRight:{text:void 0,image:void 0}},texts:{primary:{text:void 0,background:void 0,tip:void 0},secondary:{text:void 0,background:void 0,tip:void 0}}}}function sc(e,t,n,i,r,o){var a,s,l,u,d,c,h,p,g;return s=i-e,l=r-t,n+o<(u=Math.sqrt(s*s+l*l))||u<Math.abs(n-o)?null:(g=t+l*(a=(n*n-o*o+u*u)/(2*u))/u,[[(p=e+s*a/u)+(c=(d=Math.sqrt(n*n-a*a))/u*-l),g+(h=d/u*s)],[p-c,g-h]])}function uc(e,t,n,i,r,o){if(0<=e-r&&n-r<0)return 1;if(e-r<0&&0<=n-r)return-1;if(e-r==0&&n-r==0)return 0<=t-i||0<=i-o?t-i:i-t;var a=(e-r)*(i-o)-(n-r)*(t-o);return a<0?1:0<a?-1:(e-r)*(e-r)+(t-o)*(t-o)-((n-r)*(n-r)+(i-o)*(i-o))}function Yf(e,t,n){var r=e[1],o=e[2],a=Math.abs(e[0]-t),s=Math.abs(r-n);return a+s<=o||!(o<a||o<s)&&Math.sqrt(a*a+s*s)<o+1e-12}function Xf(e,t,n,i){var r=e[0]-t,o=e[1]-n,a=e[2]-i;return r*r+o*o<a*a+1e-6}function lc(e,t,n,i,r,o,a){var s=e-Math.max(i,Math.min(o,e)),l=t-Math.max(r,Math.min(a,t));return s*s+l*l<n*n}function Jf(e,t,n,i,r,o,a,s){void 0===s&&(s={x:0,y:0});var l,u,d,c,h=s||{x:0,y:0};if(n===e){var p=e-r,g=a*a-p*p;if(g<0)return null;var m=Math.sqrt(g);d=l=e,u=o+m,c=o-m}else{var x=(i-t)/(n-e),v=t-x*e,y=v-o,b=x*x+1,S=2*(x*y-r),w=S*S-4*b*(r*r+y*y-a*a);if(w<0)return null;var M=-S,N=Math.sqrt(w),D=2*b;u=x*(l=(M+N)/D)+v,c=x*(d=(M-N)/D)+v}var P=e-l,L=t-u,V=e-d,X=t-c;return P*P+L*L<V*V+X*X?(h.x=l,h.y=u):(h.x=d,h.y=c),h}function Qf(e,t,n,i,r,o){(function(a,s,l,u,d){var vt,c=u.source,h=u.target,p=s.source.get(l),g=s.target.get(l),m=c.x.get(p),x=c.y.get(p),v=c.radius.get(p),y=c.color.get(p),b=+("scaled"===c.scalingMethod.get(p)),S=h.x.get(g),w=h.y.get(g),M=h.radius.get(g),N=h.color.get(g),D=+("scaled"===h.scalingMethod.get(g)),P="source"===(vt=s.color.get(l))?y:"target"===vt?N:vt,L=s.width.get(l),V=+("scaled"===s.scalingMethod.get(l)),X=s.stroke.width.get(l),J=+("scaled"===s.stroke.scalingMethod.get(l)),se=L0[s.shape.style.get(l)],re=s.adjustAnchors.get(l);if(a.source=p,a.target=g,a.sourceX=m,a.sourceY=x,a.targetX=S,a.targetY=w,a.sourceRadiusScaled=v*b,a.sourceRadiusFixed=v*(1-b),a.targetRadiusScaled=M*D,a.targetRadiusFixed=M*(1-D),a.widthScaled=L*V,a.widthFixed=L*(1-V),a.curvature=s.curvature.get(l),a.isSelfLoop=p===g,a.color=P,a.opacity=s.opacity.get(l),a.minVisibleSize=s.minVisibleSize.get(l),a.shape.type=s.shape.type.get(l),a.shape.head=s.shape.head.get(l),a.shape.tail=s.shape.tail.get(l),a.shape.dashLength=se.dash,a.shape.gapLength=se.gap,a.shape.isBodyTriangle="triangle"===a.shape.type,a.stroke.color=ro(s.stroke.color.get(l),P),a.stroke.widthScaled=X*J,a.stroke.widthFixed=X*(1-J),a.stroke.minVisibleSize=s.stroke.minVisibleSize.get(l),a.halo.color=s.halo.color.get(l),a.outline.enabled=s.outline.enabled.get(l),a.textHidden=1===s.textHidden.get(l),re&&(a.shape.head||a.shape.tail||"triangle"===a.shape.type)){var j=a,Y=j.curvature,he=j.sourceX,pe=j.sourceY,Ae=j.targetX,Ie=j.targetY,ot=1,at=1;if(Y){if(!j.isSelfLoop){var We=pa(he,pe,Ae,Ie,Y/2);ot=Ml(0,d,c,p,he,pe,We.x,We.y),at=Ml(0,d,h,g,Ae,Ie,We.x,We.y)}}else ot=Ml(0,d,c,p,he,pe,Ae,Ie),at=Ml(0,d,h,g,Ae,Ie,he,pe);a.sourceRadiusScaled*=ot,a.sourceRadiusFixed*=ot,a.targetRadiusScaled*=at,a.targetRadiusFixed*=at}})(t,n,i,r,o),Kf(e,t.texts.primary,n.text,i,t),Kf(e,t.texts.secondary,n.text.secondary,i,t)}function Kf(e,t,n,i,r){t.hidden=r.textHidden,t.content=e.formatText(n.content.get(i)),t.backgroundColor=ro(n.backgroundColor.get(i),r.color)}function Ml(e,t,n,i,r,o,a,s){var l=t.angle,u=Math.atan2(s-o,a-r)-l,d=1,c=0,h=null;u<-Br?u+=gu:Br<u&&(u-=gu),h=u<-Br/2?(c=Yp,n.badges.topLeft):u<0?(c=Xp,n.badges.topRight):u<Br/2?(c=Qp,n.badges.bottomRight):(c=Jp,n.badges.bottomLeft),c+=l;var p,g=h.text.content.get(i),m=h.image.url.get(i);if((p=g)||0===p||m){var x=h.positionScale.get(i),v=h.scale.get(i),y=Jf(a,s,r,o,r+(M=Math.cos(c))*x,o+(N=Math.sin(c))*x,v);if(y){var b=y.x-r,S=y.y-o,w=Math.sqrt(b*b+S*S);d=Math.max(d,w)}}if("square"===n.shape.get(i)){var M=Math.abs(Math.cos(u)),N=Math.abs(Math.sin(u)),D=1/Math.max(M,N);d=Math.max(d,D)}return d}function tg(e,t){dc(e.body,t,!0,!0),dc(e.outline,t,t.outline.enabled,!0),dc(e.halo,t,!!t.halo.color,!1),ng(e.texts.primary,t.texts.primary),ng(e.texts.secondary,t.texts.secondary)}function dc(e,t,n,i){e.body=n,e.head=n&&i&&!!t.shape.head,e.tail=n&&i&&!!t.shape.tail}function ng(e,t){e.text=!t.hidden&&!!t.content,e.background=e.text&&!!t.backgroundColor}function Ex(e,t,n,i){cc(e,t,n,i),e.thicknessOrFontSizeScaled=t.widthScaled,e.thicknessOrFontSizeFixed=t.widthFixed,e.strokeWidthScaled=t.stroke.widthScaled,e.strokeWidthFixed=t.stroke.widthFixed,e.offsetScaled=0,e.offsetFixed=0,e.fillColor=t.color,e.strokeColor=t.stroke.color,e.globalMinVisibleSize=t.minVisibleSize,e.strokeMinVisibleSize=t.stroke.minVisibleSize,e.offsetAngle=0,e.symbolicSize=t.widthScaled,e.dashLength=t.shape.dashLength,e.gapLength=t.shape.gapLength,e.hasHead=!!t.shape.head,e.hasTail=!!t.shape.tail,e.isBodyTriangle=t.shape.isBodyTriangle}function cc(e,t,n,i){e.pieceId=n,e.shape=i,e.x1=t.sourceX,e.y1=t.sourceY,e.x2=t.targetX,e.y2=t.targetY,e.rectWidthOrSourceRadiusScaled=t.sourceRadiusScaled,e.rectWidthOrSourceRadiusFixed=t.sourceRadiusFixed,e.rectHeightOrTargetRadiusScaled=t.targetRadiusScaled,e.rectHeightOrTargetRadiusFixed=t.targetRadiusFixed,e.thicknessOrFontSizeScaled=0,e.thicknessOrFontSizeFixed=0,e.strokeWidthScaled=0,e.strokeWidthFixed=0,e.offsetScaled=0,e.offsetFixed=0,e.pattern.type=0,e.opacity=t.opacity,e.fillColor=null,e.strokeColor=null,e.patternColor=null,e.globalMinVisibleSize=t.minVisibleSize,e.strokeMinVisibleSize=null,e.patternMinVisibleSize=0,e.offsetAngle=0,e.patternScale=0,e.symbolicSize=t.widthScaled,e.curvature=t.curvature,e.dashLength=0,e.gapLength=0,e.hasHead=!1,e.hasTail=!1,e.isSelfLoop=t.isSelfLoop,e.isText=!1}function Sx(e,t,n){var i=t.widthScaled+2*t.halo.widthScaled,r=t.widthFixed+2*t.halo.widthFixed;cc(e,t,n,"line"),e.thicknessOrFontSizeScaled=i,e.thicknessOrFontSizeFixed=r,e.strokeWidthScaled=0,e.strokeWidthFixed=0,e.offsetScaled=0,e.offsetFixed=0,e.fillColor=t.halo.color,e.strokeColor=null,e.globalMinVisibleSize=t.minVisibleSize,e.strokeMinVisibleSize=0,e.offsetAngle=0,e.symbolicSize=t.widthScaled,e.dashLength=0,e.gapLength=0,e.hasHead=!1,e.hasTail=!1,e.isBodyTriangle=!1}function Ax(e,t,n,i){cc(e,t,n,i),e.thicknessOrFontSizeScaled=1*t.widthScaled,e.thicknessOrFontSizeFixed=1*t.widthFixed,e.strokeWidthScaled=0,e.strokeWidthFixed=0,e.offsetScaled=.17*t.widthScaled,e.offsetFixed=.17*t.widthFixed+1,e.fillColor=t.outline.color,e.strokeColor=null,e.globalMinVisibleSize=Math.max(t.minVisibleSize,t.outline.minVisibleSize),e.strokeMinVisibleSize=0,e.offsetAngle=Math.PI/2,e.symbolicSize=t.widthScaled,e.dashLength=t.shape.dashLength,e.gapLength=t.shape.gapLength,e.hasHead=!!t.shape.head,e.hasTail=!!t.shape.tail,e.isBodyTriangle=t.shape.isBodyTriangle}function ig(e,t,n){var i=(n.widthScaled+t.heightScaled)/2+n.stroke.widthScaled,r=(n.widthFixed+t.heightFixed)/2+n.stroke.widthFixed+t.padding+t.margin;e.pieceId=5,e.shape="square",e.x1=n.sourceX,e.y1=n.sourceY,e.x2=n.targetX,e.y2=n.targetY,e.rectWidthOrSourceRadiusScaled=t.widthScaled,e.rectWidthOrSourceRadiusFixed=t.widthFixed+2*t.padding+1,e.rectHeightOrTargetRadiusScaled=t.heightScaled,e.rectHeightOrTargetRadiusFixed=t.heightFixed+2*t.padding,e.thicknessOrFontSizeScaled=0,e.thicknessOrFontSizeFixed=0,e.strokeWidthScaled=n.sourceRadiusScaled+n.targetRadiusScaled,e.strokeWidthFixed=n.sourceRadiusFixed+n.targetRadiusFixed,e.offsetScaled=i,e.offsetFixed=r,e.pattern.type=0,e.opacity=n.opacity,e.fillColor=null,e.strokeColor=null,e.patternColor=null,e.globalMinVisibleSize=Math.max(t.minVisibleSize,n.minVisibleSize),e.strokeMinVisibleSize=0,e.patternMinVisibleSize=0,e.offsetAngle=t.offsetAngle,e.patternScale=0,e.symbolicSize=n.widthScaled,e.curvature=n.curvature,e.dashLength=0,e.gapLength=0,e.hasHead=!1,e.hasTail=!1,e.isSelfLoop=n.isSelfLoop,e.isText=!1,e.adjustTextAngle=t.adjustAngle}function rg(e,t,n,i,r,o){(function(a,s,l,u){if(hc(l.body,u,Ex),l.halo.body){var d=s.halo.width.get(a),c=+("scaled"===s.halo.scalingMethod.get(a));u.halo.widthScaled=d*c,u.halo.widthFixed=d*(1-c),hc(l.halo,u,Sx)}l.outline.body&&(u.outline.color=s.outline.color.get(a),u.outline.minVisibleSize=s.outline.minVisibleSize.get(a),hc(l.outline,u,Ax))})(n,i,r,o),og(e,t,n,i.text,r.texts.primary,o.texts.primary,o),og(e,t,n,i.text.secondary,r.texts.secondary,o.texts.secondary,o)}function hc(e,t,n){n(e.body,t,2,t.shape.type),e.head&&n(e.head,t,3,t.shape.head),e.tail&&n(e.tail,t,4,t.shape.tail)}function og(e,t,n,i,r,o,a){if(r.text){var s=i,l=s.scaling.get(n);if(o.font=t.fontManager.getFont(s.font.get(n)),o.color=ro(s.color.get(n),a.color),o.style=s.style.get(n),o.minVisibleSize=s.minVisibleSize.get(n),o.margin=s.margin.get(n),o.padding=s.padding.get(n),o.maxLineLength=s.maxLineLength.get(n),o.content=Bd(o.content,o.maxLineLength),o.adjustAngle=s.adjustAngle.get(n),o.align=s.align.get(n),l){var u=s.scale.get(n);o.sizeScaled=a.widthScaled*u,o.sizeFixed=a.widthFixed*u}else o.sizeFixed=s.size.get(n),o.sizeScaled=0;var d=e.measureText(o.content,o.font,o.style);o.widthScaled=d.width*o.sizeScaled,o.widthFixed=d.width*o.sizeFixed,o.heightScaled=d.height*o.sizeScaled,o.heightFixed=d.height*o.sizeFixed,o.offsetAngle=o===a.texts.primary?k0:O0,ig(p=r.text,g=o,a),p.pattern.type=7,p.pattern.attributes.text=g.content,p.pattern.attributes.size="sdf",p.pattern.attributes.font=g.font,p.pattern.attributes.style=g.style,p.pattern.attributes.align=g.align,p.patternColor=g.color,p.patternScale=1,p.thicknessOrFontSizeScaled=g.sizeScaled,p.thicknessOrFontSizeFixed=g.sizeFixed,p.isText=!0,r.background&&(ig(c=r.background,h=o,a),c.fillColor=h.backgroundColor)}var c,h,p,g}var wx=El(Ea,"start"),Cx=El(Ea,"end"),Tx=Pf(Ea),Mx=(Ur.prototype.drawEdge=function(e){if(this._computeBlockIds(e),this._attributes.excluded.get(e))this._freeBlocks();else{var t=this._engine,n=this._helper,i=this._extremitiesAttributes,r=-e,o=xu(this._attributes.layer.get(e),this._depthInfo),a=this._attributes,s=a.source.get(e),l=a.target.get(e),u=a.curvature.get(e),d=this._attributesPrev.curvature.get(e),c=a.animationDuration.get(e),h=a.animationStart.get(e),p=a.animationEasing.get(e),g=0<c;if(this._prepareBlocks(g,o,r,0!==u||g&&0!==d),i.source=this._nodeAttributes,i.target=this._nodeAttributes,Qf(n,this._endInput,a,e,i,this._view),tg(this._endFlags,this._endInput),g){var x=0<this._nodeAttributes.animationDuration.get(s),v=0<this._nodeAttributes.animationDuration.get(l);i.source=x?this._nodeAttributesPrev:this._nodeAttributes,i.target=v?this._nodeAttributesPrev:this._nodeAttributes,Qf(n,this._startInput,this._attributesPrev,e,i,this._view),tg(this._startFlags,this._startInput),Tx(this._endFlags,this._startFlags)}this._initComponents(this._fullComponents,this._endFlags,this._blocks),Cx(this._fullComponents,this._endComponents),rg(t,n,e,this._attributes,this._endComponents,this._endInput),g&&(wx(this._fullComponents,this._startComponents),rg(t,n,e,this._attributesPrev,this._startComponents,this._startInput),this._setBlocksAnimation(c,h,p)),this._setupHaloMasking(s,l),this._storeBlocks()}},Ur.prototype._setupHaloMasking=function(e,t){var n=this._nodeAttributes.halo,i=this._blocks,r=n.color.get(e)&&n.hideNonAdjacentEdges.get(e),o=n.color.get(t)&&n.hideNonAdjacentEdges.get(t),a=r||o?1:3;i.body.setStencilUsage(a),i.text.setStencilUsage(a),i.textBg.setStencilUsage(a)},Ur.prototype._computeBlockIds=function(e){var t=10*e,n=this._blockIds;n.body=5+t,n.halo=8+t,n.text=6+t,n.textBg=7+t},Ur.prototype._prepareBlocks=function(e,t,n,i){var r=this._blocks;r.body.reset(i?3:1,e,t.edgeBody,n),r.halo.reset(i?3:1,e,t.edgeHalo,n),r.text.reset(2,e,t.edgeText,n),r.textBg.reset(1,e,t.edgeTextBackground,n)},Ur.prototype._storeBlocks=function(){var e=this._engine,t=this._blocks,n=this._blockIds;e.storeBlock(n.body,t.body),e.storeBlock(n.halo,t.halo),e.storeBlock(n.text,t.text),e.storeBlock(n.textBg,t.textBg)},Ur.prototype._freeBlocks=function(){var e=this._engine,t=this._blockIds;e.freeBlock(t.body),e.freeBlock(t.halo),e.freeBlock(t.text),e.freeBlock(t.textBg)},Ur.prototype._setBlocksAnimation=function(e,t,n){var i=this._blocks;i.body.setGlobalAnimation(e,t,n),i.halo.setGlobalAnimation(e,t,n),i.text.setGlobalAnimation(e,t,n),i.textBg.setGlobalAnimation(e,t,n)},Ur.prototype._initComponents=function(e,t,n){this._initEdgeComponents(e.halo,t.halo,n.halo),this._initEdgeComponents(e.outline,t.outline,n.body),this._initEdgeComponents(e.body,t.body,n.body),this._initTextComponents(e.texts.primary,t.texts.primary,n),this._initTextComponents(e.texts.secondary,t.texts.secondary,n)},Ur.prototype._initEdgeComponents=function(e,t,n){e.head=this._nextElement(t.head,n),e.tail=this._nextElement(t.tail,n),e.body=this._nextElement(t.body,n)},Ur.prototype._initTextComponents=function(e,t,n){e.background=this._nextElement(t.background,n.textBg),e.text=this._nextElement(t.text,n.text)},Ur.prototype._nextElement=function(e,t){return e?t.next():this._nullElt},Ur);function Ur(e){var t=e.engine,n=e.imageManager,i=e.fontManager,r=e.formatText,o=e.view,a=e.attributes,s=e.attributesPrev,l=e.nodeAttributes,u=e.nodeAttributesPrev;this._extremitiesAttributes={source:null,target:null},this._fullComponents={halo:{body:void 0,head:void 0,tail:void 0},outline:{body:void 0,head:void 0,tail:void 0},body:{body:void 0,head:void 0,tail:void 0},texts:{primary:{text:void 0,background:void 0},secondary:{text:void 0,background:void 0}}},this._startComponents={halo:{body:void 0,head:void 0,tail:void 0},outline:{body:void 0,head:void 0,tail:void 0},body:{body:void 0,head:void 0,tail:void 0},texts:{primary:{text:void 0,background:void 0},secondary:{text:void 0,background:void 0}}},this._endComponents={halo:{body:void 0,head:void 0,tail:void 0},outline:{body:void 0,head:void 0,tail:void 0},body:{body:void 0,head:void 0,tail:void 0},texts:{primary:{text:void 0,background:void 0},secondary:{text:void 0,background:void 0}}},this._startFlags={halo:{body:void 0,head:void 0,tail:void 0},outline:{body:void 0,head:void 0,tail:void 0},body:{body:void 0,head:void 0,tail:void 0},texts:{primary:{text:void 0,background:void 0},secondary:{text:void 0,background:void 0}}},this._endFlags={halo:{body:void 0,head:void 0,tail:void 0},outline:{body:void 0,head:void 0,tail:void 0},body:{body:void 0,head:void 0,tail:void 0},texts:{primary:{text:void 0,background:void 0},secondary:{text:void 0,background:void 0}}},this._startInput={source:0,target:0,sourceX:0,sourceY:0,targetX:0,targetY:0,sourceRadiusScaled:0,sourceRadiusFixed:0,targetRadiusScaled:0,targetRadiusFixed:0,widthScaled:0,widthFixed:0,curvature:0,isSelfLoop:!1,color:"",opacity:0,minVisibleSize:0,shape:{type:"line",head:null,tail:null,dashLength:0,gapLength:0,isBodyTriangle:!1},stroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},halo:{widthScaled:0,widthFixed:0,color:""},outline:{enabled:!1,color:"",minVisibleSize:0},textHidden:!1,texts:{primary:{align:"left",hidden:!1,content:"",backgroundColor:"",font:"",color:"",sizeScaled:0,sizeFixed:0,style:"none",minVisibleSize:0,margin:0,padding:0,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,adjustAngle:!1,offsetAngle:0},secondary:{align:"left",hidden:!1,content:"",backgroundColor:"",font:"",color:"",sizeScaled:0,sizeFixed:0,style:"none",minVisibleSize:0,margin:0,padding:0,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,adjustAngle:!1,offsetAngle:0}}},this._endInput={source:0,target:0,sourceX:0,sourceY:0,targetX:0,targetY:0,sourceRadiusScaled:0,sourceRadiusFixed:0,targetRadiusScaled:0,targetRadiusFixed:0,widthScaled:0,widthFixed:0,curvature:0,isSelfLoop:!1,color:"",opacity:0,minVisibleSize:0,shape:{type:"line",head:null,tail:null,dashLength:0,gapLength:0,isBodyTriangle:!1},stroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},halo:{widthScaled:0,widthFixed:0,color:""},outline:{enabled:!1,color:"",minVisibleSize:0},textHidden:!1,texts:{primary:{align:"left",hidden:!1,content:"",backgroundColor:"",font:"",color:"",sizeScaled:0,sizeFixed:0,style:"none",minVisibleSize:0,margin:0,padding:0,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,adjustAngle:!1,offsetAngle:0},secondary:{align:"left",hidden:!1,content:"",backgroundColor:"",font:"",color:"",sizeScaled:0,sizeFixed:0,style:"none",minVisibleSize:0,margin:0,padding:0,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,adjustAngle:!1,offsetAngle:0}}},this._depthInfo={edgeHalo:0,nodeHaloStroke:0,nodeHalo:0,edgeBody:0,edgeTextBackground:0,edgeText:0,nodeBody:0,nodeTextBackground:0,nodeText:0},this._nullElt={id:-1,valid:!0,animation:null,start:null,end:null},this._engine=t,this._view=o,this._helper={imageManager:n,fontManager:i,formatText:r},this._attributes=a,this._attributesPrev=s,this._nodeAttributes=l,this._nodeAttributesPrev=u,this._blocks=ag(function(){return t.createBlock()}),this._blockIds=ag(function(){return 0})}function ag(e){return{body:e(),halo:e(),text:e(),textBg:e()}}function Ea(){return{halo:{body:void 0,head:void 0,tail:void 0},outline:{body:void 0,head:void 0,tail:void 0},body:{body:void 0,head:void 0,tail:void 0},texts:{primary:{text:void 0,background:void 0},secondary:{text:void 0,background:void 0}}}}var kx=ho&&document.fonts,pc="/qwerty/ [HELLO] \uf155\uf155\uf155",Ox=(Il.prototype._measureText=function(e,t){return this._ctx.font="12px "+t,this._ctx.measureText(e).width},Il.prototype.check=function(e){if(this._checkReliable)return this._fontFaceSet.check("12px "+e);var t=this._measureText(pc,"serif");return this._measureText(pc,e)!==t},Il.prototype.load=function(e){return this._fontFaceSet&&this._fontFaceSet.load?this._fontFaceSet.load("12px "+e):(this._ctx.font="12px "+e,this._ctx.fillText(pc,10,50),Promise.resolve())},Il);function Il(){this._fontFaceSet=kx?document.fonts:null,this._canvas=ci(),this._checkReliable=this._fontFaceSet&&this._fontFaceSet.check&&!this._fontFaceSet.check("12px FontThatDoesNotExist"),this._ctx=this._canvas.getContext("2d")}var Nx=(Ka.prototype._setLoaded=function(){this._loaded=!0,this._value=this._fontName},Ka.prototype.getValue=function(){return this._value},Ka.prototype.isLoaded=function(){return this._loaded},Ka.prototype.destroy=function(){clearTimeout(this._timeout)},Ka.prototype.load=function(){var e=this;return this._tryLoad(200).then(function(){e._setLoaded()})},Ka.prototype._tryLoad=function(e){var t=this;return this._fontFaceSet.load(this._fontName).then(function(){if(!t._fontFaceSet.check(t._fontName))return new Promise(function(n){e<6e4&&(t._timeout=setTimeout(n,e))}).then(function(){return t._tryLoad(1.5*e)})})},Ka);function Ka(e,t){this._loaded=!1,this._value=null,this._timeout=null,this._fontFaceSet=e,this._fontName=t,this._loaded=!1,this._value=null,this._timeout=null,ho&&!this._fontFaceSet.check(this._fontName)||this._setLoaded()}var Lx=(Ns.prototype.setHideUntilFontsLoaded=function(e){this._hideUntilFontsLoaded=e},Ns.prototype.getFont=function(e){var t=this,n=this._fonts[e];return n||(n=new Nx(this._fontFaceSet,e),(this._fonts[e]=n).isLoaded()||n.load().then(function(){return t._triggerFontLoaded(e)})),!this._hideUntilFontsLoaded&&e||n.getValue()},Ns.prototype.onFontLoaded=function(e){this._onFontLoaded.push(e)},Ns.prototype.destroy=function(){var e=this;this._onFontLoaded=[],Object.keys(this._fonts).forEach(function(t){return e._fonts[t].destroy()})},Ns.prototype._triggerFontLoaded=function(e){this._onFontLoaded.forEach(function(t){return t(e)})},Ns);function Ns(){this._fontFaceSet=new Ox,this._fonts={},this._onFontLoaded=[],this._hideUntilFontsLoaded=!0}function bu(e,t,n){for(var i=n.length,r=i-1,o=!1,a=0;a<i;++a)(n[a].y<t&&n[r].y>=t||n[r].y<t&&n[a].y>=t)&&(n[a].x<=e||n[r].x<=e)&&(o=o!==n[a].x+(t-n[a].y)/(n[r].y-n[a].y)*(n[r].x-n[a].x)<e),r=a;return o}function kl(e){var t=e.x*e.x+e.y*e.y;return{x:e.x/t,y:e.y/t}}function sg(e,t){for(var n=1/0,i=-1/0,r=0,o=e.length;r<o;r++){var a=e[r],s=a.x*t.x+a.y*t.y;s<n&&(n=s),i<s&&(i=s)}return{x:n,y:i}}function fc(e,t){for(var n=function(l,u){var d=l[1],c=l[0],h=kl({x:d.x-c.x,y:d.y-c.y}),p=h.x;h.x=-h.y,h.y=p;var g=h;p=(h=kl({x:(d=l[2]).x-(c=l[1]).x,y:d.y-c.y})).x,h.x=-h.y,h.y=p;var m=h;p=(h=kl({x:(d=u[1]).x-(c=u[0]).x,y:d.y-c.y})).x,h.x=-h.y,h.y=p;var x=h;return p=(h=kl({x:(d=u[2]).x-(c=u[1]).x,y:d.y-c.y})).x,h.x=-h.y,h.y=p,[g,m,x,h]}(e,t),i=0,r=n.length;i<r;i++){var o=n[i],a=sg(e,o),s=sg(t,o);if(0==(a.x<=s.y&&a.y>=s.x?Math.min(a.y,s.y)-Math.max(a.x,s.x):0))return!1}return!0}function gc(e){var t=0,n=0,i=e.length;if(0===i)throw new Error("Compute centroid: at least one point is required");for(var r=0;r<i;++r){var o=e[r];t+=o.x,n+=o.y}return{x:t/=i,y:n/=i}}var Ls,vc,Fx=mc(4),Px=mc(5),Dx=mc(10,.4),Sa=1/3,Rx=[{x:-1,y:-Sa},{x:-.55,y:-Sa},{x:-1,y:-1},{x:1,y:0},{x:-1,y:1},{x:-.55,y:Sa},{x:-1,y:Sa}],ug=[{x:-.6,y:-.3},{x:.1,y:0},{x:-.6,y:.3}],zx={circle:{getDistanceFromStrokeVertically:function(e,t){return 1},getDistanceFromStrokeHorizontally:function(e,t){return 1-Math.sqrt(e*e+t*t)},points:[{x:0,y:0,r:1}],isSimple:!0},square:{getDistanceFromStrokeVertically:function(e,t){return 1-Math.abs(t)},getDistanceFromStrokeHorizontally:function(e,t){return 1-Math.abs(e)},points:[{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],isSimple:!0},line:{getDistanceFromStrokeVertically:function(e,t){return 1-Math.abs(t)},getDistanceFromStrokeHorizontally:function(e,t){return 1},points:[{x:-1,y:0},{x:1,y:0}],isSimple:!0},triangle:{getDistanceFromStrokeVertically:function(e,t){return(1-e)/2-Math.abs(t)},getDistanceFromStrokeHorizontally:function(e,t){return 1-Math.abs(e)},points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],isSimple:!0},arrow:{getDistanceFromStrokeVertically:function(e,t){return(1-e)/2-Math.abs(t)},getDistanceFromStrokeHorizontally:function(e,t){return 1-Math.abs(e)},points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],isSimple:!0},"circle-hole-arrow":{getDistanceFromStrokeVertically:function(e,t){return Math.min(Math.sqrt((e+.4)*(e+.4)+t*t)-.27,(1-e)/2-Math.abs(t))},getDistanceFromStrokeHorizontally:function(e,t){return 1-Math.abs(e)},points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],hole:[{x:-.4,y:0,r:.3}],isSimple:!0},"triangle-hole-arrow":{getDistanceFromStrokeVertically:function(e,t){var n=Math.min((1-e)/2-Math.abs(t),1-Math.abs(e)),i=-dg(e,t,ug);return Math.min(n,i)},getDistanceFromStrokeHorizontally:function(e,t){return 1},points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],hole:ug,isSimple:!0},"short-arrow":Eu([{x:-1,y:-Sa},{x:0,y:-Sa},{x:0,y:-1},{x:1,y:0},{x:0,y:1},{x:0,y:Sa},{x:-1,y:Sa}],!1),"sharp-arrow":Eu(Rx,!1),cross:{getDistanceFromStrokeVertically:function(e,t){return 1},getDistanceFromStrokeHorizontally:function(e,t){var n=Math.abs(e),i=Math.abs(t),r=.31-Math.min(n,i),o=1-Math.max(n,i);return Math.min(r,o)},points:[{x:-1,y:.31},{x:-1,y:-.31},{x:-.31,y:-.31},{x:-.31,y:-1},{x:.31,y:-1},{x:.31,y:-.31},{x:1,y:-.31},{x:1,y:.31},{x:.31,y:.31},{x:.31,y:1},{x:-.31,y:1},{x:-.31,y:.31}],isSimple:!1},diamond:Eu(Fx),pentagon:Eu(Px),star:Eu(Dx)},Bx=["circle","square","triangle","line"],Vx=["cross","diamond","pentagon","star"],Ux=["arrow","triangle-hole-arrow","circle-hole-arrow","short-arrow","sharp-arrow"];function lg(e,t){for(var n=0,i=Bx;n<i.length;n++)_c(e,i[n]);for(var r=t.nodes.current.shape.getValues(),o=t.edges.current.shape.head.getValues(),a=t.edges.current.shape.tail.getValues(),s=0,l=Vx;s<l.length;s++){var u=l[s];r.includes(u)&&_c(e,u)}for(var d=0,c=Ux;d<c.length;d++){var h=c[d];(o.includes(h)||a.includes(h))&&_c(e,h)}}function _c(e,t){e.registerShape(t,zx[t])}function dg(e,t,n){for(var i=1/0,r={x:e,y:t},o=0;o<n.length;++o)i=Math.min(i,gf(r,n[o],n[(o+1)%n.length]));return i*(bu(e,t,n)?1:-1)}function mc(e,t){void 0===t&&(t=1);for(var n=-Math.PI/2+1e-6,i=[],r=2*Math.PI/e,o=n,a=0;a<e;++a){var s=a%2==1?t:1;i.push({x:Math.cos(o)*s,y:Math.sin(o)*s}),o+=r}return i}function Eu(e,t){return void 0===t&&(t=!1),{getDistanceFromStrokeVertically:function(){return 1},getDistanceFromStrokeHorizontally:function(n,i){return dg(n,i,e)},points:e,isSimple:t}}(vc=Ls=Ls||{}).ZOOM="zoom",vc.ROTATE="rotate";var yc={duration:0,easing:"linear",startAfter:0,ignoreZoomLimits:!(vc.PAN="pan"),callback:function(){}};function Ol(e){return Math.abs(e)<1e-9}var cg,jx=(St(yn,cg=Pe),Object.defineProperty(yn.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(yn.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(yn.prototype,"zoom",{get:function(){return this._zoom},enumerable:!0,configurable:!0}),Object.defineProperty(yn.prototype,"angle",{get:function(){return this._angle},enumerable:!0,configurable:!0}),Object.defineProperty(yn.prototype,"width",{get:function(){return this._dimensions.width},enumerable:!0,configurable:!0}),Object.defineProperty(yn.prototype,"height",{get:function(){return this._dimensions.height},enumerable:!0,configurable:!0}),yn.prototype.moveEnd=function(e){var t=this;this._dom.clearTimeout(this._timeout),this._timeout=this._dom.setTimeout(function(){t._timeout=null,t._events.fire(I.VIEW_CHANGED,{type:e})},80)},yn.prototype.getSize=function(){return{width:this._dimensions.width,height:this._dimensions.height}},yn.prototype.getCenter=function(){return{x:this._x,y:this._y}},yn.prototype.setCenter=function(e,t){var n=this,i=e.x,r=e.y,o=It({},yc,t),a=this._x,s=this._y,l=i-this._x,u=r-this._y;return Ol(l)&&Ol(u)?Promise.resolve():new Promise(function(d){o.callback=function(){n.moveEnd(Ls.PAN),d()},n._moveAnimation&&n._animations.end(n._moveAnimation,!1),n._moveAnimation=n._animations.play(function(c){n._x=a+l*c,n._y=s+u*c,n._events.fire(I.CAMERA_MOVE),n._events.fire(I.CAMERA_PAN)},o)})},yn.prototype.move=function(e,t){var n=hg({x:e.x,y:e.y},this._zoom,this._sinAngle,this._cosAngle);return this.setCenter({x:this._x+n.x,y:this._y+n.y},t)},yn.prototype.getZoom=function(){return this._zoom},yn.prototype.setZoom=function(e,t,n){var i=this;void 0===n&&(n={refX:void 0,refY:void 0}),t=It({},yc,t);var r=n.refX,o=n.refY,a=me(e,this._minZoom,this._maxZoom);return t.ignoreZoomLimits||(a=this._applyZoomLimits(a)),Ol(this._zoom-a)?Promise.resolve():new Promise(function(s){var l=i._dimensions.width/2,u=i._dimensions.height/2,d=i._zoom,c=l/d-l/a;if(t.callback=function(){i.moveEnd(Ls.ZOOM),s()},void 0!==r&&void 0!==o){var h=(r-l)/d-(r-l)/a,p=(o-u)/d-(o-u)/a,g=i._cosAngle,m=i._sinAngle;i.setCenter({x:i._x+(g*h-m*p),y:i._y+(m*h+g*p)},t)}i._zoomAnimation&&i._animations.end(i._zoomAnimation,!1),i._dom.setTimeout(function(){i._events.fire(I.START_ZOOM,{duration:t.duration,easing:t.easing,startZoom:d,endZoom:a})}),i._zoomAnimation=i._animations.play(function(y){i._zoom=l/(l/d-c*y),i._events.fire(I.CAMERA_MOVE),i._events.fire(I.CAMERA_ZOOM)},t)})},yn.prototype._applyZoomLimits=function(e){var t=this._settings.get("interactions.zoom.minValue"),n=this._settings.get("interactions.zoom.maxValue"),i=this._modules.locate.getGraphBoundingBox(),r=this._zoom,o=this.getSize(),a=e;if(!isNaN(i.cx)){var s={smallestNodeSize:i.minScaledSize,biggestNodeSize:i.maxScaledSize,graphWidth:i.width+i.maxScaledSize,graphHeight:i.height+i.maxScaledSize,viewWidth:o.width,viewHeight:o.height},l=t&&t(s),u=n&&n(s);pg(l)&&a<l?a<r&&(a=Math.min(r,l)):pg(u)&&u<a&&r<a&&(a=Math.max(r,u))}return a},yn.prototype.zoomIn=function(e,t,n){return void 0===n&&(n={refX:void 0,refY:void 0}),"number"!=typeof e&&(n=t,t=e,e=this._settings.get("interactions.zoom.modifier")),this.setZoom(this._zoom*e,t,n)},yn.prototype.zoomOut=function(e,t,n){return void 0===n&&(n={refX:void 0,refY:void 0}),"number"!=typeof e&&(n=t,t=e,e=this._settings.get("interactions.zoom.modifier")),this.setZoom(this._zoom/e,t,n)},yn.prototype.getAngle=function(){return this._angle},yn.prototype.setAngle=function(e,t){var n=this;t=It({},yc,t);var i=this._angle,r=e-i;return Ol(r)?Promise.resolve():new Promise(function(o){t.callback=function(){n.moveEnd(Ls.ROTATE),o()},n._rotateAnimation&&n._animations.end(n._rotateAnimation,!1),n._rotateAnimation=n._animations.play(function(a){for(n._angle=i+r*a;n._angle>Math.PI;)n._angle-=2*Math.PI;for(;n._angle<-Math.PI;)n._angle+=2*Math.PI;n._sinAngle=Math.sin(n._angle),n._cosAngle=Math.cos(n._angle),n._events.fire(I.CAMERA_MOVE),n._events.fire(I.CAMERA_ROTATE)},t)})},yn.prototype.rotate=function(e,t){return this.setAngle(this._angle+e,t)},yn.prototype.getScreenCenter=function(){return{x:this._dimensions.width/2,y:this._dimensions.height/2}},yn.prototype.graphToScreenCoordinates=function(e,t){void 0===t&&(t={x:0,y:0});var r=this._dimensions.width/2,o=this._dimensions.height/2;return Zd((e.x-this._x)*this._zoom+r,(e.y-this._y)*this._zoom+o,r,o,-this._angle,t)},yn.prototype.screenToGraphCoordinates=function(e,t){return void 0===t&&(t={x:0,y:0}),Zd(this._x+(e.x-this._dimensions.width/2)/this._zoom,this._y+(e.y-this._dimensions.height/2)/this._zoom,this._x,this._y,this._angle,t)},yn.prototype.projectBounds=function(e,t){void 0===t&&(t=e);for(var n=e[0],i=e[1],r=e[2],o=e[3],a=this._x,s=this._y,l=this._dimensions.width/2,u=this._dimensions.height/2,d=this._sinAngle,c=this._cosAngle,h=1/this._zoom,p=1/0,g=1/0,m=-1/0,x=-1/0,v=[n,i,n,o,r,o,r,i],y=0;y<v.length;y+=2){var b=v[y],S=v[y+1],w=(b=a+(b-l)*h)-a,M=(S=s+(S-u)*h)-s;(b=c*w-d*M+a)<p&&(p=b),m<b&&(m=b),(S=d*w+c*M+s)<g&&(g=S),x<S&&(x=S)}return t[0]=p,t[1]=g,t[2]=m,t[3]=x,t},yn.prototype.screenToGraphVector=function(e){return hg({x:e.x,y:e.y},this._zoom,this._sinAngle,this._cosAngle)},yn.prototype.getView=function(){return{x:this._x,y:this._y,zoom:this._zoom,angle:this._angle,width:this._dimensions.width,height:this._dimensions.height}},yn.prototype.setView=function(e,t){var n=It({x:this._x,y:this._y,zoom:this._zoom,angle:this._angle},e),o=n.zoom,a=n.angle;return Promise.all([this.setCenter({x:n.x,y:n.y},t),this.setZoom(o,t),this.setAngle(a,t)]).then(function(){})},yn.prototype._reloadDimensions=function(){this._dimensions=this._dom.getDimensions()},yn.prototype.animationInProgress=function(){var e=this._moveAnimation,t=this._zoomAnimation;return e&&!e.done||t&&!t.done},yn.prototype.getProjectedScreenBounds=function(e){void 0===e&&(e=0);var t=this._dimensions,n=t.width,i=t.height,r=Math.max(n,i)*e;return this.projectBounds([0-r,0-r,n+r,i+r])},yn.prototype._reset=function(){this._zoom=1,this._x=0,this._y=0,this._angle=0,this._sinAngle=0,this._cosAngle=1,this._dimensions=this._dom.getDimensions()},yn);function yn(e){var t=cg.call(this)||this;return t._modules=e,t._events=e.events,t._dom=e.dom,t._animations=e.animations,t._settings=e.settings,t._zoomAnimation=null,t._moveAnimation=null,t._reset(),t._minZoom=1e-8,t._maxZoom=1e8,t._settings.register("minZoom",1e-8,function(n){t._minZoom=n,t._zoom<n&&(t._zoom=n,t._events.fire(I.CAMERA_MOVE))}),t._settings.register("maxZoom",1e8,function(n){t._maxZoom=n,t._zoom>n&&(t._zoom=n,t._events.fire(I.CAMERA_MOVE))}),t._timeout=null,t._events.on({setContainer:function(){t._reset(),t._events.fire(I.CAMERA_MOVE)},resize:function(){t._reloadDimensions(),t._events.fire(I.CAMERA_MOVE)}}),t}function hg(e,t,n,i){var r=e.x,o=e.y;return{x:i*(r/=t)-n*(o/=t),y:n*r+i*o}}function pg(e){return"number"==typeof e&&isFinite(e)}var fg,Gx={maxBlockId:1024,maxScaledSize:16,maxPixelSize:255,maxMinVisibleSize:64,maxDashOffset:4,maxDashLength:3,maxGapLength:1,maxSymbolicSize:0,maxPatternScale:0},gg=Rr?"webgl":null,Zx=(St(Ft,fg=Pe),Ft.prototype.onMounted=function(e,t){var n=this;void 0!==t.renderer&&e.setOptions({renderer:t.renderer}),void 0!==t.imgCrossOrigin&&e.setOptions({imgCrossOrigin:t.imgCrossOrigin}),this._dom.addWindowEventListener("unload",function(){n.destroy()})},Ft.prototype.getTransparentBackgroundColor=function(){var e=this._settings.get("backgroundColor");return e?this._engine.transparentify(e):null},Ft.prototype._render=function(){var e=this._dom.getDimensions(),t=this._camera.getView(),n=Ln(),i=z(),r=this._settings.get("backgroundColor");this._engine.setView({x:t.x,y:t.y,zoom:t.zoom,angle:t.angle,width:e.width,height:e.height,pixelRatio:n,currentTime:i,backgroundColor:r,isBufferDisplayable:this._isBufferDisplayable});try{this._engine.render(),"requested"===this._rendererState.state&&this._updateRendererState({state:"ok"})}catch(p){if(this._debug)throw p;var a=p.message,s=p.code,l=void 0===s?"OTHER":s,u=this._rendererState.type,d=this._formatRendererName(u),c="requested"===this._rendererState.state?"Error while initializing the "+d+" renderer":"The "+d+" renderer encountered an unexpected runtime error",h=null;"webgl"===u&&(c+="; fallbacking on canvas renderer",h="canvas"),eo(a),eo(c),this._updateRendererState({state:"error",code:l,message:a}),this._settings.set("renderer",h)}},Ft.prototype._formatRendererName=function(e){return"webgl"===e?"WebGL":"svg"===e?"SVG":e},Ft.prototype._fireRendererStateChangeEvent=function(){this._events.fire(I.RENDERER_STATE_CHANGE,{type:this._rendererState.type,state:this._rendererState.state,code:this._rendererState.code,message:this._rendererState.message})},Ft.prototype._updateRendererState=function(e){var t=e.type,n=e.state,i=e.code,r=e.message,o=!1;void 0!==t&&this._rendererState.type!==t&&(this._rendererState.type=t,o=!0),void 0!==n&&this._rendererState.state!==n&&(this._rendererState.state=n,o=!0),void 0!==i&&this._rendererState.code!==i&&(this._rendererState.code=i,o=!0),void 0!==r&&this._rendererState.message!==r&&(this._rendererState.message=r,o=!0),o&&this._initDone&&this._fireRendererStateChangeEvent()},Ft.prototype.getImageData=function(){var e=this;return this._dom.afterNextFrame().then(function(){return e._engine.getImageData()})},Ft.prototype.addCanvas=function(e){this._engine.addCanvas(e)},Ft.prototype.removeCanvas=function(e){this._engine.removeCanvas(e)},Ft.prototype.getNodeAttributes=function(){return this._attributesManager.getFlexArrays().nodes.current},Ft.prototype.getEdgeAttributes=function(){return this._attributesManager.getFlexArrays().edges.current},Ft.prototype.getGraphicsEngine=function(){return this._engine},Ft.prototype.getImageManager=function(){return this._imageManager},Ft.prototype.getFontManager=function(){return this._fontManager},Ft.prototype.allocateGraphicsEngineBlockId=function(){return this._availableGeIndexes.length?this._availableGeIndexes.pop():10*this._nextGeIndex+++9},Ft.prototype.releaseGraphicsEngineBlockId=function(e){this._engine.freeBlock(e),this._availableGeIndexes.push(e),this._dom.refresh()},Ft.prototype.addCursorStyle=function(e){e&&(this._cursorStyle.push(e),this._applyCursorStyle())},Ft.prototype.removeCursorStyle=function(e){if(e){var t=this._cursorStyle.lastIndexOf(e);-1!==t&&(this._cursorStyle.splice(t,1),this._applyCursorStyle())}},Ft.prototype.reloadFonts=function(){this._events.fire(I.RELOAD_FONTS),this._engine.notifyFontsReloaded(),this._dom.refresh()},Ft.prototype.getDomElement=function(){return this._domElement},Ft.prototype.setTextHidden=function(e,t){this._attributesManager.setTextHidden(e,t)},Ft.prototype.resetTextHidden=function(){this._attributesManager.resetTextHidden(),this._dom.refresh()},Ft.prototype.getAttributesManager=function(){return this._attributesManager},Ft.prototype._checkFontsNewlyLoaded=function(){return!!this._fontsNewlyLoaded.length&&(this._fontsNewlyLoaded=[],!0)},Ft.prototype._loadGraphInGraphicsEngine=function(){this._attributesManager.update(),this._checkFontsNewlyLoaded()&&this._attributesManager.redrawAll();var e=this._attributesManager.getAndResetElementsToRedraw(),t=this._attributesManager.getAndResetElementsUpdated(),n=0<t.nodes.size||0<t.edges.size;(t.nodeAttributes.includes("radius")||t.edgeAttributes.includes("width"))&&(this._boundaries.maxSize=function(i){for(var r=i.getNodeAttribute("radius"),o=i.getEdgeAttribute("width"),a=i.getNodes(),s=i.getEdges(),l=0,u=0,d=0;d<a._indexes.length;d++){var c=a._indexes[d],h=r.get(c);l<h&&(l=h)}for(d=0;d<s._indexes.length;d++){var p=o.get(c=s._indexes[d]);u<p&&(u=p)}return Math.max(2*l,u)}(this._graph)),(t.nodeAttributes.includes("shape")||t.edgeAttributes.includes("shape.head")||t.edgeAttributes.includes("shape.tail"))&&lg(this._engine,this._attributesManager.getFlexArrays()),function(e){var t,n,a=e.graph,s=e.elements,l=e.engine,u=e.imageManager,d=e.fontManager,c=e.view,p=e.boundaries,g=e.formatText,m={nodeAttributes:n=nr((t=e.attributes).nodes.current,{text:{secondary:{scaling:t.nodes.current.text.scaling,maxLineLength:t.nodes.current.text.maxLineLength}}}),nodeAttributesPrev:nr(t.nodes.previous,{textHidden:n.textHidden,text:{secondary:{scaling:t.nodes.previous.text.scaling,maxLineLength:t.nodes.previous.text.maxLineLength}}}),edgeAttributes:nr(t.edges.current,{text:{secondary:{scaling:t.edges.current.text.scaling,maxLineLength:t.edges.current.text.maxLineLength,adjustAngle:t.edges.current.text.adjustAngle}}}),edgeAttributesPrev:nr(t.edges.previous,{source:t.edges.current.source,target:t.edges.current.target,textHidden:t.edges.current.textHidden,text:{secondary:{scaling:t.edges.previous.text.scaling,maxLineLength:t.edges.previous.text.maxLineLength,adjustAngle:t.edges.previous.text.adjustAngle}}})},x=m.nodeAttributes,v=m.nodeAttributesPrev,y=m.edgeAttributes,b=m.edgeAttributesPrev,S=s.nodes,w=s.edges,M=p.maxSize,N=p.maxMinVisibleSize;if(S.size||w.size){var D=10*(Math.max(a.getNodeMaxIndex(),a.getEdgeMaxIndex())+1),P=l.setGlobalBoundaries({maxBlockId:Ni(D),maxScaledSize:Ni(8*M),maxMinVisibleSize:Ni(N),maxSymbolicSize:Ni(M),maxDashLength:3,maxGapLength:1,maxPatternScale:2}),L=(P?a.getNodes("_all"):S)._indexes,V=(P?a.getEdges("_all"):w)._indexes;if(L.length)for(var X=new bx({engine:l,imageManager:u,fontManager:d,formatText:g,attributes:x,attributesPrev:v}),J=0;J<L.length;++J)X.drawNode(L[J]);if(V.length){var se=new Mx({engine:l,imageManager:u,fontManager:d,formatText:g,view:c,attributes:y,attributesPrev:b,nodeAttributes:x,nodeAttributesPrev:v});for(J=0;J<V.length;++J)se.drawEdge(V[J])}}}({graph:this._graph,elements:e,engine:this._engine,imageManager:this._imageManager,fontManager:this._fontManager,view:this._camera.getView(),attributes:this._attributesManager.getFlexArrays(),boundaries:this._boundaries,formatText:this._formatText}),n&&this._events.fire(I.UPDATE_ATTRIBUTES,t)},Ft.prototype._forceCompleteGraphRefresh=function(){this._attributesManager.redrawAll(),this._loadGraphInGraphicsEngine()},Ft.prototype.export=function(e,t,n,i){var r,o=this;return Promise.all([this._graph.getNodes().addClass(Qa),this._graph.getEdges().addClass(Qa)]).then(function(){return o.resolveAtNextFrame()}).then(function(){return o._imageManager.whenReady()}).then(function(){var a;return"all"===n?(r={nodes:_g(a=o._graph,!0),edges:_g(a,!1)},o._forceCompleteGraphRefresh()):o._loadGraphInGraphicsEngine(),o._engine.export(e,t,i)}).then(function(a){return Promise.all([o._graph.getNodes().removeClass(Qa),o._graph.getEdges().removeClass(Qa)]).then(function(){return a})}).then(function(a){var s,l,u;return"all"===n&&(l=(s=r).nodes,u=s.edges,mg(l),mg(u),o._forceCompleteGraphRefresh()),a})},Ft.prototype.addAttributeLayer=function(e){return this._attributesManager.addAttributeLayer(e)},Ft.prototype.createFlexArrays=function(){return this._attributesManager.createFlexArrays()},Ft.prototype.getAttributeValues=function(e,t,n,i){return this._attributesManager.getAttributeValues(e,t,n,i)},Ft.prototype.forceAttributesComputation=function(){this._attributesManager.update()},Ft.prototype.resolveAtNextFrame=function(e){return this._dom.afterNextFrame().then(function(){return e})},Ft.prototype.animate=function(e,t,n){var r,o,i=("number"==typeof(r=n)?r={duration:r}:"object"==typeof r&&null!==r||(r={duration:0}),{duration:(o=r.duration,"number"!=typeof o||!isFinite(o)||o<0?0:o),easing:r.easing||"linear",chain:!!r.chain});return i.duration&&this._engine.ensureAnimationsReady(),this._animate(e,t,i)},Ft.prototype.isAnimating=function(){return 0<this._animations.length},Ft.prototype.getAnimationInformation=function(e){return this._attributesManager.getAnimationInformation(e)},Ft.prototype._toSubGraph=function(e){if(e instanceof or||e instanceof _o)return{nodes:e.toList(),edges:e.getAdjacentEdges()};if(e instanceof vs||e instanceof na)return{nodes:this._graph.nodeList(),edges:e.toList()};var t=e,n={nodes:t.nodes||this._graph.nodeList(),edges:t.edges||this._graph.edgeList()};return n.nodes.size&&(n.edges=n.edges.size?n.edges.concat(n.nodes.getAdjacentEdges()).dedupe():n.nodes.getAdjacentEdges()),n},Ft.prototype._animate=function(e,t,n){var i=n.duration,r=n.easing;if(!this._animations.length&&!i)return t(e),Promise.resolve(e);var o=this._toSubGraph(e),a=o.nodes,s=o.edges;if(!a.size&&!s.size)return Promise.resolve(e);a.size&&this._events.fire(I.ANIMATE,{elements:a,duration:i,easing:r}),s.size&&this._events.fire(I.ANIMATE,{elements:s,duration:i,easing:r});for(var l={id:this._nextAnimationId++,startTime:-1,finished:!1,func:function(){return t(e)},duration:i,easing:r,nodes:a,edges:s,resolve:void 0},u=new Promise(function(c){return l.resolve=function(){return c(e)}}),d=0;d<a._indexes.length;d++)this._nodeAnimationList.set(a._indexes[d],l.id);for(d=0;d<s._indexes.length;d++)this._edgeAnimationList.set(s._indexes[d],l.id);return this._animations.push(l),this._dom.refresh(),i||this._processAnimations(),u},Ft.prototype._endAnimation=function(e){e.resolve(e.elements),e.finished=!0},Ft.prototype._removeFinishedAnimations=function(){this._animations=this._animations.filter(function(e){return!e.finished})},Ft.prototype._getAnimationElements=function(e){for(var t=[],n=[],i=0;i<e.nodes._indexes.length;i++){var r=e.nodes._indexes[i];this._nodeAnimationList.get(r)===e.id&&t.push(r)}for(i=0;i<e.edges._indexes.length;i++)this._edgeAnimationList.get(r=e.edges._indexes[i])===e.id&&n.push(r);return{nodes:this._graph.nodeList(new Uint32Array(t)),edges:this._graph.edgeList(new Uint32Array(n))}},Ft.prototype._resetAnimationAttributes=function(e){var t=e.nodes,n=e.edges;this._attributesManager.resetAnimationAttributes({nodes:t,edges:n}),this._nodeAnimationList.fill(t._indexes,0),this._edgeAnimationList.fill(n._indexes,0)},Ft.prototype._processAnimations=function(){if(this._animations.length){var e=z(),t=[];this._attributesManager.update();for(var n=0,i=this._animations;n<i.length;n++)-1===(l=i[n]).startTime&&(l.startTime=e,t.push(l.func),0<l.duration&&this._attributesManager.setAnimationAttributes(this._getAnimationElements(l),l));for(var r=0,o=t;r<o.length;r++)(0,o[r])();for(var a=0,s=this._animations;a<s.length;a++){var l;e>=(l=s[a]).startTime+l.duration&&(this._resetAnimationAttributes(this._getAnimationElements(l)),this._endAnimation(l))}this._removeFinishedAnimations(),this._animations.length&&this._dom.refresh()}},Ft.prototype.hideTexts=function(){this.setNodeTextsVisibility(!1),this.setEdgeTextsVisibility(!1)},Ft.prototype.showTexts=function(){this.setNodeTextsVisibility(!0),this.setEdgeTextsVisibility(!0)},Ft.prototype.setNodesVisibility=function(e){return this._updateVisibilityCounter("nodes",e)},Ft.prototype.setNodeTextsVisibility=function(e){return this._updateVisibilityCounter("nodeTexts",e)},Ft.prototype.setEdgesVisibility=function(e){return this._updateVisibilityCounter("edges",e)},Ft.prototype.setEdgeTextsVisibility=function(e){return this._updateVisibilityCounter("edgeTexts",e)},Ft.prototype._updateVisibilityCounter=function(e,t){this._visibility[e]+=t?-1:1,this._dom.refresh()},Ft.prototype.detectNode=function(e){return function(t,n,i,r,o,a){var s=t.x,l=t.y,u=t.margin,d=t.texts,c=t.indexes;c=c||n.getNodes()._indexes;var h=r.getZoom(),p=n.getObjectList(!0),g=i.getFlexArrays().nodes.current,m=0;i.update();for(var x=0;x<c.length;++x){var v=c[x];if(!g.excluded.get(v)&&g.detectable.get(v)&&0===g.animationDuration.get(v)){var y=g.x.get(v),b=g.y.get(v),S=r.graphToScreenCoordinates({x:y,y:b}),w=S.x,M=S.y,N=g.shape.get(v),D="scaled"===g.scalingMethod.get(v),P=g.radius.get(v)*(D?h:1),L=P+u;if(o.checkShapeHit(N,(s-w)/L,(l-M)/L))m=v;else if(d){var J=a(g.text.content.get(v)),se=g.textHidden.get(v),re=g.text.minVisibleSize.get(v);if(!se&&J&&re<=(D?2*P:1/0)){var j=Bd(J,g.text.maxLineLength.get(v)),Y=g.innerStroke.width.get(v),he=g.outerStroke.width.get(v),pe=g.text.margin.get(v),Ae=g.text.padding.get(v),Ie=g.text.size.get(v),ot=g.text.scale.get(v),at=g.text.scaling.get(v),We=g.text.font.get(v),vt=g.text.style.get(v),Tt=g.text.position.get(v),Ge=o.measureText(j,We,vt,1),qe=at?ot*P:Ie,Le=Ge.width*qe/2+Ae+u,He=Ge.height*qe/2+Ae+u,Je=Q0[Tt],et=Y+he+pe+P,Te=w+(et+Le)*Je.x,Re=M+(et+He)*Je.y;Te-Le<s&&s<Te+Le&&Re-He<l&&l<Re+He&&(m=v)}}}}return p.get(m)||null}(e,this._graph,this._attributesManager,this._camera,this._engine,this._formatText)},Ft.prototype.detectEdge=function(e){return function(t,n,i,r){var o=t.margin,a=t.indexes,s=void 0===a?n.getEdges()._indexes:a,l=n.getObjectList(!1),u=r.getFlexArrays(),d=u.edges.current,c=u.nodes.current,h=i.getZoom(),p=o/h,g=i.screenToGraphCoordinates(t),m=g.x,x=g.y,v=0;r.update();for(var y=0;y<s.length;++y){var b=s[y],S=d.source.get(b),w=d.target.get(b),M=d.excluded.get(b),N=d.detectable.get(b),D=0!==d.animationDuration.get(b),P=0!==c.animationDuration.get(S),L=0!==c.animationDuration.get(w);if(!M&&N&&!D&&!P&&!L){var V=S===w,X=d.curvature.get(b),J="triangle"===d.shape.type.get(b),se="scaled"===d.scalingMethod.get(b),re=d.width.get(b)/(se?1:h),j=c.x.get(S),Y=c.y.get(S),he=c.x.get(w),pe=c.y.get(w);if(V){var Ae="scaled"===c.scalingMethod.get(S);bf(m,x,j,Y,j,Y,(Ie=Ya(j,Y,X,c.radius.get(S)/(Ae?1:h),0)).x1,Ie.y1,Ie.x2,Ie.y2,re,p)&&(v=b)}else if(0!==X){var Ie;xf(m,x,j,Y,he,pe,(Ie=pa(j,Y,he,pe,X)).x,Ie.y,re,p,J)&&(v=b)}else pf(m,x,j,Y,he,pe,re,p,J)&&(v=b)}}return l.get(v)||null}(e,this._graph,this._camera,this._attributesManager)},Ft.prototype.getVisibilityCounters=function(){return this._visibility},Ft.prototype.destroy=function(){this.getGraphicsEngine().destroy(),this.getImageManager().destroy(),this.getFontManager().destroy()},Ft);function Ft(e,t){var n,i=e.dom,r=e.graph,o=e.camera,a=e.events,s=e.settings,l=fg.call(this)||this;return l._debug=!1,l._initDone=!1,l._boundaries={maxSize:10,maxMinVisibleSize:64},l._visibility={nodes:0,edges:0,nodeTexts:0,edgeTexts:0},l._nextAnimationId=1,l._animations=[],l._rendererState={type:null,code:null,state:"ok",message:""},l._cursorStyle=[],l._fontsNewlyLoaded=[],l._nextGeIndex=1,l._availableGeIndexes=[],l._isBufferDisplayable=function(u){var d,c=2===(d=u.getDepth())||1===d||3<=(d-3)%6,h=Df(u);return 0===(c?l._visibility.nodes:l._visibility.edges)&&(!h||0===(c?l._visibility.nodeTexts:l._visibility.edgeTexts))},l._applyCursorStyle=function(){var u=l._cursorStyle[l._cursorStyle.length-1]||l._settings.get("cursor.default");$r(l._domElement,u)},l._updateImageCrossOrigin=function(){l._imageManager.setImgCrossOrigin(l._settings.get("imgCrossOrigin"))},l._debug=t.isDebug(),l._events=a,l._dom=i,l._graph=r,l._camera=o,l._events=a,l._settings=s,l._formatText=zp().applyArabicShaping,l._attributesManager=new mx(r,i,t),l._imageManager=new Y0,l._fontManager=new Lx,l._engine=new _u(_u.getCachedInitData()),l._domElement=l._engine.getDomElement(),l._nodeAnimationList=l._graph.createNodeAttribute({storage:32,default:0}),l._edgeAnimationList=l._graph.createEdgeAttribute({storage:32,default:0}),l._events.register([I.RELOAD_FONTS,I.RENDERER_STATE_CHANGE,I.UPDATE_ATTRIBUTES,I.ANIMATE,I.CAMERA_MOVE,I.CAMERA_PAN,I.CAMERA_ZOOM,I.CAMERA_ROTATE,I.VIEW_CHANGED,I.START_ZOOM]),l._settings.register("renderer",gg,function(u){l._updateRendererState({type:u,state:"requested",code:null,message:null}),l._engine.setRenderType(u),l._dom.refresh()}),l._settings.register("backgroundColor","white",function(u){l._engine.parseColor(u)?l._dom.refresh():(eo('Invalid background color "'+u+'" specified; will default to black.'),l._settings.set("backgroundColor","black"))}),l._settings.register("texts.hideUntilFontsLoaded",!0,function(u){l._fontManager.setHideUntilFontsLoaded(u)}),l._settings.register("imgCrossOrigin","anonymous",l._updateImageCrossOrigin),l._settings.register("cursor.default","default",l._applyCursorStyle),l._dom.setLayer("graphics",l._domElement),l._engine.setGlobalBoundaries(Gx),l._dom.beforeNextFrame().then(function(){l._initDone=!0,l._fireRendererStateChangeEvent()}),l._imageManager.onFetch(function(){l._engine.notifyPatternUpdate(),l._dom.refresh()}),l._fontManager.onFontLoaded(function(u){l._fontsNewlyLoaded.push(u),l._engine.notifyPatternUpdate(),l._dom.refresh()}),l._dom.addMediaListener("(min-resolution: 2dppx)",function(){l._dom.refresh()}),l._visibleAttributeLayer=l._attributesManager.addAttributeLayer({priority:0,name:"internal("+ic+")",tag:ic,nodeOutput:{attributes:"all"},edgeOutput:{attributes:"all"},nodeDependencies:null,edgeDependencies:null}),l._dataAttributeLayer=l._attributesManager.addAttributeLayer({priority:0,name:"internal(_data)",tag:rc,nodeDependencies:null,edgeDependencies:null}),lg(l._engine,l._attributesManager.getFlexArrays()),l._events.on(((n={})[I.CAMERA_MOVE]=function(){return l._dom.refresh()},n[I.NEW_FRAME]=function(){l._processAnimations(),l._loadGraphInGraphicsEngine(),l._render()},n[I.CLEAR_GRAPH]=function(){l._nextGeIndex=1,l._availableGeIndexes=[],l._engine.clear(),l._attributesManager.clear(),l._dom.refresh()},n[I.VIEW_CHANGED]=function(u){if(u.type===Ls.ROTATE){var d=l._graph.getEdges().filter(function(c){return c.getAttribute("adjustAnchors")});l._attributesManager.redrawElements(d)}},n[I.ADD_NODES+" "+I.ADD_EDGES]=function(u){l._attributesManager.updateForAllAttributeLayers(u.nodes||u.edges)},n[I.EXCLUDED_STATE_CHANGE]=function(u){l._visibleAttributeLayer.updateElements(u.elements)},n[I.SET_DATA]=function(u){l._dataAttributeLayer.updateElements(u.elements)},n)),_u.clearCachedInitData(),l}function _g(e,t){var n=t?e.getNodeAttribute("excluded"):e.getEdgeAttribute("excluded"),i=(t?e.getNodes("all"):e.getEdges("all"))._indexes,r=n.getMultiple(i);return n.fill(i,0),{excludedList:n,indexes:i,values:r}}function mg(e){e.excludedList.setMultiple(e.indexes,e.values)}var xc,qx=(St(Aa,xc=Pe),Aa.prototype.register=function(e,t){var n=this;void 0===t&&(t=[]),e.forEach(function(i){if(n._events[i])throw new Error('event "'+i+'" already exists');n._events[i]=new vg(!1,i)}),t.forEach(function(i){if(n._events[i])throw new Error('event "'+i+'" already exists');n._events[i]=new vg(!0,i)})},Aa.prototype.onAnyEvent=function(e){this._onAnyEvents.push(e)},Aa.prototype.on=function(e,t){var n=this;return"string"==typeof e?e.split(" ").filter(function(i){return!!i}).forEach(function(i){return yg(n._events,i,"event").on(t)}):_t(e,function(i,r){return n.on(r,i)}),this},Aa.prototype.removeListener=function(e){_t(this._events,function(t){t.off(e)})},Aa.prototype.fire=function(e,t){void 0===t&&(t=null);var n=yg(this._events,e,"event");return this._onAnyEvents.forEach(function(i){return i(e,t)}),n.trigger(t),this},Aa.prototype.once=function(e,t){var n=this,i=function(){t.apply(null,arguments),n.removeListener(i)};this.on(e,i)},Aa);function Aa(){var e=null!==xc&&xc.apply(this,arguments)||this;return e._events={},e._onAnyEvents=[],e}var vg=(Nl.prototype.trigger=function(e){for(var t=0,n=this._handlers;t<n.length;t++)(0,n[t])(e,this._name);return this},Nl.prototype.on=function(e){if("function"!=typeof e)throw new Error("handler is not a function");var t=this._reverseOrder?0:this._subscribers.length;return this._handlers.splice(t,0,e),this._subscribers.splice(t,0,e),this},Nl.prototype.off=function(e){for(var t;-1!==(t=this._subscribers.indexOf(e));)this._subscribers.splice(t,1),this._handlers.splice(t,1);return this},Nl);function Nl(e,t){this._subscribers=[],this._handlers=[],this._reverseOrder=e,this._name=t}function yg(e,t,n){if(!(t in e))throw new Error(n+" "+t+" does not exist");return e[t]}var xg,Hx=(St(oo,xg=Pe),oo.prototype.getOriginalAttributes=function(){return this._originalAttributesLayer.getFlexArrays()},oo.prototype.setMultipleAttributes=function(e,t,n,i){var r=this;return this._graphics.animate(e,function(){r._individualAttributesLayer.setAttributeValues(e,t,i)},n)},oo.prototype.setSingleAttribute=function(e,t,n,i){var r={};return Yt(r,t,n),this.setMultipleAttributes(e,r,i)},oo.prototype.resetMultipleAttributes=function(e,t,n){var i=this;t=t||this._individualAttributesLayer.getUsedAttributeNames(e);for(var r={},o=0,a=t;o<a.length;o++)Yt(r,a[o],void 0);return this._graphics.animate(e,function(){i._individualAttributesLayer.setAttributeValues(e,r)},n)},oo.prototype.getMultipleAttributes=function(e,t){return this._graphics.getAttributeValues(e,t,!0,!1)},oo.prototype.getSingleAttribute=function(e,t){return this._graphics.getAttributeValues(e,t,!1,!1)},oo.prototype.replaceOriginalAttributes=function(e,t,n){void 0===n&&(n=[]);for(var i={},r=this._originalAttributesLayer.getUsedAttributeNames(e).filter(function(a){return!n.includes(a)}),o=0;o<r.length;++o)Yt(i,r[o],void 0);this._originalAttributesLayer.setAttributeValues(e,i),this._originalAttributesLayer.setAttributeValues(e,t)},oo.prototype.getSinglePreviousAttribute=function(e,t){return this._graphics.getAttributeValues(e,t,!1,!0)},oo.prototype.getMultiplePreviousAttributes=function(e,t){return this._graphics.getAttributeValues(e,t,!0,!0)},oo);function oo(e){var t=e.events,n=e.graphics,i=xg.call(this)||this;return i._events=t,i._graphics=n,i._events.on({"addNodes addEdges":function(r){var s=r.nodes||r.edges,l=r.objects.map(function(u){return u.attributes});i._originalAttributesLayer.setAttributeValues(s,l)}}),i._originalAttributesLayer=i._graphics.addAttributeLayer({name:"original-attributes",priority:1,nodeOutput:{attributes:"all"},edgeOutput:{attributes:"all"},nodeDependencies:null,edgeDependencies:null}),i._individualAttributesLayer=i._graphics.addAttributeLayer({name:"individual-attributes",priority:4,nodeOutput:{attributes:"all"},edgeOutput:{attributes:"all"},nodeDependencies:null,edgeDependencies:null}),i}var bc,Wx=(St($a,bc=Pe),$a.prototype.onMounted=function(e,t){t.renderer&&this.update({renderer:t.renderer}),t.options&&this.update(t.options)},$a.prototype.register=function(e,t,n,i){return void 0===i&&(i=!0),this._keys.push(e),this._currentValue[e]=t,this._defaultValues[e]=t,this._onChange[e]=n||function(){},n&&i&&n(t),this},$a.prototype.update=function(e){e=qt(e);for(var t=this._keys,n={},i=0;i<t.length;++i){var r=t[i];if(r in e){var o=e[r];void 0===o&&(o=this._defaultValues[r]),n[r]=this._currentValue[r],this._currentValue[r]=o}}var a=Object.keys(n);for(i=0;i<a.length;++i){var s=a[i],l=this._currentValue[s],u=n[s];l!==u&&this._onChange[s](l,u)}return En(n)},$a.prototype.get=function(e){return arguments.length?this._currentValue[e]:En(this._currentValue)},$a.prototype.set=function(e,t){var n=this._currentValue[e],i=this._onChange[e];this._currentValue[e]=t,i&&i(t,n)},$a);function $a(){var e=null!==bc&&bc.apply(this,arguments)||this;return e._currentValue={},e._onChange={},e._defaultValues={},e._keys=[],e}var Yx=(jr.prototype.getName=function(){return this._name},jr.prototype.getIndex=function(){return this._classes.getIndex(this._name)},jr.prototype.setIndex=function(e){return this._classes.setIndex(this._name,e)},jr.prototype.update=function(e){return this._classes.update(this._name,e),this},jr.prototype.getDefinition=function(){return this._classes.getDefinition(this._name)},jr.prototype.getNodes=function(){return this._classes.getElementsByClass(this._name).nodes},jr.prototype.getEdges=function(){return this._classes.getElementsByClass(this._name).edges},jr.prototype.clearNodes=function(){this.getNodes().removeClass(this._name)},jr.prototype.clearEdges=function(){this.getEdges().removeClass(this._name)},jr.prototype.add=function(e){e.addClass(this._name)},jr.prototype.remove=function(e){e.removeClass(this._name)},jr);function jr(e,t){this._classes=e,this._name=t}var bg,Xx=(St($n,bg=Pe),$n.prototype._getClassList=function(e){return e?this._builtinClasses:this._userClasses},$n.prototype.createClass=function(e){void 0===e&&(e={});var t=e.name,n=e.isBuiltin,i=e.after,r=e.nodeAttributes,o=e.nodeDependencies,a=e.nodeOutput,s=e.edgeAttributes,l=e.edgeDependencies,u=e.edgeOutput;if("string"!=typeof t)throw new Error('the "name" argument should be a string');var d=this._getClassList(n),c=i?function(m,x){for(var v=0;v<m.length;++v)if(m[v].name===x)return v;return-1}(d,i)+1:d.length;if(-1===c)throw new Error('createClass: class specified as `after` parameter "'+i+'" does not exist');if(n&&!t.startsWith("_"))throw new Error('invalid builtin class name "'+t+"\": builtin classes should start with '_'");var h=new hu(this._graph),p=new Yx(this,t),g={name:t,elementSet:h,attributeLayer:this._graphics.addAttributeLayer({name:"class("+t+")",tag:t,standaloneSelectors:!0,nodeAttributes:r,edgeAttributes:s,nodeSelector:function(m,x){return x.hasElement(m)},edgeSelector:function(m,x){return x.hasElement(m)},nodeContext:h,edgeContext:h,nodeOutput:a,edgeOutput:u,nodeDependencies:o,edgeDependencies:l}),isBuiltin:n,wrapper:p};return d.splice(c,0,g),n&&d.sort(function(m,x){return Of.indexOf(m.name)-Of.indexOf(x.name)}),this._updatePriorities(n),this._classesByName[t]=g,this._events.register([Fs(t,!0,!0),Fs(t,!0,!1),Fs(t,!1,!0),Fs(t,!1,!1)]),p},$n.prototype._updatePriorities=function(e){for(var t=this._getClassList(e),n=5+(e?.5:0),i=0;i<t.length;++i)t[i].attributeLayer.update({priority:n+5e-4*i})},$n.prototype._get=function(e){var t=this._classesByName[e];if(!t)throw new Error('class "'+e+'" does not exist');return t},$n.prototype.getIndex=function(e){var t=this._get(e);return this._getClassList(t.isBuiltin).indexOf(t)},$n.prototype.setIndex=function(e,t){var n=this._get(e),i=this._getClassList(n.isBuiltin),r=i.indexOf(n),o=me(t,0,i.length-1);i.splice(r,1),i.splice(o,0,n),this._updatePriorities(n.isBuiltin)},$n.prototype.update=function(e,t){void 0===t&&(t={}),this._get(e).attributeLayer.update({nodeAttributes:t.nodeAttributes,edgeAttributes:t.edgeAttributes,nodeDependencies:t.nodeDependencies,edgeDependencies:t.edgeDependencies,nodeOutput:t.nodeOutput,edgeOutput:t.edgeOutput,fullOverwrite:t.fullOverwrite})},$n.prototype.getDefinition=function(e){var t=this._get(e).attributeLayer.getDefinition();return{nodeAttributes:t.nodeAttributes,edgeAttributes:t.edgeAttributes,nodeDependencies:t.nodeDependencies,edgeDependencies:t.edgeDependencies,nodeOutput:t.nodeOutput,edgeOutput:t.edgeOutput}},$n.prototype._addOrRemoveClassesToElements=function(e,t,n){for(var i=t.isNode,r=0;r<e.length;++r){var o=e[r],a=this._get(o),l=a.attributeLayer,u=a.elementSet.addOrRemoveElements(t,n),d=Fs(o,i,n);u.size&&(l.updateElements(u),this._events.fire(d,i?{nodes:u}:{edges:u}))}},$n.prototype.addClassesToElements=function(e,t,n){var i=this,r=t.toList();return this._graphics.animate(t,function(){i._addOrRemoveClassesToElements(e,r,!0)},n)},$n.prototype.removeClassesFromElements=function(e,t,n){var i=this,r=t.toList();return this._graphics.animate(t,function(){i._addOrRemoveClassesToElements(e,r,!1)},n)},$n.prototype.hasSingleElementClass=function(e,t){return this._get(e).elementSet.hasElement(t)},$n.prototype.getElementsClassList=function(e,t){void 0===t&&(t={});for(var n=t.includeBuiltinClasses,i=void 0!==n&&n,r=new Array(e.size),o=0;o<r.length;++o)r[o]=[];return this._addClassNamesToList(r,e,this._userClasses),i&&this._addClassNamesToList(r,e,this._builtinClasses),r},$n.prototype._addClassNamesToList=function(e,t,n){for(var i=t.toList(),r=0;r<n.length;++r)for(var o=this._userClasses[r],a=o.name,s=o.elementSet,l=0;l<i.size;++l){var u=i.get(l);s.hasElement(u)&&e[l].push(a)}},$n.prototype.getClassByName=function(e,t){void 0===t&&(t=!1);var n=this._classesByName[e]||null;if(t&&!n)throw new Error('class "'+e+'" does not exist');return n&&n.wrapper},$n.prototype.getClassList=function(){return this._userClasses.map(function(e){return e.wrapper})},$n.prototype.getElementsByClass=function(e){var t=this._get(e).elementSet.getElements();return{nodes:t.nodes.filter(function(n){return n.isVisible()}),edges:t.edges.filter(function(n){return n.isVisible()})}},$n.prototype._onClassEvent=function(e,t,n,i){var r=Fs(e,n,i);this._events.on(r,t)},$n.prototype.onNodeClassAdded=function(e,t){this._onClassEvent(e,t,!0,!0)},$n.prototype.onNodeClassRemoved=function(e,t){this._onClassEvent(e,t,!0,!1)},$n.prototype.onEdgeClassAdded=function(e,t){this._onClassEvent(e,t,!1,!0)},$n.prototype.onEdgeClassRemoved=function(e,t){this._onClassEvent(e,t,!1,!1)},$n);function $n(e){var t,n=bg.call(this)||this;return n._builtinClasses=[],n._userClasses=[],n._classesByName={},n._events=e.events,n._graphics=e.graphics,n._graph=e.graph,n._events.on(((t={})[I.EXCLUDED_STATE_CHANGE]=function(i){var r=i.elements;if(i.value){var o=n._builtinClasses.map(function(a){return a.name});n._addOrRemoveClassesToElements(o,r,!1)}},t.clear=function(){n._builtinClasses.concat(n._userClasses).forEach(function(i){return i.elementSet.clear()})},t)),n}function Fs(e,t,n){return(t?"node":"edge")+"Class"+(n?"Added":"Removed")+"_"+e}for(var Ps,Su,es=[0,1],Ll=[0,2],Fl=4;Fl<65535;Fl<<=2)for(var Pl=0,Jx=es.length;Pl<Jx;Pl++)es.push(es[Pl]|Fl),Ll.push((es[Pl]|Fl)<<1);function ao(e,t){return(Ll[255&t]|es[255&e])+65536*(Ll[t>>8&255]|es[e>>8&255])+4294967296*(Ll[t>>16&255]|es[e>>16&255])}function Eg(e,t){if(void 0===t&&(t=[]),0xffffffffffff<e)throw"Only morton codes up to 48 bits are supported.";if(!Ps){Ps={},Su={};for(var n=0;n<256;n++)Ps[ao(n,0)]=n,Su[ao(0,n)]=n}var i=Ps[21845&e],r=Su[43690&e];return 65535<e&&(i|=Ps[21845&(e/=65536)]<<8,r|=Su[43690&e]<<8,65535<e&&(i|=Ps[21845&(e/=65536)]<<16,r|=Su[43690&e]<<16)),t[0]=i,t[1]=r,t}function vr(e,t,n){void 0===e&&(e=Int32Array),void 0===t&&(t=16),void 0===n&&(n=8),this._BIG_LIST=new Uint8Array([-1])[0],this._ArrayType=e,this._capacity=t,this._MAX_LIST_SIZE=n,this._freeIndex=-1,this.clear()}ao.code=function(e,t,n){if(24<e)throw"Morton codes are only supported up to Z=24";var i=1<<24-e;return ao(t*i,n*i)},ao.range=function(e,t,n){if(24<e)throw"Morton ranges are only supported up to Z=24";var i=1<<24-e,r=ao(t*i,n*i);return[r,r+i*i-1]},ao.reverse=Eg,ao.decode=function(e,t){var n=Eg(t),i=1<<24-e;return[n[0]/i,n[1]/i]},ao.min=function(e,t){var r=2863311530&e,o=2863311530&t;return Math.min(1431655765&e,1431655765&t)+Math.min(r,o)};var Sg={averageSize:{configurable:!0}};function Ag(e,t){var n=new e.constructor(t);return n.set(e),n}function Dl(e,t,n){return n|ao(e,t)<<4}function Ec(e,t){return void 0===t&&(t=[]),ao.reverse(e>>4,t),t[2]=e&Kx,t}function Gi(e,t,n,i,r){void 0===n&&(n=16),void 0===i&&(i=65536),void 0===r&&(r=Int32Array),this._intersects=e,this._getBounds=t,this._occupied=0,this._cells=new vr(r),this._objectsAtLevel=new Array(16).fill(0),this._idToCode=new wg,this._codeCache=[],this._offset=i,this._min=-i,this._max=i,this._resolution=65535/(this._max-this._min),this._minCellSize=n*this._resolution,this._bounds=new Array(64);for(var o=0;o<16;o++)this._bounds[4*o]=1/0,this._bounds[4*o+1]=1/0,this._bounds[4*o+2]=-1/0,this._bounds[4*o+3]=-1/0}vr.prototype.clear=function(){this._buffer=new this._ArrayType(this._capacity*this._MAX_LIST_SIZE),this._sizes=new Uint8Array(this._capacity),this._bigLists=[],this._nextIndex=0,this._idToIndex={},this._constList=new Array(this._MAX_LIST_SIZE)},vr.prototype.addEntry=function(e){var t;return-1===this._freeIndex?t=this._nextIndex++:(t=this._freeIndex,this._freeIndex=-1),(this._idToIndex[e]=t)>=this._capacity&&this._expand(t+1),this._sizes[t]=0,t},vr.prototype.getItems=function(e){var t=this._idToIndex[e];if(void 0!==t){var n=this._sizes[t],i=this._MAX_LIST_SIZE*t;if(n<=this._MAX_LIST_SIZE){for(var r=0,o=this._constList.length=n;r<o;++r)this._constList[r]=this._buffer[i+r];return this._constList}if(n===this._BIG_LIST)return this._bigLists[this._buffer[i]]}},vr.prototype.removeEntry=function(e){var t=this._idToIndex[e];this._sizes[t]===this._BIG_LIST&&(this._bigLists[this._buffer[this._MAX_LIST_SIZE*t]].length=0),this._sizes[t]=0,this._freeIndex=t},vr.prototype.size=function(e){var t=this._idToIndex[e],n=this._sizes[t];return n<=this._MAX_LIST_SIZE?n:this._bigLists[this._buffer[t*this._MAX_LIST_SIZE]].length},vr.prototype.sizes=function(e){for(var t=this._sizes,n=this._bigLists,i=this._buffer,r=this._MAX_LIST_SIZE,o=e.length,a=new Array(o),s=0;s<o;s++){var l=this._idToIndex[e[s]],u=t[l];a[s]=u<=r?u:n[i[l*r]].length}return a},vr.prototype.addTo=function(e,t){var n=this._idToIndex[e],i=this._sizes[n],r=n*this._MAX_LIST_SIZE;if(i<this._MAX_LIST_SIZE)this._buffer[r+i]=t,this._sizes[n]=i+1;else if(i===this._BIG_LIST)this._bigLists[this._buffer[r]].push(t);else{for(var a=new Array(this._MAX_LIST_SIZE),s=0;s<this._MAX_LIST_SIZE;++s)a[s]=this._buffer[r+s];a.push(t),this._bigLists.push(a),this._sizes[n]=this._BIG_LIST,this._buffer[r]=this._bigLists.length-1}},vr.prototype.removeFrom=function(e,t){this.removeFromAndGetSize(e,t)},vr.prototype.removeFromAndGetSize=function(e,t){var n=this._idToIndex[e],i=this._sizes[n],r=this._MAX_LIST_SIZE*n;if(i<=this._MAX_LIST_SIZE){for(var o=r,a=r+i;o<a;++o)if(this._buffer[o]===t)return--i,this._buffer[o]=this._buffer[a-1],this._sizes[n]=i}else if(i===this._BIG_LIST){var l=this._bigLists[this._buffer[r]],u=l.indexOf(t);if(-1!==u)return l.splice(u,1),l.length}},vr.prototype.reserve=function(e){this._capacity<e&&this._expand(e)},vr.prototype._expand=function(e){this._capacity=Math.pow(2,Math.ceil(Math.log2(e))),this._buffer=Ag(this._buffer,this._capacity*this._MAX_LIST_SIZE),this._sizes=Ag(this._sizes,this._capacity)},vr.prototype.has=function(e){var t=this._idToIndex[e];return!(void 0===t||t>=this._capacity)&&0!==this._sizes[t]},Sg.averageSize.get=function(){for(var e=0,t=0;t<this._capacity;t++)e+=this._sizes[t];return e/this._capacity},Object.defineProperties(vr.prototype,Sg);var wg="undefined"==typeof Map?function(){function e(){this._values={},this._size=0}var t={size:{configurable:!0}};return t.size.get=function(){return this._size},e.prototype.has=function(n){return!!this._values[n]},e.prototype.set=function(n,i){n in this._values||this._size++,this._values[n]=i},e.prototype.get=function(n){return this._values[n]},e.prototype.delete=function(n){n in this._values&&(delete this._values[n],this._size--)},e.prototype.keys=function(){return Object.keys(this._values)},e.prototype.clear=function(){this._values={},this._size=0},Object.defineProperties(e.prototype,t),e}():Map,Qx="undefined"==typeof Set?function(){function e(){this._values={},this._size=0}var t={size:{configurable:!0}};return t.size.get=function(){return this._size},e.prototype.has=function(n){return!!this._values[n]},e.prototype.add=function(n){n in this._values||this._size++,this._values[n]=!0},e.prototype.delete=function(n){n in this._values&&(delete this._values[n],this._size--)},e.prototype.keys=function(){return Object.keys(this._values)},e.prototype.clear=function(){this._values={},this._size=0},Object.defineProperties(e.prototype,t),e}():Set,Kx=(1<<Math.log2(16))-1,Sc={averageCellOccupancy:{configurable:!0},size:{configurable:!0}};Gi.prototype.setMinCellSize=function(e){return this._minCellSize=e,this},Gi.prototype.setOffset=function(e){return this._offset=e,this._min=-e,this._max=e,this._resolution=65535/(this._max-this._min),this},Gi.prototype.setIntersector=function(e){return this._intersects=e,this},Gi.prototype.setBoundsGetter=function(e){return this._getBounds=e,this},Gi.prototype.insert=function(e,t){void 0===t&&(t=this._getBounds(e));var n,i=Math.max(t[2]-t[0],t[3]-t[1]),r=this._minCellSize;for(n=0;r<i&&n<16;n++)r*=2;var o=this._resolution,a=this._min,s=o*(.5*(t[2]+t[0])-a)/r|0,l=o*(.5*(t[3]+t[1])-a)/r|0,u=Dl(s,l,n);this._cells.has(u)||this._cells.addEntry(u),this._cells.addTo(u,e),this._objectsAtLevel[n]++,this._occupied|=1<<n;var d=4*n,c=this._bounds;return s<c[d]&&(c[d]=s),l<c[1+d]&&(c[1+d]=l),s>c[2+d]&&(c[2+d]=s),l>c[3+d]&&(c[3+d]=l),this._idToCode.set(e,u),u},Gi.prototype.has=function(e){return this._idToCode.has(e)},Gi.prototype.update=function(e,t){return this.remove(e),this.insert(e,t)},Gi.prototype.remove=function(e){var t=this._idToCode.get(e);Ec(t,this._codeCache);var n=this._codeCache[2];return 0==--this._objectsAtLevel[n]&&(this._occupied&=~(1<<n),this._bounds[4*n]=1/0,this._bounds[4*n+1]=1/0,this._bounds[4*n+2]=-1/0,this._bounds[4*n+3]=-1/0),this._cells.removeFrom(t,e),this._idToCode.delete(e),this},Gi.prototype.query=function(e){var t=e[0],n=e[1],i=e[2],r=e[3],o=this._cells,a=this._bounds,s=this._intersects,l=this._min,u=this._resolution,d=this._minCellSize,c=this._occupied,h=[];t=u*(t-l),n=u*(n-l),i=u*(i-l),r=u*(r-l);for(var p=0;p<16&&0!==c;d*=2,c>>=1,p++)if(0!=(1&c))for(var g=1/d,m=4*p,x=Math.max(a[m],t*g-1>>0),v=Math.max(a[1+m],n*g-1>>0),y=Math.min(a[2+m],i*g+1>>0),b=Math.min(a[3+m],r*g+1>>0),S=x;S<=y;S++)for(var w=v;w<=b;w++){var M=Dl(S,w,p),N=o.getItems(M);if(void 0!==N)for(var D=0;D<N.length;D++){var P=N[D];s(P,e)&&h.push(P)}}return h},Gi.prototype.collisions=function(e,t){if(void 0===t&&(t=this._getBounds),"function"!=typeof t)throw new Error("getBounds function is required to get the object bounds");for(var n=Array.from(this._idToCode.keys()),i=this._min,r=this._resolution,o=this._cells,a=new wg,s=[],l=0;l<n.length;l++){var u=0,d=this._minCellSize,c=this._occupied,h=n[l],p=t(h),g=p[0],m=p[1],x=p[2],v=p[3],y=Math.max(x-g,v-m);for(u=0;d<y;u++)d*=2,c>>=1;g=r*(g-i),m=r*(m-i),x=r*(x-i),v=r*(v-i);for(var b=u;b<16&&0!==c;d*=2,c>>=1,b++)if(0!=(1&c))for(var S=1/d,w=m*S-1>>0,M=x*S+1>>0,N=v*S+1>>0,D=g*S-1>>0;D<=M;D++)for(var P=w;P<=N;P++){var L=Dl(D,P,b);if(a.get(L)!==l){a.set(L,l);var V=o.getItems(L);if(void 0!==V)for(var X=0;X<V.length;X++){var J=V[X];J!==h&&e(h,J)&&s.push(h,J)}}}}return function(se){for(var re=new Qx,j=[],Y=0;Y<se.length;Y+=2){var he=se[Y],pe=se[Y+1],Ae=he<pe?he*pe+(pe-he-1)*(pe-he-1)/4:he*pe+(he-pe-1)*(he-pe-1)/4;re.has(Ae)||(re.add(Ae),j.push(he,pe))}return j}(s)},Gi.prototype.clear=function(){this._occupied=0,this._cells.clear(),this._idToCode.clear(),this._objectsAtLevel=new Array(16).fill(0),this._bounds=new Array(64);for(var e=0;e<16;e++)this._bounds[4*e]=1/0,this._bounds[4*e+1]=1/0,this._bounds[4*e+2]=-1/0,this._bounds[4*e+3]=-1/0;return this},Gi.prototype.keyToBBox=function(e){var t=Ec(e),n=t[0],i=t[1],o=this._minCellSize*(1<<t[2]),a=this._min,s=this._resolution;return[n*o/s+a,i*o/s+a,(n+1)*o/s+a,(i+1)*o/s+a]},Gi.prototype.keys=function(){return Object.keys(this._cells._idToIndex)},Sc.averageCellOccupancy.get=function(){return this._cells.averageSize},Sc.size.get=function(){return this._idToCode.size},Object.defineProperties(Gi.prototype,Sc),Gi.code=Dl,Gi.decode=Ec;var Tg,$x=["x","y","radius"],eb=["width","curvature"],tb=(St(Fi,Tg=Pe),Fi.prototype._getIntersector=function(){var e=this._graph,t=e.getNodeAttributes(["x","y","radius"]),n=t[0],i=t[1],r=t[2],o=e.getEdgeAttributes(["source","target","width","curvature"]),a=o[0],s=o[1],l=o[2],u=o[3],d={x:0,y:0,x1:0,y1:0,x2:0,y2:0};return function(c,h){if(c<0){var p=a.get(c=-c),g=s.get(c),m=u.get(c),x=l.get(c)/2,v=n.get(p),y=i.get(p),b=n.get(g),S=i.get(g);return p===g?(Ya(v,y,m,r.get(p),0,d),yf(v,y,d.x1,d.y1,d.x2,d.y2,b,S,h[0]-x,h[1]-x,h[2]+x,h[3]+x)):0===m?Xd(v,y,b,S,h[0]-x,h[1]-x,h[2]+x,h[3]+x):(pa(v,y,b,S,m,d),vf(v,y,d.x,d.y,b,S,h[0]-x,h[1]-x,h[2]+x,h[3]+x))}return lc(n.get(c),i.get(c),r.get(c),h[0],h[1],h[2],h[3])}},Fi.prototype._boundsGetter=function(){var e=this._graph,t=e.getNodeAttributes(["x","y","radius"]),n=t[0],i=t[1],r=t[2],o=e.getEdgeAttributes(["source","target","curvature"]),a=o[0],s=o[1],l=o[2],u={x:0,y:0,x1:0,y1:0,x2:0,y2:0},d={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(c){if(c<0){var h=a.get(c=-c),p=s.get(c),g=l.get(c),m=n.get(h),x=i.get(h),v=n.get(p),y=i.get(p);h===p?(Ya(m,x,g,r.get(h),0,u),gl(m,x,u.x1,u.y1,u.x2,u.y2,v,y,d)):0===g?(d.minX=Math.min(m,v),d.minY=Math.min(x,y),d.maxX=Math.max(m,v),d.maxY=Math.max(x,y)):(pa(m,x,v,y,g,u),Kd(m,x,u.x,u.y,v,y,d))}else{var b=n.get(c),S=i.get(c),w=r.get(c);d.minX=b-w,d.minY=S-w,d.maxX=b+w,d.maxY=S+w}return[d.minX,d.minY,d.maxX,d.maxY]}},Fi.prototype.reindex=function(){this._graphics.forceAttributesComputation(),this._index.clear(),this._elementsToUpdate.clear(),this._updateItems(this._graph.getNodes("all")._indexes,this._graph.getEdges("all")._indexes)},Fi.prototype._updateIndex=function(){if(!this._elementsToUpdate.isEmpty()){var e=this._elementsToUpdate.getElements();this._updateItems(e.nodes._indexes,e.edges._indexes),this._elementsToUpdate.clear()}},Fi.prototype._updateItems=function(e,t){for(var n=this._index,i=this._removedNodes,r=this._removedEdges,o=[],a=[],s=0;s<e.length;s++){var l=e[s];0!==i.get(l)?o.push(l):(n.has(l)&&o.push(l),a.push(l))}for(s=0;s<t.length;s++)0!==r.get(-(l=-t[s]))?o.push(l):(n.has(l)&&o.push(l),a.push(l));for(var u=0,d=o;u<d.length;u++)n.remove(l=d[u]);for(var c=0,h=a;c<h.length;c++)n.insert(l=h[c])},Fi.prototype.getNodesInScreenByDistance=function(e){var t=e.getPositionOnScreen(),n=t.x,i=t.y;return this._graph.getNodes().filter(function(r){return r.isInScreen()&&r!==e}).sort(function(r,o){var a=r.getPositionOnScreen(),s=o.getPositionOnScreen();return yi(a.x,a.y,n,i)-yi(s.x,s.y,n,i)})},Fi.prototype.getNearestNodesForNode=function(e,t,n){void 0===t&&(t=240);var i=e.getPosition();return this.getNearestNodes(i.x,i.y,t,n,e)},Fi.prototype.getNearestNodes=function(e,t,n,i,r){if(this._updateIndex(),i){var o=this._camera.screenToGraphVector({x:n,y:n});n=yi(0,0,o.x,o.y)}return this._getNearestNodes(e,t,n,r)},Fi.prototype._getNearestNodes=function(e,t,n,i){for(var r=[],o=n*n,a=i?i._index:0,s=this._graph.getNodes()._indexes,l=this._graph.getNodeAttributes(["x","y"]),u=l[0],d=l[1],c=0,h=s.length;c<h;c++){var p=s[c];if(p!==a){var g=e-u.get(p),m=t-d.get(p);g*g+m*m<=o&&r.push(p)}}return this._graph.nodeList(new Uint32Array(r))},Fi.prototype.queryRaw=function(e,t,n,i){this._updateIndex();var r=this._queryBounds;r[0]=e,r[1]=t,r[2]=n,r[3]=i;var o=this._index.query(r),a=this._queryResult,s=a.nodes,l=a.edges;s.length=l.length=0;for(var u=0;u<o.length;u++){var d=o[u];d<0?l.push(-d):s.push(d)}return this._queryResult},Fi.prototype.queryRawProjected=function(e,t,n,i){var r=this._queryBounds;return r[0]=e,r[1]=t,r[2]=n,r[3]=i,this._camera.projectBounds(r),this.queryRaw(r[0],r[1],r[2],r[3])},Fi.prototype.query=function(e,t,n,i){var r=this._graph,o=this.queryRaw(e,t,n,i),s=o.edges;return{nodes:r.nodeList(new Uint32Array(o.nodes.slice())),edges:r.edgeList(new Uint32Array(s.slice()))}},Fi.prototype.queryProjected=function(e,t,n,i){var r=this._graph,o=this.queryRawProjected(e,t,n,i),s=o.edges;return{nodes:r.nodeList(new Uint32Array(o.nodes.slice())),edges:r.edgeList(new Uint32Array(s.slice()))}},Fi.prototype.getNodesByBoundingBox=function(e,t,n,i,r){if(this._updateIndex(),r){var o=void 0;e=(o=this._camera.screenToGraphVector({x:e,y:t})).x,t=o.y,n=(o=this._camera.screenToGraphVector({x:n,y:i})).x,i=o.y}for(var a=this._graph,s=a.getNodes()._indexes,l=[],u=a.getNodeAttribute("excluded"),d=a.getNodeAttributes(["x","y"]),c=d[0],h=d[1],p=0,g=s.length;p<g;p++){var m=s[p];if(!u.get(m)){var x=c.get(m),v=h.get(m);e<=x&&x<=n&&t<=v&&v<=i&&l.push(m)}}return a.nodeList(new Uint32Array(l))},Fi.prototype.toggleDebug=function(e){e?(this._canvas=ci(),this._graphics.addCanvas(this._canvas),this._ctx=this._canvas.getContext("2d")):this._canvas&&(this._graphics.removeCanvas(this._canvas),this._canvas=this._ctx=null)},Fi.prototype.renderDebug=function(e){this._ctx||this.toggleDebug(!0),function(t,n){function i(V,X){return{x:(V-y)*v,y:(X-b)*v}}var r=void 0===n?{}:n,o=r.cells,a=void 0===o||o,s=r.boxes,l=void 0===s||s,u=r.query,d=void 0===u||u,c=Ln(),h=t._ctx,p=t._canvas,g=t._camera,m=t._index,x=-g.getAngle(),v=g.getZoom()*c,y=g._x,b=g._y,S=g._dimensions.width*c/2,w=g._dimensions.height*c/2,M=m.keys().map(function(V){return m.keyToBBox(V)}),N=Array.from(m._idToCode.keys()).map(function(V){return m._getBounds(V)});if(h.clearRect(0,0,p.width,p.height),h.save(),h.translate(S,w),h.rotate(x),a&&(h.beginPath(),h.lineWidth=1,h.strokeStyle="#707070",M.forEach(function(V){var X=i(V[0],V[1]),J=i(V[2],V[3]);h.rect(X.x,X.y,J.x-X.x,J.y-X.y)}),h.stroke()),l&&(h.beginPath(),h.lineWidth=1,h.strokeStyle="#ff7070",N.forEach(function(V){var X=i(V[0],V[1]),J=i(V[2],V[3]);h.rect(X.x,X.y,J.x-X.x,J.y-X.y)}),h.closePath(),h.stroke()),d&&t._queryBounds){var D=t._queryBounds;h.beginPath(),h.lineWidth=2,h.strokeStyle="#3030ff";var P=i(D[0],D[1]),L=i(D[2],D[3]);h.rect(P.x,P.y,L.x-P.x,L.y-P.y),h.closePath(),h.stroke()}h.restore()}(this,e)},Fi);function Fi(e){var t=Tg.call(this)||this;t._minCellSize=8;var n=e.graph,i=e.camera,r=e.graphics,o=e.events;return t._graph=n,t._camera=i,t._graphics=r,t._index=new Gi(t._getIntersector(),t._boundsGetter(),t._minCellSize,1e6),t._elementsToUpdate=new hu(t._graph),t._removedNodes=n.getNodeAttribute("removed"),t._removedEdges=n.getEdgeAttribute("removed"),t._queryResult={edges:[],nodes:[]},t._queryBounds=[0,0,0,0],o.on({"addNodes addEdges removeNodes removeEdges updateAttributes":function(a){if(a.nodes&&(!a.nodeAttributes||a.nodeAttributes.some(function(l){return $x.includes(l)}))){var s=a.nodes.fastGetAdjacentElements().edges;t._elementsToUpdate.addElements(a.nodes),t._elementsToUpdate.addElements(s)}a.edges&&(a.edgeAttributes&&!a.edgeAttributes.some(function(l){return eb.includes(l)})||t._elementsToUpdate.addElements(a.edges))},clear:function(){t._index.clear(),t._elementsToUpdate.clear()}}),t}var Mg,Qt,Ac,nb=(St(Xn,Mg=Pe),Xn.prototype.onMounted=function(){this.locateGraph({},!0)},Xn.prototype.locateGraph=function(e,t){var n=this;return void 0===t&&(t=!1),t?this._locateGraph(e):this._transformations.whenApplied().then(function(){return n._locateGraph(e)})},Xn.prototype._locateGraph=function(e){return this._locateBoundingBox(this.getGraphBoundingBox(),e)},Xn.prototype.locateElements=function(e,t){var n=this;return this._transformations.whenApplied().then(function(){return n._locateBoundingBox(n.getBoundingBox(e),t)})},Xn.prototype.locateRawGraph=function(e,t){return this._locateBoundingBox(this.getRawGraphBoundingBox(e),t)},Xn.prototype.getGraphBoundingBox=function(){return this._cacheValid||this._updateCache(),Object.assign({},this._cachedGraphBoundingBox)},Xn.prototype.forceInvalidCache=function(){this._invalidCache()},Xn.prototype._invalidCache=function(){this._cacheValid=!1},Xn.prototype._updateCache=function(){this._cacheValid=!0,this._cachedGraphBoundingBox=this.getBoundingBox(this._graph.getNodes())},Xn.prototype.getBoundingBox=function(e,t){return e.isNode?this._getNodesBoundingBox(e.toList()):this._getEdgesBoundingBox(e.toList(),t)},Xn.prototype._getNodesBoundingBox=function(e){this._graphics.forceAttributesComputation();for(var t=this._graphics.getNodeAttributes(),n=[],i=[],r=[],o=[],a=0;a<e.size;++a){var s=e._indexes[a];if(0===t.excluded.get(s)){var l=t.x.get(s),u=t.y.get(s),d=2*t.radius.get(s);"scaled"===t.scalingMethod.get(s)?r.push(d):o.push(d),n.push(l),i.push(u)}}return new Cr({xValues:n,yValues:i,scaledSizeValues:r,fixedSizeValues:o})},Xn.prototype._getEdgesBoundingBox=function(e,t){void 0===t&&(t=!1),this._graphics.forceAttributesComputation();for(var n=this._graphics.getEdgeAttributes(),i=this._graphics.getNodeAttributes(),r={x1:0,y1:0,x2:0,y2:0},o={x:0,y:0},a={minX:0,minY:0,maxX:0,maxY:0},s=[],l=[],u=[],d=[],c=0;c<e.size;++c){var h=e._indexes[c],p=n.source.get(h),g=n.target.get(h),m=n.curvature.get(h),x=i.x.get(p),v=i.y.get(p),y="scaled"===i.scalingMethod.get(p),b=2*i.radius.get(p),S=i.x.get(g),w=i.y.get(g),M="scaled"===i.scalingMethod.get(g),N=2*i.radius.get(g);y?u.push(b):d.push(b),M?u.push(N):d.push(N),t||0===m?(s.push(x,S),l.push(v,w)):(p===g?(Ya(x,v,m,b/2,0,r),gl(x,v,r.x1,r.y1,r.x2,r.y2,S,w,a)):(pa(x,v,S,w,m,o),Kd(x,v,o.x,o.y,S,w,a)),s.push(a.minX,a.maxX),l.push(a.minY,a.maxY))}return new Cr({xValues:s,yValues:l,scaledSizeValues:u,fixedSizeValues:d})},Xn.prototype.getRawGraphBoundingBox=function(e){for(var t=e.nodes.length,n=new Array(t),i=new Array(t),r=new Array(t),o=0;o<t;o++){var a=e.nodes[o].attributes||{};n[o]=a.x||0,i[o]=a.y||0,r[o]=a.radius||5}return new Cr({xValues:n,yValues:i,scaledSizeValues:r})},Xn.prototype._computeCameraConfig=function(e,t,n){"number"==typeof t&&(t={left:t,right:t,top:t,bottom:t});var i,r=void 0===t.left?40:t.left,o=void 0===t.right?40:t.right,a=void 0===t.top?40:t.top,s=void 0===t.bottom?40:t.bottom,l=this._dom.getDimensions(),u=r+o,d=a+s,c=0===e.width?e.maxFixedSize:e.width,h=0===e.height?e.maxFixedSize:e.height,y=(i=[(l.width-u)/(c+e.maxScaledSize),(l.height-d)/(h+e.maxScaledSize),(l.width-u-e.maxFixedSize)/c,(l.height-d-e.maxFixedSize)/h,n/e.maxScaledSize||NaN].filter(function(b){return isFinite(b)&&0<b})).length?_n(i):1;return{x:e.cx+(o-r)/(2*y),y:e.cy+(s-a)/(2*y),zoom:y}},Xn.prototype._locateBoundingBox=function(e,t){if(void 0===t&&(t={}),isNaN(e.cx))return Promise.resolve();var n=t.padding,r=t.easing,o=void 0===r?"quadraticInOut":r,a=t.duration,s=void 0===a?0:a,l=t.maxNodeSizeOnScreen,d=t.ignoreZoomLimits,c=void 0!==d&&d,h=this._computeCameraConfig(e,void 0===n?{}:n,void 0===l?200:l),p=h.x,g=h.y,m=h.zoom,x=m/this._camera.getZoom();return this._moveCamera(p,g,m,s,o,x,c)},Xn.prototype._moveCamera=function(e,t,n,i,r,o,a){return 1.01<o?(this._camera.setCenter({x:e,y:t},{duration:i,easing:r,ignoreZoomLimits:a}),this._camera.setZoom(n,{duration:i,easing:r,ignoreZoomLimits:a,startAfter:.5})):o<.99?(this._camera.setCenter({x:e,y:t},{duration:i,easing:r,ignoreZoomLimits:a,startAfter:.5}),this._camera.setZoom(n,{duration:i,easing:r,ignoreZoomLimits:a})):this._camera.setCenter({x:e,y:t},{duration:i,easing:r,ignoreZoomLimits:a})},Xn.prototype.computeConfigForBounds=function(e,t){void 0===t&&(t={});var n=t.padding,r=t.maxNodeSizeOnScreen;return this._computeCameraConfig(e,void 0===n?{}:n,void 0===r?200:r)},Xn.prototype.layoutDataBoundingBox=function(e){for(var t=e.x,n=e.y,i=e.indexes,r=this._graphics.getNodeAttributes(),o=[],a=[],s=[],l=[],u=0;u<i.length;++u){var d=i[u],c=t[u],h=n[u],p=2*r.radius.get(d),g="scaled"===r.scalingMethod.get(d);o.push(c),a.push(h),g?s.push(p):l.push(p)}return new Cr({xValues:o,yValues:a,scaledSizeValues:s,fixedSizeValues:l})},Xn.prototype.isEdgeInPolygon=function(e,t){var n=e.getSource(),i=e.getTarget(),r=n.getPositionOnScreen(),o=i.getPositionOnScreen();if(bu(r.x,r.y,t)||bu(o.x,o.y,t))return!0;for(var a=Ig(e,this._camera.getZoom()),s=0;s<a.length-1;++s)for(var l=a[s],u=a[s+1],d=0;d<t.length-1;++d){var c=t[d],h=t[d+1];if(Is(l.x,l.y,u.x,u.y,c.x,c.y,h.x,h.y))return!0}return!1},Xn.prototype.isElementInView=function(e,t){var n=(void 0===t?{}:t).margin,i=void 0===n?0:n,r=this._camera.getSize(),o={minX:-i,minY:-i,maxX:r.width+i,maxY:r.height+i};return e.isNode?this.isNodeInRectangle(e,o):this.isEdgeInRectangle(e,o)},Xn.prototype.isNodeInRectangle=function(e,t){var n=e.getPositionOnScreen(),i=e.getAttribute("radius")*this._camera.getZoom();return n.x+i>=t.minX&&n.x-i<=t.maxX&&n.y+i>=t.minY&&n.y-i<=t.maxY},Xn.prototype.isNodeInPolygon=function(e,t){var n=e.getPositionOnScreen();return bu(n.x,n.y,t)},Xn.prototype.isEdgeInRectangle=function(e,t){for(var n=Ig(e,this._camera.getZoom()),i=0;i<n.length-1;++i){var r=n[i],o=n[i+1];if(Xd(r.x,r.y,o.x,o.y,t.minX,t.minY,t.maxX,t.maxY))return!0}return!1},Xn);function Xn(e){var t=Mg.call(this)||this;return t._cacheValid=!0,t._cachedGraphBoundingBox=new Cr,t._dom=e.dom,t._events=e.events,t._camera=e.camera,t._graph=e.graph,t._graphics=e.graphics,t._settings=e.settings,t._sync=e.sync,t._transformations=e.transformations,t._events.on({"addNodes removeNodes addEdges removeEdges excludedStateChange clear updateAttributes":function(){return t._invalidCache()}}),t}function Ig(e,t){var n=e.getAttribute("curvature"),i=e.getSource(),r=e.getTarget(),o=i.getPositionOnScreen();if(i===r){var a=5*(n+i.getAttribute("radius"))*t,s=o.x,l=o.y,u=s-a,d=l,c=s,h=l+a;return[o].concat([.2,.4,.6,.8].map(function(M){return vu(M,s,l,s,l,u,d,c,h)}),[o])}var p=r.getPositionOnScreen();if(0===n)return[o,p];var g=p.x-o.x,m=p.y-o.y,x=Math.sqrt(g*g+m*m),b=n*(x/5)*2,S=(o.x+p.x)/2+m/x*b,w=(o.y+p.y)/2+-g/x*b;return[o].concat([.25,.5,.75].map(function(M){return Qd(M,o.x,o.y,p.x,p.y,S,w)}),[p])}(Ac=Qt=Qt||{}).LEFT="left",Ac.MIDDLE="middle",Ac.RIGHT="right";var ib=Wi&&"msLaunchUri"in navigator&&!("documentMode"in document);if(Rr){var kg=[];document.documentElement.addEventListener("mousemove",function(e){for(var t=0;t<kg.length;t++)kg[t](e)})}var Og,rb=(St(ur,Og=Pe),Object.defineProperty(ur.prototype,"x",{get:function(){return this._position.x},enumerable:!0,configurable:!0}),Object.defineProperty(ur.prototype,"y",{get:function(){return this._position.y},enumerable:!0,configurable:!0}),Object.defineProperty(ur.prototype,"left",{get:function(){return this._left},enumerable:!0,configurable:!0}),Object.defineProperty(ur.prototype,"right",{get:function(){return this._right},enumerable:!0,configurable:!0}),Object.defineProperty(ur.prototype,"middle",{get:function(){return this._middle},enumerable:!0,configurable:!0}),ur.prototype._isEnabled=function(){return this._settings.get("mouse.enabled")},ur.prototype._isWheelEnabled=function(){return this._settings.get("mouse.wheelEnabled")},ur.prototype._disableWheelUntilMouseDown=function(){return this._settings.get("mouse.disableWheelUntilMouseDown")},ur.prototype._getDoubleClickTimer=function(){return this._settings.get("mouse.doubleClickTimer")},ur.prototype._resetClickCounter=function(e,t){void 0===t&&(t=0),e?this._clickCounter[e]=t:(this._clickCounter.left=t,this._clickCounter.middle=t,this._clickCounter.right=t),this._dom.clearTimeout(this._dbclickTimer),this._lastMouseDownTarget=null},ur.prototype._setXY=function(e){var t=this._domElt.getBoundingClientRect();return!!(this._bounds=t)&&(this._evt=e,this._button=Mi[e.button],this._px=this._position.x,this._py=this._position.y,this._position.x=e.clientX-t.left,this._position.y=e.clientY-t.top,this._left=this._buttons.left,this._right=this._buttons.right,this._middle=this._buttons.middle,!0)},ur.prototype._applyMouseWheelZoom=function(e){var t;this._setXY(e)&&this._events.fire(I.MOUSE_WHEEL,{delta:(t=e,ib?t.wheelDeltaY/2:t.deltaY&&0===t.deltaMode?-t.deltaY/Ln():t.deltaY&&1===t.deltaMode?20*-t.deltaY:t.deltaY&&2===t.deltaMode?60*-t.deltaY:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?20*-t.detail:t.detail?t.detail/-32765*60:0),x:this._position.x,y:this._position.y,domEvent:this._evt})},ur.prototype._initializeListeners=function(){var e=this,t=this._domElt,n=this._dom;ho&&this._dom.addElementEventListener(document,"contextmenu",function(r){e._lastMouseDownTarget&&r.target!==e._lastMouseDownTarget&&r.preventDefault()}),n.addElementEventListener(t,"contextmenu",function(r){e._setXY(r),e._dom.hasFocus()&&e._settings.get("mouse.enabled")&&r.preventDefault()},!1),n.addElementEventListener(t,"onwheel"in t?"wheel":void 0!==t.onmousewheel?"mousewheel":"DOMMouseScroll",this._onMouseWheel),n.addElementEventListener(t,"mousemove",this._onMouseMove),n.addElementEventListener(t,"mouseleave",function(){e._isEnabled()&&(e._dom.blur(),e._events.fire(I.MOUSE_LEAVE,{domEvent:e._evt}))}),n.addElementEventListener(t,"mousedown",this._onMouseDown),n.addElementEventListener(t,"mouseup",this._onMouseUp)},ur);function ur(e){var t=e.dom,n=e.position,i=e.settings,r=e.events,o=e.graphics,a=Og.call(this)||this;return a._px=0,a._py=0,a._pressX=0,a._pressY=0,a._left=!1,a._middle=!1,a._right=!1,a._evt=null,a._bounds=null,a._clickCounter={left:0,middle:0,right:0},a._buttons={left:!1,middle:!1,right:!1},a._button=null,a._lastMouseDownTarget=null,a._skipNextMove=!1,a._onMouseWheel=function(s){a._isEnabled()&&a._isWheelEnabled()&&(!a._disableWheelUntilMouseDown()||a._dom.hasFocus())&&(s.preventDefault(),s.stopPropagation(),a._applyMouseWheelZoom(s))},a._onMouseMove=function(s){if(a._isEnabled()&&a._setXY(s)){var l=a._position.x,u=a._position.y,d=l-a._px,c=u-a._py;0==d&&0==c||(a._skipNextMove?a._skipNextMove=!1:6<=yi(l,u,a._pressX,a._pressY)&&(a._resetClickCounter(),a._events.fire(I.MOUSE_MOVE,{x:l,y:u,dx:d,dy:c,domEvent:a._evt})))}},a._onDocumentMouseMove=function(s){if(a._isEnabled()&&a._setXY(s)){var l=a._position.x,u=a._position.y,d=a._bounds;(l<0||l>d.width||u<0||u>d.height)&&a._events.fire(I.DOCUMENT_MOUSE_MOVE,{x:l,y:u,dx:l-a._px,dy:u-a._py,domEvent:a._evt})}},a._onMouseUp=function(s){if(a._isEnabled()&&a._setXY(s)){var l=a._position.x,u=a._position.y,d=a._button,c=a._evt;a._buttons[d]=!1,1===a._clickCounter[a._button]?a._events.fire(I.MOUSE_CLICK,{button:d,x:l,y:u,domEvent:c}):1<a._clickCounter[d]&&(a._events.fire(I.MOUSE_DOUBLE_CLICK,{button:d,x:l,y:u,domEvent:c}),a._resetClickCounter(d)),a._events.fire(I.MOUSE_UP,{button:d,x:l,y:u,domEvent:c})}},a._onDocumentMouseup=function(s){if(a._isEnabled()&&a._setXY(s)){var l=a._position.x,u=a._position.y,d=a._button;a._buttons[d]=!1,a._events.fire(I.DOCUMENT_MOUSE_UP,{button:d,x:l,y:u,domEvent:a._evt}),a._dom.removeDocumentEventListener(I.MOUSE_MOVE,a._onDocumentMouseMove),a._dom.removeDocumentEventListener(I.MOUSE_UP,a._onDocumentMouseup)}},a._onMouseDown=function(s){if(a._isEnabled()&&a._setXY(s)){var l=a._position.x,u=a._position.y,d=a._button;a._skipNextMove=!0,a._pressX=l,a._pressY=u,a._lastMouseDownTarget=s.target,a._dom.focus(),a._buttons[d]=!0,a._clickCounter[d]+=1;var c=d;a._dbclickTimer=a._dom.setTimeout(function(){a._resetClickCounter(c,0)},a._getDoubleClickTimer()),a._events.fire(I.MOUSE_DOWN,{button:d,x:l,y:u,domEvent:a._evt}),a._dom.addDocumentEventListener(I.MOUSE_MOVE,a._onDocumentMouseMove),a._dom.addDocumentEventListener(I.MOUSE_UP,a._onDocumentMouseup)}},a._dom=t,a._settings=i,a._events=r,a._graphics=o,a._position=n,a._domElt=a._graphics.getDomElement(),i.register("mouse.enabled",!0),i.register("mouse.wheelEnabled",!0),i.register("mouse.disableWheelUntilMouseDown",!1),i.register("mouse.doubleClickTimer",500),r.register([I.MOUSE_DOWN,I.MOUSE_UP,I.MOUSE_MOVE,I.MOUSE_WHEEL,I.MOUSE_CLICK,I.MOUSE_DOUBLE_CLICK,I.MOUSE_LEAVE,I.DOCUMENT_MOUSE_UP,I.DOCUMENT_MOUSE_MOVE]),t.afterNextFrame().then(function(){return a._initializeListeners()}),a}var Ng,ab=(St(ts,Ng=Pe),Object.defineProperty(ts.prototype,"x",{get:function(){return this._position.x},enumerable:!0,configurable:!0}),Object.defineProperty(ts.prototype,"y",{get:function(){return this._position.y},enumerable:!0,configurable:!0}),Object.defineProperty(ts.prototype,"pressed",{get:function(){return this._pressed},enumerable:!0,configurable:!0}),ts.prototype._listen=function(e,t,n){if(ve){if(t===oe.START)return function(e,t,n){function i(r){Oe(r)||(Ce(r)&&r.preventDefault(),ae(r,n))}return e(t,q,i,!1),i}(this._addEvent,e,n);if(t===oe.MOVE)return function(e,t,n){function i(r){Oe(r)&&0===r.buttons||ae(r,n)}return e(t,Q,i,!1),i}(this._addDocEvent,e,n);if(t===oe.END)return function(e,t,n){function i(r){return ae(r,n)}return e(t,$,i,!1),e(t,ue,i,!1),i}(this._addDocEvent,e,n);if(t===oe.CANCEL)return function(e,t,n){function i(r){Ce(r)&&r.preventDefault(),ae(r,n)}return e(t,ue,i,!1),i}(this._addDocEvent,e,n)}return this._dom.addElementEventListener(e,t,n)},ts.prototype._initialize=function(e){function t(){s._position.x=l,s._position.y=u,s._pressed=h}function n(w,M){var N=s._domElt.getBoundingClientRect();if(!N)return null;var D=w.touches[0].clientX-N.left,P=w.touches[0].clientY-N.top,L=w.touches[1].clientX-N.left,V=w.touches[1].clientY-N.top,X=(D+L)/2,J=(P+V)/2,se=X-l,re=J-u,j=yi(D,P,L,V),Y=j/v,he=Ms(D,P,L,V),pe={dx:se,dy:re,rotation:he-y,scale:Y};return v=j,y=he,l=X,u=J,t(),pe}function i(w){if(p=Mi[w.button],1!==w.touches.length)return h=!1,1<w.touches.length&&s._events.fire(I.TOUCH_UP,{x:l,y:u,domEvent:b,button:p}),!1;var M=s._domElt.getBoundingClientRect();return M&&(d=l,c=u,l=w.touches[0].clientX-M.left|0,u=w.touches[0].clientY-M.top|0,h=!0,b=w,t()),!0}function r(){g=0,s._dom.clearTimeout(S)}function o(w){if(w.preventDefault(),2!==w.touches.length&&x&&(x=!1,s._events.fire(I.TOUCH_END_GESTURE,{domEvent:b})),i(w),0===w.touches.length){var M={x:l,y:u,domEvent:b,button:p};1===g&&s._events.fire(I.TOUCH_TAP,M),1<g&&(s._events.fire(I.TOUCH_DOUBLE_TAP,M),r()),s._events.fire(I.TOUCH_UP,M)}var N=Bi().documentElement;be(s._removeDocEvent,N,oe.MOVE,s._onMove),be(s._removeDocEvent,N,oe.END,s._onEnd)}function a(w){(function(M){if(2===M.touches.length&&x){var N=n(M);N&&s._events.fire(I.TOUCH_PROGRESS_GESTURE,{dx:N.dx,dy:N.dy,rotation:N.rotation,scale:N.scale,x:l,y:u,domEvent:b,button:p})}})(w),m?m=!1:(r(),i(w)&&s._events.fire(I.TOUCH_MOVE,{x:l,y:u,dx:l-d,dy:u-c,domEvent:b,button:p}))}var s=this,l=0,u=0,d=0,c=0,h=!1,p=Qt.LEFT,g=0,m=!1,x=!1,v=1,y=0,b=null,S=null;this._listen(this._domElt,oe.START,function(w){2!==w.touches.length||x||n(w)&&(x=!0,s._events.fire(I.TOUCH_START_GESTURE,{domEvent:b})),i(w)&&(s._dom.focus(),s._events.fire(I.TOUCH_DOWN,{x:l,y:u,domEvent:b,button:p}),g+=1,S=s._dom.setTimeout(r,500),m=!0);var M=Bi().documentElement;s._onMove=s._listen(M,oe.MOVE,a),s._onEnd=s._listen(M,oe.END,o)})},ts);function ts(e){var t=e.dom,n=e.events,i=e.settings,r=e.graphics,o=e.position,a=Ng.call(this)||this;return a._pressed=!1,a._addEvent=function(s,l,u,d){a._dom.addElementEventListener(s,l,u,d)},a._addDocEvent=function(s,l,u,d){a._dom.addDocumentEventListener(l,u,d)},a._removeDocEvent=function(s,l,u){a._dom.removeDocumentEventListener(l,u)},a._dom=t,a._events=n,a._settings=i,a._graphics=r,a._position=o,a._domElt=a._graphics.getDomElement(),a._settings.register("touch.enabled",!0),a._events.register([I.TOUCH_DOWN,I.TOUCH_UP,I.TOUCH_TAP,I.TOUCH_DOUBLE_TAP,I.TOUCH_MOVE,I.TOUCH_START_GESTURE,I.TOUCH_PROGRESS_GESTURE,I.TOUCH_END_GESTURE,I.DOCUMENT_TOUCH_MOVE,I.DOCUMENT_TOUCH_UP]),a._dom.afterNextFrame().then(function(){a._initialize(a)}),a}var Lg,sb=(St(wa,Lg=Pe),wa.prototype._fetchSubEltsList=function(e){return e?this._subNodesList:this._subEdgesList},wa.prototype._fetchMetaEltList=function(e){return e?this._metaNodeList:this._metaEdgeList},wa.prototype.setSubElements=function(e,t){this._fetchSubEltsList(e.isNode).setMultiple(e._indexes,t)},wa.prototype.setMetaElement=function(e,t){this._fetchMetaEltList(e.isNode).setMultiple(e._indexes,t)},wa.prototype.getSubElements=function(e){return this._fetchSubEltsList(e.isNode).getMultiple(e._indexes)},wa.prototype.getMetaElement=function(e){return this._fetchMetaEltList(e.isNode).getMultiple(e._indexes)},wa);function wa(e){var t=e.graph,n=Lg.call(this)||this;return n._graph=t,n._subNodesList=n._graph.createNodeAttribute({storage:"any",default:null}),n._subEdgesList=n._graph.createEdgeAttribute({storage:"any",default:null}),n._metaNodeList=n._graph.createNodeAttribute({storage:"any",default:null}),n._metaEdgeList=n._graph.createEdgeAttribute({storage:"any",default:null}),n}var ub=(Mr.prototype.getName=function(){return this._module.getName(this._id)},Mr.prototype.getId=function(){return this._id},Mr.prototype.whenApplied=function(){return this._whenApplied},Mr.prototype.isEnabled=function(){return this._module.isEnabled(this._id)},Mr.prototype.enable=function(e){return this._module.enable(this._id,e)},Mr.prototype.disable=function(e){return this._module.disable(this._id,e)},Mr.prototype.toggle=function(e){return this._module.toggle(this._id,e)},Mr.prototype.getIndex=function(){return this._module.getIndex(this._id)},Mr.prototype.setIndex=function(e){return this._module.setIndex(this._id,e)},Mr.prototype.destroy=function(e){return this._module.remove(this._id,e)},Mr.prototype.refresh=function(){return this._module.refresh(this._id)},Mr.prototype.delete=function(e){return this.destroy(e)},Mr);function Mr(e,t){var n=this;this._module=e,this._id=t,this._whenApplied=e.whenApplied().then(function(){return n})}var Au=(Fg.prototype.cleanup=function(e){return Promise.resolve()},Fg);function Fg(e){}var Pg,lb=(St(Pn,Pg=Pe),Pn.prototype._invalidState=function(){var e=this;this._afterCurrentUpdate.then(function(){(e._list.length||e._currentPipeline.length)&&(e._mustRefresh=!0,e._dom.refresh())})},Pn.prototype._onUpdate=function(){var e=this;return this._afterCurrentUpdate.then(function(){return e._dom.refresh(),new Promise(function(t,n){return e._resolvers.push({resolve:t,reject:n})})})},Pn.prototype._resetEltTransformationIds=function(){this._nodeTransformationIdList.reset(),this._edgeTransformationIdList.reset()},Pn.prototype._assignTransformationIds=function(e){this._assignTransformationIdsToElements(!0,e),this._assignTransformationIdsToElements(!1,e)},Pn.prototype._assignTransformationIdsToElements=function(e,t){for(var n=e?this._graph.getNodes("all"):this._graph.getEdges("all"),i=this._graph.getAttribute(e,"virtual"),r=this._graph.getAttribute(e,"excluded"),o=e?this._nodeTransformationIdList:this._edgeTransformationIdList,a=0;a<n._indexes.length;a++){var s=n._indexes[a];if(!o.get(s)){var l=r.get(s),u=i.get(s);!l&&u&&o.set(s,t)}}},Pn.prototype._resolveTransformations=function(e,t,n){var i=this;n||(e.forEach(function(d){return d.duration=0}),t.forEach(function(d){return d.duration=0})),this._resetEltTransformationIds();for(var r=this._selection.getSelectedNodes().getId(),o=this._selection.getSelectedEdges().getId(),a=Promise.resolve(),s=function(d){var c=e[d];null!==c.context&&(a=a.then(function(){return c.methods.undo(c)})),t.some(function(h){return h.id===c.id})||(a=a.then(function(){return c.methods.cleanup(c)}).then(function(){c.context=null}))},l=e.length-1;0<=l;--l)s(l);var u=function(d){var c=t[d],h=null;a=a.then(function(){return c.methods.run(c)}).catch(function(p){return c.error=p,!0}).then(function(p){if(h=p,c.context)return c.methods.cleanup(c)}).then(function(){i._assignTransformationIds(c.id),c.context=h})};for(l=0;l<t.length;++l)u(l);return a=a.then(function(){i._destroyed||(i._graph.getNodes(r).setSelected(!0),i._graph.getEdges(o).setSelected(!0))})},Pn.prototype.getList=function(){return this._list.map(function(e){return e.wrapper})},Pn.prototype.clear=function(){return this._list=[],this._invalidState(),this._onUpdate()},Pn.prototype._get=function(e,t){void 0===t&&(t=!0);for(var n=0;n<this._list.length;++n){var i=this._list[n];if(i.id===e)return i.index=n,i}if(t)throw new Error("calling a method on a destroyed transformation");return null},Pn.prototype.getName=function(e){return this._get(e).methods.getName()},Pn.prototype.enable=function(e,t){var n=this;return this._afterCurrentUpdate.then(function(){var i=n._get(e);return i.enabled||(i.enabled=!0,i.duration=t,n._invalidState()),n._onUpdate()})},Pn.prototype._setRemovalDuration=function(e,t){for(var n=0;n<this._currentPipeline.length;++n){var i=this._currentPipeline[n];i.id===e&&(i.duration=t)}},Pn.prototype.disable=function(e,t){var n=this;return this._afterCurrentUpdate.then(function(){var i=n._get(e);return i.enabled&&(i.enabled=!1,n._setRemovalDuration(e,t),n._invalidState()),n._onUpdate()})},Pn.prototype.remove=function(e,t){var n=this;return this._afterCurrentUpdate.then(function(){var i=n._get(e);return n._list.splice(i.index,1),n._setRemovalDuration(e,t),n._invalidState(),n._onUpdate()})},Pn.prototype.toggle=function(e,t){var n=this;return this._afterCurrentUpdate.then(function(){return n._get(e).enabled?n.disable(e,t):n.enable(e,t)})},Pn.prototype.setIndex=function(e,t){var n=this;return this._afterCurrentUpdate.then(function(){var i=n._get(e);return n._list.splice(i.index,1),n._list.splice(me(t,0,n._list.length),0,i),n._invalidState(),n._onUpdate()})},Pn.prototype.getIndex=function(e){return this._get(e).index},Pn.prototype.add=function(e,t){var n=void 0===t?{}:t,i=n.duration,r=void 0===i?0:i,o=n.enabled,a=void 0===o||o;e.cleanup||(e.cleanup=function(){return Promise.resolve()});var s={ogma:this._ogma,id:++this._idCounter,methods:e,duration:r,enabled:a,context:null,wrapper:new ub(this,this._idCounter),index:-1,error:null};return this._list.push(s),this._invalidState(),s.wrapper},Pn.prototype.whenApplied=function(){return this._onUpdate()},Pn.prototype.refresh=function(){return this._invalidState(),this._onUpdate()},Pn.prototype.isEnabled=function(e){return this._get(e).enabled},Pn.prototype._getElementTransformationId=function(e){return(e.isNode?this._nodeTransformationIdList:this._edgeTransformationIdList).get(e._index)},Pn.prototype.isElementVirtual=function(e){return!!this._getElementTransformationId(e)},Pn.prototype.getElementTransformation=function(e){var t=this._get(this._getElementTransformationId(e),!1);return t&&t.wrapper},Pn.prototype.destroy=function(){this._destroyed=!0},Pn);function Pn(e,t){var n,i=Pg.call(this)||this;return i._list=[],i._currentPipeline=[],i._idCounter=0,i._mustRefresh=!1,i._safeGuard=!1,i._resolvers=[],i._afterCurrentUpdate=Promise.resolve(),i._destroyed=!1,i._computeTransformations=function(){if(!i._safeGuard){if(i._safeGuard=!0,i._afterCurrentUpdate=Promise.resolve(),i._mustRefresh){i._captor.setDetectionEnabled(!1);var r,o,l,a=i._currentPipeline.filter(function(u){return u.enabled}),s=i._list.filter(function(u){return u.enabled});l=a.length===s.length+1&&Dg(a,s,s.length)?(r=[a.pop()],o=[],!0):s.length===a.length+1&&Dg(a,s,a.length)?(r=[],o=[s.pop()],!0):(r=a,o=s,!1),i._afterCurrentUpdate=i._afterCurrentUpdate.then(function(){return i._resolveTransformations(r,o,l)}).then(function(){return i._captor.setDetectionEnabled(!0),i._currentPipeline=i._list.map(function(u){return It({},u)}),i._mustRefresh=!1,i._dom.afterNextFrame()})}i._afterCurrentUpdate=i._afterCurrentUpdate.then(function(){i._safeGuard=!1,i._resolvers.forEach(function(u,d){var c=u.resolve,p=i._list[d];return p&&p.error?(0,u.reject)(p.error):c()}),i._resolvers=[]})}},i._settings=e.settings,i._dom=e.dom,i._events=e.events,i._graph=e.graph,i._captor=e.captor,i._classes=e.classes,i._selection=e.selection,i._ogma=t,i._classes.createClass({name:ai,isBuiltin:!0,nodeAttributes:{opacity:0,radius:0},edgeAttributes:{opacity:0,width:0}}),i._classes.createClass({name:xa,isBuiltin:!0,nodeAttributes:{opacity:0},edgeAttributes:{opacity:0}}),i._nodeTransformationIdList=i._graph.createNodeAttribute({storage:16,default:0}),i._edgeTransformationIdList=i._graph.createEdgeAttribute({storage:16,default:0}),i._settings.register("transformations.updateOnDataChange",!0),i._events.on(((n={})[[I.ADD_NODES,I.ADD_EDGES,I.REMOVE_NODES,I.REMOVE_EDGES].join(" ")]=function(r){r.virtual||i._invalidState()},n[I.UPDATE_NODE_DATA+" "+I.UPDATE_EDGE_DATA]=function(){i._settings.get("transformations.updateOnDataChange")&&!i._safeGuard&&i._invalidState()},n[I.AFTER_NEW_FRAME]=i._computeTransformations,n)),i}function Dg(e,t,n){for(var i=0;i<n;++i)if(e[i].id!==t[i].id)return!1;return!0}var Rg,zg={layer:2,outline:!0,outerStroke:{color:"red",width:5},innerStroke:{minVisibleSize:0},text:{backgroundColor:"rgb(220, 220, 220)",minVisibleSize:0}},db={layer:2,color:"red",outline:!0,text:{backgroundColor:"rgb(220, 220, 220)",minVisibleSize:0},stroke:{width:2}},cb=(St(Ir,Rg=Pe),Ir.prototype.onMounted=function(e){function t(){n._selectionExtremityHighlightedClass.clearNodes(),n._selectedClass.getEdges().getExtremities().addClass(yl)}var n=this;e.events.onEdgesClassAdded(xi,t),e.events.onEdgesClassRemoved(xi,t)},Ir.prototype.setNodeAttributes=function(e,t){this._selectedClass.update({nodeAttributes:e,fullOverwrite:t}),this._selectionExtremityHighlightedClass.update({nodeAttributes:e,fullOverwrite:t}),this._updateExtremityHighlightLayer()},Ir.prototype.setEdgeAttributes=function(e,t){this._selectedClass.update({edgeAttributes:e,fullOverwrite:t}),this._updateExtremityHighlightLayer()},Ir.prototype._updateExtremityHighlightLayer=function(){var e=this._selectedClass.getDefinition().edgeAttributes;this._selectionExtremityHighlightedClass.update({nodeAttributes:{layer:e?e.layer:void 0},fullOverwrite:!1})},Ir.prototype.setActive=function(e,t){if(li(t)){var n=[],i=[];e.toList().forEach(function(r,o){(t[o]?n:i).push(r.getId())}),0!==n.length&&this._graph.getElements(e.isNode,n).addClass(xi),0!==i.length&&this._graph.getElements(e.isNode,i).removeClass(xi)}else e[t?"addClass":"removeClass"](xi)},Ir.prototype.areActive=function(e){return e.hasClass(xi)},Ir.prototype.getSelectedNodes=function(){return this._selectedClass.getNodes()},Ir.prototype.getSelectedEdges=function(){return this._selectedClass.getEdges()},Ir.prototype.getNonSelectedNodes=function(){return this._graph.getNodes().filter(function(e){return!e.hasClass(xi)})},Ir.prototype.getNonSelectedEdges=function(){return this._graph.getEdges().filter(function(e){return!e.hasClass(xi)})},Ir.prototype.clear=function(){this._selectedClass.clearNodes(),this._selectedClass.clearEdges()},Ir);function Ir(e){var t=Rg.call(this)||this;return t._events=e.events,t._settings=e.settings,t._graph=e.graph,t._keyboard=e.keyboard,t._graphics=e.graphics,t._interactions=e.interactions,t._selectionExtremityHighlightedClass=e.classes.createClass({name:yl,isBuiltin:!0,nodeAttributes:zg}),t._selectedClass=e.classes.createClass({name:xi,isBuiltin:!0,nodeAttributes:zg,edgeAttributes:db}),t._settings.register("interactions.selection.enabled",!0),t._settings.register("interactions.selection.multiSelectionKey","ctrl"),t._interactions.onClick({priority:"selection",check:function(n){var i=n.button,r=t._settings.get("interactions.selection.enabled");return"left"===i&&r&&!t._graphics.isAnimating()},handler:function(n){var i=n.target;if(i){var r=t._settings.get("interactions.selection.multiSelectionKey"),o=r&&t._keyboard.isPressed(r);i.isNode?t._selectedClass.clearEdges():t._selectedClass.clearNodes(),o?i.hasClass(xi)?i.removeClass(xi):i.addClass(xi):((i.isNode?t._selectedClass.getNodes():t._selectedClass.getEdges()).filter(function(a){return a!==i}).removeClass(xi),i.hasClass(xi)||i.addClass(xi))}else t._selectedClass.clearNodes(),t._selectedClass.clearEdges()}}),t._events.on(I.BEFORE_REMOVE_EDGES,function(n){return n.edges.setSelected(!1)}),t}var Bg,hb=(St(Rl,Bg=Pe),Rl.prototype._nextTimeIdle=function(e){var t=this,n=new pb(this._dom,this._idIdle,e);return this._delayedCalls.push(n),n.whenDone().then(function(){t._delayedCalls.splice(t._delayedCalls.indexOf(n),1)})},Rl.prototype.debounceIdle=function(e,t){var n=this;function i(){var a=o;r=!1,o=[],e(),a.forEach(function(s){return s()})}void 0===t&&(t=0);var r=!1,o=[];return function(){return new Promise(function(a){o.push(a),r||(r=!0,n._nextTimeIdle(t).then(i))})}},Rl);function Rl(e){var t=Bg.call(this)||this;return t._dom=e.dom,t._events=e.events,t._captor=e.captor,t._delayedCalls=[],t._idIdle=function(){return!t._captor.isAnyButtonPressed()&&!t._dom.isPlayingFrame()},t._events.on({"down up beforeNewFrame newFrame":function(){t._delayedCalls.forEach(function(n){return n.reset()})}}),t}var pb=(zl.prototype._startTimeout=function(){var e=this;this._timeout=this._dom.setTimeout(function(){e._isIdle()?(e._done=!0,e._resolve()):e._startTimeout()},this._delay)},zl.prototype.reset=function(){this._done||(this._dom.clearTimeout(this._timeout),this._startTimeout())},zl.prototype.whenDone=function(){return this._promise},zl);function zl(e,t,n){var i=this;this._timeout=null,this._done=!1,this._dom=e,this._promise=new Promise(function(r){return i._resolve=r}),this._isIdle=t,this._delay=n,this._startTimeout()}var Vg,fb={number:1,duration:1e3,interval:800,startColor:"rgba(0,0,0,0.6)",endColor:"rgba(0,0,0,0.0)",width:50,startRatio:1,endRatio:2},gb={number:1,duration:1e3,interval:800,startColor:"rgba(0,0,0,0.6)",endColor:"rgba(0,0,0,0.0)",width:10,startRatio:1,endRatio:2},_b=(St(Ca,Vg=Pe),Ca.prototype._onElementsAttributeChange=function(e,t){if(t.includes("pulse.enabled")){var n=Dh(this._graph,e,function(o){return o.getAttribute("pulse.enabled")}),i=n.valid,r=n.invalid;this._hasPulses.removeElements(r),this._hasPulses.addElements(i),this._removePulses(r)}},Ca.prototype._removePulses=function(e){for(var t=e.isNode?this._nodePulses:this._edgePulses,n=0;n<e._indexes.length;n++){var i=e._indexes[n],r=t.get(i);if(r){for(var o=0;o<r.length;o++)this._graphics.releaseGraphicsEngineBlockId(r[o].blockId);t.set(i,null)}}},Ca.prototype._refreshElementsPulses=function(e,t){for(var n=e.isNode,i=n?this._nodePulses:this._edgePulses,r=n?this._nodeFlexArrays.pulse.duration:this._edgeFlexArrays.pulse.duration,o=n?"_createNodePulseBlock":"_createEdgePulseBlock",a=n?this._nodeFlexArrays.pulse.interval:this._edgeFlexArrays.pulse.interval,s=n?this._nodeNbPulsesRemaining:this._edgeNbPulsesRemaining,l=0;l<e._indexes.length;l++){var u=e._indexes[l],d=i.get(u);d||i.set(u,d=[]);for(var c=0;c<d.length;c++){var h=d[c],g=h.duration;h.startTime+g<=t&&(this._graphics.releaseGraphicsEngineBlockId(h.blockId),d.splice(c--,1))}var x=d[d.length-1];if(!x||t>=x.startTime+a.get(u)){g=r.get(u);var v=s.get(u);0!==v&&d.push({blockId:this[o](u,t,g),startTime:t,duration:g}),0<v&&s.set(u,v-1)}}},Ca.prototype._createNodePulseBlock=function(e,t,n){var i=this._nodeFlexArrays,r=i.color.get(e),o=i.layer.get(e),a=i.x.get(e),s=i.y.get(e),l=i.radius.get(e),u="scaled"===i.scalingMethod.get(e),d=i.pulse.startRatio.get(e),c=i.pulse.endRatio.get(e),h=i.pulse.width.get(e),p=2*l*d,g=2*l*c,m=xu(o).nodeBody,x=i.pulse.startColor.get(e),v=i.pulse.endColor.get(e),y=this._graphics.allocateGraphicsEngineBlockId(),b=this._block.reset(1,!0,m),S=b.nextAndReset(),w=ro(x,r),M=ro(v,r);return S.end.shape="circle",S.end.pieceId=1,S.end.x1=a,S.end.y1=s,S.end.x2=a,S.end.y2=s,S.end.rectWidthOrSourceRadiusScaled=u?g:0,S.end.rectHeightOrTargetRadiusScaled=u?g:0,S.end.rectWidthOrSourceRadiusFixed=u?0:g,S.end.rectHeightOrTargetRadiusFixed=u?0:g,S.end.strokeWidthFixed=h,S.end.strokeColor=M,S.start.shape="circle",S.start.pieceId=1,S.start.x1=a,S.start.y1=s,S.start.x2=a,S.start.y2=s,S.start.rectWidthOrSourceRadiusScaled=u?p:0,S.start.rectHeightOrTargetRadiusScaled=u?p:0,S.start.rectWidthOrSourceRadiusFixed=u?0:p,S.start.rectHeightOrTargetRadiusFixed=u?0:p,S.start.strokeWidthFixed=h,S.start.strokeColor=w,S.animation.duration=n,S.animation.beginTime=t,this._engine.storeBlock(y,b),y},Ca.prototype._createEdgePulseBlock=function(e,t,n){var i=this._edgeFlexArrays,r=this._nodeFlexArrays,o=i.pulse.startRatio.get(e),a=i.pulse.endRatio.get(e),s=i.pulse.startColor.get(e),l=i.pulse.endColor.get(e),u=xu(i.layer.get(e)).edgeBody,d=this._edgeSourceList.get(e),c=this._edgeTargetList.get(e),h=i.curvature.get(e),p=0!==h,g=this._graphics.allocateGraphicsEngineBlockId(),m=this._block.reset(p?3:1,!0,u),x=m.nextAndReset(),v={isSelfLoop:d===c,curvature:h,sourceX:r.x.get(d),sourceY:r.y.get(d),targetX:r.x.get(c),targetY:r.y.get(c),sourceRadius:r.radius.get(d),targetRadius:r.radius.get(c),isSourceRadiusScaled:"scaled"===r.scalingMethod.get(d),isTargetRadiusScaled:"scaled"===r.scalingMethod.get(c),width:i.width.get(e),isWidthScaled:"scaled"===i.scalingMethod.get(e),strokeWidth:i.pulse.width.get(e)};return Ug(x.start,v),Ug(x.end,v),x.start.strokeColor=s,x.end.strokeColor=l,x.start.thicknessOrFontSizeScaled*=o,x.start.thicknessOrFontSizeFixed*=o,x.end.thicknessOrFontSizeScaled*=a,x.end.thicknessOrFontSizeFixed*=a,x.animation.duration=n,x.animation.beginTime=t,this._engine.storeBlock(g,m),g},Ca.prototype.pulse=function(e,t){var n=e.isNode,i=It({},n?fb:gb,t),r=i.number,s=n?this._nodeNbPulsesRemaining:this._edgeNbPulsesRemaining,l=(r-1)*i.interval+i.duration;delete i.number,i.enabled=!0,e.setAttributes({pulse:i}),s.setMultiple(e._indexes,r),this._dom.setTimeout(function(){e.setAttribute("pulse.enabled",!1),s.setMultiple(e._indexes,-1)},l)},Ca);function Ca(e){var t=e.graphics,n=e.graph,i=e.dom,r=e.events,o=Vg.call(this)||this;return o._onAttributeChange=function(a){var l=a.edges,d=a.edgeAttributes;o._onElementsAttributeChange(a.nodes,a.nodeAttributes),o._onElementsAttributeChange(l,d)},o._refreshPulses=function(){var a=o._hasPulses.getElements(),s=a.nodes,l=a.edges;if(0!==s.size||0!==l.size){var u=o._engine.getCurrentTime();o._refreshElementsPulses(s,u),o._refreshElementsPulses(l,u),o._dom.refresh()}},o._graph=n,o._dom=i,o._graphics=t,r.on(I.UPDATE_ATTRIBUTES,o._onAttributeChange),r.on(I.NEW_FRAME,o._refreshPulses),r.on(I.BEFORE_REMOVE_NODES+" "+I.BEFORE_REMOVE_EDGES,function(a){(a.nodes||a.edges).setAttribute("pulse.enabled",!1)}),r.on(I.CLEAR_GRAPH,function(){return o._hasPulses.clear()}),o._engine=o._graphics.getGraphicsEngine(),o._block=o._engine.createBlock(),o._nodePulses=n.createNodeAttribute({storage:"any"}),o._edgePulses=n.createEdgeAttribute({storage:"any"}),o._nodeNbPulsesRemaining=n.createNodeAttribute({storage:"int16",default:-1}),o._edgeNbPulsesRemaining=n.createEdgeAttribute({storage:"int16",default:-1}),o._nodeFlexArrays=o._graphics.getNodeAttributes(),o._edgeFlexArrays=o._graphics.getEdgeAttributes(),o._edgeSourceList=n.getEdgeAttribute("source"),o._edgeTargetList=n.getEdgeAttribute("target"),o._hasPulses=new hu(o._graph),o}function Ug(e,t){var n=t.sourceX,i=t.sourceY,r=t.targetX,o=t.targetY,a=t.isSourceRadiusScaled,s=t.isTargetRadiusScaled,l=t.targetRadius,u=t.sourceRadius,d=t.isWidthScaled,c=t.width,h=t.strokeWidth,p=t.curvature,g=t.isSelfLoop;e.pieceId=2,e.shape="line",e.x1=n,e.y1=i,e.x2=r,e.y2=o,e.rectWidthOrSourceRadiusScaled=a?u:0,e.rectWidthOrSourceRadiusFixed=a?0:u,e.rectHeightOrTargetRadiusScaled=s?l:0,e.rectHeightOrTargetRadiusFixed=s?0:l,e.thicknessOrFontSizeScaled=d?c:0,e.thicknessOrFontSizeFixed=d?0:c,e.strokeWidthFixed=h,e.curvature=p,e.isSelfLoop=g}var jg,mb={duration:0,easing:"linear",callback:function(){},startAfter:0},vb=(St(Bl,jg=Pe),Bl.prototype.play=function(e,t){var n=un(t,mb),i=n.duration,r=n.easing,o=n.callback,a=n.startAfter,s=null;return i<=0?(e(1),o()):(s={func:e,easing:"function"==typeof r?r:If[r],duration:i,callback:o,startAfter:a,creationDate:z(),done:!1},this._animationList.push(s),this._dom.refresh()),s},Bl.prototype.end=function(e,t){void 0===t&&(t=!0);var n=this._animationList.indexOf(e);-1!==n&&(e.func(1),this._animationList.splice(n,1),e.done=!0,t&&e.callback(!0))},Bl);function Bl(e){var t=jg.call(this)||this;return t._animationList=[],t._update=function(){if(0!==t._animationList.length){for(var n=z(),i=[],r=0;r<t._animationList.length;++r){var o=t._animationList[r],a=(n-o.creationDate)/o.duration,s=o.startAfter,l=o.easing(a);1<=a?(o.func(1),o.done=!0,t._animationList.splice(r,1),--r,i.push(o.callback)):s<=l&&o.func(l=1/(1-s)*(l-s))}for(var u=0;u<i.length;++u)i[u](!1);t._dom.refresh()}},t._dom=e.dom,t._events=e.events,t._animationList=[],t._events.on(I.BEFORE_NEW_FRAME,t._update),t}function Gg(e){return e+(-1===e.indexOf("?")?"?":"&")+"noCache="+Date.now()}var yb={tileLayers:function(e,t,n,i,r){var o=n._getMapPanePos(),a=i.DomUtil.getPosition(e.getContainer());n.removeLayer(e),e.options.crossOrigin="anonymous";var s=[],l=[];return e.on("tileload",function(u){var d=u.tile,c=i.DomUtil.getPosition(d),h=c.x,p=c.y;s.push(d),l.push({x:h-a.x+o.x-r.x,y:p-a.y+o.y-r.y})}),n.addLayer(e),new Promise(function(u){e.once("load",function(){var d=e.getTileSize();s.forEach(function(c,h){var p=l[h];t.drawImage(c,p.x,p.y,d.x,d.y)}),u()})})},imageOverlays:function(e,t,n,i,r){return new Promise(function(o){n.removeLayer(e),e.setUrl(Gg(e.getUrl())),e.options.crossOrigin="anonymous",e.once("load",function(){var a=e.getBounds(),s=n.latLngToContainerPoint(a.getNorthWest()),l=n.latLngToContainerPoint(a.getSouthEast());t.drawImage(e._image,s.x-r.x,s.y-r.y,l.x-s.x,l.y-s.y),o()}),n.addLayer(e)})},vectorLayers:function(e,t,n,i,r,o){return new Promise(function(a){var s=e.options.renderer;n.removeLayer(e),e.options.renderer=o,n.addLayer(e),o._updatePaths();var l=n._getMapPanePos(),u=o._container,d=i.DomUtil.getPosition(u),c=Ln();t.drawImage(o._container,d.x+l.x-r.x,d.y+l.y-r.y,u.width/c,u.height/c),n.removeLayer(e),e.options.renderer=s,n.addLayer(e),a()})},markers:function(e,t,n,i,r){return new Promise(function(o){var a=n.getPixelBounds().min,s=n.project(e.getLatLng(),n.getZoom()),l=/^data\:/.test(e._icon.src),u=l?e._icon.src:Gg(e._icon.src),d=new Image,c=e.options.icon.options,h=c.iconSize,p=s.subtract(a),g=c.iconAnchor;Array.isArray(h)||(h=[h.x,h.y]),Array.isArray(g)||(g=[g.x,g.y]);var m=Math.round(p.x-h[0]+g[0])-r.x,x=Math.round(p.y-g[1])-r.y;function v(){t.drawImage(d,m,x,h[0],h[1]),o()}d.crossOrigin="",d.onload=v,d.src=u,l&&v()})},vectorMap:function(e,t,n,i,r){var o=n._getMapPanePos(),a=e.getMapboxMap(),s=e.getCanvas(),l=e.getSize().round(),u=i.DomUtil.getPosition(e.getContainer()),d=u.x+o.x-r.x,c=u.y+o.y-r.y;return new Promise(function(h){function p(){t.drawImage(s,d,c,l.x,l.y),h()}if(a.loaded())return p();a.once("idle",p)})}};var Zg,qg={"top-left":"left","bottom-left":"left","top-right":"right","bottom-right":"right"},Eb={"top-left":"top","bottom-left":"bottom","top-right":"top","bottom-right":"bottom"},Hg={position:"bottom-right",horizontalMargin:0,verticalMargin:0,className:null},Sb=(St(Vl,Zg=Pe),Vl.prototype.set=function(e,t){var n=It({},Hg,t),i=n.position,r=n.horizontalMargin,o=n.verticalMargin,a=n.className;qg[i]||(i=Hg.position),this.remove();var s=document.createElement("div");return s.innerHTML=e,s.style.position="absolute",Wg(s,i,r,o),s.style.padding="0px 0px 0px 0px",s.style.zIndex="10",a&&s.setAttribute("class",a),this._brand=s,this._dom.setLayer("brand",this._brand),s},Vl.prototype.remove=function(){this._dom.setLayer("brand",null),this._brand=null},Vl);function Vl(e){var t=Zg.call(this)||this;return t._dom=e.dom,t._brand=null,t}function Wg(e,t,n,i){var o=void 0===i?"":i+"px";e.style[qg[t]]=void 0===n?"":n+"px",e.style[Eb[t]]=o}var Yg,Ab=(St(Pt,Yg=Pe),Pt.prototype._onCameraUpdate=function(){var e=this;if(this._enabled&&this._map&&this._map._loaded&&(this._x-this._camera.x||this._y-this._camera.y)){this._updating||(this._updating=!0,this._layer.setLocked(!0),this._map._moveStart(!0,!1));var i=this._fromPointToLatLng(this._camera.x,this._camera.y),r=gd(this._camera.zoom),o=this.L.latLng(i.latitude,i.longitude);this._map._move(o,r,{pinch:!0,round:!1}),clearTimeout(this._updateRequest),this._updateRequest=setTimeout(function(){e._updating=!1,e._layer.setLocked(!1),e._map&&e._map._move(o,r,{pinch:!0})._moveEnd(!0)},this._updateRate)}},Pt.prototype._onNodesDragStart=function(){this._enabled&&(this._setMapDragging(!1),this._nodeDragOffsetX=this._nodeDragOffsetY=0)},Pt.prototype._onNodesDragged=function(e){var t=this,n=e.nodes,i=e.dx,r=e.dy;if(this._enabled){var o=n.map(function(a){var s=a.getAttributes(["x","y"]);return t._fromPointToLatLng(s.x+i-t._nodeDragOffsetX,s.y+r-t._nodeDragOffsetY)});return this._nodeDragOffsetX=i,this._nodeDragOffsetY=r,n.setGeoCoordinates(o)}},Pt.prototype._onDataChange=function(e){var t=this,n=e.filter(function(r){var o=r.property;return o===t.latitudePath||o===t.longitudePath});if(n.length){var i=n.reduce(function(r,o){var a=o.nodes,s=o.newValues;if(!a)return r;var l=a.filter(function(u,d){return null!=s[d]});return r?r.concat(l):l},null);this._refreshOrAddNodes(i)}},Pt.prototype._refreshOrAddNodes=function(e){this._updateNodesCoordinates(e),this._enabled&&(this._filter.refresh(),this._updatePrevNodesCoordinates(e))},Pt.prototype._updatePrevNodesCoordinates=function(e){Hu(this._graph,e,ia,"geo.prevLat"),Hu(this._graph,e,ra,"geo.prevLng")},Pt.prototype._restorePrevNodesCoordinates=function(e){Hu(this._graph,e,"geo.prevLat",ia),Hu(this._graph,e,"geo.prevLng",ra)},Pt.prototype._updateNodesCoordinates=function(e){!function(t,n,i){for(var r=i.longitudePath,o=i.latitudePath,a=i.wrapCoordinates,s=t.getAttributes(!0,[ia,ra]),l=s[0],u=s[1],d=n._indexes,c=n.getId(),h=d.length,p=n.getData(o),g=n.getData(r),m=0;m<h;m++){var x=g[m],v=p[m],y=d[m],b=c[m];null!=v&&null!=x&&(Xh(b,x),Jh(b,v),a&&(x%=180,v=me(+v,-nu,nu)),u.set(y,x),l.set(y,v))}}(this._graph,e,this._settings)},Pt.prototype._createMapTileLayer=function(e,t){return $t(e)?(e.wms?this.L.tileLayer.wms:this.L.tileLayer)(e.url,It({attribution:null==t&&e.url===ys.tiles.url?'Map data &copy; <a target="_blank" href="http://osm.org/copyright">OpenStreetMap contributors</a>':null},e)):e},Pt.prototype._setupTileLayer=function(e,t){var n=this,i=this._createMapTileLayer(e,t);return i.once("load",function(){n._events.fire(I.GEO_LOADED)}),i.addTo(this._map),i},Pt.prototype._onSettingsChanged=function(e,t){var n,i;(e.wrapCoordinates!==t.wrapCoordinates||e.latitudePath!==t.latitudePath||e.longitudePath!==t.longitudePath)&&this._updateNodesCoordinates(this._graph.getNodes("all")),this._enabled&&((n=e).attribution===(i=t).attribution&&n.tiles===i.tiles||!this._map||(this._map.removeLayer(this._tileLayer),this._tileLayer=this._setupTileLayer(t.tiles,t.attribution)),e.sizeRatio!==t.sizeRatio&&this._updateSizes(),e.maxZoomLevel!==t.maxZoomLevel&&this._settingsModule.update({minZoom:1,maxZoom:Math.pow(2,t.maxZoomLevel)}),e.disableNodeDragging!==t.disableNodeDragging&&this._setDragging(!t.disableNodeDragging),e.attributionOptions!==t.attributionOptions&&this._setAttributionOptions(t.attributionOptions,t.attribution))},Pt.prototype._setMapDragging=function(e){this._map&&this._map.dragging[e?"enable":"disable"]()},Pt.prototype._fromLatLngToPoint=function(e,t){return this._map.options.crs.latLngToPoint(this.L.latLng(e,t),1)},Pt.prototype._fromPointToLatLng=function(e,t){var n=this._map.options.crs.pointToLatLng(this.L.point({x:e,y:t}),1);return{latitude:n.lat,longitude:n.lng}},Pt.prototype._updateSizes=function(){this._enabled&&this._projection&&this._projection.updateAll()},Pt.prototype.enable=function(e){return this.setEnabled(!0,e)},Pt.prototype.getMap=function(){if(this._enabled)return this._map},Pt.prototype.getOptions=function(){if(this._enabled)return It({},this._settings,{tiles:It({},this._settings.tiles)})},Pt.prototype.setOptions=function(e){if(this._enabled){!function(n,i){void 0===n&&(n={});var r=n.tileUrlSubdomains,o=n.tileUrlTemplate,a=n.attribution,s=n.attributionOptions,l=n.latitudePath,u=n.longitudePath,d=n.sizeRatio,c=n.tiles;if(null!=o&&"string"!=typeof o)throw new TypeError("Geo mode: tileUrlTemplate must be a URL string");if(null!=r&&"string"!=typeof r)throw new TypeError("Geo mode: tileUrlTemplate must be a string");if(null!=c){if(!($t(c)||c instanceof i.Layer))throw new TypeError("Geo mode: tiles must be a object or L.Layer instance");var h=c;if(null!=h.url&&"string"!=typeof h.url)throw new TypeError("Geo mode: tiles.url must be a string");if(null!=h.subdomains&&"string"!=typeof h.subdomains)throw new TypeError("Geo mode: tiles.subdomains must be a string");if(h.tms&&"boolean"!=typeof h.tms)throw new TypeError("Geo mode: tiles.tms must be a boolean");if(h.wms&&"boolean"!=typeof h.wms)throw new TypeError("Geo mode: tiles.wms must be a boolean")}if(null!=a&&"string"!=typeof a)throw new TypeError("Geo mode: Map attribution must be a string");if(null!=s&&!$t(s))throw new TypeError("Geo mode: attributionOptions must to be a BrandOptions object");if(null!=l&&"string"!=typeof l&&!Array.isArray(l))throw new TypeError("Geo mode: Latitude path must be a valid property path: a string or an array of strings.");if(null!=u&&"string"!=typeof u&&!Array.isArray(u))throw new TypeError("Geo mode: Longitude path must be a valid property path: a string or an array of strings.");if(null!=d&&(!isFinite(d)||d<=0))throw new TypeError("Geo mode: sizeRatio must be a positive number.")}(e,this.L);var t=this._settings;this._settings=It({},ys,e,{tiles:function(n,i){if(void 0===i&&(i={}),void 0===i.tiles||i.tileUrlTemplate||i.tileUrlSubdomains){var r=ys.tiles;return It({},i.tiles||{},ys.tiles,{url:i.tileUrlTemplate||r.url,subdomains:i.tileUrlSubdomains||r.subdomains})}return $t(i.tiles)?It({},n.tiles,i.tiles):i.tiles}(ys,e)}),this._onSettingsChanged(t,this._settings)}},Pt.prototype.disable=function(e){return this.setEnabled(!1,e)},Pt.prototype.isEnabled=function(){return this._enabled},Pt.prototype.toggle=function(e){return this.setEnabled(!this._enabled,e)},Pt.prototype.getContainerCoords=function(e){var t=this;return e.getGeoCoordinates().map(function(n){return t._map.latLngToContainerPoint([n.latitude,n.longitude])})},Pt.prototype.setEnabled=function(e,t){var n=this;if(!Wh())throw new Error("Ogma Geo cannot be used outside a browser");if(!this.L)throw new Error("You are trying to use Geo mode but Leaflet has not been found. Please follow our migration guide: https://bit.ly/2SYkF8A");if(this._transition||e===this._enabled)return Promise.resolve();this._enabled=e,this._transition=!0,this.setOptions(t);var r=this._settings;return e?(this._nodeDraggingSetting=this._settingsModule.get("interactions.drag.enabled"),this._setDragging(!r.disableNodeDragging),this._show().then(function(){n._setDragging(!r.disableNodeDragging),n._setMapDragging(r.disableNodeDragging),n._transition=!1,n._updating=!1,n._events.fire(I.GEO_ENABLED),n._events.fire(I.GEO_READY)})):this._hide().then(function(){n._transition=!1,n._events.fire(I.GEO_DISABLED),n._setDragging(n._nodeDraggingSetting,!0)})},Pt.prototype._setDragging=function(e,t){void 0===t&&(t=!1),this._settingsModule.update({interactions:{drag:{enabled:e,applyResult:t}}})},Pt.prototype._setAttributionOptions=function(e,t){if(this._attribution&&(this._attribution.remove(),this._attribution=null),this._attribution=this.L.control.attribution({prefix:!1}).addTo(this._map),$t(e)){this._attribution.setPrefix(""),e.position=e.position||"bottom-right";var n=e.position.replace("-","");this._attribution.setPosition(n);var i=this._attribution.getContainer();e.className&&this.L.DomUtil.addClass(i,e.className),Wg(i,e.position||"bottom-right",e.horizontalMargin,e.verticalMargin)}void 0!==t&&this._attribution.addAttribution(t)},Pt.prototype._nodeIsVisible=function(e){return t=e,n=this._settings,i=this._hasCustomProjection(),o=n.latitudePath,a=n.wrapCoordinates,s=t.getData(n.longitudePath),l=t.getData(o),null!=s&&null!=l&&(!(!a&&!i)||Math.abs(l)<=nu&&Math.abs(s)<=180);var t,n,i,o,a,s,l},Pt.prototype._updateSettingsForMap=function(){var e=this._graphics.getGraphicsEngine().parseColor(this._settings.backgroundColor);e[3]=0,this._prevSettings=this._settingsModule.update({backgroundColor:ep(e),minZoom:1e-6,interactions:{rotation:{enabled:!1},drag:{enabled:!1},pan:{enabled:!1},zoom:{enabled:!1,onDoubleClick:!1}},mouse:{wheelEnabled:!1}})},Pt.prototype.getGraphPosition=function(e){var t,n=this.L.latLngBounds((t=[[1/0,1/0],[-1/0,-1/0]],e.getGeoCoordinates().reduce(function(i,r){var o=r.latitude,a=r.longitude,s=i[0],l=i[1];return s[0]=Math.min(s[0],o),s[1]=Math.min(s[1],a),l[0]=Math.max(l[0],o),l[1]=Math.max(l[1],a),i},t)));return{center:0<e.size?n.getCenter():this.L.latLng([0,0]),zoom:this._map.getBoundsZoom(n)}},Pt.prototype._initMap=function(){this._updateSettingsForMap(),this._mapContainer=function(t){var n=Bi().createElement("div");n.className="ogma-geo-container",n.style.width=n.style.height="100%";var i=t||Fy;return i.insertBefore(n,i.firstChild),n}(this._dom.getContainer());var e=It({},Ly,{minZoom:this._settings.minZoomLevel,maxZoom:this._settings.maxZoomLevel});this._hasCustomProjection()&&(e.crs=this._settings.crs,e.worldCopyJump=!1,e.maxBoundsViscosity=0),this._map=new this.L.Map(this._mapContainer,e),this._hasCustomProjection()||this._map.setMaxBounds(this.L.latLngBounds([[nu,-180],[-nu,180]])),this._setAttributionOptions(this._settings.attributionOptions,this._settings.attribution),this._setupLayers()},Pt.prototype._show=function(){var e=this;return this._filter=this._filters.addNodeFilter(function(t){return e._nodeIsVisible(t)}),this._filter.whenApplied().then(function(){e._initMap();var t=e._graph.getNodes(),n=e._graph.getEdges(),i=e.getGraphPosition(t),r=i.center,o=i.zoom;e._zoom=o;var a=e._transformToGeo(),s=a.offset;return e._camera.setView(a.newCameraView,{ignoreZoomLimits:!0}).then(function(){return e._updatePrevNodesCoordinates(t),e._map.setView(r,o),e._zoom=o,e._graphics.animate({nodes:t,edges:n},function(){e._projection=e._createFinalPositionLayer()},e._settings.duration)}).then(function(){return s.destroy()})})},Pt.prototype._hasCustomProjection=function(){return null!=this._settings.crs},Pt.prototype._setupLayers=function(){var e=this;this._settings.tiles&&(this._tileLayer=this._setupTileLayer(this._settings.tiles,this._settings.attribution)),this._layer=new this.L.OgmaOverlay({container:this._graphics.getDomElement(),mapContainer:this._mapContainer,onUpdate:function(){return e._onMapUpdate()}}),this._layer.addTo(this._map)},Pt.prototype._onMapUpdate=function(){var e,t=this._map.getCenter(),r=this._fromLatLngToPoint(t.lat,t.lng);return this._x=r.x,this._y=r.y,this._camera.setView({zoom:(e=this._map.getZoom(),Math.pow(2,e-1)),x:r.x,y:r.y},{ignoreZoomLimits:!0})},Pt.prototype._hide=function(){var e=this;if(!this._map)return Promise.resolve();this._settingsModule.update(this._prevSettings),this._map.removeLayer(this._layer);var t=this._dom.getContainer(),n=this._graphics.getDomElement();t&&t.appendChild(n),this._map.getContainer().style.zIndex=0;var i=this._graph.getNodes("all"),r=this._graph.getEdges("all"),o=this._transformToGraph(),a=o.offset;return this._camera.setView(o.newCameraView).then(function(){return Promise.all([A(e._map.getContainer(),1,0,e._settings.duration/2).then(function(){e._map.remove(),e._mapContainer.parentNode.removeChild(e._mapContainer)}),e._graphics.animate({nodes:i,edges:r},function(){return a.destroy()},e._settings.duration)])}).then(function(){return e._map=null,e._filter.delete()})},Pt.prototype._transformToGeo=function(){var e=this,t=function(e,t,n,i){var r=e.filter(function(P){return P.isVisible()}),o=0===r.size,a=r.reduce(function(P,L){var V=L.getGeoCoordinates(),se=i(V.latitude,V.longitude),j=se.y;return P.mapX.push(se.x),P.mapY.push(j),P},{mapX:[],mapY:[]}),s=a.mapX,l=a.mapY,u=r.getAttribute("x"),d=r.getAttribute("y"),c=r.getAttribute("radius"),h=new Cr({xValues:u,yValues:d,scaledSizeValues:c}),p=new Cr({xValues:s,yValues:l});o&&(h.cx=h.cy=0,h.width=h.height=0),isFinite(p.width)&&isFinite(p.height)||(p.cx=p.cy=0,p.width=p.height=0);var g=p.cx-h.cx,m=p.cy-h.cy,x=o?1:Math.max(p.width,p.height)/Math.max(h.width,h.height),v=c.reduce(function(P,L){return P[0]=Math.min(P[0],L*x),P[1]=Math.max(P[1],L*x),P},[1/0,0]),y=v[0],b=v[1];p.pad(b),p.minScaledSize=y,p.maxScaledSize=b;var w=n.computeConfigForBounds(p),M=t.zoom/Math.pow(2,Math.ceil(Math.log2(w.zoom))),N=h.cx+(g+=(h.cx-t.x)*M),D=h.cy+(m+=(h.cy-t.y)*M);return{offsetChanges:{name:"graph-to-geo",nodeAttributes:{radius:function(P){return P.getAttribute("radius")*M},x:function(P){return(P.getAttribute("x")+g-N)*M+N},y:function(P){return(P.getAttribute("y")+m-D)*M+D}},edgeAttributes:{width:function(P){return P.getAttribute("width")*M}}},camera:It({zoom:t.zoom/M,x:(t.x+g-N)*M+N,y:(t.y+m-D)*M+D,angle:0},t.getSize())}}(this._graph.getNodes(),this._camera,this._locate,function(r,o){return e._fromLatLngToPoint(r,o)}),i=t.camera;return{offset:this._addGraphAttributesLayer(t.offsetChanges),newCameraView:i}},Pt.prototype._addGraphAttributesLayer=function(e){return this._graphics.addAttributeLayer(It({priority:6,nodeSelector:function(t){return t.isVisible()},edgeSelector:function(t){return t.isVisible()}},e))},Pt.prototype._transformToGraph=function(){var e=this,t=function(r,o,a,s){var l=r.getAttributes(["x","y","radius"]),u=r.getBoundingBox(),d=0===r.size,c=r.reduce(function(D,P,L){return D[P._index]=L,D},{});e._projection&&(e._projection.destroy(),e._projection=null);var h=r.getAttribute("x"),p=r.getAttribute("y"),g=r.getAttribute("radius"),m=new Cr({xValues:h,yValues:p,scaledSizeValues:g.map(function(D){return 2*D})});d&&(u.reset(),m.reset());var x,v,y=m.cx-u.cx,b=m.cy-u.cy,S=0,w=0,M=a.computeConfigForBounds(m),N=o.zoom/M.zoom;return v=isNaN(u.cx)||isNaN(u.cy)?(u.cx=o.x,u.cy=o.y,x=M.x,M.y):(x=(o.x+(y+=(u.cx-o.x)*N)-(S=u.cx+y))*N+S,(o.y+(b+=(u.cy-o.y)*N)-(w=u.cy+b))*N+w),{offsetChanges:{name:"geo-to-graph",nodeAttributes:{x:function(D){return(l[c[D._index]].x+y-S)*N+S},y:function(D){return(l[c[D._index]].y+b-w)*N+w}}},camera:It({zoom:M.zoom,x,y:v,angle:0},o.getSize())}}(this._graph.getNodes("all"),this._camera,this._locate),i=t.camera;return{offset:this._addGraphAttributesLayer(t.offsetChanges),newCameraView:i}},Pt.prototype.getPointFromLatLng=function(e){var t=e.getGeoCoordinates(),n=t.latitude,i=t.longitude;return null==n?e.getAttributes(["x","y"]):this._fromLatLngToPoint(n,i)},Pt.prototype._createFinalPositionLayer=function(){var e=this;return this._addGraphAttributesLayer({name:"graph-2-geo-animation",nodeAttributes:{scalingMethod:"fixed",radius:function(t){return t.getAttribute("radius")*e._settings.sizeRatio},x:function(t){return e.getPointFromLatLng(t).x},y:function(t){return e.getPointFromLatLng(t).y}},edgeAttributes:{scalingMethod:"fixed",width:function(t){return t.getAttribute("width")*e._settings.sizeRatio}}})},Pt.prototype.destroy=function(){return Promise.resolve()},Pt.prototype.setCenter=function(e,t){return this._enabled?this.setView(e,t,gd(this._camera.getZoom())):Promise.resolve()},Pt.prototype.setZoom=function(e){return this._enabled?(this._zoom=e,this._map.setZoom(e),this._onMapUpdate()):Promise.resolve()},Pt.prototype.setView=function(e,t,n){if(this._enabled)return this._map.setView(this.L.latLng([e,t]),n,{animate:!1}),this._zoom=n,this._onMapUpdate()},Pt.prototype.getView=function(){if(this._enabled){var e=this._map.getCenter();return{zoom:this._zoom,latitude:e.lat,longitude:e.lng}}},Pt.prototype.getCenter=function(){if(this._enabled){var e=this._map.getCenter();return{latitude:e.lat,longitude:e.lng}}},Pt.prototype.getZoom=function(){if(this._enabled)return this._zoom},Pt.prototype.resetCoordinates=function(){if(this._enabled){var e=this._graph.getNodes();this._restorePrevNodesCoordinates(this._graph.getNodes());var t=this._graph.getNodeAttribute(ia).getMultiple(e._indexes),n=this._graph.getNodeAttribute(ra).getMultiple(e._indexes);e.setData(this._settings.latitudePath,t),e.setData(this._settings.longitudePath,n),this._projection.update()}},Pt.prototype.updateCoordinates=function(){eo("The ogma.geo.updateCoordinates() API has been deprecated. The coordinates are updated by default now.")},Pt.prototype.getUnprojectedCoordinates=function(e){eo("The ogma.geo.getUnprojectedCoordinates() API has been deprecated. Original graph coordinates are only available when in graph mode."),this._projection.destroy();var t=e.getPosition();return this._projection=this._createFinalPositionLayer(),t},Object.defineProperty(Pt.prototype,"latitudePath",{get:function(){return this._settings.latitudePath},enumerable:!0,configurable:!0}),Object.defineProperty(Pt.prototype,"longitudePath",{get:function(){return this._settings.longitudePath},enumerable:!0,configurable:!0}),Pt.prototype.exportBackground=function(e){var t=this,n=ci();n.width=e.width,n.height=e.height;var i=n.getContext("2d"),r=this._map.getSize(),o=this.getView(),a=It({zoom:gd(e.zoom)},this._fromPointToLatLng(e.x,e.y)),s={x:(r.x-e.width)/2,y:(r.y-e.height)/2},l=new this.L.Canvas;this._map.addLayer(l);var u=function(e,t,n,i,r,o){var a={vectorMap:[],tileLayers:[],vectorLayers:[],imageOverlays:[],markers:[]};return t.eachLayer(function(s){if(s!==e){var l=(d=s)instanceof(c=i).TileLayer?"tileLayers":d instanceof c.ImageOverlay?"imageOverlays":d instanceof c.Path?"vectorLayers":d instanceof c.Marker?"markers":"MapboxGL"in c&&d instanceof c.MapboxGL?"vectorMap":void 0;if(l in a){var u=yb[l];a[l].push(function(){return u(s,n,t,i,r,o)})}}var d,c}),a}(this._layer,this._map,i,this.L,s,l),d=u.vectorMap,c=u.tileLayers,h=u.vectorLayers,p=u.imageOverlays,g=u.markers,m=this._map.options.zoomSnap;return this.setView(a.latitude,a.longitude,a.zoom).then(function(){return t._map._onResize()}).then(function(){return qi(d.concat(c,p,h,g))}).then(function(){t._map._onResize(),t.setView(o.latitude,o.longitude,o.zoom),t._map.options.zoomSnap=m}).then(function(){return new Promise(function(x){return t.L.Util.requestAnimFrame(x)})}).then(function(){return t._map.removeLayer(l)}).then(function(){return n})},Pt);function Pt(e){var t,n=e.camera,i=e.graph,r=e.settings,o=e.filters,a=e.events,s=e.dom,l=e.graphics,u=e.locate,d=Yg.call(this)||this;return d._enabled=!1,d._zoom=0,d._nodeDraggingSetting=!1,d._transition=!1,d._map=null,d._attribution=null,d._updating=!1,d._updateRate=50,d._x=0,d._y=0,d._graph=i,d._camera=n,d._settingsModule=r,d._filters=o,d._events=a,d._dom=s,d._graphics=l,d._locate=u,d._events.register(["geoEnabled","geoDisabled","geoLoaded","geoReady"]),d.L=null,Wh()&&(d.L=bi("L")||bi("leaflet"),d.L&&function(c){c.TileLayer.prototype.getUrl=function(){return this._url},c.ImageOverlay.prototype.getUrl=function(){return this._url};var h="leaflet-zoom-animated";c.OgmaOverlay||(c.OgmaOverlay=c.Layer.extend({options:{pane:"overlayPane",padding:0,onUpdate:function(){}},initialize:function(p){var g=p.container;c.Util.setOptions(this,p),this._container=g},setLocked:function(p){return this._locked=p,this},onAdd:function(p){this._map=p,this.getPane().appendChild(this._container),this._wgsOrigin=c.latLng([0,0]),this._wgsInitialShift=p.project(this._wgsOrigin,this._initialZoom),c.DomUtil.addClass(this._container,"leaflet-layer"),this._zoomAnimated&&(c.DomUtil.addClass(this._container,h),this._container.style.position="absolute",this._container.style.zIndex=9999),this._initialZoom=(this._map.getMaxZoom()+this._map.getMinZoom())/2,this._mapInitialZoom=this._map.getZoom(),this._updateBounds(),this._update({})},_updateBounds:function(){var p=this.options.padding,g=this._map.getSize(),m=this._map.containerPointToLayerPoint(g.multiplyBy(-p));this._bounds=new c.Bounds(m,m.add(g.multiplyBy(1+2*p))),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()},_update:function(p){var g=this;this._updateBounds(),this._redraw(this._bounds.min,p),this._positionTimer=c.Util.requestAnimFrame(function(){return c.DomUtil.setPosition(g._container,g._bounds.min)})},_redraw:function(p,g){this.options.onUpdate()},_updateTransform:function(p,g){if(!this._locked){var m=this._map.getZoomScale(g,this._zoom),x=this._map.getSize().multiplyBy(.5+this.options.padding),v=this._map.project(this._center,g),y=x.multiplyBy(-m).add(v).subtract(this._map._getNewPixelOrigin(p,g));c.Browser.any3d?c.DomUtil.setTransform(this._container,y,m):c.DomUtil.setPosition(this._container,y)}},_onZoom:function(p){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_onMoveEnd:function(p){this._update(p)},_onAnimZoom:function(p){this._updateTransform(p.center,p.zoom)},bringToFront:function(){c.DomUtil.toFront(this._container)},getEvents:function(){return{zoom:this._onZoom,moveend:this._onMoveEnd,zoomanim:this._onAnimZoom,layeradd:this.bringToFront,zoomend:this.options.onUpdate}},onRemove:function(){c.DomUtil.removeClass(this._container,h);var p=this._container;["transform","webkitTransform","OTransform","MozTransform","msTransform","zIndex","position"].forEach(function(g){return p.style[g]=null}),c.Util.cancelAnimFrame(this._positionTimer),this._container=null}}))}(d.L)),d._graph.createNodeAttribute({name:"geo.prevLat",storage:"float"}),d._graph.createNodeAttribute({name:"geo.prevLng",storage:"float"}),d._graph.createNodeAttribute({name:ia,storage:"float"}),d._graph.createNodeAttribute({name:ra,storage:"float"}),d._settings=It({},ys),d._events.on(((t={addNodes:function(c){return d._refreshOrAddNodes(c.nodes)}})[I.UPDATE_NODE_DATA]=function(c){d._enabled&&d._onDataChange(c.changes)},t.progressMoveNodesByDragging=function(c){return d._onNodesDragged(c)},t.startMoveNodesByDragging=function(){return d._onNodesDragStart()},t.endMoveNodesByDragging=function(){return d._setMapDragging(!0)},t[I.CAMERA_MOVE]=function(){return d._onCameraUpdate()},t[I.VIEW_CHANGED]=function(){return d._onCameraUpdate()},t)),d}function wc(e,t,n,i,r){for(var o=new Array(e.length),a=0;a<t.length;a++){var s=i[t[a]],l=i[n[a]];o[s]=o[s]||[],o[s].push(l),r&&(o[l]=o[l]||[],o[l].push(s))}return o}function wu(e,t){return-1===e[t]?t:wu(e,e[t])}function Xg(e,t,n,i,r,o,a,s){if(i[e]=r,n[e])return!0;if(t[e])return!1;t[e]=1,n[e]=1;var l=o[e];if(l)for(var u=0,d=l;u<d.length;u++){var c=d[u];if(Xg(c,t,n,i,e,o,a,s))return a.push(s[c]),!0}return n[e]=0,!1}function Jg(e,t,n){for(var i=e.length,r=new Uint8Array(i),o=new Uint8Array(i),a=new Int32Array(i),s={},l=0;l<i;l++)s[e[l]]=l;var u=wc(e,t,n,s,!1);for(l=0;l<i;l++){var d=[];if(Xg(l,r,o,a,-1,u,d,e)&&1<d.length){for(var c=d[0],h=1;h<d.length;h++)if(d[h]===c){d.length=h;break}return d.push(c),d.reverse()}}return!1}function Qg(e,t,n,i,r,o,a){t[e]=1,i[e]=n;var s=r[e];if(s)for(var l=0,u=s;l<u.length;l++){var d=u[l];if(t[d]){if(d!==n)return i[d]=e,o.push(a[d]),!0}else if(Qg(d,t,e,i,r,o,a))return o.push(a[d]),!0}return!1}var Kg=(Cc.prototype.getCycles=function(){this.visited=new Uint8Array(this.nodes.length),this.visitedStack=[];for(var e=0;e<this.nodes.length;e++)for(this.backtrack(e,e);0!==this.visitedLength;){var t=this.visitedStack.pop();this.visited[t]&&(this.visited[t]=0,this.visitedLength--)}return this.cycles},Cc.prototype.backtrack=function(e,t){var n=!1;this.stack.push(t),this.visited[t]||(this.visited[t]=1,this.visitedLength++),this.visitedStack.push(t);for(var i=0,r=this.adjacency[t]||[];i<r.length;i++){var o=r[i];if(this.removed[t]=this.removed[t]||{},!this.removed[t][o])if(o<e)this.removed[t][o]=!0;else if(o===e){for(var a=[],s=0,l=!(n=!0);s<this.stack.length;s++){var u=this.stack[s];e===u&&(l=!0),l&&a.push(this.nodes[u])}this.cycles.push(a)}else if(!this.visited[o]){var d=this.backtrack(e,o);n=n||d}}if(n)for(var c=void 0;c=this.visitedStack.pop(),this.visited[c]&&(this.visited[c]=null,this.visitedLength--),c!==t;);return this.stack.pop(),n},Cc);function Cc(e,t,n){this.cycles=[],this.visitedLength=0,this.visitedStack=[],this.stack=[],this.idToIndex={},this.removed={},this.nodes=e,this.visited=new Uint8Array(this.nodes.length);for(var i=0;i<e.length;i++)this.idToIndex[e[i]]=i;this.adjacency=wc(e,t,n,this.idToIndex)}var $g,wb=(St(Ds,$g=Pe),Ds.prototype.shortestPath=function(e){void 0===e&&(e={source:void 0,target:void 0});var n=e.target,i=e.directed,r=void 0!==i&&i,o=e.filter,a=void 0===o?"visible":o,s=e.edgeCostFunction,l=void 0===s?function(){return 1}:s,u=e.heuristicFunction,d=void 0===u?function(){return 0}:u,c=this._graph.getNode(e.source),h=this._graph.getNode(n);if(!c)throw new Error("the source is not a node");if(!h)throw new Error("the target is not a node");var p=c._index,g=h._index,m=null;if(p===g)m={nodes:c.toList(),edges:this._graph.edgeList()};else{var x=this._graph.getNodeMaxIndex()+1,v=new Int32Array(x),y=new Float32Array(x),b=new Float32Array(x),S=new Set,w=new Fp(b);for(y.fill(1/0),b.fill(1/0),v.fill(-1),w.add(p),y[p]=0,b[p]=d(c,h);!w.isEmpty();){var M=w.removeMin();if(M===g){m=this._constructPath(v,p,g);break}S.add(M);var N=this._graph.getAdjacentDirections(M);if(N)for(var D=0;D<N.length;++D){for(var L=this._graph.getEdgeIndexesInDirection(N[D]),V=-1,X=0,J=-1,se=0;se<L.length;++se){var re=L[se],j=this._sourceList.get(re),Y=this._targetList.get(re);if(j!==Y&&!(r&&M!==j||"visible"===a&&this._excludedList.get(re)||"raw"===a&&this._virtualList.get(re))){var he=l(this._edgeList.get(re));(-1===V||he<X)&&(V=re,X=he,J=j===M?Y:j)}}if(-1!==J||S.has(J)){var pe=y[M]+X;if(!w.has(J)||pe<y[J]){var Ae=this._nodeList.get(M);v[J]=V,y[J]=pe,b[J]=pe+d(Ae,h),w.add(J)}}}}}return Promise.resolve(m)},Ds.prototype._constructPath=function(e,t,n){for(var i=[n],r=[],o=n;o!==t;){var a=e[o],s=this._sourceList.get(a),l=this._targetList.get(a);i.push(o=o===s?l:s),r.push(a)}return i.reverse(),r.reverse(),{nodes:this._graph.nodeList(new Uint32Array(i)),edges:this._graph.edgeList(new Uint32Array(r))}},Ds.prototype.detectCycle=function(e,t){var n=t.getSource(),i=t.getTarget(),r=Jg(e._indexes,n._indexes,i._indexes);return r?this._graph.nodeList(new Uint32Array(r)).dedupe():null},Ds.prototype.getAllSimpleCycles=function(e,t){var n=this,i=t.getSource(),r=t.getTarget();return new Kg(e._indexes,i._indexes,r._indexes).getCycles().map(function(o){return n._graph.nodeList(new Uint32Array(o))})},Ds);function Ds(e){var t=e.graph,n=$g.call(this)||this;return n._graph=t,n._nodeList=t.getNodeAttribute("object"),n._edgeList=t.getEdgeAttribute("object"),n._sourceList=t.getEdgeAttribute("source"),n._targetList=t.getEdgeAttribute("target"),n._excludedList=t.getEdgeAttribute("excluded"),n._virtualList=t.getEdgeAttribute("virtual"),n}var e_,Cb=(St(Tc,e_=Pe),Tc.prototype._addAttributeLayer=function(){return this._graphics.addAttributeLayer({name:"curvature",priority:2,edgeDependencies:{parallelEdges:!0},edgeContext:this._context,edgeAttributes:{curvature:function(e,t){var n,i=t.edgesAlwaysCurvy,r=t.directedEdges,o=e.getSource()===e.getTarget(),a=e.getParallelEdges(),s=a.indexOf(e);if(-1===s)return 0;if(o)n=s+1;else{var l=e.getSource(),u=a.size;if(1===u&&!i)return 0;if(r){for(var d=0,c=0;c<s;++c)a.get(c).getSource()===l&&(d+=1);n=d+1}else{var h=l!==a.get(0).getSource();n=u%2!=1||i?(1+(s/2|0))*(s%2==0?1:-1)*(h?-1:1):0===s?0:((s+1)/2|0)*(s%2==0?1:-1)*(h?-1:1)}}return n}}})},Tc);function Tc(e){var t=e_.call(this)||this;return t._context={edgesAlwaysCurvy:!1,directedEdges:!1},t._settings=e.settings,t._graphics=e.graphics,t._attributeLayer=t._addAttributeLayer(),t._settings.register("edgesAlwaysCurvy",!1,function(n){t._context.edgesAlwaysCurvy=n,t._attributeLayer.updateAll()}),t._settings.register("directedEdges",!1,function(n){t._context.directedEdges=n,t._attributeLayer.updateAll()}),t}function Tb(){return{}}function Mb(){}function Ib(){return!1}function kb(){}function Ob(){}function Nb(){}var t_,n_=(St(ns,t_=Rd),ns.prototype.configure=function(e){this._onStart=e.onStart||Ob,this._onEnd=e.onEnd||Nb,this._update=e.update||Mb,this._onUpdate=e.onUpdate||kb,this._createContext=e.context||Tb,this._isRunning=e.isRunning||Ib},ns.prototype.setData=function(e){this._data=e},ns.prototype.getData=function(){return this._data},ns.prototype.onStart=function(){return this.fire("start",{target:this}),this._onStart.call(this),this},ns.prototype.stop=function(){},ns);function ns(e,t,n){var i=t_.call(this)||this;return i._complete=!1,i._data=null,i._dependencies=t,i._dom=n,i.configure(e),i}var i_,Lb=(St(Cu,i_=n_),Cu.prototype.sync=function(e){var t=e.data.isRunning,n=e.data.result,i=this._onUpdate.call(this,n,this._dependencies,t);return this.fire("update",{target:this,isRunning:t}),t?this.send(i):this.stop(n)},Cu.prototype.stop=function(e){return this._complete||(this._onEnd.call(this,e,this._dependencies),this._worker.terminate(),this.fire("stop",{target:this})),this._complete=!0,this},Cu.prototype.send=function(e){return this._worker.postMessage(Cp(e)),this},Cu);function Cu(e,t,n){var i=i_.call(this,e,t,n)||this,r=[function(o){void 0===o&&(o={});for(var a=Object.keys(o),s=[],l=0,u=a.length;l<u;l++){var d=a[l],c=o[d];if("function"!=typeof c)throw new Error('Asynchronous task: dependency "'+d+'" is not found');var h=Fb(c);h?(s.push(o_(c,d)),h!==d&&s.push("var "+d+" = "+h+";")):s.push("var "+d+" = "+o_(c,d)+";")}return s.join("\n")}(e.imports),"","","var __CONTEXT = ("+i._createContext.toString()+")();","var __UPDATE_FUNC = "+i._update.toString()+";","var __IS_RUNNING_FUNC = "+i._isRunning.toString()+";","",'self.addEventListener("message", function (evt) {',"  var result    = __UPDATE_FUNC(evt.data, __CONTEXT);","  var isRunning = __IS_RUNNING_FUNC(__CONTEXT, evt.data);","  self.postMessage({ result: result, isRunning: isRunning });","});"].join("\n");return i._worker=Tp(r),i._worker.addEventListener("message",function(o){i._dom.isDestroyed()||i.sync(o)}),i}var r_=/^function\s*\(/;function o_(e,t){var n=e.toString();return r_.test(n)?"function "+(e.name||t)+" "+n.substring(n.indexOf("(")):n}function Fb(e){var t=e.toString();return e.name?e.name:r_.test(t)?null:t.substring("function ".length,t.indexOf("(")).trim()}var a_,Pb=(St(Tu,a_=n_),Tu.prototype.sync=function(e){var t=this._update(e,this._context),n=this._isRunning(this._context,e),i=this._onUpdate.call(this,t,this._dependencies,n);this.fire("update",{target:this,isRunning:n}),n?this.send(i):this.stop(t)},Tu.prototype.send=function(e){var t=this;return this._complete||this._dom.setTimeout(function(){return t.sync(e)},0),this},Tu.prototype.stop=function(e){return this._complete||(this._onEnd(e,this._dependencies),this._complete=!0),this},Tu);function Tu(e,t,n){var i=a_.call(this,e,t,n)||this;return i._context=i._createContext(),i}var s_,Db=(St(Mc,s_=Pe),Mc.prototype.run=function(e,t,n,i){var s,u,r=n,o=(void 0===(u=(e.configure||function(a){return a})(s=t,i))&&(u=s),u);return new(r?Lb:Pb)(e,i,this._dom).onStart().send(o)},Mc);function Mc(e){var t=e.dom,n=s_.call(this)||this;return n._dom=t,n}var u_,Ul="complete",Ub=(St(jo,u_=Pe),jo.prototype.register=function(e,t){if(e in this._layouts)throw new Error("Layout "+e+" already exists");var n=It({},t,{name:e});this._layouts[e]=n},jo.prototype.getAvailableLayouts=function(){return Object.keys(this._layouts)},jo.prototype.start=function(e,t){var n=this;void 0===t&&(t={});var i=this._layouts[e];return new Promise(function(r){if(!i)throw new Error("layout "+e+" does not exist");n._currentLayout&&n.stop(),t.duration="number"==typeof t.duration?t.duration:500;var o=i.onSync,a=-1/0;t.skipTextDrawing=void 0===t.skipTextDrawing||t.skipTextDrawing;var s=t.locate||false;s&&"boolean"==typeof s&&(s={}),t.locate=s;var l=n._onTaskStart,u=n._onTaskUpdate,d=n._onTaskComplete,c={name:e,update:i.update,isRunning:i.isRunning,configure:i.configure,context:i.context,imports:i.imports,onStart:function(){l(i,t,this)},onUpdate:function(p,g,m){var x=z();m&&x-a<40||(a=x,u(this,e,p,m,o,t))},onEnd:function(p){var g=this;this.once(Ul,function(m){d(p,m,i,t,r,g.getData())})}};n._graphics.forceAttributesComputation(),n._currentLayout=n._tasks.run(c,t,void 0===t.useWebWorker||t.useWebWorker,n._modules)})},jo.prototype._animateCamera=function(e,t,n){if(0===e.indexes.length)return Promise.resolve();var i=this._locate.layoutDataBoundingBox(e),r=this._locate.computeConfigForBounds(i,t);return this._camera.setView(r,{duration:n,easing:t.easing})},jo.prototype.stop=function(){return null!==this._currentLayout&&(this._currentLayout.stop(),this._currentLayout.fire(Ul,null),this._currentLayout=null),Promise.resolve()},jo.prototype.isRunning=function(){return null!==this._currentLayout},jo.prototype._assignNodePositions=function(e,t,n){if(!e||n){var i=e?new Uint32Array(e.indexes):void 0,r=this._graph.nodeList(i);return Promise.resolve(r)}for(var a=e.x,s=e.y,l=this._graph.nodeList(new Uint32Array(e.indexes)),u=Ic(e),d=0;d<u.length;d++)u[d]={x:a[d],y:s[d]};return l.setAttributes(u,t)},jo);function jo(e){var t=u_.call(this)||this;return t._currentLayout=null,t._onTaskUpdate=function(n,i,r,o,a,s){var l=s.duration,u=s.onSync,d=s.onUpdate,c=s.dryRun,h=s.locate;if(u&&t._dom.setTimeout(function(){return u(r,t._modules,o)},l),a){var p=a(r,t._modules,o);t._events.fire(I.LAYOUT_COMPUTED,{type:I.LAYOUT_COMPUTED,name:i,positions:p}),d&&d(r,p,o);var g=t._assignNodePositions(p,l,c);o||(h&&t._animateCamera(p,h,s.duration),g.then(function(){return n.fire(Ul,p)}))}else o||n.fire(Ul,r)},t._onTaskComplete=function(n,i,r,o,a,s){t._currentLayout=null,r.onEnd&&n&&r.onEnd(n,t._modules),o.skipTextDrawing&&t._dom.setTimeout(function(){return t._graphics.showTexts()},50);var l=t._graph.nodeList(new Uint32Array(s.indexes)),u=o.dryRun&&n?i:l_(l),d=l.getId(),c={before:Ic(s),current:Ic(u)};t._events.fire(I.LAYOUT_END,{type:I.LAYOUT_END,name:r.name,positions:c,ids:d}),t._dom.setTimeout(function(){o.onEnd&&o.onEnd(n),a({name:r.name,positions:c,ids:d})})},t._onTaskStart=function(n,i,r){i.skipTextDrawing&&t._graphics.hideTexts();var o=l_(t._graph.getNodes(i.nodes)),a=o.ids;r.setData(o),t._events.fire(I.LAYOUT_START,{type:I.LAYOUT_START,name:n.name,ids:a,task:r})},t._modules=e,t._dom=e.dom,t._events=e.events,t._graph=e.graph,t._graphics=e.graphics,t._tasks=e.tasks,t._locate=e.locate,t._camera=e.camera,t._layouts={},t._events.register([I.LAYOUT_START,I.LAYOUT_END,I.LAYOUT_COMPUTED]),t._currentLayout=null,t._events.on(I.CLEAR_GRAPH,function(){return t.stop()}),t}function Ic(e){for(var t=e.x,n=e.y,i=e.indexes.length,r=new Array(i),o=0;o<i;o++)r[o]={x:t[o],y:n[o]};return r}function l_(e){var t=e.getAttribute("x"),n=e.getAttribute("y");return{ids:e.getId(),indexes:e._indexes,x:t,y:n}}function jl(e){return"number"==typeof e&&isFinite(e)}var jb=(Rs.prototype.onUpdate=function(e){this._onUpdateHandlers.push(e)},Rs.prototype.getPropertyInfo=function(){return this._info},Rs.prototype.getPath=function(){return this._path.slice()},Rs.prototype.destroy=function(){this._module.unwatchPropertyInformation(this._isNode,this._path,this._triggerUpdate,this._filter,this._unwindArrays)},Rs.prototype.kill=function(){return this.destroy()},Rs);function Rs(e,t,n){var i=n.path,r=n.filter,o=n.unwindArrays,a=this;this._module=e,this._isNode=t,this._path=i||[],this._filter=r,this._unwindArrays=o,this._onUpdateHandlers=[],this._triggerUpdate=function(s){for(var l=0;l<a._onUpdateHandlers.length;++l)a._onUpdateHandlers[l](s)},this._info=e.watchPropertyInformation(this._isNode,this._path,this._triggerUpdate,this._filter,this._unwindArrays)}var Gb=(Object.defineProperty(yr.prototype,"path",{get:function(){return this._path},enumerable:!0,configurable:!0}),yr.prototype.onPropertyAdded=function(e){return this._onAddHandlers.push(e),this},yr.prototype.onPropertyRemoved=function(e){return this._onRemoveHandlers.push(e),this},yr.prototype.onPropertyUpdated=function(e){return this._onUpdateHandlers.push(e),this},yr.prototype.getPath=function(){return this._path.slice()},yr.prototype.getProperties=function(){return this._propertyList.slice()},yr.prototype.getPropertyInfo=function(e){var t=this._properties[e];return t?t.info:null},yr.prototype.destroy=function(){var e=this;_t(this._properties,function(n,i){var r=n.handler,o=e._path.concat([i]);e._module.unwatchPropertyInformation(e._isNode,o,r,e._filter,e._unwindArrays)}),this._propertyList=void 0,this._properties=void 0,this._onAddHandlers=void 0,this._onRemoveHandlers=void 0,this._onUpdateHandlers=void 0;var t=this._module._objectPropertyWatchers.indexOf(this);this._module._objectPropertyWatchers.splice(t,1)},yr.prototype.kill=function(){return this.destroy()},yr.prototype.updateSubPropertiesToWatch=function(e,t){if(e===this._isNode)for(var n=t.getData(this._path),i=0;i<n.length;i++){var r=n[i];if(Qr(r))for(var o=Object.keys(r),a=0;a<o.length;a++)this._addSubPropertyToWatch(o[a])}},yr.prototype._addSubPropertyToWatch=function(e){var t=this;if(!this._properties[e]){var n=this._path.concat([e]),i=function(){return t._triggerPropertyUpdate(e)},s=this._module.watchPropertyInformation(this._isNode,n,i,this._filter,this._unwindArrays);this._properties[e]={handler:i,info:s},this._triggerPropertyUpdate(e)}},yr.prototype._triggerPropertyUpdate=function(e){var t=this._properties[e].info,n=this._propertyList.indexOf(e),i=-1!==n,r="undefined"!==t.getType();!i&&r?(this._propertyList.push(e),this._triggerHandlers("_onAddHandlers",e,t),this._triggerHandlers("_onUpdateHandlers",e,t)):i&&!r?(this._propertyList.splice(n,1),this._triggerHandlers("_onUpdateHandlers",e,t),this._triggerHandlers("_onRemoveHandlers",e,t)):i&&r&&this._triggerHandlers("_onUpdateHandlers",e,t)},yr.prototype._triggerHandlers=function(e,t,n){for(var i=this[e],r=0,o=i.length;r<o;r++)i[r](t,n)},yr);function yr(e,t,n){var i=n.path,r=n.filter,o=n.unwindArrays;this._module=e,this._isNode=t,this._path=i,this._filter=r,this._unwindArrays=o,this._propertyList=[],this._properties={},this._onAddHandlers=[],this._onRemoveHandlers=[],this._onUpdateHandlers=[]}var Zb=(Ta.prototype.isNode=function(){return this._watcher.isNode},Ta.prototype.getPath=function(){return this._watcher.property.slice()},Ta.prototype.getBoundaries=function(){var e=this._watcher.boundaries;return e?{min:e.min,max:e.max}:null},Ta.prototype.getValues=function(){return this._watcher.values.keys()},Ta.prototype.getValueCount=function(e){return this._watcher.values.get(e)||0},Ta.prototype.getCount=function(){return this._watcher.total},Ta.prototype.getType=function(){return 0<this._watcher.any?"any":0<this._watcher.numbers?"number":"undefined"},Ta);function Ta(e){this._watcher=e}function d_(e){return"number"==typeof e&&isNaN(e)}var c_=(Go.prototype.set=function(e,t){var n=this._getIndex(e);return-1===n?(this._keys.push(e.slice()),this._values.push(t),!0):(this._values[n]=t,!1)},Go.prototype.get=function(e){var t=this._getIndex(e);return-1===t?void 0:this._values[t]},Go.prototype.has=function(e){return-1!==this._getIndex(e)},Go.prototype.delete=function(e){var t=this._getIndex(e);return-1!==t&&(this._keys.splice(t,1),this._values.splice(t,1),!0)},Go.prototype.keys=function(){return this._keys.map(function(e){return e.slice()})},Go.prototype.values=function(){return this._values.slice()},Go.prototype._getIndex=function(e){for(var t=0;t<this._keys.length;t++){var n=this._keys[t];if(n.length===e.length){for(var i=!0,r=0;r<e.length;r++){var o=n[r],a=e[r];if(!(o===a||d_(o)&&d_(a))){i=!1;break}}if(i)return t}}return-1},Object.defineProperty(Go.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Go);function Go(){this._keys=[],this._values=[]}var qb=(Ma.prototype.clear=function(){return this._arrays=new c_,this._map.clear()},Ma.prototype.delete=function(e){return li(e)?this._arrays.delete(e):this._map.delete(e)},Ma.prototype.get=function(e){return li(e)?this._arrays.get(e):this._map.get(e)},Ma.prototype.set=function(e,t){return li(e)?this._arrays.set(e,t):this._map.set(e,t),this},Ma.prototype.keys=function(){return il(this._map).concat(this._arrays.keys())},Ma.prototype.values=function(){return ws(this._map).concat(this._arrays.values())},Object.defineProperty(Ma.prototype,"size",{get:function(){return this._map.size+this._arrays.size},enumerable:!0,configurable:!0}),Ma);function Ma(){this._map=new Map,this._arrays=new c_}var h_,Hb=(St(Gr,h_=Pe),Gr.prototype.watchNodeObjectProperty=function(e){return this._watchObjectProperty(!0,ql(e))},Gr.prototype.watchEdgeObjectProperty=function(e){return this._watchObjectProperty(!1,ql(e))},Gr.prototype.watchNodeNonObjectProperty=function(e){return this._watchNonObjectProperty(!0,ql(e))},Gr.prototype.watchEdgeNonObjectProperty=function(e){return this._watchNonObjectProperty(!1,ql(e))},Gr.prototype.watchPropertyInformation=function(e,t,n,i,r){var o=this._findWatcher(e,t,i,r)||this._createWatcher(e,t,i,r);return n&&o.onChange.push(n),o.info},Gr.prototype.unwatchPropertyInformation=function(e,t,n,i,r){var o=this._findWatcher(e,t,i,r);if(o){var a=o.onChange,s=a.indexOf(n);if(-1!==s&&(a.splice(s,1),0===a.length)){var l=this._propertyWatchers.indexOf(o);this._propertyWatchers.splice(l,1)}}},Gr.prototype._watchObjectProperty=function(e,t){var n=new Gb(this,e,t);return this._objectPropertyWatchers.push(n),n.updateSubPropertiesToWatch(e,this._graph[e?"getNodes":"getEdges"](t.filter)),n},Gr.prototype._watchNonObjectProperty=function(e,t){return new jb(this,e,t)},Gr.prototype._findWatcher=function(e,t,n,i){for(var r=0;r<this._propertyWatchers.length;++r){var o=this._propertyWatchers[r];if(o.isNode===e&&o.filter===n&&o.unwindArrays===i&&Wb(o.property,t))return o}return null},Gr.prototype._createWatcher=function(e,t,n,i){var r={isNode:e,property:t,numbers:0,any:0,total:0,values:new qb,boundaries:null,onChange:[],filter:n,unwindArrays:i,info:void 0};return r.info=new Zb(r),Mu(r,this._graph[e?"getNodes":"getEdges"](n).getData(t)),this._propertyWatchers.push(r),r},Gr);function Gr(e){var t,n=e.graph,i=e.events,r=h_.call(this)||this;return r._onExcludedStateChange=function(o){for(var a=o.elements,s=!o.value,l=0,u=r._propertyWatchers.length;l<u;l++){var d=r._propertyWatchers[l];d.isNode===a.isNode&&"visible"===d.filter&&(s?Mu(d,a.getData(d.property)):Zl(d,a.getData(d.property)),Gl(d))}},r._onDataChange=function(o){for(var a=o.isNode,s=o.changes,l=0;l<r._propertyWatchers.length;++l){var u=(S=r._propertyWatchers[l]).property,d="all"===S.filter;if(S.isNode===a)for(var c=0;c<s.length;++c){var h=s[c],p=Yb(h.property||[],u);if(p){for(var g=h.nodes||h.edges,m=[],x=[],v=0;v<g.size;++v){var y=g.get(v);(d||y.isVisible())&&(m.push(bn(h.newValues[v],p)),x.push(bn(h.previousValues[v],p)))}m.length&&(Mu(S,m),Zl(S,x),Gl(S))}}}l=0;for(var b=r._objectPropertyWatchers.length;l<b;l++){var S,w=(S=r._objectPropertyWatchers[l]).path,M=function(N){var D=s[N],P=D.property,X=D.nodes||D.edges,J=X.isNode;(!P||P.length<=w.length+1&&w.every(function(se,re){return se===P[re]}))&&S.updateSubPropertiesToWatch(J,X)};for(c=0;c<s.length;++c)M(c)}},r._onElementsAdded=function(o){for(var a=o.nodes||o.edges,s=0;s<r._propertyWatchers.length;++s){var l=r._propertyWatchers[s];if(l.isNode===a.isNode){var u=a.getData(l.property);u.length&&(Mu(l,u),Gl(l))}}for(s=0;s<r._objectPropertyWatchers.length;s++)r._objectPropertyWatchers[s].updateSubPropertiesToWatch(a.isNode,a)},r._onElementsRemoved=function(o){for(var a=o.nodes||o.edges,s=0;s<r._propertyWatchers.length;++s){var l=r._propertyWatchers[s];if(l.isNode===a.isNode&&"all"===l.filter){var d=a.getData(l.property);d.length&&(Zl(l,d),Gl(l))}}},r._onGraphClear=function(){r._propertyWatchers.forEach(function(o){o.numbers=0,o.any=0,o.total=0,o.boundaries=null,o.values.clear()})},r._graph=n,r._propertyWatchers=[],r._objectPropertyWatchers=[],i.on(((t={})[I.EXCLUDED_STATE_CHANGE]=r._onExcludedStateChange,t[I.UPDATE_NODE_DATA+" "+I.UPDATE_EDGE_DATA]=r._onDataChange,t[I.ADD_NODES+" "+I.ADD_EDGES]=r._onElementsAdded,t[I.REMOVE_NODES+" "+I.REMOVE_EDGES]=r._onElementsRemoved,t[I.CLEAR_GRAPH]=r._onGraphClear,t)),r}function p_(e){return null==e?[]:Pr(e)}function Gl(e){for(var t=0;t<e.onChange.length;++t)e.onChange[t](e.info)}function Wb(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}function Yb(e,t){if(e.length>t.length)return null;for(var n=0;n<e.length;++n)if(e[n]!==t[n])return null;return t.slice(n)}function Mu(e,t,n){for(var i=e.values,r=!n&&e.unwindArrays,o=0;o<t.length;++o){var a=t[o];if(n||void 0===a||(e.total+=1),r&&Array.isArray(a))Mu(e,a,!0);else{var s=i.get(a);s?i.set(a,s+1):(i.set(a,1),jl(a)?(e.boundaries?a<e.boundaries.min?e.boundaries.min=a:a>e.boundaries.max&&(e.boundaries.max=a):e.boundaries={min:a,max:a},e.numbers+=1):void 0!==a&&(e.any+=1))}}}function Zl(e,t,n){for(var i=e.values,r=!n&&e.unwindArrays,o=e.boundaries,a=!1,s=0;s<t.length;++s){var l=t[s];if(n||void 0===l||--e.total,r&&Array.isArray(l))a=a||Zl(e,l,!0);else{var u=i.get(l);1<u?i.set(l,u-1):(i.delete(l),jl(l)?(--e.numbers,!o||o.min!==l&&o.max!==l||(a=!0)):void 0!==l&&--e.any)}}return!n&&a&&(e.boundaries=function(d){for(var c=void 0,h=void 0,p=0;p<d.length;++p){var g=d[p];jl(g)&&((void 0===c||g<c)&&(c=g),(void 0===h||h<g)&&(h=g))}return void 0===c?null:{min:c,max:h}}(i.keys())),a}function ql(e){return"object"!=typeof e||null===e||Array.isArray(e)?{path:p_(e),filter:"visible",unwindArrays:!1}:{path:p_(e.path),filter:"all"===e.filter?"all":"visible",unwindArrays:!!e.unwindArrays}}function kc(e,t,n,i){void 0===e&&(e=function(a,s){return a-s}),void 0===t&&(t=[]),void 0===n&&(n={}),void 0===i&&(i=function(a){return a});var r=t.length;function o(a){for(;;){var s=2*a+1,l=1+s,u=a;if(s<r&&e(t[s],t[u])<0&&(u=s),l<r&&e(t[l],t[u])<0&&(u=l),u===a)return a;var d=t[u];t[u]=t[a],t[a]=d,n[i(t[u])]=u,n[i(d)]=a,a=u}}return{get keys(){return n},get size(){return r},heapify:o,pop:function(){if(!(r<=0)){if(1===r)return r--,t[0];var a=t[0];return t[0]=t[r-1],r--,o(0),a}},decreaseKey:function(a,s){for(void 0!==s&&(t[a]=s,n[i(s)]=a);0<a;){var l=a-1>>1;if(!(0<e(t[l],t[a])))break;var u=t[a];t[a]=t[l],t[l]=u,n[i(t[a])]=a,a=n[i(u)]=l}return a},min:function(){return t[0]},remove:function(a){return this.decreaseKey(a,Number.NEGATIVE_INFINITY),this.pop()},push:function(a){var s=++r-1;for(t[s]=a;0<s;){var l=s-1>>1;if(!(0<e(t[l],t[s])))break;var u=t[s];t[s]=t[l],t[l]=u,n[i(t[s])]=s,s=n[i(u)]=l}return s},empty:function(){return r<=0},toArray:function(){return t.slice(0,r)}}}function Hl(e,t,n,i,r,o,a){void 0===i&&(i=e.map(function(L,V){return V+1}));var s=i?i.length:e.length,l=new Float32Array(s),u=new Int32Array(s),d=new Uint32Array(s),c=Number.POSITIVE_INFINITY,h={};if(0===s)return{distances:l,path:null,pathLength:null};if(!r){r={};for(var p=0;p<s;p++)r[i[p]]=p}for(p=0;p<s;p++)l[p]=c,u[p]=-1,d[p]=h[p]=p;var g=kc(function(L,V){return l[L]-l[V]},d,h);for(l[r[t]]=0,g.decreaseKey(h[r[t]]);0!==g.size;){var m=g.pop(),x=l[m],v=e[m];if(x===c)break;p=0;for(var y=v.nodes.length;p<y;p++){var b=v.nodes[p],S=o?1:a?a(i[m],b):v.weights[p],w=r[b];if(void 0!==w){var M=x+S;M<l[w]&&(l[w]=M,u[w]=m,g.decreaseKey(h[w]))}}}var N=null,D=null;if(void 0!==n){var P=r[n];if(l[P]!==c){for(N=[],p=P;-1!==p;p=u[p])N.push(i[p]);N.reverse(),D=l[n]}}return{distances:l,path:N,pathLength:D}}function f_(e,t){var n=e.getPosition(),i=t.getPosition();return yi(n.x,n.y,i.x,i.y)}var g_,Xb={pathLengthFunction:f_,heuristicLengthFunction:f_},Jb={pathLengthFunction:function(){return 1},heuristicLengthFunction:function(){return 0}},Qb=(St(Iu,g_=Pe),Iu.prototype.astar=function(e,t,n){return __(this._graph,e,t,this._cachedObjectList,It({},Xb,n))},Iu.prototype.dijkstra=function(e,t,n){return __(this._graph,e,t,this._cachedObjectList,It({},Jb,n))},Iu.prototype.dijkstraBig=function(e,t,n){var i=this._graph.getNodes(),r=Hl(this._graph.getAdjacencyList({directed:n.directed,weight:1,nodes:i}),this._graph.getNode(e)._index,this._graph.getNode(t)._index,i._indexes,void 0,!1);return r.path&&this._graph.nodeList(new Uint32Array(r.path))},Iu);function Iu(e){var t=e.graph,n=g_.call(this)||this;return n._graph=t,n._cachedObjectList=t.getNodeAttribute("object"),n}function __(e,t,n,i,r){var o=void 0===r?{}:r,a=o.pathLengthFunction,s=o.heuristicLengthFunction,l=o.filter,u=o.directed,d=e.getNode(t)._index,c=e.getNode(n)._index,h=a,p=s,g=u?rr.OUT:rr.BOTH,m=i.get(d),x=i.get(c),v=null;if(d===c)return e.nodeList(new Uint32Array([d]));for(var y=e.getNodeMaxIndex()+1,b=new Sp,S=new Sp,w=new Int32Array(y),M=new Float32Array(y),N=new Float32Array(y),D=0;D<y;++D)w[D]=-1,M[D]=1/0,N[D]=1/0;for(S.add(d),M[d]=0,N[d]=p(m,x);0!==S.length;){var P=S.length,L=S.get(0),V=0,X=N[L];for(D=1;D<P;++D){var J=S.get(D),se=N[J];se<X&&(X=se,L=J,V=D)}if(L===c){v=Kb(w,d,c);break}var re=i.get(L);S.removeByPosition(V),b.add(L);var j=e.node(L).getAdjacentNodes({direction:g,filter:l})._indexes;for(D=0;D<j.length;++D){var Y=j[D],he=i.get(Y);if(!b.has(Y)){var pe=M[L]+h(re,he);!S.add(Y)&&pe>=M[Y]||(w[Y]=L,M[Y]=pe,N[Y]=pe+p(he,x))}}}return v&&e.nodeList(v)}function Kb(e,t,n){for(var i=[n],r=n;r!==t;)i.push(r=e[r]);return i.reverse(),i}var m_,$b=(St(kr,m_=Pe),Object.defineProperty(kr.prototype,"x",{get:function(){return this._position.x||0},enumerable:!0,configurable:!0}),Object.defineProperty(kr.prototype,"y",{get:function(){return this._position.y||0},enumerable:!0,configurable:!0}),kr.prototype._later=function(){return this._dom.afterNextFrame()},kr.prototype.move=function(e){var t=this,n=e.x,i=e.y;return void 0!==n&&void 0!==i?this._dom.afterNextFrame().then(function(){return t._events.fire(I.VIRTUAL_MOVE,{x:n,y:i,dx:n-t.x,dy:i-t.y}),t._later()}):Promise.resolve()},kr.prototype.down=function(e){var t=this,n=void 0===e?{}:e,o=n.button,a=void 0===o?Qt.LEFT:o;return this.move({x:n.x,y:n.y}).then(function(){return t._events.fire(I.VIRTUAL_DOWN,{x:t.x,y:t.y,button:a}),t._events.fire(I.VIRTUAL_MOVE,{x:t.x,y:t.y,dx:0,dy:0,button:a}),t._later()})},kr.prototype.up=function(e){var t=this,n=void 0===e?{}:e,i=n.x,r=n.y,o=n.button,a=void 0===o?Qt.LEFT:o;return this.move({x:i,y:r}).then(function(){return t._events.fire(I.VIRTUAL_UP,{x:i,y:r,button:a}),t._later()})},kr.prototype.click=function(e){var t=this,n=void 0===e?{}:e,i=n.x,r=n.y,o=n.button,a=void 0===o?Qt.LEFT:o;return this.move({x:i,y:r}).then(function(){return t._events.fire(I.VIRTUAL_CLICK,{x:i,y:r,button:a}),t._later()})},kr.prototype.rightClick=function(e){var t=this,n=void 0===e?{}:e,i=n.x,r=n.y,o=n.button,a=void 0===o?Qt.RIGHT:o;return this.move({x:i,y:r}).then(function(){return t._events.fire(I.VIRTUAL_CLICK,{x:i,y:r,button:a}),t._later()})},kr.prototype.doubleClick=function(e){var t=this,n=void 0===e?{}:e,i=n.x,r=n.y,o=n.button,a=void 0===o?Qt.LEFT:o;return this.move({x:i,y:r}).then(function(){return t._events.fire(I.VIRTUAL_DOUBLE_CLICK,{x:i,y:r,button:a}),t._later()})},kr.prototype.drag=function(e,t){var n=this;return this.down(e).then(function(){return n.move(t)}).then(function(){return n.up(t)})},kr.prototype.wheel=function(e){var t=this,n=e.x,i=e.y,r=e.delta;return this.move({x:n,y:i}).then(function(){return t._events.fire(I.VIRTUAL_WHEEL,{x:n,y:i,delta:r}),t._later()})},kr);function kr(e){var t=e.position,n=e.dom,i=e.events,r=m_.call(this)||this;return r._dom=n,r._events=i,r._position=t,r._events.register([I.VIRTUAL_DOWN,I.VIRTUAL_UP,I.VIRTUAL_MOVE,I.VIRTUAL_CLICK,I.VIRTUAL_DOUBLE_CLICK,I.VIRTUAL_WHEEL]),r}function Zr(e,t,n,i,r,o){var a=Ln(),s=o.graphToScreenCoordinates(e),l=o.graphToScreenCoordinates(t);r.beginPath(),r.moveTo(s.x*a,s.y*a),r.lineTo(l.x*a,l.y*a),r.strokeStyle=i,r.lineWidth=n,r.stroke()}function v_(e,t,n,i){for(var r,o,a=0,s=e.length-1;a<s;)r=(a+s)/2|0,o=Math.abs(t[e[r]]-n),Math.abs(t[e[1+r]]-n)<=o?a=1+r:s=r;return i?s:e[s]}function y_(e,t,n,i,r,o,a){for(var s,l,u,d,c,h,p=!1,g=0,m=e.length;!p&&g<m;g++)for(var x=0;!p&&x<m;x++)if(g!==x){var v=e[g],y=e[x];x<g&&(d=y,y=v,v=d);var b=t[v],S=t[y],w=o.get(v),M=o.get(y);b+w<i-r&&i+r<S-M&&Math.abs(Math.abs(b+w-(i-r))-Math.abs(S-M-(i+r)))<=a?(s=v,l=n,u=y,c=[b+w,(h=b+w+Math.abs(S-M-(b+w))/2)-r,h+r,S-M],p=!0):b+w<i-r&&S+M<i-r&&Math.abs(Math.abs(b+w-(S-M))-Math.abs(Math.max(b+w,S+M)-(i-r)))<=a?(s=v,l=y,u=n,c=[b+w,S-M,S+M,(h=S+w+Math.abs(Math.abs(b+w-(S-M)))+r)-r],p=!0):i+r<b-w&&i+r<S-M&&Math.abs(Math.abs(b+w-(S-M))-Math.abs(Math.min(b-w,S-M)-(i+r)))<=a&&(s=n,l=v,u=y,c=[(h=b-w-Math.abs(Math.abs(b+w-(S-M)))-r)+r,b-w,b+w,S-M],p=!0)}return p?{a:s,b:l,c:u,current:n,target:h,points:c}:null}var ei,qr,Oc={tolerance:5,centerSnapDistance:240,sideSnapDistanceFactor:3,guidelineWidth:1,guidelineColor:"#ff0000",preferredDistance:{enabled:!0,ratio:1.13,tolerance:10,lineColor:"#00C3FF",lineWidth:1},neighbours:{enabled:!0,offset:5,tolerance:3,lineColor:"#00C3FF",lineWidth:1}};(qr=ei=ei||{})[qr.NONE=0]="NONE",qr[qr.CENTER=1]="CENTER",qr[qr.LEFT=2]="LEFT",qr[qr.RIGHT=3]="RIGHT",qr[qr.TOP=4]="TOP",qr[qr.BOTTOM=5]="BOTTOM";var x_,e1=(St(bo,x_=Pe),bo.prototype.enable=function(e){var t=this;this._enabled||(this._options=un(e,Oc),this._enabled=!0,this._graphics.addCanvas(this._canvas),this._events.on(I.NODES_DRAG_START,this._onNodeDragStart),this._events.on(I.NODES_DRAG_END,this._onNodeDragEnd),this._settings.update({"interactions.drag.onBeforeDrag":function(n,i,r,o){return t._onBeforeDrag(i,r,o)}}))},bo.prototype.disable=function(){this._enabled&&(this._events.removeListener(this._onNodeDragStart),this._events.removeListener(this._onNodeDragEnd),this._graphics.removeCanvas(this._canvas),this._settings.update({"interactions.drag.onBeforeDrag":null}),this._enabled=!1)},bo.prototype.enabled=function(){return this._enabled},bo.prototype._onBeforeDrag=function(e,t,n){if(this._node){var i=n[0];this._scan(i),this._node.setAttributes(i)}},bo.prototype._cacheViewportData=function(){var e=this._camera,t=e.screenToGraphCoordinates({x:0,y:0}),n=e.screenToGraphCoordinates({x:e.width,y:e.height});this._nodes=this._spatial.getNodesByBoundingBox(t.x,t.y,n.x,n.y);var i=this._node._index,r=Array.from(this._nodes._indexes);r.splice(r.indexOf(i),1);var o=this._graph.getNodeAttribute("radius"),a=this._graph.getNodeAttribute("x"),s=this._graph.getNodeAttribute("y"),l=a.buffer(),u=s.buffer(),d=Xr(r.slice(),a),c=Xr(r.slice(),s),h={},p={};this._gridResolution=this._node.getAttribute("radius");for(var g=this._gridResolution,m=0,x=r.length;m<x;m++){var v=d[m],y=c[m],b=l[v]/g|0,S=u[y]/g|0;h[b]||(h[b]=[]),p[S]||(p[S]=[]),h[b].push(v),p[S].push(y)}this._nodesByX=d,this._nodesByY=c,this._xGrid=h,this._yGrid=p,this._xList=a,this._yList=s,this._X=l,this._Y=u,this._R=o},bo.prototype._scan=function(e){Ga(this._canvas,this._ctx);var t,n,i,r,o,a,s,l,u,d=this._node._index,c=e.x,h=e.y,p=this._r,g=this._options,m=this._xList,x=this._yList,v=this._R,y=this._X,b=this._Y,S=this._camera.zoom,w=Math.min(p,this._options.tolerance/S),M=2*p*g.sideSnapDistanceFactor,N=g.guidelineWidth,D=g.guidelineColor,P=d,L=d,V=!1,X=!1;if(P=v_(this._nodesByX,y,c),L=v_(this._nodesByY,b,h),Math.abs(y[P]-c)>g.centerSnapDistance&&(P=d),Math.abs(b[L]-h)>g.centerSnapDistance&&(L=d),this._xsnap=ei.NONE,P!==d){t=this._vguideline.start,n=this._vguideline.end,i=y[u=P],r=b[u],o=v.get(u),l=Math.abs(c-i);var J=Math.abs(c-p-(i-o)),se=Math.abs(c+p-(i+o));l<Math.max(p,o)&&(r<h?(t.y=r-o,n.y=h+p):(t.y=r+o,n.y=h-p),(re=Math.min(J,l,se))===l?(t.x=n.x=i,n.y=h,t.y=r,this._xsnap=ei.CENTER):Math.abs(h-r)<o+p+M&&(re===J?(t.x=n.x=i-o,this._xsnap=ei.LEFT):(t.x=n.x=i+o,this._xsnap=ei.RIGHT)),re<w&&(V=!0)),this._xsnap!==ei.NONE&&Zr(t,n,N,D,this._ctx,this._camera)}if(this._ysnap=ei.NONE,L!==d){t=this._hguideline.start,n=this._hguideline.end,i=y[u=L],r=b[u],o=v.get(u),l=Math.abs(h-r);var re,j=Math.abs(h-p-(r-o)),Y=Math.abs(h+p-(r+o));l<Math.max(p,o)&&(i<c?(t.x=i-o,n.x=c+p):(t.x=i+o,n.x=c-p),(re=Math.min(j,l,Y))===l?(t.y=n.y=r,n.x=c,t.x=i,this._ysnap=ei.CENTER):Math.abs(c-i)<o+p+M&&(re===j?(t.y=n.y=r-o,this._ysnap=ei.TOP):(t.y=n.y=r+o,this._ysnap=ei.BOTTOM)),re<w&&(X=!0)),this._ysnap!==ei.NONE&&Zr(t,n,N,D,this._ctx,this._camera)}if(g.preferredDistance.enabled){var he=g.preferredDistance.ratio,pe=Math.min(g.preferredDistance.tolerance/S,p),Ae=Math.max(p,o);if(P===d||this._xsnap!==ei.NONE&&V)L!==d&&(this._ysnap===ei.NONE||!X)&&(i=y[u=L],r=b[u],o=v.get(u),(s=Math.abs(h-r)-(p+o)*(1+he))<=pe&&-pe<=s)&&(Ie=h<r?-1:1,n=this._hguideline.end,(t=this._hguideline.start).x=i-Ae,n.x=i+Ae,t.y=n.y=r,Zr(t,n,N,D,this._ctx,this._camera),t.x=c-Ae,n.x=c+Ae,t.y=n.y=r+Ie*(1+he)*(p+o),Zr(t,n,N,D,this._ctx,this._camera),this._ysnap=ei.CENTER,X=!0);else if(i=y[u=P],r=b[u],o=v.get(u),(a=Math.abs(c-i)-(p+o)*(1+he))<=pe&&-pe<=a){var Ie=c<i?-1:1;(t=this._vguideline.start).x=(n=this._vguideline.end).x=i+Ie*(1+he)*(p+o),t.y=r-Ae,n.y=r+Ae,t.x=n.x=i,Zr(t,n,N,D,this._ctx,this._camera),t.y=h-Ae,n.y=h+Ae,t.x=n.x=i+Ie*(1+he)*(p+o),Zr(t,n,N,D,this._ctx,this._camera),this._xsnap=ei.CENTER,V=!0}}if(g.neighbours.enabled){var ot=this._gridResolution,at=c/ot|0,We=h/ot|0,vt=this._xGrid,Tt=this._yGrid,Ge=[],qe=[].concat(Tt[We-1]||Ge,Tt[We]||Ge,Tt[1+We]||Ge),Le=[].concat(vt[at-1]||Ge,vt[at]||Ge,vt[1+at]||Ge),He=void 0;1<qe.length&&(Xr(qe,m),(He=y_(qe,y,d,c,p,v,w))&&(this._drawNeighbourGuidelines(He,e,!1),V=!1)),1<Le.length&&!He&&(Xr(Le,x),(He=y_(Le,b,d,h,p,v,w))&&(this._drawNeighbourGuidelines(He,e,!0),X=!1))}(V||X)&&this._snap(e,!V,!X)},bo.prototype._drawNeighbourGuidelines=function(e,t,n){var i,r,o=e.a,a=e.b,s=e.c,l=e.points,u=e.target,d={x:0,y:0},c={x:0,y:0},p=this._X,g=this._Y,m=this._R.getMultiple([o,a,s]),x=m[0],v=m[1],y=m[2],b=this._options.neighbours,S=b.offset,w=b.lineWidth,M=b.lineColor;r=n?(t.y=u,x=-x,v=-v,y=-y,i=c.x=d.x=Math.min(p[o]+x,p[a]+v,p[s]+y)-S,p):(t.x=u,i=c.y=d.y=Math.max(g[o]+x,g[a]+v,g[s]+y)+S,g);var N=n?"y":"x",D=n?"x":"y";d[N]=l[0],c[N]=l[1],Zr(d,c,w,M,this._ctx,this._camera),d[N]=l[2],c[N]=l[3],Zr(d,c,w,M,this._ctx,this._camera),d[N]=l[0],d[D]=i-S/2,c[N]=l[0],d[D]=r[o]+x,Zr(d,c,w,M,this._ctx,this._camera),d[N]=l[1],d[D]=i-S/2,c[N]=l[1],d[D]=r[a]+v,Zr(d,c,w,M,this._ctx,this._camera),d[N]=l[2],d[D]=i-S/2,c[N]=l[2],d[D]=r[a]+v,Zr(d,c,w,M,this._ctx,this._camera),d[N]=l[3],d[D]=i-S/2,c[N]=l[3],d[D]=r[s]+y,Zr(d,c,w,M,this._ctx,this._camera)},bo.prototype._snap=function(e,t,n){var i,r=this._xsnap,o=this._ysnap;t||r===ei.NONE||(i=this._vguideline.end,e.x=r===ei.LEFT?i.x+this._r:r===ei.RIGHT?i.x-this._r:i.x),n||o===ei.NONE||(i=this._hguideline.end,e.y=o===ei.TOP?i.y+this._r:o===ei.BOTTOM?i.y-this._r:i.y)},bo);function bo(e){var t=e.graph,n=e.graphics,i=e.spatial,r=e.camera,o=e.events,a=e.settings,s=x_.call(this)||this;return s._options=sn(Oc),s._enabled=!1,s._ysnap=ei.NONE,s._xsnap=ei.NONE,s._node=null,s._nodes=null,s._r=0,s._vguideline={start:{x:0,y:0},end:{x:0,y:0}},s._hguideline={start:{x:0,y:0},end:{x:0,y:0}},s._gridResolution=0,s._onNodeDragStart=function(l){var u=l.nodes;1===u.size&&(s._node=u.get(0),s._cacheViewportData(),s._r=s._node.getAttribute("radius"))},s._onNodeDragEnd=function(){s._node=null,Ga(s._canvas,s._ctx)},s._graph=t,s._graphics=n,s._spatial=i,s._settings=a,s._events=o,s._camera=r,s._options=sn(Oc),s._enabled=!1,s._canvas=ci(),s._ctx=s._canvas.getContext("2d"),s}var t1=(Eo.prototype.getId=function(){return this._id},Eo.prototype.whenApplied=function(){return this._whenApplied},Eo.prototype.refresh=function(){return this._module.refreshRule(this._id)},Eo.prototype.getIndex=function(){return this._module.getRuleIndex(this._id)},Eo.prototype.setIndex=function(e){return this._module.setRuleIndex(this._id,e)},Eo.prototype.update=function(e){return this._module.updateRule(this._id,e)},Eo.prototype.getDefinition=function(){return this._module.getRuleDefinition(this._id)},Eo.prototype.destroy=function(){return this._module.destroyRule(this._id)},Eo.prototype.delete=function(){return this.destroy()},Eo);function Eo(e,t,n){var i=this;this._module=e,this._id=t,this._whenApplied=n.then(function(){return i})}var b_,n1=(St(Or,b_=Pe),Or.prototype._get=function(e){for(var t=0;t<this._rules.length;++t){var n=this._rules[t];if(n.id===e)return n.index=t,n}throw new Error("calling a method on a destroyed style rule")},Or.prototype._updatePriorities=function(){for(var e=0;e<this._rules.length;++e)this._rules[e].attributeLayer.update({priority:3+.001*e})},Or.prototype.addRule=function(e){void 0===e&&(e={});var t=this._idCounter++,n=this._graphics.addAttributeLayer(It({name:"rule("+t+")"},Nc(e))),i=this._dom.afterNextFrame(),r=new t1(this,t,i);return this._rules.push({id:t,attributeLayer:n,wrapper:r}),this._updatePriorities(),r},Or.prototype.getRuleIndex=function(e){return this._get(e).index},Or.prototype.setRuleIndex=function(e,t){var n=this._get(e),i=me(t,0,this._rules.length-1);return this._rules.splice(n.index,1),this._rules.splice(i,0,n),this._updatePriorities(),this._dom.afterNextFrame()},Or.prototype.updateRule=function(e,t){var n=this._get(e),i=Object.assign({fullOverwrite:t.fullOverwrite},Nc(t));return n.attributeLayer.update(i),this._dom.afterNextFrame()},Or.prototype.getRuleDefinition=function(e){return Nc(this._get(e).attributeLayer.getDefinition())},Or.prototype.destroyRule=function(e){var t=this._get(e);return t.attributeLayer.destroy(),this._rules.splice(t.index,1),this._dom.afterNextFrame()},Or.prototype.refreshRule=function(e){return this._get(e).attributeLayer.updateAll(),this._dom.afterNextFrame()},Or.prototype.refreshAllRules=function(){for(var e=0;e<this._rules.length;e++)this._rules[e].attributeLayer.updateAll();return this._dom.afterNextFrame()},Or.prototype.getRuleList=function(){return this._rules.map(function(e){return e.wrapper})},Or);function Or(e){var t=b_.call(this)||this;return t._idCounter=1,t._rules=[],t._graphics=e.graphics,t._dom=e.dom,t._rules=[],t}function Nc(e){return{nodeAttributes:e.nodeAttributes,edgeAttributes:e.edgeAttributes,nodeSelector:e.nodeSelector,edgeSelector:e.edgeSelector,nodeDependencies:e.nodeDependencies,edgeDependencies:e.edgeDependencies,nodeOutput:e.nodeOutput,edgeOutput:e.edgeOutput}}var E_,S_={strokeColor:"#00C3FF",fillColor:"rgba(0,195,255,0.1)",strokeWidth:1,cursorStyle:"cell",callback:function(e){return e.nodes.setSelected(!0)},bothExtremities:!1},A_=(St(is,E_=Pe),is.prototype.enable=function(e){if(!this._enabled)return this._enabled=!0,this._captor.setDetectionEnabled(!1),this._options=un(e,S_),this._graphics.addCanvas(this._canvas),$r(this._canvas,this._options.cursorStyle),this._captor.isLeftPressed()&&this._interaction.start(this._captor.getCursorPosition()),this},is.prototype.disable=function(){if(this._enabled)return this._enabled=!1,this._captor.setDetectionEnabled(!0),this._graphics.removeCanvas(this._canvas),this},is.prototype.enabled=function(){return this._enabled},is.prototype.savePoint=function(e,t,n){var i=Ln(),r=this._ctx,o=this._options,a=this._points;if(this._bbox.addPoint(e,t),r.clearRect(0,0,this._canvas.width,this._canvas.height),a.push({x:e,y:t}),n){var s=a[0];r.lineWidth=o.strokeWidth,r.lineJoin="bevel",r.strokeStyle=o.strokeColor,r.fillStyle=o.fillColor,r.beginPath(),r.moveTo(s.x*i,s.y*i);for(var l=1;l<a.length;++l){var u=a[l];r.lineTo(u.x*i,u.y*i)}r.stroke(),o.fillColor&&r.fill()}},is.prototype.filterByExtremities=function(e,t){var n=this._graph.getEdgeAttribute("source"),i=this._graph.getEdgeAttribute("target");return e.filter(function(r){var o=r._index,a=n.get(o),s=i.get(o);return t[a]&&t[s]})},is);function is(e){var t=e.locate,n=e.graphics,i=e.captor,r=e.graph,o=e.spatial,a=e.interactions,s=E_.call(this)||this;return s._enabled=!1,s._points=[],s._bbox=new Cr,s._onStart=function(l){var u=l.x,d=l.y;s._bbox.reset(),s.savePoint(u,d,!1)},s._onStop=function(){var l=s._bbox,p=s._spatial.queryProjected(l.minX,l.minY,l.maxX,l.maxY),m=p.edges,x={},v=p.nodes.filter(function(b){var S=b.isVisible(),w=b.getAttribute("detectable"),M=S&&w&&s._locate.isNodeInPolygon(b,s._points);return x[b._index]=M}),y=m.filter(function(b){var S=b.isVisible(),w=b.getAttribute("detectable");return S&&w&&s._locate.isEdgeInPolygon(b,s._points)});s._options.bothExtremities&&(y=s.filterByExtremities(y,x)),s._ctx.clearRect(0,0,s._canvas.width,s._canvas.height),s._points=[],s.disable(),s._options.callback({nodes:v,edges:y})},s._locate=t,s._graph=r,s._graphics=n,s._captor=i,s._interactions=a,s._spatial=o,s._options=sn(S_),s._canvas=ci(),s._ctx=s._canvas.getContext("2d"),s._interaction=s._interactions.onDrag({priority:"lasso",check:function(){return s._enabled},onStart:s._onStart,onProgress:function(l){return s.savePoint(l.x,l.y,!0)},onStop:s._onStop}),s}var w_,C_={strokeColor:"#00C3FF",fillColor:"rgba(0,195,255,0.1)",strokeWidth:1,cursorStyle:"cell",callback:function(e){var t=e.nodes,n=e.edges;t.size?t.setSelected(!0):n.setSelected(!0)},bothExtremities:!1},i1=(St(rs,w_=A_),rs.prototype.enable=function(e){this._enabled||(this._enabled=!0,this._options=un(e,C_),this._graphics.addCanvas(this._canvas),$r(this._canvas,this._options.cursorStyle),this._captor.isLeftPressed()&&this._interaction.start(this._captor.getCursorPosition()))},rs.prototype.disable=function(){if(this._enabled)return this._enabled=!1,this._graphics.removeCanvas(this._canvas),this},rs.prototype.enabled=function(){return this._enabled},rs.prototype._formatRectangle=function(e){var t=this._start.x,n=this._start.y,i=e.x,r=e.y,o=Math.abs(t-i),a=Math.abs(n-r),s=t<i?t:i,l=n<r?n:r;return this._rectangle.reset().addPoint(s,l).addPoint(s+o,l+a)},rs.prototype._refreshRectangle=function(e){var t=this._formatRectangle(e),n=t.minX,i=t.minY,r=t.width,o=t.height,a=Ln();Ga(this._canvas,this._ctx),this._ctx.strokeRect(n*a,i*a,r*a,o*a),this._options.fillColor&&this._ctx.fillRect(n*a,i*a,r*a,o*a)},rs);function rs(e){var t=w_.call(this,e)||this;return t._options=sn(C_),t._canvas=ci(),t._ctx=t._canvas.getContext("2d"),t._enabled=!1,t._start=null,t._rectangle=new Cr,t._interaction=t._interactions.onDrag({priority:"lasso",disableDetection:!0,check:function(){return t._enabled},onStart:function(n){var i=n.x,r=n.y;t._rectangle.reset(),t._start={x:i,y:r},t._ctx.fillStyle=t._options.fillColor,t._ctx.strokeStyle=t._options.strokeColor,t._ctx.lineWidth=t._options.strokeWidth},onProgress:function(n){return t._refreshRectangle({x:n.x,y:n.y})},onStop:function(){var n=t._captor.getCursorPosition(),i=t._formatRectangle(n),r=t._spatial.queryProjected(i.minX,i.minY,i.maxX,i.maxY),a=r.edges,s={},l=r.nodes.filter(function(d){var c=d.isVisible(),h=d.getAttribute("detectable"),p=c&&h&&t._locate.isNodeInRectangle(d,i);return s[d._index]=p}),u=a.filter(function(d){var c=d.isVisible(),h=d.getAttribute("detectable");return c&&h&&t._locate.isEdgeInRectangle(d,i)});t._options.bothExtremities&&(u=t.filterByExtremities(u,s)),Ga(t._canvas,t._ctx),t.disable(),t._options.callback({nodes:l,edges:u})}}),t}function Wl(e,t,n,i,r,o,a,s){void 0===r&&(r=0),void 0===o&&(o=Math.sin(r)),void 0===a&&(a=Math.cos(r)),void 0===s&&(s=[0,0,0,0]);var l,u,d,c,h,p,g,m,x=n/2,v=i/2,y=e+x,b=t+v;return 0===r?(s[0]=e,s[1]=t,s[2]=e+n,s[3]=t+i):(h=g=l=y+(d=-x)*a-(c=-v)*o,p=m=u=b+d*o+c*a,(l=y+(d=-x)*a-(c=v)*o)<h?h=l:g<l&&(g=l),(u=b+d*o+c*a)<p?p=u:m<u&&(m=u),(l=y+(d=x)*a-(c=v)*o)<h?h=l:g<l&&(g=l),(u=b+d*o+c*a)<p?p=u:m<u&&(m=u),(l=y+(d=x)*a-(c=-v)*o)<h?h=l:g<l&&(g=l),(u=b+d*o+c*a)<p?p=u:m<u&&(m=u),s[0]=h,s[1]=p,s[2]=g,s[3]=m),s}function zs(e,t,n,i,r){void 0===r&&(r=0);var o=n/2,a=i/2,s=e+o,l=t+a;if(0===r)return[{x:e,y:t},{x:e+n,y:t},{x:e+n,y:t+i},{x:e,y:t+i}];var u,d,c=Math.sin(r),h=Math.cos(r);return[{x:s+(u=-o)*h-(d=-a)*c,y:l+u*c+d*h},{x:s+(u=-o)*h-(d=a)*c,y:l+u*c+d*h},{x:s+(u=o)*h-(d=a)*c,y:l+u*c+d*h},{x:s+(u=o)*h-(d=-a)*c,y:l+u*c+d*h}]}function Lc(e,t,n,i){void 0===t&&(t=0),void 0===n&&(n=1),void 0===i&&(i=af.slice());var r=n*Math.sin(t),o=n*Math.cos(t);return i[0]=e[0]+r,i[1]=e[1]+o,i[2]=e[2]+r,i[3]=e[3]+o,i}function T_(e,t,n,i,r,o,a,s){return r<e&&e<a&&o<t&&t<s||r<n&&n<a&&o<i&&i<s}function Zo(e,t,n,i,r,o,a,s){return o<=i&&t<=s&&r<=n&&e<=a}function os(e,t,n,i,r,o){return{minX:e,minY:t,maxX:n,maxY:i,leaf:!0,level:o,parent:r,objects:[],final:!1,children:null}}function M_(e){return[e.minX,e.minY,e.maxX,e.maxY]}function Fc(e,t,n,i,r,o,a,s){var l=(e+n)/2,u=(t+i)/2;return r<=l&&l<=a&&o<=u&&u<=s}function I_(e,t,n,i,r,o,a,s){var l=(o+s)/2,u=(t+i)/2;return(e+n)/2<=(r+a)/2?u<=l?0:1:u<=l?3:2}function u1(e){return e}var k_=(Object.defineProperty(si.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(si.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),si.prototype.clear=function(){return this._root=null,this._objects={},this._size=0,this._idToCell={},this._rootLevel=0,this._maxLevel=this._rootLevel+30,this},si.prototype.insert=function(e,t,n){if(void 0===n&&(n=this._root),t=t||this._getBBox(e),!this._objects[e]){if(this._objects[e]=!0,this._size++,!this._root){var i=Math.max(Math.abs(t[2]-t[0]),Math.abs(t[3]-t[1]));return this._root=os(t[0],t[1],t[0]+i,t[1]+i,null,this._rootLevel),this._root.objects.push(e),e}for(var r,o=[n],a=!1,s=this._nodeCapacity,l=this._idToCell,u=this._maxLevel;r=o.pop();){var d=r.minX,c=r.minY,h=r.maxX,p=r.maxY;Zo(t[0],t[1],t[2],t[3],d,c,h,p)&&(r.leaf?r.objects.length<s||r.final?(r.objects.push(e),l[e]?l[e].push(r):l[e]=[r],a=!0,(r.level>=u||Math.abs(h-d)<=Math.abs(t[2]-t[0])||Math.abs(p-c)<=Math.abs(t[3]-t[1]))&&(r.final=!0)):(this.splitNode(r),o.push(r)):o.push.apply(o,r.children))}if(a)return e;if(!Fc(t[0],t[1],t[2],t[3],(n=this._root).minX,n.minY,n.maxX,n.maxY)){for(var g=this._rootLevel,m=(t[0]+t[2])/2,x=(t[1]+t[3])/2;!Fc(t[0],t[1],t[2],t[3],this._root.minX,this._root.minY,this._root.maxX,this._root.maxY);){var v=d=(n=this._root).minX,y=c=n.minY,b=h=n.maxX,S=p=n.maxY,w=Math.abs(h-d),M=Math.abs(p-c);if(0===M&&0===w)break;var N=Math.max(w,M);m<=d&&(v-=N),x<=c&&(y-=N),d<m&&(b+=N),c<x&&(S+=N);var D=os(v,y,b,S,null,--g);this.splitNode(D),D.children[I_(d,c,h,p,v,y,b,S)]=n,this._root=n.parent=D}for(o=[this._root],this._root.level=this._rootLevel;r=o.shift();)if(!r.leaf)for(var P=0;P<4;P++){var L=r.children[P];L.level=r.level+1,o.push(L)}}return(r=(n=this._root).children[I_(t[0],t[1],t[2],t[3],n.minX,n.minY,n.maxX,n.maxY)]).leaf&&(r.objects.push(e),l[e]?l[e].push(r):l[e]=[r]),e}},si.prototype.removeById=function(e){if(!this._objects[e])return e;this._size--;for(var t=this._idToCell[e],n=0;n<t.length;n++)for(var i=t[n].objects,r=0,o=i.length;r<o;r++)if(i[r]===e){i.splice(r,1);break}return delete this._objects[e],delete this._idToCell[e],e},si.prototype.remove=function(e){for(var t,n,i,r=this._getBBox(e),o=r[0],a=r[1],s=r[2],l=r[3],u=[this._root];t=u.pop();)if(Zo(o,a,s,l,t.minX,t.minY,t.maxX,t.maxY))if(t.leaf){for(var d=t.objects,c=0,h=d.length;c<h;c++)if(d[c]===e){d.splice(c,1),1===h&&(i=i||[]).push(t);break}}else u.push.apply(u,t.children);if(delete this._idToCell[e],delete this._objects[e],this._size--,i)for(;n=i.pop();)for(var p=n.parent,g=!0;p&&g;){if(!p.leaf){for(c=0;c<4;c++)if(!(t=p.children[c]).leaf||0!==t.objects.length){g=!1;break}g&&(p.leaf=!0,p.children=null,p.objects=[])}p=p.parent}return e},si.prototype.splitNode=function(e){var t=e.minX,n=e.minY,i=e.maxX,r=e.maxY,o=(t+i)/2,a=(n+r)/2,s=e.level+1,l=this._idToCell,u=this._maxLevel,d=[os(t,n,o,a,e,s),os(t,a,o,r,e,s),os(o,a,i,r,e,s),os(o,n,i,a,e,s)];if(null!==e.objects)for(var c=e.objects,h=this._getBBox,p=0,g=c.length;p<g;p++){for(var m=c[p],x=h(m),v=l[m],y=0;y<4;y++){var b=d[y],S=b.minX,w=b.minY,M=b.maxX,N=b.maxY;Zo(x[0],x[1],x[2],x[3],S,w,M,N)&&(b.objects.push(m),(b.level>=u||Math.abs(M-S)<=Math.abs(x[2]-x[0])||Math.abs(N-w)<=Math.abs(x[3]-x[1]))&&(b.final=!0),v?v.push(b):v=[b])}v.splice(v.indexOf(e),1)}e.children=d,e.objects=null,e.leaf=!1},si.prototype.point=function(e,t,n){for(var i,r,o,a=[],s=[this._root],l=this._getBBox;i=s.pop();)if(e>=i.minX&&e<=i.maxX&&t>=i.minY&&t<=i.maxY){if(i.leaf){n&&(a=i.objects);for(var u=i.objects,d=0,c=u.length;d<c;d++)e>=(r=l(o=u[d]))[0]&&e<=r[2]&&t>=r[1]&&t<=r[3]&&a.push(o);break}s.push.apply(s,i.children)}return a},si.prototype.neigbours=function(e,t){for(var n,i=[],r=[this._root];n=r.pop();)if(e>=n.minX&&e<=n.maxX&&t>=n.minY&&t<=n.maxY){if(n.leaf){i=n.objects;break}r.push.apply(r,n.children)}return i},si.prototype.query=function(e,t,n,i){for(var r,o,a,s=[],l=[this._root],u=this._getBBox,d={};r=l.pop();)if(Zo(e,t,n,i,r.minX,r.minY,r.maxX,r.maxY))if(r.leaf)for(var c=r.objects,h=0,p=c.length;h<p;h++)d[a=c[h]]||(Zo(e,t,n,i,(o=u(a))[0],o[1],o[2],o[3])&&s.push(a),d[a]=!0);else l.push.apply(l,r.children);return s},si.prototype.getOverlaps=function(){for(var e,t,n,i=[this._root],r=[],o=this._getBBox,a={};e=i.pop();)if(e.leaf){for(var s=e.objects,l=s.length,u=0;u<l;u++)for(var d=0;d<l;d++)if(t=s[u],n=s[d],u!==d&&!a[t+":"+n]&&!a[n+":"+t]){a[t+":"+n]=!0;var c=o(t),h=o(n);Zo(c[0],c[1],c[2],c[3],h[0],h[1],h[2],h[3])&&r.push(t,n)}}else i.push.apply(i,e.children);return r},si.prototype.getAll=function(){return Object.keys(this._objects).map(function(e){return Number(e)})},si.prototype.forEach=function(e,t){for(var n,i=[this._root];n=i.pop();)if(n.leaf)for(var r=0,o=n.objects.length;r<o;r++)e.call(t,n.objects[r]);else i.push.apply(i,n.children);return this},si.prototype.getLeafs=function(){for(var e,t=[this._root],n=[];e=t.pop();)e.leaf?n.push(e):t.push.apply(t,e.children);return n},si.prototype.traverse=function(e,t){for(var n,i=[this._root];n=i.pop();)e.call(t,n,n.objects)||n.leaf||i.push.apply(i,n.children);return this},si.prototype.update=function(e){return this.remove(e),this.insert(e,this._getBBox(e)),this},si.prototype.getNodeBounds=function(e){return M_(e)},si.flatAccessor=function(e,t){return function(n){var i=t*n;return e.slice(i,i+t)}},si.inside=Fc,si.intersects=T_,si.overlaps=Zo,si.getNodeBBox=M_,si);function si(e,t,n,i){void 0===e&&(e=u1),void 0===t&&(t=10),void 0===i&&(i=0),this._nodeCapacity=10,this._root=null,this._objects={},this._size=0,this._rootLevel=0,this._maxLevel=30,this._idToCell={},this._nodeCapacity=t,this._root=null,this._getBBox=e,this._rootLevel=i,this._maxLevel=i+30,this._idToCell={},n&&(this._root=os(n[0],n[1],n[2],n[3],null,i))}var l1={left:-1,right:1,top:0,bottom:0,center:0},d1={left:0,right:0,top:-1,bottom:1,center:0},c1={left:-1,right:0,top:-.5,bottom:-.5,center:-.5},h1={left:-.5,right:-.5,top:-1,bottom:0,center:-.5},ku={x1:0,y1:0,x2:0,y2:0},Pc={x:0,y:0},Bs={x:0,y:0},p1=Math.PI/2;function Dc(e,t,n,i){void 0===i&&(i="#ff0000"),t.strokeStyle=i,t.lineWidth=1,t.beginPath();for(var r=Ln(),o=0,a=e.length;o<a;o++){var s=n.graphToScreenCoordinates(e[o]);0===o?t.moveTo(s.x*r,s.y*r):t.lineTo(s.x*r,s.y*r)}t.closePath(),t.stroke()}var O_,g1=["x","y","radius","width","text.content","text.minVisibleSize","text.size","text.scale","text.scaling","text.padding","text.margin","text.position","text.style"],_1=(St(xr,O_=Pe),xr.prototype.getTextsBoundingBox=function(){this._updateLabels();for(var e=this._rects,t=this._textBBoxes,n=new Cr,i=this._graphics.getNodeAttributes(),r=this._graphics.getEdgeAttributes(),o=i.excluded,a=r.excluded,s=0;s<e.length;s++){var l=5*s,d=t[6*s+4];if(!(1===t[6*s+4]?o.get(d):a.get(d))){var c=Wl(e[l],e[1+l],e[2+l],e[3+l],e[4+l]),g=c[2],m=c[3];n.addPoint(c[0],c[1]).addPoint(g,m)}}return n},xr.prototype.setRate=function(e){var t=this;this._updateDebounced=this._sync.debounceIdle(function(n){return t._updateLabels(n)},e)},xr.prototype.forceEnable=function(){this._forceEnabled=!0},xr.prototype.update=function(){this._update()},xr.prototype.forceUpdate=function(){this._updateLabels()},xr.prototype._enable=function(){this._enabled=!0,this._update()},xr.prototype._disable=function(){this._textBBoxes=[],this._rects=[],this._intersects=[],this._enabled=!1},xr.prototype._onCameraMove=function(){this._update()},xr.prototype._updateLabels=function(e){if(void 0===e&&(e=this._camera.getZoom()),this._settings.get("texts.preventOverlap")){var t=this._graphics.getNodeAttributes(),n=this._graphics.getEdgeAttributes();this._intersects=[],this._textBBoxes=[],this._rects=[];var i=this._textQuad.clear(),r=this._camera.getAngle(),o=this._camera.getProjectedScreenBounds(.25),a="bottomUp"===this._settings.get("texts.removalStrategy"),s={angle:r,zoom:e,screen:o,sin:Math.sin(r),cos:Math.cos(r)},l={remove:{nodes:[],edges:[]},redraw:{nodes:[],edges:[]},rects:this._rects,bboxes:this._textBBoxes,intersects:this._intersects},u=this._spatial.queryRaw(o[0],o[1],o[2],o[3]),d=u.nodes,c=u.edges;d.length+c.length!==0&&(function(h,p,g,m,x,v,y){var b,S,w=y.remove.nodes,M=y.remove.edges,N=y.redraw.nodes,D=g.angle,P=g.zoom,L=g.sin,V=g.cos,X=m.x,J=m.y,se=m.radius,j=m.innerStroke.width,Y=m.outerStroke.width,he=m.scalingMethod,pe=m.text.content,Ae=m.text.position,Ie=m.text.size,ot=m.text.font,at=m.text.style,We=m.text.maxLineLength,vt=m.text.scaling,Tt=m.text.scale,Ge=m.text.minVisibleSize,qe=m.text.padding,Le=m.text.margin,He=m.animationDuration,Je=m.textHidden,et=m.excluded;pr(h,m.layer);for(var Te=[0,0,0,0],Re=[0,0,0,0,0],Ze=y.bboxes,Qe=y.rects,dt=y.intersects,Ht=0,Kt=h.length;Ht<Kt;Ht++){var ln=He.get(b=h[Ht]),an=pe.get(b);if(null!==an&&""!==an&&0===ln){var hn=se.get(b),W=Ge.get(b);if(1!==et.get(b))if(2*hn*P<W)0===Je.get(b)&&w.push(b);else{"fixed"===he.get(b)&&(hn/=P);var Z=X.get(b),B=J.get(b);"number"==typeof an&&(an=an.toString());var K=!vt.get(b),ce=Ae.get(b),_e=qe.get(b),Ee=Tt.get(b),xe=1*(K?Ie.get(b):Ee*hn),Me=at.get(b),Fe=ot.get(b),Be=Rp(an,We.get(b)).lines,De=_e+j.get(b)+Y.get(b)+Le.get(b),ze=l1[ce],ke=d1[ce],Ne=x(an,Fe,Me,xe).width/Be,we=Be*xe*1,Ke=Ne/2/P,ut=we/2/P,Ue=De/P,je=c1[ce]*Ne,Ve=h1[ce]*we;K&&(je/=P,Ve/=P),je=je+ze*Ue+Ke+ze*hn,Ve=Ve+ke*Ue+ut+ke*hn,Wl(Z-Ke,B-ut,Ne/P,we/P,-D,L,-V,Te),Re[0]=Z-Ke,Re[1]=B-ut,Re[2]=Ne/P,Re[3]=we/P,Re[4]=D;var $e=V*je-L*Ve,Ye=L*je+V*Ve;Te[0]+=$e,Te[1]+=Ye,Te[2]+=$e,Te[3]+=Ye,Re[0]+=$e,Re[1]+=Ye;var rt=p.query(Te[0],Te[1],Te[2],Te[3]);if(0!==rt.length){for(var bt=!1,Et=zs(Re[0],Re[1],Re[2],Re[3],Re[4]),Mt=0;Mt<rt.length;Mt++){var yt=rt[Mt],Ct=5*yt,nt=zs(Qe[Ct],Qe[1+Ct],Qe[2+Ct],Qe[3+Ct],Qe[4+Ct]);if(fc(Et,nt)){if(dt.push(Et,nt),bt=!0,!v)break;p.remove(yt),1===Ze[6*yt+4]?w.push(Ze[6*yt+5]):M.push(Ze[6*yt+5])}}if(bt&&!v){w.push(b);continue}}N.push(b),S=Ze.length/6,Ze.push(Te[0],Te[1],Te[2],Te[3],1,b),p.insert(S,Te),Qe.push(Re[0],Re[1],Re[2],Re[3],Re[4])}else w.push(b)}}}(d,i,s,t,this._measureText,a,l),function(h,p,g,m,x,v,y,b){var S,w,M=b.remove.nodes,N=b.remove.edges,D=b.redraw.edges,P=g.angle,L=g.zoom,V=x.x,X=x.y,J=x.radius,se=Math.PI,re=m.source,j=m.target,Y=m.scalingMethod,he=m.width,pe=m.curvature,Ie=m.text.content,ot=m.text.scaling,at=m.text.size,We=m.text.font,vt=m.text.style,Tt=m.text.scale,Ge=m.text.maxLineLength,qe=m.text.margin,Le=m.text.minVisibleSize,He=m.animationDuration;pr(h,m.layer);for(var Je=[0,0,0,0],et=[0,0,0,0,0],Te=b.bboxes,Re=b.rects,Ze=b.intersects,Qe=0,dt=h.length;Qe<dt;Qe++){var Ht=He.get(S=h[Qe]),Kt=Ie.get(S);if(null!==Kt&&""!==Kt&&!Ht){var ln=re.get(S),an=j.get(S),hn=he.get(S),W=pe.get(S);if(!(hn*L<Le.get(S))){"fixed"===Y.get(S)&&(hn/=L);var Z=(V.get(ln)+V.get(an))/2,B=(X.get(ln)+X.get(an))/2;Kt=Kt.toString();var K=!ot.get(S),ce=Tt.get(S),_e=We.get(S),Ee=1*(K?at.get(S):ce*hn),xe=vt.get(S),Me=Ge.get(S),Fe=qe.get(S),Be=V.get(ln),De=X.get(ln),ze=V.get(an),ke=X.get(an),Ne=void 0,we=ln===an;if(we)Ne=se/4-P,Ya(Be,De,W,J.get(ln),0,ku),vu(.5,Be,De,ze,ke,ku.x1,ku.y1,ku.x2,ku.y2,Bs),Z=Bs.x,B=Bs.y,Fe/=-L;else{if(Be===ze&&De===ke)continue;Ne=Ms(Be,De,ze,ke)-P,0!==W&&(Ne=Ms(Be,De,ze,ke)-P,pa(Be,De,ze,ke,W,Pc),Qd(.5,Be,De,ze,ke,Pc.x,Pc.y,Bs),Z=Bs.x,B=Bs.y)}var Ke=Fe+4,ut=Rp(Kt,Me).lines,Ue=ut*Ee,je=1*v(Kt,_e,xe,Ee).width/ut/L/2,Ve=Ue/L/2,$e=Math.abs(Ne)<p1?1:-1,Ye=we?Ue/L+hn/2:$e*(Ke/L+hn/2+Ve);et[0]=Z-je,et[1]=B-Ve,et[2]=Z+je,et[3]=B+Ve,et[4]=Ne+P,Lc(et,-(Ne+P),-Ye,et),et[2]=et[2]-et[0],et[3]=et[3]-et[1],Wl(Z-je,B-Ve,2*je,2*Ve,Ne=se-Ne-P,void 0,void 0,Je),Lc(Je,Ne,Ye,Je);var rt=p.query(Je[0],Je[1],Je[2],Je[3]);if(rt.length){for(var bt=!1,Et=zs(et[0],et[1],et[2],et[3],et[4]),Mt=0;Mt<rt.length;Mt++){var yt=rt[Mt],Ct=5*yt,nt=zs(Re[Ct],Re[1+Ct],Re[2+Ct],Re[3+Ct],Re[4+Ct]);if(fc(Et,nt)){if(bt=!0,Ze.push(Et,nt),!y)break;p.remove(yt),1===Te[6*yt+4]?M.push(Te[6*yt+5]):N.push(Te[6*yt+5])}}if(bt&&!y){N.push(S);continue}}D.push(S),w=Te.length/6,Te.push(Je[0],Je[1],Je[2],Je[3],0,S),p.insert(w,Je),Re.push(et[0],et[1],et[2],et[3],et[4])}}}}(c,i,s,n,t,this._measureText,a,l),this._clearOverlaps(l),this._settings.get("texts.debug")&&this.drawAll())}},xr.prototype._clearOverlaps=function(e){var t=this._graph.nodeList,n=this._graph.edgeList,i=t(new Uint32Array(e.remove.nodes)),r=n(new Uint32Array(e.remove.edges)),o=t(new Uint32Array(e.redraw.nodes)),a=n(new Uint32Array(e.redraw.edges));this._graphics.setTextHidden(i,!0),this._graphics.setTextHidden(r,!0),this._graphics.setTextHidden(o,!1),this._graphics.setTextHidden(a,!1),this._events.fire("labelCollisionsRemoved",e)},xr.prototype._reset=function(){this._graphics.resetTextHidden()},xr.prototype.drawAll=function(){!function(e,t,n,i,r,o){e.clearRect(0,0,t.width,t.height);for(var a=0,s=i.length;a<s;a+=6)l=i.slice(a,a+4),u=e,d=n,void 0===(c="#aaaaaa")&&(c="#22ff00"),Dc([[l[0],l[1]],[l[2],l[1]],[l[2],l[3]],[l[0],l[3]]].map(function(h){return{x:h[0],y:h[1]}}),u,d,c);var l,u,d,c;for(a=0;a<r.length;a+=5)Dc(zs(r[a],r[a+1],r[a+2],r[a+3],r[a+4]),e,n,"green");o.forEach(function(h){return Dc(h,e,n,"red")})}(this._ctx,this._canvas,this._camera,this._textBBoxes,this._rects,this._intersects)},xr);function xr(e,t){var n,i=e.graph,r=e.graphics,o=e.camera,a=e.events,s=e.settings,l=e.sync,u=e.spatial,d=O_.call(this)||this;return d._textBBoxes=[],d._rects=[],d._enabled=!1,d._intersects=[],d._onZoomStart=Pa(function(c){var p=c.endZoom;d._enabled&&p<c.startZoom&&d._updateLabels(p)},80),d._onAttributesChanged=function(c){c.edgeAttributes.concat(c.nodeAttributes).some(function(h){return g1.includes(h)})&&d._update()},d._onItemsAdded=function(c){var h=c.nodes||c.edges;(d._enabled||d._forceEnabled)&&d._settings.get("texts.preventOverlap")&&d._graphics.setTextHidden(h,!0)},d._onToggle=function(c){return c?d._update():d._reset(),d},d._update=function(){(d._enabled||d._forceEnabled)&&d._updateDebounced()},d._toggleDebug=function(c){c?(d._canvas=ci(),d._graphics.addCanvas(d._canvas),d._ctx=d._canvas.getContext("2d"),d._update()):d._canvas&&(d._graphics.removeCanvas(d._canvas),d._canvas=d._ctx=null)},d._measureText=function(c,h,p,g){return d._engine.measureText(c,h,p,g)},d._graph=i,d._graphics=r,d._camera=o,d._events=a,d._settings=s,d._sync=l,d._spatial=u,d._engine=r.getGraphicsEngine(),d._textQuad=new k_(function(c){var h=6*c;return d._textBBoxes.slice(h,6+h)},5),t.forceEnableTextOverlapRemoval&&d.forceEnable(),d._events.register(["labelCollisionsRemoved"]),d.setRate(200),s.register("texts.preventOverlap",!0,d._onToggle),s.register("texts.debug",!1,d._toggleDebug),s.register("texts.removalStrategy","topDown"),d._events.on(((n={})[I.ADD_NODES+" "+I.ADD_EDGES]=d._onItemsAdded,n[I.LAYOUT_END]=function(){return d._updateLabels()},n[I.VIEW_CHANGED]=d._update,n[I.UPDATE_ATTRIBUTES]=d._onAttributesChanged,n[I.SET_CONTAINER]=function(c){if(c.element)return d._enable();d._disable()},n[I.START_ZOOM]=d._onZoomStart,n)),d}function Yl(){}function N_(){return!1}var as,L_,m1=(Pi.prototype._startInteraction=function(e,t){e.onStart(t),e.onStop&&(this._current=e).disableDetection&&this._captor.setDetectionEnabled(!1)},Pi.prototype._stopCurrentInteraction=function(e){this._current.disableDetection&&this._captor.setDetectionEnabled(!0),this._current.onStop(e),this._current=null},Pi.prototype._forceStartInteraction=function(e,t){this._current&&this._stopCurrentInteraction(t),this._startInteraction(e,t)},Pi.prototype._createWrapper=function(e){var t=this;return{start:function(n){return t._forceStartInteraction(e,n)}}},Pi.prototype._addInteraction=function(e,t){var n=this._interactionsByStartEvent[e];return n?n.push(t):(this._interactionsByStartEvent[e]=[t],this._events.on(e,this._onStartInteractionEvent)),this._createWrapper(t)},Pi.prototype._createProgressiveInteraction=function(e,t,n,i){var r={priority:F_(i.priority),check:i.check||N_,onStart:i.onStart||Yl,onProgress:i.onProgress||Yl,onStop:i.onStop||Yl,disableDetection:!!i.disableDetection,progressEventName:t,stopEventName:n};return this._boundProgressEvents[t]||(this._boundProgressEvents[t]=!0,this._events.on(t,this._onProgressInteractionEvent)),this._boundStopEvents[n]||(this._boundStopEvents[n]=!0,this._events.on(n,this._onStopInteractionEvent)),this._addInteraction(e,r)},Pi.prototype._createNonProgressiveInteraction=function(e,t){return this._addInteraction(e,{priority:F_(t.priority),check:t.check||N_,onStart:t.handler||Yl,onProgress:null,onStop:null,disableDetection:!1,progressEventName:null,stopEventName:null})},Pi.prototype.onDrag=function(e){return this._createProgressiveInteraction(I.DRAG_START,I.DRAG_PROGRESS,I.DRAG_END,e)},Pi.prototype.onGesture=function(e){return this._createProgressiveInteraction(I.GESTURE_START,I.GESTURE_PROGRESS,I.GESTURE_END,e)},Pi.prototype.onClick=function(e){return this._createNonProgressiveInteraction(I.CLICK,e)},Pi.prototype.onDoubleClick=function(e){return this._createNonProgressiveInteraction(I.DOUBLE_CLICK,e)},Pi.prototype.onHover=function(e){return this._createNonProgressiveInteraction(I.HOVER,e)},Pi.prototype.onUnhover=function(e){return this._createNonProgressiveInteraction(I.UNHOVER,e)},Pi.prototype.onMouseWheel=function(e){return this._createNonProgressiveInteraction(I.WHEEL,e)},Pi.prototype.onMouseDown=function(e){return this._createNonProgressiveInteraction(I.DOWN,e)},Pi.prototype.onMouseUp=function(e){return this._createNonProgressiveInteraction(I.UP,e)},Pi.prototype.onMouseMove=function(e){return this._createNonProgressiveInteraction(I.MOVE,e)},Pi);function Pi(e){var t=e.captor,n=e.events,i=this;this._current=null,this._onStartInteractionEvent=function(r,o){if(!i._current){for(var a=null,s=0,l=i._interactionsByStartEvent[o];s<l.length;s++){var u=l[s];u.check(r)&&(!a||u.priority>=a.priority)&&(a=u)}a&&i._startInteraction(a,r)}},this._onProgressInteractionEvent=function(r,o){i._current&&i._current.progressEventName===o&&i._current.onProgress(r)},this._onStopInteractionEvent=function(r,o){i._current&&i._current.stopEventName===o&&i._stopCurrentInteraction(null)},this._captor=t,this._events=n,this._interactionsByStartEvent={},this._boundProgressEvents={},this._boundStopEvents={}}function F_(e){return"string"==typeof e?cx.indexOf(e):"number"!=typeof e||isNaN(e)?0:e}(L_=as=as||{}).MOUSE="mouse",L_.TOUCH="touch";var P_,v1=[I.VIRTUAL_UP,I.MOUSE_UP,I.TOUCH_UP].join(" "),y1=[I.VIRTUAL_DOWN,I.MOUSE_DOWN,I.TOUCH_DOWN].join(" "),x1=[I.VIRTUAL_MOVE,I.MOUSE_MOVE,I.TOUCH_MOVE].join(" "),b1=[I.VIRTUAL_CLICK,I.MOUSE_CLICK,I.TOUCH_TAP].join(" "),E1=[I.VIRTUAL_DOUBLE_CLICK,I.MOUSE_DOUBLE_CLICK,I.TOUCH_DOUBLE_TAP].join(" "),S1=[I.VIRTUAL_WHEEL,I.MOUSE_WHEEL].join(" "),A1=(St(On,P_=Pe),On.prototype.triggerUnhover=function(){this._hover=!1,this._hoveredElt=null},On.prototype.triggerDetection=function(){this._detectElement(this._position.x,this._position.y),this._elt&&(this._hoveredElt=this._elt,this._hover=!0)},On.prototype.getElementAt=function(e,t){return this._detectElementAt(e.x,e.y,t)},On.prototype.getPointedElement=function(){return this._hoveredElt},On.prototype.getDraggedElement=function(){return this._draggedElt},On.prototype.isAnyButtonPressed=function(){return this._buttons[Qt.LEFT].isPressed||this._buttons[Qt.RIGHT].isPressed||this._buttons[Qt.MIDDLE].isPressed},On.prototype.isAnyButtonDragging=function(){return this._buttons[Qt.LEFT].isDragging||this._buttons[Qt.RIGHT].isDragging||this._buttons[Qt.MIDDLE].isDragging},On.prototype.isButtonPressed=function(e){return this._buttons[e].isPressed},On.prototype.isLeftPressed=function(){return this.isButtonPressed(Qt.LEFT)},On.prototype.getCursorPosition=function(){return{x:this._position.x,y:this._position.y}},On.prototype.getCursorInformation=function(){return{x:this._position.x,y:this._position.y,target:this._hoveredElt}},On.prototype.setDetectionEnabled=function(e){this._disabledCounter=Math.max(0,this._disabledCounter+(e?-1:1))},On.prototype._resetCurrent=function(e,t){for(var n in this._buttons){var i=this._buttons[n];i.isDragging&&this._events.fire(I.DRAG_END,{domEvent:null,x:e,y:t,button:n,target:this._draggedElt}),i.isPressed=!1,i.isDragging=!1}this._hover&&this._hoveredElt&&this._events.fire(I.UNHOVER,{domEvent:null,x:e,y:t,target:this._hoveredElt}),this._hover=!1,this._hoveredElt=null,this._draggedElt=null},On.prototype._onMove=function(e){var t=e.domEvent,n=e.x,i=e.y,r=e.source,o=this._setPointerPosition(n,i),a=o.dx,s=o.dy;for(var l in this._events.fire(I.MOVE,{domEvent:t,x:n,y:i,dx:a,dy:s,source:r}),this._buttons){var u=this._buttons[l];if(u.isPressed)if(u.isDragging){var d=this._getStoredDXY();this._events.fire(I.DRAG_PROGRESS,{domEvent:t,x:n,y:i,dx:a+=d.dx,dy:s+=d.dy,button:l,source:r,target:this._draggedElt})}else u.isDragging=!0,this._hoveredElt&&this._hover&&(this._events.fire(I.UNHOVER,{domEvent:t,x:n,y:i,source:r,target:this._hoveredElt}),this._hover=!1),this._draggedElt||(this._draggedElt=this._hoveredElt),this._storeDXY(a,s),this._events.fire(I.DRAG_START,{domEvent:t,x:n,y:i,button:l,source:r,target:this._draggedElt})}t&&!this._graphics.getDomElement().contains(t.target)||this._detectElement(n,i),this._elt!==this._hoveredElt&&(this._hoveredElt&&this._hover&&(this._hover=!0,this._events.fire(I.UNHOVER,{domEvent:t,x:n,y:i,source:r,target:this._hoveredElt})),this._hoveredElt=this._elt,this._elt&&(this._hover=!0,this._events.fire(I.HOVER,{domEvent:t,x:n,y:i,source:r,target:this._hoveredElt})))},On.prototype._onDocumentMove=function(e){var t=e.domEvent,n=e.x,i=e.y,r=e.source;for(var o in this._buttons)if(this._buttons[o].isDragging){var a=this._setPointerPosition(n,i);this._events.fire(I.DRAG_PROGRESS,{domEvent:t,x:n,y:i,dx:a.dx,dy:a.dy,button:o,source:r,target:this._draggedElt})}},On.prototype._onDocumentUp=function(e){var o=e.button;if(this._buttons[o].isDragging){this._events.fire(I.DRAG_END,{domEvent:e.domEvent,x:e.x,y:e.y,button:o,source:e.source,target:this._draggedElt});var a=this._buttons[o];a.isDragging=!1,a.isPressed=!1,this.isAnyButtonDragging()||(this._draggedElt=null)}},On.prototype._onDown=function(e){var t=e.domEvent,n=e.x,i=e.y,r=e.button,o=e.source;this._detectElement(n,i),this._elt!==this._hoveredElt&&this._resetCurrent(n,i);var a=this._buttons[r];this._hoveredElt=this._elt,a.isPressed=!0,this._events.fire(I.DOWN,{domEvent:t,x:n,y:i,button:r,source:o,target:this._hoveredElt})},On.prototype._onDoubleClick=function(e){var t=e.domEvent,n=e.x,i=e.y,r=e.button,o=e.source;R_(t,"doubleclick")||this._events.fire(I.DOUBLE_CLICK,{domEvent:t,x:n,y:i,button:r,source:o,target:this._hoveredElt})},On.prototype._onUp=function(e){var t=e.domEvent,n=e.x,i=e.y,r=e.button,o=e.source,a=this._buttons[r];a.isPressed&&(a.isDragging&&(this._events.fire(I.DRAG_END,{domEvent:t,x:n,y:i,button:r,source:o,target:this._draggedElt}),a.isDragging=!1,this.isAnyButtonDragging()||(this._draggedElt=null)),a.isPressed=!1,this._detectElement(n,i),this._events.fire(I.UP,{domEvent:t,x:n,y:i,button:r,source:o,target:this._elt}),this.isAnyButtonPressed()||this._hover||o===as.TOUCH||(this._hoveredElt=this._elt,this._hoveredElt&&(this._events.fire(I.HOVER,{domEvent:t,x:n,y:i,source:o,target:this._hoveredElt}),this._hover=!0)))},On.prototype._onClick=function(e){var t=e.domEvent,n=e.x,i=e.y,r=e.button,o=e.source;R_(t,"click")||this._events.fire(I.CLICK,{domEvent:t,x:n,y:i,button:r,source:o,target:this._hoveredElt})},On.prototype._onWheel=function(e){var t=e.domEvent,n=e.x,i=e.y,r=e.delta,o=e.source;this._position.x=n,this._position.y=i,this._events.fire(I.WHEEL,{domEvent:t,x:n,y:i,delta:r,source:o,target:this._hoveredElt})},On.prototype._storeDXY=function(e,t){this._accDx=e,this._accDy=t},On.prototype._getStoredDXY=function(){var e=this._accDx,t=this._accDy;return this._accDx=0,this._accDy=0,{dx:e,dy:t}},On.prototype._setPointerPosition=function(e,t){var n=e-this._prevX,i=t-this._prevY;return this._position.x=e,this._position.y=t,this._prevX=e,this._prevY=t,this._accDx=0,this._accDy=0,{dx:n,dy:i}},On.prototype._detectElement=function(e,t,n){this._elt=this._detectElementAt(e,t,n)},On.prototype._detectElementAt=function(e,t,n){if(0!==this._disabledCounter)return null;var i,r,o=this._settings,a=o.get("detect.enableSpatialIndex"),s=o.get("detect.nodeErrorMargin"),l=o.get("detect.edgeErrorMargin"),u=o.get("detect.nodes"),d=o.get("detect.edges"),c=null;if(!n&&a&&(u||d)){var h=o.get("detect.spatialIndexMarginRatio"),p=Math.max(s*h,l*h),g=this._spatial.queryRawProjected(e-p,t-p,e+p,t+p);i=g.nodes,r=g.edges}return u&&(c=this._graphics.detectNode({x:e,y:t,indexes:i,margin:s,texts:o.get("detect.nodeTexts")})),!c&&d&&(c=this._graphics.detectEdge({x:e,y:t,indexes:r,margin:l,texts:o.get("detect.edgeTexts")})),c},On);function On(e){var t,n,i=e.dom,r=e.events,o=e.graphics,a=e.spatial,s=e.settings,l=e.position,u=P_.call(this)||this;return u._elt=null,u._hoveredElt=null,u._draggedElt=null,u._hover=!1,u._disabledCounter=0,u._accDx=0,u._accDy=0,u._timeout=null,u._prevX=0,u._prevY=0,u._buttons=((t={})[Qt.LEFT]={isPressed:!1,isDragging:!1},t[Qt.MIDDLE]={isPressed:!1,isDragging:!1},t[Qt.RIGHT]={isPressed:!1,isDragging:!1},t),u._onGraphChanged=function(){u._resetCurrent(u._position.x,u._position.y),u._timeout||(u._timeout=u._dom.setTimeout(function(){u._onMove({x:u._position.x,y:u._position.y,source:null,domEvent:null}),u._timeout=null},0))},u._dom=i,u._graphics=o,u._events=r,u._settings=s,u._spatial=a,u._position=l,r.register([I.MOVE,I.DOWN,I.UP,I.CLICK,I.DOUBLE_CLICK,I.HOVER,I.UNHOVER,I.WHEEL,I.DRAG_START,I.DRAG_PROGRESS,I.DRAG_END,I.GESTURE_START,I.GESTURE_PROGRESS,I.GESTURE_END]),s.register("detect.nodes",!0).register("detect.edges",!0).register("detect.nodeTexts",!0).register("detect.edgeTexts",!0).register("detect.nodeErrorMargin",5).register("detect.edgeErrorMargin",7).register("detect.enableSpatialIndex",!0).register("detect.spatialIndexMarginRatio",3),r.on(((n={})[[I.REMOVE_NODES,I.REMOVE_EDGES,I.CLEAR_GRAPH].join(" ")]=u._onGraphChanged,n[x1]=function(d,c){u._onMove({domEvent:d.domEvent,x:d.x,y:d.y,source:ss(c)})},n[y1]=function(d,c){var m=d.button;u._onDown({domEvent:d.domEvent,x:d.x,y:d.y,button:void 0===m?Qt.LEFT:m,source:ss(c)})},n[v1]=function(d,c){var m=d.button;u._onUp({domEvent:d.domEvent,x:d.x,y:d.y,button:void 0===m?Qt.LEFT:m,source:ss(c)})},n[b1]=function(d,c){var m=d.button;u._onClick({domEvent:d.domEvent,x:d.x,y:d.y,button:void 0===m?Qt.LEFT:m,source:ss(c)})},n[E1]=function(d,c){var m=d.button;u._onDoubleClick({domEvent:d.domEvent,x:d.x,y:d.y,button:void 0===m?Qt.LEFT:m,source:ss(c)})},n[S1]=function(d){u._onWheel({domEvent:d.domEvent,x:d.x,y:d.y,delta:d.delta,source:as.MOUSE})},n.touchStartGesture=function(d){return r.fire(I.GESTURE_START,d)},n.touchProgressGesture=function(d){return r.fire(I.GESTURE_PROGRESS,d)},n.touchEndGesture=function(d){return r.fire(I.GESTURE_END,d)},n.documentMouseMove=function(d,c){u._onDocumentMove({domEvent:d.domEvent,x:d.x,y:d.y,source:ss(c)})},n.documentMouseUp=function(d,c){var m=d.button,x=void 0===m?Qt.LEFT:m;u._onDocumentUp({domEvent:d.domEvent,x:d.x,y:d.y,source:ss(c),button:x})},n)),u}function ss(e){return 0===e.indexOf(as.TOUCH)?as.TOUCH:as.MOUSE}var Rc=!1,D_={down:{trigger:"pointerdown",duplicate:"mousedown"},click:{trigger:"pointerdown",duplicate:"mouseup"},doubleclick:{trigger:"pointerdown",duplicate:"mouseup"}};function R_(e,t){if(e)return e.type===D_[t].trigger&&(Rc=!0),e.type===D_[t].duplicate&&Rc?!(Rc=!1):void 0}var z_,So,Xl,w1=(St(B_,z_=Pe),B_);function B_(e){var t=e.graphics,n=e.camera,i=e.selection,r=e.events,o=e.captor,a=e.individualAttributes,s=e.interactions,l=e.classes,u=e.settings,d=z_.call(this)||this;return d._dragged=null,d._start=null,d._end=null,d._startDrag=null,d._shouldDrag=function(c){var h=c.target,p=c.button===Qt.LEFT,g=d._settings.get("interactions.drag.enabled"),m=null!==h&&h.isNode&&!0===h.getAttribute("draggable");return p&&g&&m},d._onDragStart=function(c){var h=c.x,p=c.y,g=c.target;d._dragged=g.isSelected()?d._selection.getSelectedNodes().filter(function(m){return m.getAttribute("draggable")}):g.toList(),d._start=d._dragged.getPosition(),d._end=sn(d._start),d._onBeforeDrag=d._settings.get("interactions.drag.onBeforeDrag"),d._startDrag=d._camera.screenToGraphCoordinates({x:h,y:p}),d._dragged.addClass(xl),d._events.fire(I.NODES_DRAG_START,{nodes:d._dragged}),d._graphics.addCursorStyle(d._settings.get("interactions.drag.cursor"))},d._onDrag=function(){for(var c=d._captor.getCursorInformation(),h=c.x,p=c.y,g=d._dragged._indexes,m=d._camera.screenToGraphCoordinates({x:h,y:p}),x=m.x-d._startDrag.x,v=m.y-d._startDrag.y,y=0;y<g.length;++y){var b=d._start[y],S=d._end[y];S.x=b.x+x,S.y=b.y+v}d._onBeforeDrag&&d._onBeforeDrag(d._dragged,h,p,d._end),d._settings.get("interactions.drag.applyResult")&&d._attributes.setMultipleAttributes(d._dragged,d._end,null,["x","y"]),d._events.fire(I.NODES_DRAG_PROGRESS,{nodes:d._dragged,dx:x,dy:v})},d._onDragEnd=function(){d._dragged.removeClass(xl),d._graphics.removeCursorStyle(d._settings.get("interactions.drag.cursor")),d._events.fire(I.NODES_DRAG_END,{nodes:d._dragged,start:d._start,end:d._end}),d._dragged=null,d._start=null,d._end=null},d._camera=n,d._graphics=t,d._selection=i,d._events=r,d._settings=u,d._captor=o,d._attributes=a,d._interactions=s,l.createClass({name:xl,isBuiltin:!0,nodeAttributes:{layer:3}}),r.register([I.NODES_DRAG_START,I.NODES_DRAG_PROGRESS,I.NODES_DRAG_END]),u.register("interactions.drag.enabled",!0),u.register("interactions.drag.cursor","move"),u.register("interactions.drag.onBeforeDrag",null),u.register("interactions.drag.applyResult",!0),d._interactions.onDrag({priority:"drag",disableDetection:!0,check:d._shouldDrag,onStart:d._onDragStart,onProgress:d._onDrag,onStop:d._onDragEnd}),d}function C1(e){return.2*Math.min(e.viewWidth/e.graphWidth,e.viewHeight/e.graphHeight)}function T1(e){var t=e.smallestNodeSize;return t===1/0?1/0:Math.min(e.viewWidth,e.viewHeight)/t*.5}(Xl=So=So||{}).ROTATION="rotation",Xl.PAN="pan",Xl.ZOOM="zoom",Xl.GESTURE="gesture";var V_,M1=(St(Vs,V_=Pe),Vs.prototype._setupInteractions=function(){var e=this;this._interactions.onMouseWheel({priority:"zoom",check:function(){return e._settings.get("interactions.zoom.enabled")},handler:Pa(function(t){return e._smoothZoom(t.delta,t.x,t.y)},50)}),this._interactions.onDoubleClick({priority:"zoom",check:function(){var t=e._settings.get("interactions.zoom.enabled"),n=e._settings.get("interactions.zoom.onDoubleClick");return t&&n},handler:function(t){return e._smoothZoom(1,t.x,t.y)}}),this._interactions.onDrag({priority:"panning",disableDetection:!0,check:function(t){var n=t.button,i=e._settings.get("interactions.pan.enabled");return"left"===n&&i},onStart:function(){return e._updateVisibility(So.PAN,!0)},onProgress:function(t){return e._camera.move({x:-t.dx,y:-t.dy})},onStop:function(){return e._updateVisibility(So.PAN,!1)}}),this._interactions.onDrag({priority:"rotation",disableDetection:!0,check:function(t){var i=t.domEvent;return("right"===t.button||i&&2===i.buttons)&&e._settings.get("interactions.rotation.enabled")},onStart:function(t){e._rotationStart={x:t.x,y:t.y},e._updateVisibility(So.ROTATION,!0)},onProgress:function(t){return e._rotate({x:t.x,y:t.y})},onStop:function(){return e._updateVisibility(So.ROTATION,!1)}}),this._interactions.onGesture({priority:"gesture",disableDetection:!0,check:function(){return e._settings.get("interactions.gesture.enabled")},onStart:function(){return e._updateVisibility(So.GESTURE,!0)},onProgress:function(t){var n=t.dx,i=t.dy,r=t.rotation,o=t.scale,a=t.x,s=t.y;e._settings.get("interactions.rotation.enabled")&&e._camera.rotate(-r),e._camera.zoomIn(o,void 0,{refX:a,refY:s}),e._camera.move({x:-n,y:-i})},onStop:function(){return e._updateVisibility(So.GESTURE,!0)}})},Vs.prototype._rotate=function(e){var t=e.x,n=e.y,i=this._camera.getSize(),r=i.width/2,o=i.height/2,l=t-r,u=n-o,d=Math.atan2(this._rotationStart.y-o,this._rotationStart.x-r)-Math.atan2(u,l);this._rotationStart.x=t,this._rotationStart.y=n,this._camera.rotate(d)},Vs.prototype._updateVisibility=function(e,t){var n=!t,i=this._settings,r=i.get("interactions."+e+".hideNodes"),o=i.get("interactions."+e+".hideEdges"),a=i.get("interactions."+e+".hideNodeTexts"),s=i.get("interactions."+e+".hideEdgeTexts");r&&this._graphics.setNodesVisibility(n),a&&this._graphics.setNodeTextsVisibility(n),o&&this._graphics.setEdgesVisibility(n),s&&this._graphics.setEdgeTextsVisibility(n)},Vs.prototype._smoothZoom=function(e,t,n){var i=this,r=this._settings,o=r.get("interactions.zoom.modifier"),a=r.get("interactions.zoom.duration"),s=r.get("interactions.zoom.easing"),l=this._camera.getZoom()*(0<e?o:1/o),u={duration:a,easing:s};this._zooming||(this._zooming=!0,this._updateVisibility(So.ZOOM,!0)),this._camera.setZoom(l,u,{refX:t,refY:n}).then(function(){i._zooming&&(i._zooming=!1,i._updateVisibility(So.ZOOM,!1))})},Vs);function Vs(e,t){var n=e.camera,i=e.graphics,r=e.settings,o=e.interactions,a=V_.call(this)||this;return a._zooming=!1,a._camera=n,a._settings=r,a._interactions=o,a._graphics=i,r.register("interactions.zoom.enabled",!0),r.register("interactions.zoom.onDoubleClick",!1),r.register("interactions.zoom.duration",150),r.register("interactions.zoom.modifier",1.8),r.register("interactions.zoom.easing","quadraticOut"),r.register("interactions.zoom.minValue",t?null:C1),r.register("interactions.zoom.maxValue",t?null:T1),r.register("interactions.zoom.hideNodes",!1),r.register("interactions.zoom.hideEdges",!1),r.register("interactions.zoom.hideNodeTexts",!1),r.register("interactions.zoom.hideEdgeTexts",!1),r.register("interactions.pan.enabled",!0),r.register("interactions.pan.hideNodes",!1),r.register("interactions.pan.hideEdges",!1),r.register("interactions.pan.hideNodeTexts",!1),r.register("interactions.pan.hideEdgeTexts",!1),r.register("interactions.rotation.enabled",!0),r.register("interactions.rotation.hideNodes",!1),r.register("interactions.rotation.hideEdges",!1),r.register("interactions.rotation.hideNodeTexts",!1),r.register("interactions.rotation.hideEdgeTexts",!1),r.register("interactions.gesture.enabled",!0),r.register("interactions.gesture.hideNodes",!1),r.register("interactions.gesture.hideEdges",!1),r.register("interactions.gesture.hideNodeTexts",!1),r.register("interactions.gesture.hideEdgeTexts",!1),a._setupInteractions(),a}var U_,I1={color:"#00C3FF",radius:7,cursorOnHover:"grab",cursorOnDrag:"grabbing"},k1=(St(so,U_=Pe),so.prototype.onMounted=function(e){e.events.onEdgesSelected(this._refreshHandles),e.events.onEdgesUnselected(this._refreshHandles)},so.prototype.enable=function(e){this._enabled||(this._options=It({},I1,e),this._enabled=!0,this._graphics.addCanvas(this._canvas),this._refreshHandles())},so.prototype.disable=function(){this._enabled&&(this._interaction.stop(),this._graphics.removeCursorStyle(this._options.cursorOnDrag),this._disableCursorOnHover(),this._restoreSettings(),this._graphics.removeCanvas(this._canvas),this._rewirableClass.clearEdges(),this._enabled=!1)},so.prototype.enabled=function(){return this._enabled},so.prototype._restoreSettings=function(){this._prevSettings&&(this._settings.update(this._prevSettings),this._prevSettings=null)},so.prototype._disableCursorOnHover=function(){this._hoverHandle&&!this._grabHandle&&(this._hoverHandle=!1,this._graphics.removeCursorStyle(this._options.cursorOnHover))},so.prototype._enableCursorOnHover=function(){this._hoverHandle||(this._hoverHandle=!0,this._graphics.addCursorStyle(this._options.cursorOnHover))},so.prototype._displayMovedEdges=function(){var e=this;if(this._movedEdges){var t=this._x,n=this._y,i=this._ctx,r=Ln(),o={x:t,y:n},a=this._camera.getZoom();this._movedEdges.forEach(function(s,l){var u=e._edgeColors[l],d=s.getSource(),c=s.getTarget(),h=e._getPointedNode(),p=c===e._startNode?d:c,g=s.getAttribute("width")*a,m=p.getPositionOnScreen(),x=h?h.getPositionOnScreen():o;p.addClass(yl),i.beginPath(),i.moveTo(m.x*r,m.y*r),i.lineTo(x.x*r,x.y*r),i.strokeStyle=u,i.lineWidth=g*r,i.stroke()})}},so.prototype._getPointedNode=function(){var e=this._captor.getPointedElement();return e&&e.isNode?e:null},so);function so(e){var t=e.classes,n=e.graphics,i=e.camera,r=e.captor,o=e.selection,a=e.events,s=e.settings,l=e.interactions,u=U_.call(this)||this;return u._canvas=ci(),u._ctx=u._canvas.getContext("2d"),u._nodesToHighlight=null,u._movedEdges=null,u._startNode=null,u._hoverHandle=!1,u._grabHandle=!1,u._prevSettings=null,u._x=0,u._y=0,u._enabled=!1,u._onDragStart=function(){u._nodesToHighlight=u._nodesToHighlight.filter(function(c){return c!==u._startNode}),u._movedEdges.setExcluded(!0);var d=u._options.cursorOnDrag;u._prevSettings=u._settings.update({edgeHover:!1,cursor:{default:d,node:d,edge:d}})},u._onDragEnd=function(){u._restoreSettings();var d=u._getPointedNode();d&&u._movedEdges.forEach(function(c){c.getTarget()===u._startNode?c.setTarget(d):c.setSource(d)}),u._movedEdges.setExcluded(!1),u._movedEdges.setSelected(!0),u._movedEdges=null,u._refreshHandles()},u._refreshHandles=function(){if(u._enabled&&!u._movedEdges){var d=u._selection.getSelectedEdges();u._nodesToHighlight=d.getExtremities().dedupe(),u._rewirableClass.clearEdges(),u._rewirableClass.add(d),u._refreshCanvas()}},u._shouldInteractionStart=function(d){var c=d.target;if(!(u._enabled&&c&&c.isNode&&u._hoverHandle))return!1;var h=c.getAdjacentEdges().filter(function(p){return p.isSelected()});return!!h.size&&(u._movedEdges=h,u._edgeColors=u._movedEdges.getAttribute("color"),u._startNode=c,!0)},u._refreshCanvas=function(){if(u._enabled&&u._nodesToHighlight){var d=u._captor.getCursorPosition(),c=u._getPointedNode(),h=u._camera.zoom,p=u._canvas.getContext("2d"),g=Ln(),m=u._options.color,x=u._options.radius,v=2*x*g;p.clearRect(0,0,u._canvas.width,u._canvas.height),u._displayMovedEdges(),p.fillStyle=m,p.strokeStyle=m;var y=!1;if(u._nodesToHighlight.forEach(function(S){var w=S.getPositionOnScreen(),M=w.x,N=w.y,D=S.getAttribute("radius")*("fixed"===S.getAttribute("scalingMethod")?1:h);x<D&&(p.fillRect((M-x)*g,(N-x)*g,v,v),yi(M,N,d.x,d.y)<x&&(y=!0))}),u._movedEdges){var b=c?c.getPositionOnScreen():d;p.fillRect((b.x-x)*g,(b.y-x)*g,v,v)}y?u._enableCursorOnHover():u._disableCursorOnHover()}},u._captor=r,u._camera=i,u._graphics=n,u._selection=o,u._events=a,u._settings=s,u._interactions=l,u._classes=t,u._rewirableClass=u._classes.createClass({name:kf,isBuiltin:!0,edgeAttributes:{layer:4}}),u._events.on({cameraMove:u._refreshCanvas,move:u._refreshCanvas,progressMoveNodesByDragging:u._refreshCanvas,down:function(){u._hoverHandle&&(u._grabHandle=!0)},up:function(){u._grabHandle=!1}}),u._interaction=u._interactions.onDrag({priority:"rewiring",check:u._shouldInteractionStart,onStart:u._onDragStart,onProgress:function(d){var h=d.y;u._x=d.x,u._y=h},onStop:u._onDragEnd}),u}var j_,O1={cursor:"nesw-resize",color:"#00C3FF",lineWidth:1,handleSize:6,detectionMargin:5,snappingRatio:1.25,nbNodesToSnapTo:5,previewColor:"rgba(0, 0, 0, 0.2)",sizeIndicatorColor:"black",sizeIndicatorOffset:5,sizeIndicatorWidth:3,sizeIndicatorThickness:1},N1=(St($i,j_=Pe),$i.prototype.onMounted=function(e){e.events.onNodesSelected(this._onSelectionChange),e.events.onNodesUnselected(this._onSelectionChange)},$i.prototype._enableCursor=function(){this._cursorEnabled||(this._graphics.addCursorStyle(this._options.cursor),this._cursorEnabled=!0)},$i.prototype._disableCursor=function(){this._cursorEnabled&&(this._graphics.removeCursorStyle(this._options.cursor),this._cursorEnabled=!1)},$i.prototype._detectBoundingBoxes=function(e,t){var n=this;if(this._enabled&&!this._nodeBeingResized&&this._nodesToHighlight){var i=this._options.handleSize/2,r=this._options.detectionMargin;return this._pointedNode=null,this._forEachNodeToHighlight(function(o,a,s){a.x+s-i-r<=e&&e<=a.x+s+i+r&&a.y-s-i-r<=t&&t<=a.y-s+i+r&&(n._pointedNode=o)}),this._pointedNode?this._enableCursor():this._disableCursor()}},$i.prototype._forEachNodeToHighlight=function(e){var t=this;this._nodesToHighlight.forEach(function(n){var i=n.getPositionOnScreen(),r=t._getTotalOnScreenRadius(n);e(n,i,r)})},$i.prototype._displayHandles=function(){var e=this;if(this._enabled&&this._nodesToHighlight){var t=this._canvas,n=this._ctx,i=t.width,r=t.height,o=Ln(),a=this._options,s=a.color,l=a.lineWidth,u=a.handleSize,d=0;if(n.clearRect(0,0,i,r),this._nodeBeingResized){var c=this._getTotalOnScreenRadius(this._nodeBeingResized),h=this._nodeBeingResized.getPositionOnScreen();d=Math.max(this._x-(h.x+c),-(this._y-(h.y-c)))/2}this._additionalRadiuses=[],this._forEachNodeToHighlight(function(p,g,m){var x=0;if(e._nodeBeingResized){x=d;var v=-m+p.getAttribute("innerStroke.width")+p.getAttribute("outerStroke.width")+l/2+1;x=x<v?v:e._snap(p,x),e._additionalRadiuses.push(x);var y=p.getAttribute("shape"),b=e._engine.getShapePoints(y);e._displayNodePreview(n,o,g.x+x,g.y-x,m+x,b)}n.strokeStyle=s,n.fillStyle=s,n.lineWidth=l,n.strokeRect((g.x-m)*o,(g.y-m-2*x)*o,2*(x+m)*o,2*(x+m)*o),n.fillRect((g.x+m+2*x-u/2)*o,(g.y-m-2*x-u/2)*o,u*o,u*o)})}},$i.prototype._displayNodePreview=function(e,t,n,i,r,o){if(n*=t,i*=t,r*=t,e.beginPath(),1===o.length)e.arc(n,i,r,0,2*Math.PI);else for(var a=0;a<o.length;++a){var s=o[a],l=n+s.x*r,u=i+s.y*r;0===a?e.moveTo(l,u):e.lineTo(l,u)}e.fillStyle=this._options.previewColor,e.fill()},$i.prototype._getTotalOnScreenRadius=function(e){return e.getAttribute("radius")*this._camera.zoom+e.getAttribute("innerStroke.width")+e.getAttribute("outerStroke.width")+this._options.lineWidth/2},$i.prototype._snap=function(e,t){var n=this,i=this._spatial.getNodesInScreenByDistance(e).filter(function(p){return!p.isSelected()}).slice(0,this._options.nbNodesToSnapTo),r=this._ctx,o=this._getTotalOnScreenRadius(e),a=o+t,s=this._options.snappingRatio,u=Math.round(Ar(a/o,s)),d=o*Math.pow(s,u),c=null;if(i.forEach(function(p){var g=n._getTotalOnScreenRadius(p);Math.abs(g-a)<=Math.abs(d-a)&&(d=g,c=p)}),c){r.save(),r.strokeStyle=this._options.sizeIndicatorColor,r.lineWidth=this._options.sizeIndicatorThickness;var h=c.getAttribute("radius");this._displaySizeIndicator(e,d),i.filter(function(p){return p.getAttribute("radius")===h}).forEach(function(p){return n._displaySizeIndicator(p)}),r.restore()}return d-o},$i.prototype._displaySizeIndicator=function(e,t){var n=this._ctx,i=Ln(),r=e.getPositionOnScreen(),o=this._getTotalOnScreenRadius(e),a=t||o,s=t?t-o:0,l=s-this._options.sizeIndicatorOffset-(t?e.getAttribute("innerStroke.width")+e.getAttribute("outerStroke.width"):0),u=r.x-a+l|0,d=r.y-a-s|0,c=r.y+a-s|0,h=this._options.sizeIndicatorWidth;n.beginPath(),n.moveTo((u-h)*i,d*i),n.lineTo((u+h)*i,d*i),n.moveTo(u*i,d*i),n.lineTo(u*i,c*i),n.moveTo((u-h)*i,c*i),n.lineTo((u+h)*i,c*i),n.stroke()},$i.prototype.enable=function(e){this._enabled||(this._options=It({},O1,e),this._graphics.addCanvas(this._canvas),this._ctx=this._canvas.getContext("2d"),this._events.on({"cameraMove progressMoveNodesByDragging":this._displayHandlesHandler,"move down":this._moveHandler}),this._enabled=!0)},$i.prototype.disable=function(){this._enabled&&(this._events.removeListener(this._displayHandlesHandler),this._events.removeListener(this._moveHandler),this._graphics.removeCanvas(this._canvas),this._disableCursor(),this._reset())},$i.prototype._reset=function(){this._enabled=!1,this._nodesToHighlight=null,this._options=null,this._nodeBeingResized=null,this._pointedNode=null,this._cursorEnabled=!1,this._x=0,this._y=0,this._additionalRadiuses=[]},$i.prototype.enabled=function(){return this._enabled},$i);function $i(e){var t=e.dom,n=e.interactions,i=e.camera,r=e.events,o=e.graphics,a=e.spatial,s=e.selection,l=j_.call(this)||this;return l._enabled=!1,l._nodesToHighlight=null,l._options=null,l._nodeBeingResized=null,l._pointedNode=null,l._cursorEnabled=!1,l._x=0,l._y=0,l._additionalRadiuses=[],l._onSelectionChange=function(){l._enabled&&(l._nodesToHighlight=l._selection.getSelectedNodes(),l._displayHandles())},l._displayHandlesHandler=function(){return l._displayHandles()},l._moveHandler=function(u){var d=u.x,c=u.y;l._dom.setTimeout(function(){return l._detectBoundingBoxes(d,c)})},l._dom=t,l._interactions=n,l._events=r,l._camera=i,l._dom=t,l._spatial=a,l._graphics=o,l._selection=s,l._engine=l._graphics.getGraphicsEngine(),l._canvas=ci(),l._ctx=l._canvas.getContext("2d"),l._interactions.onDrag({priority:"resizing",disableDetection:!0,check:function(){return!(!l._enabled||!l._pointedNode)},onStart:function(u){var c=u.y;l._x=u.x,l._y=c,l._nodeBeingResized=l._pointedNode},onProgress:function(u){var c=u.y;l._x=u.x,l._y=c,l._displayHandles()},onStop:function(){l._nodesToHighlight.forEach(function(u,d){var c=l._additionalRadiuses[d]/l._camera.zoom;u.setAttributes({radius:u.getAttribute("radius")+c,x:u.getPosition().x+c,y:u.getPosition().y-c})}),l._pointedNode=null,l._nodeBeingResized=null,l._displayHandles()}}),l}var G_,zc,Bc,L1={strokeColor:"black",strokeWidth:5,dashed:!0,cursorStyle:"cell",createNodes:!0,condition:function(){return!0},onNodeCreated:function(){},onEdgeCreated:function(){},onComplete:function(){}},F1=(St(qo,G_=Pe),qo.prototype._onStart=function(e){e&&(this._cursorEnabled=!0,this._startNode=e,this._startPos=e.getPosition(),this._graphics.addCursorStyle(this._options.cursorStyle),this._blockId=this._graphics.allocateGraphicsEngineBlockId())},qo.prototype._onMove=function(e,t){null!==this._startNode&&(this._endPos=this._camera.screenToGraphCoordinates({x:e,y:t}),this._drawLine())},qo.prototype._onStop=function(){if(null!==this._startNode){var e=this._options,t=e.condition,n=e.onNodeCreated,i=e.onEdgeCreated,r=e.onComplete,o=e.createNodes,a=this._captor.getPointedElement(),s=null,l=null;this._graphics.releaseGraphicsEngineBlockId(this._blockId),!a&&o&&(l=a=this._graph.addNode({attributes:{x:this._endPos.x,y:this._endPos.y}}),n&&n(l)),a&&(l||!t||t(this._startNode,a))&&(s=this._graph.addEdge({source:this._startNode.getId(),target:a.getId()}),i&&i(s)),r&&(this._events.fire(I.CONNECT_NODES,{source:this._startNode,target:a,edge:s}),r(this._startNode,a,s)),this.disable()}},qo.prototype._drawLine=function(){this._block.reset(1,!1,this._depth);var e=this._block.nextAndReset().end;e.pieceId=2,e.shape="line",e.x1=this._startPos.x,e.y1=this._startPos.y,e.x2=this._endPos.x,e.y2=this._endPos.y,e.fillColor=this._options.strokeColor,e.thicknessOrFontSizeFixed=this._options.strokeWidth,this._options.dashed&&(e.dashLength=3,e.gapLength=1),this._engine.storeBlock(this._blockId,this._block),this._dom.refresh()},qo.prototype.enable=function(e){if(void 0===e&&(e={}),!this._enabled)return this._options=It({},L1,e),this._enabled=!0,this._cursorEnabled=!1,this._startNode=null,this._prevSettings=this._settings.update({"cursor.node":this._options.cursorStyle,"detect.edges":!1}),this._captor.isLeftPressed()&&this._interaction.start(this._captor.getCursorInformation()),this},qo.prototype.disable=function(){this._enabled&&(this._enabled=!1,this._settings.update(this._prevSettings),this._cursorEnabled&&this._graphics.removeCursorStyle(this._options.cursorStyle))},qo.prototype.enabled=function(){return this._enabled},qo);function qo(e){var t=e.dom,n=e.camera,i=e.captor,r=e.graph,o=e.graphics,a=e.interactions,s=e.events,l=e.settings,u=G_.call(this)||this;return u._enabled=!1,u._options=null,u._blockId=null,u._startNode=null,u._startPos=null,u._endPos=null,u._cursorEnabled=!1,u._dom=t,u._camera=n,u._captor=i,u._graph=r,u._graphics=o,u._interactions=a,u._events=s,u._settings=l,u._engine=u._graphics.getGraphicsEngine(),u._block=u._engine.createBlock(),u._depth=xu(0).edgeBody,u._events.register([I.CONNECT_NODES]),u._interaction=u._interactions.onDrag({priority:"connectNodes",check:function(d){var c=d.target,h=d.button;return u._enabled&&"left"===(void 0===h?"left":h)&&c&&c.isNode},onStart:function(d){return u._onStart(d.target)},onProgress:function(d){return u._onMove(d.x,d.y)},onStop:function(){return u._onStop()}}),u._events.on({clear:function(){return u.disable()}}),u}var Z_,P1=["top","bottom","left","right","cssDefined"],D1={top:{x:0,y:-1},bottom:{x:0,y:1},left:{x:-1,y:0},right:{x:1,y:0}},R1={position:"top",autoAdjust:!0,delay:100,className:null},z1={hover:{node:function(e){var t=e.target;return t&&t.isNode},edge:function(e){var t=e.target;return t&&!t.isNode}},click:((zc={})[Qt.LEFT]={node:function(e){var t=e.target;return e.button===Qt.LEFT&&t&&t.isNode},edge:function(e){var t=e.target;return e.button===Qt.LEFT&&t&&!t.isNode},background:function(e){return e.button===Qt.LEFT&&!e.target}},zc[Qt.RIGHT]={node:function(e){var t=e.target;return e.button===Qt.RIGHT&&t&&t.isNode},edge:function(e){var t=e.target;return e.button===Qt.RIGHT&&t&&!t.isNode},background:function(e){return e.button===Qt.RIGHT&&!e.target}},zc),doubleClick:((Bc={})[Qt.LEFT]={node:function(e){var t=e.target;return e.button===Qt.LEFT&&t&&t.isNode},edge:function(e){var t=e.target;return e.button===Qt.LEFT&&t&&!t.isNode},background:function(e){return e.button===Qt.LEFT&&!e.target}},Bc[Qt.RIGHT]={node:function(e){var t=e.target;return e.button===Qt.RIGHT&&t&&t.isNode},edge:function(e){var t=e.target;return e.button===Qt.RIGHT&&t&&!t.isNode},background:function(e){return e.button===Qt.RIGHT&&!e.target}},Bc)},B1=(St(Hr,Z_=Pe),Hr.prototype.hide=function(){this._hideTooltip(!0)},Hr.prototype.isShown=function(){return!!this._tooltip},Hr.prototype.refresh=function(){this._refreshTooltip()},Hr.prototype.show=function(e,t){var n=void 0===t?{}:t,i=n.position,o=n.autoAdjust,s=n.className,u=n.x,c=n.y;this._showTooltip(e,{position:void 0===i?"top":i,autoAdjust:void 0===o||o,className:void 0===s?null:s},{x:void 0===u?0:u,y:void 0===c?0:c})},Hr.prototype.setHandler=function(e,t,n){var i=It({},R1,n);-1===P1.indexOf(i.position)&&(i.position="top"),this._handlers[e]={handler:t,condition:bn(z1,e),settings:i}},Hr.prototype._hideTooltip=function(e){if(this._timeout&&(this._dom.clearTimeout(this._timeout),this._timeout=null),e&&(this._currentHandlerName=null),this._tooltip){var t=this._tooltip;this._tooltip.parentNode&&this._tooltip.parentNode.removeChild(this._tooltip),this._tooltip=null,this._events.fire(I.TOOLTIP_HIDE,{tooltip:t})}},Hr.prototype._createInteraction=function(e,t){var n=this;return void 0===t&&(t=!1),{priority:"tooltip",check:function(i){var r=q_(e,i),o=n._handlers[r];return!(t&&n._connectNodes.enabled()||(!o||!o.condition(i))&&(t||!n._currentHandlerName||n._isHover||null===n._tooltip))},handler:function(i){var r=i.target,o=i.x,a=i.y;n._hideTooltip(!1),n._isHover=t,n._elt=r,n._x=o,n._y=a,n._currentHandlerName=q_(e,i),n._refreshTooltip()}}},Hr.prototype._refreshTooltip=function(){var e=this;if(this._currentHandlerName){var t=this._handlers[this._currentHandlerName];if(t){var n=t.settings,i=t.handler,r=this._elt;if(r&&-1===this._currentHandlerName.indexOf(r.isNode?"node":"edge"))return;var a=i(r);(a instanceof Promise?a:Promise.resolve(a)).then(function(s){e._schedule(function(){return e._showTooltip(s,n)},n.delay)})}}else this._hideTooltip(!1)},Hr.prototype._schedule=function(e,t){var n=this;this._timeout&&this._dom.clearTimeout(this._timeout),this._timeout=this._dom.setTimeout(function(){n._timeout=null,e()},t)},Hr.prototype._showTooltip=function(e,t,n){this._hideTooltip(!1);var i=t.position,r=t.className,o=t.autoAdjust,a=this._x,s=this._y,l=this._elt,u=this._dom.getDimensions(),d=0,c=0;if(n&&(a=n.x,s=n.y,l=null),"string"==typeof e)this._tooltip=ir?document.createElement("div"):$o(),this._tooltip.innerHTML=e;else{if(!Po(e))throw new Error("invalid tooltip "+e+", expected HTML string or HTML element");this._tooltip=e}var h=this._tooltip;if(r&&this._tooltip.classList.add(r),"cssDefined"!==i&&(h.style.position="absolute"),this._dom.appendElement(h),l&&l.isNode){var p=l,g=p.getPositionOnScreen(),m=p.getAttribute("radius");m="fixed"===p.getAttribute("scalingMethod")?m+p.getAttribute("innerStroke.width")+p.getAttribute("outerStroke.width"):m*this._camera.getZoom()+p.getAttribute("innerStroke.width")+p.getAttribute("outerStroke.width"),a=g.x,s=g.y,c=d=m}var x=h.offsetWidth/2,v=h.offsetHeight/2;if(d+=x,c+=v,"cssDefined"!==i){var y=D1[i],b=y.x,S=y.y;if(o){var w=a+d*y.x,M=s+c*y.y;(w-x<0||w+x>=u.width)&&("left"===i||"right"===i?b*=-1:b=w-x<0?(x-w+1)/d:(u.width-(w+x)-1)/d),(M-v<0||M+v>=u.height)&&("top"===i||"bottom"===i?S*=-1:S=M-v<0?(v-M+1)/c:(u.height-(M+v)-1)/c)}h.style.left=a+d*b-x+"px",h.style.top=s+c*S-v+"px"}this._events.fire(I.TOOLTIP_SHOW,{tooltip:h})},Hr);function Hr(e){var t=e.dom,n=e.connectNodes,i=e.interactions,r=e.camera,o=e.events,a=Z_.call(this)||this;return a._x=0,a._y=0,a._dom=t,a._connectNodes=n,a._interactions=i,a._camera=r,a._events=o,a._handlers={},a._currentHandlerName=null,a._tooltip=null,a._isHover=!1,a._events.register(["showTooltip","hideTooltip"]),a._events.on({"up dragStart":function(){a._isHover||a._hideTooltip(!1)},unhover:function(){a._isHover&&a._hideTooltip(!1)},clear:function(){return a._hideTooltip(!1)}}),a._interactions.onHover(a._createInteraction("hover",!0)),a._interactions.onClick(a._createInteraction("click")),a._interactions.onDoubleClick(a._createInteraction("doubleClick")),a}function q_(e,t){var n=t.button,i=t.target;return e+(n?"."+n:"")+"."+(null!==i?i.isNode?"node":"edge":"background")}var H_,Ou={65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",13:"enter",16:"shift",17:"ctrl",18:"alt",27:"esc",46:"del",8:"backspace",32:"space",224:"cmd",91:"cmd",92:"cmd",93:"cmd",187:"+",189:"-"},W_=Object.keys(Ou).reduce(function(e,t){var n=Ou[t];return e[n]||(e[n]=[]),e[n].push(t),e},{}),V1=(St(Us,H_=Pe),Us.prototype.setIdleTimeout=function(e){if(!isFinite(e)||e<=1)throw new TypeError("Idle timeout must be a positive number > 1");this._idleTimeout=e},Us.prototype.resetKeys=function(){for(var e=0;e<this._pressed.length;e++)this._pressed[e]&&(this._pressed[e]=!1,this._events.fire("keyUp",{key:Ou[e],code:e}))},Us.prototype.onKeyPress=function(e,t){var n,i=this;if("number"==typeof e&&(n=[e]),"string"==typeof e&&(n=e.split(" ")),Array.isArray(e)&&(n=e),!n)throw new TypeError(e+" is not a number, string or array");if(0===n.length)throw new Error("the array should contain at least one element");var r=n.map(function(s){if("number"==typeof s)return[s];if("string"!=typeof s)throw new TypeError(s+" is not a valid key identifier");var l=W_[s];if(!l)throw new Error(s+" is not a valid key identifier");return l}),o=r.pop(),a={keys:r,handler:t};o.forEach(function(s){i._binds[s]||(i._binds[s]=[]),i._binds[s].push(a)})},Us.prototype.isPressed=function(e){var t=this;if("number"==typeof e)return this._pressed[e];if("string"==typeof e){var n=W_[e];if(n)return n.some(function(i){return t._pressed[i]})}return!1},Us);function Us(e){var t=e.dom,n=e.events,i=H_.call(this)||this;return i._onBlur=function(){return i.resetKeys()},i._onKeyUp=function(r){var o=r.keyCode||r.which;i._pressed[o]=!1,i._events.fire("keyUp",{domEvent:r,key:Ou[o],code:o})},i._onKeyDown=function(r){var o=r.keyCode||r.which,a=i._binds[o];if(!i._pressed[o]){if(i._pressed[o]=!0,a)for(var s=0,l=a;s<l.length;s++){var u=l[s];u.keys.every(function(d){return d.some(function(c){return i._pressed[c]})})&&u.handler({domEvent:r})}i._events.fire("keyDown",{domEvent:r,key:Ou[o],code:o})}},i._dom=t,i._events=n,i._events.register(["keyUp","keyDown"]),i._binds=[],i._pressed=[],i._dom.addWindowEventListener("keydown",i._onKeyDown),i._dom.addWindowEventListener("keyup",i._onKeyUp),i._dom.addWindowEventListener("visibilitychange",i._onBlur),i._dom.addWindowEventListener("blur",i._onBlur,!1),i._idleTimeout=4e3,i._prevEventTimeStamp=z(),i._events.onAnyEvent(function(){var r=z();r-i._prevEventTimeStamp>i._idleTimeout&&i.resetKeys(),i._prevEventTimeStamp=r}),i}var U1=[{name:"color",isNode:!0},{name:"shape",isNode:!0},{name:"radius",isNode:!0},{name:"icon.content",isNode:!0},{name:"image.url",isNode:!0},{name:"image",isNode:!0},{name:"color",isNode:!1},{name:"shape",isNode:!1},{name:"width",isNode:!1}],Ho=Math.PI,Wo=2*Math.PI,Y_=Math.cos(Ho/2-Wo/5),X_=Math.cos(Ho/2-Wo/5*2),J_=Math.cos(Ho/2-Wo/5*3),Q_=Math.cos(Ho/2-Wo/5*4),K_=Math.sin(-Ho/2+Wo/5),$_=Math.sin(-Ho/2+Wo/5*2),em=Math.sin(-Ho/2+Wo/5*3),tm=Math.sin(-Ho/2+Wo/5*4),Vc=1/3,G1=[8,3],Z1=[3,3],im={position:"bottom",widgetWidth:130,fontFamily:"Arial",fontSize:10,fontColor:"black",titleFontSize:12,titleFontColor:"black",titleMaxLength:20,titleTextAlign:"left",shapeColor:"grey",backgroundColor:"white",borderColor:"black",borderRadius:0,borderWidth:1,innerMargin:10,outerMargin:5,circleStrokeWidth:3,titleFunction:function(e){return e[e.length-1]}},q1=["widgetWidth","fontSize","titleFontSize","borderRadius","borderWidth","innerMargin","outerMargin","circleStrokeWidth"];function Yo(e){var t=["K","M","B","T","P","E","Z","Y"];if(9999<e){for(var n=0;n<t.length&&999<e;)e/=1e3,n++;return(rm(e,3)+t[n-1]).toString()}return rm(e,4).toString()}function rm(e,t){void 0===t&&(t=3);var n=4===t?10:1;return e<10?Math.round(100*e*n)/100*n:e<100?Math.round(10*e*n)/10*n:e<1e3?Math.round(e*n)/n:Math.round(e)}function om(e){return e.innerMargin+1.6*(e.titleFontSize+e.fontSize)}function H1(e,t,n){var i,j,Y,he,pe,Ae,Ie,ot,at,We,o=t.getContext("2d"),a=n.x,s=n.y,u=n.isNode,d=n.styleProperty,c=n.title,h=n.mapping,p=n.iconFont,g=n.iconFontStyle;Y=a,he=s,pe=(i=e).widgetWidth,Ae=n.height,Ie=i.borderRadius,ot=i.backgroundColor,at=i.borderColor,We=i.borderWidth,(j=o).setLineDash([]),j.beginPath(),j.moveTo(Y+Ie,he),j.lineTo(Y+pe-Ie,he),j.quadraticCurveTo(Y+pe,he,Y+pe,he+Ie),j.lineTo(Y+pe,he+Ae-Ie),j.quadraticCurveTo(Y+pe,he+Ae,Y+pe-Ie,he+Ae),j.lineTo(Y+Ie,he+Ae),j.quadraticCurveTo(Y,he+Ae,Y,he+Ae-Ie),j.lineTo(Y,he+Ie),j.quadraticCurveTo(Y,he,Y+Ie,he),j.closePath(),j.fillStyle=ot,j.fill(),j.strokeStyle=at,j.lineWidth=We,j.stroke(),function(j,Y,he,pe,Ae){Nu(j,Y.fontFamily,Y.titleFontSize,Y.titleFontColor,Y.titleTextAlign);var Ie="center"===Y.titleTextAlign,ot=Y.widgetWidth-2*Y.innerMargin,at=j.measureText(he).width,We=pe+(Ie?Y.widgetWidth/2:Y.innerMargin),vt=Ae+Y.titleFontSize/2+Y.innerMargin;ot<at&&(he=he.substr(0,(he.length*(ot/at)|0)-2)+"\u2026"),j.fillText(he,We,vt)}(o,e,c,a,s);var x=1.6*e.fontSize,v=e.fontSize/2*1.6*.9,y=3*e.fontSize,b=e.fontSize,S=e.fontSize*(u?1:3),w=s+om(e),M=a+e.innerMargin+S/2,N=a+2*e.innerMargin+S,D=Da(h),P=function j(Y){return Array.isArray(Y)?Y.reduce(function(he,pe){return he&&j(pe)},!0):"undefined"===Y||!isNaN(Number(Y))}(D),L=e.fontColor,V=e.shapeColor,X=Object.keys(h);if(P&&(X.sort(function(j,Y){return _n(h[Y])-_n(h[j])}),"radius"===d||"width"===d)){var J=function j(Y){return Array.isArray(Y)?Y.reduce(function(he,pe){return Math.min(he,j(pe))},1/0):isNaN(Y)?1/0:+Y}(D),se=function j(Y){return Array.isArray(Y)?Y.reduce(function(he,pe){return Math.max(he,j(pe))},-1/0):isNaN(Y)?-1/0:+Y}(D),re=Math.round((J+se)/2);return(u?W1:Y1)(e,o,a,w,J,re,se,V)}X.forEach(function(j){var Y,he,pe,Ae,Ie,at,We,vt,Tt,qe,Le,He,Je,et,Te,Re,Ze,Qe,dt,Ht,Kt,Ge=h[j];"color"===d&&(u?am(o,M,w,v,j):(he=M,pe=w,Ae=y,Ie=b,(Y=o).fillStyle=j,Y.fillRect(he-Ae/2,pe-Ie/2,Ae,Ie))),"shape"===d&&(u?function(qe,Le,He,Je,et,Te){switch(qe.fillStyle=Te,et){case"square":return qe.fillRect(Le-Je,He-Je,2*Je,2*Je);case"circle":return am(qe,Le,He,Je,Te);case"cross":return(Re=qe).fillRect((Ze=Le)-(dt=Je),(Qe=He)-.31*dt,2*dt,2*dt*.31),void Re.fillRect(Ze-.31*dt,Qe-dt,2*dt*.31,2*dt);case"diamond":return function(Re,Ze,Qe,dt){Re.beginPath(),Re.moveTo(Ze-dt,Qe),Re.lineTo(Ze,Qe-dt),Re.lineTo(Ze+dt,Qe),Re.lineTo(Ze,Qe+dt),Re.fill()}(qe,Le,He,Je);case"equilateral":return function(Re,Ze,Qe,dt){Re.beginPath(),Re.moveTo(Ze,Qe-dt),Re.lineTo(Ze+Y_*dt,Qe+K_*dt),Re.lineTo(Ze+X_*dt,Qe+$_*dt),Re.lineTo(Ze+J_*dt,Qe+em*dt),Re.lineTo(Ze+Q_*dt,Qe+tm*dt),Re.fill()}(qe,Le,He,Je);case"star":!function(Re,Ze,Qe,dt){Re.beginPath(),Re.moveTo(Ze,Qe-dt),Re.lineTo(Ze+X_*dt,Qe+$_*dt),Re.lineTo(Ze+Q_*dt,Qe+tm*dt),Re.lineTo(Ze+Y_*dt,Qe+K_*dt),Re.lineTo(Ze+J_*dt,Qe+em*dt),Re.fill()}(qe,Le,He,Je)}var Re,Ze,Qe,dt}(o,M,w,v,j,V):(Le=M,He=w,Je=y,et=b,Te=j,(qe=o).fillStyle=Re=V,"line"===Te&&qe.fillRect(Le-Je/2,He-et/4,Je,et/2),"arrow"===Te?((Ze=qe).fillRect((Qe=Le)-(Ht=Je)/2,(dt=He)-(Kt=et)/4,Ht*(1-Vc),Kt/2),Ze.beginPath(),Ze.moveTo(Qe+Ht*(1-Vc-.5),dt-Kt/2),Ze.lineTo(Qe+Ht*(1-Vc-.5),dt+Kt/2),Ze.lineTo(Qe+Ht/2,dt),Ze.fill()):"dashed"===Te||"dotted"===Te?function(Ze,Qe,dt,Ht,Kt,ln,an){Ze.beginPath(),Ze.moveTo(Qe-Ht/2,dt),Ze.lineTo(Qe+Ht/2,dt),Ze.strokeStyle=ln,Ze.lineWidth=Kt/2,Ze.setLineDash("dashed"===an?G1:Z1),Ze.stroke()}(qe,Le,He,Je,et,Re,Te):"tapered"===Te&&function(Ze,Qe,dt,Ht,Kt){Ze.beginPath(),Ze.moveTo(Qe-Ht/2,dt-Kt/2),Ze.lineTo(Qe-Ht/2,dt+Kt/2),Ze.lineTo(Qe+Ht/2,dt),Ze.fill()}(qe,Le,He,Je,et))),"icon.content"===d&&(We=M,vt=w,Tt=j,Nu(at=o,p,2*v,L,"center",g),at.fillText(Tt,We,vt)),"image"!==d&&"image.url"!==d||function(qe,Le,He,Je,et){if("undefined"!=typeof Image){qe._imgStore||(qe._imgStore={});var Te=qe._imgStore[et];if(Te)return qe.drawImage(Te,Le-Je,He-Je,2*Je,2*Je);(Te=new Image).src=et,Te.onload=function(){qe.drawImage(Te,Le-Je,He-Je,2*Je,2*Je)},qe._imgStore[et]=Te}}(o,M,w,v,j),function(qe,Le,He,Je,et,Te){var Re=et.join();if(Te)if(1===et.length)Re=Yo(et[0]);else{var Ze=_n(et),Qe=rn(et);Re=Yo(Ze)+" - "+Yo(Qe)}Nu(qe,Le.fontFamily,Le.fontSize,Le.fontColor),qe.fillText(Re,He,Je)}(o,e,N,w,Ge,P),w+=x})}function Nu(e,t,n,i,r,o){void 0===r&&(r="left"),void 0===o&&(o="normal"),e.textAlign=r,e.textBaseline="middle",e.fillStyle=i,e.font=o+" "+n+'px "'+t+'"'}function am(e,t,n,i,r){e.beginPath(),e.arc(t,n,i,0,2*Ho),e.fillStyle=r,e.fill()}function W1(e,t,n,i,r,o,a,s){for(var l,u,d,c,h,p,g=.7*e.fontSize,m=3*g,x=(g+m)/2,v=n+e.innerMargin+m,y=v+m+e.innerMargin,b=i+2*m-.5*e.innerMargin,S=e.circleStrokeWidth,w=0,M=[g,x,m];w<M.length;w++){var N=M[w];u=v,d=b-N,c=N,h=s,p=S,(l=t).beginPath(),l.arc(u,d,c,0,Wo),l.strokeStyle=h,l.lineWidth=p,l.stroke()}Nu(t,e.fontFamily,e.fontSize,e.fontColor,"left"),t.fillText(Yo(r),y,b+g-2*g),t.fillText(Yo(o),y,b+g-2*x),t.fillText(Yo(a),y,b+g-2*m)}function Y1(e,t,n,i,r,o,a,s){var l=(e.widgetWidth-2*e.innerMargin)/3,u=e.fontSize,d=i-e.innerMargin/2,c=d+2*u,h=n+e.innerMargin;t.fillStyle=s,t.fillRect(h,d-u/2,1+l,u),t.fillRect(h+l,d-u/3,1+l,u/1.5),t.fillRect(h+2*l,d-u/6,l,u/3),Nu(t,e.fontFamily,e.fontSize,e.fontColor,"center"),t.fillText(Yo(a),h+.5*l,c),t.fillText(Yo(o),h+1.5*l,c),t.fillText(Yo(r),h+2.5*l,c)}function J1(e,t,n){for(var i=null,r=0;r<t.length;++r){var o=t[r];o.isNode!==e.isNode&&1!==t.length||!(null===i||o.height<t[i].height)||(i=r)}(o=t[i]).content.push(e),o.height+=e.height+n.outerMargin}function Q1(e){for(var t=0,n=1;n<e.length;++n)e[n].height>e[t].height&&(t=n);return t}function K1(e,t){return e.isNode!==t.isNode?e.isNode?-1:1:e.title<=t.title?-1:1}function $1(e,t){return e.height-t.height}function eE(e,t){return e.isNode!==t.isNode?e.isNode?-1:1:t.height-e.height}function tE(e,t){return e.isNode!==t.isNode?e.isNode?-1:1:e.content[0].title<=t.content[0].title?-1:1}var sm,nE=(St(Di,sm=Pe),Di.prototype.enable=function(e){var t=this._settings;return this._settings=It({},im,e),this._mustRefresh=!this._enabled||!this._sameOptions(t,this._settings),this._enabled?Promise.resolve():(this._enabled=!0,this._graphics.addCanvas(this._canvas),this.refresh())},Di.prototype._afterNextUpdate=function(){var e=this;return new Promise(function(t){return e._promises.push(t)})},Di.prototype._formatSettings=function(e,t){var n=It({},im,e);return q1.forEach(function(i){return n[i]*=t}),n},Di.prototype.disable=function(){this._enabled&&(this._enabled=!1,this._graphics.removeCanvas(this._canvas))},Di.prototype.enabled=function(){return this._enabled},Di.prototype.refresh=function(){return this._mustRefresh=!0,this._dom.refresh(),this._afterNextUpdate()},Di.prototype.destroy=function(){this._enabled=!1,this._mustRefresh=!1,this._settings=null,this._promises=[]},Di.prototype.getOptions=function(){if(this.enabled)return It({},this._settings)},Di.prototype.getCurrentOptions=function(){return this._settings},Di.prototype._sameOptions=function(e,t){return e===t||Object.keys(e).reduce(function(n,i){return n&&e[i]===t[i]},!0)},Di.prototype._drawOnCanvas=function(e,t,n){var i=this._formatSettings(e,n);!function(e,t,n){var i={width:t.width,height:t.height},r=!1;!!(i.width&&i.height&&n)&&((r="top"===e.position||"bottom"===e.position?function(o,a,s,l){s=s.slice();for(var u=a.widgetWidth+a.outerMargin,d=Math.floor((o.width-a.outerMargin)/u),c=o.height-a.outerMargin,h=new Array(Math.min(d,s.length)),p=s.length,g=0,m=0,x=0,v=0,y=0;y<p;++y){var b=s[y];b.isNode?(g+=1,m+=b.height):(x+=1,v+=b.height)}var S=m+v,M=v/S,N=Math.round(m/S*d),D=Math.round(M*d);if(g<N?N=g:x<D&&(N=d-x),0===d)return!1;for(y=0;y<h.length;y++)h[y]={content:[],height:0,isNode:y<N};for(y=0;y<p;++y){var P=Q1(s);J1(s[P],h,a),s.splice(P,1)}h.every(function(re){return 1===re.content.length})?h.sort(tE):h.sort(eE);var L=a.outerMargin;for(y=0;y<h.length;++y){var V=h[y];if(V.height>c)return!1;V.content.sort($1);for(var X=0,J=0;J<V.content.length;++J){var se=V.content[J];se.x=L,se.y=l?o.height-X-se.height-a.outerMargin:X+a.outerMargin,X+=se.height+a.outerMargin}L+=u}return!0}(i,e,n,"bottom"===e.position):function(o,a,s,l){var u=a.widgetWidth+a.outerMargin,d=Math.floor((o.width-a.outerMargin)/u),c=o.height,h=a.outerMargin,p=l?a.outerMargin:o.width-u,g=1;s=s.slice().sort(K1);for(var m=0;m<s.length;++m){var x=s[m];if(h+x.height>c){if(h===a.outerMargin)return!1;h=a.outerMargin,g+=1,l?p+=u:p-=u}x.x=p,x.y=h,h+=x.height}return g<=d}(i,e,n,"left"===e.position))&&n.forEach(function(o){return H1(e,t,o)}))}(i,t,this._computeWidgetList(i))},Di.prototype.exportOnCanvas=function(e,t){return this._drawOnCanvas(t,e,1)},Di.prototype._computeWidgetList=function(e){var t=this,n=[];return U1.forEach(function(i){var a=t._computeWidget(e,i.name,i.isNode);a&&n.push(a)}),n},Di.prototype._computeWidget=function(e,t,n){var i=this._computePropertyMapping(e,t,n);if(i){if("icon.content"!==t)return i;var r=this._getRulesForAttribute(n,"icon.font"),o=this._getRulesForAttribute(n,"icon.style"),a=null,s=null;if(r.length||(a="Arial",s="normal"),"string"==typeof r[0]&&(a=r[0],s=o[0]),a)return i.iconFont=a,i.iconFontStyle=s,i}return null},Di.prototype._computePropertyMapping=function(e,t,n){var i,r,o,a,s,l,u,d=this._getRulesForAttribute(n,t)[0],c=d&&d.mapping,h=c&&c.getValues(n);if(c&&h){var p=c.getField(),g={};return _t(h,function(m,x){void 0!==m&&"undefined"!==x&&(g[m]=g[m]||[],g[m].push(x))}),0===Object.keys(g).length?null:{isNode:n,title:e.titleFunction(p),styleProperty:t,dataProperty:p,mapping:g,height:(i=g,r=t,o=n,s=(a=e).outerMargin+om(a),l=1.6*a.fontSize,u=s-.8*a.innerMargin,"radius"===r||"width"===r?u+l*(o?3:2):u+Object.keys(i).length*l)}}return null},Di.prototype._getRulesForAttribute=function(e,t){return this._styleRules.getRuleList().map(function(n){var i=n.getDefinition();return bn(e?i.nodeAttributes:i.edgeAttributes,t)}).filter(function(n){return n}).sort(function(n,i){return n.mapping&&i.mapping?0:n.mapping?-1:1})},Di);function Di(e){var t,n=e.graphics,i=e.dom,r=e.events,o=e.styleRules,a=sm.call(this)||this;return a._enabled=!1,a._mustRefresh=!1,a._settings=null,a._promises=[],a._graphics=n,a._dom=i,a._events=r,a._styleRules=o,a._canvas=ci(),a._ctx=a._canvas.getContext("2d"),a._events.on(((t={})[I.NEW_FRAME]=function(){if(a._enabled&&a._mustRefresh){a._ctx.clearRect(0,0,a._canvas.width,a._canvas.height),a._drawOnCanvas(a._settings,a._canvas,Ln());var s=a._promises;a._promises=[],s.forEach(function(l){return l()}),a._mustRefresh=!1}},t[I.RESIZE+" "+I.RELOAD_FONTS]=function(){a._mustRefresh=!0},t)),a}var um,lm={layer:3,outline:!0,outerStroke:{color:"red",width:5},innerStroke:{minVisibleSize:0},text:{backgroundColor:"rgb(220, 220, 220)",minVisibleSize:0}},iE={layer:3,outline:!0,color:"red",text:{backgroundColor:"rgb(220, 220, 220)",minVisibleSize:0}},rE=(St(Nr,um=Pe),Nr.prototype.setRate=function(e){this._delay=e},Nr.prototype.updateNodeAttributes=function(e,t){this._hoverClass.update({nodeAttributes:e,fullOverwrite:t}),this._hoverExtremityHighlightedClass.update({nodeAttributes:e,fullOverwrite:t}),this._updateExtremityHighlightLayer()},Nr.prototype.updateEdgeAttributes=function(e,t){this._hoverClass.update({edgeAttributes:e,fullOverwrite:t}),this._updateExtremityHighlightLayer()},Nr.prototype.onMounted=function(e){function t(){n._hoverExtremityHighlightedClass.clearNodes(),n._hoverClass.getEdges().getExtremities().addClass(oc)}var n=this;this._classes.onEdgeClassAdded(Ja,t),this._classes.onEdgeClassRemoved(Ja,t)},Nr.prototype._registerSettings=function(){var e=this;this._settings.register("cursor.node","pointer",function(t,n){e._hovered&&e._hovered.isNode&&(e._graphics.removeCursorStyle(n),e._graphics.addCursorStyle(t))}),this._settings.register("cursor.edge","pointer",function(t,n){e._hovered&&!e._hovered.isNode&&(e._graphics.removeCursorStyle(n),e._graphics.addCursorStyle(t))}),this._settings.register("nodeHover",!0,function(t){!t&&e._hovered&&e._hovered.isNode&&e._unhoverElement(e._hovered)}),this._settings.register("edgeHover",!0,function(t){t||!e._hovered||e._hovered.isNode||e._unhoverElement(e._hovered)})},Nr.prototype._updateExtremityHighlightLayer=function(){var e=this._hoverClass.getDefinition().edgeAttributes;this._hoverExtremityHighlightedClass.update({nodeAttributes:{layer:e?e.layer:void 0},fullOverwrite:!1})},Nr.prototype._removeTimeout=function(){this._timeout&&(this._dom.clearTimeout(this._timeout),this._timeout=null)},Nr.prototype._isAnimating=function(){return this._graphics.isAnimating()},Nr.prototype._hoverElement=function(e){var t=this;this._settings.get(e.isNode?"nodeHover":"edgeHover")&&!this._isAnimating()&&(this._removeTimeout(),this._timeout=this._dom.setTimeout(function(){t._isAnimating()||(t._setElementHighlight(!0,e),t._hovered=e),t._timeout=null},this._delay))},Nr.prototype._unhoverElement=function(e){this._removeTimeout(),this._hovered===e&&(this._setElementHighlight(!1,e),this._hovered=null)},Nr.prototype._setElementHighlight=function(e,t){var n=this._settings.get(t.isNode?"cursor.node":"cursor.edge");e?(this._graphics.addCursorStyle(n),t.addClass(Ja)):(this._graphics.removeCursorStyle(n),t.removeClass(Ja)),t.isNode&&e&&this._graph.getAttribute(t.isNode,"textHidden").set(t._index,!1)},Nr);function Nr(e){var t,n=e.dom,i=e.classes,r=e.captor,o=e.graph,a=e.graphics,s=e.settings,l=e.events,u=um.call(this)||this;return u._delay=100,u._manualTriggerDetection=!1,u._hovered=null,u._timeout=null,u._onAnimate=function(d){d.duration&&(u._manualTriggerDetection=!0,u._resetHover())},u._onBeforeNewFrame=function(){if(u._manualTriggerDetection&&!u._graphics.isAnimating()){u._manualTriggerDetection=!1,u._captor.triggerDetection();var d=u._captor.getPointedElement();d&&u._hoverElement(d)}},u._onClear=function(){u._hovered=null,u._timeout&&u._dom.clearTimeout(u._timeout)},u._resetHover=function(){u._hovered&&(u._unhoverElement(u._hovered),u._captor.triggerUnhover()),u._timeout&&(u._dom.clearTimeout(u._timeout),u._timeout=null)},u._dom=n,u._graph=o,u._graphics=a,u._settings=s,u._captor=r,u._events=l,u._classes=i,u._registerSettings(),u._hoverExtremityHighlightedClass=u._classes.createClass({name:oc,isBuiltin:!0,nodeAttributes:lm}),u._hoverClass=u._classes.createClass({name:Ja,isBuiltin:!0,nodeAttributes:lm,edgeAttributes:iE}),u._events.on(((t={})[I.HOVER]=function(d){return u._hoverElement(d.target)},t[I.UNHOVER]=function(d){return u._unhoverElement(d.target)},t[I.ANIMATE]=u._onAnimate,t[I.BEFORE_NEW_FRAME]=u._onBeforeNewFrame,t[I.MOUSE_LEAVE]=u._resetHover,t[I.CLEAR_GRAPH]=u._onClear,t)),u}var oE=function(){this.x=0,this.y=0},aE=(Lu.prototype.getValue=function(e,t){var n=e.isNode,i=n?this._nodeMapping:this._edgeMapping;i.valid||(i.values=this._computeMapping(n),i.valid=!0);var r=e.getData(this._field);return Array.isArray(r)?"color"===t?r.map(function(o){return i.values[o]}):i.values[r[0]]:i.values[r]},Lu.prototype.markAsInvalid=function(){this._nodeMapping.valid=!1,this._edgeMapping.valid=!1},Lu.prototype.getValues=function(e){return e?this._nodeMapping.values:this._edgeMapping.values},Lu.prototype.getField=function(){return this._field},Lu);function Lu(e,t){this._nodeMapping={valid:!1,values:null},this._edgeMapping={valid:!1,values:null},this._computeMapping=t,this._field=e}function dm(e,t,n){var i=(t?e.getNodes():e.getEdges()).getData(n),r={};return i.forEach(function(o){if(!Array.isArray(o))return r[o]=1;o.forEach(function(a){return r[a]=1})}),"undefined"in r&&delete r[void 0],Object.keys(r).sort()}function sE(e,t,n,i){for(var r=n.values,o=n.fallback,a=dm(e,i,t),s={},l=0,u=0;u<a.length;++u){var d=a[u];d in r?s[d]=r[d]:(s[d]=o[l],l=(l+1)%o.length)}return s}function uE(e,t,n,i){for(var r=n.fallback,o=n.stops,a=n.values,s=n.reverse,l=dm(e,i,t),u=1/0,d=-1/0,c=0;c<l.length;c++)jl(m=+l[c])&&(u=Math.min(u,m),d=Math.max(d,m),l[c]=m);var h={};if(!isFinite(u)){for(c=0;c<l.length;c++)h[l[c]]=r;return h}var p=function(v,y){var b=y.nbSlices,S=y.minValue,w=y.maxValue;if(Array.isArray(v))return v.slice();for(var M=v.min,N=void 0===M?S:M,D=v.max,P=((void 0===D?w:D)-N)/b,L=[],V=1;V<b;++V)L.push(N+P*V);return L}(o,{nbSlices:Array.isArray(a)?a.length:a.nbSlices,minValue:u,maxValue:d}),g=function(v,y){if(Array.isArray(v))return v;for(var b=v.min,w=y.length+1,M=(v.max-b)/y.length,N=[],D=0;D<w;D++)N.push(b+D*M);return N}(a,p);for(s&&g.reverse(),c=0;c<l.length;++c){var m=l[c];if(isFinite(m)){for(var x=0;x<p.length&&p[x]<=m;)x+=1;h[m]=g[x]}else h[m]=r}return h}var cm,lE=(St(js,cm=Pe),js.prototype.createMapping=function(e){var t=void 0===e?{field:""}:e,n=t.field,i=t.values,r=void 0===i?{}:i,o=t.fallback,a=void 0===o?void 0:o;if(n=Pr(n),Array.isArray(a)?0===a.length&&(a=[void 0]):a=[a],!Qr(r))throw new Error('"mapping" should be an object');return this._createMappingFunction(sE,n,{values:r,fallback:a})},js.prototype.createSlices=function(e){var t=void 0===e?{field:"",values:[]}:e,n=t.field,i=t.fallback,r=void 0===i?void 0:i,o=t.stops,a=void 0===o?{}:o,s=t.values,l=t.reverse,u=void 0!==l&&l;if(n=Pr(n),Array.isArray(s)||s.nbSlices||(s.nbSlices=7),Array.isArray(a)&&Array.isArray(s)&&a.length!==s.length-1)throw new Error("there should be exactly one more value that stops");return this._createMappingFunction(uE,n,{fallback:r,stops:a,values:s,reverse:u})},js.prototype._createMappingFunction=function(e,t,n){var i=this,r=new aE(t,function(a){return e(i._graph,t,n,a)});function o(a,s,l){return r.getValue(a,l)}return this._mappingList.push(r),o.mapping=r,o},js.prototype.createTemplate=function(e){if("string"!=typeof e)throw new TypeError('"template" should be a string');for(var t=[],n=0,i=!1;!i;){var r=-1,o=e.indexOf("{{",n);-1!==o&&(r=e.indexOf("}}",o+2)),-1!==r?(t.push(e.substring(n,o)),t.push(e.substring(o+2,r)),n=r+2):(t.push(e.slice(n)),i=!0)}return function(a){for(var s=t[0],l=1;l<t.length;l+=2)s+=a.getData(t[l]),s+=t[l+1];return s}},js);function js(e){var t,n=e.graph,i=e.events,r=e.styleRules,o=e.legend,a=cm.call(this)||this;return a._mappingList=[],a._graph=n,a._styleRules=r,a._events=i,a._legend=o,a._events.on(((t={})[[I.ADD_NODES,I.ADD_EDGES,I.UPDATE_NODE_DATA,I.UPDATE_EDGE_DATA,I.REMOVE_NODES,I.BEFORE_REMOVE_EDGES,I.EXCLUDED_STATE_CHANGE,I.CLEAR_GRAPH].join(" ")]=function(){if(a._mappingList.length){for(var s=0;s<a._mappingList.length;++s)a._mappingList[s].markAsInvalid();a._styleRules.refreshAllRules(),a._legend.refresh()}},t)),a}var Ao,Gs,hm=(Uc.prototype.run=function(e){var t=e.ogma,n=e.duration,i=this._getNodesToFilter(t),r=this._getEdgesToFilter(t,i);return Promise.all([i.addClass(xa,n),r.addClass(xa,n)]).then(function(){return i.setExcluded(!0),r.setExcluded(!0),{nodes:i,edges:r}})},Uc.prototype.undo=function(e){var t=e.duration,n=e.context,i=n.nodes,r=n.edges;return i.setExcluded(!1),r.setExcluded(!1),i.addClass(xa),r.addClass(xa),Promise.all([i.removeClass(xa,t),r.removeClass(xa,t)])},Uc);function Uc(e){var n=e.getEdgesToFilter;this._getNodesToFilter=e.getNodesToFilter,this._getEdgesToFilter=n}(Gs=Ao=Ao||{}).NodeFilter="node-filter",Gs.EdgeFilter="edge-filter",Gs.NodeCollapsing="node-collapsing",Gs.VirtualProperties="virtual-properties",Gs.NeighborGeneration="neighbor-generation",Gs.NeighborMerging="neighbor-merging";var pm,dE=(St(jc,pm=hm),jc.prototype.getName=function(){return Ao.NodeFilter},jc);function jc(e){return pm.call(this,{getNodesToFilter:function(t){return t.getNodes().filter(function(n){return!e(n)})},getEdgesToFilter:function(t,n){return n.getAdjacentEdges()}})||this}var fm,cE=(St(Gc,fm=hm),Gc.prototype.getName=function(){return Ao.EdgeFilter},Gc);function Gc(e){return fm.call(this,{getNodesToFilter:function(t){return t.createNodeList()},getEdgesToFilter:function(t){return t.getEdges().filter(function(n){return!e(n)})}})||this}function gm(e){return"object"!=typeof e?{criteria:e,enabled:!0,duration:0}:e}var _m,hE=(St(Kl,_m=Pe),Kl.prototype.addNodeFilter=function(e){var t=gm(e),n=t.criteria,i=Io(t,["criteria"]);return this._transformations.add(new dE(n),i)},Kl.prototype.addEdgeFilter=function(e){var t=gm(e),n=t.criteria,i=Io(t,["criteria"]);return this._transformations.add(new cE(n),i)},Kl);function Kl(e){var t=e.transformations,n=_m.call(this)||this;return n._transformations=t,n}var pE=(mm.prototype.destroy=function(){var e=this;Object.keys(this).forEach(function(t){var n=e[t];n instanceof Pe&&n.destroy(e._ogma)})},mm);function mm(e,t){var n=this;this._ogma=e,"webgl"===gg&&_u.cacheInitData(_u.createInitData()),this.settings=new Wx,this.events=new qx,this.dom=new k(this,t.dimensions),this.animations=new vb(this),this.camera=new jx(this),this.graph=new Py(this,e),this.data=new Xe(this),this.graphics=new Zx(this,e),this.individualAttributes=new Hx(this),this.algorithms=new wb(this),this.position=new oE,this.touch=new ab(this),this.mouse=new rb(this),this.virtualMouse=new $b(this),this.spatial=new tb(this),this.captor=new A1(this),this.interactions=new m1(this),this.classes=new Xx(this),this.cameraInteractions=new M1(this,!!t.debug),this.hover=new rE(this),this.keyboard=new V1(this),this.selection=new cb(this),this.styleRules=new n1(this),this.legend=new nE(this),this.sync=new hb(this),this.rules=new lE(this),this.transformations=new lb(this,e),this.filters=new hE(this),this.locate=new nb(this),this.grouping=new sb(this),this.pulses=new _b(this),this.drag=new w1(this),this.curvatureManager=new Cb(this),this.tasks=new Db(this),this.layouts=new Ub(this),this.watcher=new Hb(this),this.pathfinding=new Qb(this),this.rectangleSelect=new i1(this),this.labels=new _1(this,t),this.brand=new Sb(this),this.lasso=new A_(this),this.rewiring=new k1(this),this.resizing=new N1(this),this.snapping=new e1(this),this.connectNodes=new F1(this),this.tooltip=new B1(this),this.geo=new Ab(this),e.onReady(function(){Object.keys(n).forEach(function(i){var r=n[i];r instanceof Pe&&r.onMounted(n._ogma,t)})})}var vm=(ym.initNamespace=function(e){var t;e.algorithms=(t=e,{shortestPath:function(n){return t.modules.algorithms.shortestPath(n)},hasCycle:function(n){var i=void 0===n?{}:n;return null!==t.algorithms.detectCycle({nodes:i.nodes,edges:i.edges})},getAllSimpleCycles:function(n){var i=void 0===n?{}:n,r=i.nodes,o=i.edges;return r=r||t.getNodes(),o=o||r.getAdjacentEdges({bothExtremities:!0}),t.modules.algorithms.getAllSimpleCycles(r,o)},detectCycle:function(n){var i=void 0===n?{}:n,r=i.nodes,o=i.edges;return r=r||t.getNodes(),o=o||r.getAdjacentEdges({bothExtremities:!0}),t.modules.algorithms.detectCycle(r,o)}})},ym);function ym(){}var fE=(Fu.prototype.createClass=function(e,t){return this.modules.classes.createClass(Object.assign({},t,{name:e}))},Fu.prototype.updateClass=function(e,t){return this.modules.classes.getClassByName(e,!0).update(t)},Fu.prototype.getNodesByClassName=function(e){return this.modules.classes.getClassByName(e,!0).getNodes()},Fu.prototype.getEdgesByClassName=function(e){return this.modules.classes.getClassByName(e,!0).getEdges()},Fu);function Fu(){}var gE=(Zc.prototype.getHoveredElement=function(){return this.modules.captor.getPointedElement()},Zc.prototype.getPointerInformation=function(){return this.modules.captor.getCursorInformation()},Zc);function Zc(){}var xm=(bm.initNamespace=function(e){var t;e.debug=(t=e,{wait:function(n){return new Promise(function(i){return setTimeout(i,n)})},initRandomGraph:function(n){return t.generate.random(n).then(t.setGraph).then(function(){return t.view.locateGraph()}).then(function(){return t.view.afterNextFrame()})},initGrid:function(n){var i=Math.ceil(Math.sqrt(n));return t.generate.grid({rows:i,columns:i}).then(function(r){return t.setGraph(r)}).then(function(){return t.view.locateGraph()})},initLine:function(n){return t.setGraph({nodes:[{id:0,attributes:{x:0,y:0}},{id:1,attributes:n?{x:0,y:50}:{x:50,y:0}}],edges:[{id:0,source:1,target:0}]}),t.view.locateGraph()},initSingleNode:function(){return t.setGraph({nodes:[{id:0,attributes:{x:0,y:0}}],edges:[]}),t.view.locateGraph()},initContinuousRenderLoop:function(n){var i=void 0===n?{}:n,r=i.triggerKey,o=void 0===r?"r":r,a=i.start,s=void 0===a||a,l=function(){s&&t.modules.dom.beforeNextFrame().then(l)};document.addEventListener("keydown",function(u){u.key===o&&(s=!s,l())}),l()},appendToBody:function(){var n=document.createElement("div");n.style.position="absolute",n.style.top="0",n.style.left="0",n.style.bottom="0",n.style.right="0",document.body.appendChild(n),t.setContainer(n)},loadFile:function(n){return(n.endsWith(".gexf")?t.parse.gexfFromUrl(n):t.parse.jsonFromUrl(n)).then(function(i){return t.setGraph(i)}).then(function(){return t.view.locateGraph()}).then(function(){return t.view.afterNextFrame()})},enableLasso:function(n){t.events.onDragStart(function(){t.keyboard.isKeyPressed("ctrl")&&t.tools.lasso.enable(n)})},randomizeGraph:function(n){var i=void 0===n?{}:n,r=i.minX,o=void 0===r?0:r,a=i.minY,s=void 0===a?0:a,l=i.maxX,u=void 0===l?500:l,d=i.maxY,c=void 0===d?500:d;return t.getNodes().setAttributes(t.getNodes().map(function(){return{x:o+Math.random()*(u-o),y:s+Math.random()*(c-s)}}))}})},bm);function bm(){}var _E=(qc.prototype.setContainer=function(e){this.modules.dom.setContainer(e)},qc.prototype.getContainer=function(){return this.modules.dom.getContainer()},qc);function qc(){}var Em=(Sm.initNamespace=function(e){var t;e.events=(t=e,{removeListener:function(n){t.modules.events.removeListener(n)},onNodesAdded:function(n){return t.modules.events.on(I.ADD_NODES,n),t},onBeforeNodesRemoved:function(n){return t.modules.events.on(I.BEFORE_REMOVE_NODES,n),t},onNodesRemoved:function(n){return t.modules.events.on(I.REMOVE_NODES,n),t},onEdgesAdded:function(n){return t.modules.events.on(I.ADD_EDGES,n),t},onBeforeEdgesRemoved:function(n){return t.modules.events.on(I.BEFORE_REMOVE_EDGES,n),t},onEdgesRemoved:function(n){return t.modules.events.on(I.REMOVE_EDGES,n),t},onNodesClassAdded:function(n,i){return t.modules.classes.onNodeClassAdded(n,i),t},onNodesClassRemoved:function(n,i){return t.modules.classes.onNodeClassRemoved(n,i),t},onEdgesClassAdded:function(n,i){return t.modules.classes.onEdgeClassAdded(n,i),t},onEdgesClassRemoved:function(n,i){return t.modules.classes.onEdgeClassRemoved(n,i),t},onNodeDragStart:function(n){return t.modules.events.on(I.NODES_DRAG_START,n),t},onNodeDragProgress:function(n){return t.modules.events.on(I.NODES_DRAG_PROGRESS,n),t},onNodeDragEnd:function(n){return t.modules.events.on(I.NODES_DRAG_END,n),t},onKeyPress:function(n,i){return t.modules.keyboard.onKeyPress(n,i),t},onNodesSelected:function(n){return t.events.onNodesClassAdded(xi,n)},onNodesUnselected:function(n){return t.events.onNodesClassRemoved(xi,n)},onEdgesSelected:function(n){return t.events.onEdgesClassAdded(xi,n)},onEdgesUnselected:function(n){return t.events.onEdgesClassRemoved(xi,n)},onNodeDataChange:function(n){return t.modules.events.on(I.UPDATE_NODE_DATA,n),t},onEdgeDataChange:function(n){return t.modules.events.on(I.UPDATE_EDGE_DATA,n),t},onMouseMove:function(n){return t.modules.events.on(I.MOVE,n),t},onMouseButtonDown:function(n){return t.modules.events.on(I.DOWN,n),t},onMouseButtonUp:function(n){return t.modules.events.on(I.UP,n),t},onClick:function(n){return t.modules.events.on(I.CLICK,n),t},onDoubleClick:function(n){return t.modules.events.on(I.DOUBLE_CLICK,n),t},onMouseWheel:function(n){return t.modules.events.on(I.WHEEL,n),t},onHover:function(n){return t.modules.events.on(I.HOVER,n),t},onUnhover:function(n){return t.modules.events.on(I.UNHOVER,n),t},onDragStart:function(n){return t.modules.events.on(I.DRAG_START,n),t},onDragProgress:function(n){return t.modules.events.on(I.DRAG_PROGRESS,n),t},onDragEnd:function(n){return t.modules.events.on(I.DRAG_END,n),t},onGestureStart:function(n){return t.modules.events.on(I.GESTURE_START,n),t},onGestureProgress:function(n){return t.modules.events.on(I.GESTURE_PROGRESS,n),t},onGestureEnd:function(n){return t.modules.events.on(I.GESTURE_END,n),t},onRendererStateChange:function(n){return t.modules.events.on(I.RENDERER_STATE_CHANGE,n),t},onZoomProgress:function(n){return t.modules.events.on(I.CAMERA_ZOOM,n),t},onViewChanged:function(n){return t.modules.events.on(I.VIEW_CHANGED,n),t},onNodesConnected:function(n){return t.modules.events.on(I.CONNECT_NODES,n),t},onGeoModeEnabled:function(n){return t.modules.events.on(I.GEO_ENABLED,n),t},onGeoModeDisabled:function(n){return t.modules.events.on(I.GEO_DISABLED,n),t},onGeoModeLoaded:function(n){return t.modules.events.on(I.GEO_LOADED,n),t},onLayoutStart:function(n){return t.modules.events.on(I.LAYOUT_START,n),t},onLayoutComplete:function(n){return t.modules.events.on(I.LAYOUT_END,n),t},onLayoutComputed:function(n){return t.modules.events.on(I.LAYOUT_COMPUTED,n),t},onTooltipShown:function(n){return t.modules.events.on(I.TOOLTIP_SHOW,n),t},onTooltipHidden:function(n){return t.modules.events.on(I.TOOLTIP_HIDE,n),t}})},Sm);function Sm(){}function Am(e){return e instanceof _o?e.getId():e}function wm(e){return e instanceof na?e.getId():e}function Cm(e){return e instanceof or?e.getId():e instanceof _o?[e.getId()]:li(e)?e.map(Am):[Am(e)]}function Tm(e){return e instanceof vs?e.getId():e instanceof na?[e.getId()]:li(e)?e.map(wm):[wm(e)]}function Zs(e,t,n){if(null!=e)return Array.isArray(e)?e[0]:"source"===e?Zs(n.color.get(t.getSource()._index)):"target"===e?Zs(n.color.get(t.getTarget()._index)):e}function Hc(e){return null==e?null:"string"==typeof e||"number"==typeof e?""+e:e&&Hc(e.content)}var mE=["color","radius","shape","text.content","x","y"],vE=["color","width","shape.type","text.content"];function Mm(e,t,n,i){var r,o,a,s,l=(o=i,(r=t)?Cm(r):"object"==typeof o?Cm(o.nodes):o),u=(s=i,(a=n)?Tm(a):"object"==typeof s?Tm(s.edges):s);return{nodes:e.getNodes(l),edges:e.getEdges(u)}}function Im(e,t){var n=t.nodeAttributes,i=t.edgeAttributes,s=t.nodeData,l=t.edgeData,u=Mm(e,t.nodes,t.edges,t.filter);return{nodes:u.nodes.toJSON({attributes:n,data:s}),edges:u.edges.toJSON({attributes:i,data:l})}}function $l(e,t,n){var i,r,o,a,s,l=n.styles,u=n.nodes,d=n.edges,c=n.filter,g="all"!==l?{nodes:["x","y"],edges:[]}:{nodes:mE,edges:vE},m=Im(e,{nodeAttributes:g.nodes,edgeAttributes:g.edges,nodes:u,edges:d,filter:c,nodeData:n.nodeData,edgeData:n.edgeData});if("original"===l){for(var x=(i=t,o=(r=Mm(e,u,d,c)).nodes,a=r.edges,s=i.getOriginalAttributes(),{nodes:o.reduce(function(N,D){return N[D.getId()]={x:s.nodes.x.get(D._index),y:s.nodes.y.get(D._index),color:Zs(s.nodes.color.get(D._index)),radius:s.nodes.radius.get(D._index),shape:s.nodes.shape.get(D._index),text:{content:s.nodes.text.content.get(D._index)}},N},{}),edges:a.reduce(function(N,D){return N[D.getId()]={color:Zs(s.edges.color.get(D._index)),width:s.edges.width.get(D._index),shape:{type:s.edges.shape.type.get(D._index)},text:{content:s.edges.text.content.get(D._index)}},N},{})}),v=0,y=m.nodes;v<y.length;v++){var b=y[v];b.attributes=x[b.id]}for(var S=0,w=m.edges;S<w.length;S++){var M=w[S];M.attributes=x[M.id]}}return"all"===l&&m.edges.forEach(function(N){var P=N.target,L=N.attributes;"source"===L.color&&(L.color=e.getNode(N.source).getAttribute("color")),"target"===L.color&&(L.color=e.getNode(P).getAttribute("color"))}),function(e){return{nodes:e.nodes.map(function(t){var i=t.attributes,r=void 0===i?{}:i,o=t.data,s=r.radius,l=r.shape,u=r.text;return{id:t.id,x:r.x,y:r.y,color:Zs(r.color),size:s,shape:l,text:Hc(u),data:o}}),edges:e.edges.map(function(t){var o=t.attributes,a=void 0===o?{}:o,s=t.data,u=a.width,d=a.text,c=a.shape;return{id:t.id,source:t.source,target:t.target,color:Zs(a.color),size:u,shape:function(h){if(null!=h)return"string"==typeof h?h:h.type}(c),text:Hc(d),data:s}})}}(m)}function km(e,t){return null==e||Array.isArray(e)&&!e.length?t:e}function xE(e){return"string"==typeof e}function bE(e,t,n,i){for(var r="edges"===t,o={},a=function(u){var d=f(km(n(u),t));if(!d.every(xE))throw Error("The tab "+t+" function returned an invalid value.");var c=f(i(u.data,d));d.forEach(function(h,p){var g=km(c[p],{}),m=rl(It({},g,{id:u.id},r?{source:u.source,target:u.target}:{})).reduce(function(x,v){var b=v.value;return x[v.path.join(".")]=b,x},{});o[h]=o[h]||[],o[h].push(m)})},s=0,l=e;s<l.length;s++)a(l[s]);return o}function EE(e){if(!e.length)return[];for(var t=function(l){for(var u=It({},l[0]),d=0,c=l;d<c.length;d++)for(var p=0,g=Object.keys(c[d]);p<g.length;p++){var m=g[p];m in u||(u[m]=void 0)}return Object.keys(u)}(e),n=-1<t.indexOf("source")?["id","source","target"]:["id"],i=n.concat(t.filter(function(l){return-1===n.indexOf(l)})),r=[i],o=function(l){r.push(i.map(function(u){return l[u]}))},a=0,s=e;a<s.length;a++)o(s[a]);return r}function AE(e){return{csv:function(t){var n=un("string"==typeof t?{what:t}:t,wE),i=n.what,r=n.dataProperties,s=n.separator,l=n.textSeparator,u=n.download,h=n.filename,g=$l(e.modules.graph,e.modules.individualAttributes,{styles:"none",nodes:n.nodes,edges:n.edges,filter:n.filter,nodeData:n.nodeData,edgeData:n.edgeData});try{var m=function(x,v){var y=v.what,b=v.separator,S=v.textSeparator,w=v.dataProperties,M=new RegExp(""+S,"g");if(S&&'"'!==S&&"'"!==S)throw new TypeError('Invalid argument :"textSeparator" is not single-quote or double-quote, was '+S);if("nodes"!==y&&"edges"!==y)throw new TypeError('missing argument: "what": should have value "nodes" or "edges"');var D="nodes"===y;return function(e,t,n){for(var i=new Ap,r=t?1:3,o=[],a=function(u){var d=e[u],c=new Array(r),h=d.data;if(n){var p={};n.forEach(function(b){var S=Pr(b),w=function(M,N){for(var D=0;D<N.length;++D){if(null==M)return;M=M[N[D]]}return M}(h,S);!function(M,N,D){for(var P=0;P<N.length-1;++P){var L=N[P],V=M[L];void 0===V&&(M[L]=V={}),M=V}M[N[N.length-1]]=D}(p,S,w)}),h=p}var g=rl(h);c[0]=d.id,t||(c[1]=d.source,c[2]=d.target);for(var m=0;m<g.length;++m){var x=g[m],v=x.path,y=x.value;v.length&&(i.has(v)?c[i.get(v)]=y:(i.set(v,r),c[r]=y,r++))}o.push(c)},s=0;s<e.length;++s)a(s);var l=[];return l.push("id"),t||(l.push("source"),l.push("target")),i.keys().forEach(function(u){return l.push(u[u.length-1])}),o.unshift(l),o.forEach(function(u){return u.length=r}),o}(D?x.nodes:x.edges,D,w).map(function(P){return P.map(function(L){return function(P){return P=(L=P)instanceof Date?L.toISOString():""+L,S+P.replace(M,"\\$&")+S;var L}(L)})}).map(function(P){return P.join(b)}).join("\n")}(g,{what:i,separator:s,textSeparator:l,dataProperties:r});return u&&cn(m,h,"text"),Promise.resolve(m)}catch(x){return Promise.reject(x)}}}}var wE={what:void 0,dataProperties:void 0,separator:",",textSeparator:'"',download:!0,filename:"graph.csv",filter:"visible",nodes:void 0,edges:void 0,nodeData:function(e){return e},edgeData:function(e){return e},styles:"none"};var TE={creator:void 0,description:void 0,styles:"all",download:!0,filename:"graph.gexf",nodes:void 0,edges:void 0,nodeData:function(e){return e},edgeData:function(e){return e},filter:"visible"};function qs(e){return Math.round(255*e)}function Om(e,t){if("integer"===t&&"number"==typeof e){if(e%1!=0)return"float"}else if("number"!=typeof e)return"boolean"==typeof e?"boolean":"string";return t}function Wc(e){return"object"==typeof e&&null!==e&&e.constructor===Object}function Yc(e,t){return void 0===t&&(t={}),_t(e,function(n,i){Wc(n)?Yc(n,t):t[i]=n}),t}function ME(e){return{graphml:function(t){void 0===t&&(t={});var n=un(t,IE),i=n.styles,a=n.download,s=n.filename,l=n.graphId,u=n.directedEdges,p=function(g,m){var x=new ou,v=Lp();function y(J){return x.toHexa(J)}function S(J,se,re,j,Y){re=re||{};var he=v.createElement(se);for(var pe in re)if(re.hasOwnProperty(pe)){var Ae=re[pe];void 0!==Ae&&he.setAttribute(pe,Ae)}return void 0===j&&!Y||("[object Object]"===Object.prototype.toString.call(j)&&(j=JSON.stringify(j)),he.appendChild(v.createTextNode(j))),J.appendChild(he),he}var w=["id","source","target"],M=["size","x","y","shape","text","color"],N={size:{for:"all",type:"double"},x:{for:"node",type:"double"},y:{for:"node",type:"double"},shape:{for:"all",type:"string"},color:{for:"all",type:"string"},r:{for:"all",type:"int"},g:{for:"all",type:"int"},b:{for:"all",type:"int"},a:{for:"all",type:"double"},text:{for:"all",type:"string"}};m.noStyles&&(delete N.color,delete N.r,delete N.g,delete N.b,delete N.a,delete N.shape,M.pop());var D=[],P=[];function L(J,se){var re={id:J.id};M.forEach(function(j){var Y=J[j];"y"===j&&Y&&(Y=-parseFloat(Y)),void 0!==Y&&(re[("edge"===se?"edge_":"")+j]=Y,"color"===j&&function(J,se){var j=x.parseColor(se);J.r=j[0],J.g=j[1],J.b=j[2]}(re,Y))}),_t(J.data||{},function(j,Y){-1===M.indexOf(Y)&&-1===w.indexOf(Y)&&(N[Y]?N[Y].for!==se&&(N[Y].for="all"):N[Y]={for:se,type:"string"},re[Y]=j)}),"edge"===se?(re.source=J.source,re.target=J.target,P.push(re)):D.push(re)}g.nodes.forEach(function(J){return L(J,"node")}),g.edges.forEach(function(J){return L(J,"edge")});var V=S(v,"graphml",{xmlns:"http://graphml.graphdrawing.org/xmlns","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xsi:schemaLocation":"http://graphml.graphdrawing.org/xmlns http://www.yworks.com/xml/schema/graphml/1.1/ygraphml.xsd","xmlns:y":"http://www.yworks.com/xml/graphml","xmlns:java":"http://www.yworks.com/xml/yfiles-common/1.0/java","xmlns:sys":"http://www.yworks.com/xml/yfiles-common/markup/primitives/2.0","xmlns:x":"http://ww.yworks.com/xml/yfiles-common/markup/2.0"});_t(N,function(J,se){"node"!==J.for&&"all"!==J.for||S(V,"key",{"attr.name":se,"attr.type":J.type,for:"node",id:se}),"edge"!==J.for&&"all"!==J.for||S(V,"key",{"attr.name":se,"attr.type":J.type,for:"edge",id:"edge_"+se})}),S(V,"key",{id:"nodegraphics",for:"node","yfiles.type":"nodegraphics","attr.type":"string"}),S(V,"key",{id:"edgegraphics",for:"edge","yfiles.type":"edgegraphics","attr.type":"string"});var X=S(V,"graph",{edgedefault:m.directedEdges||void 0===m.directedEdges?"directed":"undirected",id:m.graphId?m.graphId:"G","parse.nodes":g.nodes.length,"parse.edges":g.edges.length,"parse.order":"nodesfirst"});return D.forEach(function(J){var j,Y,he,se=S(X,"node",{id:J.id});j=J,Y=S(se,"data",{key:"nodegraphics"}),he=S(Y,"y:ShapeNode"),S(he,"y:Geometry",{x:j.x,y:j.y,width:j.size,height:j.size}),m.noStyles||S(he,"y:Fill",{color:y(j.color),transparent:!1}),S(he,"y:NodeLabel",null,j.text||""),S(he,"y:Shape",{type:j.shape}),_t(J,function(re,j){-1===w.indexOf(j)&&S(se,"data",{key:j},re,!0)})}),P.forEach(function(J){var se,re,j,Y=S(X,"edge",{id:J.id,source:J.source,target:J.target});se=J,re=S(Y,"data",{key:"edgegraphics"}),j=S(re,"y:PolyLineEdge"),S(j,"y:LineStyle",{type:se.edge_type,color:m.noStyles?void 0:y(se.edge_color),width:se.edge_size}),S(j,"y:EdgeLabel",null,se.edge_label),_t(J,function(he,pe){-1===w.indexOf(pe)&&S(Y,"data",{key:pe},he,!0)})}),'<?xml version="1.0" encoding="UTF-8"?>\n'+Pd(v)}($l(e.modules.graph,e.modules.individualAttributes,{styles:i,nodes:n.nodes,edges:n.edges,filter:n.filter,nodeData:n.nodeData,edgeData:n.edgeData}),{graphId:l,directedEdges:u,noStyles:"none"===i});return a&&cn(p,s,"text"),Promise.resolve(p)}}}var IE={graphId:"G",directedEdges:!0,styles:"all",download:!0,filename:"graph.graphml",nodes:void 0,edges:void 0,nodeData:function(e){return e},edgeData:function(e){return e},filter:"visible"},kE={nodeAttributes:["x","y","color","radius","shape","text"],edgeAttributes:["color","width","text"],nodeData:function(e){return e},edgeData:function(e){return e},filter:"visible",pretty:!1,download:!0,filename:"graph.json"};function Nm(e,t){var n=e.view.get(),i="number"==typeof t.margin?t.margin:0,r={pixelRatio:1,angle:0,backgroundColor:null,zoom:0,x:0,y:0,width:0,height:0,hideImages:!1};if(t.width&&t.height?(r.width=t.width,r.height=t.height):(r.width=n.width,r.height=n.height),t.clip)r.zoom=n.zoom,r.x=n.x,r.y=n.y;else{var o=e.getNodes(t.filter),a=o.getBoundingBox().computeForZoom(n.zoom).extend(Cr.fromValues(o.getAttribute("x"),o.getAttribute("y"),o.map(function(p){return p.getAttribute("radius")+p.getAttribute("innerStroke.width")+p.getAttribute("outerStroke.width")})));if(t.texts){var s=e.modules.labels.getTextsBoundingBox();s.isValid()&&a.extend(s)}if(!isFinite(t.width)||!isFinite(t.height)){var l=e.view.graphToScreenCoordinates(a.bottomLeft()),u=e.view.graphToScreenCoordinates(a.topRight()),d=u.x-l.x,c=u.y-l.y,h=Math.min(r.width/d,r.height/c);r.width=d*h,r.height=c*h}r.x=a.cx,r.y=a.cy,r.width=Math.max(r.width,2*i+1),r.height=Math.max(r.height,2*i+1),r.zoom=Math.min((r.width-2*i)/a.width,(r.height-2*i)/a.height)}return e.modules.geo.isEnabled()?r.backgroundColor=null:void 0!==t.background&&(r.backgroundColor=t.background),r}function Xc(e,t,n,i,r){void 0===r&&(r=!1);var o=It({},n,{renderBackground:!1,hideImages:r,angle:n.angle||0,isBufferDisplayable:function(l){return t.texts||!Df(l)}}),a={};if(!1===t.badges){var s={text:null,image:null};a.badges={topLeft:s,topRight:s,bottomRight:s,bottomLeft:s}}return e.styles.getClass(Qa).update({nodeAttributes:a}),e.modules.graphics.export(i,o,t.filter,t)}function ed(e){return{download:!0,filter:"visible",filename:"graph."+e,clip:!1,margin:10,width:void 0,height:void 0,background:null,badges:!0,legend:void 0,texts:!0,images:!0,textWatermark:{content:null,fontFamily:"Arial",fontSize:48,fontStyle:null,fontColor:"red",repeat:!1,angle:0,alpha:.65,space:50,x:void 0,y:void 0},imageWatermark:{url:null,width:void 0,height:void 0,repeat:!1,angle:0,alpha:.65,space:50,x:void 0,y:void 0},imageCrossOrigin:void 0}}var OE={png:ed("png"),jpg:ed("jpg"),tiff:ed("tiff"),gif:ed("gif")};function NE(e){var t=e.canvas,n=e.parameters;return n.textWatermark.content&&Fm(t,n.textWatermark,RE,zE),n.imageWatermark.url?_s(n.imageWatermark.url).then(function(i){return i&&(n.imageWatermark.content=i,Fm(t,n.imageWatermark,VE,BE)),e}):e}function LE(e){var n=e.canvas,i=e.parameters,r=e.ogma.modules.legend,o=null;return void 0===i.legend&&(o=!!r.enabled()&&r.getCurrentOptions()),!0===i.legend&&(o={}),o&&r.exportOnCanvas(n,o),e}function FE(e){var t=e.ogma,n=e.view;return t.modules.geo.isEnabled()?t.modules.geo.exportBackground(n).then(function(i){var r=Lm(e.view),o=r.getContext("2d");return o.drawImage(i,(n.width-i.width)/2,(n.height-i.height)/2),o.drawImage(e.canvas,0,0),e.canvas=r,e}):e}function PE(e){var t=e.ogma,n=e.parameters,r=e.view,o=e.canvas.getContext("2d");return Xc(t,n,r,"canvas",!n.images).then(function(a){try{return a.getContext("2d").getImageData(0,0,1,1),o.drawImage(a,0,0),e}catch(s){return eo(s),Xc(t,n,r,"canvas",!0).then(function(l){return o.drawImage(l,0,0),e})}})}function DE(e){var n=e.parameters,r=e.canvas.toDataURL("image/"+e.type);return n.download&&cn(r,n.filename,"dataURL"),r}function Lm(e){var t=e.width,n=e.height,i=ci();return i.width=t,i.height=n,i}function td(e,t,n){null===(t=un(t,OE[n])).background&&(t.background=e.modules.graphics.getTransparentBackgroundColor());var i=Nm(e,t),r={ogma:e,parameters:t,canvas:Lm(i),view:i,type:n};return Promise.resolve(r).then(FE).then(PE).then(NE).then(LE).then(DE)}function RE(e,t,n,i){e.textAlign="center",e.textBaseline="middle",e.fillText(t,n,i)}function zE(e,t,n){return{width:e.measureText(t).width,height:n}}function BE(e,t,n,i,r){return{width:void 0===i?t.width:i,height:void 0===r?t.height:r}}function VE(e,t,n,i,r,o){e.drawImage(t,n-r/2,i-o/2,r,o)}function Fm(e,t,n,i){if(t){if("object"!=typeof t)t={content:t};else if(!t.content)return;var r=t.fontFamily,o=t.fontSize,a=t.fontStyle,s=t.fontColor,l=t.repeat,u=t.angle,d=t.alpha,c=t.space,h=t.content,p=e.getContext("2d"),g=e.width,m=e.height,x=void 0===t.x?g/2:t.x,v=void 0===t.y?m/2:t.y,y=t.height,b=t.width;u=u/180*Math.PI,da(p,r,o,a),p.fillStyle=s,p.globalAlpha=d;var S=i(p,h,o,b,y);if(l){var w=S.width+c,M=S.height+c,N=Math.sqrt(g*g+m*m);p.save(),p.translate(0,0),p.rotate(u);for(var D=0;D<N;D+=w)for(var P=0;P<N;P+=M)n(p,h,D,P,S.width,S.height),0!==P&&n(p,h,D,-P,S.width,S.height);p.restore()}else p.save(),p.translate(x,v),p.rotate(u),n(p,h,0,0,S.width,S.height),p.restore()}}var jE={download:!0,filename:"graph.svg",width:void 0,height:void 0,background:null,texts:!0,images:!0,badges:!0,embedFonts:!1,clip:!1,margin:10,prefix:"ogma"};var ZE={what:void 0,dataProperties:void 0,filter:"visible",nodes:void 0,edges:void 0,download:!0,filename:"graph.xlsx",tab:void 0,nodeData:void 0,edgeData:void 0};function qE(e,t){for(var n,i={},r={s:{c:1e7,r:1e7},e:{c:0,r:0}},o=0;o!==t.length;++o)for(var a=t[o],s=0;s!==a.length;++s){var l=a[s];r.s.r>o&&(r.s.r=o),r.s.c>s&&(r.s.c=s),r.e.r<o&&(r.e.r=o),r.e.c<s&&(r.e.c=s);var u={v:void 0===(n=l)?"":n instanceof Date?n.toISOString():""+n};i[e.utils.encode_cell({c:s,r:o})]=u}return r.s.c<1e7&&(i["!ref"]=e.utils.encode_range(r)),i}var HE=function(){this.SheetNames=[],this.Sheets={}};function WE(e){return e.styles.createClass({name:Qa,isBuiltin:!0}),It({},AE(e),function(e){return{gexf:function(t){void 0===t&&(t={});var n=un(t,TE),a=n.download,s=n.filename,l=n.creator,u=n.description,p=function(g,m){var x,v=new ou,y=Np(),b={},S={},w=0,M=0,N=y.createElement("gexf");N.setAttribute("xmlns","http://www.gexf.net/1.2draft"),N.setAttribute("xmlns:viz","http://www.gexf.net/1.2draft/viz"),N.setAttribute("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance"),N.setAttribute("xsi:schemaLocation","http://www.gexf.net/1.2draft http://www.gexf.net/1.2draft/gexf.xsd"),N.setAttribute("version","1.2");var D=y.createElement("meta");if(D.setAttribute("lastmodifieddate",U()),m.creator){var P=y.createElement("creator");x=y.createTextNode(""+m.creator),P.appendChild(x),D.appendChild(P)}if(m.description){var L=y.createElement("description");x=y.createTextNode(""+m.description),L.appendChild(x),D.appendChild(L)}var V=y.createElement("graph");V.setAttribute("mode","static");var X=y.createElement("nodes");g.nodes.forEach(function(j){var Y=y.createElement("node");if(Y.setAttribute("id",String(j.id)),j.text&&Y.setAttribute("label",_r(j.text)),Wc(j.data)){var he=Yc(j.data),pe=y.createElement("attvalues");Object.keys(he).forEach(function(We){We in b||(b[We]={id:w,type:"integer"},w++);var vt=he[We];b[We].type=Om(vt,b[We].type);var Tt=y.createElement("attvalue");Tt.setAttribute("for",b[We].id),Tt.setAttribute("value",_r(vt)),pe.appendChild(Tt)}),Y.appendChild(pe)}if(j.color){var Ae=v.parseColor(j.color),Ie=y.createElement("viz:color");Ie.setAttribute("r",qs(Ae[0])),Ie.setAttribute("g",qs(Ae[1])),Ie.setAttribute("b",qs(Ae[2])),Ie.setAttribute("a",Ae[3]),Y.appendChild(Ie)}var ot=y.createElement("viz:position");if(ot.setAttribute("x",j.x),ot.setAttribute("y",-j.y),Y.appendChild(ot),j.size){var at=y.createElement("viz:size");at.setAttribute("value",j.size),Y.appendChild(at)}X.appendChild(Y)});var J=y.createElement("attributes");J.setAttribute("class","node"),Object.keys(b).forEach(function(j){var Y=y.createElement("attribute");Y.setAttribute("id",b[j].id),Y.setAttribute("title",j),Y.setAttribute("type",b[j].type),J.appendChild(Y)});var se=y.createElement("edges");g.edges.forEach(function(j){var Y=y.createElement("edge");if(Y.setAttribute("id",j.id.toString()),Y.setAttribute("source",j.source),Y.setAttribute("target",j.target),j.size&&Y.setAttribute("weight",j.size),j.text&&Y.setAttribute("label",_r(j.text)),Wc(j.data)){var he=Yc(j.data),pe=y.createElement("attvalues");Object.keys(he).forEach(function(at){at in S||(S[at]={id:M,type:"integer"},M++);var We=he[at];S[at].type=Om(We,S[at].type);var vt=y.createElement("attvalue");vt.setAttribute("for",S[at].id),vt.setAttribute("value",_r(We)),pe.appendChild(vt)}),Y.appendChild(pe)}if(j.color){var Ae=v.parseColor(j.color),Ie=y.createElement("viz:color");Ie.setAttribute("r",qs(Ae[0])),Ie.setAttribute("g",qs(Ae[1])),Ie.setAttribute("b",qs(Ae[2])),Ie.setAttribute("a",Ae[3]),Y.appendChild(Ie)}if(j.size){var ot=y.createElement("viz:size");ot.setAttribute("value",j.size),Y.appendChild(ot)}se.appendChild(Y)});var re=y.createElement("attributes");return re.setAttribute("class","edge"),Object.keys(S).forEach(function(j){var Y=y.createElement("attribute");Y.setAttribute("id",S[j].id),Y.setAttribute("title",j),Y.setAttribute("type",S[j].type),re.appendChild(Y)}),V.appendChild(J),V.appendChild(re),V.appendChild(X),V.appendChild(se),N.appendChild(D),N.appendChild(V),y.appendChild(N),'<?xml version="1.0" encoding="UTF-8"?>'+y.serialize()}($l(e.modules.graph,e.modules.individualAttributes,{styles:n.styles,nodes:n.nodes,edges:n.edges,filter:n.filter,nodeData:n.nodeData,edgeData:n.edgeData}),{creator:l,description:u});return a&&cn(p,s,"text"),Promise.resolve(p)}}}(e),ME(e),{json:function(i){void 0===i&&(i={});var r=un(i,kE),d=r.pretty,c=r.download,h=r.filename,p=Im(n.modules.graph,{nodeAttributes:r.nodeAttributes,edgeAttributes:r.edgeAttributes,filter:r.filter,nodeData:r.nodeData,edgeData:r.edgeData}),g=d?JSON.stringify(p,null," "):JSON.stringify(p);return c&&cn(g,h,"text"),Promise.resolve(g)}},{png:function(i){return void 0===i&&(i={}),td(t,i,"png")},jpg:function(i){return void 0===i&&(i={}),td(t,i,"jpg")},tiff:function(i){return void 0===i&&(i={}),td(t,i,"tiff")},gif:function(i){return void 0===i&&(i={}),td(t,i,"gif")}},function(e){return{svg:function(t){return void 0===t&&(t={}),function(n,i){var r=(i=un(i,jE)).background,o=i.filename,a=i.download;null===r&&(i.background=n.modules.graphics.getTransparentBackgroundColor());var l=Nm(n,i);return Xc(n,i,l,"svg",!i.images).then(function(u){return u.removeAttribute("pointer-events"),u.setAttribute("version","1.1"),u.setAttributeNS(kn,"xmlns",ta),u.setAttributeNS(kn,"xmlns:xlink",lt),u}).then(function(u){return function(d,c,h){for(var p=c.childNodes[2],g=p.childNodes,m={},x=h.prefix,v=0;v<g.length;v++){var y=(j=g[v]).getAttribute(no);m[y]=m[y]||[],m[y].push(j)}var b=Object.keys(m),S=d.modules.graph,w=S.getNodeAttribute("id"),M=S.getEdgeAttribute("id"),N=fn("g",{class:x+"-edges"}),D=fn("g",{class:x+"-nodes"});for(v=0;v<b.length;v++){var P=b[v],L="n"===P.charAt(0),V=parseInt(P.substring(1)),X=m[P],J=_r((L?w:M).get(V).toString()),se=fn("g");se.setAttribute("data-"+(L?"node":"edge")+"-id",J),se.setAttribute("class",x+"-"+(L?"node":"edge"));for(var re=0;re<X.length;re++){var j=X[re];se.appendChild(j),j.removeAttribute(no)}(L?D:N).appendChild(se)}return p.appendChild(N),p.appendChild(D),c}(n,u,i)}).then(function(u){return c=i,h=function(p){for(var g=[].concat(Array.prototype.slice.call(p.getElementsByTagName("text")||[]),Array.prototype.slice.call(p.getElementsByTagName("tspan")||[])),m=[],x={},v=0;v<g.length;v++){var y=g[v].getAttribute("font-family");if("string"==typeof y)for(var b=y.split(","),S=0;S<b.length;S++){var w=b[S].replace(/['"]/g,"");""===w||x[w]||(x[w]=!0,m.push(w))}}return{list:m,map:x}}(d=u).map,xp().then(function(p){return p.filter(function(g){return h[g.name]})}).then(function(p){return bp(p,!!c.embedFonts)}).then(function(p){if(0!==p.length){for(var g=fn("style"),m=0;m<p.length;m++)g.appendChild(Ti(p[m]));d.childNodes[0].appendChild(g)}return d});var d,c,h}).then(function(u){var d='<?xml version="1.0" encoding="utf-8"?>'+Pd(u);return a&&cn(d,o,"text/xml"),d})}(e,t)}}}(t=n=e),function(e){return{xlsx:function(t){"string"==typeof t&&(t={what:t});var n=un(t,ZE),i=n.what,r=n.nodes,o=n.edges,a=n.tab,s=void 0===a?{nodes:void 0,edges:void 0}:a,l=n.download,u=n.filename,d=n.dataProperties,c=n.filter,h=n.nodeData,p=n.edgeData;s.nodes||(s.nodes=function(){return"nodes"}),s.edges||(s.edges=function(){return"edges"});var g=function(m,x){var v=x.what,y=x.tabFunctions,b=x.tabContentFunctions,S=bi("XLSX")||bi("xlsx",{throwOnError:!0}),w=new HE;if(v){if("nodes"!==v&&"edges"!==v)throw new TypeError('Invalid argument: "what" is not "nodes" or "edges", was '+v);"nodes"===v&&(m.edges=[]),"edges"===v&&(m.nodes=[])}for(var M={},N=0,D=["nodes","edges"];N<D.length;N++)for(var P=D[N],L=bE(m[P],P,y[P],b[P]),V=0,X=Object.keys(L);V<X.length;V++){var J=X[V];M[J]=(M[J]||[]).concat(L[J])}for(var se=0,re=Object.keys(M);se<re.length;se++)w.SheetNames.push(J=re[se]),w.Sheets[J]=qE(S,EE(M[J]));return gr([function(j){for(var Y=new ArrayBuffer(j.length),he=new Uint8Array(Y),pe=0;pe!==j.length;++pe)he[pe]=255&j.charCodeAt(pe);return Y}(S.write(w,{bookType:"xlsx",bookSST:!1,type:"binary"}))])}($l(e.modules.graph,e.modules.individualAttributes,{styles:"none",nodes:r,edges:o,filter:c,nodeData:function(m){return m},edgeData:function(m){return m}}),{what:i,tabFunctions:s,tabContentFunctions:{nodes:h||function(m){return Ra(qt(m||{}),d)},edges:p||function(m){return Ra(qt(m||{}),d)}}});return l&&cn(g,u,"blob"),Promise.resolve(g)}}}(e));var t,n}var Pm=(Dm.initNamespace=function(e){e.export=WE(e)},Dm);function Dm(){}var Rm_configure=function(e){var t,n=void 0===e?{}:e,i=n.children,r=void 0===i?2:i,o=n.height,a=void 0===o?3:o;if(!("number"==typeof(t=r)&&isFinite(t)&&0<t?t:void 0))throw new TypeError('Invalid argument: "children" is not a positive number, was '+r);if(!Gn(a))throw new TypeError('Invalid argument: "height" is not a positive number, was '+a);return{children:r,height:a}},Rm_generate=function(e){var t=e.children,n=e.height;n+=1;for(var i=Math.pow(t,n),r=[],o=[],a=1,s=0,l=0,u=0;u<n;++u){for(var d=i/(a+1)/1.5,c=0;c<a;++c){var h=s++;if(r.push({id:h,attributes:{x:(c+1)*d*10,y:20*u}}),u!==n-1)for(var p=0;p<t;++p)o.push({id:l,source:h,target:h*t+p+1}),l+=1}a*=t}return{nodes:r,edges:o}},zm_configure=function(e){var t=void 0===e?{}:e,n=t.nodes,i=void 0===n?40:n,r=t.m0,o=void 0===r?5:r,a=t.m,s=void 0===a?1:a,l=t.scale,u=void 0===l?100:l;if(!ma(i)||i<3)throw new TypeError("Invalid argument: options.nodes is not a number >= 3, was "+i);if(!ma(o)||i<=o)throw new TypeError("Invalid argument: options.m0 is not a number < "+i+", was "+o);if(!ma(o)||o<=s)throw new TypeError("Invalid argument: options.m is not a number <= "+o+", was "+s);if(!ma(u)||u<0)throw new TypeError("Invalid argument: options.scale is not a number or is less than 0");return{nodes:i,m0:o,m:s,scale:u}},zm_generate=function(e){for(var t=e.scale,n=e.nodes,i=e.m0,r=e.m,o={nodes:[],edges:[]},a={},s=[],l=t/10,u=0,d=0;d<i;d++)o.nodes.push({id:d,attributes:{x:Math.random()*l,y:Math.random()*l}}),s[d]=0;for(d=0;d<i;d++)for(var c=d+1;c<i;c++)a[(v={id:u++,source:d,target:c}).source+"-"+v.target]=v,o.edges.push(v),s[d]++,s[c]++;for(d=i;d<n;d++){o.nodes.push({id:d,attributes:{x:Math.random()*t,y:Math.random()*t}});var h=s[d]=0;for(c=0;c<d;c++)h+=s[c];for(var p=0,g=0;g<r;g++){var m=Math.random(),x=0;for(c=0;c<d;c++)if(!a[d+"-"+c]&&!a[c+"-"+d]&&m<=(x=1===d?1:x+s[c]/h+p/(d-g))){var v;p+=s[c]/h,a[(v={id:u++,source:d,target:c}).source+"-"+v.target]=v,o.edges.push(v),s[d]++,s[c]++;break}}}return o},Bm_configure=function(e){var t=void 0===e?{}:e,n=t.nodes,i=void 0===n?20:n,r=t.edges,o=t.p,a=t.scale,s=void 0===a?100:a;if(!ma(i)||i<3)throw new TypeError("Invalid argument: options.nodes is not a number >= 3, was "+i);if(void 0!==r&&void 0!==o)throw new TypeError("Invalid argument: choose between options.edges and options.p");return void 0===r&&void 0===o&&(o=.1),{nodes:i,edges:r,p:o,scale:s}},Bm_generate=function(e){var t={nodes:[],edges:[]},n=e.nodes,i=e.p,r=e.scale;if(0<=i)for(var o=0,a=0;a<n;a++){t.nodes.push({id:a,attributes:{x:Math.random()*r,y:Math.random()*r}});for(var s=0;s<a;s++)Math.random()<i&&t.edges.push({id:o++,source:a,target:s})}else{var l=[],u=e.edges;for(a=0;a<n;a++)for(t.nodes.push({id:a,attributes:{x:100*Math.random(),y:100*Math.random()}}),s=a+1;s<n;s++)l.push({source:a,target:s});for(o=l.length-1,a=0;a<u;a++){var d=l.splice(Math.floor(Math.random()*o),1)[0];d.id=a,t.edges.push(d),o--}}return t};function Vm(e){return 10*Math.pow(2.7,e)}function Um(e){return 5+Vm(e)/10}var jm_configure=function(e){var t=e.depth,n=void 0===t?3:t,i=e.breadth,r=void 0===i?3:i,o=e.nbNodes;return void 0!==o&&(r=5,n=Math.ceil(Math.log(o)/Math.log(5))),{depth:n,breadth:r,nbNodes:o}},jm_generate=function(e){var t=e.depth,n=e.breadth,i=e.nbNodes,r={id:0,attributes:{x:0,y:0,radius:Um(t+1)}},o={nodes:[r],edges:[]};return function a(s,l,u,d,c){if(0===u)return c;for(var h=Vm(u),p=Um(u),g=.2*p,m=-Math.PI,x=2*Math.PI/l,v=d.attributes.x,y=d.attributes.y,b=0;b<l;++b){var M={id:c,attributes:{x:v+h*Math.cos(m),y:y+h*Math.sin(m),radius:p}},N={id:c,source:d.id,target:c,attributes:{width:g}};s.nodes.push(M),s.edges.push(N),c=a(s,l,u-1,M,c+1),m+=x}return c}(o,n,t,r,1),void 0!==i&&(o.nodes=o.nodes.slice(0,i),o.edges=o.edges.slice(0,Math.max(i-1,0))),o},Gm_configure=function(e){var t=void 0===e?{}:e,n=t.rows,r=t.columns,a=t.columnDistance,l=t.rowDistance,d=t.xmin,h=t.ymin;return{rows:void 0===n?4:n,columns:void 0===r?4:r,columnDistance:void 0===a?20:a,rowDistance:void 0===l?20:l,xmin:void 0===d?0:d,ymin:void 0===h?0:h}},Gm_generate=function(e){for(var t=e.rows,n=e.columns,i=e.columnDistance,r=e.rowDistance,o=e.xmin,a=e.ymin,s={nodes:[],edges:[]},l=0,u=0;u<t;++u)for(var d=0;d<n;++d){var c=u*n+d;s.nodes.push({id:c,attributes:{x:o+d*i,y:a+u*r}}),d!==n-1&&(s.edges.push({id:l,source:c,target:u*n+d+1}),l++),u!==t-1&&(s.edges.push({id:l,source:c,target:(u+1)*n+d}),l++)}return s},Zm_configure=function(e){var t=void 0===e?{}:e,n=t.nodes,r=t.edges,a=t.texts,l=t.scale;return{nodes:void 0===n?10:n,edges:void 0===r?10:r,texts:void 0!==a&&a,scale:void 0===l?100:l}},Zm_generate=function(e){for(var t=e.nodes,n=e.edges,i=e.texts,r=e.scale,o=[],a=[],s=0;s<t;s++)o.push({id:s,attributes:{x:Math.random()*r,y:Math.random()*r,text:i?"Node "+s:void 0}});for(s=0;s<n;s++)a.push({id:s,source:Math.random()*t|0,target:Math.random()*t|0,attributes:{text:i?"Edge "+s:void 0}});return{nodes:o,edges:a}},qm_configure=function(e){var t=void 0===e?{}:e,n=t.nodes,i=void 0===n?50:n,r=t.width,o=void 0===r?100:r,a=t.height,s=void 0===a?100:a,l=t.x,u=void 0===l?0:l,d=t.y,c=void 0===d?0:d;if(!isFinite(i)||i<1)throw new RangeError("Tree generator: number of nodes must be a positive integer");return{nodes:i,width:o,height:s,x:u,y:c}},qm_generate=function(e){var t=e.nodes,r=e.width,o=e.height,a=e.x-r/2,s=e.y-o/2;return{nodes:new Array(t).fill(0).map(function(l,u){return{id:u,attributes:{x:a+Math.random()*r,y:s+Math.random()*o}}}),edges:new Array(t-1).fill(0).map(function(l,u){return{id:u,source:Math.floor(Math.sqrt(u)),target:u+1}})}},Hm_configure=function(e){var t=void 0===e?{}:e,n=t.length,r=t.scale;return{length:void 0===n?5:n,scale:void 0===r?100:r}},Hm_generate=function(e){var t=e.length,n=e.scale,i={nodes:[],edges:[]};if(t<=0)return i;i.nodes.push({id:0,attributes:{x:Math.random()*n,y:Math.random()*n}});for(var r=1;r<t;++r)i.nodes.push({id:r,attributes:{x:Math.random()*n,y:Math.random()*n}}),i.edges.push({id:r-1,source:r-1,target:r});return i},Wm=(Ym.initNamespace=function(e){e.generate={balancedTree:function(t){return Promise.resolve(Rm_generate(Rm_configure(t)))},barabasiAlbert:function(t){return Promise.resolve(zm_generate(zm_configure(t)))},erdosRenyi:function(t){return Promise.resolve(Bm_generate(Bm_configure(t)))},flower:function(t){return Promise.resolve(jm_generate(jm_configure(t)))},grid:function(t){return Promise.resolve(Gm_generate(Gm_configure(t)))},path:function(t){return Promise.resolve(Hm_generate(Hm_configure(t)))},random:function(t){return Promise.resolve(Zm_generate(Zm_configure(t)))},randomTree:function(t){return Promise.resolve(qm_generate(qm_configure(t)))}}},Ym);function Ym(){}var Xm=(Jm.initNamespace=function(e){var t;e.geo=(t=e,{enable:function(n){return t.modules.geo.enable(n)},disable:function(n){return t.modules.geo.disable(n)},setOptions:function(n){return t.modules.geo.setOptions(n)},getOptions:function(){return t.modules.geo.getOptions()},getMap:function(){return t.modules.geo.getMap()},enabled:function(){return t.modules.geo.isEnabled()},getCenter:function(){return t.modules.geo.getCenter()},getView:function(){return t.modules.geo.getView()},getZoom:function(){return t.modules.geo.getZoom()},setZoom:function(n){return t.modules.geo.setZoom(n)},setView:function(n,i,r){return t.modules.geo.setView(n,i,r)},setCenter:function(n,i){return t.modules.geo.setCenter(n,i)},toggle:function(n){return t.modules.geo.toggle(n)},resetCoordinates:function(){return t.modules.geo.resetCoordinates()},updateCoordinates:function(){return t.modules.geo.updateCoordinates()},getUnprojectedCoordinates:function(n){return t.modules.geo.getUnprojectedCoordinates(t.getNodes(n))}})},Jm);function Jm(){}function Pu(e,t,n,i,r){var o;void 0===i&&(i={}),void 0===r&&(r=!1),Array.isArray(n)||n instanceof(t?or:vs)||(n=[n]);var a=e.getElements(t,n);if(r||(a=a.dedupe()),!a.size)return Promise.resolve();t&&Pu(e,!1,a.getAdjacentEdges({filter:"all"}),i,!0);var s=i.virtual,l=void 0!==s&&s,u=a._indexes,d=e.storage.fetch(t),c=e.getCacheLists(t),h=d.getFlexArray("removed");if(Sn(d.getFlexArray("virtual").getMultiple(u))!==(l?u.length:0))throw new Error("Attempting to remove virtual elements; you should not do that");var p=((o={virtual:l})[t?"nodes":"edges"]=a,o);if(e.fireEvent(t?I.BEFORE_REMOVE_NODES:I.BEFORE_REMOVE_EDGES,p),c.visible.invalidList(),c.all.invalidList(),l||c.raw.invalidList(),e.setExcluded(a,!0),h.setMultiple(u,1),!t)for(var g=0;g<u.length;++g)e.topology.removeFromAdjacencyList(u[g]);return d.removeElements(u),e.setIndexFreeStep(1),e.fireEvent(t?I.REMOVE_NODES:I.REMOVE_EDGES,p),Promise.resolve()}var $E=(Ai.prototype.addNodes=function(e,t){return xs(this.modules.graph,!0,e,t)},Ai.prototype.addEdges=function(e,t){return xs(this.modules.graph,!1,e,t)},Ai.prototype.addNode=function(e,t){return Wu(this.modules.graph,!0,e,t)},Ai.prototype.addEdge=function(e,t){return Wu(this.modules.graph,!1,e,t)},Ai.prototype.removeNodes=function(e,t){return Pu(this.modules.graph,!0,e,t)},Ai.prototype.removeEdges=function(e,t){return Pu(this.modules.graph,!1,e,t)},Ai.prototype.removeNode=function(e,t){return Pu(this.modules.graph,!0,[e],t)},Ai.prototype.removeEdge=function(e,t){return Pu(this.modules.graph,!1,[e],t)},Ai.prototype.getNodes=function(e){return this.modules.graph.getNodes(e)},Ai.prototype.getEdges=function(e){return this.modules.graph.getEdges(e)},Ai.prototype.getNode=function(e){return this.modules.graph.getNode(e)},Ai.prototype.getEdge=function(e){return this.modules.graph.getEdge(e)},Ai.prototype.clearGraph=function(){this.modules.graph.clear()},Ai.prototype.setGraph=function(e,t){return this.modules.graph.clear(),this.addGraph(e,t)},Ai.prototype.addGraph=function(e,t){return n=this.modules.graph,s=void 0===(a=(i=e).nodes)?[]:a,u=void 0===(l=i.edges)?[]:l,void 0===(r=t)&&(r={}),r.batchSize?xs(n,!0,s,r).then(function(d){return o=d,xs(n,!1,u,r)}).then(function(d){return{nodes:o,edges:d}}):Promise.resolve({nodes:iu(n,!0,s,r),edges:iu(n,!1,u,r)});var n,i,r,o,a,s,l,u},Ai.prototype.createNodeList=function(){return this.getNodes([])},Ai.prototype.createEdgeList=function(){return this.getEdges([])},Ai.prototype.getConnectedComponents=function(e){return void 0===e&&(e={}),this.modules.graph.getConnectedComponents(this.getNodes(e.filter),e)},Ai.prototype.getConnectedComponentByNode=function(e,t){var n=this.modules.graph.getNode(e);if(void 0===n)throw new Error("getComponentByNode: cannot find node "+e);return this.modules.graph.getConnectedComponentByNode(n,t)[0]},Ai);function Ai(){}var eS=(Qm.prototype.reloadFonts=function(){this.modules.graphics.reloadFonts()},Qm);function Qm(){}function lr(e){return e.charCodeAt(0)}var tS=lr(" "),Km=lr("<"),nd=lr(">"),$m=lr('"'),nS=lr("\n"),iS=lr("\r"),id=lr("/"),rS=lr("\\"),oS=lr("a"),aS=lr("z"),sS=lr("A"),uS=lr("Z"),lS=lr("0"),dS=lr("9"),cS=lr(":");function hS(e,t,n,i){var r=i.length;if(n-t!==r)return!1;for(var o=0;o<r;++o)if(e[t+o]!==i[o])return!1;return!0}function iv(e,t,n,i){for(var r=e.length,o=0;o<r;++o)if(hS(t,n,i,e[o]))return o;return e.push(t.slice(n,i)),r}function pS(e,t,n){var i=rd(t,n),r=t[i];if(r===nd||r===id)return i;var o=i;i=ov(t,i);for(var u=iv(e.attributes,t,o,i);t[i]!==$m;)++i;for(o=++i;(r=t[i])!==$m;)r===rS&&++i,++i;return e.tokens.push(-3,u,o,i),i+1}function rv(e){return e===tS||e===nS||e===iS}function rd(e,t){for(;rv(e[t]);)++t;return t}function ov(e,t){for(;oS<=(n=e[t])&&n<=aS||sS<=n&&n<=uS||n===cS||lS<=n&&n<=dS;)++t;var n;return t}function av(e,t){var n=["return {","  id: undefined,","  attributes: {","    text: undefined,","    color: undefined,","    "+(e?"radius":"width")+": undefined",e?"  ,x: undefined":"",e?"  ,y: undefined":"","  },"];e||n.push("  source: undefined,","  target: undefined,");var i=Object.keys(t);i.length&&n.push("  data: {");for(var r=0;r<i.length;++r){var o=t[i[r]];n.push('  "'+o.title+'": '+(void 0!==o.default?JSON.stringify(o.default):void 0)+(r===i.length-1?"":","))}return i.length&&n.push("}"),n.push("};"),new Function(n.join("\n"))}function sv(e){return-1===e.indexOf("\\")?e:e=e.replace(/\\"/g,'"')}function uv(e){if(-1===e.indexOf("<gexf"))throw new Error("not a GEXF file");var t=function(xe){for(var Me=new Int32Array(xe.length),Fe=0,Be=xe.length;Fe<Be;++Fe)Me[Fe]=xe.charCodeAt(Fe);return Me}(e),n=function(xe,Me){for(var Fe,Be,De={tags:[],attributes:[],tokens:[]},ze=De.tokens,ke=rd(xe,Me);ke<xe.length;){var Ne=xe[ke];if(Ne===Km){if(xe[ke=rd(xe,++ke)]===id)for(ze.push(-2);xe[++ke]!==nd;);else{ke=ov(xe,Fe=ke);var we=iv(De.tags,xe,Fe,ke);for(ze.push(-1,we),Ne=xe[ke];Ne!==nd&&Ne!==id;)Ne=xe[ke=pS(De,xe,ke)];if(Ne===id)for(ze.push(-2);xe[++ke]!==nd;);}ke+=1}else{for(Fe=ke;xe[++ke]!==Km;);for(Be=ke-1;rv(xe[Be]);)--Be;ze.push(-4,Fe,Be+1)}ke=rd(xe,ke)}return De}(t,e.indexOf("<gexf ")),i={},r={};n.tags.forEach(function(xe,Me){var Fe=String.fromCharCode.apply(null,xe);i[Fe]=Me}),n.attributes.forEach(function(xe,Me){var Fe=String.fromCharCode.apply(null,xe);r[Fe]=Me});for(var o=i.attributes,a=i.attribute,s=i.node,l=i.edge,u=i.default,d=i["viz:position"],c=i["viz:size"],h=i["viz:color"],p=i.attvalue,g=r.class,m=r.id,x=r.type,v=r.title,y=r.label,b=r.source,S=r.target,w=r.x,M=r.y,N=r.r,D=r.g,P=r.b,L=r.a,V=r.value,X=r.for,J=r.weight,se={float:1,double:1,integer:2,boolean:3,string:4,"list-string":5},re=0,j=n.tokens,Y=j.length,he=new Array(16),pe=0,Ae=0,Ie=0,ot=!0,at={},We={},vt=null,Tt=null,Ge=null,qe=void 0,Le=null,He=0,Je=0,et=0,Te=1,Re=null,Ze=void 0,Qe=!1,dt=!0,Ht=null,Kt=null,ln=[],an=[],hn=0,W=null;re<Y;){var Z=j[re];if(-1===Z)Ae=pe,he[Ie]=pe=j[re+1],Ie+=1,pe===s?(Le=(Ht=Ht||av(!0,at))(),dt=!0,W=at):pe===l&&(Le=(Kt=Kt||av(!1,We))(),dt=!1,W=We),re+=2;else if(-2===Z){if(vt&&pe===a){W=ot?at:We;var B=se[Tt];(_e=qe)&&(1===B?_e=+_e:2===B?_e=0|+_e:3===B?_e="true"===_e:5===B&&(_e=_e.split(" ").filter(function(xe){return xe}))),W[vt]={title:Ge||vt,default:_e,type:B},Tt=Ge=vt=null,qe=void 0}else if(pe===s&&4===Ie)Qe&&(Le.attributes.color="rgba("+He+", "+Je+", "+et+", "+Te+")",et=Je=He=0,Qe=!(Te=1)),Le.id||(Le.id=++hn),ln.push(Le);else if(pe===l&&4===Ie)Le.id||(Le.id=++hn),an.push(Le);else if(pe===p&&6===Ie&&Re){var K=(dt?at:We)[Re];K&&(void 0===Ze?Ze=K.default:(B=K.type)&&(1===B?Ze=+Ze:2===B?Ze=0|+Ze:3===B?Ze="true"===Ze:5===B?Ze=Ze.split(" ").filter(function(xe){return xe}).map(function(xe){return sv(xe)}):"string"==typeof t&&(Ze=sv(Ze))),Le.data[W[Re].title]=Ze),Ze=Re=null}pe=Ae,Ae=he[--Ie-2],re+=1}else if(-3===Z){var ce=j[re+1],_e=e.substring(j[re+2],j[re+3]);if(pe===o)ce===g&&(ot="edge"!==_e&&"edges"!==_e);else if(pe===a)ce===m?vt=_e:ce===x?Tt=_e:ce===v&&(Ge=_e);else if(pe!==s&&pe!==l||4!==Ie)if(pe===d&&5===Ie){if(ce===w)Le.attributes.x=parseFloat(_e);else if(ce===M){var Ee=parseFloat(_e);Le.attributes.y=0===Ee?Ee:-Ee}}else pe===h&&5===Ie?(Qe=!0,ce===N?He=parseInt(_e):ce===D?Je=parseInt(_e):ce===P?et=parseInt(_e):ce===L&&(Te=parseFloat(_e))):pe===c&&5===Ie?ce===V&&(dt?Le.attributes.radius=+_e:Le.attributes.width=+_e):pe===p&&6===Ie&&(ce===X||ce===m?Re=_e:ce===V&&(Ze=_e));else ce===m?Le.id=_e:ce===y?Le.attributes.text=_e:ce===b?Le.source=_e:ce===S?Le.target=_e:ce===J&&(Le.attributes.width=+_e);re+=4}else{if(-4!==Z)throw new Error("at index "+re+": token "+Z);_e=e.substring(j[re+1],j[re+2]),pe===u&&(qe=_e),re+=3}}return{nodes:ln,edges:an}}function od(e){return"string"==typeof e||isFinite(e)?String(e):String(e.id||e._id)}function Ia(e,t,n){n=n||t,t in e&&(e.attributes||(e.attributes={}),e.attributes[n]=e[t])}function lv(e){for(var t=JSON.parse(e),n=t.nodes||[],i=t.edges||[],r=0;r<n.length;r++){var o=n[r];"string"==typeof o.size&&(o.size=+o.size),"string"==typeof o.x&&(o.x=+o.x),"string"==typeof o.y&&(o.y=+o.y),Ia(o,"x"),Ia(o,"y"),Ia(o,"size","radius"),Ia(o,"color"),Ia(o,"text")}for(r=0;r<i.length;r++){var a=i[r];"string"==typeof a.size&&(a.size=+a.size),Ia(a,"size","width"),Ia(a,"color"),Ia(a,"text")}return t}function dv(e,t){for(var n=0,i=0;i<20;++i){var r=n+e[i]+t[i];n=+(10<=r),e[i]=r%10}}function cv(){this._decimalPowerOfTwo=new Uint8Array(20),this._binaryNumber=new Uint8Array(64),this._decimalNumber=new Uint8Array(20)}var gS=new(cv.prototype.int64ToString=function(e){var t=e.low,n=e.high;if(0===t&&0===n)return"0";(function(s,l,u){for(var d=0;d<32;++d)u[d]=+!!(s&1<<d);for(d=0;d<32;++d)u[d+32]=+!!(l&1<<d)})(t,n,this._binaryNumber),this._decimalNumber.fill(0),this._decimalPowerOfTwo.fill(0);var i=(this._decimalPowerOfTwo[0]=1)===this._binaryNumber[63];i&&function(s){for(var l=0;l<64;++l)s[l]^=1;for(l=0;l<64&&!(s[l]^=1);++l);}(this._binaryNumber);for(var r=0;r<64;++r)this._binaryNumber[r]&&dv(this._decimalNumber,this._decimalPowerOfTwo),dv(this._decimalPowerOfTwo,this._decimalPowerOfTwo);var o=[],a=this._decimalNumber.length-1;for(i&&o.push("-");!this._decimalNumber[a];)--a;for(r=a;0<=r;--r)o.push(String(this._decimalNumber[r]));return o.join("")},cv);function ad(e){return gS.int64ToString(e)}function sd(e){return"object"==typeof e&&"high"in e&&"low"in e}function Du(e,t,n,i){var r,o,a;t&&(Array.isArray(t)?t.forEach(function(s){return Du(e,s,n,i)}):function(e){return"segments"in e}(t)?(r=e,o=n,a=i,t.segments.forEach(function(s){Du(r,s.start,o,a),Du(r,s.end,o,a),Du(r,s.relationship,o,a)})):(function(s){if("object"!=typeof s||null===s)throw new Error("Ogma can only retrieve nodes and relationships from Neo4j. Please make sure that your Cypher query returns nodes and edges, not values.");for(var l,u=0,d=Object.keys(s.properties);u<d.length;u++){var c=d[u],h=s.properties[c];sd(h)&&(s.properties[c]=ad(h))}if(void 0!==s.identity&&(sd(s.identity)&&(s.identity=ad(s.identity)),"start"in(l=s)&&"end"in l)){var p=s.start.identity||s.start,g=s.end.identity||s.end;sd(p)&&(s.start=ad(p)),sd(g)&&(s.end=ad(g))}}(t),function(e){return"start"in e&&"end"in e&&"type"in e}(t)?i.has(t.identity)||(i.add(t.identity),e.edges.push({id:t.identity,source:t.start,target:t.end,data:{neo4jType:t.type,neo4jProperties:t.properties}})):n.has(t.identity)||(n.add(t.identity),e.nodes.push({id:t.identity,attributes:{x:100*Math.random(),y:100*Math.random()},data:{neo4jLabels:t.labels,neo4jProperties:t.properties}}))))}function vS(e){return{gexf:function(t){return Promise.resolve(uv(t))},gexfFromUrl:function(t){return mi(t).then(function(n){return uv(n)})},janus:function(t){return Promise.resolve(function(e){var t=[],n=[];return function i(r,o,a){if(r&&"object"==typeof r){if(Array.isArray(r))return r.forEach(function(h){return i(h,o,a)});if("vertex"===(d=r).type||"vertex"===d._type||d.inE||d.outE||d._inE||d._outE){var s={};r.properties&&Object.keys(r.properties).forEach(function(h){s[h]=r.properties[h][0].value});var l=od(r);for(var u in o.push({id:l,data:{id:r.id+"",categories:[r.label],properties:s}}),r)"properties"!==u&&i(r[u],o,a)}else{var d,c;if("edge"===(c=r).type||"edge"===c._type||c.inV||c.outV||c._outV||c._inV)for(var u in l=od(r),a.push({id:l,source:od(r.inV||r._inV),target:od(r.outV||r._outV),data:{id:l,type:r.label,properties:r.properties||{}}}),r)"properties"!==u&&i(r[u],o,a);else Object.keys(r).forEach(function(h){return i(r[h],o,a)})}}}("string"==typeof e?JSON.parse(e):e,t,n),{nodes:t,edges:n}}(t))},json:function(t){return Promise.resolve(lv(t))},jsonFromUrl:function(t){return mi(t).then(function(n){return lv(n)})},neo4j:function(t){return Promise.resolve((i="string"==typeof(n=t)?JSON.parse(n):n,r={nodes:[],edges:[]},o=new Set,a=new Set,i.records.forEach(function(s){s._fields.forEach(function(l){Du(r,l,o,a)})}),r));var n,i,r,o,a}}}var hv=(Qc.initNamespace=function(e){e.parse=vS()},Qc.prototype.fetch=function(e){return mi(e)},Qc);function Qc(){}var pv=(fv.initNamespace=function(e){var t;e.keyboard=(t=e,{isKeyPressed:function(n){return t.modules.keyboard.isPressed(n)},resetKeys:function(){t.modules.keyboard.resetKeys()}})},fv);function fv(){}var yS={configure:function(e,t){var n=t.graph,i=t.data;if(void 0===e.centralNode)throw new Error('concentric layout: missing parameter "centralNode"');var r,o,a,s,l,u=It({},e,{centralNode:(s=n,(l=e.centralNode)instanceof _o?l:s.getNode(l)),nodes:(r=n,o=e.nodes,void 0===a&&(a=r.getNodes()),o?o instanceof or?o:r.getNodes(o):a)}),c=u.nodes,h=n.getNode(u.centralNode)._index,p=u.centralNode.getPosition(),g=p.x,m=p.y,x=c.getAttribute("layoutable"),v=n.getNodes(c)._indexes,y=Array.from(v.filter(function(D,P){return x[P]}));-1===y.indexOf(h)&&y.push(h);var b=n.getNodeAttribute("radius").getMultiple(v),S=function(D,P,L,V){if(P)return"random"===P?"random":"radius"===P?V.slice():"degree"===P?L.getDegree():D.getProperty(L,P)}(i,u.sortBy,c,b),w=y.reduce(function(D,P,L){return D[P]=L,D},{}),M=y.map(function(D,P){return P}),N=y.map(function(D){return n.topology.getAdjacentElements(!0,new Uint32Array([D])).map(function(P){return w[P]})});return{sourceNodeIndex:y.indexOf(h),centerX:"number"==typeof u.centerX?u.centerX:g,centerY:"number"==typeof u.centerY?u.centerY:m,list:y,indexes:M,size:y.length,totalSize:y.length,attributes:{adjacentNodes:N,size:b},sortAttr:S,clockwise:void 0===u.clockwise||u.clockwise,circleHopRatio:u.circleHopRatio||5,allowOverlap:!!u.allowOverlap}},context:function(){return{dijkstra:function(e,t,n,i,r){var o,a=Math.pow(2,31)-1,s=new Int32Array(i),l=new Int32Array(i),u=new Int8Array(i);s.fill(a),l.fill(-1);for(var d=0;d<i;++d){var c=t[d];void 0!==c&&(s[c]=a,l[c]=-1)}s[r]=0;for(var h=function(){var p=a;o=-1;for(var g=0;g<n;++g){var m=t[g],x=s[m];!u[m]&&x<p&&(p=x,u[o=m]=1)}if(-1<o){var y=p+1;e[o].forEach(function(b){y<s[b]&&(s[b]=y,l[b]=o)})}};-1!==o;)h();return s},determinePropertyType:function(e,t,n){return t.some(function(i){return"number"!==e[i]})?"string":"number"}}},update:function(e,t){for(var n=e.attributes,i=e.indexes,r=e.size,o=e.sourceNodeIndex,a=e.centerX,s=e.centerY,l=e.sortAttr,u=n.adjacentNodes,d=n.size,c=new Array(e.totalSize),h=new Array(e.totalSize),p=t.dijkstra(u,i,e.size,e.totalSize,o),g=0,m={},x=0;x<r;x++){var v=d[i[x]];g<v&&(g=v)}var y=g*e.circleHopRatio,b=0,S=0,w=Math.PI/9;for(x=0;x<r;x++){var M=i[x],N=p[M],D=m[N];D||(m[N]=D=[]),D.push(M)}var P,L,X=(L=i,"random"===(P=l)?function(){return Math.random()-.5}:P?"number"===t.determinePropertyType(P,L,L.length)?function(se,re){return P[se]-P[re]}:function(se,re){return P[se]<P[re]?-1:1}:void 0),J="random"===l||l;return Object.keys(m).sort(function(se,re){return parseInt(se)-parseInt(re)}).forEach(function(se,re){var Ie,j=m[se],Y=j.length,he=0,pe=S,Ae=2*Math.PI/Y;0===re||e.allowOverlap||2*Math.PI*b<(Ie=2*(he+=j.reduce(function(We,vt){return We+d[vt]},0))*Math.SQRT2)&&(b+=Ie/(2*Math.PI)-b),J&&(j.sort(X),e.clockwise||j.reverse());for(var ot=0;ot<Y;ot++){var at=j[ot];c[at]=Math.cos(pe)*b+a,h[at]=Math.sin(pe)*b+s,v=d[at],pe+=Ae*(e.allowOverlap?1:v/he*Y)}b+=y,S+=w}),{x:c,y:h,indexes:e.list}},isRunning:function(){return!1},onSync:function(e){return{indexes:e.indexes,x:e.x,y:e.y}}};function Kc(e){var t=e.sources,n=e.targets,i=e.weights,r=e.source,o=e.target,a=e.undirected,s=void 0!==a&&a,l=e.indexes,u=e.N;if(u=l?l.length:u,!isFinite(u)||0===u)throw new Error("Invalid number of nodes "+u);var d,c=new Float32Array(u),h=new Int32Array(u),p={},g=Number.POSITIVE_INFINITY;if(!i){i=[];for(var m=0;m<u;m++)i[m]=1}if(!l)for(l=new Uint32Array(u),m=0;m<u;m++)l[m]=m+1;for(m=0;m<u;m++)c[m]=g,h[m]=-1,p[l[m]]=m;for(c[p[r]]=0,m=1;m<=u;m++){d=!1;for(var x=0;x<i.length;x++){var v=t[x],y=n[x],b=p[v],S=p[y];if(void 0!==b&&void 0!==S){var w=i[x],M=c[b]+w;c[b]!==g&&M<c[S]&&(c[S]=M,h[S]=v,d=!0),s&&(M=c[S]+w,c[S]!==g&&M<c[b]&&(c[b]=M,h[b]=y,d=!0))}}if(!d)break}if(d)for(m=0;m<i.length;m++)if(S=p[y=n[m]],void 0!==(b=p[v=t[m]])&&void 0!==S&&c[b]+(w=i[m])<c[S])return null;var N=null,D=null;if(void 0!==o){var P=p[o];if(void 0!==P&&c[P]!==g){for(N=[],m=o;-1!==m;m=h[p[m]])N.push(m);N=N.reverse(),D=c[P]}}return{distances:c,path:N,pathLength:D}}function $c(e){var t=e.sources,n=e.targets,i=e.weights,r=e.indexes,o=e.adjacency,a=e.undirected,s=e.ignoreWeights,l=Number.POSITIVE_INFINITY,u=r?r.length:o.length;if(!r){r=new Uint32Array(u);for(var d=0;d<u;d++)r[d]=d+1}var c=new Array(u),h={};for(d=0;d<u;d++){c[d]=new Float32Array(u);for(var p=0;p<u;p++)c[d][p]=d===p?0:l;h[r[d]]=d}var g=u,m=i.length;for(t=t.slice(),n=n.slice(),i=i.slice(),d=0;d<u;d++)t[m+d]=g,n[m+d]=r[d],i[m+d]=0,s&&(i[d]=1);var x=Kc({sources:t,targets:n,weights:i,undirected:a,N:u+1,source:g});if(null===x)throw new Error("Graph has negative weight loops");var v=x.distances;for(d=0;d<i.length;d++){var y=h[t[d]],b=h[n[d]];void 0!==y&&void 0!==b&&(i[d]=i[d]+v[y]-v[b])}for(t=t.slice(0,m),n=n.slice(0,m),i=i.slice(0,m),d=0;d<u;d++){var S=Hl(o,r[d],void 0,r,h,s).distances;for(p=0;p<u;p++)c[d][p]=d===p?0:S[p]}return c}function eh(e){var t=e.X,n=e.Y,i=e.sizes,r=e.indexes,o=e.R,a=e.center,s=e.gap,l=void 0===s?0:s,u=e.epsilon,d=void 0===u?.001:u,c=e.maxLoops,h=void 0===c?5:c,p=e.inPlace,m=r.length,x=a[0],v=a[1],y=m;void 0===p||p||(t=t.slice(),n=n.slice());for(var b=sc,S=uc,w=r.slice().sort(function(Te,Re){return S(t[Te],n[Te],t[Re],n[Re],x,v)}),M=w[m-1],N=t[M],D=n[M],P=!1,L=0;L<y-1;L++){var V=L%m,X=(L+1)%m;-1===L&&(V=m-1,X=0);var J=t[V=w[V]],se=n[V],re=t[X=w[X]],j=n[X],Y=i[V]+i[X]+l,he=S(J,se,re,j,x,v);if(-1===he&&P&&(he=1),!(o<Y)){if(1===he||Y-yi(J,se,re,j)>d){var pe=b(x,v,o,J,se,Y);if(pe){var Ae=pe[0];P=x<re&&Ae[0]<x,re=t[X]=Ae[0],j=n[X]=Ae[1]}}else P=!1;if(L%m==m-2){var Ie=w[m-1],ot=w[0];if(n[Ie]>v&&n[ot]>v&&t[Ie]-i[Ie]<t[ot]+i[Ie]){var at=0;for(y=Math.min(m*h,y+m);n[w[Ie]]>v&&n[w[0]]>v&&t[w[Ie]]<t[w[0]]&&++at<m;)w.unshift(w.pop())}}}}var We=N-x,vt=D-v,Tt=t[M]-x,Ge=n[M]-v,qe=We==Tt?0:Math.abs(Math.acos((We*Tt+vt*Ge)/(Math.sqrt(We*We+vt*vt)*Math.sqrt(Tt*Tt+Ge*Ge))));if(0!==qe){var Le=Math.sin(-qe),He=Math.cos(-qe),Je=void 0;for(L=0;L<m;L++){var et=n[Je=w[L]]-v;t[Je]=(at=t[Je]-x)*He-et*Le+x,n[Je]=at*Le+et*He+v}}return{X:t,Y:n}}function gv(e,t,n,i,r,o){var a=Object.create(null),s=n[e],l=s,u=0,d=s;for(var c in t){for(var h=t[c],p=0,g=0,m=0,x=h.length;m<x;m++){var v=n[h[m]];g=Math.max(g,v),p+=2*v+i}var y=p/(2*Math.PI)+g,S=o?u+Math.max(o,g+l):u*r;u=Math.max(u,y,d,S),a[c]=u,l=g}return a[0]=0,a[Number.POSITIVE_INFINITY]=u,a}function _v(e,t,n,i,r,o){for(var a=0,s=0;s<i;s++)for(var l=0;l<i;l++){var u=o[s],d=o[l];if(u!==d){var c=e[u][d]*r,h=1/(c*c);if(h){var p=t[u]-t[d],g=n[u]-n[d];a+=h*Math.pow(c-Math.sqrt(p*p+g*g),2)}}}return a}function mv(e,t,n,i,r,o,a){var s=0;if(-1===r)return 0;for(var l=0;l<i;l++)for(var u=0;u<i;u++){var d=a[l],c=a[u];if(d!==c&&(d===r||c===r)){var h=e[d][c]*o,p=1/(h*h);if(p){var g=t[d]-t[c],m=n[d]-n[c];s+=p*Math.pow(h-Math.sqrt(g*g+m*m),2)}}}return s}function th(e,t,n,i,r,o,a,s){a=a||0;for(var l=0,u=0,d=0;d<i;d++)for(var c=0;c<i;c++){var h=s[d],p=s[c];if(h!==p){var g=e[h][p]*o,m=1/(g*g);if(m){var x=t[h]-t[p],v=n[h]-n[p],y=m*Math.pow(g-Math.sqrt(x*x+v*v),2);l+=y,h!==r&&p!==r||(u+=y)}}}return(1-a)*l+a*u}function nh(e,t,n,i,r,o,a,s,l){a=a||0;var u=t,d=n;-1===(r=void 0===r?-1:r)&&(a=0);for(var c=t[r],h=n[r],p=0;p<i;p++){var g=s[p],m=l(e[r][p]),x=a/(m*m);if(0!==m){for(var v=0,y=0,b=0,S=t[g],w=n[g],M=0;M<i;M++){var N=s[M];if(N!==g){var D=e[g][N]*o,P=1/(D*D),L=t[N],V=n[N];if(0!=P){var X=(j=(se=S-L)*se+(re=w-V)*re)<1e-6?0:1/Math.sqrt(j);y+=(1-a)*P*(L+D*(S-L)*X),b+=(1-a)*P*(V+D*(w-V)*X)}v+=P}}var J=(1-a)*v+x;if(0!=J){var se,re,j;j=(j=(se=S-c)*se+(re=w-h)*re)<1e-6?0:1/Math.sqrt(j);var Y=0===m?0:m*j*x;u[g]=(y+Y*t[g])/J,d[g]=(b+Y*n[g])/J}}}return{x:u,y:d}}function ih(e,t){return e-t}var xS={imports:{minHeap:kc,bellmanFord:Kc,dijkstra:Hl,johnson:$c,distance:yi,circleCircleIntersection:sc,circleSortCompare:uc,weightedStress:_v,distanceStress:mv,constrainedStress:th,stressMinimizationStep:nh,removeRadialOverlap:eh,quadraticInOut:nc,calculateRadii:gv},configure:function(e,t){void 0===e&&(e={centralNode:null});var n=t.graph,i=n.getNode(e.centralNode),r=i.getPosition(),o=isFinite(e.centerX)?e.centerX:r.x,a=isFinite(e.centerY)?e.centerY:r.y,s=i._index,l=e.nodes;l.includes(i)||(l=l.concat(i.toList()));var u=l._indexes,d=l.getAttribute("layoutable");(u=u.filter(function(w,M){return d[M]||w===s})).sort(ih);var c=u.length,h=function(w,M,N){for(var D=w.slice().sort(ih),P=[],L=0,V=M.length;L<V;L++){for(var X=[],J=M[L],se=!1,re=0,j=J.length;re<j;re++){var Y=J[re];-1!==ps(D,Y)&&(Y===N&&(se=!0),X.push(Y))}0!==X.length&&P[se?"unshift":"push"](X.sort(ih))}return P}(u,n.getConnectedComponents(l,{internalIndexes:!0}),s),p=n.degrees(u),g=new Float32Array(n.getNodeAttribute("x").getMultiple(u)),m=new Float32Array(n.getNodeAttribute("y").getMultiple(u)),x=n.getNodeAttribute("radius").getMultiple(u),v=n.getEdges()._indexes,y=n.getEdgeAttribute("source").getMultiple(v),b=n.getEdgeAttribute("target").getMultiple(v),S=n.getAdjacencyList({internalIndexes:!0,weight:1,indexes:u});return{centerIndex:s,centerIndexPos:0,cx:o,cy:a,D:null,indexes:u,components:h,normIndexes:null,radii:null,rings:null,x:g,y:m,degree:p,size:c,attributes:{size:x,adjacency:S,weights:b.map(function(){return 1}),sources:y,targets:b},sortAttr:null,allowOverlap:!!e.allowOverlap,nodeGap:e.nodeGap,radiusRatio:e.radiusRatio,radiusDelta:e.radiusDelta,repulsion:e.repulsion,randomize:!("randomize"in e)||!!e.randomize,renderSteps:!!e.renderSteps,epsilon:e.epsilon,maxSteps:e.maxIterations,iterationsPerRender:e.iterationsPerRender,step:-1,stress:Number.POSITIVE_INFINITY,prevStress:0,converged:!1,overlapRemoved:!1,done:!1}},context:function(){return{data:null,gridPlacement:function(e,t,n){void 0===n&&(n=8);for(var i=e.length,r=new Float32Array(i),o=new Float32Array(i),a=0,s=0,l=e.length;s<l;s++){var u=t[e[s]];a<u&&(a=u)}var d=a*n,c=Math.ceil(Math.sqrt(i)),h=Math.ceil(i/c),p=-Math.floor((h-1)*d/2),g=-Math.floor((c-1)*d/2);for(s=0;s<c;s++)for(var m=0;m<h;m++)r[s*h+m]=p+m*d,o[s*h+m]=g+s*d;return{x:r,y:o}},connectComponents:function(e,t,n,i,r,o){var a;function s(d,c){var h=new Uint32Array(d.length+1);return h.set(d),h[d.length]=c,h}for(var l=function(d){var c=e[d],h=0,p=0;c.forEach(function(m,x){r.get(m)>h&&(p=x,h=r.get(m))});var g=t[o.get(a=c[p])];g.nodes=s(g.nodes,n),g.weights.push(i),(g=t[o.get(n)]).nodes=s(g.nodes,a),g.weights.push(i)},u=1;u<e.length;u++)l(u)},correctSubgraphsDistances:function(e,t,n,i,r){for(var o=Array.prototype.reduce.call(e[n],function(h,p,g){return g!==n&&p<i&&h<p&&(h=p),h},0),a=i-o-1,s=1;s<t.length;s++)for(var l=t[s],u=0,d=l.length;u<d;u++){var c=r.get(l[u]);e[n][c]-=a,e[c][n]-=a}},initialize:function(e,t){(e.data=t).step=0;var n=new Map,i=new Map;t.normIndexes=t.indexes.reduce(function(h,p,g){return h[g]=g,n.set(p,g),i.set(p,t.degree[g]),p===t.centerIndex&&(e.data.centerIndexPos=g),h},new Uint32Array(t.indexes.length));var r=t.centerIndexPos,o=t.components[0].length;e.connectComponents(t.components,t.attributes.adjacency,t.centerIndex,o,i,n);var a=$c({sources:t.attributes.sources,targets:t.attributes.targets,weights:t.attributes.weights,indexes:t.indexes,adjacency:t.attributes.adjacency,undirected:!0});e.correctSubgraphsDistances(a,t.components,r,o,n);for(var s=(t.D=a)[r],l=Object.create(null),u=0,d=t.normIndexes.length;u<d;u++)if(u!==r){var c=s[u];l[c]=l[c]||[],l[c].push(t.normIndexes[u])}t.rings=l,t.radii=gv(r,t.rings,t.attributes.size,t.nodeGap,t.radiusRatio,t.radiusDelta)},removeOverlaps:function(e,t){var n=e.data.centerIndexPos,i=t.attributes.size,r=t.rings,o=t.x[n],a=t.y[n];for(var s in r){var l=r[s],u=yi(o,a,t.x[l[0]],t.y[l[0]]);eh({X:t.x,Y:t.y,sizes:i,indexes:l,center:[o,a],R:u,gap:t.nodeGap,inPlace:!0})}}}},update:function(e,t){var n,i=(e=e||t.data).indexes,r=e.centerIndex;function o(y){return e.radii[y]||1}e.x=e.x||new Float32Array(e.size),e.y=e.y||new Float32Array(e.size),-1===e.step?t.initialize(t,e):e.step++;var a=e.repulsion;if(0===e.step)e.randomize&&(n=t.gridPlacement(e.indexes,e.attributes.size),e.x=n.x,e.y=n.y);else if(!e.converged)for(var s=e.maxSteps,u=e.step,d=Math.min(u+e.iterationsPerRender,s+1),c=e.D,h=e.x,p=e.y,g=e.size,m=e.centerIndexPos,x=e.normIndexes;u<=d||!e.converged;){var v=nc(Math.min(u,s)/s);e.step=u++,n=nh(c,h,p,g,m,a,v,x,o),e.x=n.x,e.y=n.y,e.prevStress=e.stress,e.stress=th(c,h,p,g,m,a,v,x),e.converged=e.converged||Math.abs(e.stress-e.prevStress)<=e.epsilon}return e.converged&&(e.overlapRemoved||e.allowOverlap?(e.done=!0,e.rings=Object.keys(e.rings).reduce(function(y,b){return y[b]=e.rings[b].map(function(S){return i[S]}),y},{})):(t.removeOverlaps(t,e,r),e.overlapRemoved=!0)),e},isRunning:function(e){var t=e.data;return!t.converged||!t.allowOverlap&&!t.done},onSync:function(e){if(e.renderSteps||e.done)return vv(e)},onEnd:function(e,t){return vv(e)}};function vv(e){for(var t=e.x,n=e.y,i=e.indexes.length,r=t[e.centerIndexPos]-e.cx,o=n[e.centerIndexPos]-e.cy,a=0;a<i;a++)t[a]-=r,n[a]-=o;return{indexes:e.indexes,x:t,y:n}}function yv(){return function(){var e=function(W){var Z,B=(Z=4022871197,function(K){K=K.toString();for(var ce=0;ce<K.length;ce++){var _e=.02519603282416938*(Z+=K.charCodeAt(ce));_e-=Z=_e>>>0,Z=(_e*=Z)>>>0,Z+=4294967296*(_e-=Z)}return 2.3283064365386963e-10*(Z>>>0)});this.c=1,this.s0=B(" "),this.s1=B(" "),this.s2=B(" "),this.s0-=B(String(W)),this.s0<0&&(this.s0+=1),this.s1-=B(String(W)),this.s1<0&&(this.s1+=1),this.s2-=B(W),this.s2<0&&(this.s2+=1),B=null};function t(W){return new e(W.toString()).next()}e.prototype.next=function(){var W=this;return function(){var Z=2091639*W.s0+2.3283064365386963e-10*W.c;return W.s0=W.s1,W.s1=W.s2,W.s2=Z-(W.c=0|Z)}},e.prototype.nextDouble=function(){var W=this.next();return function(){return W()+11102230246251565e-32*(2097152*W()|0)}},e.prototype.nextInt32=function(){var W=this.next();return function(){return 4294967296*W()|0}};var n=t(42);function i(W){n=t(W)}function r(){return 1e-6*(n()-.5)}for(var o=[0,1],a=[0,2],s=4;s<65535;s<<=2)for(var l=0,u=o.length;l<u;l++)o.push(o[l]|s),a.push((o[l]|s)<<1);function d(W,Z){return(a[255&Z]|o[255&W])+65536*(a[Z>>8&255]|o[W>>8&255])+4294967296*(a[Z>>16&255]|o[W>>16&255])}function c(W,Z){var B=W^Z,K=65535^B,ce=65535^(W|Z),_e=W&(65535^Z),Ee=B|K>>1,xe=B>>1^B,Me=ce>>1^K&_e>>1^ce,Fe=B&ce>>1^_e>>1^_e;xe=(B=Ee)&(K=xe)>>2^K&(B^K)>>2,Me^=B&(ce=Me)>>2^K&(_e=Fe)>>2,Fe^=K&ce>>2^(B^K)&_e>>2,xe=(B=Ee=B&B>>2^K&K>>2)&(K=xe)>>4^K&(B^K)>>4,Me^=B&(ce=Me)>>4^K&(_e=Fe)>>4,Fe^=K&ce>>4^(B^K)&_e>>4,Me^=(B=Ee=B&B>>4^K&K>>4)&(ce=Me)>>8^(K=xe)&(_e=Fe)>>8;var Be=W^Z,De=(K=(Fe^=K&ce>>8^(B^K)&_e>>8)^Fe>>1)|65535^(Be|(B=Me^Me>>1));return((De=1431655765&((De=858993459&((De=252645135&((De=16711935&(De|De<<8))|De<<4))|De<<2))|De<<1))<<1|(Be=1431655765&((Be=858993459&((Be=252645135&((Be=16711935&(Be|Be<<8))|Be<<4))|Be<<2))|Be<<1)))>>>0}var p,g,m=function(W,Z,B){this.left=null,this.right=null,this.code=W,this.left=Z,this.right=B},x=function(W,Z){this.code=W,this.data=Z},v=function(W,Z){this.code=W,this.data=Z};function y(){this.left=null,this.right=null,this.data=null}function b(W){for(var Z=1<<31,B=0;B<31;B+=1){if(Z&W)return B;Z>>>=1}return 32}function S(W,Z,B){var K=W[Z],ce=W[B];if(K===ce)return Z;for(var _e,Ee=b(K^ce),xe=Z,Me=B-Z;(_e=xe+(Me=Me+1>>1))<B&&Ee<b(K^W[_e])&&(xe=_e),1<Me;);return xe}(g=p=p||{})[g.HILBERT=1]="HILBERT",g[g.MORTON=0]="MORTON";var w=function(W,Z){void 0===Z&&(Z={});var B=Z.getX,K=Z.getY,ce=Z.bucketSize;void 0===ce&&(ce=0);var _e=Z.sfc;void 0===_e&&(_e=p.HILBERT);var Ee=Z.recursive;void 0===Ee&&(Ee=!0),this._bucketSize=0,this._root=null;var xe,Me,Fe,Be,De=W.length,ze=new Uint32Array(De),ke=1/0,Ne=1/0,we=-1/0,Ke=-1/0;this._x=B,this._y=K;var ut=_e===p.HILBERT?c:d;this._project=ut;var Ue=new Uint32Array(De);for(Me=0;Me<De;Me++)(Fe=B(xe=W[Me]))<ke&&(ke=Fe),(Be=K(xe))<Ne&&(Ne=Be),we<Fe&&(we=Fe),Ke<Be&&(Ke=Be),Ue[Me]=Me;this._minX=ke,this._minY=Ne,this._maxX=we,this._maxY=Ke;var je=65535/Math.max(we-ke,1),Ve=65535/Math.max(Ke-Ne,1);for(this._hw=je,this._hh=Ve,Me=0;Me<De;Me++)ze[Me]=ut(je*(B(xe=W[Me])-ke),Ve*(K(xe)-Ne));(function(W,Z){(function B(K,ce,_e,Ee){if(!(Ee<=_e)){for(var xe,Me=ce[_e+Ee>>1],Fe=_e-1,Be=Ee+1;;){for(;ce[++Fe]<Me;);for(;ce[--Be]>Me;);if(Be<=Fe)break;xe=K[Fe],K[Fe]=K[Be],K[Be]=xe,xe=ce[Fe],ce[Fe]=ce[Be],ce[Be]=xe}B(K,ce,_e,Be),B(K,ce,Be+1,Ee)}})(W,Z,0,W.length-1)})(Ue,ze),this._root=0===ce?Ee?function $e(Ye,rt,bt,Et,Mt){if(Mt-Et==0)return new x(bt[Et],Ye[rt[Et]]);var yt=S(bt,Et,Mt),Ct=$e(Ye,rt,bt,Et,yt),nt=$e(Ye,rt,bt,yt+1,Mt);return new m(yt,Ct,nt)}(W,Ue,ze,0,De-1):function($e,Ye,rt,bt,Et){for(var Mt=new y,yt=[Mt],Ct=[0,Et];0!==yt.length;){var nt=Ct.pop(),ct=Ct.pop(),xt=yt.pop();if(nt-ct==0)xt.code=rt[ct],xt.data=$e[Ye[ct]];else{var At=S(rt,ct,nt);ct<=(xt.code=At)&&(xt.left=new y,yt.push(xt.left),Ct.push(ct,At)),At<nt&&(xt.right=new y,yt.push(xt.right),Ct.push(At+1,nt))}}return Mt}(W,Ue,ze,0,De-1):Ee?function $e(Ye,rt,bt,Et,Mt,yt){if(Mt-Et<yt){for(var Ct=new Array(Mt-Et+1),nt=Et,ct=0;nt<=Mt;nt++,ct++)Ct[ct]=Ye[rt[nt]];return new v(bt[Et],Ct)}var xt=S(bt,Et,Mt),At=$e(Ye,rt,bt,Et,xt,yt),Ut=$e(Ye,rt,bt,xt+1,Mt,yt);return new m(xt,At,Ut)}(W,Ue,ze,0,De-1,ce):function($e,Ye,rt,bt,Et,Mt){for(var yt=new y,Ct=[yt],nt=[0,Et];0!==Ct.length;){var ct=nt.pop(),xt=nt.pop(),At=Ct.pop();if(ct-xt<Mt){for(var Ut=new Array(ct-xt+1),Dt=xt,wn=0;Dt<=ct;Dt++,wn++)Ut[wn]=$e[Ye[Dt]];At.code=rt[xt],At.data=Ut}else{var tn=S(rt,xt,ct);xt<=(At.code=tn)&&(At.left=new y,Ct.push(At.left),nt.push(xt,tn)),tn<ct&&(At.right=new y,Ct.push(At.right),nt.push(tn+1,ct))}}return yt}(W,Ue,ze,0,De-1,ce),this._bucketSize=ce},M={root:{configurable:!0}};M.root.get=function(){return this._root},w.prototype.inOrder=function(W,Z){for(var B=this._root,K=[],ce=!1;!ce;)if(B)K.push(B),B=B.left;else if(0!==K.length){if(B=K.pop(),W.call(Z,B))break;B=B.right}else ce=!0;return this},w.prototype.preOrder=function(W,Z){for(var B=[this._root];0!==B.length;){var K=B.pop();W.call(Z,K)||(K.right&&B.push(K.right),K.left&&B.push(K.left))}return this},w.prototype.postOrder=function(W,Z){var B,K=[],ce=this._root;do{for(;ce;)ce.right&&K.push(ce.right),K.push(ce),ce=ce.left;ce=K.pop(),B=K.length-1,ce=ce.right&&K[B]===ce.right?(K[B]=ce).right:(W.call(Z,ce),null)}while(0!==K.length);return this},w.prototype.map=function(W,Z){var B=[];return this.inOrder(function(K){B.push(W.call(Z,K))}),B},w.prototype.height=function(){return function W(Z){return Z?1+Math.max(W(Z.left),W(Z.right)):0}(this._root)},w.prototype.toString=function(W){void 0===W&&(W=function(B){return B.code.toString()});var Z=[];return function B(K,ce,_e,Ee,xe){if(K){Ee(ce+(_e?"^-- ":"|-- ")+xe(K)+"\n");var Me=ce+(_e?"    ":"|   ");K.left&&B(K.left,Me,!1,Ee,xe),K.right&&B(K.right,Me,!0,Ee,xe)}}(this._root,"",!0,function(B){return Z.push(B)},W),Z.join("")},w.prototype.size=function(){var W=0;return this.preOrder(function(){W++}),W},Object.defineProperties(w.prototype,M);var N=function(W){return W.x},D=function(W){return W.y},P=function(W){return W.r};function L(W,Z,B,K){void 0===Z&&(Z=N),void 0===B&&(B=D),void 0===K&&(K=P);for(var ce,_e=function(Be){for(var De=Be.length-1;0<=De;De--){var ze=Math.floor(Math.random()*(De+1));ze=Math.max(Math.min(ze,De),0);var ke=Be[De];Be[De]=Be[ze],Be[ze]=ke}return Be}(W.slice()),Ee=_e.length,xe=[],Me=0;Me<Ee;){var Fe=_e[Me];ce&&J(ce,Z(Fe),B(Fe),K(Fe))?Me++:(ce=re(xe=V(xe,Fe,Z,B,K),Z,B,K),Me=0)}return ce}function V(W,Z,B,K,ce){var _e=B(Z),Ee=K(Z),xe=ce(Z),Me={x:_e,y:Ee,r:xe};if(se(Me,W,B,K,ce))return[Z];for(var Fe=0;Fe<W.length;++Fe){var Be=W[Fe],De=B(Be),ze=K(Be),ke=ce(Be);if(!X(Me,De,ze,ke)&&se(j(De,ze,ke,_e,Ee,xe),W,B,K,ce))return[W[Fe],Z]}for(var Ne=0;Ne<W.length-1;Ne++)for(var we=Ne+1;we<W.length;we++){var Ke=W[Ne],ut=W[we],Ue=B(Ke),je=K(Ke),Ve=ce(Ke),$e=B(ut),Ye=K(ut),rt=ce(ut);if(!X(j(Ue,je,Ve,$e,Ye,rt),_e,Ee,xe)&&!X(j(Ue,je,Ve,_e,Ee,xe),$e,Ye,rt)&&!X(j($e,Ye,rt,_e,Ee,xe),Ue,je,Ve)&&se(Y(Ue,je,Ve,$e,Ye,rt,_e,Ee,xe),W,B,K,ce))return[W[Ne],W[we],Z]}throw new Error}function X(W,Z,B,K){var ce=W.r-K,_e=Z-W.x,Ee=B-W.y;return 0<=ce&&_e*_e+Ee*Ee<ce*ce}function J(W,Z,B,K){var ce=W.r-K+1e-6,_e=Z-W.x,Ee=B-W.y;return 0<ce&&_e*_e+Ee*Ee<ce*ce}function se(W,Z,B,K,ce){for(var _e=0;_e<Z.length;++_e){var Ee=Z[_e];if(!J(W,B(Ee),K(Ee),ce(Ee)))return!1}return!0}function re(W,Z,B,K){return 1===W.length?{x:Z(W[0]),y:B(W[0]),r:K(W[0])}:2===W.length?j(Z(W[0]),B(W[0]),K(W[0]),Z(W[1]),B(W[1]),K(W[1])):Y(Z(W[0]),B(W[0]),K(W[0]),Z(W[1]),B(W[1]),K(W[1]),Z(W[2]),B(W[2]),K(W[2]))}function j(W,Z,B,K,ce,_e){var Ee=K-W,xe=ce-Z,Me=_e-B,Fe=Math.sqrt(Ee*Ee+xe*xe);return{x:(W+K+Ee/Fe*Me)/2,y:(Z+ce+xe/Fe*Me)/2,r:(Fe+B+_e)/2}}function Y(W,Z,B,K,ce,_e,Ee,xe,Me){var Fe=W-K,Be=W-Ee,De=Z-ce,ze=Z-xe,ke=_e-B,Ne=Me-B,we=W*W+Z*Z-B*B,Ke=we-K*K-ce*ce+_e*_e,ut=we-Ee*Ee-xe*xe+Me*Me,Ue=Be*De-Fe*ze,je=(De*ut-ze*Ke)/(2*Ue)-W,Ve=(ze*ke-De*Ne)/Ue,$e=(Be*Ke-Fe*ut)/(2*Ue)-Z,Ye=(Fe*Ne-Be*ke)/Ue,rt=Ve*Ve+Ye*Ye-1,bt=2*(B+je*Ve+$e*Ye),Et=je*je+$e*$e-B*B,Mt=-(rt?(bt+Math.sqrt(bt*bt-4*rt*Et))/(2*rt):Et/bt);return{x:W+je+Ve*Mt,y:Z+$e+Ye*Mt,r:Mt}}function he(W,Z,B,K,ce){var _e=K.X,Ee=K.Y,xe=K.R,Me=K.fx,Fe=K.fy,Be=K.masses,De=ce.friction,ze=ce.theta,ke=ce.charge,Ne=Math.floor(Math.log(Z.length));null===B&&(B=new w(Z,{getX:function(Ue){return _e[Ue]},getY:function(Ue){return Ee[Ue]},recursive:!0,bucketSize:Ne})).postOrder(function(Ue){var je,Ve,$e,Ye,rt,bt=0;if(void 0!==Ue.data)if(Ue.data.length){var Et=L(Ue.data,function(Cn){return _e[Cn]},function(Cn){return Ee[Cn]},function(Cn){return xe[Cn]});je=Et.x,Ve=Et.y,$e=Et.r;for(var Mt=0;Mt<Ue.data.length;Mt++)bt+=Be[Ue.data[Mt]]}else je=_e[rt=Ue.data],Ve=Ee[rt],$e=xe[rt],bt=Be[rt];else if(Ue.left&&Ue.right){var yt=Ue.left.cx,Ct=Ue.left.cy,nt=Ue.right.cx,ct=Ue.right.cy,xt=Ue.left.r,At=Ue.right.r,Ut=nt-yt,Dt=ct-Ct,wn=At-xt,tn=Math.sqrt(Ut*Ut+Dt*Dt);je=(yt+nt+Ut/tn*wn)/2,Ve=(Ct+ct+Dt/tn*wn)/2,$e=(tn+xt+At)/2,bt=Ue.left.mass+Ue.right.mass}else je=(Ye=Ue.left||Ue.right).cx,Ve=Ye.cy,$e=Ye.r,bt=Ye.mass;Ue.cx=je,Ue.cy=Ve,Ue.r=$e,Ue.mass=bt});for(var we=Z.length,Ke=function(Ue){var je=Z[Ue],Ve=_e[je],$e=Ee[je],Ye=xe[je];B.preOrder(function(rt){var Et=0,Mt=0,yt=Ve-rt.cx||r(),Ct=$e-rt.cy||r(),nt=yt*yt+Ct*Ct,ct=Ye+rt.r;if(rt.data){if(rt.data===je)return!1;if(rt.data.length)for(var xt=0;xt<rt.data.length;xt++){var At=rt.data[xt];At!==je&&(nt=(yt=Ve-_e[At]||r())*yt+(Ct=$e-Ee[At]||r())*Ct,ct=Ye+xe[At],nt<1&&(nt=Math.sqrt(1*nt)),Me[je]+=yt*(Et=W*(ke*Be[At])/nt),Fe[je]+=Ct*Et)}else nt<1&&(nt=Math.sqrt(1*nt)),nt<ct*ct&&(nt=De*ct*ct),Me[je]+=yt*(Et=W*(ke*rt.mass)/nt),Fe[je]+=Ct*Et}else if((Mt=ct/ze)*Mt<=nt)return nt<1&&(nt=Math.sqrt(1*nt)),nt<ct*ct&&(nt=De*ct*ct),Me[je]+=yt*(Et=W*(ke*rt.mass)/nt),Fe[je]+=Ct*Et,!0})},ut=0;ut<we;ut++)Ke(ut);return B}function pe(W,Z,B,K){for(var ce=B.sources,_e=B.targets,Ee=B.X,xe=B.Y,Me=B.R,Fe=B.fx,Be=B.fy,De=B.degrees,ze=K.edgeStrength,ke=K.edgeLength,Ne=0;Ne<Z.length;Ne++){var we=Z[Ne],Ke=ce[we],ut=_e[we],Ue=De[Ke]+1,je=De[ut]+1,Ve=Ee[ut]+Fe[ut]-Ee[Ke]-Fe[Ke]||r(),$e=xe[ut]+Be[ut]-xe[Ke]-Be[Ke]||r(),Ye=Ve*Ve+$e*$e,rt=Math.sqrt(Ye),bt=ke+Me[Ke]+Me[ut];if(!(rt<=bt)){var Et=bt-rt,Mt=W*ze*Et*Et/Ye/Math.min(Ue,je);$e*=Mt;var yt=je/(je+Ue);Fe[Ke]+=(Ve*=Mt)*yt,Be[Ke]+=$e*yt,Fe[ut]-=Ve*(1-yt),Be[ut]-=$e*(1-yt)}}}function Ae(W,Z,B,K){for(var ce=B.pinned,_e=B.X,Ee=B.Y,xe=B.fx,Me=B.fy,Fe=K.gravity,Be=K.cx,De=K.cy,ze=0,ke=0,Ne=Z.length,we=0;we<Ne;we++)ze+=_e[we],ke+=Ee[we];ze=ze/Ne-Be,ke=ke/Ne-De;for(var Ke=0;Ke<Ne;Ke++){var ut=Z[Ke];ce[ut]||(_e[ut]-=ze,Ee[ut]-=ke)}for(var Ue=0;Ue<Ne;Ue++){var je=Z[Ue],Ve=Be-_e[je]||r(),$e=De-Ee[je]||r(),Ye=Fe*W;xe[je]+=Ve*Ye,Me[je]+=$e*Ye}}he.initialize=function(W,Z,B){for(var K=Z.X,ce=Z.Y,_e=Z.R,Ee=Z.degrees,xe=Z.layer,Me=Z.pinned,Fe=Z.component,Be=Z.masses,De=Z.nodeIds,ze=B.scaling,ke=B.defaultRadius,Ne=W.length,we=1/0,Ke=1/0,ut=-1/0,Ue=-1/0,je=Math.PI*(3-Math.sqrt(5)),Ve=0;Ve<W.length;Ve++){var $e=W[Ve],Ye=$e.x,rt=$e.y,bt=$e.r,Et=$e.mass;if(isNaN(Ye)||isNaN(rt)){var Mt=10*Math.sqrt(Ve),yt=Ve*je;Ye=Mt*Math.cos(yt),rt=Mt*Math.sin(yt)}K[Ve]=Ye,ce[Ve]=rt,_e[Ve]=bt||ke,Me[Ve]=$e.pinned?1:0,xe[Ve]=$e.layer,Fe[Ve]=$e.component,Be[Ve]=void 0===Et?(1+Ee[Ve])*ze:Et,De[Ve]=Ve,Ye<we&&(we=Ye),rt<Ke&&(Ke=rt),ut<Ye&&(ut=Ye),Ue<rt&&(Ue=rt)}if(1<W.length&&(ut-we==0||Ue-Ke==0))for(var Ct=(we+ut)/2,nt=(Ke+Ue)/2,ct=0;ct<Ne;ct++)if(!Me[ct]){var xt=10*Math.sqrt(ct),At=ct*je,Ut=Ct+xt*Math.cos(At),Dt=nt+xt*Math.sin(At);(K[ct]=Ut)<we&&(we=Ut),(ce[ct]=Dt)<Ke&&(Ke=Dt),ut<Ut&&(ut=Ut),Ue<Dt&&(Ue=Dt)}},pe.initialize=function(W,Z){for(var B=Z.edgeIds,K=Z.sources,ce=Z.targets,_e=Z.degrees,Ee=0;Ee<W.length;Ee++){var xe=W[Ee],Me=xe.source,Fe=xe.target;K[Ee]=Me,ce[Ee]=Fe,_e[Me]++,_e[Fe]++,B[Ee]=Ee}},Ae.initialize=function(W,Z,B){var K=Z.X,ce=Z.Y,_e=B.cx,Ee=B.cy,xe=W.length;if(void 0===_e||void 0===Ee){_e=Ee=0;for(var Me=0;Me<xe;Me++)_e+=K[Me],Ee+=ce[Me];_e/=xe,Ee/=xe}B.cx=_e,B.cy=Ee};var ot,at,We=function(){this.ids=[],this.xmin=1/0,this.ymin=1/0,this.xmax=-1/0,this.ymax=-1/0,this.x=0,this.y=0,this.w=0,this.h=0,this.cx=0,this.cy=0,this.radius=0,this.mx=0,this.my=0,this.m=0,this.maxr=0};function vt(W,Z){return(W+Z)*(W+Z+1)/2+Z}function Ge(W,Z,B,K){var ce=B.X,_e=B.Y,Ee=B.R,xe=B.components,ke=K.update,Ne=K.onUpdate,we=K.placement,Ke=K.placementOffset;if(K.alignSiblings&&(function(W,Z,B){var ce=W.sources,_e=W.targets,Ee=W.pinned,xe=W.degrees,Me=W.X,Fe=W.Y,Be=W.R;void 0===Z&&(Z=0),void 0===B&&(B=.5);for(var De={},ze={},ke=0,Ne=W.edgeIds;ke<Ne.length;ke+=1){var we=Ne[ke],Ke=ce[we],ut=_e[we];Ke!==ut&&(De[Ke]=De[Ke]||{},De[ut]=De[ut]||{},De[Ke][ut]=!0,De[ut][Ke]=!0)}Object.keys(De).forEach(function(Ue){var je,Ve,$e=Number(Ue),Ye=Object.keys(De[Number($e)]);if(2===Ye.length){var rt=Ye[0],bt=Ye[1],Et=(je=Number(rt))<(Ve=Number(bt))?je*Ve+Math.pow(Ve-je-1,2)/4:je*Ve+Math.pow(je-Ve-1,2)/4;Et in ze||(ze[Et]=[Number(bt),Number(rt)]),Ee[$e]||ze[Et].push($e)}}),Object.keys(ze).forEach(function(Ue){var je=ze[Number(Ue)],Ve=je[0],$e=je[1],Ye=je.slice(2);if(1!==Ye.length){var rt=Me[Ve],bt=Fe[Ve],Et=Me[$e],Mt=Fe[$e],yt=xe[Ve],Ct=.25+.5*yt/(yt+xe[$e]),nt=rt+(Et-rt)*Ct,ct=bt+(Mt-bt)*Ct,xt=-(Mt-bt),At=Et-rt,Ut=Math.sqrt(Math.pow(rt-Et,2)+Math.pow(bt-Mt,2));xt=-2*xt/Ut,At=-2*At/Ut;var Dt=Math.acos(xt/Math.sqrt(xt*xt+At*At));0<Z&&(Dt<Z||Dt>Math.PI-Z&&Dt<=Math.PI?(xt=2*Math.cos(Math.PI-Z),At=2*Math.sin(Math.PI-Z)):(Dt>2*Math.PI-Z||Dt>=Math.PI&&Dt<Math.PI+Z)&&(xt=2*Math.cos(Z),At=2*Math.sin(Z)));var wn=0,tn=1;Ye.sort(function(fi,xn){return Be[xn]-Be[fi]});var Cn=0,Dn=0,Mn=Math.max(Be[Ye[0]],Be[Ye[1]])/2;Ye.length%2==1&&(wn=1,nt-=xt*Mn,ct-=At*Mn);for(var Zn=1+B,nn=0;nn<Ye.length;nn++){var pn=(wn+nn)%2,Rn=Ye[nn],In=2<=nn?Be[Rn]:Mn,Nn=(pn?Cn:Dn)+In;Me[Rn]=nt+xt*tn*Nn,Fe[Rn]=ct+At*tn*Nn,pn?Cn+=In*Zn:Dn+=In*Zn,tn=-tn}}})}({X:ce,Y:_e,R:Ee,degrees:B.degrees,pinned:B.pinned,sources:B.sources,targets:B.targets,edgeIds:B.edgeIds},K.siblingsMinAngle,K.siblingsOffset),ke(W,ce,_e)),we in ot){var Ve=function(wn,tn,Cn,Dn){for(var Mn=0,Zn=[],nn=0,pn=Dn;nn<pn.length;nn+=1){for(var Rn=pn[nn],In=new We,Nn=0,fi=Rn;Nn<fi.length;Nn+=1){var xn=fi[Nn];In.add(xn,wn[xn],tn[xn],Cn[xn])}Zn.push(In.measure()),Rn.length>Zn[Mn].ids.length&&(Mn=Zn.length-1)}return{boxes:Zn,biggest:Mn}}(ce,_e,Ee,xe),$e=Ve.boxes,Ye=Ve.biggest;if(we===ot.spiral)!function(wn,tn,Cn,Dn,Mn){void 0===tn&&(tn=20);for(var Zn=0,nn=wn;Zn<nn.length;Zn+=1){var pn=nn[Zn],Rn=L(pn.ids,function(zn){return Cn[zn]},function(zn){return Dn[zn]},function(zn){return Mn[zn]}),Nn=Rn.y,fi=Rn.r;pn.cx=Rn.x,pn.cy=Nn,pn.radius=fi+tn}for(var xn=wn.slice().sort(function(zn,uo){return zn.radius-uo.radius}),br=xn.map(function(zn){return{x:zn.cx,y:zn.cy,r:zn.radius}}),wi=xn.pop(),ni=3*Math.PI/2,er=wi.radius,ki=2*Math.PI,Oi=wi.cx,Lr=wi.cy,Wr=[wi],Co=function(){var zn=xn[xn.length-1],uo=er+zn.radius,ds=Oi+Math.cos(ni)*uo,$s=Lr+Math.sin(ni)*uo;Wr.some(function(Vu){var eu=Vu.cx-ds,Oa=Vu.cy-$s;return Math.sqrt(eu*eu+Oa*Oa)<Vu.radius+zn.radius})?er+=1:(zn.x=ds-zn.w/2,zn.y=$s-zn.h/2,zn.cx=ds,zn.cy=$s,br[xn.length-1].x=ds,br[xn.length-1].y=$s,Wr.push(xn.pop()),ni+=(2*zn.radius+1)/uo*1%ki)};0!==xn.length;)Co()}($e,Ke,ce,_e,Ee);else{if(we!==ot.box)return;!function(W,Z){void 0===Z&&(Z=1),function(B){for(var K=0,ce=0,_e=0,Ee=B;_e<Ee.length;_e+=1){var xe=Ee[_e];K+=xe.w*xe.h,ce=Math.max(ce,xe.w)}B.sort(function(ut,Ue){return Ue.h-ut.h});for(var Me=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(K/.95)),ce),h:1/0}],Fe=0,Be=0,De=0,ze=B;De<ze.length;De+=1)for(var ke=ze[De],Ne=Me.length-1;0<=Ne;Ne--){var we=Me[Ne];if(!(ke.w>we.w||ke.h>we.h)){if(ke.x=we.x,ke.y=we.y,Be=Math.max(Be,ke.y+ke.h),Fe=Math.max(Fe,ke.x+ke.w),ke.w===we.w&&ke.h===we.h){var Ke=Me.pop();Ne<Me.length&&(Me[Ne]=Ke)}else ke.h===we.h?(we.x+=ke.w,we.w-=ke.w):(ke.w===we.w||Me.push({x:we.x+ke.w,y:we.y,w:we.w-ke.w,h:ke.h}),we.y+=ke.h,we.h-=ke.h);break}}}(W.map(function(B){return B.w+=B.maxr+Z,B.h+=B.maxr+Z,B}).sort(function(B,K){return B.w*B.h-K.w*K.h}))}($e,Ke)}for(var rt=$e[Ye].xmin-$e[Ye].x,bt=$e[Ye].ymin-$e[Ye].y,Et=0,Mt=$e;Et<Mt.length;Et+=1)for(var yt=Mt[Et],ct=yt.xmin-yt.x-rt,xt=yt.ymin-yt.y-bt,At=0,Ut=yt.ids;At<Ut.length;At+=1){var Dt=Ut[At];ce[Dt]-=ct,_e[Dt]-=xt}ke(W,ce,_e),Ne()}}function qe(W,Z,B,K,ce,_e){var Ee,xe=B.X,Me=B.Y,Fe=B.R,Be=B.degrees,De=B.nodeIds,ze=B.edgeIds,ke=B.layers,Ne=B.layer,we=B.cluster,Ke=B.masses,ut=B.weights,Ue=B.sources,je=B.targets,Ve=K.cx,$e=K.cy,Ye=K.nextTick,rt=K.cancelTick,bt=K.update,Et=K.onUpdate,Mt=K.batch,Ct=K.steps,nt=K.minMovement,ct=ke.slice(),xt=0;function At(){rt(Ee),bt(W,xe,Me),Et(),_e()}for(var Ut={},Dt=0;Dt<Z.length;Dt++)Ut[Number(Z[Dt].id)||Dt]=Dt;for(var wn=new Map,tn=0;tn<ze.length;tn++){var Cn=ze[tn];wn.set(vt(Ue[Cn],je[Cn]),Cn)}for(var Dn=0;Dn<ke.length;Dn++){for(var Mn=ke[Dn],Zn=Dn,nn=0;nn<Mn.length;nn++){var pn=Mn[nn],Rn=we[pn];-1!==Rn&&(Ke[Rn]+=Ke[pn])}for(var In=0;In<Z.length;In++){var Nn=Z[In],fi=Number(Nn.id)||In,xn=Nn.source,br=Nn.target,wi=ut[Ut[fi]];if(Ne[xn]===Zn&&Ne[br]===Zn){var ni=we[xn],er=we[br];if(ni!==er){var ki=wn.get(vt(ni,er));void 0!==ki&&(ut[ki]+=wi)}}}}De.length=0,ze.length=0;var Oi,Lr,Wr=1,zn=1-Math.pow(.1,1/Ct/2),uo=(Wr-.1)/Ct,ds=.5;return Ee=setTimeout(function $s(){var Vu=ce(Wr+=(0-Wr)*zn,De,ze),eu=Wr<=ds||Vu<nt;if(0===xt||eu){var Oa=ct.pop();if(Oa){Oi&&(Lr=Oi.reduce(function(cd,hd){return Math.max(cd,Ve-xe[hd],$e-Me[hd])},0)),De.push.apply(De,Oa);for(var Ch=0;Ch<Oa.length;Ch++){var Na=Oa[Ch],Uu=we[Na];if(-1!==Uu){var My=1<Be[Na]?2:1,Iy=Fe[Uu]+Fe[Na];Ke[Uu]-=Ke[Na],xe[Na]=xe[Uu]+My*Iy*(2*n()-1),Me[Na]=Me[Uu]+My*Iy*(2*n()-1)}else Oi&&(xe[Na]=Ve+2*Lr*(1-2*n()),Me[Na]=$e+2*Lr*(1-2*n()))}Oi=Oa;for(var ky=De.reduce(function(cd,hd){return cd[hd]=!0,cd},{}),Th=ze.length=0;Th<Z.length;Th++){var Mh=Z[Th];ky[Mh.source]&&ky[Mh.target]&&ze.push(Ut[Number(Mh.id)])}eu=!1,Wr=0===ct.length?.2:.1+2*uo,ds=.1}}xt%Mt==0&&(bt(W,xe,Me),Et()),++xt>=Infinity||eu?At():Ee=Ye($s)}),{done:!1,stop:function(){return At(),this},get iterations(){return xt}}}function Le(W,Z,B){for(var K=B.X,ce=B.Y,_e=B.fx,Ee=B.fy,xe=B.pinned,Me=0,Fe=W.length,Be=0;Be<Fe;Be++){var De=W[Be],ze=_e[De]*=Z,ke=Ee[De]*=Z;if(xe[De])_e[De]=Ee[De]=0;else{var Ne=ze,we=ke;if(1e4<Ne||1e4<we){var Ke=Math.sqrt(Ne*Ne+we*we);we/=Ke,Ne/=Ke}K[De]+=Ne,ce[De]+=we,Me+=.5*(Ne*Ne+we*we)}}return Me}We.prototype.add=function(W,Z,B,K){this.ids.push(W),Z-K<this.xmin&&(this.xmin=Z-K),B-K<this.ymin&&(this.ymin=B-K),Z+K>this.xmax&&(this.xmax=Z+K),B+K>this.ymax&&(this.ymax=B+K),K>this.maxr&&(this.maxr=K),this.mx+=K*Z,this.my+=K*B,this.m+=K},We.prototype.measure=function(W){return void 0===W&&(W=0),this.w=this.xmax-this.xmin+2*W,this.h=this.ymax-this.ymin+2*W,this.cx=this.mx/this.m,this.cy=this.my/this.m,this.x=this.xmin,this.y=this.ymin,this.radius=Math.sqrt(this.w*this.w+this.h*this.h)/2,this},(at=ot=ot||{}).none="none",at.box="box",at.spiral="spiral";var He=0,Je="undefined"==typeof window,et="undefined"!=typeof performance&&performance.now?performance:Date,Te=Je?function(W){var Z=et.now(),B=Math.max(0,16-(Z-He)),K=setTimeout(function(){return W(Z+B)},B);return He=Z+B,K}:window.requestAnimationFrame,Re=Je?function(W){return clearTimeout(W)}:window.cancelAnimationFrame;function Ze(W,Z,B){for(var K=0;K<W.length;K++){var ce=W[K];ce.x=Z[K],ce.y=B[K]}}function Qe(){}function dt(W){for(var Z in void 0===W&&(W={}),this.onUpdate=Qe,this.update=Ze,this.nextTick=Te,this.cancelTick=Re,this.onEnd=Qe,this.charge=10,this.maxIterations=1e3,this.minMovement=.1,this.edgeLength=30,this.edgeStrength=2,this.friction=.1,this.elasticity=.9,this.margin=1,this.cx=void 0,this.cy=void 0,this.gravity=.01,this.theta=.34,this.batch=1,this.inertia=.9,this.integrator=0,this.multilevel=!1,this.placement=ot.none,this.placementOffset=10,this.alignSiblings=!1,this.siblingsMinAngle=0,this.siblingsOffset=.15,this.steps=300,this.scaling=1,this.defaultRadius=1,W)void 0!==W[Z]&&(this[Z]=W[Z])}function Kt(W){var Z=W.nodes.length,B=W.edges.length;i(Z+B),this.X=new Array(Z),this.Y=new Array(Z),this.R=new Array(Z),this.fx=new Float32Array(Z),this.fy=new Float32Array(Z),this.vx=new Float32Array(Z),this.vy=new Float32Array(Z),this.pinned=new Uint8Array(Z),this.masses=new Float32Array(Z),this.weights=new Float32Array(B),this.sources=new Uint16Array(B),this.targets=new Uint16Array(B),this.degrees=new Uint32Array(Z),this.layer=new Uint32Array(Z),this.parent=new Int32Array(Z),this.cluster=new Int32Array(Z),this.component=new Uint16Array(Z),this.components=[],this.layers=[],this.nodeIds=new Array(Z),this.edgeIds=new Array(B),function(W,Z,B){(function(K,ce,_e){for(var Ee=_e.sources,xe=_e.targets,Me=_e.degrees,Fe=_e.nodeIds,Be=_e.edgeIds,De={},ze=0;ze<K.length;ze++)De[ze]=Fe[ze]=ze;for(var ke=0;ke<ce.length;ke++){var Ne=ce[ke],ut=De[Ne.source],Ue=De[Ne.target];Be[ke]=ke,Ee[ke]=ut,xe[ke]=Ue,Me[ut]++,Me[Ue]++}})(W,Z,B),function(K){for(var ce=K.nodeIds,_e=K.edgeIds,Ee=K.sources,xe=K.targets,Me=K.degrees,Fe=K.layer,Be=K.layers,De=K.component,ze=K.components,ke=K.cluster,Ne=K.parent,we=0,Ke=1,ut=new Uint32Array(ce.length),Ue=0;Ue<ce.length;Ue++)ut[Ue]=Me[Ue];for(var je=new Array(ce.length),Ve=0;Ve<_e.length;Ve++){var $e=_e[Ve],Ye=Ee[$e],rt=xe[$e];je[Ye]=je[Ye]||[],je[rt]=je[rt]||[],je[Ye].push(rt),je[rt].push(Ye)}var bt=new Uint8Array(ce.length),Et=new Uint8Array(ce.length);Ne.fill(-1);for(var Mt=0,yt=0;yt<ce.length;yt++)if(0===bt[yt]){for(var Ct=[yt];0!==Ct.length;){var nt=Ct.pop();0===bt[nt]&&(Ct.push.apply(Ct,je[nt]),bt[nt]=1,De[nt]=Mt)}Mt++}for(var ct=new Array(ce.length),xt=0;xt<ce.length;xt++)Fe[xt]=0,ct[xt]=xt;for(;0!==ct.length;){for(var At=[],Ut=[],Dt=0;Dt<ct.length;Dt++)ut[ct[Dt]]<=we&&(At.push(Dt),Ut.push(ct[Dt]));for(var wn=0;wn<Ut.length;wn++){var tn=Ut[wn];Et[tn]=we,Fe[tn]=Ke;var Cn=je[tn];if(Cn)for(var Dn=0;Dn<Cn.length;Dn++)ut[Cn[Dn]]--}for(var Mn=0;Mn<Ut.length;Mn++){var Zn=Ut[Mn],nn=je[Zn];if(nn)for(var pn=0;pn<nn.length;pn++){var Rn=nn[pn],In=Fe[Rn];if(void 0===In||Ke<In){Ne[Zn]=Rn;break}}}At.reverse();for(var Nn=0;Nn<At.length;Nn++)ct.splice(At[Nn],1);if(Ke+=1,0<ct.length){for(var fi=1/0,xn=0;xn<ct.length;xn++){var br=ut[ct[xn]];br<fi&&(fi=br)}we+1<=fi&&(we=fi,Ke=1)}}bt.fill(0);for(var wi=0;wi<ce.length;wi++){var ni=ce[wi],er=Fe[ni];if(-1===Ne[ni]||Fe[Ne[ni]]===er){var ki=[ni];for(bt.fill(0);0!==ki.length;){var Oi=ki.pop();if(!bt[Oi]){if(Fe[Oi]>er){Ne[ni]=Oi;break}var Lr=je[Oi];bt[Oi]=1,Lr&&ki.push.apply(ki,Lr)}}}}for(var Wr=0;Wr<ce.length;Wr++){var Co=ce[Wr],zn=De[Co];ze[zn]=ze[zn]||[],ze[zn].push(Co);var uo=Fe[Co]-1;Be[uo]=Be[uo]||[],Be[uo].push(Co),ke[Co]=Ne[Co]}}(B)}(W.nodes,W.edges,this)}function ln(W){this.promise=new Promise(W)}ln.prototype.then=function(W){return this.promise.then(W)},ln.prototype.stop=function(){return this.simulation.stop(),this},ln.prototype.iterations=function(){return this.simulation.iterations};var an={euler:function(W,Z,B){for(var K=B.X,ce=B.Y,_e=B.fx,Ee=B.fy,xe=B.vx,Me=B.vy,Fe=B.masses,Be=B.pinned,De=0,ze=0,ke=W.length,Ne=0;Ne<ke;Ne++){var we=W[Ne],Ke=Fe[we],ut=_e[we]/Ke,Ue=Ee[we]/Ke;xe[we]+=1/8*ut,Me[we]+=1/8*Ue;var je=.2*xe[we]*(1/8)+.5*ut*(1/8)*(1/8),Ve=.2*Me[we]*(1/8)+.5*Ue*(1/8)*(1/8);_e[we]=Ee[we]=0,Be[we]||(K[we]+=je,ce[we]+=Ve,De+=Math.abs(je)*Ke,ze+=Math.abs(Ve)*Ke)}return(De*De+ze*ze)/ke},verlet:Le,leapfrog:function(W,Z,B){for(var K=B.X,ce=B.Y,_e=B.fx,Ee=B.fy,xe=B.vx,Me=B.vy,Fe=B.pinned,Be=B.masses,De=W.length,ze=0,ke=0;ke<De;ke++){var Ne=W[ke],we=Be[Ne],Ue=xe[Ne]+_e[Ne]/we*1,je=Me[Ne]+Ee[Ne]/we*1,Ve=1*Ue,$e=1*je;1e4<Ve&&(Ve=.1),1e4<$e&&($e=.1),xe[Ne]=Z*(Ue+xe[Ne])/2,Me[Ne]=Z*(je+Me[Ne])/2,_e[Ne]=Ee[Ne]=0,Fe[Ne]||(K[Ne]+=Ve,ce[Ne]+=$e),ze+=.5*(Ve*Ve+$e*$e)}return ze}};function hn(W,Z){var B,K;function ce(ze){return void 0===ze&&(ze={nodes:[],edges:[]}),i(vt((B=ze.nodes).length,(K=ze.edges).length)),new Kt(ze)}function _e(ze){return void 0===ze&&(ze={}),new dt(ze)}void 0===Z&&(Z={});var Ee=ce(W),xe=_e(Z);function Me(ze,ke,Ne){return De=null,ke.length<=1?0:(De=he(ze,ke,De,Ee,xe),pe(ze,Ne,Ee,xe),0!==xe.elasticity&&function(we,Ke,ut,Ue){var je=ut.X,Ve=ut.Y,$e=ut.R,Ye=ut.fx,rt=ut.fy,bt=Ue.margin,Et=Ue.elasticity;if(0!==Et){if(!Ke){var Mt=Math.floor(Math.log(we.length));(Ke=new w(we,{getX:function(nt){return je[nt]},getY:function(nt){return Ve[nt]},bucketSize:Mt})).postOrder(function(nt){var ct,xt,At,Ut,Dt;if(nt.data)ct=je[Dt=nt.data],xt=Ve[Dt],At=$e[Dt];else if(nt.left&&nt.right){var wn=nt.left.cx,tn=nt.left.cy,Cn=nt.right.cx,Dn=nt.right.cy,Mn=nt.left.r,Zn=nt.right.r,nn=Cn-wn,pn=Dn-tn,Rn=Zn-Mn,In=Math.sqrt(nn*nn+pn*pn);ct=(wn+Cn+nn/In*Rn)/2,xt=(tn+Dn+pn/In*Rn)/2,At=(In+Mn+Zn)/2}else(Ut=nt.left||nt.right)&&(ct=Ut.cx,xt=Ut.cy,At=Ut.r);nt.cx=ct,nt.cy=xt,nt.r=At})}for(var yt=function(nt){var ct=we[nt],xt=je[ct]+Ye[ct],At=Ve[ct]+rt[ct],Ut=$e[ct];Ke.preOrder(function(Dt){if(!Dt.data){var wn=Dt.cx-xt,tn=Dt.cy-At,Cn=Dt.r+Ut;return Cn*Cn<wn*wn+tn*tn}if(Dt.data.length)for(var Dn=0;Dn<Dt.data.length;Dn++){var Mn=Dt.data[Dn];if(ct<Mn){var Zn=$e[Mn],nn=xt-je[Mn],pn=At-Ve[Mn],Rn=Ut+Zn+bt,In=nn*nn+pn*pn;if(In<Rn*Rn){0===nn&&(In+=(nn=r())*nn),0===pn&&(In+=(pn=r())*pn);var Nn=(Rn-(In=Math.sqrt(In)))*Et/In,fi=Zn/Rn;Ye[ct]+=nn*Nn*fi,rt[ct]+=pn*Nn*fi,Ye[Mn]-=nn*Nn*(1-fi),rt[Mn]-=pn*Nn*(1-fi)}}}else{var xn=Dt.data;if(ct<xn){var br=$e[xn],wi=xt-je[xn],ni=At-Ve[xn],er=Ut+br+bt,ki=wi*wi+ni*ni;if(ki<er*er){0===wi&&(ki+=(wi=r())*wi),0===ni&&(ki+=(ni=r())*ni);var Oi=(er-(ki=Math.sqrt(ki)))*Et/ki,Lr=br/er;Ye[ct]+=wi*Oi*Lr,rt[ct]+=ni*Oi*Lr,Ye[xn]-=wi*Oi*(1-Lr),rt[xn]-=ni*Oi*(1-Lr)}}}})},Ct=0;Ct<we.length;Ct++)yt(Ct)}}(ke,De,Ee,xe),Ae(ze,ke,Ee,xe),Be(ke,xe.inertia,Ee))}ce(W),_e(Z),pe.initialize(K,Ee),he.initialize(B,Ee,xe),Ae.initialize(B,Ee,xe);var Fe,Be=an[xe.integrator]||Le,De=null;return{setOptions:_e,setGraph:ce,start:function(){return Fe=(xe.multilevel?qe:function(ze,ke,Ne,we,Ke,ut){function Ue(){wn=!0,Et(je),xt(),ut()}var je,Ve=Ne.X,$e=Ne.Y,Ye=Ne.nodeIds,rt=Ne.edgeIds,bt=we.nextTick,Et=we.cancelTick,Mt=we.batch,yt=we.maxIterations,nt=we.minMovement,ct=we.update,xt=we.onUpdate,At=0,Ut=1,Dt=1-Math.pow(.1,1/we.steps),wn=!1,tn=function(){var Cn=Ke(Ut+=(0-Ut)*Dt,Ye,rt),Dn=wn||Ut<.1||Cn<=nt;At%Mt==0&&(ct(ze,Ve,$e),xt()),++At<yt&&!Dn?je=bt(tn):Ue()};return je=setTimeout(tn),{done:!1,stop:function(){return Ue(),this},get iterations(){return At}}})(B,K,Ee,xe,Me,function(){Fe.done||Ge(B,0,Ee,xe),xe.onEnd(),Fe.done=!0}),this},iterations:function(){return Fe.iterations},data:function(){return Ee},stop:function(){return Fe&&Fe.stop(),this},step:function(ze){return void 0===ze&&(ze=1),Me(ze,Ee.nodeIds,Ee.edgeIds),this}}}return hn.run=function(W,Z){var B,K=new ln(function(ce){Z.onEnd=ce,B=hn(W,Z).start()});return K.simulation=B,K.stop=function(){return B.stop(),K},K.iterations=function(){return B.iterations},K},hn}().apply(this,arguments)}var bS={imports:{force:yv},configure:function(e,t){var n=t.graph,i=e.nodes._indexes,r=n.getNodeAttribute("x").getMultiple(i),o=n.getNodeAttribute("y").getMultiple(i),a=n.getNodeAttribute("radius").getMultiple(i),s=n.getNodeAttribute("layoutable").getMultiple(i),l=e.nodes.getAdjacentEdges(),u=[],d=[],c={};e.edgeStrength=void 0!==e.edgeStrength?1.5*e.edgeStrength:.75,null==e.gravity&&(e.gravity=.05),null==e.siblingsOffset&&(e.siblingsOffset=0),e.alignSiblings=!!e.alignSiblings;for(var h=e.radiusRatio||1.25,p=0;p<e.nodes._indexes.length;p++)c[e.nodes._indexes[p]]=p,u.push({id:p,x:r[p],y:o[p],r:a[p]*h,pinned:!s[p]});l.forEach(function(x){var v=c[x.getSource()._index],y=c[x.getTarget()._index];v!==y&&void 0!==v&&void 0!==y&&d.push({source:v,target:y})});var m=Hi(It({},e));return delete m.nodes,{graph:{nodes:u,edges:d},options:m,indexes:e.nodes._indexes,done:!1,x:r,y:o}},update:function(e,t){if(!t.simulation){t.graph=e.graph,t.options=e.options,t.indexes=e.indexes,e.options.nextTick=function(a){return a()},e.options.update=function(a,s,l){t.x=s,t.y=l},e.options.onEnd=function(){return t.done=!0};var n=yv(e.graph,e.options).start(),i=n.data(),r=i.X,o=i.Y;t.simulation=n,t.x=r,t.y=o}return{graph:t.graph,indexes:t.indexes,x:t.x,y:t.y}},context:function(){return{done:!1,graph:null,x:null,y:null,indexes:null}},isRunning:function(e){return!e.done},onSync:function(e){return{indexes:e.indexes,x:e.x,y:e.y}}};function xv(e,t,n,i){var r;if(i)r=i;else{r=new Uint32Array(e.length);for(var o=0,a=e.length;o<a;o++)r[o]=o}var s=n?function(d,c,h,p,g,m){var x=h-d,v=p-c,y=m-g,b=Math.sqrt(x*x+v*v);return[(d+h+x/b*y)/2,(c+p+v/b*y)/2,(b+g+m)/2]}:function(d,c,h,p){var g=d-h,m=c-p;return[(d+h)/2,(c+p)/2,Math.sqrt(g*g+m*m)/2]},l=n?function(d,c,h,p,g,m,x,v,y){var b=2*(d-h),S=2*(c-p),w=2*(v-x),M=d*d+c*c-x*x-h*h-p*p+v*v,N=2*(d-g),D=2*(c-m),P=2*(y-x),L=d*d+c*c-x*x-g*g-m*m+y*y,V=N*S-b*D,X=(S*L-D*M)/V-d,J=(D*w-S*P)/V,se=(N*M-b*L)/V-c,re=(b*P-N*w)/V,j=J*J+re*re-1,Y=2*(X*J+se*re+x),pe=(-Y-Math.sqrt(Y*Y-4*j*(X*X+se*se-x*x)))/(2*j);return[X+J*pe+d,se+re*pe+c,pe]}:function(d,c,h,p,g,m){var x=2*(d*(p-m)+h*(m-c)+g*(c-p));if(0==x)return null;var v=((d*d+c*c)*(p-m)+(h*h+p*p)*(m-c)+(g*g+m*m)*(c-p))/x,y=((d*d+c*c)*(g-h)+(h*h+p*p)*(d-g)+(g*g+m*m)*(h-d))/x,b=v-d,S=y-c;return[v,y,Math.sqrt(b*b+S*S)]},u=n?Xf:Yf;return n=n||[],function d(c,h,p,g,m,x,v,y,b){var S,w,M,N,P,L,V,X,J,se,re=null;if(0===p||3===h.length)w=g,M=m,N=x,P=b,J=null,1===(se=(S=h).length)?J=[w[L=S[0]],M[L],N[L]||0]:2===se?J=y(w[L=S[0]],M[L],w[V=S[1]],M[V],N[L],N[V]):3===se&&(J=P(w[L=S[0]],M[L],w[V=S[1]],M[V],w[X=S[2]],M[X],N[L],N[V],N[X])),re=J;else{var j=c[p-1];null!==(re=d(c,h,p-1,g,m,x,v,y,b))&&v(re,g[j],m[j],x[j])||(h.push(j),re=d(c,h,p-1,g,m,x,v,y,b),h.pop())}return re}(r=function(d){for(var c=d.length-1;0<=c;c--){var h=Math.floor(Math.random()*(c+1));h=Math.max(Math.min(h,c),0);var p=d[c];d[c]=d[h],d[h]=p}return d}(r),[],r.length,e,t,n,u,s,l)}function bv(e){for(var t,n,i,r=e.length,o=[0,1],a=2,s=2;s<r;s++){for(;1<a&&((n=e[o[a-1]])[0]-(t=e[o[a-2]])[0])*((i=e[s])[1]-t[1])-(n[1]-t[1])*(i[0]-t[0])<=0;)--a;o[a++]=s}return o.slice(0,a)}function rh(e){var t=e.length;if(t<3)return null;for(var n=new Array(t),i=new Array(t),r=0;r<t;r++)n[r]=[+e[r][0],+e[r][1],r];for(n.sort(function(h,p){return h[0]-p[0]||h[1]-p[1]}),r=0;r<t;r++)i[r]=[n[r][0],-n[r][1]];var o=bv(n),a=bv(i),u=a[0]===o[0],d=a[a.length-1]===o[o.length-1]?1:0,c=[];for(r=o.length-1;0<=r;--r)c.push(e[n[o[r]][2]]);for(r=+u;r<a.length-d;r++)c.push(e[n[a[r]][2]]);return c}var oh,Ev=(function(e){function t(h){if(!(this instanceof t))return new t(h);this.points=h||[]}function n(h,p,g){return 0<(p[0]-h[0])*(g[1]-h[1])-(p[1]-h[1])*(g[0]-h[0])}function i(h,p){return n(h,p.dest,p.orig)}function r(h,p){return n(h,p.orig,p.dest)}function o(h,p){return i(h.dest,p)}function a(h,p,g,m){if(h[0]===m[0]&&h[1]===m[1]||p[0]===m[0]&&p[1]===m[1]||g[0]===m[0]&&g[1]===m[1])return!1;var v=p[0]*p[0]+p[1]*p[1],y=g[0]*g[0]+g[1]*g[1],b=m[0]*m[0]+m[1]*m[1],S=y-b,w=g[1]-m[1],M=g[1]*b-y*m[1],N=g[0]-m[0],D=g[0]*b-y*m[0],P=g[0]*m[1]-g[1]*m[0];return 1<h[0]*(p[1]*S-v*w+M)-h[1]*(p[0]*S-v*N+D)+(h[0]*h[0]+h[1]*h[1])*(p[0]*w-p[1]*N+P)-p[0]*M+p[1]*D-v*P}function s(h,p,g){this.onext=h,this.rot=p,this.orig=g,this.mark=!1}function l(h,p){var g=new s(null,null,h),m=new s(null,null,null),x=new s(null,null,p),v=new s(null,null,null);return g.onext=g,x.onext=x,(m.onext=v).onext=m,(((g.rot=m).rot=x).rot=v).rot=g}function u(h,p){var g=h.onext.rot,m=p.onext.rot,x=h.onext,v=m.onext,y=g.onext;h.onext=p.onext,p.onext=x,g.onext=v,m.onext=y}function d(h,p){var g=l(h.dest,p.orig);return u(g,h.lnext),u(g.sym,p),g}function c(h){u(h,h.oprev),u(h.sym,h.sym.oprev)}t.prototype={triangulate:function(){var h=this.points;h.sort(function(S,w){return S[0]===w[0]?S[1]-w[1]:S[0]-w[0]});for(var p=h.length-1;1<=p;p--)h[p][0]===h[p-1][0]&&h[p][1]===h[p-1][1]&&h.splice(p,1);if(h.length<2)return{};for(var g=function S(w){var M,N,D,P;if(2===w.length)return{le:M=l(w[0],w[1]),re:M.sym};if(3===w.length)return M=l(w[0],w[1]),N=l(w[1],w[2]),u(M.sym,N),n(w[0],w[1],w[2])?(D=d(N,M),{le:M,re:N.sym}):n(w[0],w[2],w[1])?{le:(D=d(N,M)).sym,re:D}:{le:M,re:N.sym};for(var L=Math.ceil(w.length/2),V=S(w.slice(0,L)),X=S(w.slice(L)),J=V.le,se=V.re,re=X.le,j=X.re;;)if(r(re.orig,se))se=se.lnext;else{if(!i(se.orig,re))break;re=re.rprev}var Y=d(re.sym,se);for(se.orig===J.orig&&(J=Y.sym),re.orig===j.orig&&(j=Y);;){var he=Y.sym.onext;if(o(he,Y))for(;a(Y.dest,Y.orig,he.dest,he.onext.dest);)P=he.onext,c(he),he=P;var pe=Y.oprev;if(o(pe,Y))for(;a(Y.dest,Y.orig,pe.dest,pe.oprev.dest);)P=pe.oprev,c(pe),pe=P;if(!o(he,Y)&&!o(pe,Y))break;Y=!o(he,Y)||o(pe,Y)&&a(he.dest,he.orig,pe.orig,pe.dest)?d(pe,Y.sym):d(Y.sym,he.sym)}return{le:J,re:j}}(h).le,m=[],x=0,v=[g];r(g.onext.dest,g);)g=g.onext;for(var y=g;v.push(y.sym),y.mark=!0,(y=y.lnext)!==g;);do{var b=v[x++];if(!b.mark)for(y=b;m.push(y.orig),y.sym.mark||v.push(y.sym),y.mark=!0,(y=y.lnext)!=b;);}while(x<v.length);return m}},s.prototype={get sym(){return this.rot.rot},get dest(){return this.sym.orig},get rotSym(){return this.rot.sym},get oprev(){return this.rot.onext.rot},get dprev(){return this.rotSym.onext.rotSym},get lnext(){return this.rotSym.onext.rot},get lprev(){return this.onext.sym},get rprev(){return this.sym.onext}},t.prototype.ccw=n,t.prototype.rightOf=i,t.prototype.leftOf=r,t.prototype.inCircle=a,e.exports=t}(oh={exports:{}}),oh.exports);function Sv(e,t,n,i,r){if(void 0===t&&(t=1),void 0===n&&(n=0),!i||!r){var o=e.map(function(P){return[P.x,P.y]});i=new Ev(o.slice()).triangulate(),r=rh(o)}for(var a,u,g,m,x=n*n,v=[],y={},b=0;b<i.length;b+=3)ES(r,ah(i[b],i[b+1],i[b+2]))&&x<(N=(g=(u=ah(a=i[b],i[b+1],i[b+2]))[0]-a[0])*g+(m=u[1]-a[1])*m)&&(v.push(b),y[b]=N);if(0===v.length)return[];v.sort(function(P,L){return y[P]-y[L]});var S=v[0],w=y[S],M=[];for(b=0;b<v.length;b++){var N,D=v[b];w<(N=y[D])&&x<N&&(w=N,M.push(S=D),M.length>t&&M.shift())}return M.map(function(P){return function(L,V,X){for(var J=arguments,se=ah(L,V,X),re=0,j=0;j<3;j++){var Y=J[j],he=Y[0]-se[0],pe=Y[1]-se[1],Ae=Math.sqrt(he*he+pe*pe);re<Ae&&(re=Ae)}return[se[0],se[1],re]}(i[P],i[P+1],i[P+2])})}function ES(e,t){for(var n=e.length,i=e[n-1],r=t[0],o=t[1],a=i[0],s=i[1],l=!1,u=0;u<n;u++){var d=e[u],c=d[0],h=d[1];o<h!=o<s&&r<(a-c)*(o-h)/(s-h)+c&&(l=!l),a=c,s=h}return l}function ah(e,t,n){var i=[(e[0]+t[0])/2,(e[1]+t[1])/2],r=[(t[0]+n[0])/2,(t[1]+n[1])/2],o=-1/((t[1]-e[1])/(t[0]-e[0])),a=-1/((n[1]-t[1])/(n[0]-t[0])),s=i[1]-o*i[0],l=(s-(r[1]-a*r[0]))/(a-o);return[l,o*l+s]}function wS(e,t,n){var i=t.duration,r=void 0===i?0:i,o=t.margin,a=void 0===o?5:o,l=t.nodes,u=t.referenceNodes;!u||u instanceof or||(u=e.getNodes(u));var d=u||l.inverse(),c=d.getPosition().map(function(Ge){return[Ge.x,Ge.y]}),h=n,p=l.getBoundingBox(),g=d.getBoundingBox();g.pad(g.maxScaledSize);var m,x,v,y,b,S,N,D=xv(h.map(function(Ge){return Ge.x}),h.map(function(Ge){return Ge.y}),l.getAttribute("radius")),P=D[0],L=D[1],V=D[2]+g.maxScaledSize+a,X=0,J=0;if(function(Ge,qe,Le,He){for(var Je=0;Je<Ge.length;Je++){var et=Ge[Je],Re=et[1],Ze=Math.abs(et[0]-qe),Qe=Math.abs(Re-Le);if(Ze+Qe<=He||!(He<Ze||He<Qe)&&Ze*Ze+Qe*Qe<=He*He)return!0}return!1}(c,P,L,V))if(d.size<=3){if(lc(P,L,D[2],g.minX,g.minY,g.maxX,g.maxY)){var se=function(Ge,qe,Le){for(var He,Je=ff(Le.cx,Le.cy,Ge,qe,Le.minX,Le.minY,Le.maxX,Le.maxY),et=1/0,Te={x:Le.maxX,y:qe},Re=0,Ze=Je;Re<Ze.length;Re++){var Qe=Ze[Re];(He=yi(Ge,qe,Qe.x,Qe.y))<et&&(et=He,Te=Qe)}return Te}(P,L,g);m=yi(g.cx,g.cy,se.x,se.y);var re={x:(b=g.cx)+(N=(m+V)/m)*(se.x-b),y:(S=g.cy)+N*(se.y-S)};X=re.x-P,J=re.y-L}}else{var j=new Ev(c.slice()).triangulate(),Y=3<c.length?rh(c):(v=(x=g).bottomLeft(),y=x.topRight(),[[v.x,v.y],[v.x,y.y],[y.x,y.y],[y.x,v.y]]),he=Sv(d.getPosition(),10,V,j,Y);if(se=function(e,t,n){for(var i,r,o=1/0,a=0,s=t.length;a<s;a++){var l=t[a],u=t[(a+1)%s],d=Jd(e[0],e[1],l[0],l[1],u[0],u[1]);d<o&&(o=d,i=l,r=u)}return v=n,y=_f(e[0],e[1],p=i[0],g=i[1],m=r[0],x=r[1]),b=-(g-x),S=p-m,w=Math.sqrt(b*b+S*S),[y.x-v*(b/=w),y.y-v*(S/=w)];var p,g,m,x,v,y,b,S,w}([P,L],Y,V),0<he.length){for(var pe=Math.pow(P-se[0],2)+Math.pow(L-se[1],2),Ae=0,Ie=he;Ae<Ie.length;Ae++){var ot=Ie[Ae];(m=(X=P-ot[0])*X+(J=L-ot[1])*J)<pe&&(pe=m,se=ot.slice(0,2))}X=se[0]-P,J=se[1]-L}else X=se[0]-p.cx,J=se[1]-p.cy}var at={layoutName:"incremental",ids:l.getId(),positions:{before:h,current:h}};if(X||J){var We=h.map(function(Ge){return Ge.x+=X,Ge.y+=J,Ge});if(t.locate){"boolean"==typeof t.locate&&(t.locate={});var vt=e.modules.locate.layoutDataBoundingBox({x:c.map(function(Ge){return Ge[0]}).concat(We.map(function(Ge){return Ge.x})),y:c.map(function(Ge){return Ge[1]}).concat(We.map(function(Ge){return Ge.y})),indexes:e.getNodes()._indexes}),Tt=e.modules.locate.computeConfigForBounds(vt,t.locate);e.modules.camera.setView(Tt,{duration:r,easing:t.locate.easing,ignoreZoomLimits:!0})}return at.positions.current=We,l.setAttributes(We,r).then(function(){return at})}return l.setAttributes(h,r).then(function(){return at})}function Av(e,t,n){var i=sn(t);return i.duration=0,i.dryRun=!0,i.locate=!1,delete i.incremental,n(i).then(function(r){return wS(e,t,r.positions.current)})}function wv(e,t,n){var r=t.duration,o=t.centralNode,a=t.nodes,s=a.reduce(function(d,c){return d[c._index]=!0,d},{}),l=e.getNodes();if(t.focusOnGroupShape)return n({nodes:a,duration:0}).then(function(){var d=a.concat(o),c=d.getAttribute("layoutable");return d.setAttributes({layoutable:!1}),n({nodes:e.getNodes(),duration:r}).then(function(){return d.setAttributes(c)})});var u=sn(t);return delete u.centralNode,u.incremental=!1,u.nodes=l,u.nodeMass=function(d,c){return(c+1)*(s[d._index]?1:2)},n(u)}function Cv(e,t,n){var i=e.nodes,r=e.centralNode;if(!i||0===i.size)throw new Error("Incremental layout: no nodes are selected");if("boolean"!=typeof e.incremental&&"margin"in e.incremental&&!isFinite(e.incremental.margin))throw new Error("Incremental layout: margin has to be a positive number");var o=sn(e);return"boolean"!=typeof e.incremental&&(o.margin=e.incremental.margin,o.referenceNodes=e.incremental.referenceNodes),r&&!r.getAttribute("layoutable")?wv(t,o,n):(o.nodes=o.nodes instanceof or?o.nodes:t.getNodes(o.nodes),Av(t,o,n))}var CS={configure:function(e,t){var n,i,r,o=t.graph,a=t.camera,s=e.nodes,l=s._indexes,u={},d={},c=l.length,h=o.getObjectList(!0),p=o.getObjectList(!1);e.nodes&&delete(e=sn(e)).nodes;var g=o.getNodeAttribute("innerStroke.width").getMultiple(l),m=o.getNodeAttribute("outerStroke.width").getMultiple(l),x=o.degrees(l),v=o.getNodeAttribute("x").getMultiple(l),y=o.getNodeAttribute("y").getMultiple(l),b=o.getNodeAttribute("radius").getMultiple(l),S=o.nodeList(l).getAttribute("layoutable"),w="function"==typeof e.nodeMass?e.nodeMass:function(We,vt,Tt){return vt+1};delete e.nodeMass;var M="function"==typeof e.edgeWeight?e.edgeWeight:function(We){return 1};delete e.edgeWeight,isFinite(e.scalingRatio)||delete e.scalingRatio;var N=l.reduce(function(We,vt,Tt){return S[Tt]||(We[vt]=!0),We},{}),D=0,P=0,L=0,V=a.getZoom();for(r=0;r<l.length;++r){var X=l[r],re=b[r]+(g[r]+m[r])/V;u[X]={id:X,x:v[r],y:y[r],degree:x[r],size:re,pinned:!!N[X],mass:w(h.get(X),x[r],r)},L=Math.max(re,L)}if(1<c)for(r=0;r<c;r++){var j=u[l[r]];D+=j.x,P+=j.y}var Y={x:D/=c,y:P/=c},he=s.getAdjacentEdges();i=(n=he._indexes).length;var pe=he.getSource()._indexes,Ae=he.getTarget()._indexes;for(r=0;r<i;r++){var Ie=n[r],ot=pe[r],at=Ae[r];u[ot]&&u[at]&&(d[Ie]={source:ot,target:at},d[Ie].weight=M(p.get(Ie)))}return{nodes:u,edges:d,maxSize:L,config:Hi(e),barycentre:Y}},context:function(){return{}},update:function(e,t){var n,i,r,o;t.W?n=t.W:(t.W=n={ppn:10,ppe:3,ppr:9,MAX_SUBDIVISION_RETRIES:3,maxForce:10,iterations:0,converged:!1,settings:{linLogMode:!1,outboundAttractionDistribution:!1,adjustSizes:!1,edgeWeightInfluence:0,scalingRatio:100,strongGravityMode:!0,gravity:1,slowDown:1,barnesHutOptimize:!1,barnesHutTheta:.5,startingIterations:10,iterationsPerRender:10,maxIterations:1e3,avgDistanceThreshold:.01,autoStop:!0,alignNodeSiblings:!0,nodeSiblingsScale:5,nodeSiblingsAngleMin:0}},r=(i=e).config,o=function(d,c){var h,p,g,m,x=d.nodes,v=d.edges,y=d.maxSize,b=Object.keys(d.nodes),S=Object.keys(d.edges),w=b.length*n.ppn,M=S.length*n.ppe,N={},D=Math.pow(10,Math.log(Math.max(y,1))-6),P=D/2,L=Math.random,V=c.randomizeFactor||1;m="locally"===c.randomize?function(pe){return pe+L()*V}:"globally"===c.randomize?function(pe){return L()*V}:function(pe){return pe+L()*D-P};var X=new Float32Array(w),J=new Float32Array(M);for(h=p=0,g=b.length;h<g;h++){var se=b[h],re=x[se],j=re.x,Y=re.y;re.pinned||(j=m(j),Y=m(Y)),N[se]=p,X[p]=j,X[p+1]=Y,X[p+2]=0,X[p+3]=0,X[p+4]=0,X[p+5]=0,X[p+6]=re.mass,X[p+7]=1,X[p+8]=re.size,X[p+9]=re.pinned||0,p+=n.ppn}for(h=p=0,g=S.length;h<g;h++){var he=v[se=S[h]];J[p]=N[he.source],J[p+1]=N[he.target],J[p+2]=he.weight||0,p+=n.ppe}return{nodes:X,edges:J}}(i,r),t.NodeMatrix=o.nodes,t.EdgeMatrix=o.edges,n.nodesLength=t.NodeMatrix.length,n.edgesLength=t.EdgeMatrix.length,n.settings=function(d,c){for(var h in d)c[h]=d[h];return c}(e.config,n.settings),t.nodes=e.nodes,t.edges=e.edges,t.barycentre=e.barycentre);var a,s=t.NodeMatrix,l=t.EdgeMatrix;function u(){var d,c,h,p,g,m,x,v,y,b,S,w,M,N,D,P,L;for(h=0;h<n.nodesLength;h+=n.ppn)s[h+4]=s[h+2],s[h+5]=s[h+3],s[h+2]=0,s[h+3]=0;if(n.settings.outboundAttractionDistribution){for(h=y=0;h<n.nodesLength;h+=n.ppn)y+=s[h+6];y/=n.nodesLength}if(n.settings.barnesHutOptimize){var V,X,J,se,re=1/0,j=-1/0,Y=1/0,he=-1/0;for(a=[],h=0;h<n.nodesLength;h+=n.ppn)re=Math.min(re,s[h+0]),j=Math.max(j,s[h+0]),Y=Math.min(Y,s[h+1]),he=Math.max(he,s[h+1]);var pe=j-re,Ae=he-Y;for(Ae<pe?he=(Y-=(pe-Ae)/2)+pe:j=(re-=(Ae-pe)/2)+Ae,a[0]=-1,a[1]=(re+j)/2,a[2]=(Y+he)/2,a[3]=Math.max(j-re,he-Y),a[4]=-1,a[5]=-1,a[6]=0,a[7]=0,d=1,h=a[8]=0;h<n.nodesLength;h+=n.ppn)for(c=0,J=n.MAX_SUBDIVISION_RETRIES;;){if(!(0<=a[c+5])){if(a[c+0]<0){a[c+0]=h;break}if(a[c+5]=d*n.ppr,x=a[c+3]/2,a[(v=a[c+5])+0]=-1,a[v+1]=a[c+1]-x,a[v+2]=a[c+2]-x,a[v+3]=x,a[v+4]=v+n.ppr,a[v+5]=-1,a[v+6]=0,a[v+7]=0,a[v+8]=0,a[(v+=n.ppr)+0]=-1,a[v+1]=a[c+1]-x,a[v+2]=a[c+2]+x,a[v+3]=x,a[v+4]=v+n.ppr,a[v+5]=-1,a[v+6]=0,a[v+7]=0,a[v+8]=0,a[(v+=n.ppr)+0]=-1,a[v+1]=a[c+1]+x,a[v+2]=a[c+2]-x,a[v+3]=x,a[v+4]=v+n.ppr,a[v+5]=-1,a[v+6]=0,a[v+7]=0,a[v+8]=0,a[(v+=n.ppr)+0]=-1,a[v+1]=a[c+1]+x,a[v+2]=a[c+2]+x,a[v+3]=x,a[v+4]=a[c+4],a[v+5]=-1,a[v+6]=0,a[v+7]=0,a[v+8]=0,d+=4,V=s[a[se=c+0]+0]<a[c+1]?s[a[se]+1]<a[c+2]?a[c+5]:a[c+5]+n.ppr:s[a[se]+1]<a[c+2]?a[c+5]+2*n.ppr:a[c+5]+3*n.ppr,a[c+6]=s[a[se]+6],a[c+7]=s[a[se]+0],a[c+8]=s[a[se]+1],a[V+0]=a[c+0],a[c+0]=-1,V===(X=s[h+0]<a[c+1]?s[h+1]<a[c+2]?a[c+5]:a[c+5]+n.ppr:s[h+1]<a[c+2]?a[c+5]+2*n.ppr:a[c+5]+3*n.ppr)){if(J--){c=V;continue}J=n.MAX_SUBDIVISION_RETRIES;break}a[X+0]=h;break}V=s[h+0]<a[c+1]?s[h+1]<a[c+2]?a[c+5]:a[c+5]+n.ppr:s[h+1]<a[c+2]?a[c+5]+2*n.ppr:a[c+5]+3*n.ppr,a[c+7]=(a[c+7]*a[c+6]+s[h+0]*s[h+6])/(a[c+6]+s[h+6]),a[c+8]=(a[c+8]*a[c+6]+s[h+1]*s[h+6])/(a[c+6]+s[h+6]),a[c+6]+=s[h+6],c=V}}if(n.settings.barnesHutOptimize)for(b=n.settings.scalingRatio,h=0;h<n.nodesLength;h+=n.ppn)for(c=0;;)if(0<=a[c+5]){if(P=Math.sqrt((s[h+0]-a[c+7])*(s[h+0]-a[c+7])+(s[h+1]-a[c+8])*(s[h+1]-a[c+8])),2*a[c+3]/P<n.settings.barnesHutTheta){if(S=s[h+0]-a[c+7],w=s[h+1]-a[c+8],n.settings.adjustSizes?0<P?(s[h+2]+=S*(L=b*s[h+6]*a[c+6]/P/P),s[h+3]+=w*L):P<0&&(s[h+2]+=S*(L=-b*s[h+6]*a[c+6]/P),s[h+3]+=w*L):0<P&&(s[h+2]+=S*(L=b*s[h+6]*a[c+6]/P/P),s[h+3]+=w*L),a[c+4]<0)break;c=a[c+4];continue}c=a[c+5]}else{if(0<=a[c+0]&&a[c+0]!==h&&(S=s[h+0]-s[a[c+0]+0],w=s[h+1]-s[a[c+0]+1],P=Math.sqrt(S*S+w*w),n.settings.adjustSizes?0<P?(s[h+2]+=S*(L=b*s[h+6]*s[a[c+0]+6]/P/P),s[h+3]+=w*L):P<0&&(s[h+2]+=S*(L=-b*s[h+6]*s[a[c+0]+6]/P),s[h+3]+=w*L):0<P&&(s[h+2]+=S*(L=b*s[h+6]*s[a[c+0]+6]/P/P),s[h+3]+=w*L)),a[c+4]<0)break;c=a[c+4]}else for(b=n.settings.scalingRatio,p=0;p<n.nodesLength;p+=n.ppn)for(g=0;g<p;g+=n.ppn)S=s[p+0]-s[g+0],w=s[p+1]-s[g+1],n.settings.adjustSizes?0<(P=Math.sqrt(S*S+w*w)-s[p+8]-s[g+8])?(s[p+2]+=S*(L=b*s[p+6]*s[g+6]/P/P),s[p+3]+=w*L,s[g+2]+=S*L,s[g+3]+=w*L):P<0&&(s[p+2]+=S*(L=100*b*s[p+6]*s[g+6]),s[p+3]+=w*L,s[g+2]-=S*L,s[g+3]-=w*L):0<(P=Math.sqrt(S*S+w*w))&&(s[p+2]+=S*(L=b*s[p+6]*s[g+6]/P/P),s[p+3]+=w*L,s[g+2]-=S*L,s[g+3]-=w*L);for(v=n.settings.gravity/n.settings.scalingRatio,b=n.settings.scalingRatio,h=0;h<n.nodesLength;h+=n.ppn)S=s[h+(L=0)],w=s[h+1],P=Math.sqrt(S*S+w*w),n.settings.strongGravityMode?0<P&&(L=b*s[h+6]*v):0<P&&(L=b*s[h+6]*v/P),s[h+2]-=S*L,s[h+3]-=w*L;for(b=1*(n.settings.outboundAttractionDistribution?y:1),m=0;m<n.edgesLength;m+=n.ppe)p=l[m+0],g=l[m+1],x=l[m+2],D=Math.pow(x,n.settings.edgeWeightInfluence),S=s[p+0]-s[g+0],w=s[p+1]-s[g+1],n.settings.adjustSizes?(P=Math.sqrt(S*S+w*w)-s[p+8]-s[g+8],n.settings.linLogMode?n.settings.outboundAttractionDistribution?0<P&&(L=-b*D*Math.log(1+P)/P/s[p+6]):0<P&&(L=-b*D*Math.log(1+P)/P):n.settings.outboundAttractionDistribution?0<P&&(L=-b*D/s[p+6]):0<P&&(L=-b*D)):(P=Math.sqrt(S*S+w*w),n.settings.linLogMode?n.settings.outboundAttractionDistribution?0<P&&(L=-b*D*Math.log(1+P)/P/s[p+6]):0<P&&(L=-b*D*Math.log(1+P)/P):L=n.settings.outboundAttractionDistribution?(P=1,-b*D/s[p+6]):(P=1,-b*D)),0<P&&(s[p+2]+=S*L,s[p+3]+=w*L,s[g+2]-=S*L,s[g+3]-=w*L);var Ie,ot,at,We,vt=0;if(n.settings.adjustSizes)for(h=0;h<n.nodesLength;h+=n.ppn)s[h+9]||((Ie=Math.sqrt(s[h+2]*s[h+2]+s[h+3]*s[h+3]))>n.maxForce&&(s[h+2]=s[h+2]*n.maxForce/Ie,s[h+3]=s[h+3]*n.maxForce/Ie),ot=s[h+6]*Math.sqrt((s[h+4]-s[h+2])*(s[h+4]-s[h+2])+(s[h+5]-s[h+3])*(s[h+5]-s[h+3])),at=Math.sqrt((s[h+4]+s[h+2])*(s[h+4]+s[h+2])+(s[h+5]+s[h+3])*(s[h+5]+s[h+3]))/2,We=.1*Math.log(1+at)/(1+Math.sqrt(ot)),M=s[h+0],N=s[h+1],s[h+0]=s[h+0]+s[h+2]*(We/n.settings.slowDown),s[h+1]=s[h+1]+s[h+3]*(We/n.settings.slowDown),S=s[h+0],w=s[h+1],vt+=P=Math.sqrt((S-M)*(S-M)+(w-N)*(w-N)));else for(h=0;h<n.nodesLength;h+=n.ppn)s[h+9]||(ot=s[h+6]*Math.sqrt((s[h+4]-s[h+2])*(s[h+4]-s[h+2])+(s[h+5]-s[h+3])*(s[h+5]-s[h+3])),at=Math.sqrt((s[h+4]+s[h+2])*(s[h+4]+s[h+2])+(s[h+5]+s[h+3])*(s[h+5]+s[h+3]))/2,We=s[h+7]*Math.log(1+at)/(1+Math.sqrt(ot)),s[h+7]=Math.min(1,Math.sqrt(We*(s[h+2]*s[h+2]+s[h+3]*s[h+3])/(1+Math.sqrt(ot)))),M=s[h+0],N=s[h+1],s[h+0]=s[h+0]+s[h+2]*(We/n.settings.slowDown),s[h+1]=s[h+1]+s[h+3]*(We/n.settings.slowDown),S=s[h+0],w=s[h+1],vt+=P=Math.sqrt((S-M)*(S-M)+(w-N)*(w-N)));if(n.iterations++,n.settings.autoStop&&(n.converged=n.iterations>n.settings.maxIterations||vt/n.nodesLength<n.settings.avgDistanceThreshold,n.converged&&n.settings.alignNodeSiblings)){var Tt,Ge,qe={},Le={};for(m=0;m<n.edgesLength;m+=n.ppe)(p=l[m+0])!==(g=l[m+1])&&(qe[p]=qe[p]||{},qe[g]=qe[g]||{},qe[p][g]=!0,qe[g][p]=!0);Object.keys(qe).forEach(function(B){var K=~~B;2==(Ge=Object.keys(qe[K])).length&&((Tt=Ge[0]+";"+Ge[1])in Le||Le[Tt=Ge[1]+";"+Ge[0]]||(Le[Tt]=[~~Ge[1],~~Ge[0]]),Le[Tt].push(K))});var He,Je,et,Te,Re,Ze,Qe,dt,Ht,Kt,ln,an,hn,W,Z=n.settings.nodeSiblingsAngleMin;Object.keys(Le).forEach(function(B){if(Je=Le[B].shift(),et=Le[B].shift(),1!=(He=Le[B].filter(function($e){return!s[$e+9]})).length){var _e,Ee,xe,Me,Fe,Be,De,ze,ke,Ne,we,Ke;if(Ze=s[Je+0],Qe=s[Je+1],dt=s[et+0],Ht=s[et+1],Te=Object.keys(qe[Je]).length,Re=Object.keys(qe[et]).length,ln={x:(_e=Ze)+(dt-_e)*(xe=(.75-.25)*(Te/(Te+Re)-0)/1+.25),y:(Ee=Qe)+(Ht-Ee)*xe},an={xi:-((De=Ht)-(Fe=Qe)),yi:(Be=dt)-(Me=Ze),xiPrime:De-Fe,yiPrime:-(Be-Me)},ze=dt-Ze,ke=Ht-Qe,Kt=Math.sqrt(ze*ze+ke*ke),Ke=hn={x:((Ne=an).xiPrime-Ne.xi)/(we=Kt),y:(Ne.yiPrime-Ne.yi)/we},W=Math.acos(Ke.x/Math.sqrt(Ke.x*Ke.x+Ke.y*Ke.y)),2*Z>Math.PI)throw new Error("ForceLink.Worker - Invalid parameter: angleMin must be smaller than 2 PI.");0<Z&&(W<Z||W>Math.PI-Z&&W<=Math.PI?hn={x:2*Math.cos(Math.PI-Z),y:2*Math.sin(Math.PI-Z)}:(W>2*Math.PI-Z||W>=Math.PI&&W<Math.PI+Z)&&(hn={x:2*Math.cos(Z),y:2*Math.sin(Z)}));var ut=0,Ue=1,je=1;He.length%2==1&&(je=0,ut=1);for(var Ve=0;Ve<He.length;Ve++)s[He[Ve]+0]=ln.x+Ue*hn.x*je*(ut||2<=Ve?n.settings.nodeSiblingsScale:2*n.settings.nodeSiblingsScale/3),s[He[Ve]+1]=ln.y+Ue*hn.y*je*(ut||2<=Ve?n.settings.nodeSiblingsScale:2*n.settings.nodeSiblingsScale/3),Ue=-Ue,je+=(Ve+ut)%2}})}}return function(){if(n.settings.autoStop)for(;!n.converged;)u();else for(var d=0===n.iterations?n.settings.startingIterations:n.iterations+n.settings.iterationsPerRender;n.iterations!==d;)u();return{nodes:function(c){for(var h=Object.keys(c),p={},g=0;g<s.length;g+=n.ppn){var m=h[g/n.ppn];p[m]={id:m,x:s[g+0],y:s[g+1],pinned:s[g+9]}}return p}(t.nodes),barycentre:t.barycentre}}()},isRunning:function(e){return!e.W.settings.autoStop},onSync:function(e,t){var n,i,r,o,a,s,l,u,d=e.nodes,c=e.barycentre,h=t.graph,p=Object.keys(d),g=p.length,m=0,x=0,v=new Array(g),y=new Array(g),b=new Array(g),S=new Array(g),w=h.getAttributes(!0,["x","y"]),M=w[0],N=w[1];for(n=0;n<g;n++)r=d[i=p[n]],u=parseInt(i),v[n]=u,S[n]=r.pinned,a=r.pinned?(o=M.get(u),N.get(u)):(o=r.x,r.y),m+=y[n]=o,x+=b[n]=a;for(s=m/g-c.x,l=x/g-c.y,n=0;n<g;n++)S[n]||(y[n]-=s,b[n]-=l);return{indexes:v,x:y,y:b}}},Tv=function(e){return e.reduce(function(t,n){return t[n]=!0,t},{})};function TS(e,t){for(var n=[e],i=Tv(n),r=[e];n.length;)for(var o=0,a=t[n.shift()];o<a.length;o+=1){var s=a[o];i[s]||(i[s]=!0,r.push(s),n.push(s))}return r}function Mv(e){return e.reduce(function(t,n){return t[n.source]=t[n.source]||[],t[n.target]=t[n.target]||[],t[n.source].push(""+n.target),t[n.target].push(""+n.source),t},{})}function MS(e){return function(t,n){var i=Math.abs(t.layer-n.layer),r=[n,t].reduce(function(o,a){return o+(Ru(a)?1:.01)},0);return i?2*i*e:r*e}}function Iv(e){return e.reduce(function(t,n){return t+function(i,r){for(var o=[],a=arguments.length-2;0<a--;)o[a]=arguments[a+2];for(var s=r,l=0,u=o;l<u.length;l+=1){var d=u[l];if(!s[d])return i;s=s[d]}return s}(Ru(n)?.5:0,n,"data","radius")},0)/e.length}function kv(e,t,n){var i=n||Mv(t||[]);return e.filter(function(r){return!(r.id in i)})}function IS(e,t){var n=Tv(t);return e.filter(function(i){return!(i in n)})}function us(e,t){e.forEach(function(n,i){n.forEach(function(r,o,a){t(r,o,a,i)})})}function sh(e){return Object.keys(e).map(function(t){return e[t]})}function uh(e,t){return Object.keys(e).reduce(function(n,i){return n[i]=t(e[i],i,e),n},{})}function Ru(e){return!!e.data}function lh(e,t){return{id:e,data:t,children:[]}}function OS(e,t){t.forEach(function(n){return n._median=[]}),e.forEach(function(n,i){n.children.filter(function(r){return r.layer>n.layer}).forEach(function(r){r._median.push(i)})}),t.forEach(function(n,i){n.children.filter(function(r){return r.layer<=n.layer}).forEach(function(){return n._median.push(i)})}),t.forEach(function(n){return n._median=function(i){if(i.sort(function(o,a){return o-a}),0===i.length)return 0;var r=Math.floor(i.length/2);return i.length%2?i[r]:(i[r-1]+i[r])/2}(n._median)||0}),t.sort(function(n,i){return n._median-i._median}),t.forEach(function(n){return delete n._median})}var dh="left",ch="right",hh=Number.POSITIVE_INFINITY;function ph(e){for(var t=0,n=["up","down"];t<n.length;t+=1)e(n[t])}function fh(e){for(var t=0,n=[dh,ch];t<n.length;t+=1)e(n[t])}function Ov(e,t,n,i){this.feasible=n,this.evaluation=t,this.bounded=i,this._tableau=e}var gh=Ov;function ld(e,t,n,i,r){gh.call(this,e,t,n,i),this.iter=r}Ov.prototype.generateSolutionSet=function(){for(var e={},t=this._tableau,n=t.varIndexByRow,i=t.variablesPerIndex,r=t.matrix,o=t.rhsColumn,a=t.height-1,s=Math.round(1/t.precision),l=1;l<=a;l+=1){var u=i[n[l]];void 0!==u&&!0!==u.isSlack&&(e[u.id]=Math.round(r[l][o]*s)/s)}return e};var PS=ld;function wo(e){this.model=null,this.matrix=null,this.width=0,this.height=0,this.costRowIndex=0,this.rhsColumn=0,this.variablesPerIndex=[],this.unrestrictedVars=null,this.feasible=!0,this.evaluation=0,this.varIndexByRow=null,this.varIndexByCol=null,this.rowByVarIndex=null,this.colByVarIndex=null,this.precision=e||1e-8,this.optionalObjectives=[],this.objectivesByPriority={},this.savedState=null,this.availableIndexes=[],this.lastElementIndex=0,this.variables=null,this.nVars=0,this.bounded=!0,this.unboundedVarIndex=null,this.branchAndCutIterations=0}ld.prototype=Object.create(gh.prototype),ld.constructor=ld;var mn=wo;function _h(e,t){this.priority=e,this.reducedCosts=new Array(t);for(var n=0;n<t;n+=1)this.reducedCosts[n]=0}wo.prototype.solve=function(){return 0<this.model.getNumberOfIntegerVariables()?this.branchAndCut():this.simplex(),this.updateVariableValues(),this.getSolution()},_h.prototype.copy=function(){var e=new _h(this.priority,this.reducedCosts.length);return e.reducedCosts=this.reducedCosts.slice(),e},wo.prototype.setOptionalObjective=function(e,t,n){var i=this.objectivesByPriority[e];void 0===i&&(i=new _h(e,Math.max(this.width,t+1)),this.objectivesByPriority[e]=i,this.optionalObjectives.push(i),this.optionalObjectives.sort(function(r,o){return r.priority-o.priority})),i.reducedCosts[t]=n},wo.prototype.initialize=function(e,t,n,i){this.variables=n,this.unrestrictedVars=i,this.width=e,this.height=t;for(var r=new Array(e),o=0;o<e;o++)r[o]=0;this.matrix=new Array(t);for(var a=0;a<t;a++)this.matrix[a]=r.slice();this.varIndexByRow=new Array(this.height),this.varIndexByCol=new Array(this.width),this.varIndexByRow[0]=-1,this.varIndexByCol[0]=-1,this.nVars=e+t-2,this.rowByVarIndex=new Array(this.nVars),this.colByVarIndex=new Array(this.nVars),this.lastElementIndex=this.nVars},wo.prototype._resetMatrix=function(){var e,t,n=this.model.variables,i=this.model.constraints,r=n.length,o=i.length,a=this.matrix[0],s=!0===this.model.isMinimization?-1:1;for(e=0;e<r;e+=1){var l=n[e],u=l.priority,d=s*l.cost;0===u?a[e+1]=d:this.setOptionalObjective(u,e+1,d),this.rowByVarIndex[t=n[e].index]=-1,this.colByVarIndex[t]=e+1,this.varIndexByCol[e+1]=t}for(var c=1,h=0;h<o;h+=1){var p,g,m=i[h],x=m.index;this.rowByVarIndex[x]=c,this.colByVarIndex[x]=-1,this.varIndexByRow[c]=x;var v=m.terms,y=v.length,b=this.matrix[c++];if(m.isUpperBound){for(p=0;p<y;p+=1)b[this.colByVarIndex[(g=v[p]).variable.index]]=g.coefficient;b[0]=m.rhs}else{for(p=0;p<y;p+=1)b[this.colByVarIndex[(g=v[p]).variable.index]]=-g.coefficient;b[0]=-m.rhs}}},wo.prototype.setModel=function(e){var t=(this.model=e).nVariables+1;return this.initialize(t,e.nConstraints+1,e.variables,e.unrestrictedVariables),this._resetMatrix(),this},wo.prototype.getNewElementIndex=function(){if(0<this.availableIndexes.length)return this.availableIndexes.pop();var e=this.lastElementIndex;return this.lastElementIndex+=1,e},wo.prototype.density=function(){for(var e=0,t=this.matrix,n=0;n<this.height;n++)for(var i=t[n],r=0;r<this.width;r++)0!==i[r]&&(e+=1);return e/(this.height*this.width)},wo.prototype.setEvaluation=function(){var e=Math.round(1/this.precision);this.evaluation=Math.round(this.matrix[this.costRowIndex][this.rhsColumn]*e)/e},wo.prototype.getSolution=function(){var e=!0===this.model.isMinimization?this.evaluation:-this.evaluation;return 0<this.model.getNumberOfIntegerVariables()?new PS(this,e,this.feasible,this.bounded,this.branchAndCutIterations):new gh(this,e,this.feasible,this.bounded)},mn.prototype.simplex=function(){return this.bounded=!0,this.phase1(),!0===this.feasible&&this.phase2(),this},mn.prototype.phase1=function(){for(var e=this.model.checkForCycles,t=[],n=this.matrix,i=this.rhsColumn,r=this.width-1,o=this.height-1,a=0;;){for(var s=0,l=-this.precision,u=1;u<=o;u++)if(!0!==this.unrestrictedVars[this.varIndexByRow[u]]){var d=n[u][i];d<l&&(l=d,s=u)}if(0===s)return this.feasible=!0,a;for(var c=0,h=-1/0,p=n[0],g=n[s],m=1;m<=r;m++){var x=g[m];if(!(-this.precision<x&&x<this.precision)&&(!0===this.unrestrictedVars[this.varIndexByCol[m]]||x<-this.precision)){var v=-p[m]/x;h<v&&(h=v,c=m)}}if(0===c)return this.feasible=!1,a;if(e){t.push([this.varIndexByRow[s],this.varIndexByCol[c]]);var y=this.checkForCycles(t);if(0<y.length)throw console.log("Cycle in phase 1"),console.log("Start :",y[0]),console.log("Length :",y[1]),new Error}this.pivot(s,c),a+=1}},mn.prototype.phase2=function(){for(var e,t,n=this.model.checkForCycles,i=[],r=this.matrix,o=this.rhsColumn,a=this.width-1,s=this.height-1,l=this.precision,u=this.optionalObjectives.length,d=null,c=0;;){var h=r[this.costRowIndex];0<u&&(d=[]);for(var p=0,g=l,m=!1,x=1;x<=a;x++)e=h[x],t=!0===this.unrestrictedVars[this.varIndexByCol[x]],0<u&&-l<e&&e<l?d.push(x):t&&e<0?g<-e&&(g=-e,p=x,m=!0):g<e&&(g=e,p=x,m=!1);if(0<u)for(var v=0;0===p&&0<d.length&&v<u;){var y=[],b=this.optionalObjectives[v].reducedCosts;g=l;for(var S=0;S<d.length;S++)e=b[x=d[S]],t=!0===this.unrestrictedVars[this.varIndexByCol[x]],-l<e&&e<l?y.push(x):t&&e<0?g<-e&&(g=-e,p=x,m=!0):g<e&&(g=e,p=x,m=!1);d=y,v+=1}if(0===p)return this.setEvaluation(),c;for(var w=0,M=1/0,N=1;N<=s;N++){var D=r[N],P=D[o],L=D[p];if(!(-l<L&&L<l)){if(0<L&&P<l&&-l<P){M=0,w=N;break}var V=m?-P/L:P/L;l<V&&V<M&&(M=V,w=N)}}if(M===1/0)return this.evaluation=-1/0,this.bounded=!1,this.unboundedVarIndex=this.varIndexByCol[p],c;if(n){i.push([this.varIndexByRow[w],this.varIndexByCol[p]]);var X=this.checkForCycles(i);if(0<X.length)throw console.log("Cycle in phase 2"),console.log("Start :",X[0]),console.log("Length :",X[1]),new Error}this.pivot(w,p,!0),c+=1}};var mh=[];function vh(e,t,n,i){this.id=e,this.cost=t,this.index=n,this.value=0,this.priority=i}function Nv(e,t,n,i){vh.call(this,e,t,n,i)}function yh(e,t){vh.call(this,e,0,t,0)}function Lv(e,t){this.variable=e,this.coefficient=t}function Fv(e,t,n){return 0===n||"required"===n?null:(t=t||1,n=n||1,!1===e.isMinimization&&(t=-t),e.addVariable(t,"r"+e.relaxationIndex++,!1,!1,n))}function ls(e,t,n,i){this.slack=new yh("s"+n,n),this.index=n,this.model=i,this.rhs=e,this.isUpperBound=t,this.terms=[],this.termsByVarIndex={},this.relaxation=null}function Hs(e,t){this.upperBound=e,this.lowerBound=t,this.model=e.model,this.rhs=e.rhs,this.relaxation=null}mn.prototype.pivot=function(e,t){var n=this.matrix,i=n[e][t],r=this.height-1,o=this.width-1,a=this.varIndexByRow[e],s=this.varIndexByCol[t];this.varIndexByRow[e]=s,this.varIndexByCol[t]=a,this.rowByVarIndex[s]=e,this.rowByVarIndex[a]=-1,this.colByVarIndex[s]=-1,this.colByVarIndex[a]=t;for(var l,u,d,c=n[e],h=0,p=0;p<=o;p++)0!==c[p]&&(c[p]/=i,mh[h]=p,h+=1);c[t]=1/i;for(var g=0;g<=r;g++){var m=n[g];if(g!==e&&0!==(l=m[t])){for(u=0;u<h;u++)0!==(d=c[p=mh[u]])&&(m[p]=m[p]-l*d);m[t]=-l/i}}var x=this.optionalObjectives.length;if(0<x)for(var v=0;v<x;v+=1){var y=this.optionalObjectives[v].reducedCosts;if(0!==(l=y[t])){for(u=0;u<h;u++)0!==(d=c[p=mh[u]])&&(y[p]=y[p]-l*d);y[t]=-l/i}}},mn.prototype.checkForCycles=function(e){for(var t=0;t<e.length-1;t++)for(var n=t+1;n<e.length;n++){var i=e[t],r=e[n];if(i[0]===r[0]&&i[1]===r[1]){if(n-t>e.length-n)break;for(var o=!0,a=1;a<n-t;a++){var s=e[t+a],l=e[n+a];if(s[0]!==l[0]||s[1]!==l[1]){o=!1;break}}if(o)return[t,n-t]}}return[]},yh.prototype.isSlack=Nv.prototype.isInteger=!0,ls.prototype.addTerm=function(e,t){var n=t.index,i=this.termsByVarIndex[n];return void 0===i?(i=new Lv(t,e),this.termsByVarIndex[n]=i,this.terms.push(i),!0===this.isUpperBound&&(e=-e),this.model.updateConstraintCoefficient(this,t,e)):this.setVariableCoefficient(i.coefficient+e,t),this},ls.prototype.removeTerm=function(e){return this},ls.prototype.setRightHandSide=function(e){if(e!==this.rhs){var t=e-this.rhs;!0===this.isUpperBound&&(t=-t),this.rhs=e,this.model.updateRightHandSide(this,t)}return this},ls.prototype.setVariableCoefficient=function(e,t){var n=t.index;if(-1!==n){var i=this.termsByVarIndex[n];if(void 0===i)this.addTerm(e,t);else if(e!==i.coefficient){var r=e-i.coefficient;!0===this.isUpperBound&&(r=-r),i.coefficient=e,this.model.updateConstraintCoefficient(this,t,r)}return this}console.warn("[Constraint.setVariableCoefficient] Trying to change coefficient of inexistant variable.")},ls.prototype.relax=function(e,t){this.relaxation=Fv(this.model,e,t),this._relax(this.relaxation)},ls.prototype._relax=function(e){null!==e&&this.setVariableCoefficient(this.isUpperBound?-1:1,e)},Hs.prototype.isEquality=!0,Hs.prototype.addTerm=function(e,t){return this.upperBound.addTerm(e,t),this.lowerBound.addTerm(e,t),this},Hs.prototype.removeTerm=function(e){return this.upperBound.removeTerm(e),this.lowerBound.removeTerm(e),this},Hs.prototype.setRightHandSide=function(e){this.upperBound.setRightHandSide(e),this.lowerBound.setRightHandSide(e),this.rhs=e},Hs.prototype.relax=function(e,t){this.relaxation=Fv(this.model,e,t),this.upperBound.relaxation=this.relaxation,this.upperBound._relax(this.relaxation),this.lowerBound.relaxation=this.relaxation,this.lowerBound._relax(this.relaxation)};var Xo={Constraint:ls,Variable:vh,IntegerVariable:Nv,SlackVariable:yh,Equality:Hs,Term:Lv},xh=Xo.SlackVariable;function Pv(e,t){this.index=e,this.value=t}mn.prototype.addCutConstraints=function(e){for(var t,n=e.length,i=this.height,r=i+n,o=i;o<r;o+=1)void 0===this.matrix[o]&&(this.matrix[o]=this.matrix[o-1].slice());this.height=r,this.nVars=this.width+this.height-2;for(var a=this.width-1,s=0;s<n;s+=1){var l=e[s],u=i+s,d="min"===l.type?-1:1,c=l.varIndex,h=this.rowByVarIndex[c],p=this.matrix[u];if(-1===h){for(p[this.rhsColumn]=d*l.value,t=1;t<=a;t+=1)p[t]=0;p[this.colByVarIndex[c]]=d}else{var g=this.matrix[h];for(p[this.rhsColumn]=d*(l.value-g[this.rhsColumn]),t=1;t<=a;t+=1)p[t]=-d*g[t]}var x=this.getNewElementIndex();this.varIndexByRow[u]=x,this.rowByVarIndex[x]=u,this.colByVarIndex[x]=-1,this.variablesPerIndex[x]=new xh("s"+x,x),this.nVars+=1}},mn.prototype._addLowerBoundMIRCut=function(e){if(e===this.costRowIndex)return!1;var t=this.matrix;if(!this.variablesPerIndex[this.varIndexByRow[e]].isInteger)return!1;var n=t[e][this.rhsColumn],i=n-Math.floor(n);if(i<this.precision||1-this.precision<i)return!1;var r=this.height;t[r]=t[r-1].slice(),this.height+=1,this.nVars+=1;var o=this.getNewElementIndex();this.varIndexByRow[r]=o,this.rowByVarIndex[o]=r,this.colByVarIndex[o]=-1,this.variablesPerIndex[o]=new xh("s"+o,o),t[r][this.rhsColumn]=Math.floor(n);for(var a=1;a<this.varIndexByCol.length;a+=1)if(this.variablesPerIndex[this.varIndexByCol[a]].isInteger){var s=t[e][a],l=Math.floor(s)+Math.max(0,s-Math.floor(s)-i)/(1-i);t[r][a]=l}else t[r][a]=Math.min(0,t[e][a]/(1-i));for(var u=0;u<this.width;u+=1)t[r][u]-=t[e][u];return!0},mn.prototype._addUpperBoundMIRCut=function(e){if(e===this.costRowIndex)return!1;var t=this.matrix;if(!this.variablesPerIndex[this.varIndexByRow[e]].isInteger)return!1;var n=t[e][this.rhsColumn],i=n-Math.floor(n);if(i<this.precision||1-this.precision<i)return!1;var r=this.height;t[r]=t[r-1].slice(),this.height+=1,this.nVars+=1;var o=this.getNewElementIndex();this.varIndexByRow[r]=o,this.rowByVarIndex[o]=r,this.colByVarIndex[o]=-1,this.variablesPerIndex[o]=new xh("s"+o,o),t[r][this.rhsColumn]=-i;for(var a=1;a<this.varIndexByCol.length;a+=1){var s=this.variablesPerIndex[this.varIndexByCol[a]],l=t[e][a],u=l-Math.floor(l);t[r][a]=s.isInteger?u<=i?-u:-(1-u)*i/u:0<=l?-l:l*i/(1-i)}return!0},mn.prototype.applyMIRCuts=function(){for(var e=this.height,t=0;t<e;t+=1)this._addUpperBoundMIRCut(t);for(t=0;t<e;t+=1)this._addLowerBoundMIRCut(t)},mn.prototype._putInBase=function(e){var t=this.rowByVarIndex[e];if(-1===t){for(var n=this.colByVarIndex[e],i=1;i<this.height;i+=1){var r=this.matrix[i][n];if(r<-this.precision||this.precision<r){t=i;break}}this.pivot(t,n)}return t},mn.prototype._takeOutOfBase=function(e){var t=this.colByVarIndex[e];if(-1===t){for(var n=this.rowByVarIndex[e],i=this.matrix[n],r=1;r<this.height;r+=1){var o=i[r];if(o<-this.precision||this.precision<o){t=r;break}}this.pivot(n,t)}return t},mn.prototype.updateVariableValues=function(){for(var e=this.variables.length,t=Math.round(1/this.precision),n=0;n<e;n+=1){var i=this.variables[n],o=this.rowByVarIndex[i.index];i.value=-1===o?0:Math.round(this.matrix[o][this.rhsColumn]*t)/t}},mn.prototype.updateRightHandSide=function(e,t){var n=this.height-1,i=this.rowByVarIndex[e.index];if(-1===i){for(var r=this.colByVarIndex[e.index],o=0;o<=n;o+=1){var a=this.matrix[o];a[this.rhsColumn]-=t*a[r]}var s=this.optionalObjectives.length;if(0<s)for(var l=0;l<s;l+=1){var u=this.optionalObjectives[l].reducedCosts;u[this.rhsColumn]-=t*u[r]}}else this.matrix[i][this.rhsColumn]-=t},mn.prototype.updateConstraintCoefficient=function(e,t,n){if(e.index===t.index)throw new Error("[Tableau.updateConstraintCoefficient] constraint index should not be equal to variable index !");var i=this._putInBase(e.index),r=this.colByVarIndex[t.index];if(-1===r)for(var o=this.rowByVarIndex[t.index],a=0;a<this.width;a+=1)this.matrix[i][a]+=n*this.matrix[o][a];else this.matrix[i][r]-=n},mn.prototype.updateCost=function(e,t){var n=e.index,i=this.width-1,r=this.colByVarIndex[n];if(-1===r){var o,a=this.matrix[this.rowByVarIndex[n]];if(0===e.priority){var s=this.matrix[0];for(o=0;o<=i;o+=1)s[o]+=t*a[o]}else{var l=this.objectivesByPriority[e.priority].reducedCosts;for(o=0;o<=i;o+=1)l[o]+=t*a[o]}}else this.matrix[0][r]-=t},mn.prototype.addConstraint=function(e){var t=e.isUpperBound?1:-1,n=this.height,i=this.matrix[n];void 0===i&&(i=this.matrix[0].slice(),this.matrix[n]=i);for(var r=this.width-1,o=0;o<=r;o+=1)i[o]=0;i[this.rhsColumn]=t*e.rhs;for(var a=e.terms,s=a.length,l=0;l<s;l+=1){var u=a[l],d=u.coefficient,c=u.variable.index,h=this.rowByVarIndex[c];if(-1===h)i[this.colByVarIndex[c]]+=t*d;else{var p=this.matrix[h];for(o=0;o<=r;o+=1)i[o]-=t*d*p[o]}}var g=e.index;this.varIndexByRow[n]=g,this.rowByVarIndex[g]=n,this.colByVarIndex[g]=-1,this.height+=1},mn.prototype.removeConstraint=function(e){var t=e.index,n=this.height-1,i=this._putInBase(t),r=this.matrix[n];this.matrix[n]=this.matrix[i],this.matrix[i]=r,this.varIndexByRow[i]=this.varIndexByRow[n],this.varIndexByRow[n]=-1,this.rowByVarIndex[t]=-1,this.availableIndexes[this.availableIndexes.length]=t,e.slack.index=-1,--this.height},mn.prototype.addVariable=function(e){var t=this.height-1,n=this.width,i=!0===this.model.isMinimization?-e.cost:e.cost,r=e.priority,o=this.optionalObjectives.length;if(0<o)for(var a=0;a<o;a+=1)this.optionalObjectives[a].reducedCosts[n]=0;0===r?this.matrix[0][n]=i:(this.setOptionalObjective(r,n,i),this.matrix[0][n]=0);for(var s=1;s<=t;s+=1)this.matrix[s][n]=0;var l=e.index;this.varIndexByCol[n]=l,this.rowByVarIndex[l]=-1,this.colByVarIndex[l]=n,this.width+=1},mn.prototype.removeVariable=function(e){var t=e.index,n=this._takeOutOfBase(t),i=this.width-1;if(n!==i){for(var r=this.height-1,o=0;o<=r;o+=1){var a=this.matrix[o];a[n]=a[i]}var s=this.optionalObjectives.length;if(0<s)for(var l=0;l<s;l+=1){var u=this.optionalObjectives[l].reducedCosts;u[n]=u[i]}var d=this.varIndexByCol[i];this.varIndexByCol[n]=d,this.colByVarIndex[d]=n}this.varIndexByCol[i]=-1,this.colByVarIndex[t]=-1,this.availableIndexes[this.availableIndexes.length]=t,e.index=-1,--this.width},mn.prototype.log=function(e,t){console.log("****",e,"****"),console.log("Nb Variables",this.width-1),console.log("Nb Constraints",this.height-1),console.log("Basic Indexes",this.varIndexByRow),console.log("Non Basic Indexes",this.varIndexByCol),console.log("Rows",this.rowByVarIndex),console.log("Cols",this.colByVarIndex);var n,i,r,o,a,s,l,u,d,c,h="",p=[" "];for(i=1;i<this.width;i+=1)l=" ",u="\t",5<(s=void 0===(o=this.variablesPerIndex[a=this.varIndexByCol[i]])?"c"+a:o.id).length?l+=" ":u+="\t",p[i]=l,h+=u+s;console.log(h);var g=this.matrix[this.costRowIndex],m="\t";for(n=1;n<this.width;n+=1)m+="\t",m+=p[n],m+=g[n].toFixed(5);for(m+="\t"+p[0]+g[0].toFixed(5),console.log(m+"\tZ"),r=1;r<this.height;r+=1){for(d=this.matrix[r],c="\t",i=1;i<this.width;i+=1)c+="\t"+p[i]+d[i].toFixed(5);c+="\t"+p[0]+d[0].toFixed(5),s=void 0===(o=this.variablesPerIndex[a=this.varIndexByRow[r]])?"c"+a:o.id,console.log(c+"\t"+s)}console.log("");var x=this.optionalObjectives.length;if(0<x){console.log("    Optional objectives:");for(var v=0;v<x;v+=1){var y=this.optionalObjectives[v].reducedCosts,b="";for(n=1;n<this.width;n+=1)b+=y[n]<0?"":" ",b+=p[n],b+=y[n].toFixed(5);b+=(y[0]<0?"":" ")+p[0]+y[0].toFixed(5),console.log(b+" z"+v)}}return console.log("Feasible?",this.feasible),console.log("evaluation",this.evaluation),this},mn.prototype.copy=function(){var e=new mn(this.precision);e.width=this.width,e.height=this.height,e.nVars=this.nVars,e.model=this.model,e.variables=this.variables,e.variablesPerIndex=this.variablesPerIndex,e.unrestrictedVars=this.unrestrictedVars,e.lastElementIndex=this.lastElementIndex,e.varIndexByRow=this.varIndexByRow.slice(),e.varIndexByCol=this.varIndexByCol.slice(),e.rowByVarIndex=this.rowByVarIndex.slice(),e.colByVarIndex=this.colByVarIndex.slice(),e.availableIndexes=this.availableIndexes.slice();for(var t=[],n=0;n<this.optionalObjectives.length;n++)t[n]=this.optionalObjectives[n].copy();e.optionalObjectives=t;for(var i=this.matrix,r=new Array(this.height),o=0;o<this.height;o++)r[o]=i[o].slice();return e.matrix=r,e},mn.prototype.save=function(){this.savedState=this.copy()},mn.prototype.restore=function(){if(null!==this.savedState){var e,t,n=this.savedState,i=n.matrix;for(this.nVars=n.nVars,this.model=n.model,this.variables=n.variables,this.variablesPerIndex=n.variablesPerIndex,this.unrestrictedVars=n.unrestrictedVars,this.lastElementIndex=n.lastElementIndex,this.width=n.width,this.height=n.height,e=0;e<this.height;e+=1){var r=i[e],o=this.matrix[e];for(t=0;t<this.width;t+=1)o[t]=r[t]}var a=n.varIndexByRow;for(t=0;t<this.height;t+=1)this.varIndexByRow[t]=a[t];for(;this.varIndexByRow.length>this.height;)this.varIndexByRow.pop();var s=n.varIndexByCol;for(e=0;e<this.width;e+=1)this.varIndexByCol[e]=s[e];for(;this.varIndexByCol.length>this.width;)this.varIndexByCol.pop();for(var l=n.rowByVarIndex,u=n.colByVarIndex,d=0;d<this.nVars;d+=1)this.rowByVarIndex[d]=l[d],this.colByVarIndex[d]=u[d];if(0<n.optionalObjectives.length&&0<this.optionalObjectives.length){this.optionalObjectives=[],this.optionalObjectivePerPriority={};for(var c=0;c<n.optionalObjectives.length;c++){var h=n.optionalObjectives[c].copy();this.optionalObjectives[c]=h,this.optionalObjectivePerPriority[h.priority]=h}}}},mn.prototype.getMostFractionalVar=function(){for(var e=0,t=null,n=null,i=this.model.integerVariables,r=i.length,o=0;o<r;o++){var a=i[o].index,s=this.rowByVarIndex[a];if(-1!==s){var l=this.matrix[s][this.rhsColumn],u=Math.abs(l-Math.round(l));e<u&&(e=u,t=a,n=l)}}return new Pv(t,n)},mn.prototype.getFractionalVarWithLowestCost=function(){for(var e=1/0,t=null,n=null,i=this.model.integerVariables,r=i.length,o=0;o<r;o++){var a=i[o],s=a.index,l=this.rowByVarIndex[s];if(-1!==l){var u=this.matrix[l][this.rhsColumn];if(Math.abs(u-Math.round(u))>this.precision){var d=a.cost;d<e&&(e=d,t=s,n=u)}}}return new Pv(t,n)},mn.prototype.countIntegerValues=function(){for(var e=0,t=1;t<this.height;t+=1)if(this.variablesPerIndex[this.varIndexByRow[t]].isInteger){var n=this.matrix[t][this.rhsColumn];(n-=Math.floor(n))<this.precision&&-n<this.precision&&(e+=1)}return e},mn.prototype.isIntegral=function(){for(var e=this.model.integerVariables,t=e.length,n=0;n<t;n++){var i=this.rowByVarIndex[e[n].index];if(-1!==i){var r=this.matrix[i][this.rhsColumn];if(Math.abs(r-Math.round(r))>this.precision)return!1}}return!0},mn.prototype.computeFractionalVolume=function(e){for(var t=-1,n=1;n<this.height;n+=1)if(this.variablesPerIndex[this.varIndexByRow[n]].isInteger){var i=this.matrix[n][this.rhsColumn];if(i=Math.abs(i),Math.min(i-Math.floor(i),Math.floor(i+1))<this.precision){if(!e)return 0}else-1===t?t=i:t*=i}return-1===t?0:t};var DS=mn;function Dv(e,t,n){this.type=e,this.varIndex=t,this.value=n}function bh(e,t){this.relaxedEvaluation=e,this.cuts=t}function RS(e,t){return t.relaxedEvaluation-e.relaxedEvaluation}mn.prototype.applyCuts=function(e){if(this.restore(),this.addCutConstraints(e),this.simplex(),this.model.useMIRCuts)for(var t=!0;t;){var n=this.computeFractionalVolume(!0);this.applyMIRCuts(),this.simplex(),.9*n<=this.computeFractionalVolume(!0)&&(t=!1)}},mn.prototype.branchAndCut=function(){for(var e=[],t=0,n=1/0,i=null,r=[],o=0;o<this.optionalObjectives.length;o+=1)r.push(1/0);var a=new bh(-1/0,[]);for(e.push(a);0<e.length;)if(!((a=e.pop()).relaxedEvaluation>n)){var s=a.cuts;if(this.applyCuts(s),t++,!1!==this.feasible){var l=this.evaluation;if(!(n<l)){if(l===n){for(var u=!0,d=0;d<this.optionalObjectives.length&&!(this.optionalObjectives[d].reducedCosts[0]>r[d]);d+=1)if(this.optionalObjectives[d].reducedCosts[0]<r[d]){u=!1;break}if(u)continue}if(!0===this.isIntegral()){if(1===t)return void(this.branchAndCutIterations=t);i=a,n=l;for(var c=0;c<this.optionalObjectives.length;c+=1)r[c]=this.optionalObjectives[c].reducedCosts[0]}else{1===t&&this.save();for(var h=this.getMostFractionalVar(),p=h.index,g=[],m=[],x=s.length,v=0;v<x;v+=1){var y=s[v];y.varIndex===p?"min"===y.type?m.push(y):g.push(y):(g.push(y),m.push(y))}var b=Math.ceil(h.value),S=Math.floor(h.value),w=new Dv("min",p,b);g.push(w);var M=new Dv("max",p,S);m.push(M),e.push(new bh(l,g)),e.push(new bh(l,m)),e.sort(RS)}}}}null!==i&&this.applyCuts(i.cuts),this.branchAndCutIterations=t};var zS={},dd=Xo.Constraint,Rv=Xo.Equality,BS=Xo.Variable,VS=Xo.IntegerVariable;function ti(e,t){this.tableau=new mn(e),this.name=t,this.variables=[],this.integerVariables=[],this.unrestrictedVariables={},this.constraints=[],this.nConstraints=0,this.nVariables=0,this.isMinimization=!0,this.tableauInitialized=!1,this.relaxationIndex=1,this.useMIRCuts=!0,this.checkForCycles=!1}var Eh=ti;ti.prototype.minimize=function(){return this.isMinimization=!0,this},ti.prototype.maximize=function(){return this.isMinimization=!1,this},ti.prototype._getNewElementIndex=function(){if(0<this.availableIndexes.length)return this.availableIndexes.pop();var e=this.lastElementIndex;return this.lastElementIndex+=1,e},ti.prototype._addConstraint=function(e){var t=e.slack;this.tableau.variablesPerIndex[t.index]=t,this.constraints.push(e),this.nConstraints+=1,!0===this.tableauInitialized&&this.tableau.addConstraint(e)},ti.prototype.smallerThan=function(e){var t=new dd(e,!0,this.tableau.getNewElementIndex(),this);return this._addConstraint(t),t},ti.prototype.greaterThan=function(e){var t=new dd(e,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(t),t},ti.prototype.equal=function(e){var t=new dd(e,!0,this.tableau.getNewElementIndex(),this);this._addConstraint(t);var n=new dd(e,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(n),new Rv(t,n)},ti.prototype.addVariable=function(e,t,n,i,r){if("string"==typeof r)switch(r){case"required":r=0;break;case"strong":r=1;break;case"medium":r=2;break;case"weak":r=3;break;default:r=0}var o,a=this.tableau.getNewElementIndex();return null==t&&(t="v"+a),null==e&&(e=0),null==r&&(r=0),n?(o=new VS(t,e,a,r),this.integerVariables.push(o)):o=new BS(t,e,a,r),this.variables.push(o),this.tableau.variablesPerIndex[a]=o,i&&(this.unrestrictedVariables[a]=!0),this.nVariables+=1,!0===this.tableauInitialized&&this.tableau.addVariable(o),o},ti.prototype._removeConstraint=function(e){var t=this.constraints.indexOf(e);-1!==t?(this.constraints.splice(t,1),--this.nConstraints,!0===this.tableauInitialized&&this.tableau.removeConstraint(e),e.relaxation&&this.removeVariable(e.relaxation)):console.warn("[Model.removeConstraint] Constraint not present in model")},ti.prototype.removeConstraint=function(e){return e.isEquality?(this._removeConstraint(e.upperBound),this._removeConstraint(e.lowerBound)):this._removeConstraint(e),this},ti.prototype.removeVariable=function(e){var t=this.variables.indexOf(e);if(-1!==t)return this.variables.splice(t,1),!0===this.tableauInitialized&&this.tableau.removeVariable(e),this;console.warn("[Model.removeVariable] Variable not present in model")},ti.prototype.updateRightHandSide=function(e,t){return!0===this.tableauInitialized&&this.tableau.updateRightHandSide(e,t),this},ti.prototype.updateConstraintCoefficient=function(e,t,n){return!0===this.tableauInitialized&&this.tableau.updateConstraintCoefficient(e,t,n),this},ti.prototype.setCost=function(e,t){var n=e-t.cost;return!1===this.isMinimization&&(n=-n),t.cost=e,this.tableau.updateCost(t,n),this},ti.prototype.loadJson=function(e){this.isMinimization="max"!==e.opType;for(var t=e.variables,n=e.constraints,i={},r={},o=Object.keys(n),a=o.length,s=0;s<a;s+=1){var l,u,d=o[s],c=n[d],h=c.equal,p=c.weight,g=c.priority,m=void 0!==p||void 0!==g;if(void 0===h){var x=c.min;void 0!==x&&(l=this.greaterThan(x),i[d]=l,m&&l.relax(p,g));var v=c.max;void 0!==v&&(u=this.smallerThan(v),r[d]=u,m&&u.relax(p,g))}else{l=this.greaterThan(h),i[d]=l,u=this.smallerThan(h),r[d]=u;var y=new Rv(l,u);m&&y.relax(p,g)}}for(var b=Object.keys(t),S=b.length,w=e.ints||{},M=e.binaries||{},N=e.unrestricted||{},D=e.optimize,P=0;P<S;P+=1){var L=b[P],V=t[L],J=!!M[L],j=this.addVariable(V[D]||0,L,!!w[L]||J,!!N[L]);J&&this.smallerThan(1).addTerm(1,j);var Y=Object.keys(V);for(s=0;s<Y.length;s+=1){var he=Y[s];if(he!==D){var pe=V[he],Ae=i[he];void 0!==Ae&&Ae.addTerm(pe,j);var Ie=r[he];void 0!==Ie&&Ie.addTerm(pe,j)}}}return this},ti.prototype.getNumberOfIntegerVariables=function(){return this.integerVariables.length},ti.prototype.solve=function(){return!1===this.tableauInitialized&&(this.tableau.setModel(this),this.tableauInitialized=!0),this.tableau.solve()},ti.prototype.isFeasible=function(){return this.tableau.feasible},ti.prototype.save=function(){return this.tableau.save()},ti.prototype.restore=function(){return this.tableau.restore()},ti.prototype.activateMIRCuts=function(e){this.useMIRCuts=e},ti.prototype.debug=function(e){this.checkForCycles=e},ti.prototype.log=function(e){return this.tableau.log(e)};var zv={CleanObjectiveAttributes:function(e){var t,n,i;if("string"==typeof e.optimize){if(e.constraints[e.optimize]){for(n in t=Math.random(),e.variables)e.variables[n][e.optimize]&&(e.variables[n][t]=e.variables[n][e.optimize]);return e.constraints[t]=e.constraints[e.optimize],delete e.constraints[e.optimize],e}return e}for(i in e.optimize)if(e.constraints[i])if("equal"===e.constraints[i])delete e.optimize[i];else{for(n in t=Math.random(),e.variables)e.variables[n][i]&&(e.variables[n][t]=e.variables[n][i]);e.constraints[t]=e.constraints[i],delete e.constraints[i]}return e}};function US(e){return e.length?function(t){var n={is_blank:/^\W{0,}$/,is_objective:/(max|min)(imize){0,}\:/i,is_int:/^(?!\/\*)\W{0,}int/i,is_constraint:/(\>|\<){0,}\=/i,is_unrestricted:/^\S{0,}unrestricted/i,parse_lhs:/(\-|\+){0,1}\s{0,1}\d{0,}\.{0,}\d{0,}\s{0,}[A-Za-z]\S{0,}/gi,parse_rhs:/(\-|\+){0,1}\d{1,}\.{0,}\d{0,}\W{0,}\;{0,1}$/i,parse_dir:/(\>|\<){0,}\=/gi,parse_int:/[^\s|^\,]+/gi,get_num:/(\-|\+){0,1}(\W|^)\d+\.{0,1}\d{0,}/g,get_word:/[A-Za-z].*/},i={opType:"",optimize:"_obj",constraints:{},variables:{}},r={">=":"min","<=":"max","=":"equal"},o="",a=null,s="",l="",u="",d=0;"string"==typeof t&&(t=t.split("\n"));for(var c=0;c<t.length;c++)if(u="__"+c,a=null,n.is_objective.test(o=t[c]))i.opType=o.match(/(max|min)/gi)[0],(a=o.match(n.parse_lhs).map(function(p){return p.replace(/\s+/,"")}).slice(1)).forEach(function(p){s=null===(s=p.match(n.get_num))?"-"===p.substr(0,1)?-1:1:s[0],s=parseFloat(s),l=p.match(n.get_word)[0].replace(/\;$/,""),i.variables[l]=i.variables[l]||{},i.variables[l]._obj=s});else if(n.is_int.test(o))a=o.match(n.parse_int).slice(1),i.ints=i.ints||{},a.forEach(function(p){p=p.replace(";",""),i.ints[p]=1});else if(n.is_constraint.test(o)){var h=o.indexOf(":");(a=(-1===h?o:o.slice(h+1)).match(n.parse_lhs).map(function(p){return p.replace(/\s+/,"")})).forEach(function(p){s=null===(s=p.match(n.get_num))?"-"===p.substr(0,1)?-1:1:s[0],s=parseFloat(s),l=p.match(n.get_word)[0],i.variables[l]=i.variables[l]||{},i.variables[l][u]=s}),d=parseFloat(o.match(n.parse_rhs)[0]),o=r[o.match(n.parse_dir)[0]],i.constraints[u]=i.constraints[u]||{},i.constraints[u][o]=d}else n.is_unrestricted.test(o)&&(a=o.match(n.parse_int).slice(1),i.unrestricted=i.unrestricted||{},a.forEach(function(p){p=p.replace(";",""),i.unrestricted[p]=1}));return i}(e):function(t){if(!t)throw new Error("Solver requires a model to operate on");var n="",i={max:"<=",min:">=",equal:"="},r=new RegExp("[^A-Za-z0-9]+","gi");for(var o in n+=t.opType+":",t.variables)t.variables[o][o]=t.variables[o][o]?t.variables[o][o]:1,t.variables[o][t.optimize]&&(n+=" "+t.variables[o][t.optimize]+" "+o.replace(r,"_"));for(o in n+=";\n",t.constraints)for(var a in t.constraints[o]){for(var s in t.variables)t.variables[s][o]&&(n+=" "+t.variables[s][o]+" "+s.replace(r,"_"));n+=" "+i[a]+" "+t.constraints[o][a],n+=";\n"}if(t.ints)for(o in n+="\n\n",t.ints)n+="int "+o.replace(r,"_")+";\n";if(t.unrestricted)for(o in n+="\n\n",t.unrestricted)n+="unrestricted "+o.replace(r,"_")+";\n";return n}(e)}function Bv(){this.Model=Eh,this.branchAndCut=zS,this.Constraint=jS,this.Variable=GS,this.Numeral=ZS,this.Term=qS,this.Tableau=DS,this.lastSolvedModel=null,this.Solve=function(e,t,n,i){if(i)for(var r in zv)e=zv[r](e);if(!e)throw new Error("Solver requires a model to operate on");!(e instanceof Eh)&&(e=new Eh(t).loadJson(e));var o=e.solve();if(this.lastSolvedModel=e,o.solutionSet=o.generateSolutionSet(),n)return o;var a={};return a.feasible=o.feasible,a.result=o.evaluation,a.bounded=o.bounded,Object.keys(o.solutionSet).map(function(s){a[s]=o.solutionSet[s]}),a},this.ReformatLP=US,this.MultiObjective=function(e){return function(t,n){var i,r,o,a,s,l=n.optimize,u=JSON.parse(JSON.stringify(n.optimize)),d=Object.keys(n.optimize),c=0,h={},p="",g={},m=[];for(delete n.optimize,r=0;r<d.length;r++)u[d[r]]=0;for(r=0;r<d.length;r++){for(s in n.optimize=d[r],n.opType=l[d[r]],i=t.Solve(n,void 0,void 0,!0),d)if(!n.variables[d[s]])for(a in i[d[s]]=i[d[s]]?i[d[s]]:0,n.variables)n.variables[a][d[s]]&&i[a]&&(i[d[s]]+=i[a]*n.variables[a][d[s]]);for(p="base",o=0;o<d.length;o++)p+=i[d[o]]?"-"+(1e3*i[d[o]]|0)/1e3:"-0";if(!h[p]){for(h[p]=1,c++,o=0;o<d.length;o++)i[d[o]]&&(u[d[o]]+=i[d[o]]);delete i.feasible,delete i.result,m.push(i)}}for(r=0;r<d.length;r++)n.constraints[d[r]]={equal:u[d[r]]/c};for(r in n.optimize="cheater-"+Math.random(),n.opType="max",n.variables)n.variables[r].cheater=1;for(r in m)for(a in m[r])g[a]=g[a]||{min:1e99,max:-1e99};for(r in g)for(a in m)m[a][r]?(m[a][r]>g[r].max&&(g[r].max=m[a][r]),m[a][r]<g[r].min&&(g[r].min=m[a][r])):(m[a][r]=0,g[r].min=0);return{midpoint:i=t.Solve(n,void 0,void 0,!0),vertices:m,ranges:g}}(this,e)}}var jS=Xo.Constraint,GS=Xo.Variable,ZS=Xo.Numeral,qS=Xo.Term;"object"==typeof window&&(window.solver=new Bv);var HS=new Bv;function WS(e){var t={},n={},i={};e.nodes.forEach(function(o){n[o.id]=1,t[o.id]={opt:o.children.length},o.children.forEach(function(a){var s=o.id+"->"+a.id;i[s]={min:1},t[o.id][s]=-1})}),e.nodes.forEach(function(o){o.children.forEach(function(a){var s=o.id+"->"+a.id;t[a.id].opt--,t[a.id][s]=1})});var r=HS.Solve({optimize:"opt",opType:"max",constraints:i,variables:t,ints:n});return e.nodes.forEach(function(o){o.layer=r[o.id]||0}),e}function Vv(e){return e.nodes.forEach(function(t){t.layer=null!=t.data.layer?t.data.layer:t.layer}),e}function YS(e){var t=Object.assign({},{normalization:!0},e),n=WS;return function(i){if(i.nodes.some(function(c){return"layer"in c.data&&c.data.layer<0}))throw new Error("Some nodes have negative layering information");if(!t.normalization&&i.nodes.every(function(c){return"layer"in c.data&&-1<c.data.layer})){var r=[];i.nodes.forEach(function(c){return r[c.data.layer]=1});for(var o=r.findIndex(function(c){return null!=c}),a=0,s=r.slice(o);a<s.length;a+=1)if(null==s[a])throw new Error("The overall layering contains gaps (two non-consecutive layers)")}i.nodes.some(function(c){return"layer"in c.data&&0===c.data.layer})||Vv(n(i));var l,u,d=function(c){if(c.nodes.every(function(p){return p.layer})){var h=1/0;c.nodes.forEach(function(p){h=Math.min(h,p.layer)}),c.nodes.forEach(function(p){p.layer-=h})}return c}(function(c){if(c.nodes.some(function(p){return p.data.sink})){var h=-1/0;c.nodes.forEach(function(p){h=Math.max(h,p.layer)}),c.nodes.forEach(function(p){p.data.sink&&(p.layer=h+1)})}return c}(function(c){var h={};c.nodes.forEach(function(w){h[w.id]=(h[w.id]||[]).concat(w.children),w.children.forEach(function(M){h[M.id]=(h[M.id]||[]).concat([w])})});var p=[];c.nodes.forEach(function(w){0===w.layer&&p.push(w)});var g={},m={};for(c.nodes.forEach(function(w){null!=w.layer&&(m[w.id]=w.layer)});p.length;)for(var x=p.shift().id,v=0,y=h[x];v<y.length;v+=1){var b=y[v];if(!g[b.id]){if(null==m[b.id]){var S=m[x]+1;m[b.id]=S,b.layer=S}g[b.id]=!0,p.push(b)}}return c}(Vv(i))));return function(c,h){if(h.normalization){var p=[];c.nodes.forEach(function(m){return p[m.layer]=0});var g=Array.from(p).reduce(function(m,x,v){if(0===v)return m.push(0),m;var y=m[v-1];return m.push(null!=x?y:y-1),m},[]);c.nodes.forEach(function(m){m.layer+=g[m.layer]})}}(d,t),(u=(l=d).nodes.reduce(function(c,h){return h.data.fixed&&(null==c||c.layer>h.layer)?h:c},null))&&l.nodes.forEach(function(c){c.ref=u.id}),l}}var Jo=function(){this.root=null};function XS(e){return e.nodes.filter(function(t){return!t.layer})}Jo.prototype.fit=function(e){this.root={x:0,y:0,w:e.length?e[0].w:0,h:e.length?e[0].h:0};for(var i=0,r=e;i<r.length;i+=1){var o=r[i],a=this.findNode(this.root,o.w,o.h);o.fit=a?this.splitNode(a,o.w,o.h):this.growNode(o.w,o.h)}},Jo.prototype.findNode=function(e,t,n){return e.used?this.findNode(e.right,t,n)||this.findNode(e.down,t,n):t<=e.w&&n<=e.h?e:void 0},Jo.prototype.splitNode=function(e,t,n){return e.used=!0,e.down={x:e.x,y:e.y+n,w:e.w,h:e.h-n},e.right={x:e.x+t,y:e.y,w:e.w-t,h:n},e},Jo.prototype.growNode=function(e,t){var n=e<=this.root.w,i=t<=this.root.h;return i&&this.root.h>=this.root.w+e?this.growRight(e,t):n&&this.root.w>=this.root.h+t?this.growDown(e,t):i?this.growRight(e,t):n?this.growDown(e,t):void 0},Jo.prototype.getNewRoot=function(e,t,n,i){return void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=this.root),void 0===i&&(i=this.root),{used:!0,x:0,y:0,w:this.root.w+e,h:this.root.h+t,right:n,down:i}},Jo.prototype.growRight=function(e,t){return this.root=this.getNewRoot(e,0,{x:this.root.w,y:0,w:e,h:this.root.h}),this.grow(e,t)},Jo.prototype.growDown=function(e,t){return this.root=this.getNewRoot(0,t,void 0,{x:0,y:this.root.h,w:this.root.w,h:t}),this.grow(e,t)},Jo.prototype.grow=function(e,t){var n=this.findNode(this.root,e,t);if(n)return this.splitNode(n,e,t)};var Uv={down:function(){},up:function(e,t,n){e.y=-e.y+n},left:function(e,t,n){var i=e.x;e.x=-e.y+n,e.y=i-t},right:function(e,t,n){var i=e.x;e.x=e.y-n,e.y=-i+t}};function jv(e,t,n){for(var i,r,o,a,s=-1/0,l=-1/0,u=[],d=n.nodesSeparation||0,c=(i=t,o=(r=e.reduce(function(qe,Le){return Le.nodes.reduce(function(He,Je){var Te=i[Je.id]||{},Re=Te.x,Ze=Te.y;return null!=Re&&null!==Ze&&(He.x=Math.min(Re,He.x),He.y=Math.min(Ze,He.y)),He},qe)},{x:1/0,y:1/0})).x,a=r.y,{x:isFinite(o)?o:0,y:isFinite(a)?a:0}),h=e.reduce(function(qe,Le){return Le.nodes.filter(function(He){return He.data&&He.data.fixed}).reduce(function(He,Je){var et=t[Je.id];return He[Je.id]={x:et.x,y:et.y},He},qe)},{}),p=function(){var qe=m[g],Le={},He=qe.nodes,Je=1==He.length,et=2*Iv(He)|5,Te=null!=n.layerSeparation?n.layerSeparation:50,Re=He.reduce(function(Z,B){return Math.min(Z,B.x)},1/0);s=He.reduce(function(Z,B){return Math.max(Z,B.x)},-1/0)-Re;for(var Ze=0,Qe=He;Ze<Qe.length;Ze+=1){var dt=Qe[Ze],Ht=dt.x,Kt=dt.y,ln=dt.id;t[ln]&&(Je?t[ln].x=t[ln].y=0:(t[ln].x=Ht-Re,t[ln].y=Kt,Le[Kt]=Le[Kt]||[],Le[Kt].push(t[ln])))}var an=Math.max(et,Te),hn=Object.keys(Le),W=hn.reduce(function(Z,B){return Math.max(Z,Le[B].length-1)},1)*(3+Math.max(1,d));l=(hn.length||1)*an,s=Math.max(s,1),qe.isFake||hn.sort(function(Z,B){return Z-B}).forEach(function(Z,B){Le[Z].forEach(function(K){K.y=B*an,K.x=K.x/s*W})}),u.push({w:Math.ceil(W),h:Math.ceil(l),dag:qe}),l=s=-1/0},g=0,m=e;g<m.length;g+=1)p();u.sort(function(qe,Le){return Math.max(Le.w,Le.h)-Math.max(qe.w,qe.h)}),(new Jo).fit(u);for(var v,S=u.reduce(function(qe,Le){return Math.max(qe,Le.h)},1),w=u.reduce(function(qe,Le){var He=Le.fit;return Math.max(He&&He.x||0,qe)},1),M=0,N=u;M<N.length;M+=1){for(var D=N[M],L=D.dag,V=D.w,X=D.h,J=D.fit||{x:0,y:0},se=J.y/S*50+J.y,re=J.x/w*100+J.x,j=0,Y=L.nodes;j<Y.length;j+=1){var he=Y[j].id;t[he]&&(t[he].x+=re,t[he].y+=se,(v=n.direction)&&v in Uv&&Uv[v](t[he],(V+re)/2,(X+se)/2),t[he].x+=c.x,t[he].y+=c.y)}var pe=L.nodes[0]&&L.nodes[0].ref,Ae=0,Ie=0;if(pe&&(Ae=t[pe].x-h[pe].x,Ie=t[pe].y-h[pe].y),Ae||Ie)for(var ot=0,at=L.nodes;ot<at.length;ot+=1){var We=at[ot].id;t[We]&&(t[We].x-=Ae,t[We].y-=Ie)}}for(var vt=0,Tt=Object.keys(h);vt<Tt.length;vt+=1){var Ge=Tt[vt];t[Ge].x=h[Ge].x,t[Ge].y=h[Ge].y}return e}var Gv={rect:jv,hierarchy:function(e,t,n,i){var r=e;if(1<e.length){for(var o={id:"__root__",parentIds:[],virtual:!0},a=0,s=e.map(XS);a<s.length;a+=1)for(var l=0,u=s[a];l<u.length;l+=1)u[l].data.parentIds.push(o.id);r=i([e.reduce(function(d,c){return d.concat(c.nodes.map(function(h){return h.data}))},[o])],n)}return jv(r,t,n)}};function $S(e){if(!e||!e.length)throw Error("Cannot stratify empty data");for(var t=0,n=e;t<n.length;t+=1){var i=n[t];if(null==i)throw Error('Node data is "null"');if(null==i.id)throw Error('Node id contains a "null" value')}for(var r=e.map(function(g){return lh(g.id,g)}),o=r.reduce(function(g,m){if(g[m.id])throw Error("The connected component contains id duplicates: "+m.id);return g[m.id]=m,g},{}),a=lh(),s=0,l=r;s<l.length;s+=1){for(var u=l[s],d=0,c=u.data.parentIds;d<c.length;d+=1){var h=c[d],p=o[h];if(!p)throw Error("The node "+u.id+" has a missing parent id "+h);p.children.push(u)}u.data.parentIds.length||a.children.push(u)}return{nodes:function(g){for(var m={},x=[].concat(g.children),v=[];x.length;){var y=x.pop();m[y.id]||(v.push(y),m[y.id]=1,x.push.apply(x,y.children))}return v}(a)}}function tA(e,t){var n=t.decross,i=t.separation,r=t.coord;(0,t.layering)(e);var o,a,s=e.nodes.reduce(function(l,u){return l[u.layer]=l[u.layer]||[],l[u.layer].push(u),u.children=u.children.map(function(d){if(d.layer===u.layer+1)return d;for(var c=d,h=d.layer-1;h>u.layer;h--){var p=lh(u.id+"->"+d.id+"@"+h);p.children=[c],l[h]=l[h]||[],l[h].push(p),c=p}return c}),l},[]);return a=1===(o=s).length?nA:iA,o.forEach(function(l,u){for(var d=0,c=l;d<c.length;d+=1)c[d].y=a(u,o.length)}),function(l,u){var d=u.coord,c=u.decross,h=u.separation;if(l.every(function(p){return 1===p.length}))return l.forEach(function(p){return p[0].x=.5});c(l),d(l,h)}(s,{decross:n,coord:r,separation:i}),e.nodes.forEach(function(l){l.data&&(l.children=l.children.filter(function(u){return u.data}))}),e}function nA(){return.5}function iA(e,t){return 1*e/(t-1)}function Sh(e){return{id:""+e.id,layer:e.layer,sink:e.sink,radius:e.r,fixed:!1===e.layoutable,parentIds:[],ref:null}}function qv(e,t){void 0===t&&(t={});for(var n=[],i=0,r=e;i<r.length;i+=1){var o=$S(r[i]);n.push(o),tA(o,{decross:function(a){return a.slice(0,a.length-1).forEach(function(s,l){return OS(s,a[l+1])}),a},separation:MS(Iv(o.nodes)),coord:t.evenDistribution?function(e,t){var n=-hh;return e.forEach(function(i){var r=i.filter(Ru);if(1===r.length)r[0].x=.5;else{r.reduce(function(a,s){return s.x=void 0===a?0:a.x+t(a,s),s},void 0);var o=r[r.length-1].x;n=Math.max(n,o),r.forEach(function(a){return a.x/=o})}}),n=Math.max(n,1),us(e,function(i){return i.x*=n}),e}:function(e,t){var n,i,r,o,a,s,l=(n={},us(e,function(D){n[D.id]||(n[D.id]={successors:[],ancestors:[]});for(var P=0,L=D.children;P<L.length;P+=1){var V=L[P];n[V.id]||(n[V.id]={successors:[],ancestors:[]}),V.layer>D.layer&&(n[D.id].successors.push(V),n[V.id].ancestors.push(D)),V.layer<D.layer&&(n[D.id].ancestors.push(V),n[V.id].successors.push(D))}}),{getSuccessors:function(D){return n[D.id].successors},getAncestors:function(D){return n[D.id].ancestors}}),u=l.getSuccessors,d=l.getAncestors,c=(i={},us(e,function(D,P){i[D.id]=P}),i),h=(o=u,a=function(D){return c[D.id]},s=(r=e).length,r.reduce(function(D,P,L){var X=D.conflicts;if(!L||s-2<L)return{prevLayer:D.prevLayer,conflicts:X};var J=0,se=P.length,re=P[se-1];return P.forEach(function(j,Y){var he=function(Ie){if(Ru(Ie))return o(Ie).find(Ru)}(j),pe=he?a(he):se-1;if(he||j===re)for(var Ae=function(){var Ie=P[J];o(Ie).forEach(function(ot){var at=a(ot);(at<0||pe<at)&&(X[Ie.id]=X[Ie.id]||{},X[Ie.id][ot.id]=!0)}),J++};J<=Y;)Ae()}),{prevLayer:P,conflicts:X}},{prevLayer:r[0],conflicts:{}}).conflicts),p={};ph(function(D){var P="up"===D?e:[].concat(e).reverse();fh(function(L){L===ch&&(P=P.map(function(Ae){return[].concat(Ae).reverse()}));var V,X,J,se,re,j,Y=t,he=(X=h,J="up"===D?d:u,se={},re={},j={},us(V=P,function(Ae,Ie){se[Ae.id]=Ae.id,re[Ae.id]=Ae.id,j[Ae.id]=Ie}),V.forEach(function(Ae){var Ie=-1;Ae.forEach(function(ot){var at,We,vt=J(ot).sort(function(He,Je){return j[He.id]-j[Je.id]});if(vt.length)for(var Tt=(vt.length-1)/2,Ge=0,qe=[Math.floor(Tt),Math.ceil(Tt)];Ge<qe.length;Ge+=1){var Le=vt[qe[Ge]];re[ot.id]===ot.id&&(We=Le,!(X[(at=ot).id]&&X[at.id][We.id]||X[We.id]&&X[We.id][at.id])&&Ie<j[Le.id]&&(re[Le.id]=ot.id,se[ot.id]=se[Le.id],re[ot.id]=se[ot.id],Ie=j[Le.id]))}})}),{roots:se,aligns:re}),pe=function(Ae,Ie,ot,at){var We={},vt={},Tt={},Ge={},qe={},Le={},He={};us(Ae,function(Te,Re,Ze){We[Te.id]=Te,vt[Te.id]=hh,Tt[Te.id]=Re,qe[Te.id]=Ze[Re-1]||Te,Le[Te.id]=Te,He[Te.id]=0});var Je=Math.max(1e4,1+Object.keys(He).length/2);function et(Te){if(null==Ge[Te.id]){Ge[Te.id]=0;for(var Re=Te,Ze=!1;!Ze;){if(null!=qe[Re.id]){var Qe=Le[Ie[qe[Re.id].id]];if(He[Qe.id]>Je)return;et(Qe),He[Qe.id]++,We[Te.id]===Te&&(We[Te.id]=We[Qe.id]),We[Te.id]!==We[Qe.id]?vt[We[Qe.id].id]=Math.min(vt[We[Qe.id].id],Ge[Te.id]-Ge[Qe.id]-at(Te,qe[Te.id])):Ge[Te.id]=Math.max(Ge[Te.id],Ge[Qe.id]+at(Te,qe[Te.id]))}Ze=(Re=Le[ot[Re.id]])===Te}}}return Ae.forEach(function(Te){Te.filter(function(Re){return Ie[Re.id]===Re.id}).forEach(et)}),us(Ae,function(Te){Ge[Te.id]=Ge[Ie[Te.id]];var Re=vt[We[Ie[Te.id]].id];Te.id===Ie[Te.id]&&isFinite(Re)&&(Ge[Te.id]+=Re)}),Ge}(P,he.roots,he.aligns,Y);L===ch&&(pe=uh(pe,function(Ae){return-Ae})),p[D+L]=pe})});var g,m,x,v,y,b,S,w=(g=p,m=Object.keys(g).reduce(function(D,P){var L=D.alignment,V=D.value,X=sh(g[P]),J=Math.max.apply(Math,X)-Math.min.apply(Math,X);return V<=J?{alignment:L,value:V}:{alignment:P,value:J}},{alignment:null,value:hh}).alignment,g[m]);x=p,y=sh(v=w),b=Math.min.apply(Math,y),S=Math.max.apply(Math,y),ph(function(D){fh(function(P){var L=D+P,V=x[L];if(V!==v){var X=sh(V),J=P===dh?b-Math.min.apply(Math,X):S-Math.max.apply(Math,X);J&&(x[L]=uh(V,function(se){return se+J}))}})});var M,N=uh((M=p).upleft,function(D,P){var L=[];return ph(function(V){fh(function(X){L.push(M[V+X][P])})}),L.sort(function(V,X){return V-X}),(L[1]+L[2])/2});return us(e,function(D){D.x=N[D.id]}),e},layering:YS(t)})}return n}function Hv(e,t){if(!e||!e.nodes)return e;var i,a,l=t||{},u=function(e,t){void 0===t&&(t={});for(var n=(e.edges||[]).filter(function(d){return d.source!==d.target}),i={},r=0,o=e.nodes;r<o.length;r+=1){var a=o[r];i[a.id]=a}var s=function(e,t,n){var i=t.reduce(function(o,a){return o[a.source]=o[a.source]||[],o[a.source].push(a),o},{}),r=e.reduce(function o(a,s){var l=a.visited,u=a.stack,d=a.result;if(l[s.id])return a;l[s.id]=u[s.id]=1;for(var c=0,h=i[s.id]||[];c<h.length;c+=1){var p=h[c];u[p.target]?d.push(p):o(a,n[p.target])}return delete u[s.id],a},{visited:{},stack:{},result:[]}).result.reduce(function(o,a){var s=a.source,l=a.target;return o[s]=o[s]||{},o[s][l]=1,o},{});return t.map(function(o){var a=o.source,s=o.target;return r[a]&&r[a][s]?{source:s,target:a}:o})}(e.nodes,n,i),l=function(d,c,h){void 0===h&&(h={});for(var p=Mv(c),g=Object.keys(p),m=[];g.length;){var x=TS(g[0],p);m.push(x),g=IS(g,x)}return h.skipSingletons?m:m.concat(kv(d,c,p).map(function(v){return[v.id+""]}))}(e.nodes,s,{skipSingletons:"singleton"===t.packing}),u=s.reduce(function(d,c){return d[c.source]||(d[c.source]=Sh(i[c.source])),d[c.target]||(d[c.target]=Sh(i[c.target])),d[c.target].parentIds.push(""+c.source),d},{});return{shapes:l.map(function(d){return d.map(function(c){return u[c]||Sh({id:c})})}),nLookup:i}}(e,l),c=u.nLookup,h=qv(u.shapes,l);if("singleton"===l.packing){var p=kv(e.nodes,e.edges),g=function(e,t){void 0===t&&(t={});var n=e.slice().sort(function(d,c){return c.r-d.r}),i=Math.sqrt(n.length),r=Math.floor(i),o=Math.ceil(i);r*o<n.length&&(r<o?r++:o++);var a=1.2*n.reduce(function(d,c){return Math.max(d,2*c.r)},0),s=Math.max(t.nodesGridSeparation||50,1),l=a*o+s*(o-1),u=a*r+s*Math.max(r-1,0);return n.forEach(function(d,c){var h=c%o,p=Math.floor(c/o);d.x=l*h/o,d.y=u*p/r}),{w:l,h:u}}(p,l);h.push((i=g,Object.assign({},{nodes:p.map(function(m){return Object.assign({},m,{data:m})}),isFake:!0},i)))}return void 0===(a=l)&&(a={}),(Gv[a.packing]||Gv.rect)(h,c,a,qv),e}var Wv={direction:"TB",nodeDistance:50,levelDistance:50,arrangeComponents:"fit",gridDistance:50,layer:"layer"},Yv={imports:{sequential:Hv},configure:function(e,t){void 0===e&&(e={});var n=t.graph,i=t.data;function r(b,S,w){return void 0===w&&(w=b.getNodes()),S?S instanceof or?S:b.getNodes(S):w}var o=It({},Wv,e,{nodeList:null});o.nodeList=r(n,e.nodes),o.direction=e.direction||o.rankdir||Wv.direction,o.layerSeparation=o.levelDistance,o.nodesSeparation=o.nodeDistance,o.packing=o.arrangeComponents;var a=It({},o),s=n.getEdges(),l=n.getNodes(o.nodeList);if(-1===["TB","BT","LR","RL"].indexOf(o.direction))throw new Error('direction should be one of the "TB", "BT", "LR", "RL"');if(-1===["fit","grid","singleLine"].indexOf(o.packing))throw new Error('arrangeComponents should be one of the "fit", "grid", "singleLine"');o.nodesGridSeparation=e.gridDistance;var u=l.getId(),d=l.getAttribute("layoutable").reduce(function(b,S,w){return b[u[w]]=S,b},{}),c=l.getAttributes(["x","y"]).reduce(function(b,S,w){return b[u[w]]=S,b},{}),h=l.getAttribute("radius");if("string"!=typeof a.layer)throw new Error("'layer' should be the valid data field name");for(var p=r(n,o.roots,n.nodeList()),g=i.getProperty(o.nodeList,a.layer),m=0,x=p.map(function(b){var S=-1;return o.nodeList.forEach(function(w,M){w===b&&(S=M)}),S});m<x.length;m++)g[x[m]]=0;var v=r(n,o.sinks,n.nodeList()).toArray().reduce(function(b,S){return b[S.getId()]=!0,b},{}),y=u.map(function(b){return v[b]});return{nodes:u,edges:s.map(function(b){return{id:b.getId(),source:b.getSource().getId(),target:b.getTarget().getId()}}),options:Hi(o),layoutable:d,radiuses:h,layers:g,sinks:y,coords:c}},context:function(){},update:function(e){var t=e.nodes,i=e.options,r=e.layoutable,o=e.radiuses,a=e.layers,s=e.sinks,l=e.coords,u=e.edges.filter(function(d){return d.source in r&&d.target in r});return{positions:Hv({nodes:t.map(function(d,c){return{id:d,r:o[c],layer:a[c],sink:s[c],layoutable:r[d],x:l[d].x,y:l[d].y}}),edges:u},{packing:{fit:"rect",singleLine:"hierarchy",grid:"singleton"}[i.arrangeComponents],direction:{TB:"down",BT:"up",RL:"left",LR:"right"}[i.direction],layerSeparation:i.layerSeparation,nodesSeparation:i.nodesSeparation,nodesGridSeparation:i.nodesGridSeparation,evenDistribution:i.evenDistribution}).nodes}},isRunning:function(){return!1},onSync:function(e,t){var n=e.positions,i=t.graph;return{indexes:n.map(function(r){return i.getNode(r.id)._index}),x:n.map(function(r){return r.x}),y:n.map(function(r){return r.y})}}},aA={configure:function(e,t){var n=t.graph,i=t.camera;function r(V){return void 0===V||"number"==typeof V&&isFinite(V)&&0<V}var o=e.sortBy,a=It({},e,{nodes:null});e.nodes||(a.nodes=n.getNodes()),e.nodes&&(a.nodes=e.nodes instanceof or?e.nodes:n.getNodes(e.nodes));var s,l,u,d,c,h=a.nodes,p=Array.from(h._indexes),m=function(V,X,J){if(!r(V))throw new TypeError('"rows" should be a positive integer');if(!r(X))throw new TypeError('"cols" should be a positive integer');if(V)return{rows:V,cols:Math.ceil(J/V)};if(X)return{cols:X,rows:Math.ceil(J/X)};var se=Math.ceil(Math.sqrt(J));return{cols:se,rows:Math.ceil(J/se)}}(a.rows,a.cols,p.length),x=m.rows,v=m.cols,y=(l=n,u=h,d=p,c=e.sortFallbackValue,"string"!=typeof(s=o)?d.map(function(V,X){return X}):"radius"===s?l.getAttribute(!0,"radius").getMultiple(d):"random"===s?d.map(function(){return Math.random()}):u.getData(s).map(function(V){return V||c})),b=h.getAttribute("layoutable"),S=p.reduce(function(V,X,J){return b[J]&&V.push({id:X,attr:y[J]}),V},[]),w=h.getBoundingBox(),M=.65*Math.max(w.maxScaledSize,w.maxFixedSize/i.getZoom()),N=w.minX+M,D=w.maxX-M,P=w.minY+M,L=w.maxY-M;return w.width<M*v*2&&(N=w.cx-M*v+M,D=w.cx+M*v-M),w.height<M*x*2&&(P=w.cy-M*x+M,L=w.cy+M*x-M),{sort:!!o,nodes:S,reverse:!!a.reverse,cols:v,rows:x,minX:N,maxX:D,minY:P,maxY:L}},update:function(e){var n=e.nodes,i=e.maxX,r=e.minX,o=e.maxY,a=e.minY,s=e.reverse,l=e.rows,u=e.cols;e.sort&&n.sort(function(x,v){var y=x.attr,b=v.attr;return y<b?-1:b<y?1:0}),s&&n.reverse();var d=(i-r)/(u-1),c=(o-a)/(l-1),h=r,p=a;isFinite(d)||(d=0),isFinite(c)||(c=0);var g=0,m=0;return n.forEach(function(x){x.x=h+g*d,x.y=p+m*c,(g+=1)===u&&(m+=1,g=0)}),n},onSync:function(e){return{indexes:e.map(function(t){return t.id}),x:e.map(function(t){return t.x}),y:e.map(function(t){return t.y})}}},Xv=(Jv.initNamespace=function(e){e.layouts=function(e){return It({},((l=e).modules.layouts.register("concentric",yS),{concentric:function(u){return l.modules.layouts.start("concentric",u)}}),((s=e).modules.layouts.register("radial",xS),{radial:function(u){if(void 0===u.centralNode)throw new Error('concentric layout: missing parameter "centralNode"');u.nodes=s.modules.graph.getNodes(u.nodes);var d=u.nodes.size;if(u.radiusRatio=isFinite(u.radiusRatio)?u.radiusRatio:Math.SQRT2,u.radiusDelta=isFinite(u.radiusDelta)?u.radiusDelta:0,u.nodeGap=isFinite(u.nodeGap)?u.nodeGap:10,u.repulsion=d*(isFinite(u.repulsion)?u.repulsion:1),u.maxIterations=isFinite(u.maxIterations)?Math.floor(u.maxIterations):100,u.maxIterations<1)throw new RangeError("maxIterations must be a positive integer");if(u.iterationsPerRender=isFinite(u.iterationsPerRender)?Math.floor(u.iterationsPerRender):20,u.iterationsPerRender<1)throw new RangeError("iterationsPerRender must be a positive integer");if(u.epsilon=isFinite(u.epsilon)?u.epsilon:.001,u.epsilon<=0)throw new RangeError("epsilon has to be a positive number");return s.modules.layouts.start("radial",u)}}),((a=e).modules.layouts.register("force",bS),{force:function(u){if(void 0===u&&(u={}),u.nodes){if(Array.isArray(u.nodes))u.nodes=a.getNodes(u.nodes);else if(!(u.nodes instanceof or))throw new Error("'nodes' must be a NodeList or an Array<NodeId>")}else u.nodes=a.modules.graph.getNodes();if(u.incremental)return Cv(u,a,a.layouts.force);if(void 0!==u.edgeStrength&&(!isFinite(u.edgeStrength)||u.edgeStrength<=0||1<u.edgeStrength))throw new Error("force layout: edgeStrength must be between 0 and 1");if(void 0!==u.steps&&(!isFinite(u.steps)||u.steps<=0))throw new Error("force layout: 'steps' must be a positive integer");if(void 0!==u.edgeLength&&(!isFinite(u.edgeLength)||u.edgeLength<=0))throw new Error("force layout: 'edgeLength' must be positive");if(void 0!==u.gravity&&(!isFinite(u.gravity)||u.gravity<0||1<=u.gravity))throw new Error("force layout: 'gravity' must be between 0 and 1");if(void 0!==u.charge&&!isFinite(u.charge))throw new Error("force layout: 'charge' must be a number");if(void 0!==u.radiusRatio&&(!isFinite(u.radiusRatio)||u.radiusRatio<0))throw new Error("force layout: 'radiusRatio' must be a positive number");if(void 0!==u.theta&&(!isFinite(u.theta)||u.theta<0||1<u.theta))throw new Error("force layout: 'theta' must be between 0 and 1");if(!(void 0===u.cx&&void 0===u.cy||"number"==typeof u.cx&&"number"==typeof u.cy))throw new Error("force layout: both 'cx' and 'cy' must be numbers");if(void 0!==u.siblingsOffset&&!isFinite(u.siblingsOffset))throw new Error("force layout: 'siblingsOffset' must be a number");return a.modules.layouts.start("force",u)}}),((o=e).modules.layouts.register("forceLink",CS),{forceLink:function(u){if(void 0===u&&(u={}),u.nodes){if(Array.isArray(u.nodes))u.nodes=o.getNodes(u.nodes);else if(!(u.nodes instanceof or))throw new Error("'nodes' must be a NodeList or an Array<NodeId>")}else u.nodes=o.modules.graph.getNodes();return u.incremental?Cv(u,o,o.layouts.forceLink):o.modules.layouts.start("forceLink",u)}}),((r=e).modules.layouts.register("hierarchical",Yv),{hierarchical:function(u){return void 0===u&&(u={}),u.useWebWorker=!1,r.modules.layouts.start("hierarchical",u)}}),((i=e).modules.layouts.register("sequential",Yv),{sequential:function(u){void 0===u&&(u={}),u.useWebWorker=!1;var d=It({},u,{evenDistribution:!0});return i.modules.layouts.start("sequential",d)}}),((n=e).modules.layouts.register("grid",aA),{grid:function(u){return void 0===u&&(u={}),n.modules.layouts.start("grid",u)}}),(t=e,{incremental:function(u){eo("Incremental ForceLink layout is now deprecated.\n    Please use the incremental option in force and forceLink layouts.");var d=u.nodes,c=u.centralNode;if(d instanceof or&&0===d.size||Array.isArray(d)&&0===d.length)throw new Error("Incremental ForceLink layout: no nodes are selected");if("margin"in u&&!isFinite(u.margin))throw new Error("Incremental ForceLink layout: margin has to be a positive number");if(c&&!c.getAttribute("layoutable"))return wv(t,u,t.layouts.forceLink);var h=It({},u,{nodes:u.nodes instanceof or?u.nodes:t.getNodes(u.nodes)});return Av(t,h,t.layouts.forceLink)}}),{stop:function(){return e.modules.layouts.stop()}});var t,n,i,r,o,a,s,l}(e)},Jv);function Jv(){}var Qv=(Kv.initNamespace=function(e){var t;e.mouse=(t=e,{move:function(n){return t.modules.virtualMouse.move(n)},down:function(n){return t.modules.virtualMouse.down(n)},up:function(n){return t.modules.virtualMouse.up(n)},click:function(n){return t.modules.virtualMouse.click(n)},rightClick:function(n){return t.modules.virtualMouse.rightClick(n)},doubleClick:function(n){return t.modules.virtualMouse.doubleClick(n)},drag:function(n,i){return t.modules.virtualMouse.drag(n,i)},wheel:function(n){return t.modules.virtualMouse.wheel(n)}})},Kv);function Kv(){}var $v=(ey.initNamespace=function(e){var t;e.pathfinding=(t=e,{astar:function(n,i,r){return void 0===r&&(r={}),t.modules.pathfinding.astar(n,i,r)},dijkstra:function(n,i,r){return void 0===r&&(r={}),t.modules.pathfinding.dijkstra(n,i,r)},dijkstraBig:function(n,i,r){return void 0===r&&(r={}),t.modules.pathfinding.dijkstraBig(n,i,r)}})},ey);function ey(){}var ty=(ny.initNamespace=function(e){var t;e.rules=(t=e,{map:function(n){return t.modules.rules.createMapping(n)},slices:function(n){return t.modules.rules.createSlices(n)},template:function(n){return t.modules.rules.createTemplate(n)}})},ny);function ny(){}var sA=(Ws.prototype.clearSelection=function(){return this.modules.selection.clear()},Ws.prototype.getSelectedNodes=function(){return this.modules.selection.getSelectedNodes()},Ws.prototype.getNonSelectedNodes=function(){return this.modules.selection.getNonSelectedNodes()},Ws.prototype.getSelectedEdges=function(){return this.modules.selection.getSelectedEdges()},Ws.prototype.getNonSelectedEdges=function(){return this.modules.selection.getNonSelectedEdges()},Ws);function Ws(){}var uA=(Ah.prototype.setOptions=function(e){return this.modules.settings.update(e)},Ah.prototype.getOptions=function(){return this.modules.settings.get()},Ah);function Ah(){}var iy=(ry.initNamespace=function(e){var t;e.styles=(t=e,{setNodesVisibility:function(n){return t.modules.graphics.setNodesVisibility(n)},setEdgesVisibility:function(n){return t.modules.graphics.setEdgesVisibility(n)},setNodeTextsVisibility:function(n){return t.modules.graphics.setNodeTextsVisibility(n)},setEdgeTextsVisibility:function(n){return t.modules.graphics.setEdgeTextsVisibility(n)},addRule:function(n){return t.modules.styleRules.addRule(n)},getRuleList:function(){return t.modules.styleRules.getRuleList()},addNodeRule:function(n,i){var r,o;return o=1===arguments.length?void(r=n):(r=i,n),t.styles.addRule({nodeAttributes:r,nodeSelector:o})},addEdgeRule:function(n,i){var r,o;return o=1===arguments.length?void(r=n):(r=i,n),t.styles.addRule({edgeAttributes:r,edgeSelector:o})},getNodeRules:function(){return t.styles.getRuleList().filter(function(n){return void 0===n.getDefinition().edgeAttributes})},getEdgeRules:function(){return t.styles.getRuleList().filter(function(n){return void 0===n.getDefinition().nodeAttributes})},createClass:function(n){return t.modules.classes.createClass(n)},getClass:function(n){return t.modules.classes.getClassByName(n)},getClassList:function(){return t.modules.classes.getClassList()},setHoveredNodeAttributes:function(n,i){t.modules.hover.updateNodeAttributes(n,i)},setHoveredEdgeAttributes:function(n,i){t.modules.hover.updateEdgeAttributes(n,i)},setSelectedNodeAttributes:function(n,i){return t.modules.selection.setNodeAttributes(n,i)},setSelectedEdgeAttributes:function(n,i){return t.modules.selection.setEdgeAttributes(n,i)}})},ry);function ry(){}var oy=(ay.initNamespace=function(e){var t;e.schema=(t=e,{watchNodeObjectProperty:function(n){return t.modules.watcher.watchNodeObjectProperty(n)},watchEdgeObjectProperty:function(n){return t.modules.watcher.watchEdgeObjectProperty(n)},watchNodeNonObjectProperty:function(n){return t.modules.watcher.watchNodeNonObjectProperty(n)},watchEdgeNonObjectProperty:function(n){return t.modules.watcher.watchEdgeNonObjectProperty(n)}})},ay);function ay(){}var sy=(uy.initNamespace=function(e){e.tools=function(e){return{lasso:{enable:function(d){return u.modules.lasso.enable(d),this},disable:function(){return u.modules.lasso.disable(),this},enabled:function(){return u.modules.lasso.enabled()}},connectNodes:{enable:function(d){return l.modules.connectNodes.enable(d),this},disable:function(){return l.modules.connectNodes.disable(),this},enabled:function(){return l.modules.connectNodes.enabled()}},legend:{enable:function(d){return s.modules.legend.enable(d)},disable:function(){return s.modules.legend.disable()},enabled:function(){return s.modules.legend.enabled()},getOptions:function(){return s.modules.legend.getOptions()}},rectangleSelect:{enable:function(d){a.modules.rectangleSelect.enable(d)},disable:function(){a.modules.rectangleSelect.disable()},enabled:function(){return a.modules.rectangleSelect.enabled()}},resize:{enable:function(d){return o.modules.resizing.enable(d),this},disable:function(){return o.modules.resizing.disable(),this},enabled:function(){return o.modules.resizing.enabled()}},rewire:{enable:function(d){return r.modules.rewiring.enable(d),this},disable:function(){return r.modules.rewiring.disable(),this},enabled:function(){return r.modules.rewiring.enabled()}},snapping:{enable:function(d){return i.modules.snapping.enable(d),this},disable:function(){return i.modules.snapping.disable(),this},enabled:function(){return i.modules.snapping.enabled()}},tooltip:{onNodeHover:function(d,c){n.modules.tooltip.setHandler("hover.node",d,c)},onNodeClick:function(d,c){n.modules.tooltip.setHandler("click.left.node",d,c)},onNodeRightClick:function(d,c){n.modules.tooltip.setHandler("click.right.node",d,c)},onNodeDoubleClick:function(d,c){n.modules.tooltip.setHandler("doubleClick.left.node",d,c)},onEdgeHover:function(d,c){n.modules.tooltip.setHandler("hover.edge",d,c)},onEdgeClick:function(d,c){n.modules.tooltip.setHandler("click.left.edge",d,c)},onEdgeRightClick:function(d,c){n.modules.tooltip.setHandler("click.right.edge",d,c)},onEdgeDoubleClick:function(d,c){n.modules.tooltip.setHandler("doubleClick.left.edge",d,c)},onBackgroundClick:function(d,c){n.modules.tooltip.setHandler("click.left.background",d,c)},onBackgroundRightClick:function(d,c){n.modules.tooltip.setHandler("click.right.background",d,c)},onBackgroundDoubleClick:function(d,c){n.modules.tooltip.setHandler("doubleClick.left.background",d,c)},refresh:function(){return n.modules.tooltip.refresh()},isShown:function(){return n.modules.tooltip.isShown()},hide:function(){n.modules.tooltip.hide()},show:function(d,c){return n.modules.tooltip.show(d,c)}},brand:(t=n=i=r=o=a=s=l=u=e,{set:function(d,c){return t.modules.brand.set(d,c)},remove:function(){t.modules.brand.remove()}})};var t,n,i,r,o,a,s,l,u}(e)},uy);function uy(){}function ly(e){return!0}function dy(e){return""}function wh(e,t,n){return{}}var cy,hy=(St(Ys,cy=Au),Ys.prototype._computeNodeGroupId=function(e){return this._nodeSelector(e)?this._nodeGroupIdFunction(e):void 0},Ys.prototype._computeEdgeGroupId=function(e){return this._edgeSelector(e)?this._edgeGroupIdFunction(e):void 0},Ys.prototype._addMetaNodes=function(e,t){for(var n=t.getId(),i=e.getNodes(),r=new Map,o=0;o<i.size;++o){var a=i.get(o);if(void 0!==(c=this._computeNodeGroupId(a))){var s=r.get(c);s||r.set(c,s={id:c,nodes:[]}),s.nodes.push(a)}}var l=ws(r),u=l.map(function(g){return e.getNodes(g.nodes)}),d=[];for(o=0;o<l.length;++o){var c=l[o].id,h=u[o],p=this._nodeGenerator(h,c,t);void 0===p.id&&(p.id=py(c,n)),p.position=gc(h.getPosition()),d.push(p)}return e.addNodes(d.map(function(g){return{id:g.id,attributes:g.position}}),{virtual:!0}).then(function(){var g=e.getNodes(d.map(function(b){return b.id}));g.replaceOriginalAttributes(d.map(function(b){return b.attributes}),["x","y"]);for(var m=g.getData(),x=0;x<m.length;x++){var v=m[x],y=d[x];m[x]=void 0===v?y.data:It({},v,y.data)}return g.setData(null,m),g.setVisible(!0),e.modules.grouping.setSubElements(g,u),u.forEach(function(b,S){e.modules.grouping.setMetaElement(b,g.get(S))}),g})},Ys.prototype._addMetaEdges=function(e,t){for(var n=t.getId(),i=e.getEdges(),r=new Map,o=e.modules.graphics.getAttributesManager().getUsedEdgeAttributes(),a=0;a<i.size;++a){var s=i.get(a);if(void 0!==(b=this._computeEdgeGroupId(s))){var l=this._edgeSource(s),u=this._edgeTarget(s),d=this._groupEdges?dA(b,l.getId(),u.getId(),this._separateEdgesByDirection):String(s.getId());(y=r.get(d))||r.set(d,y={id:d,source:l,target:u,edges:[]}),y.edges.push(s)}}var p,g,m=ws(r),x=m.map(function(M){return e.getEdges(M.edges)}),v=[];for(a=0;a<m.length;++a){var y,b=(y=m[a]).id,S=x[a],w=this._groupEdges?this._edgeGenerator(S,b,t):(p=o,g=void 0,{data:(g=S.get(0)).getData(),attributes:g.getAttributes(p)});if(null!=w.id&&null!=e.getEdge(w.id))throw Error("The id "+w.id+" returned by the edgeGenerator function is not a unique id.");void 0===w.id&&(w.id=py(b,n)),w.source=y.source.getId(),w.target=y.target.getId(),v.push(w)}return e.addEdges(v.map(function(M){return{id:M.id,source:M.source,target:M.target}}),{virtual:!0}).then(function(){var M=e.getEdges(v.map(function(V){return V.id}));M.replaceOriginalAttributes(v.map(function(V){return V.attributes}));for(var N=M.getData(),D=0;D<N.length;D++){var P=v[D],L=N[D];N[D]=void 0===L?P.data:It({},L,P.data)}return M.setData(null,N),M.setVisible(!0),e.modules.grouping.setSubElements(M,x),x.forEach(function(V,X){e.modules.grouping.setMetaElement(V,M.get(X))}),M})},Ys);function Ys(e){var t=cy.call(this,e)||this;return t._nodeSelector=e.nodeSelector,t._nodeGroupIdFunction=e.nodeGroupIdFunction,t._nodeGenerator=e.nodeGenerator,t._edgeSelector=e.edgeSelector,t._edgeGroupIdFunction=e.edgeGroupIdFunction,t._edgeGenerator=e.edgeGenerator,t._edgeSource=e.edgeSource,t._edgeTarget=e.edgeTarget,t._separateEdgesByDirection=e.separateEdgesByDirection,t._groupSelfLoopEdges=e.groupSelfLoopEdges,t._groupEdges=e.groupEdges,t}function dA(e,t,n,i){var r=t,o=n;return!i&&r.toString()>o.toString()&&(r=n,o=t),e+"["+r+"-"+o+"]"}function py(e,t){return"gen_grp_"+t+"_"+e}var fy,cA=(St(Xs,fy=hy),Xs.prototype.getName=function(){return"node-grouping"},Xs.prototype.run=function(e){var t,n,i,r,o,a=this,s=e.ogma,l=e.duration,u=e.wrapper;return this._addMetaNodes(s,u).then(function(d){return(t=d).setVisible(!1),a._addMetaEdges(s,u)}).then(function(d){(n=d).setVisible(!1),i=t.getSubNodes().reduce(function(h,p){return h.concat(p)},s.createNodeList()),r=n.getSubEdges().reduce(function(h,p){return h.concat(p)},s.createEdgeList());var c=s.getNodes(i.getMetaNode()).getPosition();return o=i.getPosition().map(function(h,p){var g=c[p];return{x:h.x-g.x,y:h.y-g.y}}),i.setAttributes(c,l)}).then(function(){return i.setVisible(!1),r.setVisible(!1),t.setVisible(!0),n.filter(function(d){return a._groupSelfLoopEdges||d.getSource()!==d.getTarget()}).setVisible(!0),{metaNodes:t,metaEdges:n,subNodes:i,subEdges:r,offsets:o}})},Xs.prototype.undo=function(e){var t=this,n=e.ogma,i=e.duration,r=e.context,o=r.metaNodes,a=r.metaEdges,s=r.subNodes,l=r.subEdges,u=r.offsets,d=n.getNodes(s.getMetaNode()).getPosition(),c=d.map(function(h,p){return{x:(g=h).x+(m=u[p]).x,y:g.y+m.y};var g,m});return s.setVisible(!0),l.setVisible(!0),n.modules.grouping.setMetaElement(s,null),n.modules.grouping.setMetaElement(l,null),o.setVisible(!1),a.setVisible(!1),s.setAttributes(d).then(function(){if(t._restorePositions)return s.setAttributes(c,i)})},Xs.prototype.cleanup=function(e){var t=e.ogma,n=e.context,r=n.metaEdges,o=n.metaNodes.filter(function(s){return!s.isVisible()}),a=r.filter(function(s){return!s.isVisible()});return Promise.all([t.removeEdges(a,{virtual:!0}),t.removeNodes(o,{virtual:!0})]).then(function(){return Promise.resolve()})},Xs);function Xs(e){var t=e.selector,i=e.groupIdFunction,o=e.nodeGenerator,s=e.edgeGenerator,u=e.separateEdgesByDirection,c=e.groupSelfLoopEdges,h=void 0!==c&&c,p=e.groupEdges,m=e.restorePositions,x=void 0===m||m,v=fy.call(this,{nodeSelector:void 0===t?ly:t,nodeGroupIdFunction:void 0===i?dy:i,nodeGenerator:void 0===o?wh:o,edgeSelector:function(y){return!(!y.getSource().getMetaNode()&&!y.getTarget().getMetaNode())},edgeGroupIdFunction:function(){return""},edgeGenerator:void 0===s?wh:s,edgeSource:function(y){return gy(y.getSource())},edgeTarget:function(y){return gy(y.getTarget())},separateEdgesByDirection:void 0!==u&&u,groupEdges:void 0===p||p})||this;return v._groupSelfLoopEdges=h,v._restorePositions=x,v}function gy(e){return e.getMetaNode()||e}var _y,hA=(St(Js,_y=hy),Js.prototype.getName=function(){return"edge-grouping"},Js.prototype.run=function(e){var t,n,i=e.ogma;return this._addMetaEdges(i,e.wrapper).then(function(o){return(n=(t=o).getSubEdges().reduce(function(a,s){return a.concat(s)},i.createEdgeList())).setVisible(!1),{metaEdges:t,subEdges:n}})},Js.prototype.undo=function(e){var t=e.context,n=t.metaEdges;return t.subEdges.setVisible(!0),n.setVisible(!1),Promise.resolve()},Js.prototype.cleanup=function(e){return e.ogma.removeEdges(e.context.metaEdges.filter(function(i){return!i.isVisible()}),{virtual:!0})},Js);function Js(e){var t=e.selector,i=e.groupIdFunction,o=e.generator,s=e.separateEdgesByDirection;return _y.call(this,{nodeSelector:null,nodeGroupIdFunction:null,nodeGenerator:null,edgeSelector:void 0===t?ly:t,edgeGroupIdFunction:void 0===i?dy:i,edgeGenerator:void 0===o?wh:o,edgeSource:function(u){return u.getSource()},edgeTarget:function(u){return u.getTarget()},separateEdgesByDirection:void 0!==s&&s,groupEdges:!0})||this}var my,pA=(St(Qs,my=Au),Qs.prototype.getName=function(){return Ao.NeighborGeneration},Qs.prototype.run=function(e){for(var t,n=this,i=e.ogma,r=e.duration,o=e.wrapper.getId(),a=i.getNodes(),s=new Map,l=0;l<a.size;++l){var u=a.get(l),d=(t=this._generateIds(u),Array.isArray(t)?t:t?[t]:null);if(d)for(var c=0;c<d.length;++c){var h=d[c];(y=s.get(h))||s.set(h,y=[]),y.push(u)}}var p,g,m=new Array(s.size),x=il(s),v=ws(s).map(function(w){return i.getNodes(w)});for(l=0;l<m.length;++l){var y=v[l],b=this._nodeGenerator(h=x[l],y);b.id="_gen_"+o+"_"+h;var S=gc(y.getPosition());b.attributes=b.attributes||{},b.attributes.x=S.x,b.attributes.y=S.y,m[l]=b}return i.addNodes(m.map(function(w){return{id:w.id,attributes:w.attributes}}),{virtual:!0}).then(function(w){(p=w).replaceOriginalAttributes(m.map(function(J){return J.attributes}),["x","y"]),p.setData(null,m.map(function(J){return J.data}));for(var M=[],N=0;N<w.size;++N)for(var D=w.get(N),P=v[N],L=0;L<P.size;++L){var V=P.get(L),X=n._edgeGenerator(V,D);X.source||X.target||(X.source=V.getId(),X.target=D.getId()),M.push(X)}return i.addEdges(M,{virtual:!0})}).then(function(w){return g=w,p.setVisible(!0),g.setVisible(!0),p.addClass(ai),g.addClass(ai),Promise.all([p.removeClass(ai,r),g.removeClass(ai,r)])}).then(function(){return{virtualNodes:p,virtualEdges:g}})},Qs.prototype.undo=function(e){var t=e.context,n=e.duration,i=t.virtualNodes,r=t.virtualEdges;return Promise.all([i.addClass(ai,n),r.addClass(ai,n)]).then(function(){i.setVisible(!1),r.setVisible(!1)})},Qs.prototype.cleanup=function(e){var t=e.ogma,n=e.context,i=n.virtualEdges,r=n.virtualNodes.filter(function(a){return!a.isVisible()}),o=i.filter(function(a){return!a.isVisible()});return t.removeNodes(r,{virtual:!0}),t.removeEdges(o,{virtual:!0}),Promise.resolve()},Qs);function Qs(e){var t=my.call(this)||this,n=e.selector,i=void 0===n?function(){return!0}:n,r=e.neighborIdFunction,o=void 0===r?function(){return null}:r,a=e.nodeGenerator,s=void 0===a?function(){return{}}:a,l=e.edgeGenerator,u=void 0===l?function(){return{source:null,target:null}}:l;return t._generateIds=function(d){return i(d)&&o(d)},t._nodeGenerator=s,t._edgeGenerator=u,t}var vy,fA=(St(zu,vy=Au),zu.prototype.run=function(e){for(var t=e.ogma,n=e.duration,i=t.getNodes().filter(this._selector),r=[],o=new Map,a=0;a<i.size;++a)for(var s=i.get(a),l=s.getAdjacentEdges(),u=this._dataFunction(s),d=0;d<l.size;++d){var c=l.get(d),h=c.getSource(),p=c.getTarget();if(h!==p&&void 0!==u){var g=h===s?p:h,m=o.get(g);m||o.set(g,m=[]),m.push(u)}r.push(c)}var x=t.getEdges(r),v=t.getNodes(il(o)),y=ws(o),b=v.getData(),S=new Array(v.size);for(a=0;a<S.length;++a){var w=y[a],M=b[a];for(d=0;d<w.length;++d)M=nr(M,w[d]);S[a]=M}return Promise.all([i.addClass(ai,n),x.addClass(ai,n)]).then(function(){return i.setVisible(!1),x.setVisible(!1),v.setData(S),{hiddenNodes:i,hiddenEdges:x,nodesWithDataChange:v,oldDataList:b}})},zu.prototype.getName=function(){return Ao.NeighborMerging},zu.prototype.undo=function(e){var t=e.duration,n=e.context,i=n.hiddenNodes,r=n.hiddenEdges,o=n.nodesWithDataChange,a=n.oldDataList;return i.setVisible(!0),r.setVisible(!0),i.addClass(ai),r.addClass(ai),Promise.all([i.removeClass(ai,t),r.removeClass(ai,t)]).then(function(){o.setData(a)})},zu);function zu(e){var t=e.selector,n=void 0===t?function(){return!1}:t,i=e.dataFunction,r=void 0===i?function(){}:i,o=vy.call(this)||this;return o._selector=n,o._dataFunction=r,o}function gA(e,t){return e.size===t.size&&0<e.filter(function(n){return t.includes(n)}).size}var yy,_A=(St(Ks,yy=Au),Ks.prototype.getName=function(){return Ao.NodeCollapsing},Ks.prototype.run=function(e){for(var t=this,n=e.ogma,i=e.duration,r=n.getNodes().filter(this._selector),o=r.getAdjacentEdges(),a=[],s=r.map(function(M){return M.getAdjacentNodes().filter(function(N){return!t._selector(N)})}),l=0;l<r.size;l++)for(var u=l;u<r.size;u++){var d=r.get(l),c=r.get(u);if(0<n.modules.graph.getEdgesBetweenTwoNodes(d,c).size&&(s[l].size||s[u].size)&&!gA(s[l],s[u]))throw Error("addNodeCollapsing: invalid connected nodes ["+d.getId()+"] and ["+c.getId()+"] to be collapsed. The addNodeCollapsing function supports only disconnected nodes.")}for(l=0;l<r.size;++l){var h=r.get(l),p=s[l];for(u=0;u<p.size-1;++u){var g=p.get(u),m=n.modules.graph.getEdgesBetweenTwoNodes(h,g);if(g!==h)for(var x=u+1;x<p.size;++x){var v=p.get(x),y=n.modules.graph.getEdgesBetweenTwoNodes(h,v),b=this._edgeGenerator(h,g,v,m,y);if(b)for(var S=f(b),w=0;w<S.length;++w)a.push(mA(n,S[w],w,h,g,v,m,y))}}}return n.addEdges(a,{virtual:!0}).then(function(M){return M.addClass(ai)}).then(function(M){return Promise.all([M.removeClass(ai,i),r.addClass(ai,i),o.addClass(ai,i)])}).then(function(M){var N=M[0];return r.setVisible(!1),o.setVisible(!1),{virtualEdges:N,hiddenNodes:r,hiddenEdges:o}})},Ks.prototype.undo=function(e){var t=e.duration,n=e.context,i=n.virtualEdges,r=n.hiddenNodes,o=n.hiddenEdges;return r.setVisible(!0),o.setVisible(!0),Promise.all([r.addClass(ai),o.addClass(ai)]).then(function(){return Promise.all([r.removeClass(ai,t),o.removeClass(ai,t),i.addClass(ai,t)])}).then(function(){i.setVisible(!1)})},Ks.prototype.cleanup=function(e){return e.ogma.removeEdges(e.context.virtualEdges.filter(function(i){return!i.isVisible()}),{virtual:!0})},Ks);function Ks(e){var t=e.selector,n=void 0===t?function(){return!1}:t,i=e.edgeGenerator,r=void 0===i?function(){return{}}:i,o=yy.call(this)||this;return o._selector=n,o._edgeGenerator=r,o}function mA(e,t,n,i,r,o,a,s){var l=null,u=null;if(void 0!==t.source&&(l=e.getNode(t.source))!==r&&l!==o)throw new Error(["addNodeCollapsing: edge generator produced RawEdge with invalid source ["+t.source+"]","expected to be ["+r.getId()+"] or ["+o.getId()+"]"].join("; "));if(void 0!==t.target&&(u=e.getNode(t.target))!==r&&u!==o)throw new Error(["addNodeCollapsing: edge generator produced RawEdge with invalid target ["+t.target+"]","expected to be ["+r.getId()+"] or ["+o.getId()+"]"].join("; "));if(l&&u&&l===u)throw new Error("addNodeCollapsing: edge generator produced RawEdge with same source and target ["+l.getId()+"]");if(l&&!u)u=l===r?o:r;else if(u&&!l)l=u===r?o:r;else if(!l&&!u){for(var d=!0,c=0;c<a.size;++c)a.get(c).getSource()===r&&(d=!1);for(c=0;c<s.size;++c)s.get(c).getTarget()===o&&(d=!1);u=d?(l=o,r):(l=r,o)}return It({},t,{id:"_gen_"+i.getId()+"_"+l.getId()+"_"+u.getId()+"_"+n,source:l.getId(),target:u.getId()})}var xy,vA=(St(Bu,xy=Au),Bu.prototype.getName=function(){return Ao.VirtualProperties},Bu.prototype.run=function(e){var t=e.ogma,n={nodes:null,oldNodesData:null,edges:null,oldEdgesData:null};return this._nodeDataFunction&&(n.nodes=t.getNodes().filter(this._nodeSelector),n.oldNodesData=by(n.nodes,this._nodeDataFunction)),this._edgeDataFunction&&(n.edges=t.getEdges().filter(this._edgeSelector),n.oldEdgesData=by(n.edges,this._edgeDataFunction)),Promise.resolve(n)},Bu.prototype.undo=function(e){var t=e.context,n=t.nodes,r=t.edges,o=t.oldEdgesData;return n&&n.setData(t.oldNodesData),r&&r.setData(o),Promise.resolve()},Bu);function Bu(e){var t=e.nodeSelector,n=void 0===t?function(){return!0}:t,i=e.edgeSelector,r=void 0===i?function(){return!0}:i,o=e.nodeDataFunction,a=void 0===o?null:o,s=e.edgeDataFunction,l=void 0===s?null:s,u=xy.call(this)||this;return u._nodeSelector=n,u._edgeSelector=r,u._nodeDataFunction=a,u._edgeDataFunction=l,u}function by(e,t){for(var n=[],i=0;i<e.size;++i){var r=e.get(i),o=r.getData(),a=nr(o,t(r));n.push(o),r.setData(a)}return n}var Ey=(ka.initNamespace=function(e){e.transformations=function(e){return It({},{getList:function(){return a.modules.transformations.getList()},clear:function(){return a.modules.transformations.clear()},afterNextUpdate:function(){return a.modules.transformations.whenApplied()}},{addNodeGrouping:function(s){return void 0===s&&(s={}),o.modules.transformations.add(new cA(s),{duration:s.duration,enabled:s.enabled})},addEdgeGrouping:function(s){return void 0===s&&(s={}),o.modules.transformations.add(new hA(s),{duration:s.duration,enabled:s.enabled})}},{addNodeFilter:function(s){return r.modules.filters.addNodeFilter(s)},addEdgeFilter:function(s){return r.modules.filters.addEdgeFilter(s)}},{addNeighborGeneration:function(s){return i.modules.transformations.add(new pA(s),{duration:s.duration,enabled:s.enabled})},addNeighborMerging:function(s){return i.modules.transformations.add(new fA(s),{duration:s.duration,enabled:s.enabled})}},{addNodeCollapsing:function(s){return void 0===s&&(s={}),n.modules.transformations.add(new _A(s),{duration:s.duration,enabled:s.enabled})}},(t=n=i=r=o=a=e,{addVirtualProperties:function(s){return t.modules.transformations.add(new vA(s),{duration:s.duration,enabled:s.enabled})}}));var t,n,i,r,o,a}(e)},ka.prototype.addNodeFilter=function(e){return this.modules.filters.addNodeFilter(e)},ka.prototype.addEdgeFilter=function(e){return this.modules.filters.addEdgeFilter(e)},ka.prototype.getNodeFilters=function(){return this.modules.transformations.getList().filter(function(e){return e.getName()===Ao.NodeFilter})},ka.prototype.getEdgeFilters=function(){return this.modules.transformations.getList().filter(function(e){return e.getName()===Ao.EdgeFilter})},ka.prototype.clearNodeFilters=function(){return Promise.all(this.getNodeFilters().map(function(e){return e.destroy()})).then(function(){return Promise.resolve()})},ka.prototype.clearEdgeFilters=function(){return Promise.all(this.getEdgeFilters().map(function(e){return e.destroy()})).then(function(){return Promise.resolve()})},ka);function ka(){}var Sy=(Ay.initNamespace=function(e){var t,n,i,r,o,a;e.view=(n=(t=e.modules).camera,i=t.captor,r=t.dom,o=t.graphics,a=t.locate,{setZoom:function(s,l){return n.setZoom(s,l)},zoomIn:function(s,l){return n.zoomIn(s,l)},zoomOut:function(s,l){return n.zoomOut(s,l)},getZoom:function(){return n.getZoom()},setCenter:function(s,l){return n.setCenter(s,l)},move:function(s,l){return n.move(s,l)},getCenter:function(){return n.getCenter()},setAngle:function(s,l){return n.setAngle(s,l)},rotate:function(s,l){return n.rotate(s,l)},getAngle:function(){return n.getAngle()},set:function(s,l){return n.setView(s,l)},get:function(){return n.getView()},graphToScreenCoordinates:function(s){return n.graphToScreenCoordinates(s)},screenToGraphCoordinates:function(s){return n.screenToGraphCoordinates(s)},getImageData:function(){return o.getImageData()},getElementAt:function(s){return i.getElementAt(s)},beforeNextFrame:function(){return r.beforeNextFrame()},afterNextFrame:function(){return r.afterNextFrame()},setFullScreen:function(s){return r.setFullScreen(s)},isFullScreen:function(){return r.isFullScreen()},forceResize:function(){return r.forceResize()},getSize:function(){return r.getDimensions()},setSize:function(s){if(!s||isNaN(s.width)||isNaN(s.height))throw new Error("Size must follow the format { width: number, height: number }");if(s.width<0)throw new Error("width must be positive");if(s.height<0)throw new Error("height must be positive");return r.setDimensions(s),Promise.resolve()},locateGraph:function(s){return a.locateGraph(s)},locateRawGraph:function(s,l){return a.locateRawGraph(s,l)},getGraphBoundingBox:function(){return a.getGraphBoundingBox()}})},Ay);function Ay(){}function wy(e){return--e*e*e+1}function Cy(e,t,n){var i=e-n[0],r=t-n[1];return i*i+r*r}var xA=Object.freeze({__proto__:null,circleCircleIntersection:sc,circleSortCompare:uc,circleContainsPoint:Yf,circleContainsCircle:Xf,circleIntersectsBox:lc,circleLineIntersection:Jf,isPointInLine:pf,twoSegmentsIntersect:function(e,t,n,i,r){if(void 0===r&&(r=!1),r&&(fl(e,n)||fl(e,i)||fl(t,n)||fl(t,i)))return!1;var o=(e.y-n.y)*(i.x-n.x)-(e.x-n.x)*(i.y-n.y),a=(t.x-e.x)*(i.y-n.y)-(t.y-e.y)*(i.x-n.x);if(0==a)return!1;var s=o/a,l=(o=(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y))/a;return!(s<=0||1<=s||l<=0||1<=l)},lineAngle:Ms,angle:function(e,t,n){var i=Ms(e.x,e.y,t.x,t.y)-Ms(n.x,n.y,t.x,t.y);return i<0?i+2*Math.PI:i},lineIntersection:function(e,t,n,i,r,o,a,s){var l=(s-o)*(n-e)-(a-r)*(i-t);if(0==l)return null;var u=t-o;return{x:e+(u=((a-r)*u-(s-o)*(e-r))/l)*(n-e),y:t+u*(i-t)}},segmentIntersection:mu,segmentRectangleIntersection:ff,lineLine:Is,lineAABB:Xd,distancePointSegment:gf,distToSegmentSquared:Jd,getClosestPointOnSegment:_f,getClosestPointOnLine:function(e,t,n,i,r,o){var a=r-n,s=o-i,l=((e-n)*a+(t-i)*s)/(a*a+s*s);return{x:n+a*l,y:i+s*l}},defaultAABB:af,rotate:Zd,move:function(e,t,n,i){return void 0===n&&(n=0),void 0===i&&(i={x:0,y:0}),i.x=e.x+n*Math.sin(t),i.y=e.y+n*Math.cos(t),i},distance:yi,squaredDistance:ul,radiansToDegrees:sf,degreesToRadians:function(e){return e*Math.PI/180},extendBounds:function(e,t){return e.minX-=t,e.minY-=t,e.maxX+=t,e.maxY+=t,e.width+=2*t,e.height+=2*t,e},isPointInPolygon:bu,polygonsIntersect:fc,computeCentroid:gc,getPointOnQuadraticCurve:Qd,isPointOnQuadraticCurve:xf,getPointOnBezierCurve:vu,isPointOnBezierCurve:bf,getQuadraticCurveBoundingBox:Kd,getBezierCurveBoundingBox:gl,quadBezierAABB:vf,cubicBezierAABB:yf,getSelfLoopControlPoints:Ya,getQuadraticCurveControlPoint:pa,getAABB:Wl,getOBBPoints:zs,moveAABB:Lc,padBounds:function(e,t){return e.minX-=t,e.minY-=t,e.maxX+=t,e.maxY+=t,e.width+=2*t,e.height+=2*t,e},overlapsAABB:function(e,t){return Zo(e[0],e[1],e[2],e[3],t[0],t[1],t[2],t[3])},intersects:T_,overlaps:Zo}),bA=Object.freeze({__proto__:null,minHeap:kc,bellmanFord:Kc,dijkstra:Hl,johnson:$c,largestEmptyCircle:Sv,minDisk:xv,removeRadialOverlap:eh,convexhull:rh,circlePack:function(e){var t=e.X,n=e.Y,i=e.R,r=e.center,o=e.maxSteps,a=void 0===o?1e3:o,s=e.padding,l=void 0===s?5:s,u=e.epsilon,d=void 0===u?1e-5:u,c=e.damping,h=void 0===c?2:c,p=e.pinned,g=e.indexes,m=e.onUpdate,x=e.pushSmallerOut,v=void 0===x||x,y=g?g.length:t.length,b=g;if(isFinite(p)||(p=-1),void 0===b){b=new Uint32Array(y);for(var S=0;S<y;S++)b[S]=S}else b=g;if(-1!==p)r=[t[p],n[p]];else if(!r){var w=0,M=0;for(S=0;S<y;S++)w+=t[b[S]],M+=n[b[S]];r=[w/y,M/y]}var N=function(se,re){for(var j=1/0,Y=-1/0,he=0;he<se.length;he++){var pe=se[he],Ae=re?re[pe]:pe;j=Math.min(Ae,j),Y=Math.max(Ae,Y)}return{min:j,max:Y}}(b,i),D=N.min,P=N.max;function L(se,re){for(var j=0,Y=0;Y<y-1;Y++)for(var he=Y+1;he<y;he++)if(Y!==he){var pe=b[Y],Ae=b[he],at=i[pe],Tt=i[Ae],Ge=t[Ae]-t[pe],qe=n[Ae]-n[pe],Le=Ge*Ge+qe*qe;if(Le<(Qe=at+Tt+l)*Qe-se){var He=(Qe-Math.sqrt(Le))*re,Je=1/Le,et=(dt=Ge*Je*He)*dt+(Ht=qe*Je*He)*Ht;Ae!==p&&(j+=et*(an=at/D),t[Ae]+=dt*an,n[Ae]+=Ht*an),pe!==p&&(j+=et*(an=Tt/D),t[pe]-=dt*an,n[pe]-=Ht*an)}}var Te=se*h*(1-re),Re=r[0],Ze=r[1];for(Y=0;Y<y;Y++)if((pe=b[Y])!==p){var Qe,dt,Ht,an=(Qe=i[pe])/P,hn=v?Te*an:Te;j+=et=(dt=(t[pe]-Re)*hn)*dt+(Ht=(n[pe]-Ze)*hn)*Ht,t[pe]-=dt,n[pe]-=Ht}return j}b.sort(function(se,re){return i[re]*Cy(t[re],n[re],r)-i[se]*Cy(t[se],n[se],r)});var V=0,X=0,J=wy(1/y);for(S=0;S<a&&(V=L(J,wy((S+1)/a)),m&&setTimeout(function(){return m(t,n)}),!(Math.abs(V-X)<d));S++)X=V;return{X:t,Y:n}},Quadtree:k_,weightedStress:_v,distanceStress:mv,constrainedStress:th,stressMinimizationStep:nh,stressMinimizationStepGeneral:function(e,t,n,i,r,o,a,s){a=a||0;var l,u=t,d=n;-1===(r=void 0===r?-1:r)&&(a=0);for(var c=0;c<i;c++){for(var h=s[c],p=0,g=0,m=0,x=t[h],v=n[h],y=0;y<i;y++){var b=s[y],S=void 0;if(b!==h){var w=0,M=e[h][b]*o,N=1/(M*M);h!==r&&b!==r||(w=N);var D=(1-a)*N+a*w;if(p+=D,0!=N){var P=t[b],L=n[b],V=x-P,X=v-L,J=V*V+X*X;1e-6<J&&(S=1/Math.sqrt(J)),g+=D*(P+M*(x-P)*S),m+=D*(L+M*(v-L)*S)}}}0!==(l=p)&&(u[h]=g/l,d[h]=m/l)}return{x:u,y:d}},detectCyclesUndirected:function(e,t,n,i){void 0===i&&(i=!1);for(var r,o,a,s,l=new Int32Array(e.length),u={},d=0;d<e.length;d++)l[d]=-1,u[e[d]]=d;for(d=0;d<t.length;d++){var c=u[t[d]],h=u[n[d]];if(i&&c===h)return!0;var p=wu(l,c),g=wu(l,h);if(p===g)return!0;o=g,a=wu(r=l,p),s=wu(r,o),r[a]=s}return!1},detectCyclesDirected:Jg,detectCyclesUndirectedDFS:function(e,t,n){for(var i=e.length,r=new Uint8Array(i),o=new Int32Array(i),a={},s=0;s<i;s++)o[a[e[s]]=s]=-1;var l=wc(e,t,n,a,!0);for(s=0;s<t.length;s++){var u=a[t[s]],d=a[n[s]];l[u]=l[u]||[],l[u].push(d)}for(s=0;s<i;s++)if(!r[s]&&Qg(s,r,-1,o,l,[],e))return!0;return!1},CyclesFinder:Kg}),EA=1,Ty=function(){function e(t){void 0===t&&(t={});var n=this;if(this.node=function(i){return new _o(i,n)},this.edge=function(i){return new na(i,n)},this.nodeList=function(i){return new or(i||new Uint32Array(0),n)},this.edgeList=function(i){return new vs(i||new Uint32Array(0),n)},this._onReady=[],null==this||this.constructor!==e)return new e(t);this._init(t)}return e.prototype._init=function(t){var n=this;this._initParameters=t,this._debug=!!t.debug,this._token=EA++,this.modules=new pE(this,t),iy.initNamespace(this),vm.initNamespace(this),Pm.initNamespace(this),pv.initNamespace(this),Wm.initNamespace(this),Xv.initNamespace(this),hv.initNamespace(this),Ey.initNamespace(this),sy.initNamespace(this),Sy.initNamespace(this),Qv.initNamespace(this),Em.initNamespace(this),oy.initNamespace(this),ty.initNamespace(this),Xm.initNamespace(this),$v.initNamespace(this),xm.initNamespace(this),this._onReady.forEach(function(i){return i(n)}),this.safelyBindToInstance()},e.prototype.safelyBindToInstance=function(){for(var t=0,n=Object.keys(e.prototype);t<n.length;t++){var i=n[t];"function"==typeof e.prototype[i]&&(this[i]=this[i].bind(this))}},e.prototype.onReady=function(t){this._onReady.push(t)},e.prototype._destroy=function(){if(!this._token)throw new Error('"destroy" called twice on the same instance of Ogma');this._onReady=[],this.modules.destroy(),this.modules=null},e.prototype.destroy=function(){this._destroy()},e.prototype.reset=function(){var t=this._initParameters;this._destroy(),this._init(t)},e.prototype.isDebug=function(){return this._debug},e.libraries=Jn,e.build={version:"2.9.3",commit:"673d5e4",date:"Wed Jan 08 2020 19:06:20 GMT+0100 (Central European Standard Time)"},e.geometry=xA,e.algorithms=bA,e.utils=d0,e}();return Object.assign.apply(Object,[Ty.prototype].concat([vm,fE,gE,xm,_E,Em,Pm,Wm,Xm,$E,eS,hv,pv,Xv,$v,sA,uA,iy,sy,Ey,Sy,Qv,oy,ty].map(function(e){return e.prototype}))),Ty}()}}]);